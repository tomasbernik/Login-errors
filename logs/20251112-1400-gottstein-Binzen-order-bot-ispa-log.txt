2025-11-12 14:00:35,936 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 14:00:35,943 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 14:00:46,456 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 14:00:57,535 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 14:01:13,042 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:03:11,118 - ispa_next.app_start.main - DEBUG - Operation already took 106.78 seconds (more than 80 seconds)
2025-11-12 14:03:13,203 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_8j5g686z_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_8j5g686z', 'txt']
2025-11-12 14:03:13,460 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:03:13,464 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:03:13,465 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:05:12,504 - ispa_next.app_start.main - DEBUG - Operation already took 106.72 seconds (more than 80 seconds)
2025-11-12 14:05:14,577 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_fa7aw46g_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_fa7aw46g', 'txt']
2025-11-12 14:05:14,799 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:05:14,805 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:05:22,350 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 14:05:32,597 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 14:05:42,716 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 14:05:58,284 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:07:56,027 - ispa_next.app_start.main - DEBUG - Operation already took 106.64 seconds (more than 80 seconds)
2025-11-12 14:07:58,108 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_xzenoov__input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_xzenoov_', 'txt']
2025-11-12 14:07:58,352 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:07:58,358 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:07:58,359 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:09:57,648 - ispa_next.app_start.main - DEBUG - Operation already took 107.00 seconds (more than 80 seconds)
2025-11-12 14:09:59,765 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_ky19xmfu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_ky19xmfu', 'txt']
2025-11-12 14:10:00,028 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:10:00,032 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:10:06,884 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 14:10:13,768 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 14:10:26,095 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 14:10:41,653 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:12:39,444 - ispa_next.app_start.main - DEBUG - Operation already took 106.71 seconds (more than 80 seconds)
2025-11-12 14:12:41,512 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_pnkoxmiv_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_pnkoxmiv', 'txt']
2025-11-12 14:12:41,745 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:12:41,750 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:12:41,751 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:14:40,889 - ispa_next.app_start.main - DEBUG - Operation already took 106.84 seconds (more than 80 seconds)
2025-11-12 14:14:42,979 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_2o9en1q1_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_2o9en1q1', 'txt']
2025-11-12 14:14:43,211 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:14:43,215 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:14:50,038 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 14:14:56,974 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 14:15:09,255 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 14:15:24,700 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:17:22,053 - ispa_next.app_start.main - DEBUG - Operation already took 106.30 seconds (more than 80 seconds)
2025-11-12 14:17:24,133 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_ul5m45t2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c448a12cf8aeb31c\\tess_ul5m45t2', 'txt']
2025-11-12 14:17:24,340 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 14:17:24,343 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 14:17:24,344 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:18:13,362 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 14:18:28,467 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 14:18:32,354 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:18:33,509 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2254
2025-11-12 14:18:33,511 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 620
2025-11-12 14:18:35,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 442
2025-11-12 14:18:35,895 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 14:18:35,896 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 14:18:37,067 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 14:18:38,141 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:19:43,418 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:43,420 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:43,480 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:43,536 - ispa_next.appointments.models - DEBUG - Appointment betaplan GmbH LÖ-BS 7119 WBA41CM0108E22810 ohne Termin.
2025-11-12 14:19:43,537 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:43,558 - ispa_next.appointments.models - DEBUG - Appointment Elektro Rütten GmbH LÖ-ER 3003 WBS61AY0X0FS27171 ohne Termin.
2025-11-12 14:19:43,585 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:43,599 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-12 14:19:43,604 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:43,635 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-12 14:19:43,666 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-12 14:19:43,689 - ispa_next.appointments.models - DEBUG - Appointment Vahap Yilmaz LÖ-VY 23 WBAWZ510300M14799 ohne Termin.
2025-11-12 14:19:43,704 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-12 14:19:43,718 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-12 14:19:43,733 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-12 14:19:43,748 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-12 14:19:43,763 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-12 14:19:43,776 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-12 14:19:43,791 - ispa_next.appointments.models - DEBUG - Appointment Mady Wattiau DZ-892-BN WBAVP71090V210069 ohne Termin.
2025-11-12 14:19:43,821 - ispa_next.main - DEBUG - Found 3 out of 146 appointments to process (configured limit: 15).
2025-11-12 14:19:43,821 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 14:19:43,821 - ispa_next.main - DEBUG - All appointments: LÖ-IK 9781, LÖ-M6H, LÖ-AN 995
2025-11-12 14:19:43,823 - ispa_next.main - DEBUG - 



2025-11-12 14:19:43,823 - ispa_next.main - DEBUG - starting with process 1 (LÖ-IK 9781) of 3
2025-11-12 14:19:43,827 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:19:44,607 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:19:45,477 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2254
2025-11-12 14:19:45,478 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 442
2025-11-12 14:19:46,665 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:19:46,666 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:20:26,005 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:20:26,102 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 14:20:26,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:20:26,594 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2254
2025-11-12 14:20:26,596 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:20:29,113 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 620
2025-11-12 14:20:29,114 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:20:29,994 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:20:29,998 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:20:30,002 - ispa_next.main - DEBUG - Found new Appointment: GS-653-SZ
2025-11-12 14:20:30,002 - ispa_next.main - DEBUG - Found new Appointment: LÖ-BL 6000
2025-11-12 14:20:30,003 - ispa_next.main - DEBUG - 



2025-11-12 14:20:30,003 - ispa_next.main - DEBUG - starting with process 2 (GS-653-SZ) of 5
2025-11-12 14:20:30,008 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:20:31,222 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:20:32,379 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2254
2025-11-12 14:20:32,381 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 620
2025-11-12 14:20:33,773 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:20:33,773 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:20:55,341 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:21:04,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:21:04,868 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:21:05,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:21:06,924 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:21:06,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:21:06,985 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:21:07,140 - ispa_next.functions - DEBUG - HU date already expired after 792 days.
2025-11-12 14:21:13,941 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:21:13,945 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:21:16,724 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:21:16,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:21:17,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:21:19,780 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:21:19,885 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:21:23,100 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:21:23,157 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:21:23,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:21:25,102 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:21:36,188 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 14:21:37,193 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:21:37,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:21:37,716 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:21:51,170 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:21:58,438 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:21:58,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:21:58,509 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:21:58,510 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:21:58,546 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:21:58,634 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:21:59,709 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 14:22:00,984 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 14:22:01,349 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:22:03,690 - ispa_next.functions - DEBUG - Updated appointment (AB00091576) customer contact data.
2025-11-12 14:22:04,609 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:22:04,613 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:22:04,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:22:05,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:22:06,858 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:22:06,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:22:06,930 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 14:22:11,426 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:22:11,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:22:11,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:22:13,938 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:22:14,033 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:22:14,164 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:22:14,266 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:22:14,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:22:17,539 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:22:28,893 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 14:22:36,008 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:22:36,010 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:22:42,219 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 14:22:44,894 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 14:22:46,996 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:22:49,344 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:22:50,350 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:22:50,355 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:22:50,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:22:50,494 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:22:50,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:22:51,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:22:51,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:22:52,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:22:52,113 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:22:55,120 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:22:55,123 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:22:57,087 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:22:57,092 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:22:57,094 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:22:57,096 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:22:57,098 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:22:57,099 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:22:57,100 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:22:57,101 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:22:57,102 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:22:57,103 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:22:57,107 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:22:57,109 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:22:57,110 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:23:00,363 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:23:00,366 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:23:00,368 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:23:00,371 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:23:00,373 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:23:00,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:23:03,583 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:23:03,586 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:23:03,589 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:23:03,589 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:23:04,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:23:05,075 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:23:05,078 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:23:07,016 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:23:16,141 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:23:16,513 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 14:23:16,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:23:18,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:23:18,855 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:23:21,754 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 14:23:21,755 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:23:22,617 - ispa_next.appointments.models - DEBUG - Appointment Harald Fleischer LÖ-OA 1000 WMWYW110103H93507 ohne Termin.
2025-11-12 14:23:22,618 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:23:22,620 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:23:22,625 - ispa_next.main - DEBUG - 



2025-11-12 14:23:22,625 - ispa_next.main - DEBUG - starting with process 3 (LÖ-BL 6000) of 5
2025-11-12 14:23:22,629 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:23:23,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:23:25,170 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:23:25,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 14:23:26,516 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:23:26,518 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:23:51,283 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:23:53,317 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 14:23:58,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:23:58,614 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:23:58,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:24:06,005 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:24:06,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:24:06,117 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:24:06,331 - ispa_next.functions - DEBUG - HU date already expired after 1415 days.
2025-11-12 14:24:10,400 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:24:10,403 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:24:13,194 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:24:13,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:24:14,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:24:16,173 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:24:16,287 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:24:16,385 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:24:16,457 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:24:16,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:24:23,964 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:24:34,632 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 14:24:41,859 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:24:41,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:24:50,874 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 14:24:52,529 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:24:54,923 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:24:55,931 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:24:55,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:24:56,473 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:25:10,492 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:25:14,656 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:25:14,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:25:14,756 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:25:14,757 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:25:14,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:25:16,021 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:25:17,270 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:25:17,469 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:25:18,948 - ispa_next.functions - DEBUG - Updated appointment (AB00091575) customer contact data.
2025-11-12 14:25:19,858 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:25:19,860 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:25:20,863 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:25:20,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:25:21,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:25:25,691 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:25:25,691 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 14:25:25,694 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:25:25,698 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:25:25,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:25:26,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:25:31,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:25:32,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:25:32,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:25:32,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:25:32,958 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:25:39,409 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:25:39,411 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:25:40,883 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:25:40,885 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:25:40,886 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:25:40,888 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:25:40,890 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:25:40,891 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:25:40,894 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:25:40,895 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:25:40,903 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:25:40,906 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:25:40,912 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:25:40,915 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:25:40,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:25:48,269 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 14:25:50,531 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:25:50,534 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:25:50,537 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:25:50,540 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:25:50,542 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:25:50,545 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:25:57,816 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:25:57,819 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:25:57,822 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:25:57,822 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:25:58,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:25:59,416 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:25:59,418 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:26:01,411 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:26:09,972 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:26:10,354 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 14:26:10,603 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:26:12,907 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:26:12,908 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:26:15,706 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 14:26:15,707 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:26:16,642 - ispa_next.appointments.models - DEBUG - Appointment Harald Fleischer LÖ-OA 1000 WMWYW110103H93507 ohne Termin.
2025-11-12 14:26:16,643 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:26:16,645 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:26:16,650 - ispa_next.main - DEBUG - 



2025-11-12 14:26:16,650 - ispa_next.main - DEBUG - starting with process 4 (LÖ-M6H) of 5
2025-11-12 14:26:16,656 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:26:17,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:26:19,132 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:26:19,133 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 14:26:20,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:26:20,481 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:26:49,288 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:26:49,301 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 14:26:49,305 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:26:49,784 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:26:49,785 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:26:52,074 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 14:26:52,075 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:26:52,877 - ispa_next.appointments.models - DEBUG - Appointment Harald Fleischer LÖ-OA 1000 WMWYW110103H93507 ohne Termin.
2025-11-12 14:26:52,879 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:26:52,881 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:26:52,885 - ispa_next.main - DEBUG - 



2025-11-12 14:26:52,885 - ispa_next.main - DEBUG - starting with process 5 (LÖ-AN 995) of 5
2025-11-12 14:26:52,888 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:26:54,066 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:26:55,311 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:26:55,312 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 14:26:56,736 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:26:56,738 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:27:28,999 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 14:27:29,010 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 14:27:29,015 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:27:29,544 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2255
2025-11-12 14:27:29,545 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:27:31,781 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 14:27:31,782 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:27:32,671 - ispa_next.appointments.models - DEBUG - Appointment Harald Fleischer LÖ-OA 1000 WMWYW110103H93507 ohne Termin.
2025-11-12 14:27:32,672 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:27:32,674 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
