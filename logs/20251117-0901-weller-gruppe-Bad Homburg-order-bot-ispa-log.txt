2025-11-17 09:01:25,950 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:01:25,956 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:01:36,356 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:01:47,853 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:02:03,905 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:04:09,298 - ispa_next.app_start.main - DEBUG - Operation already took 113.82 seconds (more than 80 seconds)
2025-11-17 09:04:11,455 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\8542808a3080a7e2\\tess_inggossa_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\8542808a3080a7e2\\tess_inggossa', 'txt']
2025-11-17 09:04:11,853 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:04:11,857 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:04:11,858 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:04:57,352 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:05:13,981 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:05:19,008 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:05:20,879 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-17 09:05:20,881 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 09:05:24,818 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 68
2025-11-17 09:05:24,818 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:05:24,819 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:05:26,863 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:05:28,479 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:05:42,456 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,461 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,483 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,484 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,497 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,560 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,560 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,570 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,573 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,583 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,584 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:05:42,614 - ispa_next.main - DEBUG - Found 12 out of 57 appointments to process (configured limit: 15).
2025-11-17 09:05:42,614 - ispa_next.main - DEBUG - Processing 12 fresh appointments.
2025-11-17 09:05:42,614 - ispa_next.main - DEBUG - All appointments: F-ST 7012, F-ME 8908, HG- BF 47E, HG-GA 6967, HG-DO414, F MO 611, HG-AB 872 E, FB-XX267E, HG LY 772, F-AS 3777, F BA 590E, F GF 195
2025-11-17 09:05:42,617 - ispa_next.main - DEBUG - 



2025-11-17 09:05:42,617 - ispa_next.main - DEBUG - starting with process 1 (F-ST 7012) of 12
2025-11-17 09:05:42,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:05:44,166 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:05:45,742 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-17 09:05:45,744 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 68
2025-11-17 09:05:47,861 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:05:47,862 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:06:29,053 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:06:42,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:06:46,365 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:06:46,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:46,465 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:06:46,873 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:06:46,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:47,088 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:06:59,325 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:07:02,503 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:07:02,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:07:04,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:07:06,069 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:07:06,256 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:07:06,496 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:07:06,662 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:07:08,898 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:07:09,904 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:07:09,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:10,600 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:27,598 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:07:38,433 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:07:38,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:07:38,558 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:07:38,559 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:07:38,684 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:07:38,832 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:07:40,463 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:07:41,933 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:07:42,310 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:07:44,421 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:07:44,423 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:07:44,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:07:45,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:07:47,873 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:07:47,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:07:48,190 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:07:51,779 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:07:51,779 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:07:51,783 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:07:51,784 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:07:51,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:07:52,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:07:56,596 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:07:57,928 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:08:21,038 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:08:21,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:08:22,227 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:08:22,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:08:24,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:08:24,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:08:25,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:08:25,773 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:08:30,095 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:08:30,098 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:08:33,009 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:08:33,010 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:08:33,012 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:08:33,014 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:08:33,019 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:08:33,020 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:08:33,022 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:08:33,024 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:08:33,025 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:08:33,027 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:08:33,033 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:08:33,036 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:08:33,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:08:37,761 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:08:37,765 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:08:37,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:08:42,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:08:42,259 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:08:53,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:14,088 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:09:14,090 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:09:14,093 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:09:14,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:18,872 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 09:09:38,297 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:10:10,892 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:10:12,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:10:13,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:10:14,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:28,854 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:10:43,853 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:10:43,854 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:10:45,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:10:45,985 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:10:45,989 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:10:58,782 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:11:26,010 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:11:26,479 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:11:28,703 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:32,271 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-17 09:11:32,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:39,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 09:11:39,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:11:41,621 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:11:41,627 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:11:41,637 - ispa_next.main - DEBUG - Found new Appointment: F-GR 110E
2025-11-17 09:11:41,640 - ispa_next.main - DEBUG - 



2025-11-17 09:11:41,640 - ispa_next.main - DEBUG - starting with process 2 (F-GR 110E) of 13
2025-11-17 09:11:41,644 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:11:45,130 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:48,745 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-17 09:11:48,747 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 09:11:52,561 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:52,564 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:12:54,793 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:13:15,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:19,407 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:13:19,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:19,634 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:13:20,291 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:13:36,474 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:13:36,477 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:13:39,852 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:13:39,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:42,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:13:44,294 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:13:44,494 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:13:44,853 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:13:45,026 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:13:49,425 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:13:50,431 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:13:50,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:50,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:12,055 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:14:12,056 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:14:31,695 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:14:31,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:31,875 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:14:31,877 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:14:31,998 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:14:33,866 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:14:34,704 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:14:38,554 - ispa_next.functions - DEBUG - Updated appointment (AB00036874) customer contact data.
2025-11-17 09:14:39,761 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:14:39,765 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:14:41,919 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:14:41,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:14:43,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:14:47,028 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:14:47,028 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:14:47,032 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:14:47,033 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:14:47,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:14:47,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:14:52,117 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:14:54,091 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:15:16,567 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:15:16,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:16,737 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:15:23,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:24,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:24,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:26,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:15:26,140 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:15:29,621 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:15:29,630 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:15:31,596 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:15:31,597 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:15:31,600 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:15:31,601 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:15:31,604 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:15:31,605 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:15:31,607 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:15:31,609 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:15:31,611 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:15:31,613 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:15:31,622 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:15:31,625 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:15:31,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:15:35,350 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:15:35,356 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:15:35,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:15:38,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:39,064 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:15:50,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:09,365 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:16:09,368 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:16:09,370 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:16:09,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:12,988 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 09:16:31,158 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:17:03,826 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:17:04,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:06,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:17:06,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:17:20,390 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:17:35,702 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:17:35,703 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:17:37,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:17:37,995 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:17:37,999 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:17:51,461 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:18:15,340 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:18:15,759 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:18:17,851 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:21,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 908
2025-11-17 09:18:21,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:28,886 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 09:18:28,887 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:31,115 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:31,119 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:31,134 - ispa_next.main - DEBUG - Found new Appointment: HG-RC 224
2025-11-17 09:18:31,136 - ispa_next.main - DEBUG - 



2025-11-17 09:18:31,136 - ispa_next.main - DEBUG - starting with process 3 (HG-RC 224) of 14
2025-11-17 09:18:31,142 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:34,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:38,033 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 908
2025-11-17 09:18:38,035 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 09:18:41,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:41,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:40,034 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:19:59,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:01,367 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:20:01,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:01,545 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:20:02,266 - ispa_next.functions - DEBUG - HU date already expired after 1632 days.
2025-11-17 09:20:17,433 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:20:17,436 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:20:20,821 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:20:20,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:22,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:24,959 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:20:39,648 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 09:20:55,482 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 09:20:56,487 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:20:56,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:57,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:22,483 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:21:38,255 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:21:38,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:38,470 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:21:38,471 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:21:38,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:21:38,853 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:21:41,549 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:21:43,175 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:21:44,120 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:21:48,978 - ispa_next.functions - DEBUG - Updated appointment (AB00036879) customer contact data.
2025-11-17 09:21:50,080 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:21:50,083 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:21:50,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:21:52,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:21:54,906 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:21:54,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:21:55,212 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:21:59,665 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:21:59,665 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:21:59,666 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:21:59,671 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:21:59,672 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:21:59,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:22:00,487 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:22:04,848 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:22:04,853 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:22:04,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:22:05,013 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:22:05,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:22:06,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:22:06,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:22:07,447 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:22:07,448 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:22:09,113 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:22:09,121 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:22:11,558 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:22:11,561 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:22:11,563 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:22:11,564 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:22:11,566 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:22:11,568 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:22:11,569 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:22:11,571 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:22:11,572 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:22:11,574 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:22:11,578 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:22:11,587 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:22:11,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:22:13,136 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:22:13,139 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:22:13,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:22:14,898 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:22:14,901 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:22:14,904 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:22:14,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:22:16,571 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:22:48,798 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:22:49,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:22:51,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:22:51,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:23:04,022 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:23:17,713 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:23:17,714 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:23:19,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:23:19,775 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:23:19,778 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:23:33,160 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:23:55,735 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:23:56,179 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:23:57,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:24:01,366 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 909
2025-11-17 09:24:01,368 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:24:09,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 91
2025-11-17 09:24:09,340 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:24:11,414 - ispa_next.appointments.models - DEBUG - Appointment Georgios Koniaris HG-JP 2025 WBA81FY040FS29895 ohne Termin.
2025-11-17 09:24:11,417 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:24:11,419 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:24:11,430 - ispa_next.main - DEBUG - 



2025-11-17 09:24:11,430 - ispa_next.main - DEBUG - starting with process 4 (F-ME 8908) of 14
2025-11-17 09:24:11,435 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:24:14,599 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:24:18,201 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 909
2025-11-17 09:24:18,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 09:24:22,484 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:24:22,486 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:25:21,992 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:25:43,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:25:49,584 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:25:49,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:49,788 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:25:50,288 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:25:50,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:50,454 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:26:28,349 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 09:26:28,356 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:26:31,923 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:26:31,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:26:34,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:26:36,020 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:26:36,281 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:26:36,592 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:26:36,796 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:26:41,199 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:26:42,205 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:26:42,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:26:42,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:03,885 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:27:20,604 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:27:20,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:20,823 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:27:20,824 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:27:21,028 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:27:23,455 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:27:23,847 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:27:28,189 - ispa_next.functions - DEBUG - Updated appointment (AE00016652) customer contact data.
2025-11-17 09:27:29,404 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:27:29,451 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:27:31,763 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:27:31,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:27:33,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:27:38,341 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:27:38,342 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:27:38,402 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:27:38,404 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:27:38,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:27:39,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:27:44,033 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:27:46,390 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:28:04,812 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:28:04,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:04,995 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:28:05,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:06,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:06,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:07,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:28:07,366 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:28:12,661 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:28:12,665 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:28:15,262 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:28:15,264 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:28:15,267 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:28:15,268 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:28:15,271 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:28:15,273 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:28:15,279 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:28:15,282 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:28:15,283 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:28:15,285 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:28:15,289 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:28:15,294 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:28:15,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:28:21,475 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:28:21,478 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:28:21,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:28:27,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:27,334 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:28:41,510 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:28:41,514 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:28:41,517 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:28:41,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:28:47,822 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 09:29:03,621 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:29:37,297 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:29:38,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:29:39,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:29:39,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:56,218 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:30:12,287 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:30:12,288 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:30:14,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:30:14,642 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:30:14,644 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:30:28,134 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:30:55,084 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:30:55,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:30:59,084 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:31:00,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 910
2025-11-17 09:31:00,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:31:10,884 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 09:31:10,886 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:31:12,995 - ispa_next.appointments.models - DEBUG - Appointment Georgios Koniaris HG-JP 2025 WBA81FY040FS29895 ohne Termin.
2025-11-17 09:31:12,996 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:31:12,999 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:31:13,003 - ispa_next.main - DEBUG - Found new Appointment: D-SV 330 E
2025-11-17 09:31:13,005 - ispa_next.main - DEBUG - 



2025-11-17 09:31:13,005 - ispa_next.main - DEBUG - starting with process 5 (D-SV 330 E) of 15
2025-11-17 09:31:13,009 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:31:16,022 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:31:19,658 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 910
2025-11-17 09:31:19,660 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 09:31:23,640 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:31:23,642 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:21,442 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:32:42,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:42,969 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:43,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:32:46,374 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:32:46,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:46,679 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:47,308 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:33:03,312 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:33:03,316 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:33:06,808 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:33:06,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:10,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:12,384 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:33:12,609 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:33:16,141 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:33:33,872 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:33:34,880 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:33:34,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:35,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:44,145 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 09:33:44,151 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:33:44,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:44,271 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:44,320 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:33:44,503 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:33:46,357 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:33:47,061 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:33:51,569 - ispa_next.functions - DEBUG - Updated appointment (AB00036881) customer contact data.
2025-11-17 09:33:52,699 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:33:52,704 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:33:54,825 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:33:54,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:33:56,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:34:01,278 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:34:01,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:02,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:04,203 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:34:04,436 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:34:04,712 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:34:04,888 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:34:04,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:07,946 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:34:22,766 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:35:21,769 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:35:34,807 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:35:44,984 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:35:44,986 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:49,184 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:35:53,520 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:35:54,542 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:35:54,544 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:35:54,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:35:54,691 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:35:59,000 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:35:59,005 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:35:59,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:35:59,167 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:36:05,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:05,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:36:05,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:36:07,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:36:07,079 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:36:10,785 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:36:10,792 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:36:13,390 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:36:13,392 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:36:13,394 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:36:13,395 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:36:13,398 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 09:36:13,399 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:36:13,401 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:36:13,402 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:36:13,404 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:36:13,406 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 09:36:17,275 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:36:17,841 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:36:18,868 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:36:19,576 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:36:20,147 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:36:21,135 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:36:21,794 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:36:22,395 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:36:23,390 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:36:24,037 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:36:24,595 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 09:36:26,888 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:36:29,171 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:36:30,157 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:36:30,783 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 09:36:31,865 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 09:36:33,182 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:36:33,251 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:36:33,252 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:36:36,192 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:36:36,196 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:36:36,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:36:39,035 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:36:39,038 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:36:39,041 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:36:39,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:36:42,156 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:37:14,573 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:37:15,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:37:17,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:37:17,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:37:32,018 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:37:46,575 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:37:46,576 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:37:48,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:37:48,656 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:37:48,659 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:38:05,615 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:38:29,282 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:38:29,669 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:38:31,025 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:38:35,329 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 910
2025-11-17 09:38:35,331 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:38:43,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 09:38:43,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:38:45,531 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:38:45,535 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:38:45,591 - ispa_next.main - DEBUG - 



2025-11-17 09:38:45,591 - ispa_next.main - DEBUG - starting with process 6 (HG- BF 47E) of 15
2025-11-17 09:38:45,647 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:38:49,069 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:38:52,767 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 910
2025-11-17 09:38:52,769 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 09:38:56,760 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:38:56,762 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:39:51,122 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:39:51,287 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 09:39:51,304 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:39:53,172 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 910
2025-11-17 09:39:53,174 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:40:01,171 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 09:40:01,172 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:40:03,852 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:40:03,855 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:40:03,862 - ispa_next.main - DEBUG - 



2025-11-17 09:40:03,862 - ispa_next.main - DEBUG - starting with process 7 (HG-GA 6967) of 15
2025-11-17 09:40:03,867 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:40:06,949 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:40:10,673 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 910
2025-11-17 09:40:10,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 09:40:14,885 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:40:14,887 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:41:17,083 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:41:36,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:38,897 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:41:38,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:41:39,053 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:41:39,832 - ispa_next.functions - DEBUG - HU date already expired after 757 days.
2025-11-17 09:41:55,224 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:41:55,228 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:41:58,717 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:41:58,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:42:01,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:42:03,514 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:42:03,748 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:42:07,220 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:42:24,100 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:42:25,110 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:42:25,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:42:25,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:42:34,453 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 09:42:34,457 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:42:34,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:42:34,633 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:42:34,634 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:42:34,731 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:42:36,514 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:42:36,970 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:42:41,973 - ispa_next.functions - DEBUG - Updated appointment (AN00014674) customer contact data.
2025-11-17 09:42:43,087 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:42:43,097 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:42:45,310 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:42:45,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:42:46,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:42:50,647 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:42:50,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:42:51,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:42:53,251 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:42:53,555 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:42:53,830 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:42:54,401 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:42:54,404 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:42:58,232 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:43:13,207 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:44:13,210 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:44:27,910 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:44:44,962 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 09:44:45,969 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:44:45,970 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:44:45,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:44:46,140 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:44:50,434 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:44:52,741 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:45:15,233 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:45:15,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:45:15,440 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:45:15,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:16,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:16,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:45:17,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:45:17,912 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:45:20,058 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:45:20,066 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:45:22,227 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:45:22,230 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:45:22,234 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:45:22,237 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:45:22,240 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:45:22,241 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:45:22,243 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:45:22,244 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:45:22,245 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:45:22,247 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:45:22,252 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:45:22,255 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:45:22,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:24,677 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:45:24,680 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:45:24,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:27,061 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:45:27,065 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:45:27,068 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:45:27,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:29,369 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:46:03,044 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:46:04,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:46:05,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:46:06,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:19,476 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:46:33,579 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:46:33,580 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:46:35,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:46:35,679 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:46:35,683 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:46:49,362 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:47:14,296 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:47:14,739 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 09:47:16,173 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:47:20,383 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:47:20,385 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:47:28,146 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:47:28,148 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:47:30,636 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:47:30,642 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:47:30,644 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:47:30,650 - ispa_next.main - DEBUG - 



2025-11-17 09:47:30,650 - ispa_next.main - DEBUG - starting with process 8 (HG-DO414) of 15
2025-11-17 09:47:30,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:47:33,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:47:37,229 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:47:37,231 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:47:41,328 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:47:41,330 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:48:37,355 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:48:37,377 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 09:48:37,389 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:48:39,294 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:48:39,296 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:48:47,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:48:47,600 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:48:50,432 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:48:50,438 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:48:50,441 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:48:50,450 - ispa_next.main - DEBUG - 



2025-11-17 09:48:50,450 - ispa_next.main - DEBUG - starting with process 9 (F MO 611) of 15
2025-11-17 09:48:50,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:48:55,769 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:48:59,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:48:59,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:49:03,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:49:03,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:49:58,806 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:49:58,822 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 09:49:58,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:50:00,695 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:50:00,697 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:50:08,567 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:50:08,568 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:50:11,094 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:50:11,101 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:50:11,106 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:50:11,114 - ispa_next.main - DEBUG - 



2025-11-17 09:50:11,114 - ispa_next.main - DEBUG - starting with process 10 (HG-AB 872 E) of 15
2025-11-17 09:50:11,120 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:50:14,386 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:50:18,060 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:50:18,062 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:50:22,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:50:22,482 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:51:12,552 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:51:12,566 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 09:51:12,570 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:51:14,405 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:51:14,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:51:22,193 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:51:22,194 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:51:24,731 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:51:24,738 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:51:24,742 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:51:24,748 - ispa_next.main - DEBUG - 



2025-11-17 09:51:24,748 - ispa_next.main - DEBUG - starting with process 11 (FB-XX267E) of 15
2025-11-17 09:51:24,752 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:51:28,021 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:51:31,976 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:51:31,979 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:51:35,978 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:51:35,980 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:52:30,450 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:52:30,467 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 09:52:30,471 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:52:32,355 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:52:32,357 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:52:39,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:52:39,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:52:42,373 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:52:42,377 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:52:42,379 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:52:42,385 - ispa_next.main - DEBUG - 



2025-11-17 09:52:42,385 - ispa_next.main - DEBUG - starting with process 12 (HG LY 772) of 15
2025-11-17 09:52:42,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:52:45,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:52:49,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:52:49,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:52:53,472 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:52:53,475 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:53:48,970 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:53:48,982 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 09:53:48,986 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:53:50,621 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:53:50,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:53:57,801 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:53:57,802 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:54:00,341 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:54:00,348 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:54:00,352 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:54:00,361 - ispa_next.main - DEBUG - 



2025-11-17 09:54:00,361 - ispa_next.main - DEBUG - starting with process 13 (F-AS 3777) of 15
2025-11-17 09:54:00,396 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:54:03,559 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:54:07,414 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:54:07,416 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:54:11,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:54:11,652 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:55:03,240 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:55:03,252 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 09:55:03,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:55:04,814 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:55:04,816 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:55:12,393 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:55:12,394 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:55:15,154 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:55:15,161 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:55:15,163 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:55:15,169 - ispa_next.main - DEBUG - 



2025-11-17 09:55:15,169 - ispa_next.main - DEBUG - starting with process 14 (F BA 590E) of 15
2025-11-17 09:55:15,173 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:55:18,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:55:22,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:55:22,263 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:55:26,331 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:55:26,333 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:56:16,043 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:56:16,055 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 09:56:16,059 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:56:17,846 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:56:17,861 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:56:25,360 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:56:25,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:56:27,895 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:56:27,902 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:56:27,907 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:56:27,916 - ispa_next.main - DEBUG - 



2025-11-17 09:56:27,916 - ispa_next.main - DEBUG - starting with process 15 (F GF 195) of 15
2025-11-17 09:56:27,922 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:56:31,077 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:56:34,910 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:56:34,912 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 09:56:39,241 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:56:39,244 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:57:29,018 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:57:29,031 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 09:57:29,035 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:57:30,947 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 911
2025-11-17 09:57:30,949 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:57:38,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 09:57:38,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:57:41,473 - ispa_next.appointments.models - DEBUG - Appointment Crédit Agricole Corporate and F-X 5489E WBA41EU0X09T37855 ohne Termin.
2025-11-17 09:57:41,481 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:57:41,485 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
