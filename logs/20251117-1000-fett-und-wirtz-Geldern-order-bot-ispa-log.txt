2025-11-17 10:00:36,501 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:36,507 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:48,699 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:00:59,681 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:15,196 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:01:56,696 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:02:08,687 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:02:10,774 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:11,582 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 319
2025-11-17 10:02:11,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 10:02:13,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 214
2025-11-17 10:02:13,612 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:02:13,613 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:14,498 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:15,366 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:44,947 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:02:44,956 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:02:44,966 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:02:44,975 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:02:44,983 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:02:44,993 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:02:45,003 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:02:45,013 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:02:45,023 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 10:02:45,033 - ispa_next.appointments.models - DEBUG - Appointment Anastasia Huwald KLE-A 1413 WBA1V710805N01313 ohne Termin.
2025-11-17 10:02:45,044 - ispa_next.appointments.models - DEBUG - Appointment Samir Mougawaz KLE-JS 813 WBA2D710105C40715 ohne Termin.
2025-11-17 10:02:45,062 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:45,074 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:45,114 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-17 10:02:45,126 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-17 10:02:45,145 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-17 10:02:45,155 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-17 10:02:45,157 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:45,157 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:45,173 - ispa_next.main - DEBUG - Found 13 out of 36 appointments to process (configured limit: 15).
2025-11-17 10:02:45,174 - ispa_next.main - DEBUG - Processing 13 fresh appointments.
2025-11-17 10:02:45,174 - ispa_next.main - DEBUG - All appointments: K YL 248, LÖWN93, KLE F 404, KLE S 7711, GEL RG111, M-D-3722, KR-SW7373, GEL VW 25, Kle-FM-44e, KLE-UP-14, GEL P 706, KK-B 602, GEL BL777
2025-11-17 10:02:45,177 - ispa_next.main - DEBUG - 



2025-11-17 10:02:45,177 - ispa_next.main - DEBUG - starting with process 1 (K YL 248) of 13
2025-11-17 10:02:45,180 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:02:46,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:47,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 319
2025-11-17 10:02:47,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 214
2025-11-17 10:02:48,785 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:02:48,787 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:21,135 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:03:30,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:03:34,110 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:03:34,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:34,192 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:34,460 - ispa_next.functions - DEBUG - HU date already expired after 12 days.
2025-11-17 10:03:40,828 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:03:40,830 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:03:40,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:40,909 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:43,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:03:43,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:44,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:46,674 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:03:46,784 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:03:46,853 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:03:46,956 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:03:46,956 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:03:58,000 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:03:59,004 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:03:59,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:59,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:09,840 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:04:17,044 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:04:17,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:17,147 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:17,147 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:04:17,192 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:04:18,406 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:04:18,680 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:04:20,717 - ispa_next.functions - DEBUG - Updated appointment (AV00009507) customer contact data.
2025-11-17 10:04:21,626 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:04:21,629 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:04:22,602 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:04:22,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:04:23,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:04:26,916 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:04:26,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:27,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:29,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:04:29,540 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:04:29,652 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:04:29,748 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:04:29,750 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:04:41,418 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:04:48,415 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:04:48,417 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:04:52,603 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:04:53,607 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:04:53,610 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:04:53,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:53,692 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:04:57,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:58,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:58,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:59,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:59,055 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:05:02,021 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:05:02,023 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:05:02,912 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:05:02,913 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:05:02,917 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 10:05:02,919 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:05:02,921 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:05:02,926 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:05:02,926 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:05:02,928 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:05:02,931 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:05:02,932 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:05:02,936 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:05:02,938 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:05:02,939 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:05:02,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:06,166 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:05:06,168 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:05:06,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:09,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:09,564 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:05:18,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:31,212 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:05:31,213 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:05:31,215 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:05:31,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:34,553 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 10:05:43,538 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:05:56,776 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:05:57,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:05:58,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:05:58,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:05,537 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:06:12,052 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:06:12,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:06:12,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:06:12,861 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:06:12,866 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:06:16,337 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:06:27,052 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:06:27,435 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:06:28,476 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:06:29,111 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 319
2025-11-17 10:06:29,111 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:06:31,531 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-17 10:06:31,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:06:32,123 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:06:32,129 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:06:32,135 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:06:32,140 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:06:32,145 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:06:32,151 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:06:32,157 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:06:32,162 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:06:32,167 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 10:06:32,173 - ispa_next.appointments.models - DEBUG - Appointment Anastasia Huwald KLE-A 1413 WBA1V710805N01313 ohne Termin.
2025-11-17 10:06:32,175 - ispa_next.main - DEBUG - 



2025-11-17 10:06:32,175 - ispa_next.main - DEBUG - starting with process 2 (LÖWN93) of 13
2025-11-17 10:06:32,178 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:06:33,103 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:06:33,921 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 319
2025-11-17 10:06:33,923 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 10:06:35,048 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:06:35,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:06:59,947 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:07:09,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:12,309 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:07:12,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:12,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:07:12,710 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:07:12,713 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:07:12,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:12,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:07:15,972 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:07:15,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:16,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:18,939 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:07:19,035 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:07:19,157 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:07:19,218 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:07:19,219 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:07:30,299 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:07:31,304 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:07:31,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:31,804 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:45,306 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:07:52,430 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:07:52,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:52,523 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:07:52,524 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:07:52,565 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:07:53,717 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:07:54,785 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:07:55,047 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:07:57,141 - ispa_next.functions - DEBUG - Updated appointment (BZ00002133) customer contact data.
2025-11-17 10:07:58,094 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:07:58,097 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:07:58,970 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:07:58,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:07:59,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:08:03,289 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:03,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:03,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:05,778 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:05,886 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:08:05,995 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:08:06,064 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:08:06,066 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:08:16,755 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:08:23,883 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:08:23,884 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:08:28,105 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:08:29,112 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:08:29,116 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:08:29,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:29,181 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:08:34,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:35,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:35,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:36,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:36,028 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:08:39,094 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:08:39,095 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:08:40,062 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:08:40,066 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:08:40,070 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:08:40,078 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:08:40,084 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:08:40,086 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:08:40,088 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:08:40,092 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:08:40,094 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:08:40,097 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:08:40,099 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:08:40,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:08:41,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:08:48,278 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:08:48,280 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:08:48,283 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:08:48,284 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:52,223 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:08:52,223 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:08:52,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:56,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:56,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:05,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:18,961 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:09:18,963 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:09:18,964 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:09:18,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:22,956 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 10:09:31,186 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:09:43,436 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:09:44,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:09:44,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:09:44,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:51,865 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:09:57,400 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:09:57,400 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:58,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:09:58,156 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:09:58,158 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:10:02,005 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:10:10,359 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:10:10,753 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:10:12,085 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:12,694 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 319
2025-11-17 10:10:12,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:15,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-17 10:10:15,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:16,449 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:10:16,457 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:10:16,476 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:10:16,482 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:10:16,489 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:10:16,496 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:10:16,502 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:10:16,508 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:10:16,516 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 10:10:16,524 - ispa_next.appointments.models - DEBUG - Appointment Anastasia Huwald KLE-A 1413 WBA1V710805N01313 ohne Termin.
2025-11-17 10:10:16,526 - ispa_next.main - DEBUG - 



2025-11-17 10:10:16,526 - ispa_next.main - DEBUG - starting with process 3 (KLE F 404) of 13
2025-11-17 10:10:16,529 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:17,757 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:18,925 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 319
2025-11-17 10:10:18,927 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 10:10:20,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:20,488 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:55,085 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:11:04,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:05,696 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:11:05,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:05,779 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:05,983 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:11:05,987 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:11:05,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:06,188 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:09,630 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:09,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:10,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:12,936 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:11:13,053 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:11:16,255 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:11:16,343 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:11:16,343 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:11:27,485 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:11:28,489 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:11:28,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:28,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:40,458 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:11:47,535 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:11:47,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:47,598 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:47,601 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:11:47,644 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:11:48,879 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:11:50,100 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:11:50,322 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:11:52,303 - ispa_next.functions - DEBUG - Updated appointment (GL00000003) customer contact data.
2025-11-17 10:11:53,215 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:11:53,216 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:11:53,759 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:11:53,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:11:54,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:11:58,164 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:58,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:58,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:00,699 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:12:00,798 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:12:00,878 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:12:00,970 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:12:00,971 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:11,781 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:12:18,748 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:12:18,749 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:12:22,927 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:12:23,934 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:12:23,938 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:12:23,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:24,018 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:12:28,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:28,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:28,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:29,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:29,630 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:12:30,941 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:12:30,945 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:12:31,953 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:12:31,955 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:12:31,959 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:12:31,960 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:12:31,964 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:12:31,965 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:12:31,966 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:12:31,970 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:12:31,970 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:12:31,974 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:12:31,984 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:12:32,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:12:33,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:12:40,368 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:12:40,370 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:12:40,373 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:12:40,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:42,298 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:12:42,299 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:12:42,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:44,171 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:12:44,175 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:12:44,177 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:12:44,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:46,036 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:12:57,024 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:12:57,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:12:58,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:12:58,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:04,252 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:13:10,343 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:13:10,345 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:11,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:13:11,095 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:13:11,099 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:13:14,709 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:13:23,513 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:13:23,900 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:13:24,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:25,406 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:13:25,406 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:28,545 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 10:13:28,546 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:13:29,380 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:13:29,388 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:13:29,395 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:13:29,402 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:13:29,409 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:13:29,416 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:13:29,422 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:13:29,430 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:13:29,437 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:13:29,447 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 10:13:29,452 - ispa_next.main - DEBUG - 



2025-11-17 10:13:29,452 - ispa_next.main - DEBUG - starting with process 4 (KLE S 7711) of 13
2025-11-17 10:13:29,455 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:30,366 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:31,293 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:13:31,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 10:13:32,584 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:32,585 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:07,735 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:14:17,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:19,571 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:14:19,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:19,684 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:19,893 - ispa_next.functions - DEBUG - HU date already expired after 17 days.
2025-11-17 10:14:26,288 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:14:26,292 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:14:26,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:26,349 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:29,312 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:14:29,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:30,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:32,388 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:14:32,505 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:14:32,616 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:14:32,687 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:14:32,687 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:14:43,557 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:14:50,550 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:14:50,551 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:14:54,722 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:14:55,728 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:14:55,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:56,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:11,342 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:15:18,453 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:15:18,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:18,549 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:18,557 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:15:18,589 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:15:19,776 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:15:20,007 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:15:22,025 - ispa_next.functions - DEBUG - Updated appointment (EO00000022) customer contact data.
2025-11-17 10:15:22,945 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:15:22,946 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:15:23,753 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:15:23,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:15:24,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:15:28,961 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:28,961 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:15:28,965 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:15:28,967 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:15:28,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:29,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:29,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:30,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:30,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:30,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:30,954 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:15:32,896 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:15:32,896 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:15:34,431 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:15:34,433 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:15:34,437 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 10:15:34,439 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:15:34,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:15:34,443 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:15:34,459 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:15:34,461 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:15:34,465 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:15:34,469 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:15:34,473 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:15:34,483 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:15:34,485 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:15:34,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:36,415 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:15:36,417 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:15:36,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:38,380 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:15:38,380 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:15:38,382 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:15:38,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:40,247 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:15:53,687 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:15:54,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:15:55,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:15:55,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:01,395 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:16:07,304 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:16:07,306 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:16:07,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:16:08,063 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:16:08,066 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:16:11,547 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:16:19,840 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:16:20,213 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:16:21,025 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:16:21,862 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:16:21,864 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:16:25,181 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 10:16:25,182 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:16:25,988 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:16:25,996 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:16:26,004 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:16:26,011 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:16:26,018 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:16:26,026 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:16:26,033 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:16:26,038 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:16:26,046 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:16:26,056 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 10:16:26,059 - ispa_next.main - DEBUG - 



2025-11-17 10:16:26,059 - ispa_next.main - DEBUG - starting with process 5 (GEL RG111) of 13
2025-11-17 10:16:26,063 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:16:27,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:16:28,489 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:16:28,490 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 10:16:30,079 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:16:30,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:16:56,037 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:17:06,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:07,525 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:17:07,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:07,591 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:17:07,824 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:17:07,828 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:17:07,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:07,955 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:17:11,153 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:17:11,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:17:12,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:17:14,372 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:17:14,501 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:17:14,620 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:17:14,687 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:17:14,689 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:25,583 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:17:33,010 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:17:33,011 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:17:37,189 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:17:38,194 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:17:38,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:38,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:48,075 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:17:55,452 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:17:55,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:55,548 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:17:55,549 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:17:55,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:17:56,868 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:17:57,099 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:17:59,381 - ispa_next.functions - DEBUG - Updated appointment (BT00003583) customer contact data.
2025-11-17 10:18:00,275 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:18:00,277 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:18:01,163 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:18:01,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:18:01,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:18:05,597 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:18:05,598 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:18:05,601 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:18:05,604 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:18:05,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:06,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:11,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:12,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:12,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:13,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:13,601 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:18:14,931 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:18:14,933 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:18:16,052 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:18:16,054 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:16,061 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:18:16,063 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:16,065 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:18:16,073 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:18:16,075 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:18:16,085 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:18:16,087 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:18:16,091 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:18:16,093 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:18:16,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:18:17,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:18:24,678 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:18:24,680 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:18:24,682 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:18:24,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:26,640 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:18:26,640 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:18:26,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:28,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:28,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:40,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:52,129 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:18:52,131 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:18:52,133 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:18:52,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:54,114 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:19:07,403 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:19:08,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:08,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:19:08,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:15,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:21,533 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:19:21,533 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:22,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:22,167 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:19:22,167 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:19:25,359 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:19:32,129 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:19:32,534 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:19:33,905 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:34,694 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 321
2025-11-17 10:19:34,706 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:38,094 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 217
2025-11-17 10:19:38,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:38,769 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:19:38,775 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:19:38,781 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:19:38,789 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:19:38,795 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:19:38,801 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:19:38,809 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:19:38,816 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:19:38,823 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:19:38,828 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:19:38,830 - ispa_next.main - DEBUG - 



2025-11-17 10:19:38,831 - ispa_next.main - DEBUG - starting with process 6 (M-D-3722) of 13
2025-11-17 10:19:38,833 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:39,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:40,647 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 321
2025-11-17 10:19:40,648 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 217
2025-11-17 10:19:42,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:42,300 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:20:11,164 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:20:22,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:27,105 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:20:27,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:27,175 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:27,371 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:20:27,373 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:20:27,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:27,434 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:30,497 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:30,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:31,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:33,908 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:20:34,000 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:20:34,119 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:20:34,176 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:20:34,176 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:20:45,667 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:20:46,673 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:20:46,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:47,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:02,278 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:21:10,845 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:21:10,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:10,935 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:10,937 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:21:10,974 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:21:12,210 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:21:13,217 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:21:13,419 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:21:15,271 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:21:15,282 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:21:16,117 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:21:16,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:21:16,938 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:21:20,533 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:20,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:21,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:23,228 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:21:23,372 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:21:23,488 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:21:23,543 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:21:23,543 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:21:34,342 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:21:41,609 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:21:41,609 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:21:43,785 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:21:44,791 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:21:44,794 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:21:44,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:44,894 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:21:50,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:50,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:50,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:51,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:51,586 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:21:55,746 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:21:55,749 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:21:56,938 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:21:56,943 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:56,948 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:21:56,951 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:56,955 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:21:56,956 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:21:56,957 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:21:56,961 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:21:56,963 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:21:56,966 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:21:56,969 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:21:57,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:21:58,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:22:05,153 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:22:05,156 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:22:05,157 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:22:05,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:10,496 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:22:10,497 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:22:10,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:15,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:16,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:25,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:40,794 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:22:40,795 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:22:40,795 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:22:40,807 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:46,519 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 10:22:55,611 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:23:09,897 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:23:10,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:11,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:23:11,203 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:20,155 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:25,703 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:23:25,703 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:26,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:26,588 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:23:26,588 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:23:30,105 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:23:48,854 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:23:52,211 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:23:52,213 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:52,612 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 321
2025-11-17 10:23:52,612 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:55,478 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 10:23:55,479 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:56,344 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:23:56,352 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:23:56,360 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:23:56,368 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:23:56,375 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:23:56,382 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:23:56,390 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:23:56,397 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:23:56,405 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:23:56,413 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:23:56,416 - ispa_next.main - DEBUG - 



2025-11-17 10:23:56,416 - ispa_next.main - DEBUG - starting with process 7 (KR-SW7373) of 13
2025-11-17 10:23:56,420 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:57,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:58,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 321
2025-11-17 10:23:58,855 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 10:24:00,397 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:00,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:28,066 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:24:41,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:45,921 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:24:45,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:45,994 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:46,325 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:24:46,327 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:24:46,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:46,398 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:49,572 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:49,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:50,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:52,703 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:52,806 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:52,943 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:53,010 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:53,010 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:25:04,643 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:25:05,648 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:25:05,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:06,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:14,950 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:25:21,753 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:25:21,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:21,824 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:21,824 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:25:21,925 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:25:23,177 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:25:23,436 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:25:25,886 - ispa_next.functions - DEBUG - Updated appointment (FC00000042) customer contact data.
2025-11-17 10:25:27,291 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:25:27,293 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:25:28,194 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:25:28,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:25:29,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:25:32,719 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:32,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:33,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:35,230 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:25:35,341 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:25:35,436 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:25:35,520 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:25:35,520 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:25:46,971 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:26:46,974 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:58,527 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:27:28,531 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:27:39,651 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:27:46,394 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:27:47,399 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:27:47,401 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:27:47,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:47,541 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:27:51,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:52,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:52,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:52,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:52,920 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:27:57,174 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:27:57,176 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:27:58,122 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:27:58,124 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:58,128 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:27:58,132 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:58,136 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:27:58,136 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:27:58,138 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:27:58,141 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:27:58,142 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:27:58,145 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:27:58,147 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:27:58,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:27:59,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:28:06,393 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:28:06,396 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:28:06,397 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:28:06,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:11,822 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:28:11,824 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:28:11,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:17,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:17,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:26,341 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:41,877 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:28:41,879 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:28:41,880 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:28:41,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:47,302 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 10:28:56,511 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:29:08,302 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:29:08,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:09,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:29:09,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:18,788 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:24,383 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:29:24,383 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:24,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:24,989 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:29:24,991 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:29:28,792 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:29:37,700 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:29:38,079 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:29:39,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:29:40,511 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 321
2025-11-17 10:29:40,511 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:29:43,901 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 10:29:43,902 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:29:44,786 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:29:44,794 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:29:44,801 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:29:44,808 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:29:44,814 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:29:44,821 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:29:44,828 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:29:44,835 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:29:44,842 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:29:44,848 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:29:44,852 - ispa_next.main - DEBUG - 



2025-11-17 10:29:44,852 - ispa_next.main - DEBUG - starting with process 8 (GEL VW 25) of 13
2025-11-17 10:29:44,856 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:45,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:29:47,089 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 321
2025-11-17 10:29:47,090 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 10:29:49,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:29:49,131 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:21,073 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:30:31,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:34,947 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:30:34,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:35,020 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:35,320 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:30:35,322 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:30:35,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:35,415 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:46,396 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:30:46,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:47,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:30:49,738 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:30:49,853 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:30:49,986 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:30:50,058 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:30:50,058 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:01,569 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:31:02,573 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:31:02,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:03,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:14,460 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:31:22,205 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:31:22,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:22,292 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:22,293 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:31:22,363 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:31:23,580 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:31:23,868 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:31:25,950 - ispa_next.functions - DEBUG - Updated appointment (BT00003580) customer contact data.
2025-11-17 10:31:26,971 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:31:26,973 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:31:28,031 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:31:28,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:31:28,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:31:32,590 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:31:32,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:33,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:35,099 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:31:35,215 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:31:35,308 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:31:35,371 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:31:35,371 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:46,480 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:31:53,565 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:31:53,565 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:31:57,808 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:31:58,819 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:31:58,822 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:31:58,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:59,022 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:31:59,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:59,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:59,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:00,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:32:00,617 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:32:03,639 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:32:03,641 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:32:04,658 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:32:04,668 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:32:04,676 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:32:04,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:32:04,682 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:32:04,692 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:32:04,700 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:32:04,706 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:32:04,708 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:32:04,714 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:32:04,718 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:32:05,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:32:06,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:32:13,234 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:32:13,236 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:32:13,237 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:32:13,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:17,307 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:32:17,309 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:32:17,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:21,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:21,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:32:30,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:44,665 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:32:44,668 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:32:44,669 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:32:44,672 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:48,855 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 10:32:58,422 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:33:12,776 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:33:13,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:33:14,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:33:14,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:22,875 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:33:28,970 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:33:28,972 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:33:29,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:33:29,699 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:33:29,699 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:33:33,266 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:33:42,047 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:33:42,421 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:33:43,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:33:44,862 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:33:44,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:33:48,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 10:33:48,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:33:49,366 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:33:49,372 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:33:49,379 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:33:49,391 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:33:49,398 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:33:49,405 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:33:49,413 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:33:49,422 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:33:49,431 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:33:49,440 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:33:49,444 - ispa_next.main - DEBUG - 



2025-11-17 10:33:49,444 - ispa_next.main - DEBUG - starting with process 9 (Kle-FM-44e) of 13
2025-11-17 10:33:49,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:33:50,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:33:51,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:33:51,619 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 10:33:52,883 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:33:52,884 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:34:23,562 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:34:33,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:39,347 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:34:39,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:39,410 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:34:39,634 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:34:39,637 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:34:39,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:39,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:34:42,882 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:34:42,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:44,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:46,056 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:34:46,161 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:34:46,266 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:34:46,329 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:34:46,329 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:58,379 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:34:59,385 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:34:59,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:59,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:12,909 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:35:21,139 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:35:21,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:21,211 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:21,213 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:35:21,273 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:35:22,547 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:35:22,836 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:35:25,928 - ispa_next.functions - DEBUG - Updated appointment (EL00000016) customer contact data.
2025-11-17 10:35:26,861 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:35:26,868 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:35:27,882 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:35:27,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:35:28,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:35:32,495 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:32,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:32,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:34,987 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:35:35,113 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:35:35,245 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:35:35,347 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:35:35,347 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:35:46,273 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:35:53,886 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:35:53,886 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:35:56,026 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:35:57,123 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:35:57,126 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:35:57,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:57,341 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:36:06,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:07,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:07,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:08,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:08,078 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:36:13,543 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:36:13,547 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:36:14,739 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:36:14,741 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:36:14,745 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 10:36:14,750 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:36:14,752 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:36:14,760 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:36:14,762 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:36:14,766 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:36:14,766 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:36:14,769 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:36:14,771 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:36:17,418 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:17,939 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:18,883 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:19,479 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:20,009 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:20,915 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:21,489 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:22,020 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:22,925 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:23,495 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:24,027 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:24,979 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:25,522 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:26,090 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:27,013 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:27,570 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:28,118 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:29,071 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:29,671 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:30,203 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:31,151 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:31,699 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:32,275 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:36:33,898 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:35,149 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:36:36,273 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:36:37,080 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:36:37,102 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:36:37,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:42,605 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:36:45,511 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:36:45,513 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:36:45,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:50,964 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:36:50,965 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:36:50,966 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:36:50,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:56,478 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:37:08,015 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:37:08,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:37:09,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:37:09,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:20,434 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:37:26,977 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:37:26,979 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:37:27,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:37:27,783 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:37:27,785 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:37:32,100 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:37:40,886 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:37:41,289 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:37:42,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:37:43,149 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:37:43,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:37:46,858 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 10:37:46,859 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:37:47,731 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:37:47,738 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:37:47,745 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:37:47,752 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:37:47,759 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:37:47,766 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:37:47,773 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:37:47,783 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:37:47,792 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:37:47,799 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:37:47,802 - ispa_next.main - DEBUG - 



2025-11-17 10:37:47,802 - ispa_next.main - DEBUG - starting with process 10 (KLE-UP-14) of 13
2025-11-17 10:37:47,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:37:49,045 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:37:50,377 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:37:50,378 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 10:37:52,028 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:37:52,029 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:38:32,759 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:38:42,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:45,431 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:38:45,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:45,523 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:38:45,750 - ispa_next.functions - DEBUG - HU date already expired after 5 days.
2025-11-17 10:38:52,718 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:38:52,721 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:38:52,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:52,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:38:56,033 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:38:56,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:38:57,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:38:59,443 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:38:59,584 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:38:59,676 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:38:59,770 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:38:59,770 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:39:11,044 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:39:12,049 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:39:12,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:12,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:26,142 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:39:34,387 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:39:34,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:34,486 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:39:34,488 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:39:34,518 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:39:35,763 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:39:36,019 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:39:38,705 - ispa_next.functions - DEBUG - Updated appointment (DH00000165) customer contact data.
2025-11-17 10:39:39,727 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:39:39,729 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:39:40,541 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:39:40,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:39:41,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:39:46,520 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:39:46,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:47,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:49,196 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:39:49,345 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:39:49,424 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:39:49,513 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:39:49,513 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:40:00,900 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:41:00,902 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:41:12,618 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:41:33,628 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:41:45,092 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:41:52,983 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:41:53,988 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:41:53,991 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:41:53,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:54,068 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:41:59,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:00,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:00,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:42:00,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:42:00,948 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:42:03,993 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:42:03,998 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:42:05,359 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:42:05,359 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:05,364 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:42:05,371 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:05,375 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:42:05,377 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:42:05,379 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:42:05,383 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:42:05,383 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:42:05,387 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:42:05,389 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:42:06,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:42:06,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:42:13,886 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:42:13,889 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:42:13,891 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:42:13,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:17,972 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:42:17,974 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:42:17,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:22,007 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:42:22,007 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:42:22,010 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:42:22,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:25,975 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:42:38,160 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:42:38,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:39,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:42:39,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:47,833 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:53,984 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:53,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:54,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:54,633 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:54,635 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:42:58,533 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:43:07,279 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:43:07,666 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:43:08,780 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:09,484 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:43:09,485 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:12,284 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 10:43:12,285 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:12,954 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:43:12,961 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:43:12,967 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:43:12,974 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:43:12,980 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:43:12,987 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:43:12,992 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:43:12,999 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:43:13,007 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:43:13,015 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:43:13,017 - ispa_next.main - DEBUG - 



2025-11-17 10:43:13,017 - ispa_next.main - DEBUG - starting with process 11 (GEL P 706) of 13
2025-11-17 10:43:13,020 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:13,963 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:14,834 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:43:14,835 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 10:43:16,261 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:16,262 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:56,715 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:44:07,545 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:11,530 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:44:11,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:11,617 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:11,812 - ispa_next.functions - DEBUG - HU date already expired after 732 days.
2025-11-17 10:44:19,393 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:44:19,395 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:44:19,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:19,489 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:22,718 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:22,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:24,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:26,020 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:26,234 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:26,325 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:26,434 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:44:26,445 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:44:37,874 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:44:38,879 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:44:38,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:39,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:52,152 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:45:00,455 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:45:00,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:00,561 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:00,563 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:45:00,614 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:45:01,885 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:45:02,129 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:45:05,390 - ispa_next.functions - DEBUG - Updated appointment (CS00000636) customer contact data.
2025-11-17 10:45:06,292 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:45:06,293 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:45:07,191 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:45:07,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:45:08,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:45:11,648 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:11,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:12,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:14,163 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:45:14,307 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:45:14,391 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:45:14,512 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:45:14,512 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:45:26,823 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:46:26,825 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:38,292 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:46:57,294 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:47:08,623 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:47:15,914 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:47:16,919 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:47:16,921 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:47:16,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:16,987 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:47:17,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:17,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:17,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:18,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:18,615 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:47:22,351 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:47:22,352 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:47:23,388 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:47:23,388 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:47:23,393 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=AU / § Hauptuntersuchung / Paketpreis, source=from_tab, target=cart), Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:47:23,399 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:47:23,405 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:47:23,409 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:47:23,409 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:47:23,417 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 10:47:23,417 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:47:23,421 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:47:23,423 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:47:24,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:47:24,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:47:43,296 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:47:43,298 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:47:46,059 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:47:46,584 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:47:47,505 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:47:48,100 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:47:48,669 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:47:49,608 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:47:50,172 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:47:50,707 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:47:51,668 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:47:52,231 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:47:52,774 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:47:54,641 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:47:55,225 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:47:55,747 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:47:57,685 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:47:58,275 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:47:58,828 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:47:59,760 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:48:00,328 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:48:00,891 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:48:01,860 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:48:03,004 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:48:03,072 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:48:03,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:07,861 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:48:07,863 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:48:07,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:12,778 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:48:12,779 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:48:12,781 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:48:12,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:17,484 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:48:31,473 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:48:32,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:33,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:48:33,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:42,612 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:49,307 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:49,307 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:50,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:50,227 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:50,229 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:48:54,112 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:49:03,013 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:49:03,413 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:49:04,889 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:05,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:49:05,806 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:09,137 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 10:49:09,138 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:09,875 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:49:09,881 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:49:09,886 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:49:09,892 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:49:09,900 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:49:09,906 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:49:09,913 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:49:09,920 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:49:09,927 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:49:09,935 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:49:09,937 - ispa_next.main - DEBUG - 



2025-11-17 10:49:09,937 - ispa_next.main - DEBUG - starting with process 12 (KK-B 602) of 13
2025-11-17 10:49:09,940 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:10,835 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:12,036 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:49:12,037 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 10:49:13,746 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:13,747 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:50,122 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:50:01,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:10,480 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:50:10,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:10,544 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:10,749 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:50:10,752 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:50:10,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:10,838 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:13,949 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:13,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:15,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:17,309 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:17,451 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:17,575 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:17,664 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:17,664 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:29,182 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:50:30,185 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:50:30,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:30,681 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:43,732 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:50:52,295 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:50:52,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:52,373 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:52,375 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:50:52,424 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:50:53,635 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:50:54,863 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:50:55,113 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:50:59,599 - ispa_next.functions - DEBUG - Updated appointment (AA00073898) customer contact data.
2025-11-17 10:51:00,641 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:51:00,643 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:51:01,555 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:51:01,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:51:02,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:51:06,299 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:51:06,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:06,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:08,797 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:51:08,911 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:51:09,065 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:51:09,137 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:51:09,138 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:51:20,909 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:51:28,045 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:51:28,047 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:51:32,233 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:51:33,255 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:51:33,259 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:51:33,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:33,316 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:38,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:39,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:39,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:40,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:40,057 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:51:47,766 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:51:47,766 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:51:48,867 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:51:48,869 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:48,873 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 10:51:48,875 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:48,877 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:51:48,879 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:51:48,879 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:51:48,883 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:51:48,883 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:51:48,887 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:51:48,889 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:51:49,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:51:50,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:51:57,538 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:51:57,541 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:51:57,543 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:51:57,543 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:07,287 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:52:07,289 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:52:07,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:17,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:52:17,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:52:29,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:48,543 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:52:48,545 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:52:48,545 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:52:48,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:58,591 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 10:53:07,407 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:53:22,483 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:53:23,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:53:23,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:53:23,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:34,903 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:53:34,904 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 10:53:37,299 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:53:37,299 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 10:53:40,829 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:53:40,829 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 10:53:46,359 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:53:46,360 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 10:53:55,845 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:53:55,845 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 10:54:13,097 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:54:13,811 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 10:54:13,905 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:54:13,907 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:14,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:14,567 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:54:14,569 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:54:14,589 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:54:18,849 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:54:18,851 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:19,435 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:54:19,437 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:22,961 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 10:54:22,962 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:54:23,772 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:54:23,779 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:54:23,787 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:54:23,794 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:54:23,800 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:54:23,807 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:54:23,818 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:54:23,825 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:54:23,832 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:54:23,839 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 10:54:23,841 - ispa_next.main - DEBUG - 



2025-11-17 10:54:23,842 - ispa_next.main - DEBUG - starting with process 13 (GEL BL777) of 13
2025-11-17 10:54:23,845 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:25,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:54:26,267 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:54:26,268 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 10:54:27,949 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:54:27,950 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:54:57,076 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:55:07,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:07,725 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:55:07,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:07,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:08,133 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:55:15,159 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:55:15,162 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:55:15,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:15,266 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:26,824 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:26,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:31,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:33,037 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:55:33,166 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:55:36,444 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:55:36,578 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:55:36,578 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:55:50,415 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:55:51,420 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:55:51,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:52,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:07,059 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:56:15,322 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:56:15,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:15,402 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:56:15,402 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:56:15,492 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:56:16,788 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:56:17,890 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:56:19,258 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:56:19,546 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:56:22,325 - ispa_next.functions - DEBUG - Updated appointment (DD00000192) customer contact data.
2025-11-17 10:56:23,359 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:56:23,361 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:56:24,158 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:56:24,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:56:25,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:56:29,573 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:56:29,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:30,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:32,308 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:56:32,418 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:56:32,517 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:56:32,616 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:56:32,616 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:56:43,822 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:56:51,166 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:56:51,166 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:56:55,388 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:56:56,408 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:56:56,436 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:56:56,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:56,527 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:56:56,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:57,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:57,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:58,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:58,020 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:57:01,754 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:57:01,755 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:57:03,176 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:57:03,178 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:03,180 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 10:57:03,182 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:57:03,182 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:03,187 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:57:03,187 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:57:03,189 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:57:03,192 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:57:03,193 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:57:03,196 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:57:03,198 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:57:03,200 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:57:03,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:07,211 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:57:07,213 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:57:07,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:11,279 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:57:11,280 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:57:11,281 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:57:11,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:15,371 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:57:29,297 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:33,471 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 10:57:33,474 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:57:34,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:57:35,135 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:57:35,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:44,009 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:50,722 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:57:50,724 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:51,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:57:51,548 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:57:51,550 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:57:55,002 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:58:04,950 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:58:05,346 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:58:06,325 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:58:07,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 10:58:07,108 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:58:10,544 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 10:58:10,544 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:11,223 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 10:58:11,229 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 10:58:11,235 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 10:58:11,241 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 10:58:11,247 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 10:58:11,254 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 10:58:11,261 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 10:58:11,268 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 10:58:11,275 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 10:58:11,305 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
