2025-11-12 07:26:07,011 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:26:07,017 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:26:20,182 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:26:30,809 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:26:46,578 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:27:10,530 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:27:22,309 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:27:24,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:25,464 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:27:25,465 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:27:27,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 07:27:27,392 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:27:27,392 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:27:28,254 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:27:29,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:00,113 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 07:28:00,136 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 07:28:00,145 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 07:28:00,152 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 07:28:00,168 - ispa_next.main - DEBUG - Found 15 out of 38 appointments to process (configured limit: 15).
2025-11-12 07:28:00,169 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-12 07:28:00,169 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 07:28:00,169 - ispa_next.main - DEBUG - All appointments: BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE, HF-JC 8820, HF-C 213, HF-C 213, HF-H 2227E, HF-AV 404, HF-GE 123, OS-BO 693, HF-EO 550E
2025-11-12 07:28:00,172 - ispa_next.main - DEBUG - 



2025-11-12 07:28:00,173 - ispa_next.main - DEBUG - starting with process 1 (BÜNDE) of 15
2025-11-12 07:28:00,176 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:28:01,946 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:03,676 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:28:03,678 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 07:28:05,060 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:05,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:38,906 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:28:39,004 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:28:39,007 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:39,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:28:39,557 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:41,425 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:28:41,426 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:42,066 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:28:42,070 - ispa_next.main - DEBUG - 



2025-11-12 07:28:42,070 - ispa_next.main - DEBUG - starting with process 2 (HF-LB-222) of 15
2025-11-12 07:28:42,073 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:28:42,900 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:43,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:28:43,970 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:28:45,359 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:45,360 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:16,254 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:29:16,263 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:29:16,267 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:29:16,709 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:29:16,711 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:29:19,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:29:19,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:19,825 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:29:19,828 - ispa_next.main - DEBUG - 



2025-11-12 07:29:19,828 - ispa_next.main - DEBUG - starting with process 3 (HF L 1612) of 15
2025-11-12 07:29:19,832 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:21,070 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:29:22,232 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:29:22,233 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:29:23,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:29:23,647 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:54,666 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:29:54,675 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:29:54,679 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:29:55,101 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:29:55,102 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:29:57,639 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:29:57,640 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:58,420 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:29:58,423 - ispa_next.main - DEBUG - 



2025-11-12 07:29:58,423 - ispa_next.main - DEBUG - starting with process 4 (OS-CW177) of 15
2025-11-12 07:29:58,427 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:59,472 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:00,672 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:30:00,673 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:30:02,051 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:02,052 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:39,228 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:30:39,238 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:30:39,242 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:39,678 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:30:39,679 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:41,852 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:30:41,853 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:42,723 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:30:42,730 - ispa_next.main - DEBUG - 



2025-11-12 07:30:42,730 - ispa_next.main - DEBUG - starting with process 5 (HF-BT 540) of 15
2025-11-12 07:30:42,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:30:43,845 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:44,982 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:30:44,983 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:30:46,348 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:46,349 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:31:08,289 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:31:18,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:22,066 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:31:22,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:22,146 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:31:22,379 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:31:22,383 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:31:22,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:22,474 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:31:25,476 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:31:25,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:26,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:31:28,528 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:31:28,628 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:31:31,875 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:31:31,944 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:31:31,944 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:31:40,183 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:31:41,188 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:31:41,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:41,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:53,200 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:31:53,200 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:31:59,966 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:31:59,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:00,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:32:00,050 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:32:00,136 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:32:01,311 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:32:01,632 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:32:04,933 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 07:32:05,843 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:32:05,845 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:32:06,424 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:32:06,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:32:07,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:32:10,630 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:32:10,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:11,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:32:13,154 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:32:13,291 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:32:13,411 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:32:13,506 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:32:13,506 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:32:24,952 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:32:29,097 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:32:29,097 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:32:33,248 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:32:34,269 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:32:34,272 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:32:34,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:34,360 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:32:43,700 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:32:48,873 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:32:48,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:49,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:49,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:50,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:32:50,151 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:32:53,815 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:32:53,817 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:32:54,940 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:32:54,943 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:32:54,946 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:32:54,950 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:32:54,952 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 07:32:54,953 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:32:54,955 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:32:54,957 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:32:54,958 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:32:54,959 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:32:54,960 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:32:54,962 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:32:54,964 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 07:33:16,973 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 07:33:16,997 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:33:16,999 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:33:17,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:33:18,541 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:33:18,542 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:33:18,563 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:33:21,000 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:33:21,002 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:33:21,312 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:33:21,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:33:24,005 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:33:24,006 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:33:24,830 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:33:24,833 - ispa_next.main - DEBUG - 



2025-11-12 07:33:24,833 - ispa_next.main - DEBUG - starting with process 6 (MI-JC 96 E) of 15
2025-11-12 07:33:24,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:33:25,637 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:33:26,375 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:33:26,376 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:33:27,475 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:33:27,476 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:34:01,506 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:34:01,515 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:34:01,518 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:34:01,995 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:34:01,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:34:04,442 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:34:04,443 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:34:05,287 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:34:05,290 - ispa_next.main - DEBUG - 



2025-11-12 07:34:05,290 - ispa_next.main - DEBUG - starting with process 7 (BÜNDE) of 15
2025-11-12 07:34:05,294 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:34:06,342 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:34:07,217 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:34:07,219 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:34:08,280 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:34:08,281 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:34:36,405 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:34:36,414 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:34:36,418 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:34:36,930 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:34:36,946 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:34:39,364 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:34:39,365 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:34:40,073 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:34:40,077 - ispa_next.main - DEBUG - 



2025-11-12 07:34:40,077 - ispa_next.main - DEBUG - starting with process 8 (HF-JC 8820) of 15
2025-11-12 07:34:40,082 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:34:40,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:34:42,051 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:34:42,052 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:34:43,357 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:34:43,358 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:35:06,798 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:35:08,503 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:35:13,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:14,526 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:35:14,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:14,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:35:14,760 - ispa_next.functions - DEBUG - HU date already expired after 1909 days.
2025-11-12 07:35:17,675 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:35:17,677 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:35:17,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:17,765 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:35:23,686 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:35:23,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:24,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:35:26,506 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:35:26,603 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:35:26,683 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:35:26,772 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:35:30,902 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:35:31,906 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:35:31,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:32,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:43,060 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:35:46,936 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:35:46,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:47,028 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:35:47,028 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:35:47,087 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:35:48,336 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:35:48,565 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:35:50,336 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:35:50,338 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:35:51,126 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:35:51,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:35:51,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:35:55,805 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 07:35:55,806 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:35:55,806 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:35:55,807 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:35:55,810 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:35:55,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:56,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:00,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:00,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:00,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:01,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:01,513 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:36:02,801 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:36:02,803 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:36:03,833 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:36:03,834 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:03,836 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:36:03,837 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:36:03,838 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:36:03,839 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:36:03,841 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:36:03,842 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:36:03,843 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:36:03,844 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:36:03,846 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:36:03,855 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:36:03,859 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:36:03,861 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:36:03,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:05,162 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:36:05,163 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:36:05,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:06,355 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:36:06,356 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:36:06,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:36:07,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:36:07,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:11,237 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:36:11,239 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:12,454 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:36:12,456 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:36:12,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:36:13,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:36:13,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:18,601 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:36:18,603 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:36:18,603 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:36:19,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:36:19,106 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:36:19,108 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:36:20,680 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:36:30,516 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:36:30,896 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:36:31,182 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:36:33,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:36:33,260 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:36:36,252 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:36:36,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:37,066 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:36:37,069 - ispa_next.main - DEBUG - 



2025-11-12 07:36:37,069 - ispa_next.main - DEBUG - starting with process 9 (HF-C 213) of 15
2025-11-12 07:36:37,072 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:36:38,147 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:36:39,284 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:36:39,285 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:36:40,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:36:40,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:37:03,696 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:37:05,649 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:37:10,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:12,628 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:37:12,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:12,721 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:12,970 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:37:12,972 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:37:12,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:13,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:19,835 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:37:19,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:20,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:22,825 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:37:22,924 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:37:23,024 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:37:23,112 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:37:27,340 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:37:28,346 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:37:28,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:28,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:38,171 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:37:41,938 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:37:41,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:42,015 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:42,015 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:37:42,059 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:37:42,156 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:37:43,344 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:37:43,554 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:37:44,810 - ispa_next.functions - DEBUG - Updated appointment (AI00015550) customer contact data.
2025-11-12 07:37:45,710 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:37:45,712 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:37:45,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:37:46,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:37:47,642 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:37:47,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:37:47,733 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:37:51,315 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:37:51,316 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:37:51,318 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:37:51,321 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:37:51,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:51,863 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:52,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:52,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:52,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:53,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:53,452 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:37:55,470 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:37:55,471 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:37:56,562 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:37:56,565 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:37:56,567 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:37:56,571 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:37:56,573 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:37:56,575 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:37:56,577 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:37:56,579 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:37:56,580 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:37:56,582 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:37:56,583 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:37:56,585 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:37:56,587 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:37:56,589 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:37:56,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:58,502 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:37:58,503 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:37:58,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:00,431 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:38:00,433 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:38:00,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:38:01,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:38:01,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:10,561 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:38:10,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:12,501 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:38:12,503 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:38:12,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:13,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:38:13,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:21,079 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:25,254 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:25,256 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:38:25,257 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:25,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:25,922 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:38:25,923 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:38:27,605 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:38:34,520 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:38:34,895 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:38:35,233 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:36,111 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:38:36,112 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:38,883 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:38:38,884 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:38:39,699 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:38:39,702 - ispa_next.main - DEBUG - 



2025-11-12 07:38:39,703 - ispa_next.main - DEBUG - starting with process 10 (HF-C 213) of 15
2025-11-12 07:38:39,708 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:40,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:41,924 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:38:41,925 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:38:43,274 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:43,276 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:05,375 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:39:07,501 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:39:12,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:39:14,278 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:39:14,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:14,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:14,590 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:39:14,593 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:39:14,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:14,707 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:21,532 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:39:21,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:39:22,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:39:24,549 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:39:24,649 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:39:24,760 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:39:24,858 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:39:29,025 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:39:30,030 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:39:30,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:30,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:40,156 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:39:43,744 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:39:43,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:43,821 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:43,822 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:39:43,870 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:39:43,992 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:39:45,442 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:39:45,660 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:39:46,953 - ispa_next.functions - DEBUG - Updated appointment (AF00021378) customer contact data.
2025-11-12 07:39:47,866 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:39:47,868 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:39:47,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:39:48,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:39:49,794 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:39:49,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:39:49,872 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:39:53,470 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:39:53,470 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:39:53,472 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:39:53,474 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:39:53,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:39:53,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:39:54,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:54,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:54,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:39:55,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:39:55,630 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:39:57,577 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:39:57,579 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:39:58,533 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:39:58,537 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:39:58,540 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:39:58,542 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:39:58,544 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:39:58,545 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:39:58,547 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:39:58,548 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:39:58,549 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:39:58,551 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:39:58,551 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:39:58,553 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:39:58,556 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:39:58,557 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:39:58,557 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:00,449 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:40:00,450 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:40:00,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:02,361 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:40:02,363 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:40:02,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:40:03,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:40:03,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:12,451 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:40:12,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:14,344 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:40:14,345 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:40:14,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:40:15,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:40:15,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:21,027 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:40:25,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:40:25,040 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:40:25,041 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:40:25,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:40:25,774 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:40:25,775 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:40:27,303 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:40:34,156 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:40:34,551 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:40:34,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:40:35,852 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:40:35,854 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:40:38,760 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:40:38,761 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:40:39,537 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:40:39,540 - ispa_next.main - DEBUG - 



2025-11-12 07:40:39,540 - ispa_next.main - DEBUG - starting with process 11 (HF-H 2227E) of 15
2025-11-12 07:40:39,543 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:40:40,698 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:40:42,638 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:40:42,639 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:40:44,618 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:40:44,620 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:41:08,682 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:41:10,432 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:41:15,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:21,805 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:41:21,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:21,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:41:22,052 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:41:22,054 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:41:22,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:22,167 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:41:25,255 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:41:25,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:26,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:28,081 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:41:28,183 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:41:28,273 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:41:28,345 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:41:32,493 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:41:33,496 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:41:33,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:33,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:47,854 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:41:51,869 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:41:51,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:51,977 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:41:51,978 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:41:52,021 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:41:53,249 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:41:54,435 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:41:54,656 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:41:56,324 - ispa_next.functions - DEBUG - Updated appointment (AA00044450) customer contact data.
2025-11-12 07:41:57,246 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:41:57,247 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:41:58,001 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:41:58,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:41:58,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:42:02,313 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:42:02,314 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:42:02,317 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:42:02,320 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:42:02,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:42:02,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:42:06,318 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 07:42:15,676 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:42:15,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:42:16,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:42:16,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:42:16,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:42:16,976 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:42:22,275 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:42:22,276 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:42:23,577 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:42:23,578 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:42:23,580 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:42:23,581 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:42:23,582 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:42:23,583 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:42:23,585 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:42:23,586 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:42:23,587 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:42:23,588 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:42:23,591 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:42:23,593 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:42:23,606 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:42:23,610 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:29,648 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:42:29,650 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:42:29,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:35,560 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:42:35,561 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:42:35,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:42:36,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:42:36,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:49,702 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:42:49,705 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:55,635 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:42:55,637 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:42:56,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:42:56,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:42:56,745 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:06,562 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:43:10,731 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:43:14,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:43:18,299 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:43:21,803 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:43:21,803 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:22,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:43:22,520 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:43:22,521 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:43:25,301 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:43:33,264 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:43:33,643 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:43:33,976 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:34,960 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:43:34,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:37,874 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:43:37,874 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:38,731 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:43:38,734 - ispa_next.main - DEBUG - 



2025-11-12 07:43:38,734 - ispa_next.main - DEBUG - starting with process 12 (HF-AV 404) of 15
2025-11-12 07:43:38,738 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:39,871 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:41,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:43:41,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:43:42,489 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:42,490 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:44:06,234 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:44:08,054 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:44:12,960 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:16,915 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:44:16,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:16,978 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:17,151 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 07:44:20,878 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:44:20,881 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:44:20,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:20,974 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:27,808 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:44:27,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:28,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:44:30,817 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:44:30,931 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:44:31,020 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:44:31,119 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:44:35,241 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:44:36,246 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:44:36,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:36,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:46,463 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:44:50,107 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:44:50,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:50,179 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:50,179 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:44:50,217 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:44:51,426 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:44:52,746 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:44:52,969 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:44:54,289 - ispa_next.functions - DEBUG - Updated appointment (AB00040183) customer contact data.
2025-11-12 07:44:55,207 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:44:55,209 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:44:55,877 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:44:55,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:44:56,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:45:00,312 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:45:00,312 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:45:00,315 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:45:00,318 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:45:00,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:00,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:45:04,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:04,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:04,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:05,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:45:05,638 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:45:09,226 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:45:09,227 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:45:10,300 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:45:10,302 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:45:10,306 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:45:10,307 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:45:10,308 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:45:10,309 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:45:10,329 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:45:10,331 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:45:10,334 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:45:10,336 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:45:10,337 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:45:10,339 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:45:10,341 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:45:10,345 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:45:10,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:14,295 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:45:14,297 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:45:14,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:18,229 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:45:18,231 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:45:18,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:45:18,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:45:19,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:27,932 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:45:27,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:31,854 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:45:31,856 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:45:32,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:45:32,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:45:32,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:40,583 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:45:45,380 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:45:49,280 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:45:54,209 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:45:59,298 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:45:59,299 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:45:59,307 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:45:59,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:46:00,017 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:46:00,019 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:46:01,790 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:46:09,169 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:46:09,548 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:46:10,021 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:46:11,039 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:46:11,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:46:14,208 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:46:14,209 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:46:15,101 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:46:15,104 - ispa_next.main - DEBUG - 



2025-11-12 07:46:15,104 - ispa_next.main - DEBUG - starting with process 13 (HF-GE 123) of 15
2025-11-12 07:46:15,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:46:16,085 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:46:17,327 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:46:17,329 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:46:18,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:46:18,834 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:46:51,227 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:46:53,118 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:46:58,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:02,649 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:47:02,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:02,748 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:47:02,961 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:47:02,964 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:47:02,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:03,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:47:06,107 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:47:06,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:07,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:09,268 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:47:09,410 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:47:09,525 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:47:09,638 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:47:13,803 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:47:14,808 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:47:14,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:15,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:26,791 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:47:26,791 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:47:30,496 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:47:30,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:30,589 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:47:30,590 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:47:30,633 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:47:31,839 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:47:33,026 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:47:33,250 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:47:34,625 - ispa_next.functions - DEBUG - Updated appointment (AF00021355) customer contact data.
2025-11-12 07:47:35,518 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:47:35,520 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:47:36,309 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:47:36,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:47:37,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:47:41,057 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:47:41,057 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:47:41,061 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:47:41,075 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:47:41,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:41,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:47,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:47,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:47,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:48,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:48,265 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:47:52,544 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:47:52,545 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:47:53,523 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:47:53,524 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:47:53,525 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:47:53,526 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:47:53,527 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:47:53,531 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:47:53,534 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:47:53,537 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:47:53,539 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:47:53,542 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:47:53,545 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:47:53,547 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:47:53,552 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:47:53,553 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:47:53,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:58,173 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:47:58,174 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:47:58,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:02,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:02,874 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:48:11,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:25,709 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:48:25,710 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:48:25,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:48:26,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:48:26,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:39,931 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:48:39,932 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:44,631 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:48:44,633 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:48:45,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:48:45,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:48:45,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:54,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:58,730 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:49:01,945 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:49:01,946 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:49:02,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:49:02,644 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:49:02,645 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:49:05,652 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:49:13,179 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:49:13,547 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:49:14,613 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:49:15,250 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 07:49:15,251 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:49:18,136 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:49:18,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:49:18,841 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:49:18,843 - ispa_next.main - DEBUG - 



2025-11-12 07:49:18,844 - ispa_next.main - DEBUG - starting with process 14 (OS-BO 693) of 15
2025-11-12 07:49:18,847 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:49:19,948 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:49:20,979 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 07:49:20,980 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:49:22,543 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:49:22,544 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:49:50,695 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:49:52,718 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:49:57,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:06,632 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:50:06,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:06,734 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:06,978 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:50:06,981 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:50:06,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:07,061 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:10,356 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:50:10,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:11,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:13,554 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:50:13,669 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:50:13,771 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:50:13,862 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:50:15,989 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:50:16,993 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:50:16,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:17,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:31,415 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:50:35,770 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:50:35,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:35,851 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:35,852 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:50:35,919 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:50:36,049 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:50:37,190 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:50:37,408 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:50:38,915 - ispa_next.functions - DEBUG - Updated appointment (AB00040597) customer contact data.
2025-11-12 07:50:40,151 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:50:40,217 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:50:40,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:50:41,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:50:42,074 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:50:42,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:50:42,176 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:50:45,746 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:50:45,746 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:50:45,750 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:50:45,753 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:50:45,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:46,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:49,844 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:51:01,796 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:51:02,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:51:03,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:51:03,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:51:03,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:51:03,747 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:51:11,307 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:51:11,319 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:51:12,783 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:51:12,788 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:51:12,790 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:51:12,791 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:51:12,792 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:51:12,794 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:51:12,795 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:51:12,797 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:51:12,798 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:51:12,799 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:51:12,801 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:51:12,802 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:51:12,805 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:51:12,807 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:51:12,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:21,620 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:51:21,622 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:51:21,624 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:30,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:51:30,300 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:51:39,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:57,533 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:51:57,536 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:51:57,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:51:58,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:51:58,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:18,167 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:52:18,168 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:26,942 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:52:26,944 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:52:27,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:52:28,022 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:52:28,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:41,248 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:46,306 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:49,847 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:52:49,848 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:52:50,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:52:50,567 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:52:50,568 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:52:53,547 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:53:02,035 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:53:02,419 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 07:53:03,499 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:53:04,158 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 07:53:04,159 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:53:07,293 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 348
2025-11-12 07:53:07,293 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:53:08,081 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:53:08,084 - ispa_next.main - DEBUG - 



2025-11-12 07:53:08,084 - ispa_next.main - DEBUG - starting with process 15 (HF-EO 550E) of 15
2025-11-12 07:53:08,088 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:53:09,269 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:53:10,183 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 07:53:10,184 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 348
2025-11-12 07:53:11,560 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:53:11,561 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:53:35,026 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:53:37,025 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:53:41,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:53:44,894 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:53:44,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:44,978 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:53:45,165 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:53:45,167 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:53:45,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:45,244 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:53:48,503 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:53:48,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:53:50,075 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:53:52,078 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:53:52,205 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:53:52,359 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:53:52,431 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:53:56,612 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:53:57,617 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:53:57,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:58,151 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:08,335 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:54:12,617 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:54:12,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:12,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:54:12,695 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:54:12,760 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:54:14,023 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:54:14,236 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:54:15,600 - ispa_next.functions - DEBUG - Updated appointment (AB00040564) customer contact data.
2025-11-12 07:54:16,514 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:54:16,527 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:54:17,151 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:54:17,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:54:17,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:54:22,005 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:54:22,005 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:54:22,008 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:54:22,011 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:54:22,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:22,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:54:31,271 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:54:40,825 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:54:40,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:41,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:41,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:42,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:54:42,295 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:54:45,356 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:54:45,358 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:54:46,479 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:54:46,481 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:46,483 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:54:46,485 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:54:46,488 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:54:46,490 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:46,492 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:54:46,510 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:54:46,511 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:54:46,514 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:54:46,518 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:54:46,520 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:54:46,522 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:54:46,524 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:54:46,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:49,834 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:54:49,837 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:54:49,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:53,111 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:54:53,112 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:54:53,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:54:53,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:54:54,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:06,080 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:55:06,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:09,348 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:55:09,349 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:55:09,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:55:10,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:55:10,611 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:18,049 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:21,823 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:25,805 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:30,555 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:55:30,557 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:55:30,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:55:31,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:55:31,319 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:55:31,320 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:55:33,000 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:55:40,761 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:55:41,137 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:55:41,972 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:55:42,627 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 609
2025-11-12 07:55:42,628 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:55:45,588 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 347
2025-11-12 07:55:45,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:55:46,434 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
