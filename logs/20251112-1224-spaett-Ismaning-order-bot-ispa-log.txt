2025-11-12 12:32:04,966 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:32:04,976 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:32:14,627 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:32:25,073 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:32:40,639 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:33:04,506 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:33:17,594 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:33:20,863 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:22,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:33:22,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:33:24,553 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 473
2025-11-12 12:33:24,554 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:33:24,555 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:33:25,570 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:33:26,682 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:36,201 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,275 - ispa_next.appointments.models - DEBUG - Appointment Livia Veitschegger M-V 5084 WBA61CM0908C93157 ohne Termin.
2025-11-12 12:34:36,303 - ispa_next.appointments.models - DEBUG - Appointment Thomas Löb M-L 5621 WBA8H71010A040968 ohne Termin.
2025-11-12 12:34:36,317 - ispa_next.appointments.models - DEBUG - Appointment Antonio Cavar ED-AC 1986 WBA6L31020FJ84465 ohne Termin.
2025-11-12 12:34:36,322 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,340 - ispa_next.appointments.models - DEBUG - Appointment Rebecca Hurst FS-RA 602 WMW31DH0902V63832 ohne Termin.
2025-11-12 12:34:36,347 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,347 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,348 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,350 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,350 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,362 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schulz M-S 7319 WBA61EE0605Y49885 ohne Termin.
2025-11-12 12:34:36,380 - ispa_next.appointments.models - DEBUG - Appointment Firma NEO - Professional Solutions GmbH M-N 917 WBS31AZ000CM52265 ohne Termin.
2025-11-12 12:34:36,402 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,419 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,419 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,420 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,439 - ispa_next.appointments.models - DEBUG - Appointment Faton Halilaj M-DF 1991 WBA6L51030FJ39031 ohne Termin.
2025-11-12 12:34:36,452 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,465 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,469 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,490 - ispa_next.appointments.models - DEBUG - Appointment Martin Lamprecht  WBA7K310807P56396 ohne Termin.
2025-11-12 12:34:36,490 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,503 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,533 - ispa_next.appointments.models - DEBUG - Appointment Josef Deimel M-LW 90 WBATX35040NC13555 ohne Termin.
2025-11-12 12:34:36,547 - ispa_next.appointments.models - DEBUG - Appointment Firma Panavia Aircraft GmbH FS-PA 85E WBA65GP040N362472 ohne Termin.
2025-11-12 12:34:36,578 - ispa_next.appointments.models - DEBUG - Appointment Meisterbetrieb Thomas Patitz  WBA21GW060CU43030 ohne Termin.
2025-11-12 12:34:36,594 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Hanika M-WH 6500 WBA4K31030BG88527 ohne Termin.
2025-11-12 12:34:36,613 - ispa_next.appointments.models - DEBUG - Appointment Nina Bernreuther M-NN 369 WMWLV310502L56279 ohne Termin.
2025-11-12 12:34:36,614 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,633 - ispa_next.appointments.models - DEBUG - Appointment Michaela Hartwig M-NR 9641 WBA2E510205G52370 ohne Termin.
2025-11-12 12:34:36,651 - ispa_next.appointments.models - DEBUG - Appointment Firma JTF Beratung und M-JT 700 WBA51AJ0X0CK76754 ohne Termin.
2025-11-12 12:34:36,668 - ispa_next.appointments.models - DEBUG - Appointment Ladislav Kilisek M-JO 1742 WBA2A310207A62139 ohne Termin.
2025-11-12 12:34:36,683 - ispa_next.appointments.models - DEBUG - Appointment Ihor Karnakov M-KA 5871E WBA6N31070FM27147 ohne Termin.
2025-11-12 12:34:36,713 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke AG M-NP 3316 WMW21GA0407S97954 ohne Termin.
2025-11-12 12:34:36,731 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Yazar M-YA 29 WBA6V710005P54227 ohne Termin.
2025-11-12 12:34:36,747 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-12 12:34:36,761 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-12 12:34:36,778 - ispa_next.appointments.models - DEBUG - Appointment Joachim Schubert M-JS 2161 WBA51AB0105U16063 ohne Termin.
2025-11-12 12:34:36,802 - ispa_next.appointments.models - DEBUG - Appointment Imer Jakupi M-LJ 1824 WBA11DY090FK02746 ohne Termin.
2025-11-12 12:34:36,820 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Wydra M-W 5397 WBAJC91010B280060 ohne Termin.
2025-11-12 12:34:36,834 - ispa_next.appointments.models - DEBUG - Appointment   WBABS51040EW00681 ohne Termin.
2025-11-12 12:34:36,848 - ispa_next.appointments.models - DEBUG - Appointment Erwin Jaksch M-EJ 69 WBABG11010ER37920 ohne Termin.
2025-11-12 12:34:36,864 - ispa_next.appointments.models - DEBUG - Appointment Eduard Grimm M-EG 3011 WBS1H91060V916418 ohne Termin.
2025-11-12 12:34:36,879 - ispa_next.appointments.models - DEBUG - Appointment Tarik Sahin M-X 3330 WBAJK51000BJ13877 ohne Termin.
2025-11-12 12:34:36,904 - ispa_next.appointments.models - DEBUG - Appointment Firma ACTRON AG ED-AG 444 WBA5R11080FN22370 ohne Termin.
2025-11-12 12:34:36,917 - ispa_next.appointments.models - DEBUG - Appointment Anja Goetzke M-AG 565 WBAJU810409L17973 ohne Termin.
2025-11-12 12:34:36,940 - ispa_next.appointments.models - DEBUG - Appointment Marco Hübl  WBA21EN0009X29619 ohne Termin.
2025-11-12 12:34:36,955 - ispa_next.appointments.models - DEBUG - Appointment Narayanaswamy Anand M-SN 554 WMWLV710302L69958 ohne Termin.
2025-11-12 12:34:36,971 - ispa_next.appointments.models - DEBUG - Appointment Soria-Vanessa Neumann FS-N 347 WBA2H71010VA14727 ohne Termin.
2025-11-12 12:34:36,972 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:34:36,990 - ispa_next.appointments.models - DEBUG - Appointment Firma ProSiebenSat.1 Media SE M-P 7308 E WBA21EF0405Z47312 ohne Termin.
2025-11-12 12:34:37,074 - ispa_next.main - DEBUG - Found 20 out of 294 appointments to process (configured limit: 20).
2025-11-12 12:34:37,075 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 12:34:37,075 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 12:34:37,075 - ispa_next.main - DEBUG - All appointments: M-C 9104, FS- , M-XM 6099E , M-RO 985 E, PF-DN 2121, M-NC 1407, AOIH412, M-S 8543 E, M-MM 3808, R-CK 696, M-ON-120, AS-MY550, FSSP640, H PT 7268, M-S 1739 E, M-K 1317, EBE-FA 502, M-DA 9696, M-P 5330, M-BD 1618
2025-11-12 12:34:37,078 - ispa_next.main - DEBUG - 



2025-11-12 12:34:37,078 - ispa_next.main - DEBUG - starting with process 1 (M-C 9104) of 20
2025-11-12 12:34:37,085 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:38,206 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:39,207 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:34:39,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 473
2025-11-12 12:34:40,693 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:40,694 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:23,154 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:35:23,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:35:23,246 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:23,742 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:35:23,742 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:26,161 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:35:26,162 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:26,985 - ispa_next.main - DEBUG - Found new Appointment: M-DR 2907
2025-11-12 12:35:26,987 - ispa_next.main - DEBUG - 



2025-11-12 12:35:26,987 - ispa_next.main - DEBUG - starting with process 2 (M-DR 2907) of 21
2025-11-12 12:35:26,992 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:35:28,084 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:29,052 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:35:29,053 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:35:30,200 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:30,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:51,929 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:35:53,548 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:35:57,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:58,032 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:58,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:00,085 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:36:00,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:00,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:36:00,339 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:36:00,345 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:36:03,088 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:36:03,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:04,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:06,007 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:36:06,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:36:06,224 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:36:06,284 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:36:06,284 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:36:14,525 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:36:15,532 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:36:15,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:16,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:28,294 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:36:31,527 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:36:31,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:31,595 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:36:31,595 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:36:31,662 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:36:31,761 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:36:32,835 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:36:34,045 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:36:34,445 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:36:35,966 - ispa_next.functions - DEBUG - Updated appointment (AA00023683) customer contact data.
2025-11-12 12:36:36,867 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:36:36,884 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:36:36,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:36:37,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:36:38,783 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:36:38,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:36:38,872 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:36:42,902 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:36:42,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:43,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:45,380 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:36:45,502 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:36:45,593 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:36:45,677 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:36:45,677 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:36:54,241 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:37:54,243 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:38:02,702 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:38:52,705 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:39:01,108 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:39:08,653 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:39:09,664 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:39:09,669 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:39:09,669 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 12:39:09,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:39:11,544 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:39:11,546 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:39:12,943 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:39:12,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:39:12,945 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:39:12,947 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:39:12,948 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:39:12,949 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:39:12,950 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:39:12,951 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:39:12,951 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:39:12,952 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:39:12,956 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:39:12,960 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:39:12,960 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:14,888 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:39:14,893 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:39:14,896 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:16,768 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:39:16,773 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:39:16,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:39:17,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:39:17,695 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:39:17,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:19,604 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:39:30,109 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:39:30,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:31,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:39:31,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:49,185 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:39:53,462 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:39:53,468 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:39:53,468 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:39:54,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:54,186 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:39:54,190 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:39:55,913 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:40:04,617 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:40:05,009 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:40:05,328 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:06,824 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:40:06,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:09,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:40:09,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:10,400 - ispa_next.main - DEBUG - 



2025-11-12 12:40:10,400 - ispa_next.main - DEBUG - starting with process 3 (FS- ) of 21
2025-11-12 12:40:10,406 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:11,678 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:12,824 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:40:12,825 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:40:14,264 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:14,266 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:52,725 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:40:52,737 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:40:52,741 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:53,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:40:53,191 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:55,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:40:55,471 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:56,130 - ispa_next.main - DEBUG - 



2025-11-12 12:40:56,131 - ispa_next.main - DEBUG - starting with process 4 (M-XM 6099E ) of 21
2025-11-12 12:40:56,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:57,171 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:58,426 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:40:58,427 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:40:59,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:59,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:28,764 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:41:28,778 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:41:28,784 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:29,285 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:41:29,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:31,621 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:41:31,622 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:32,293 - ispa_next.main - DEBUG - 



2025-11-12 12:41:32,293 - ispa_next.main - DEBUG - starting with process 5 (M-RO 985 E) of 21
2025-11-12 12:41:32,298 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:41:33,227 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:34,379 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:41:34,381 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:41:35,727 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:35,729 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:12,841 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:42:12,853 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:42:12,859 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:13,251 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:42:13,253 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:15,649 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:42:15,650 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:16,498 - ispa_next.main - DEBUG - 



2025-11-12 12:42:16,499 - ispa_next.main - DEBUG - starting with process 6 (PF-DN 2121) of 21
2025-11-12 12:42:16,505 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:42:17,637 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:18,464 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:42:18,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:42:19,636 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:19,637 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:48,320 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:42:48,330 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:42:48,336 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:48,714 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:42:48,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:51,046 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:42:51,047 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:51,875 - ispa_next.main - DEBUG - 



2025-11-12 12:42:51,875 - ispa_next.main - DEBUG - starting with process 7 (M-NC 1407) of 21
2025-11-12 12:42:51,883 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:42:53,052 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:54,102 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:42:54,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:42:55,475 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:55,477 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:25,869 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:43:25,880 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:43:25,886 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:26,284 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:43:26,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:28,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:43:28,406 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:29,208 - ispa_next.main - DEBUG - 



2025-11-12 12:43:29,208 - ispa_next.main - DEBUG - starting with process 8 (AOIH412) of 21
2025-11-12 12:43:29,218 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:30,091 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:31,266 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:43:31,267 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:43:32,485 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:32,487 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:08,769 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:44:08,781 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:44:08,787 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:09,245 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:44:09,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:11,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:44:11,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:12,363 - ispa_next.main - DEBUG - 



2025-11-12 12:44:12,363 - ispa_next.main - DEBUG - starting with process 9 (M-S 8543 E) of 21
2025-11-12 12:44:12,369 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:44:13,614 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:14,883 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:44:14,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:44:16,247 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:16,249 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:46,086 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:44:46,099 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:44:46,105 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:46,495 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:44:46,497 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:48,873 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:44:48,874 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:49,581 - ispa_next.main - DEBUG - 



2025-11-12 12:44:49,581 - ispa_next.main - DEBUG - starting with process 10 (M-MM 3808) of 21
2025-11-12 12:44:49,587 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:44:50,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:51,877 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:44:51,878 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:44:53,252 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:53,254 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:45:16,024 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:45:25,352 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:27,971 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:45:27,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:28,042 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:28,281 - ispa_next.functions - DEBUG - HU date already expired after 108 days.
2025-11-12 12:45:35,430 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:45:35,436 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:45:38,260 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:38,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:39,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:41,415 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:45:41,521 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:45:44,750 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:45:44,816 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:45:44,816 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:45:53,322 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:45:54,330 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:45:54,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:54,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:05,959 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:46:13,293 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:46:13,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:13,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:46:13,401 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:46:13,432 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:46:14,666 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:46:15,829 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:46:16,041 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:46:18,823 - ispa_next.functions - DEBUG - Updated appointment (AC00016810) customer contact data.
2025-11-12 12:46:19,729 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:46:19,733 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:46:20,441 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:46:20,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:46:21,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:46:24,830 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:46:24,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:25,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:27,342 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:46:27,435 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:46:27,547 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:46:27,620 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:46:27,620 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:46:36,052 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:47:36,055 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:47:44,720 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:48:16,723 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:48:25,254 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:48:32,613 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:48:33,619 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:48:33,625 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:48:33,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:48:33,733 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:48:34,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:48:34,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:48:34,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:48:35,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:48:35,209 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:48:37,637 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:48:37,639 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:48:38,542 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:48:38,543 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:48:38,544 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:48:38,545 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:48:38,547 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:48:38,547 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:48:38,550 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:48:38,553 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:48:38,555 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:48:38,558 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:48:38,567 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:48:38,570 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:48:38,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:41,166 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:48:41,171 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:48:41,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:43,752 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:48:43,757 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:48:43,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:48:44,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:48:44,599 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:48:44,601 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:47,218 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:48:58,136 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:48:58,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:48:59,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:48:59,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:24,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:27,570 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:31,791 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:31,795 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:49:31,796 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:49:32,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:49:32,523 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:49:32,527 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:49:34,160 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:49:41,651 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:49:42,036 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:49:42,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:49:43,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:49:43,452 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:49:45,674 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:49:45,674 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:49:46,494 - ispa_next.main - DEBUG - 



2025-11-12 12:49:46,494 - ispa_next.main - DEBUG - starting with process 11 (R-CK 696) of 21
2025-11-12 12:49:46,501 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:49:47,642 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:49:48,664 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:49:48,666 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 12:49:50,027 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:49:50,028 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:50:12,421 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:50:22,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:50:27,041 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:50:27,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:27,125 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:50:27,353 - ispa_next.functions - DEBUG - HU date already expired after 108 days.
2025-11-12 12:50:34,421 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:50:34,425 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:50:37,192 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:50:37,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:50:38,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:50:40,272 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:50:40,388 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:50:43,596 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:50:43,666 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:50:43,666 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:50:52,373 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:50:53,380 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:50:53,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:50:53,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:05,047 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:51:12,673 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:51:12,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:12,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:12,763 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:51:12,792 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:51:14,068 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:51:14,317 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:51:17,330 - ispa_next.functions - DEBUG - Updated appointment (AC00016807) customer contact data.
2025-11-12 12:51:18,227 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:51:18,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:51:19,002 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:51:19,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:51:19,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:51:23,359 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:51:23,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:23,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:51:25,846 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:51:25,975 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:51:26,068 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:51:26,149 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:51:26,149 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:51:37,750 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:51:42,010 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:51:42,010 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:51:44,168 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:51:45,175 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:51:45,181 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:51:45,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:45,258 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:51:45,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:46,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:46,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:46,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:51:46,821 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:51:51,015 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:51:51,017 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:51:52,218 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:51:52,220 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:51:52,221 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:51:52,222 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:51:52,224 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:51:52,225 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:51:52,226 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:51:52,227 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:51:52,228 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:51:52,230 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:51:52,240 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:51:52,243 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:51:52,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:56,957 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:51:56,963 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:51:56,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:01,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:01,665 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:52:10,596 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:24,789 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:52:24,791 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:52:24,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:52:25,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:52:25,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:33,904 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:52:33,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:38,551 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:52:50,173 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:52:50,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:52:51,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:52:51,311 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:53:36,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:40,890 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:47,161 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:53:47,161 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:53:47,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:53:47,881 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:53:47,885 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:53:51,166 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:53:58,969 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:53:59,347 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:54:00,262 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:54:01,357 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:54:01,358 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:54:04,147 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:54:04,147 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:54:05,039 - ispa_next.main - DEBUG - 



2025-11-12 12:54:05,039 - ispa_next.main - DEBUG - starting with process 12 (M-ON-120) of 21
2025-11-12 12:54:05,045 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:54:06,120 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:54:07,252 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:54:07,253 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:54:08,724 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:54:08,725 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:54:39,526 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:54:39,539 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:54:39,545 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:54:39,961 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:54:39,962 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:54:42,285 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:54:42,307 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:54:43,089 - ispa_next.main - DEBUG - 



2025-11-12 12:54:43,089 - ispa_next.main - DEBUG - starting with process 13 (AS-MY550) of 21
2025-11-12 12:54:43,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:54:44,244 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:54:45,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:54:45,452 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:54:46,829 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:54:46,830 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:55:17,505 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:55:17,517 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:55:17,523 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:55:17,981 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:55:17,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:55:20,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:55:20,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:55:21,339 - ispa_next.main - DEBUG - 



2025-11-12 12:55:21,339 - ispa_next.main - DEBUG - starting with process 14 (FSSP640) of 21
2025-11-12 12:55:21,348 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:55:22,483 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:55:23,605 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:55:23,607 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:55:24,864 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:55:24,869 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:55:55,834 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:55:55,844 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 12:55:55,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:55:56,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:55:56,310 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:55:58,935 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:55:58,935 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:55:59,782 - ispa_next.main - DEBUG - 



2025-11-12 12:55:59,783 - ispa_next.main - DEBUG - starting with process 15 (H PT 7268) of 21
2025-11-12 12:55:59,790 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:56:01,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:56:02,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:56:02,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:56:03,381 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:56:03,382 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:56:34,492 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:56:34,503 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 12:56:34,508 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:56:35,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:56:35,004 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:56:37,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:56:37,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:56:38,260 - ispa_next.main - DEBUG - 



2025-11-12 12:56:38,260 - ispa_next.main - DEBUG - starting with process 16 (M-S 1739 E) of 21
2025-11-12 12:56:38,265 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:56:39,376 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:56:40,395 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:56:40,401 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:56:41,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:56:41,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:57:12,660 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:57:12,671 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 12:57:12,675 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:57:13,219 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:57:13,219 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:57:15,980 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:57:15,981 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:57:16,802 - ispa_next.main - DEBUG - 



2025-11-12 12:57:16,802 - ispa_next.main - DEBUG - starting with process 17 (M-K 1317) of 21
2025-11-12 12:57:16,807 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:57:17,872 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:57:19,143 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:57:19,145 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:57:20,413 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:57:20,415 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:57:42,444 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:57:44,320 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:57:49,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:57:50,612 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:57:50,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:50,714 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:57:50,986 - ispa_next.functions - DEBUG - HU date already expired after 10 days.
2025-11-12 12:57:54,768 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:57:54,774 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:57:57,578 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:57:57,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:57:58,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:58:00,615 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:58:00,717 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:58:00,813 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:58:00,876 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:58:05,068 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:58:06,075 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:58:06,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:58:06,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:58:15,371 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:58:19,234 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:58:19,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:58:19,339 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:58:19,339 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:58:19,381 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:58:19,519 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:58:20,801 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:58:21,036 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:58:23,274 - ispa_next.functions - DEBUG - Updated appointment (AA00023546) customer contact data.
2025-11-12 12:58:24,200 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:58:24,204 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:58:24,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:58:25,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:58:26,150 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:58:26,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:58:26,239 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:58:29,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:58:29,825 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:58:29,830 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:58:29,836 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:58:29,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:58:30,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:58:30,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:58:31,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:58:31,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:58:31,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:58:31,924 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:58:33,232 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:58:33,236 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:58:34,621 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:58:34,621 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:58:34,623 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:58:34,625 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:58:34,625 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:58:34,627 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:58:34,627 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:58:34,629 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:58:34,631 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:58:34,631 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:58:34,637 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:58:34,641 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:58:34,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:35,899 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:58:35,901 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:58:35,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:37,166 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:58:37,170 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:58:37,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:58:38,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:58:38,203 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:45,949 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:58:45,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:47,199 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:58:58,544 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:58:59,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:58:59,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:58:59,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:11,270 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:59:11,277 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:59:11,278 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:59:11,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:59:11,975 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:59:11,979 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:59:13,699 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:59:20,806 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:59:21,188 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 12:59:21,724 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:59:22,812 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:59:22,812 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:59:25,615 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 475
2025-11-12 12:59:25,616 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:59:26,491 - ispa_next.main - DEBUG - 



2025-11-12 12:59:26,491 - ispa_next.main - DEBUG - starting with process 18 (EBE-FA 502) of 21
2025-11-12 12:59:26,496 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:59:27,636 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:59:28,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:59:28,803 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 475
2025-11-12 12:59:30,191 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:59:30,193 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:59:53,828 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:59:55,864 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:00:01,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:03,152 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:00:03,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:03,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:00:03,454 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:00:03,470 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:00:06,446 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:00:06,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:00:07,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:00:09,847 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:00:09,993 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:00:10,098 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:00:10,221 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:00:14,463 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:00:15,471 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:00:15,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:15,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:26,551 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:00:29,923 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:00:29,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:30,007 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:00:30,007 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:00:30,040 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:00:31,283 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:00:31,483 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:00:33,307 - ispa_next.functions - DEBUG - Updated appointment (AF00012098) customer contact data.
2025-11-12 13:00:34,261 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:00:34,266 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:00:35,163 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:00:35,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:00:35,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:00:39,998 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:00:39,998 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:00:39,998 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:00:40,003 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:00:40,009 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:00:40,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:00:40,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:00:46,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:46,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:46,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:00:47,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:00:47,408 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:00:49,332 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:00:49,334 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:00:50,244 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:00:50,246 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:00:50,246 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:00:50,248 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:00:50,248 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:00:50,250 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:00:50,250 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:00:50,252 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:00:50,254 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:00:50,254 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:00:50,260 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:00:50,264 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:00:50,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:52,139 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:00:52,143 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:00:52,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:54,039 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:00:54,043 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:00:54,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:00:54,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:00:55,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:04,388 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:01:04,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:06,314 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:01:17,504 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:01:18,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:01:18,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:01:18,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:36,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:01:40,582 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:01:40,586 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:01:40,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:01:41,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:01:41,336 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:01:41,340 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:01:43,224 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:01:50,750 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:01:51,123 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 13:01:51,842 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:01:53,102 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 13:01:53,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:01:56,236 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 475
2025-11-12 13:01:56,237 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:01:56,923 - ispa_next.main - DEBUG - 



2025-11-12 13:01:56,923 - ispa_next.main - DEBUG - starting with process 19 (M-DA 9696) of 21
2025-11-12 13:01:56,931 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:01:57,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:01:58,669 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 13:01:58,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 475
2025-11-12 13:02:00,057 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:02:00,058 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:02:24,096 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:02:25,782 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:02:30,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:02:32,747 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:02:32,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:02:32,817 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:02:33,099 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:02:33,103 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:02:35,928 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:02:35,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:02:37,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:02:39,087 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:02:39,196 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:02:39,275 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:02:39,406 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:02:39,406 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:02:47,936 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:02:48,943 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:02:48,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:02:49,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:03:00,417 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:03:04,565 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:03:04,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:03:04,646 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:03:04,648 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:03:04,714 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:03:06,123 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:03:06,329 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:03:08,182 - ispa_next.functions - DEBUG - Updated appointment (AF00012106) customer contact data.
2025-11-12 13:03:09,118 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:03:09,122 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:03:09,890 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:03:09,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:03:10,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:03:14,794 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:03:14,794 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:03:14,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:03:15,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:03:17,308 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:03:17,405 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:03:17,530 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:03:17,585 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:03:17,585 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:03:26,617 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:04:26,619 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:04:35,126 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:05:24,128 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:05:32,722 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:05:40,885 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:05:41,892 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:05:41,898 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:05:41,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:05:41,980 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:05:42,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:42,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:42,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:05:43,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:05:43,651 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:05:45,598 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:05:45,598 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:05:46,712 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:05:46,714 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:05:46,718 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:05:46,718 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:05:46,720 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:05:46,722 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:05:46,724 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:05:46,726 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:05:46,733 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:05:46,736 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:05:46,742 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:05:46,746 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:05:46,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:05:48,615 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:05:48,619 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:05:48,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:05:50,542 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:05:50,546 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:05:50,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:05:51,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:05:51,311 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:05:51,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:05:53,145 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:06:03,206 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:06:03,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:06:04,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:06:04,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:06:22,526 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:06:26,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:06:26,518 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:06:26,519 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:06:26,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:06:27,028 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:06:27,031 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:06:28,840 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:06:36,869 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:06:37,247 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 13:06:37,877 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:06:39,056 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 13:06:39,057 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:06:41,688 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 475
2025-11-12 13:06:41,688 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:06:42,363 - ispa_next.main - DEBUG - 



2025-11-12 13:06:42,363 - ispa_next.main - DEBUG - starting with process 20 (M-P 5330) of 21
2025-11-12 13:06:42,370 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:06:43,495 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:06:44,741 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 13:06:44,743 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 475
2025-11-12 13:06:46,185 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:06:46,187 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:07:18,287 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:07:20,056 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:07:24,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:07:26,688 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:07:26,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:26,774 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:07:26,950 - ispa_next.functions - DEBUG - HU date already expired after 412 days.
2025-11-12 13:07:30,850 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:07:30,855 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:07:33,572 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:07:33,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:35,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:07:37,052 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:07:37,169 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:07:37,285 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:07:37,396 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:07:41,595 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:07:42,603 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:07:42,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:43,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:56,331 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:07:59,552 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:07:59,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:59,639 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:07:59,639 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:07:59,675 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:07:59,777 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:08:01,007 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:08:02,292 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 13:08:02,615 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:08:04,477 - ispa_next.functions - DEBUG - Updated appointment (AA00023288) customer contact data.
2025-11-12 13:08:05,423 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:08:05,427 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:08:05,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:08:06,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:08:08,088 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:08:08,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:08:08,188 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:08:11,820 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:08:11,820 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:08:11,825 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:08:11,830 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:08:11,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:08:12,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:08:12,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:08:13,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:08:13,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:08:13,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:08:13,967 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:08:15,851 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:08:15,856 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:08:17,487 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:08:17,489 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:08:17,493 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:08:17,493 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:08:17,495 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:08:17,497 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:08:17,497 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:08:17,499 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:08:17,499 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:08:17,501 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:08:17,507 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:08:17,509 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:08:17,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:19,422 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:08:19,427 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:08:19,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:21,350 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:08:21,355 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:08:21,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:08:22,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:08:22,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:31,941 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:08:31,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:33,842 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:08:44,016 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:08:44,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:08:45,075 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:08:45,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:09:03,585 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:09:08,280 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:09:08,286 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:09:08,287 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:09:08,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:09:09,019 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:09:09,022 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:09:10,817 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:09:18,873 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:09:19,277 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 13:09:20,030 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:09:21,350 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 13:09:21,352 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:09:24,556 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 475
2025-11-12 13:09:24,557 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:09:25,488 - ispa_next.main - DEBUG - 



2025-11-12 13:09:25,488 - ispa_next.main - DEBUG - starting with process 21 (M-BD 1618) of 21
2025-11-12 13:09:25,497 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:09:26,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:09:27,912 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 13:09:27,913 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 475
2025-11-12 13:09:29,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:09:29,519 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:10:05,464 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:10:08,037 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:10:13,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:10:18,036 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:10:18,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:18,119 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:10:18,313 - ispa_next.functions - DEBUG - HU date already expired after 77 days.
2025-11-12 13:10:22,994 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:10:23,001 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:10:25,914 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:10:25,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:10:27,208 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:10:29,213 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:10:29,355 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:10:29,440 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:10:29,568 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:10:29,569 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:10:38,133 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:10:39,140 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:10:39,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:39,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:52,414 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:10:52,415 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:10:56,660 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:10:56,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:56,739 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:10:56,739 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:10:56,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:10:56,919 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:10:58,222 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:10:58,456 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:11:00,943 - ispa_next.functions - DEBUG - Updated appointment (AF00012123) customer contact data.
2025-11-12 13:11:01,862 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:11:01,864 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:11:01,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:11:02,759 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:11:03,651 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:11:03,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:11:03,724 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:11:07,287 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:11:07,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:11:07,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:11:09,763 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:11:09,850 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:11:09,956 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:11:10,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:11:10,016 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:11:19,120 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:12:19,124 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:12:27,840 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:13:05,842 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:14,497 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:13:21,454 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:13:22,471 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:13:22,475 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:13:22,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:22,546 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:13:22,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:23,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:23,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:24,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:24,009 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:13:28,217 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:13:28,219 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:13:29,416 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:13:29,418 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:29,418 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:13:29,420 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:29,420 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:13:29,422 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:13:29,422 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:13:29,424 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:13:29,424 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:13:29,426 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:13:29,429 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:13:29,433 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:13:29,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:34,175 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:13:34,178 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:13:34,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:38,893 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:13:38,896 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:13:38,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:13:39,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:13:39,770 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:13:39,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:44,527 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:13:55,436 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:13:55,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:13:56,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:13:56,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:42,208 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:46,363 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:50,448 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:54,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:58,661 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:15:03,336 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:15:03,340 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:15:03,340 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:03,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:03,920 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:15:03,924 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:15:05,395 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:15:12,236 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:15:12,617 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-12 13:15:13,041 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:14,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 907
2025-11-12 13:15:14,643 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:17,175 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 476
2025-11-12 13:15:17,176 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
