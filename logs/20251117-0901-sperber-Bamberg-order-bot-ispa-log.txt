2025-11-17 09:01:24,597 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:01:24,604 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:01:37,408 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:01:47,868 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:02:03,846 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:04:04,997 - ispa_next.app_start.main - DEBUG - Operation already took 109.73 seconds (more than 80 seconds)
2025-11-17 09:04:07,094 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_vpi4x1ka_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_vpi4x1ka', 'txt']
2025-11-17 09:04:07,423 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:04:07,428 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:04:07,429 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:06:09,313 - ispa_next.app_start.main - DEBUG - Operation already took 109.37 seconds (more than 80 seconds)
2025-11-17 09:06:11,405 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_ubb6jgji_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_ubb6jgji', 'txt']
2025-11-17 09:06:11,718 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:06:11,725 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:06:15,842 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 09:06:28,478 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:06:39,067 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:06:54,904 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:08:55,568 - ispa_next.app_start.main - DEBUG - Operation already took 109.54 seconds (more than 80 seconds)
2025-11-17 09:08:57,688 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_pu9yt9we_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_pu9yt9we', 'txt']
2025-11-17 09:08:58,010 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:08:58,014 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:08:58,015 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:10:59,245 - ispa_next.app_start.main - DEBUG - Operation already took 108.70 seconds (more than 80 seconds)
2025-11-17 09:11:01,376 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess__rsxkgr0_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess__rsxkgr0', 'txt']
2025-11-17 09:11:01,733 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:11:01,741 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:11:05,928 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 09:11:16,764 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:11:29,232 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:11:45,177 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:13:46,125 - ispa_next.app_start.main - DEBUG - Operation already took 109.88 seconds (more than 80 seconds)
2025-11-17 09:13:48,220 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_z972twny_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_z972twny', 'txt']
2025-11-17 09:13:48,527 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:13:48,534 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:13:48,535 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:15:49,716 - ispa_next.app_start.main - DEBUG - Operation already took 108.80 seconds (more than 80 seconds)
2025-11-17 09:15:51,816 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_ltarcf8g_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\d7e99741fe4b13fe\\tess_ltarcf8g', 'txt']
2025-11-17 09:15:52,125 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:15:52,132 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:15:56,177 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 09:16:06,248 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:16:17,587 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:16:33,578 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:17:09,005 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:17:24,872 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:17:29,718 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:17:31,569 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1525
2025-11-17 09:17:31,570 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 461
2025-11-17 09:17:34,551 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-17 09:17:34,552 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:17:34,553 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:17:36,030 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:17:37,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:48,054 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,126 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,151 - ispa_next.appointments.models - DEBUG - Appointment Frau Yanhong Sha BA-YS 531 WBA31DZ070FK02591 ohne Termin.
2025-11-17 09:18:48,174 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Mihaela Becheanu LIF.LM.92 WBA8C31080A086188, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='LIF.LM.92', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-17 09:18:48,195 - ispa_next.appointments.models - DEBUG - Appointment Herr Matthias Möller BA-MM 511 WBAJM71020B067894 ohne Termin.
2025-11-17 09:18:48,196 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,214 - ispa_next.appointments.models - DEBUG - Appointment Herr Bernhard Möhrlein BA-ZZ 43 WBAHF11030WW89645 ohne Termin.
2025-11-17 09:18:48,236 - ispa_next.appointments.models - DEBUG - Appointment Herr Stefan Endres BA-LE 234 WBA1C71000J948537 ohne Termin.
2025-11-17 09:18:48,241 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,251 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,265 - ispa_next.appointments.models - DEBUG - Appointment Siegfried Geißler  WBA51EG0505W23667 ohne Termin.
2025-11-17 09:18:48,274 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,297 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,317 - ispa_next.appointments.models - DEBUG - Appointment Frau Alexandra Wolf BA-AW 555 WBY8P210607K30883 ohne Termin.
2025-11-17 09:18:48,319 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,320 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,321 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,321 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,324 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,363 - ispa_next.appointments.models - DEBUG - Appointment Firma Minges Kaffeerösterei GmbH BA-MK 540 WBA11GR0409Y69237 ohne Termin.
2025-11-17 09:18:48,370 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,408 - ispa_next.appointments.models - DEBUG - Appointment Herr Bastian Stern HÖS-S 1312 WBA4J51020BN80220 ohne Termin.
2025-11-17 09:18:48,441 - ispa_next.appointments.models - DEBUG - Appointment Herr Stephan Nätscher BA-MN 1019 WBA7K310307J40556 ohne Termin.
2025-11-17 09:18:48,463 - ispa_next.appointments.models - DEBUG - Appointment Firma Kraftanlagen Energies & M-KA 2446 WBA41EG0905Z23353 ohne Termin.
2025-11-17 09:18:48,501 - ispa_next.appointments.models - DEBUG - Appointment Frau Franziska Berg BA-JP 1720 WMWLN710202E75045 ohne Termin.
2025-11-17 09:18:48,513 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,542 - ispa_next.appointments.models - DEBUG - Appointment Herr Jürgen Manfred Suppe BA-SU 380 WBY61EF0305W96365 ohne Termin.
2025-11-17 09:18:48,574 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Kirsch BA-BK 746 WBA2E510205G50991 ohne Termin.
2025-11-17 09:18:48,575 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,588 - ispa_next.appointments.models - DEBUG - Appointment Firma Andreas Wagner Vertriebs GmbH HAS-W 3690 WBA15BZ070N298504 ohne Termin.
2025-11-17 09:18:48,659 - ispa_next.appointments.models - DEBUG - Appointment Firma Erlanger Treuhand GmbH ER-TR 70E WBA21GV020CU74535 ohne Termin.
2025-11-17 09:18:48,733 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,753 - ispa_next.appointments.models - DEBUG - Appointment Frau Aslihan Karaman NÖ-AK 5252 WBAHT710305K01893 ohne Termin.
2025-11-17 09:18:48,776 - ispa_next.appointments.models - DEBUG - Appointment Generalstaatsanwaltschaft BA-N 1017E WBA51BX0607T37782 ohne Termin.
2025-11-17 09:18:48,795 - ispa_next.appointments.models - DEBUG - Appointment Herr Josef Reuß KG-TR 899 WBA8H91030A719314 ohne Termin.
2025-11-17 09:18:48,808 - ispa_next.appointments.models - DEBUG - Appointment Firma Elektro Weis GmbH & Co. KG BA-XX 621 WMW61DL0503P86044 ohne Termin.
2025-11-17 09:18:48,827 - ispa_next.appointments.models - DEBUG - Appointment Frau Birgitta Helmstetter BA-A 607 WBA7K310507K49097 ohne Termin.
2025-11-17 09:18:48,843 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Kießwetter BA-CL 16 WBA4A51060D408079 ohne Termin.
2025-11-17 09:18:48,856 - ispa_next.appointments.models - DEBUG - Appointment Firma bornheim GmbH & Co. KG BA-M 180 WBA11GF0107R40264 ohne Termin.
2025-11-17 09:18:48,870 - ispa_next.appointments.models - DEBUG - Appointment Herr Adam Jacek Kesminowicz BA-KA 91 WBAHT710505J98589 ohne Termin.
2025-11-17 09:18:48,883 - ispa_next.appointments.models - DEBUG - Appointment Frau Inge Kimbrough WUN-NY 111 WBA31AD0303L79467 ohne Termin.
2025-11-17 09:18:48,903 - ispa_next.appointments.models - DEBUG - Appointment Herr Peter Kupsch BA-PK 12 WBAHS910805H68893 ohne Termin.
2025-11-17 09:18:48,926 - ispa_next.appointments.models - DEBUG - Appointment Frau Jennifer Crayne ERH-JD 604 WMW51DK0102T47698 ohne Termin.
2025-11-17 09:18:48,927 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:18:48,956 - ispa_next.appointments.models - DEBUG - Appointment Herr Rainer Andreas Rebel BA-TR 2003 WBAPP11070E794980 ohne Termin.
2025-11-17 09:18:48,983 - ispa_next.appointments.models - DEBUG - Appointment Firma MG-Nährmittel Produktservice BA-M 8013 WBSAE01020CE87488 ohne Termin.
2025-11-17 09:18:49,042 - ispa_next.main - DEBUG - Found 4 out of 208 appointments to process (configured limit: 15).
2025-11-17 09:18:49,042 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-17 09:18:49,042 - ispa_next.main - DEBUG - All appointments: BA-SH 5502, BA-W 1720, ERH-AL 4E, HAS-PX 9
2025-11-17 09:18:49,045 - ispa_next.main - DEBUG - 



2025-11-17 09:18:49,045 - ispa_next.main - DEBUG - starting with process 1 (BA-SH 5502) of 4
2025-11-17 09:18:49,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:50,476 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:52,150 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1525
2025-11-17 09:18:52,152 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-17 09:18:54,029 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:54,030 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:31,417 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:19:46,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:19:50,123 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:19:50,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:50,317 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:19:50,639 - ispa_next.functions - DEBUG - HU date already expired after 56 days.
2025-11-17 09:19:59,379 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:19:59,388 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:19:59,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:59,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:20:02,673 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:20:02,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:04,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:06,064 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:20:06,207 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:20:06,330 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:20:06,420 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:20:08,649 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:20:09,657 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:20:09,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:10,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:29,683 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:20:39,113 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:20:39,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:39,219 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:20:39,220 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:20:39,301 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:20:39,500 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:20:41,267 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:20:41,895 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:20:46,847 - ispa_next.functions - DEBUG - Updated appointment (AA00043498) customer contact data.
2025-11-17 09:20:47,811 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:20:47,816 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:20:48,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:20:49,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:20:50,835 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:20:50,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:20:51,003 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:20:54,644 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:20:54,644 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:20:54,649 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:20:54,650 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:20:54,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:55,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:59,398 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:21:00,440 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:21:16,358 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:21:16,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:21:16,483 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:21:21,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:21,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:21:21,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:21:22,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:21:22,785 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:21:27,746 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:21:27,766 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:21:29,937 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:21:29,940 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:21:29,946 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:21:29,948 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:21:29,954 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:21:29,956 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list)}
2025-11-17 09:21:29,962 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:21:29,973 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:21:29,975 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:21:29,983 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:21:29,986 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:21:31,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:21:32,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:21:52,477 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:21:52,484 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:21:52,507 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:21:52,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:21:57,575 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:21:57,580 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:21:57,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:22:02,491 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:22:02,491 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:22:02,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:22:07,403 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:22:07,409 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:22:07,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:22:12,319 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:22:45,363 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:22:46,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:22:47,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:22:48,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:23:38,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:23:46,508 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:23:54,800 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:03,245 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:11,040 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:20,070 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:20,074 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:24:20,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:24:21,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:24:21,972 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:24:21,978 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:24:26,679 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:24:50,590 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:24:50,991 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:24:52,772 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:25:00,428 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1524
2025-11-17 09:25:00,430 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:25:08,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 462
2025-11-17 09:25:08,746 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:25:10,544 - ispa_next.appointments.models - DEBUG - Appointment Herr Philipp Winning-Schmidt N-PW 2025 WBA6L31030FL22952 ohne Termin.
2025-11-17 09:25:10,545 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:25:10,566 - ispa_next.appointments.models - DEBUG - Appointment Firma Neuber Verwaltungs-GmbH A-MN 269E WBY61EF0705X57328 ohne Termin.
2025-11-17 09:25:10,580 - ispa_next.main - DEBUG - 



2025-11-17 09:25:10,580 - ispa_next.main - DEBUG - starting with process 2 (BA-W 1720) of 4
2025-11-17 09:25:10,587 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:25:13,357 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:25:16,473 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1524
2025-11-17 09:25:16,475 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 462
2025-11-17 09:25:23,269 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:25:23,270 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:26:23,385 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:26:41,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:26:41,222 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:26:41,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:26:43,671 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:26:43,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:26:43,824 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:26:44,425 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:26:44,432 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:26:44,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:26:44,626 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:27:02,568 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:27:02,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:27:04,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:27:06,651 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:27:21,207 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 09:27:35,972 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 09:27:36,980 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:27:36,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:37,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:57,260 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:28:11,559 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:28:11,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:11,673 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:28:11,674 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:28:11,806 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:28:12,094 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:28:13,942 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:28:14,323 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:28:20,755 - ispa_next.functions - DEBUG - Updated appointment (AA00043496) customer contact data.
2025-11-17 09:28:21,907 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:28:21,958 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:28:22,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:28:23,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:28:26,256 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:28:26,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:28:26,419 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:28:30,654 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:28:30,654 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:28:30,655 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:28:30,659 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:28:30,660 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:28:30,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:31,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:28:35,654 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:28:35,661 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:28:35,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:35,839 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:28:36,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:37,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:37,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:38,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:28:38,175 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:28:40,838 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:28:40,841 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:28:43,083 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:28:43,084 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:28:43,091 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:28:43,092 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:28:43,098 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:28:43,100 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list)}
2025-11-17 09:28:43,102 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:28:43,108 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:28:43,109 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:28:43,119 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:28:43,121 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:28:44,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:28:45,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:29:03,505 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:29:03,513 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:29:03,557 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:29:03,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:06,314 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:29:06,320 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:29:06,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:09,151 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:29:09,151 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:29:09,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:11,878 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:29:11,884 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:29:11,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:29:14,684 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:29:47,109 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:29:48,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:29:49,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:29:50,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:30:19,485 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:30:27,886 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:30:36,884 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:30:36,889 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:30:36,890 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:30:38,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:30:38,710 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:30:38,716 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:30:43,314 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:31:03,157 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:31:03,613 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:31:05,064 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:31:12,851 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1523
2025-11-17 09:31:12,853 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:31:21,197 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 462
2025-11-17 09:31:21,199 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:31:22,944 - ispa_next.appointments.models - DEBUG - Appointment Herr Philipp Winning-Schmidt N-PW 2025 WBA6L31030FL22952 ohne Termin.
2025-11-17 09:31:22,945 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:31:22,987 - ispa_next.appointments.models - DEBUG - Appointment Firma Neuber Verwaltungs-GmbH A-MN 269E WBY61EF0705X57328 ohne Termin.
2025-11-17 09:31:23,003 - ispa_next.main - DEBUG - 



2025-11-17 09:31:23,004 - ispa_next.main - DEBUG - starting with process 3 (ERH-AL 4E) of 4
2025-11-17 09:31:23,009 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:31:25,956 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:31:29,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1523
2025-11-17 09:31:29,305 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 462
2025-11-17 09:31:33,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:31:33,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:26,208 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:32:44,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:32:46,069 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:32:46,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:46,228 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:46,706 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:33:01,014 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:33:01,019 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:33:01,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:01,181 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:05,196 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:33:05,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:07,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:09,051 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:33:09,267 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:33:09,474 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:33:09,699 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:33:09,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:11,135 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:33:24,317 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:33:33,137 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:33:33,139 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:34,548 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:33:38,810 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:33:39,817 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:33:39,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:40,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:04,255 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:34:19,428 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:34:19,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:19,663 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:34:19,664 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:34:19,763 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:34:21,580 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:34:23,166 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:34:23,561 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:34:29,081 - ispa_next.functions - DEBUG - Updated appointment (AA00043482) customer contact data.
2025-11-17 09:34:30,239 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:34:30,252 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:34:32,298 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:34:32,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:34:33,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:34:37,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:34:37,182 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:34:37,187 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:34:37,188 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:34:37,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:37,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:42,030 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:34:42,037 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:34:42,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:42,207 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:34:47,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:48,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:48,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:49,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:49,790 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:34:51,291 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:34:51,294 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:34:52,864 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:34:52,865 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:52,872 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:34:52,873 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:52,880 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:34:52,882 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list)}
2025-11-17 09:34:52,883 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:34:52,889 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:34:52,890 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:34:52,897 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:34:52,902 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:34:53,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:34:54,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:35:18,446 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:35:18,451 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:35:18,454 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:35:18,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:19,801 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:35:19,805 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:35:19,807 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:21,147 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:35:21,147 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:35:21,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:22,441 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:35:22,448 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:35:22,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:23,863 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:35:56,764 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:35:57,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:59,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:35:59,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:36:16,264 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:36:16,269 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:36:16,269 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:36:17,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:36:18,195 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:36:18,201 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:36:22,868 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:36:43,525 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:36:44,010 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:36:45,445 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:52,583 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1525
2025-11-17 09:36:52,585 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:37:00,292 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 464
2025-11-17 09:37:00,293 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:37:02,001 - ispa_next.appointments.models - DEBUG - Appointment Herr Philipp Winning-Schmidt N-PW 2025 WBA6L31030FL22952 ohne Termin.
2025-11-17 09:37:02,002 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:37:02,031 - ispa_next.appointments.models - DEBUG - Appointment Firma Neuber Verwaltungs-GmbH A-MN 269E WBY61EF0705X57328 ohne Termin.
2025-11-17 09:37:02,041 - ispa_next.main - DEBUG - Found new Appointment: WUG-GK 80
2025-11-17 09:37:02,041 - ispa_next.main - DEBUG - Found new Appointment: BA-GK 2002
2025-11-17 09:37:02,043 - ispa_next.main - DEBUG - 



2025-11-17 09:37:02,043 - ispa_next.main - DEBUG - starting with process 4 (WUG-GK 80) of 6
2025-11-17 09:37:02,049 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:37:04,849 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:37:08,055 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1525
2025-11-17 09:37:08,057 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 464
2025-11-17 09:37:11,994 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:37:11,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:38:09,179 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:38:27,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:27,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:38:28,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:29,401 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:38:29,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:29,514 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:38:30,066 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:38:30,073 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:38:30,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:30,265 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:38:34,665 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:38:34,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:38:37,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:38:39,175 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:38:39,403 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:38:42,775 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:38:58,057 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:38:59,067 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:38:59,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:59,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:39:19,512 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:39:33,885 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:39:33,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:39:34,096 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:39:34,097 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:39:34,235 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:39:35,929 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:39:38,243 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:39:38,599 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:39:42,190 - ispa_next.functions - DEBUG - Updated appointment (AA00043501) customer contact data.
2025-11-17 09:39:43,293 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:39:43,336 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:39:45,227 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:39:45,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:39:46,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:39:50,215 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:39:50,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:39:50,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:39:52,790 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:39:53,021 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:39:53,281 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:39:53,459 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:39:53,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:39:54,944 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:40:08,648 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:41:08,652 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:41:20,043 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:41:28,828 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:41:28,830 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:30,201 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:41:34,508 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:41:35,520 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:41:35,523 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:41:35,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:41:35,768 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:41:40,034 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:41:40,040 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:41:40,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:41:40,187 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:41:45,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:41:46,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:41:46,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:41:47,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:41:47,756 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:41:49,210 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:41:49,212 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:41:51,007 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:41:51,009 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:41:51,016 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:41:51,017 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:41:51,024 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:41:51,026 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list)}
2025-11-17 09:41:51,027 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:41:51,034 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:41:51,035 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:41:51,042 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:41:51,044 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:41:51,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:41:53,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:42:11,871 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:42:11,878 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:42:11,884 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:42:11,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:42:13,211 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:42:13,215 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:42:13,217 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:42:14,570 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:42:14,571 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:42:14,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:42:15,893 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:42:15,900 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:42:15,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:42:17,350 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:42:49,937 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:42:51,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:42:52,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:42:52,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:09,845 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:43:09,850 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:43:09,851 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:43:11,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:43:11,654 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:43:11,660 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:43:16,430 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:43:36,483 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:43:36,931 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:43:38,648 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:43:45,893 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1524
2025-11-17 09:43:45,895 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:43:54,575 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 462
2025-11-17 09:43:54,576 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:43:56,243 - ispa_next.appointments.models - DEBUG - Appointment Herr Philipp Winning-Schmidt N-PW 2025 WBA6L31030FL22952 ohne Termin.
2025-11-17 09:43:56,243 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:43:56,259 - ispa_next.appointments.models - DEBUG - Appointment Firma Neuber Verwaltungs-GmbH A-MN 269E WBY61EF0705X57328 ohne Termin.
2025-11-17 09:43:56,268 - ispa_next.main - DEBUG - 



2025-11-17 09:43:56,269 - ispa_next.main - DEBUG - starting with process 5 (BA-GK 2002) of 6
2025-11-17 09:43:56,274 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:43:59,159 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:44:02,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1524
2025-11-17 09:44:02,335 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 462
2025-11-17 09:44:06,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:44:06,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:45:02,273 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:45:20,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:20,888 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:21,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:23,311 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:45:23,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:23,549 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:24,216 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:45:24,223 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:45:24,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:24,338 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:28,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:45:28,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:45:31,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:45:33,072 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:45:33,266 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:45:36,677 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:45:36,868 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:45:36,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:39,226 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:45:54,382 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:45:55,390 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:45:55,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:55,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:46:16,175 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:46:30,585 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:46:30,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:46:30,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:46:30,732 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:46:30,829 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:46:32,468 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:46:34,584 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:46:34,983 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:46:41,686 - ispa_next.functions - DEBUG - Updated appointment (AA00043500) customer contact data.
2025-11-17 09:46:42,836 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:46:42,927 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:46:44,911 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:46:44,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:46:46,299 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:46:49,969 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:46:49,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:46:50,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:46:52,836 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:46:53,059 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:46:53,333 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:46:53,523 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:46:53,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:55,802 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:47:07,227 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:47:16,437 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:47:16,438 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:18,639 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:47:22,947 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:47:23,956 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:47:23,957 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:47:23,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:24,098 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:47:28,353 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:47:28,362 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:47:28,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:28,514 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:47:34,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:35,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:35,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:36,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:47:36,587 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:47:38,870 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:47:38,872 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:47:41,008 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:47:41,010 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:47:41,017 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:47:41,020 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:47:41,028 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:47:41,032 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list)}
2025-11-17 09:47:41,033 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:47:41,039 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:47:41,040 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:47:41,047 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:47:41,049 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:47:41,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:47:43,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:47:47,815 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:47:47,819 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:47:47,834 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:47:47,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:49,922 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:47:49,928 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:47:49,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:52,027 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:47:52,027 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:47:52,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:54,095 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:47:54,101 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:47:54,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:56,216 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:48:29,942 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:48:31,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:48:32,564 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:48:33,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:48:55,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:49:06,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:49:06,431 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:49:06,432 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:49:08,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:49:08,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:49:08,443 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:49:13,217 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:49:34,720 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:49:35,118 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:49:36,669 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:49:44,078 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1525
2025-11-17 09:49:44,080 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:49:51,790 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 462
2025-11-17 09:49:51,793 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:49:53,620 - ispa_next.appointments.models - DEBUG - Appointment Herr Philipp Winning-Schmidt N-PW 2025 WBA6L31030FL22952 ohne Termin.
2025-11-17 09:49:53,620 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:49:53,635 - ispa_next.appointments.models - DEBUG - Appointment Firma Neuber Verwaltungs-GmbH A-MN 269E WBY61EF0705X57328 ohne Termin.
2025-11-17 09:49:53,648 - ispa_next.main - DEBUG - 



2025-11-17 09:49:53,648 - ispa_next.main - DEBUG - starting with process 6 (HAS-PX 9) of 6
2025-11-17 09:49:53,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:49:56,568 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:50:00,092 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1525
2025-11-17 09:50:00,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 462
2025-11-17 09:50:04,016 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:50:04,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:51:04,865 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:51:24,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:35,478 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:51:35,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:51:35,664 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:51:36,229 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:51:36,234 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:51:36,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:51:36,389 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:51:41,382 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:51:41,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:51:44,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:51:46,242 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:51:46,448 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:51:46,701 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:51:46,847 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:51:46,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:58,204 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:52:12,062 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:52:13,069 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:52:13,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:52:13,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:52:37,601 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:52:37,601 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 09:52:53,895 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:52:53,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:52:54,060 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:52:54,061 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:52:54,279 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:52:55,866 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:52:56,462 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:53:03,137 - ispa_next.functions - DEBUG - Updated appointment (AC00041419) customer contact data.
2025-11-17 09:53:04,447 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:53:04,456 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:53:06,795 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:53:06,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:53:08,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:53:12,128 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:53:12,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:53:12,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:53:14,711 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:53:14,929 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:53:15,121 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:53:15,326 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:53:15,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:53:26,723 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:53:38,421 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 09:53:47,621 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:53:47,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:53:58,808 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:54:03,135 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:54:04,151 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:54:04,152 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:54:04,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:04,298 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:54:08,541 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:54:08,549 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:54:08,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:08,743 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:54:14,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:15,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:15,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:16,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:54:16,565 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:54:26,197 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:54:26,201 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:54:28,415 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:54:28,418 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:54:28,425 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:54:28,428 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:54:28,437 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:54:28,442 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Klimaservice, source=from_tab, target=advice_list)}
2025-11-17 09:54:28,443 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:54:28,449 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:54:28,450 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:54:28,456 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:54:28,459 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 09:54:29,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:54:30,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:54:53,684 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:54:53,691 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:54:53,698 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:54:53,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:05,131 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:55:05,137 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:55:05,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:15,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:55:16,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:55:30,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:54,906 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:55:54,906 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:55:54,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:05,865 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:56:05,871 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:56:05,875 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:16,893 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:56:51,773 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:56:52,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:56:53,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:56:54,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:57:43,980 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:57:43,981 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:57:45,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:57:46,076 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:57:46,082 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:57:57,017 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:58:10,700 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 09:58:22,453 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 09:58:22,460 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:58:23,905 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1527
2025-11-17 09:58:23,907 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:58:31,925 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 462
2025-11-17 09:58:31,926 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:58:33,876 - ispa_next.appointments.models - DEBUG - Appointment Herr Philipp Winning-Schmidt N-PW 2025 WBA6L31030FL22952 ohne Termin.
2025-11-17 09:58:33,877 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:58:33,893 - ispa_next.appointments.models - DEBUG - Appointment Firma Neuber Verwaltungs-GmbH A-MN 269E WBY61EF0705X57328 ohne Termin.
