2025-11-12 07:08:23,551 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:08:23,563 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:08:34,888 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:08:46,383 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:09:02,220 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:11:02,299 - ispa_next.app_start.main - DEBUG - Operation already took 108.63 seconds (more than 80 seconds)
2025-11-12 07:11:04,395 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess_r_g9f6sa_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess_r_g9f6sa', 'txt']
2025-11-12 07:11:04,699 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:11:04,705 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:11:04,706 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:13:06,485 - ispa_next.app_start.main - DEBUG - Operation already took 109.38 seconds (more than 80 seconds)
2025-11-12 07:13:08,583 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess_5423365r_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess_5423365r', 'txt']
2025-11-12 07:13:08,871 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:13:08,876 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:13:13,056 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 07:13:24,685 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:13:35,349 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:13:51,205 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:15:50,848 - ispa_next.app_start.main - DEBUG - Operation already took 108.52 seconds (more than 80 seconds)
2025-11-12 07:15:52,956 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess__nyy9dic_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess__nyy9dic', 'txt']
2025-11-12 07:15:53,270 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:15:53,274 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:15:53,275 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:17:54,205 - ispa_next.app_start.main - DEBUG - Operation already took 108.45 seconds (more than 80 seconds)
2025-11-12 07:17:56,394 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess_jaomfdo__input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\9013f0eba21bfc9c\\tess_jaomfdo_', 'txt']
2025-11-12 07:17:56,780 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:17:56,788 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:18:01,359 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 07:18:13,481 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:18:24,011 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:18:39,804 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:19:03,472 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:19:22,687 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:19:25,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:27,612 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:19:27,613 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 07:19:30,854 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 71
2025-11-12 07:19:30,855 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:19:30,856 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:19:32,382 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:19:33,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:46,508 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:19:46,552 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:19:46,579 - ispa_next.main - DEBUG - Found 5 out of 7 appointments to process (configured limit: 15).
2025-11-12 07:19:46,580 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-12 07:19:46,580 - ispa_next.main - DEBUG - Processing 3 already visited appointments (w/ RKR not callable).
2025-11-12 07:19:46,581 - ispa_next.main - DEBUG - All appointments: HF-KT 524, mi mp 200, GT-WK 7070, OS-MW 37, MI-JH356
2025-11-12 07:19:46,584 - ispa_next.main - DEBUG - 



2025-11-12 07:19:46,584 - ispa_next.main - DEBUG - starting with process 1 (HF-KT 524) of 5
2025-11-12 07:19:46,590 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:48,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:49,754 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:19:49,756 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 71
2025-11-12 07:19:51,573 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:51,574 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:36,386 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:20:48,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:56,294 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:20:56,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:56,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:20:56,651 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:20:56,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:56,812 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:21:04,678 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:21:07,642 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:21:07,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:08,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:21:10,816 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:21:10,984 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:21:11,095 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:21:11,197 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:21:11,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:19,655 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:21:28,437 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:21:29,440 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:21:29,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:30,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:40,705 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:21:50,030 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:21:50,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:50,203 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:21:50,204 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:21:50,247 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:21:51,716 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:21:53,279 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:21:53,649 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:21:55,671 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-12 07:21:56,609 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:21:56,610 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:21:57,823 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:21:57,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:21:58,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:22:02,535 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:22:02,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:03,082 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:05,085 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:22:05,235 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:22:05,380 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:22:05,496 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:22:05,497 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:13,961 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:22:22,648 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:23:22,650 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:23:31,146 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:23:37,149 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:23:45,735 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:23:55,143 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:23:56,149 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:23:56,150 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:23:56,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:56,243 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:24:00,395 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:24:01,326 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 07:24:16,366 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:24:16,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:16,500 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:24:16,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:17,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:17,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:18,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:18,721 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:24:26,413 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:24:26,415 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:24:28,315 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:24:28,318 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:24:28,321 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Interne Qualitätssicherung, source=from_tab, target=cart), Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-12 07:24:28,322 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:24:28,325 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 07:24:28,326 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:24:28,329 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:24:28,330 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:24:28,332 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:24:28,335 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 07:24:29,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 07:24:30,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 07:24:48,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 07:24:48,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 07:24:55,962 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 07:24:55,963 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 07:25:00,632 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:01,187 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:01,755 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:03,406 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:03,957 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:04,507 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:06,108 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:06,655 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:07,209 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:08,797 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:09,351 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:09,904 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:11,481 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:12,029 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:12,584 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:14,204 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:14,765 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:15,322 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:16,926 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:17,477 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:18,025 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:19,598 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:20,173 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:20,752 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:23,281 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:23,832 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:24,385 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:25,959 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:26,516 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:27,076 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:28,711 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:29,268 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:29,817 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:31,408 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:31,959 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:32,508 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:34,180 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:25:34,738 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:25:35,289 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:25:35,844 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-12 07:25:36,395 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-12 07:25:36,953 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-12 07:25:37,508 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-12 07:25:37,508 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-12 07:25:39,518 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-12 07:25:39,914 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:25:39,915 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:25:41,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:25:42,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:25:42,675 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:25:42,846 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:25:49,549 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:25:49,552 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:50,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:25:50,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:57,677 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 07:25:57,678 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:59,491 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:25:59,495 - ispa_next.main - DEBUG - 



2025-11-12 07:25:59,495 - ispa_next.main - DEBUG - starting with process 2 (mi mp 200) of 5
2025-11-12 07:25:59,499 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:02,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:05,991 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:26:05,993 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 07:26:09,841 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:09,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:52,345 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:26:52,357 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:26:52,360 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:53,642 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:26:53,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:59,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 07:26:59,474 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:01,403 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:27:01,406 - ispa_next.main - DEBUG - 



2025-11-12 07:27:01,407 - ispa_next.main - DEBUG - starting with process 3 (GT-WK 7070) of 5
2025-11-12 07:27:01,410 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:04,331 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:07,837 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:27:07,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 07:27:10,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:10,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:59,904 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:28:04,283 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:28:12,979 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:17,063 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:28:17,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:17,221 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:17,672 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:28:26,265 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:28:26,267 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:28:29,629 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:29,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:31,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:33,835 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:28:34,060 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:28:34,381 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:28:34,546 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:28:38,919 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:28:39,925 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:28:39,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:40,443 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:56,153 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:29:05,370 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:29:05,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:05,500 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:29:05,501 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:29:05,592 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:29:07,122 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:29:07,517 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:29:10,529 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:29:10,532 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:29:12,388 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:29:12,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:29:13,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:29:17,441 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:29:17,441 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:29:17,444 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:29:17,444 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:29:17,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:29:18,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:29:22,366 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:29:22,370 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:29:22,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:29:22,502 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:29:31,360 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:29:46,433 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:29:46,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:47,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:47,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:29:48,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:29:48,812 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:29:52,757 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:29:52,770 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:29:55,070 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:29:55,072 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:29:55,075 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:29:55,076 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:29:55,079 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:29:55,081 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:29:55,082 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:29:55,084 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:29:55,086 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:29:55,089 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:29:55,092 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:29:55,094 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:29:55,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:59,510 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:29:59,511 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:29:59,514 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:03,707 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:30:03,707 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:30:03,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:08,059 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:30:08,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:30:09,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:30:10,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:30,057 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:30:30,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:34,275 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:30:57,341 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:30:58,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:30:58,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:30:59,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:37,460 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:31:37,461 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:31:39,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:39,189 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:31:39,190 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:31:47,578 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:32:09,696 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:32:10,105 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:32:12,220 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:13,710 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:32:13,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:20,756 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 07:32:20,757 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:22,736 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:32:22,741 - ispa_next.main - DEBUG - 



2025-11-12 07:32:22,741 - ispa_next.main - DEBUG - starting with process 4 (OS-MW 37) of 5
2025-11-12 07:32:22,747 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:32:25,600 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:32:29,056 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:32:29,058 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 07:32:32,240 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:32:32,242 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:33:30,213 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:33:34,591 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:33:43,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:48,030 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:33:48,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:48,209 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:48,694 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:33:48,697 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:33:52,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:33:52,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:54,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:56,043 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:33:56,253 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:33:56,506 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:33:56,823 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:34:01,126 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:34:02,168 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:34:02,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:02,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:19,042 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:34:28,849 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:34:28,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:28,995 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:34:28,997 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:34:29,099 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:34:29,386 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:34:31,159 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:34:31,582 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:34:34,446 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:34:34,448 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:34:34,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:36,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:34:38,225 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:34:38,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:34:38,408 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:34:42,067 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:34:42,067 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:34:42,070 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:34:42,070 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:34:42,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:42,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:46,918 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:34:46,922 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:34:46,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:47,105 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:34:55,934 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:35:10,026 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:35:10,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:11,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:11,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:12,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:35:12,451 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:35:16,988 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:35:16,991 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:35:19,376 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:35:19,388 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:35:19,391 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:35:19,392 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:35:19,395 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:35:19,396 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:35:19,398 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:35:19,402 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:35:19,403 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:35:19,406 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:35:19,409 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:35:19,411 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:35:19,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:24,654 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:35:24,655 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:35:24,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:29,625 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:35:29,625 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:35:29,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:34,594 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:35:34,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:35:35,853 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:35:36,074 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:44,963 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:35:44,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:49,816 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:36:12,928 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:36:13,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:36:14,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:36:14,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:04,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:14,851 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:24,382 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:34,563 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:44,176 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:53,065 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:53,067 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:37:53,068 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:37:54,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:54,777 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:37:54,778 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:37:59,349 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:38:18,649 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:38:19,046 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:38:21,207 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:22,794 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:38:22,797 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:29,715 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 07:38:29,716 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:38:31,532 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:38:31,537 - ispa_next.main - DEBUG - 



2025-11-12 07:38:31,538 - ispa_next.main - DEBUG - starting with process 5 (MI-JH356) of 5
2025-11-12 07:38:31,542 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:34,453 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:37,820 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:38:37,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 07:38:41,214 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:41,216 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:31,824 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:39:36,396 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:39:45,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:39:51,103 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:39:51,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:51,270 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:51,997 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:40:01,248 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:40:01,250 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:40:04,583 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:40:04,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:06,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:40:08,814 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:40:09,064 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:40:09,398 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:40:09,641 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:40:13,915 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:40:14,922 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:40:14,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:15,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:32,271 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:40:41,433 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:40:41,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:41,596 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:40:41,597 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:40:41,679 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:40:43,370 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:40:43,803 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:40:47,082 - ispa_next.functions - DEBUG - Updated appointment (AA00050351) customer contact data.
2025-11-12 07:40:48,336 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:40:48,338 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:40:50,238 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:40:50,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:40:51,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:40:55,224 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:40:55,224 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:40:55,227 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:40:55,228 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:40:55,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:55,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:00,123 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:41:00,130 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:41:00,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:00,299 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:41:09,089 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 07:41:22,447 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:41:22,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:23,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:23,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:24,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:24,812 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:41:30,165 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:41:30,189 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:41:32,189 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:41:32,191 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:32,196 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:41:32,203 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:32,207 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:41:32,208 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:41:32,209 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:41:32,214 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:41:32,218 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:41:32,221 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:41:32,227 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:41:32,229 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:41:32,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:38,137 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:41:38,138 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:41:38,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:43,905 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:41:43,905 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 07:41:43,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:49,624 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:41:49,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:41:51,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:41:51,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:06,350 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:42:06,352 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:11,966 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:42:37,806 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:42:38,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:42:39,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:42:39,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:28,437 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:43:28,438 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:30,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:43:30,341 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:43:30,342 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:43:41,753 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:44:02,331 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:44:02,736 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:44:04,970 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:44:06,584 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 301
2025-11-12 07:44:06,587 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:44:13,650 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 07:44:13,651 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:44:15,893 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
