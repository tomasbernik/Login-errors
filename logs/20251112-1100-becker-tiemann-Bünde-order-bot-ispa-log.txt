2025-11-12 11:00:36,057 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:36,064 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:00:46,020 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:00:58,559 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:14,105 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:01:38,759 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:01:49,738 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:01:52,379 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:01:53,565 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:01:53,566 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 338
2025-11-12 11:01:55,759 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-12 11:01:55,760 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:01:55,760 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:01:56,809 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:01:58,015 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:20,070 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 11:02:20,084 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 11:02:20,092 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 11:02:20,101 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 11:02:20,113 - ispa_next.main - DEBUG - Found 15 out of 37 appointments to process (configured limit: 15).
2025-11-12 11:02:20,113 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 11:02:20,114 - ispa_next.main - DEBUG - Processing 7 already visited appointments (w/ RKR not callable).
2025-11-12 11:02:20,114 - ispa_next.main - DEBUG - All appointments: HF-ZN 71E, BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE, HF-C 213, HF-C 213, HF-H 2227E, HF-AV 404, HF-GE 123, OS-BO 693, HF-EO 550E
2025-11-12 11:02:20,118 - ispa_next.main - DEBUG - 



2025-11-12 11:02:20,118 - ispa_next.main - DEBUG - starting with process 1 (HF-ZN 71E) of 15
2025-11-12 11:02:20,121 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:02:21,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:02:22,427 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:02:22,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-12 11:02:23,815 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:02:23,817 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:02:48,000 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:02:57,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:03:00,858 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:03:00,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:00,958 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:01,179 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:03:01,189 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:03:01,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:01,279 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:04,454 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:04,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:05,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:07,197 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:07,292 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:10,501 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:10,609 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:03:10,610 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:03:18,603 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:03:19,607 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:03:19,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:20,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:30,826 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:03:30,826 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:03:37,220 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:03:37,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:03:37,367 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:03:37,368 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:03:37,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:03:38,670 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:03:38,881 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:03:41,993 - ispa_next.functions - DEBUG - Updated appointment (AA00044521) customer contact data.
2025-11-12 11:03:42,888 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:03:42,890 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:03:43,650 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:03:43,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:03:44,394 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:03:47,962 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:03:47,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:03:48,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:03:50,504 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:03:50,624 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:03:50,760 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:03:50,832 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:03:50,832 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:03:58,973 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:04:58,975 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:05:10,290 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:05:14,425 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:05:14,426 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:05:18,610 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:05:19,617 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:05:19,622 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:05:19,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:19,690 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:05:25,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:25,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:25,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:26,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:05:26,476 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:05:30,007 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:05:30,009 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:05:30,829 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:05:30,830 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:05:30,832 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:05:30,833 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:05:30,834 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:05:30,839 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:05:30,840 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 11:05:30,841 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:05:30,851 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:05:30,852 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:05:30,854 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:05:30,856 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:05:32,821 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:05:33,376 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:05:34,341 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:05:34,898 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:05:35,433 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:05:36,347 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:05:36,960 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:05:37,492 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:05:38,402 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:05:38,996 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:05:39,518 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:05:40,440 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:05:41,017 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:05:41,602 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:05:42,975 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:05:44,011 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:05:44,974 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:05:45,381 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:05:45,386 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:05:45,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:48,690 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:05:48,691 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:05:48,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:51,900 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:05:51,902 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:05:51,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:05:52,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:05:52,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:58,830 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:05:58,831 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:02,079 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:06:02,080 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:06:02,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:06:03,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:06:03,311 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:10,395 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:06:14,464 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:06:20,583 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:06:20,584 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:21,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:06:21,283 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:06:21,285 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:06:23,899 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:06:33,115 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:06:33,509 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:06:33,766 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:34,458 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:06:34,459 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:37,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:06:37,145 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:06:37,959 - ispa_next.main - DEBUG - 



2025-11-12 11:06:37,959 - ispa_next.main - DEBUG - starting with process 2 (BÜNDE) of 15
2025-11-12 11:06:37,963 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:06:39,226 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:06:40,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:06:40,321 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:06:41,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:06:41,655 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:19,105 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:07:19,199 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:07:19,203 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:19,668 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:07:19,669 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:21,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:07:21,600 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:22,223 - ispa_next.main - DEBUG - 



2025-11-12 11:07:22,223 - ispa_next.main - DEBUG - starting with process 3 (HF-LB-222) of 15
2025-11-12 11:07:22,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:23,050 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:23,880 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:07:23,881 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:07:24,918 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:24,919 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:56,296 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:07:56,304 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:07:56,305 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:56,653 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:07:56,654 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:58,533 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:07:58,533 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:59,128 - ispa_next.main - DEBUG - 



2025-11-12 11:07:59,128 - ispa_next.main - DEBUG - starting with process 4 (HF L 1612) of 15
2025-11-12 11:07:59,134 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:59,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:00,875 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:08:00,876 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:08:02,101 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:02,103 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:32,889 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:08:32,897 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:08:32,901 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:33,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:08:33,248 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:35,232 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:08:35,233 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:35,873 - ispa_next.main - DEBUG - 



2025-11-12 11:08:35,873 - ispa_next.main - DEBUG - starting with process 5 (OS-CW177) of 15
2025-11-12 11:08:35,878 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:08:36,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:37,536 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:08:37,537 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:08:38,663 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:08:38,664 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:06,279 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:09:06,287 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:09:06,290 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:06,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:09:06,614 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:08,611 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:09:08,612 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:09,256 - ispa_next.main - DEBUG - 



2025-11-12 11:09:09,256 - ispa_next.main - DEBUG - starting with process 6 (HF-BT 540) of 15
2025-11-12 11:09:09,261 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:10,070 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:10,910 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 615
2025-11-12 11:09:10,911 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:09:11,988 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:11,989 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:33,328 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:09:42,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:46,656 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:09:46,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:46,766 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:46,927 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:09:46,929 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:09:46,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:47,060 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:50,106 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:09:50,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:09:51,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:09:53,247 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:09:53,387 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:09:56,581 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:09:56,669 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:09:56,669 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:10:05,067 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:10:06,072 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:10:06,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:06,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:17,450 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:10:17,450 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:10:23,520 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:10:23,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:23,597 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:23,597 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:10:23,630 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:10:24,853 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:10:25,066 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:10:28,159 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 11:10:29,073 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:10:29,074 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:10:29,715 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:10:29,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:30,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:10:33,958 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:33,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:34,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:36,480 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:10:36,621 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:10:36,710 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:10:36,848 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:10:36,848 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:10:45,103 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:11:45,107 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:11:53,300 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:12:34,317 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:12:42,670 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:12:50,235 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:12:51,241 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:12:51,243 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:12:51,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:51,381 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:00,773 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:13:05,742 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:13:05,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:06,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:06,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:06,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:06,914 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:13:10,578 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:13:10,580 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:13:11,726 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:13:11,728 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:11,733 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:13:11,734 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:13:11,735 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 11:13:11,756 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:13:11,760 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:13:11,761 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:13:11,764 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:13:11,766 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:13:11,767 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:13:11,777 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:13:11,787 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:13:33,824 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 11:13:33,848 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:13:33,849 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:34,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:35,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:13:35,167 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:13:35,195 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:13:37,450 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:13:37,452 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:37,774 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:13:37,775 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:40,443 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:13:40,444 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:41,271 - ispa_next.main - DEBUG - 



2025-11-12 11:13:41,271 - ispa_next.main - DEBUG - starting with process 7 (MI-JC 96 E) of 15
2025-11-12 11:13:41,274 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:42,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:43,571 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:13:43,573 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:13:44,947 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:44,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:25,658 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:14:25,668 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:14:25,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:26,222 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:14:26,223 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:28,767 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:14:28,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:29,589 - ispa_next.main - DEBUG - 



2025-11-12 11:14:29,589 - ispa_next.main - DEBUG - starting with process 8 (BÜNDE) of 15
2025-11-12 11:14:29,592 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:30,645 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:31,793 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:14:31,794 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:14:33,230 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:33,232 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:03,059 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:15:03,067 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:15:03,069 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:03,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:15:03,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:05,432 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:15:05,433 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:06,206 - ispa_next.main - DEBUG - 



2025-11-12 11:15:06,206 - ispa_next.main - DEBUG - starting with process 9 (HF-C 213) of 15
2025-11-12 11:15:06,227 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:07,668 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:09,042 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:15:09,043 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:15:10,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:10,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:35,265 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:15:36,784 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:15:41,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:43,322 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:15:43,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:43,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:43,680 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:15:43,682 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:15:43,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:43,821 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:15:50,375 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:15:50,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:51,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:53,323 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:15:53,440 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:15:53,564 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:15:53,635 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:15:57,825 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:15:58,830 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:15:58,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:59,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:09,289 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:16:12,885 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:16:12,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:12,971 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:12,972 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:16:13,056 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:16:13,167 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:16:14,577 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:16:14,797 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:16:16,023 - ispa_next.functions - DEBUG - Updated appointment (AI00015550) customer contact data.
2025-11-12 11:16:16,945 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:16:16,946 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:16:17,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:17,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:16:18,459 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:16:18,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:16:18,539 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:16:22,144 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:16:22,144 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:16:22,147 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:16:22,151 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:16:22,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:22,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:22,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:23,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:23,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:16:24,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:16:24,186 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:16:26,001 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:16:26,002 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:16:26,965 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:16:26,966 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:26,968 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:16:26,969 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:16:26,970 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:16:26,971 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:26,972 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:16:26,973 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:16:26,974 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:16:26,976 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:16:26,977 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:16:26,978 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:16:26,980 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:16:26,982 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:16:26,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:28,841 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:16:28,843 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:16:28,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:30,823 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:16:30,825 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:16:30,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:16:31,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:16:31,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:41,054 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:16:41,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:42,994 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:16:42,996 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:16:43,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:16:44,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:16:44,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:52,273 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:16:55,723 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:16:55,725 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:16:55,725 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:56,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:16:56,248 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:16:56,249 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:16:57,588 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:17:03,911 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:17:04,358 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:17:04,731 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:05,710 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:17:05,711 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:08,775 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:17:08,776 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:09,541 - ispa_next.main - DEBUG - 



2025-11-12 11:17:09,542 - ispa_next.main - DEBUG - starting with process 10 (HF-C 213) of 15
2025-11-12 11:17:09,544 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:10,294 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:11,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:17:11,136 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:17:12,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:12,300 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:34,165 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:17:36,256 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:17:41,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:43,086 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:17:43,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:43,204 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:43,432 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:17:43,435 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:17:43,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:43,523 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:50,247 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:50,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:51,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:53,388 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:17:53,491 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:17:53,607 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:17:53,682 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:17:57,920 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:17:58,940 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:17:58,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:59,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:09,449 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:18:13,283 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:18:13,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:13,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:13,378 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:18:13,458 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:18:13,570 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:18:14,757 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:18:14,979 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:18:16,265 - ispa_next.functions - DEBUG - Updated appointment (AF00021378) customer contact data.
2025-11-12 11:18:17,207 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:18:17,208 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:18:17,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:18:18,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:18:19,021 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:18:19,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:18:19,087 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:18:22,673 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:18:22,674 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:18:22,681 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:18:22,685 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:18:22,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:23,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:23,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:24,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:24,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:24,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:24,875 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:18:26,757 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:18:26,779 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:18:27,735 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:18:27,748 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:27,750 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:18:27,751 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:18:27,752 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:18:27,753 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:18:27,755 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:18:27,756 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:18:27,757 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:18:27,759 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:18:27,760 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:18:27,762 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:18:27,764 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:18:27,766 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:18:27,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:29,683 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:18:29,686 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:18:29,686 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:31,595 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:18:31,597 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:18:31,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:18:32,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:18:32,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:41,664 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:18:41,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:43,579 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:43,580 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:44,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:44,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:44,773 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:50,322 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:54,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:54,290 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:54,291 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:54,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:54,966 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:54,968 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:56,582 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:19:04,289 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:19:04,691 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:19:05,038 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:06,022 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:19:06,024 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:09,356 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:19:09,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:10,210 - ispa_next.main - DEBUG - 



2025-11-12 11:19:10,211 - ispa_next.main - DEBUG - starting with process 11 (HF-H 2227E) of 15
2025-11-12 11:19:10,215 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:11,471 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:12,783 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:19:12,784 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:19:14,184 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:14,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:39,193 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:40,850 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:19:45,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:51,546 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:51,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:51,633 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:51,782 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:51,784 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:51,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:51,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:54,872 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:54,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:55,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:57,683 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:57,833 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:57,920 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:58,014 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:20:02,227 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:20:03,232 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:20:03,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:03,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:18,364 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:20:22,704 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:22,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:22,821 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:22,822 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:22,852 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:24,131 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:20:25,456 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:25,686 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:27,240 - ispa_next.functions - DEBUG - Updated appointment (AA00044450) customer contact data.
2025-11-12 11:20:28,168 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:28,170 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:28,998 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:28,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:29,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:33,391 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:33,391 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:20:33,394 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:33,398 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:33,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:33,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:37,440 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 11:20:46,536 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:20:46,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:47,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:47,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:48,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:48,065 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:53,317 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:53,319 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:54,541 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:54,545 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:54,553 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:20:54,561 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:20:54,562 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:20:54,565 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:54,568 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:54,570 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:54,574 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:54,575 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:54,580 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:54,594 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:20:54,596 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:20:54,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:00,606 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:21:00,608 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:21:00,611 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:06,565 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:21:06,567 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:21:06,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:21:07,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:21:07,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:20,655 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:20,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:26,603 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:26,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:27,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:27,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:27,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:37,875 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:42,260 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:45,833 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:50,186 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:53,985 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:21:53,986 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:21:54,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:54,752 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:21:54,753 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:21:57,572 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:22:05,746 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:06,127 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:22:06,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:07,679 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:22:07,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:10,818 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:22:10,819 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:11,741 - ispa_next.main - DEBUG - 



2025-11-12 11:22:11,741 - ispa_next.main - DEBUG - starting with process 12 (HF-AV 404) of 15
2025-11-12 11:22:11,745 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:12,924 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:14,058 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:22:14,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:22:15,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:15,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:38,078 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:22:39,697 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:22:44,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:48,558 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:22:48,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:48,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:48,828 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 11:22:52,557 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:22:52,559 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:22:52,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:52,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:59,240 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:22:59,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:00,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:02,263 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:02,381 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:02,478 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:02,566 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:23:06,758 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:23:07,763 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:23:07,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:08,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:17,042 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:23:21,214 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:23:21,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:21,278 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:21,279 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:23:21,348 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:23:22,973 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:23:24,390 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:23:24,606 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:23:26,085 - ispa_next.functions - DEBUG - Updated appointment (AB00040183) customer contact data.
2025-11-12 11:23:26,974 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:23:26,975 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:23:27,795 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:23:27,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:23:28,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:23:32,264 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:32,265 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:23:32,268 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:23:32,272 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:23:32,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:32,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:36,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:36,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:36,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:37,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:37,552 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:23:41,126 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:23:41,129 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:23:42,125 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:23:42,128 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:23:42,131 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:23:42,134 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:23:42,137 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:23:42,138 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:23:42,158 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:23:42,160 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:23:42,163 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:23:42,165 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:23:42,166 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:23:42,168 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:23:42,178 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:23:42,179 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:23:42,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:46,169 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:23:46,171 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:23:46,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:50,103 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:23:50,105 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:23:50,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:23:50,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:23:51,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:00,194 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:24:00,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:04,172 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:24:04,174 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:24:04,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:24:05,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:24:05,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:13,282 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:24:18,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:24:22,380 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:24:27,628 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:24:32,563 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:24:32,565 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:24:32,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:24:33,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:24:33,255 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:24:33,256 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:24:35,006 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:24:42,842 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:24:43,251 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:24:43,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:24:44,835 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:24:44,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:24:47,965 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:24:47,966 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:48,839 - ispa_next.main - DEBUG - 



2025-11-12 11:24:48,839 - ispa_next.main - DEBUG - starting with process 13 (HF-GE 123) of 15
2025-11-12 11:24:48,842 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:24:49,945 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:24:51,343 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:24:51,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:24:52,811 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:24:52,812 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:18,163 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:25:20,099 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:25:24,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:29,376 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:25:29,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:29,436 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:29,622 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:25:29,625 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:25:29,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:29,726 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:33,020 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:33,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:34,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:36,444 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:25:36,562 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:25:36,695 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:25:36,764 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:25:41,007 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:25:42,010 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:25:42,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:42,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:54,501 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:25:54,502 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:25:58,065 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:25:58,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:58,163 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:58,164 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:25:58,211 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:25:59,481 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:26:01,065 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:26:01,296 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:26:02,714 - ispa_next.functions - DEBUG - Updated appointment (AF00021355) customer contact data.
2025-11-12 11:26:03,627 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:26:03,629 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:26:04,414 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:26:04,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:26:05,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:26:09,373 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:26:09,373 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:26:09,377 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:26:09,381 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:26:09,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:09,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:15,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:16,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:16,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:16,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:16,848 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:26:21,529 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:26:21,531 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:26:22,557 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:26:22,558 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:22,560 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:26:22,561 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:26:22,561 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:26:22,562 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:22,564 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:26:22,565 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:26:22,566 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:26:22,567 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:26:22,568 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:26:22,570 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:26:22,572 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:26:22,573 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:26:22,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:27,270 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:26:27,271 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:26:27,273 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:31,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:31,979 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:26:41,507 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:55,458 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:26:55,460 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:26:55,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:26:56,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:26:56,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:09,692 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:27:09,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:14,353 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:27:14,355 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:27:14,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:15,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:15,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:24,451 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:29,128 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:32,074 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:27:32,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:32,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:32,824 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:27:32,825 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:27:35,943 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:27:43,873 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:27:44,251 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:27:45,444 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:27:46,127 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:27:46,128 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:49,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:27:49,117 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:49,943 - ispa_next.main - DEBUG - 



2025-11-12 11:27:49,943 - ispa_next.main - DEBUG - starting with process 14 (OS-BO 693) of 15
2025-11-12 11:27:49,954 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:51,106 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:27:52,434 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:27:52,435 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:27:53,817 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:53,819 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:21,667 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:28:23,937 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:28:29,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:37,742 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:28:37,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:37,815 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:38,004 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:28:38,007 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:28:38,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:38,069 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:41,159 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:28:41,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:42,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:44,336 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:28:44,429 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:28:44,557 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:28:44,621 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:28:46,761 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:28:47,771 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:28:47,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:48,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:03,261 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:29:07,694 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:29:07,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:07,787 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:29:07,788 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:29:07,843 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:29:08,009 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:29:09,259 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:29:09,498 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:29:11,454 - ispa_next.functions - DEBUG - Updated appointment (AB00040597) customer contact data.
2025-11-12 11:29:12,351 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:29:12,354 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:29:12,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:29:13,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:29:14,410 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:29:14,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:29:14,479 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:29:18,042 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:18,042 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:29:18,045 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:29:18,048 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:29:18,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:18,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:22,124 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:29:34,436 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:29:34,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:35,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:35,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:36,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:36,496 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:29:44,259 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:29:44,261 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:29:45,768 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:29:45,769 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:45,771 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:29:45,773 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:29:45,773 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:29:45,774 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:45,776 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:29:45,778 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:29:45,779 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:29:45,780 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:29:45,781 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:29:45,783 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:29:45,786 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:29:45,787 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:29:45,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:54,536 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:29:54,538 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:29:54,540 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:03,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:03,456 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:30:12,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:31,087 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:30:31,088 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:30:31,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:30:32,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:30:32,292 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:51,574 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:30:51,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:00,233 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:31:00,235 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:31:00,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:01,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:31:01,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:14,256 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:19,113 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:22,652 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:22,653 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:23,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:23,407 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:31:23,408 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:31:26,775 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:31:35,463 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:31:35,841 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:31:36,988 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:37,549 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:31:37,550 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:40,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:31:40,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:41,043 - ispa_next.main - DEBUG - 



2025-11-12 11:31:41,044 - ispa_next.main - DEBUG - starting with process 15 (HF-EO 550E) of 15
2025-11-12 11:31:41,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:41,938 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:42,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:31:42,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 11:31:44,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:44,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:07,321 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:32:09,241 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:32:14,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:17,373 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:32:17,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:17,442 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:17,647 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:32:17,649 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:32:17,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:17,783 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:21,009 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:32:21,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:22,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:32:24,264 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:32:24,385 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:32:24,494 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:32:24,611 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:32:28,753 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:32:29,758 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:32:29,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:30,250 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:40,508 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:32:45,122 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:32:45,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:45,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:45,241 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:32:45,281 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:32:46,499 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:32:46,694 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:32:48,478 - ispa_next.functions - DEBUG - Updated appointment (AB00040564) customer contact data.
2025-11-12 11:32:49,395 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:32:49,397 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:32:50,065 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:32:50,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:32:50,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:32:54,978 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:32:54,978 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:32:54,980 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:32:54,983 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:32:54,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:55,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:04,291 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:33:14,216 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:33:14,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:14,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:14,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:15,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:15,670 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:33:18,770 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:33:18,771 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:33:19,814 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:33:19,815 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:19,817 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:33:19,818 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:33:19,818 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:33:19,819 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:19,822 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:33:19,826 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:33:19,830 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:33:19,834 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:33:19,835 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:33:19,837 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:33:19,840 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:33:19,841 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:33:19,842 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:23,080 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:33:23,081 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:33:23,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:26,395 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:33:26,396 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:33:26,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:33:27,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:33:27,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:39,578 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:33:39,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:42,888 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:33:42,889 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:33:43,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:33:43,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:33:44,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:51,389 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:33:55,219 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:33:59,312 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:04,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:04,183 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:34:04,184 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:04,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:04,910 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:34:04,914 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:34:06,704 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:34:14,060 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:34:14,434 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:34:15,327 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:15,913 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 616
2025-11-12 11:34:15,914 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:18,383 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 11:34:18,384 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
