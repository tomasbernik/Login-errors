2025-11-17 10:00:40,925 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:40,934 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:53,969 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:01:05,090 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:20,683 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:01:46,584 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:02:01,560 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:02:05,357 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:06,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1914
2025-11-17 10:02:06,628 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1168
2025-11-17 10:02:09,277 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 752
2025-11-17 10:02:09,278 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:02:09,279 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:10,487 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:11,310 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:59,972 - ispa_next.appointments.models - DEBUG - Appointment Hasan Köksal UL-EH 20 WBAVJ31020LR17360 ohne Termin.
2025-11-17 10:04:00,025 - ispa_next.appointments.models - DEBUG - Appointment Gülsüm Gülcan H-GG 896 WBA1E11040J686335 ohne Termin.
2025-11-17 10:04:00,091 - ispa_next.appointments.models - DEBUG - Appointment Mohamed Nur Bustani UL-A 3990 WBA2E510XH5G53407 ohne Termin.
2025-11-17 10:04:00,118 - ispa_next.appointments.models - DEBUG - Appointment Hermann Brodbeck NU-HB 136 WBA5R11070AK32697 ohne Termin.
2025-11-17 10:04:00,129 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:04:00,171 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Heierhoff NU-GH 5500 WBATX350X0NC21174 ohne Termin.
2025-11-17 10:04:00,219 - ispa_next.appointments.models - DEBUG - Appointment Luca Lissona NU-LL 2000 WBA5R11040FH06143 ohne Termin.
2025-11-17 10:04:00,245 - ispa_next.appointments.models - DEBUG - Appointment Carsten Werner NU-C 2705 WBAHF11050WW82664 ohne Termin.
2025-11-17 10:04:00,281 - ispa_next.appointments.models - DEBUG - Appointment Marcel Denis  WBAUX310X0A703707 ohne Termin.
2025-11-17 10:04:00,304 - ispa_next.appointments.models - DEBUG - Appointment Petrut-Marcelius Mindricel NU-KA 1990 WBAUG51020PV22612 ohne Termin.
2025-11-17 10:04:00,328 - ispa_next.appointments.models - DEBUG - Appointment Aline Walcher NU-XR 119 WBATY15050N035959 ohne Termin.
2025-11-17 10:04:00,352 - ispa_next.appointments.models - DEBUG - Appointment Wladislav Wiebe UL-SW 1204 WBAJT31030BV43579 ohne Termin.
2025-11-17 10:04:00,383 - ispa_next.appointments.models - DEBUG - Appointment Nadine Annabelle Peter UL-N 7218 WBATY55070N053421 ohne Termin.
2025-11-17 10:04:00,416 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Mihai Tritean NU-KL 2007 WBAVC31060VG12381 ohne Termin.
2025-11-17 10:04:00,446 - ispa_next.appointments.models - DEBUG - Appointment Günther Egner  WBAHF11090WW62966 ohne Termin.
2025-11-17 10:04:00,475 - ispa_next.appointments.models - DEBUG - Appointment Yannik Mario Missale BL-YM 99 WBA5V71060FH86625 ohne Termin.
2025-11-17 10:04:00,506 - ispa_next.appointments.models - DEBUG - Appointment Daniela Oßwald NU-DO 55 WBAUZ35030N001791 ohne Termin.
2025-11-17 10:04:00,529 - ispa_next.appointments.models - DEBUG - Appointment Dzafer Omerdic UL-DZ 74 WBAJP31070BT73165 ohne Termin.
2025-11-17 10:04:00,556 - ispa_next.appointments.models - DEBUG - Appointment Marcus Hermann BC-MP 307 WBAJP31050BT92541 ohne Termin.
2025-11-17 10:04:00,581 - ispa_next.appointments.models - DEBUG - Appointment   WBA5R11020FK27135 ohne Termin.
2025-11-17 10:04:00,605 - ispa_next.appointments.models - DEBUG - Appointment Ralf Pause NU-PX 88 WBAJM91050BH77340 ohne Termin.
2025-11-17 10:04:00,631 - ispa_next.appointments.models - DEBUG - Appointment Markus Henning UL-ML 35 WBA6L71060FJ55476 ohne Termin.
2025-11-17 10:04:00,665 - ispa_next.appointments.models - DEBUG - Appointment Hajro Gutic BIR-DE 177 WBAJP31030BT73745 ohne Termin.
2025-11-17 10:04:00,686 - ispa_next.appointments.models - DEBUG - Appointment Romina Reinhardt UL-JR 2202 WBAWY510900A40401 ohne Termin.
2025-11-17 10:04:00,713 - ispa_next.appointments.models - DEBUG - Appointment Emergenda NU-HK 202 WBA2D510805K80209 ohne Termin.
2025-11-17 10:04:00,739 - ispa_next.appointments.models - DEBUG - Appointment Philip Beck MA-LS 102 WBA31DX02LCD85300 ohne Termin.
2025-11-17 10:04:00,765 - ispa_next.appointments.models - DEBUG - Appointment Oula Alhajj BC-OH 2712 WBAVA71000KP97250 ohne Termin.
2025-11-17 10:04:00,789 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hucker NU-CM 105 WBATX35030NE04318 ohne Termin.
2025-11-17 10:04:00,815 - ispa_next.appointments.models - DEBUG - Appointment Gregor Golaski WR-802GF WBA6L71020FJ48038 ohne Termin.
2025-11-17 10:04:00,855 - ispa_next.appointments.models - DEBUG - Appointment PERI SE NU-PE 85 WBA5F31060FK22508 ohne Termin.
2025-11-17 10:04:00,878 - ispa_next.appointments.models - DEBUG - Appointment Zoran Kadric NU-Z 1963 WBAVA71070KR36693 ohne Termin.
2025-11-17 10:04:00,901 - ispa_next.appointments.models - DEBUG - Appointment Demir Burak NU-BD 6 WBA81GE0607U10713 ohne Termin.
2025-11-17 10:04:00,933 - ispa_next.appointments.models - DEBUG - Appointment David Friesinger UL-DF 416 WBA6L31040FJ61091 ohne Termin.
2025-11-17 10:04:00,971 - ispa_next.appointments.models - DEBUG - Appointment Dr. Sachs Andreas NU-XV 777 WBA5R71010FJ22363 ohne Termin.
2025-11-17 10:04:00,997 - ispa_next.appointments.models - DEBUG - Appointment Dominic Kreuzpaintner NU-DK 50 WBA71GP0809058750 ohne Termin.
2025-11-17 10:04:01,024 - ispa_next.appointments.models - DEBUG - Appointment Herbert Ronald Eichholz NU-RE 1021 WBA6L51020FJ56533 ohne Termin.
2025-11-17 10:04:01,050 - ispa_next.appointments.models - DEBUG - Appointment Dumitru-Danut Grosu NU-RD 71 WBAJM91040BH80214 ohne Termin.
2025-11-17 10:04:01,073 - ispa_next.appointments.models - DEBUG - Appointment Hasan Dikmen UL-KD 7238 WBA1V710605A67475 ohne Termin.
2025-11-17 10:04:01,095 - ispa_next.appointments.models - DEBUG - Appointment Axel Hansmann NU-DH 525 WBAJN11030BK38677 ohne Termin.
2025-11-17 10:04:01,118 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 8400E WBY61EF0805419386 ohne Termin.
2025-11-17 10:04:01,144 - ispa_next.appointments.models - DEBUG - Appointment Bernd Schliefer ILL-KB 66 WBAJP31010BT73159 ohne Termin.
2025-11-17 10:04:01,170 - ispa_next.appointments.models - DEBUG - Appointment Max Hentschel NU-ME 2706 WBAJM91060BH38059 ohne Termin.
2025-11-17 10:04:01,191 - ispa_next.appointments.models - DEBUG - Appointment Valdrin Abazi  WBA11DY080FK03855 ohne Termin.
2025-11-17 10:04:01,214 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schmid UL-AS 2220 WBAJP31060BT84111 ohne Termin.
2025-11-17 10:04:01,244 - ispa_next.appointments.models - DEBUG - Appointment Azem Alispahic NU-SL 701 WBAJP31060BT75599 ohne Termin.
2025-11-17 10:04:01,267 - ispa_next.appointments.models - DEBUG - Appointment Verena Wolf NU-BV 777 WBAJT51090CE05828 ohne Termin.
2025-11-17 10:04:01,290 - ispa_next.appointments.models - DEBUG - Appointment Markus Wieland NU-MW 1988 WBA5R110X0FJ58307 ohne Termin.
2025-11-17 10:04:01,313 - ispa_next.appointments.models - DEBUG - Appointment Klara Maria Bühler UL-RK 1606 WBATX35070NC11458 ohne Termin.
2025-11-17 10:04:01,336 - ispa_next.appointments.models - DEBUG - Appointment Eren Dogan UL-ER 462 WBAJN11080BK38366 ohne Termin.
2025-11-17 10:04:01,358 - ispa_next.appointments.models - DEBUG - Appointment Peter Wagner NU-XL 48 WBATY55020N009035 ohne Termin.
2025-11-17 10:04:01,380 - ispa_next.appointments.models - DEBUG - Appointment Sasa Fuchs UL-E 2299 WBA11AS0X0CE79272 ohne Termin.
2025-11-17 10:04:01,402 - ispa_next.appointments.models - DEBUG - Appointment Veselin Dokic NU-VD 443 WBA5V51090FH54319 ohne Termin.
2025-11-17 10:04:01,467 - ispa_next.appointments.models - DEBUG - Appointment Sonnentag Transporte GmbH GP-S 4500 WBAHF31020WW32817 ohne Termin.
2025-11-17 10:04:01,491 - ispa_next.appointments.models - DEBUG - Appointment Dieter Bienk NU-BI 38 WBA5R11070AK32098 ohne Termin.
2025-11-17 10:04:01,514 - ispa_next.appointments.models - DEBUG - Appointment Helmut Häuptle UL-MH 444 WBAVJ910X09C23552 ohne Termin.
2025-11-17 10:04:01,538 - ispa_next.appointments.models - DEBUG - Appointment Michael Durst BC-JD 2017 WBA6L51060FJ59063 ohne Termin.
2025-11-17 10:04:01,559 - ispa_next.appointments.models - DEBUG - Appointment Ervin Mujagic  WBATX35020NC23615 ohne Termin.
2025-11-17 10:04:01,591 - ispa_next.appointments.models - DEBUG - Appointment Arici Selcuk UL-KY 442 WBAVU31030KY03266 ohne Termin.
2025-11-17 10:04:01,619 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-17 10:04:01,645 - ispa_next.appointments.models - DEBUG - Appointment Durna Zeynep Incedayi UL-PX 1 WMWXT710102C14755 ohne Termin.
2025-11-17 10:04:01,677 - ispa_next.appointments.models - DEBUG - Appointment Özlem Sandikci NU-EE 1903 WMWLR910602E68924 ohne Termin.
2025-11-17 10:04:01,707 - ispa_next.appointments.models - DEBUG - Appointment Bareiss Prüfgerätebau GmbH UL-CX 288 WBA61EE0705W35665 ohne Termin.
2025-11-17 10:04:01,728 - ispa_next.appointments.models - DEBUG - Appointment Thomas Fundel UL-TF 260 WBA5V71050FH67905 ohne Termin.
2025-11-17 10:04:01,750 - ispa_next.appointments.models - DEBUG - Appointment Leandra Kuschel UL-LQ 13 WBAVB31060VB69085 ohne Termin.
2025-11-17 10:04:01,776 - ispa_next.appointments.models - DEBUG - Appointment Guido Steinhauser BC-G 225 WBAWZ510400S27474 ohne Termin.
2025-11-17 10:04:01,796 - ispa_next.appointments.models - DEBUG - Appointment Daniela Feinäugle  WBA5F31050FJ57747 ohne Termin.
2025-11-17 10:04:01,818 - ispa_next.appointments.models - DEBUG - Appointment Izzet özcelik ILL-Z 57 WBADY31070E827083 ohne Termin.
2025-11-17 10:04:01,849 - ispa_next.appointments.models - DEBUG - Appointment Salih Karadeniz UL-SK 157 WBAJN71010BJ06939 ohne Termin.
2025-11-17 10:04:01,872 - ispa_next.appointments.models - DEBUG - Appointment Marco Troiano UL-MT 386 WBA1R510905L60132 ohne Termin.
2025-11-17 10:04:01,894 - ispa_next.appointments.models - DEBUG - Appointment Autoforum-Muc NU-M 881 WBA11DX080CE08548 ohne Termin.
2025-11-17 10:04:01,916 - ispa_next.appointments.models - DEBUG - Appointment Hasib Mesic NU-HE 610 WBATX31060LC42685 ohne Termin.
2025-11-17 10:04:01,938 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Iman UL-EE 324 WBAUD71050P268270 ohne Termin.
2025-11-17 10:04:01,962 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-17 10:04:01,987 - ispa_next.appointments.models - DEBUG - Appointment Sascha Hankele NU-H 1820 WBAKD91000E653198 ohne Termin.
2025-11-17 10:04:02,009 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 1039E WBY31AW010FP54558 ohne Termin.
2025-11-17 10:04:02,032 - ispa_next.appointments.models - DEBUG - Appointment Janos Loboda UL-LJ 197 WBAVD91090AE65139 ohne Termin.
2025-11-17 10:04:02,057 - ispa_next.appointments.models - DEBUG - Appointment Emre Iman UL-EX 323 WBAAM31010AZ47872 ohne Termin.
2025-11-17 10:04:02,111 - ispa_next.main - DEBUG - Found 12 out of 195 appointments to process (configured limit: 15).
2025-11-17 10:04:02,111 - ispa_next.main - DEBUG - Processing 12 fresh appointments.
2025-11-17 10:04:02,111 - ispa_next.main - DEBUG - All appointments: UL-MS 1200, UL-A 3841, RV-LH 906E, UL-XB 915, UL-CD 711, UL LK 2000, GA447, NU J 3339, 3508, ul vk1010, UL-ST2016, UL-DS 5005
2025-11-17 10:04:02,113 - ispa_next.main - DEBUG - 



2025-11-17 10:04:02,113 - ispa_next.main - DEBUG - starting with process 1 (UL-MS 1200) of 12
2025-11-17 10:04:02,118 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:03,011 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:03,921 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1914
2025-11-17 10:04:03,923 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 752
2025-11-17 10:04:05,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:04:05,519 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:34,088 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:04:43,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:49,883 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:04:49,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:49,959 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:50,215 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:04:57,175 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:04:57,179 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:04:59,910 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:04:59,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:00,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:02,926 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:05:03,056 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:05:03,128 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:05:03,211 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:05:05,345 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:05:06,352 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:05:06,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:06,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:20,410 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:05:27,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:27,477 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:27,477 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:05:27,591 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:05:27,744 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:05:27,750 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:05:27,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:27,877 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:27,879 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:05:27,921 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:05:29,135 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:05:30,281 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:05:30,546 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:05:33,494 - ispa_next.functions - DEBUG - Updated appointment (GS00001287) customer contact data.
2025-11-17 10:05:34,410 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:05:34,414 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:05:35,116 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:05:35,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:05:35,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:05:40,370 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:40,370 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:05:40,375 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:05:40,376 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:05:40,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:40,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:45,063 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:05:45,879 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:06:01,147 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:06:01,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:01,360 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:06:07,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:07,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:07,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:08,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:08,338 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:06:14,302 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:06:14,305 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:06:15,614 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:06:15,616 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:15,617 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:06:15,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:15,620 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:06:15,621 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:06:15,622 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:06:15,623 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:06:15,624 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:06:15,626 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:06:15,626 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:06:15,628 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:06:15,632 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:06:15,635 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:06:15,640 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:06:15,653 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:22,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:22,387 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:06:31,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:49,353 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:06:49,355 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:06:49,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:06:50,133 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:06:50,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:09,816 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:07:09,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:16,506 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:07:31,610 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:07:32,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:32,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:07:33,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:45,938 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:51,398 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:57,351 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:06,317 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:08:06,321 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:07,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:08:07,598 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:08:07,600 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:08:15,303 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:08:28,164 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:08:28,556 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:08:30,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:37,475 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1916
2025-11-17 10:08:37,477 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:43,269 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1167
2025-11-17 10:08:43,270 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:44,356 - ispa_next.appointments.models - DEBUG - Appointment LEOFF Finanzstrategen GmbH HDH-L 9001 WBA61GE0607U42357 ohne Termin.
2025-11-17 10:08:44,372 - ispa_next.appointments.models - DEBUG - Appointment Dr. Appel Andreas UL-AA 913 WBATX35010NC37960 ohne Termin.
2025-11-17 10:08:44,378 - ispa_next.main - DEBUG - Found new Appointment: NU-A 1977
2025-11-17 10:08:44,378 - ispa_next.main - DEBUG - Found new Appointment: UL-KR 330
2025-11-17 10:08:44,381 - ispa_next.main - DEBUG - 



2025-11-17 10:08:44,381 - ispa_next.main - DEBUG - starting with process 2 (NU-A 1977) of 14
2025-11-17 10:08:44,387 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:46,064 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:47,706 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1916
2025-11-17 10:08:47,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1167
2025-11-17 10:08:50,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:50,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:24,457 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:09:35,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:35,607 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:35,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:36,410 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:09:36,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:36,579 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:36,866 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:09:45,290 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:09:45,293 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:09:48,379 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:09:48,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:49,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:51,185 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:09:51,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 10:09:52,319 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:09:52,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:52,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:09,784 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:10:18,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:18,876 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:18,876 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:10:19,035 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:10:19,198 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:10:19,204 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:10:19,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:19,304 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:19,304 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:10:19,349 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:10:20,681 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:10:20,897 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:10:24,246 - ispa_next.functions - DEBUG - Updated appointment (GS00001294) customer contact data.
2025-11-17 10:10:25,182 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:10:25,186 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:10:26,201 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:10:26,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:10:27,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:10:30,692 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:30,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:31,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:33,883 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:10:33,998 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:37,303 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:37,402 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:10:37,402 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:10:49,428 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:11:49,430 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:01,357 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:12:09,150 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:12:09,150 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:12:13,372 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:12:14,380 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:12:14,381 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:12:14,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:14,507 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:12:18,630 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:12:18,635 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:12:18,635 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:12:18,636 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:12:20,589 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:12:20,591 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:12:21,802 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:12:21,804 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:12:21,804 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:12:21,806 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:12:21,808 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:12:21,810 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:12:21,810 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:12:21,812 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:12:21,812 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:12:21,814 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:12:21,822 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:12:21,827 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:12:21,839 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:12:21,843 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:12:21,847 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:12:21,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:23,884 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:12:23,886 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:12:23,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:12:24,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:12:24,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:33,491 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:12:33,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:35,587 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:12:51,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:53,647 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-17 10:12:53,653 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:12:54,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:12:54,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:12:55,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:03,305 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:13:09,677 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:13:09,681 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:13:09,681 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:10,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:13:10,861 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:13:10,864 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:13:13,897 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:13:26,265 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:13:26,647 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:13:27,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:34,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1917
2025-11-17 10:13:34,704 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:40,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1168
2025-11-17 10:13:40,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:13:41,994 - ispa_next.appointments.models - DEBUG - Appointment Dr. Appel Andreas UL-AA 913 WBATX35010NC37960 ohne Termin.
2025-11-17 10:13:41,998 - ispa_next.main - DEBUG - Found new Appointment: HDH-L 9001
2025-11-17 10:13:42,000 - ispa_next.main - DEBUG - 



2025-11-17 10:13:42,000 - ispa_next.main - DEBUG - starting with process 3 (HDH-L 9001) of 15
2025-11-17 10:13:42,004 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:43,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:45,538 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1917
2025-11-17 10:13:45,540 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1168
2025-11-17 10:13:48,365 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:48,367 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:24,412 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:14:36,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:37,087 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:37,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:39,297 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:14:39,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:39,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:39,795 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:14:48,970 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:14:48,973 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:14:51,769 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:14:51,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:53,138 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:55,143 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:14:55,285 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:14:58,609 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:14:58,855 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:14:58,855 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:11,298 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:15:12,307 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:15:12,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:12,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:17,751 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:15:17,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:17,868 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:17,868 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:15:18,130 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:15:18,268 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:15:18,274 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:15:18,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:18,388 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:18,388 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:15:18,466 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:15:19,773 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:15:20,812 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:15:21,011 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:15:23,202 - ispa_next.functions - DEBUG - Updated appointment (GS00001296) customer contact data.
2025-11-17 10:15:24,133 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:15:24,136 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:15:25,468 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:15:25,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:15:26,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:15:30,970 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:30,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:31,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:33,574 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:33,742 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:15:33,915 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:15:34,032 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:15:34,032 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:45,301 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:15:53,183 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:15:53,183 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:15:57,465 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:15:58,474 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:15:58,474 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:15:58,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:58,557 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:02,713 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:16:02,720 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:16:02,720 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:16:02,721 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:16:05,163 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:16:05,165 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:16:06,382 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:16:06,384 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:06,388 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:16:06,388 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:06,390 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:16:06,390 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:16:06,392 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:16:06,392 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:16:06,395 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:16:06,396 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:16:06,397 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:16:06,398 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:16:06,402 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:16:06,404 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:16:06,408 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:16:06,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:09,027 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:16:09,031 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:16:09,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:16:09,951 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:16:10,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:27,030 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:16:27,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:29,681 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:16:45,887 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:16:46,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:16:47,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:16:47,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:55,933 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:00,465 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:05,787 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:05,790 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:17:05,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:06,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:06,989 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:17:06,992 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:17:10,012 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:17:21,158 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:17:21,551 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:17:22,218 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:17:29,346 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1919
2025-11-17 10:17:29,348 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:17:35,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1169
2025-11-17 10:17:35,512 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:17:36,524 - ispa_next.appointments.models - DEBUG - Appointment Marianne Rübesamen NU-CD 271 WBAUE510X0JW18304 ohne Termin.
2025-11-17 10:17:36,535 - ispa_next.appointments.models - DEBUG - Appointment Claus Pacchiaffo UL-CP 93 WBA21BY0407R63980 ohne Termin.
2025-11-17 10:17:36,544 - ispa_next.main - DEBUG - 



2025-11-17 10:17:36,544 - ispa_next.main - DEBUG - starting with process 4 (UL-KR 330) of 15
2025-11-17 10:17:36,549 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:38,338 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:17:39,940 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1919
2025-11-17 10:17:39,941 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1169
2025-11-17 10:17:42,629 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:17:42,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:18:27,779 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:18:38,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:44,101 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:18:44,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:44,213 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:44,508 - ispa_next.functions - DEBUG - HU date already expired after 285 days.
2025-11-17 10:18:54,338 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:18:54,343 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:18:57,317 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:18:57,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:58,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:00,772 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:19:00,924 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:19:01,087 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:19:01,207 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:19:03,368 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:19:04,375 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:19:04,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:04,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:20,570 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:19:20,572 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:19:30,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:30,557 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:30,557 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:19:30,815 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:19:30,966 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:19:30,970 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:19:30,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:31,093 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:31,093 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:19:31,165 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:19:31,381 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:19:32,841 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:19:33,066 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:19:36,734 - ispa_next.functions - DEBUG - Updated appointment (GS00001290) customer contact data.
2025-11-17 10:19:37,686 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:19:37,690 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:19:37,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:19:39,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:19:41,124 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:19:41,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:19:41,234 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:19:45,807 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:45,807 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:19:45,814 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:19:45,816 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:19:45,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:46,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:50,556 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:19:51,802 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:20:02,259 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:20:02,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:02,343 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:20:11,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:12,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:12,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:13,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:13,176 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:20:19,219 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:20:19,225 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:20:20,666 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:20:20,677 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:20,681 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:20:20,681 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:20,685 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:20:20,688 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:20:20,693 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:20:20,695 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:20:20,697 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:20:20,699 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:20:20,699 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:20:20,701 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:20:20,705 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:20:20,709 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:20:20,713 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:20:20,715 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:27,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:27,575 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:20:38,207 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:20:38,209 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:20:38,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:20:39,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:20:39,505 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:03,737 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:21:03,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:10,552 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:21:26,468 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:21:26,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:27,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:21:27,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:41,366 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:46,897 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:52,867 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:59,230 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:07,952 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:22:07,954 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:09,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:09,167 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:22:09,171 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:22:16,703 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:22:29,333 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:22:29,736 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:22:30,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:38,209 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1920
2025-11-17 10:22:38,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:43,794 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1170
2025-11-17 10:22:43,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:45,019 - ispa_next.appointments.models - DEBUG - Appointment Maria Heim UL-YH 27 WBAWK710X0P298265 ohne Termin.
2025-11-17 10:22:45,028 - ispa_next.main - DEBUG - Found new Appointment: NU-CD 271
2025-11-17 10:22:45,029 - ispa_next.main - DEBUG - Found new Appointment: UL-CP 93
2025-11-17 10:22:45,033 - ispa_next.main - DEBUG - 



2025-11-17 10:22:45,033 - ispa_next.main - DEBUG - starting with process 5 (NU-CD 271) of 17
2025-11-17 10:22:45,038 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:46,612 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:48,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1920
2025-11-17 10:22:48,135 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1170
2025-11-17 10:22:51,112 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:51,113 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:28,309 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:23:40,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:41,061 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:41,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:43,893 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:23:43,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:43,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:44,364 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:23:44,367 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:23:47,504 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:47,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:48,875 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:50,880 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:23:58,174 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:24:07,296 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:24:08,302 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:24:08,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:08,868 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:22,271 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:24:32,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:32,567 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:32,567 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:24:32,842 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:24:32,971 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:24:32,976 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:24:32,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:33,118 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:33,119 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:24:33,164 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:24:33,375 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:24:34,724 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:24:34,948 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:24:38,651 - ispa_next.functions - DEBUG - Updated appointment (HO00000794) customer contact data.
2025-11-17 10:24:39,583 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:24:39,587 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:24:39,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:24:40,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:24:42,310 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:24:42,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:24:42,402 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:24:46,520 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:24:46,522 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:46,522 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:24:46,528 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:24:46,528 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:24:46,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:47,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:51,210 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:24:51,215 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:24:51,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:51,341 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:24:51,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:52,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:52,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:53,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:53,079 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:24:56,114 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:24:56,116 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:24:57,300 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:24:57,302 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:24:57,302 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:24:57,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:24:57,304 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:24:57,306 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:24:57,306 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:24:57,308 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:24:57,309 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:24:57,310 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:24:57,311 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:24:57,312 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:24:57,316 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:24:57,320 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:24:57,322 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:24:57,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:00,710 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:25:00,715 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:25:00,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:25:01,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:25:01,582 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:25:01,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:04,946 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:25:19,911 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:25:20,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:21,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:25:21,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:31,283 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:37,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:42,417 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:49,978 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:25:49,978 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:51,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:51,121 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:25:51,124 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:25:58,716 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:26:09,983 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:26:10,360 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:26:10,872 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:18,200 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1920
2025-11-17 10:26:18,202 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:24,606 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1169
2025-11-17 10:26:24,607 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:25,827 - ispa_next.main - DEBUG - Found new Appointment: UL-YH 27
2025-11-17 10:26:25,829 - ispa_next.main - DEBUG - 



2025-11-17 10:26:25,829 - ispa_next.main - DEBUG - starting with process 6 (UL-YH 27) of 18
2025-11-17 10:26:25,834 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:27,631 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:29,377 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1920
2025-11-17 10:26:29,378 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1169
2025-11-17 10:26:32,235 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:32,237 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:27:09,983 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:27:23,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:23,835 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:24,097 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:28,892 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:27:28,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:28,990 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:29,272 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:27:29,276 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:27:32,312 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:27:32,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:33,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:35,692 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:27:43,350 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:27:53,065 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:27:54,072 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:27:54,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:54,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:09,080 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:28:18,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:19,075 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:19,076 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:28:19,280 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:28:19,426 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:28:19,432 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:28:19,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:19,526 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:19,527 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:28:19,580 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:28:19,735 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:28:21,075 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:28:21,278 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:28:25,048 - ispa_next.functions - DEBUG - Updated appointment (HO00000797) customer contact data.
2025-11-17 10:28:25,957 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:28:25,961 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:28:26,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:28:27,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:28:28,699 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:28:28,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:28:28,789 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:28:32,557 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:28:32,559 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:28:32,563 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:28:32,563 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:28:32,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:33,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:37,272 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:28:37,278 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:28:37,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:37,398 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:28:37,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:38,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:38,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:39,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:39,201 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:28:44,056 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:28:44,071 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:28:45,646 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:28:45,650 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:28:45,663 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:28:45,665 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:28:45,669 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:28:45,677 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:28:45,679 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:28:45,681 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:28:45,700 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:28:45,702 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:28:45,704 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:28:45,706 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:28:45,711 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:28:45,715 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:28:45,719 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:28:45,723 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:51,132 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:28:51,136 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:28:51,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:28:52,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:28:52,131 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:28:52,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:57,565 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:29:12,867 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:29:13,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:13,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:29:14,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:26,641 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:32,960 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:41,220 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:47,516 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:53,544 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:59,968 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:09,129 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:30:09,131 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:30:10,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:30:10,415 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:30:10,418 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:30:18,571 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:30:32,542 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:30:32,919 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:30:33,708 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:41,114 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1923
2025-11-17 10:30:41,116 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:46,581 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1171
2025-11-17 10:30:46,582 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:47,557 - ispa_next.appointments.models - DEBUG - Appointment Hermann Fromm UL-HF 111 WBA2A31070V419193 ohne Termin.
2025-11-17 10:30:47,564 - ispa_next.main - DEBUG - Found new Appointment: NU-WJ 400E
2025-11-17 10:30:47,566 - ispa_next.main - DEBUG - 



2025-11-17 10:30:47,566 - ispa_next.main - DEBUG - starting with process 7 (NU-WJ 400E) of 19
2025-11-17 10:30:47,571 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:30:49,229 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:51,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1923
2025-11-17 10:30:51,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1171
2025-11-17 10:30:54,241 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:54,243 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:31:42,499 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:31:55,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:00,070 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:32:00,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:00,143 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:00,394 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:32:00,398 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:32:03,344 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:32:03,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:04,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:32:06,483 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:32:06,596 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:32:06,744 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:32:06,830 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:32:11,082 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:32:12,088 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:32:12,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:12,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:28,475 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:32:28,475 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:32:37,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:38,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:38,104 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:32:38,326 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:32:38,473 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:32:38,478 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:32:38,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:38,583 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:38,583 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:32:38,666 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:32:39,983 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:32:40,211 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:32:44,048 - ispa_next.functions - DEBUG - Updated appointment (HO00000799) customer contact data.
2025-11-17 10:32:44,954 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:32:44,993 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:32:46,843 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:32:46,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:32:47,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:32:51,461 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:32:51,463 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:32:51,467 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:32:51,469 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:32:51,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:52,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:32:56,216 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:32:57,215 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:33:07,659 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:33:07,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:07,742 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:33:13,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:13,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:13,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:14,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:14,864 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:33:19,211 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:33:19,213 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:33:20,401 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:33:20,405 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:33:20,413 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:33:20,417 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:33:20,419 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:33:20,421 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:33:20,422 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:33:20,423 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:33:20,425 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:33:20,444 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:33:20,446 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:33:20,448 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:33:20,452 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:33:20,456 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:33:20,458 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:33:20,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:25,213 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:33:25,216 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:33:25,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:33:26,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:33:26,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:40,325 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:33:40,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:45,088 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:33:59,458 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:33:59,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:34:00,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:34:00,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:12,179 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:34:18,310 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:34:24,412 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:34:32,165 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:34:38,942 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:34:48,146 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:34:48,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:34:49,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:34:49,461 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:34:49,464 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:34:56,787 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:35:10,550 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:35:10,949 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:35:11,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:19,352 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1924
2025-11-17 10:35:19,354 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:25,732 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1171
2025-11-17 10:35:25,733 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:35:27,019 - ispa_next.main - DEBUG - Found new Appointment: UL-HF 111
2025-11-17 10:35:27,021 - ispa_next.main - DEBUG - 



2025-11-17 10:35:27,021 - ispa_next.main - DEBUG - starting with process 8 (UL-HF 111) of 20
2025-11-17 10:35:27,025 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:35:28,870 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:30,706 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1924
2025-11-17 10:35:30,708 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1171
2025-11-17 10:35:33,459 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:33,460 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:36:09,775 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:36:23,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:26,472 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:36:26,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:26,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:26,951 - ispa_next.functions - DEBUG - HU date already expired after 1628 days.
2025-11-17 10:36:35,711 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:36:35,715 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:36:38,629 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:36:38,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:39,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:41,944 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:36:42,127 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:36:45,659 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:36:45,772 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:36:47,954 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:36:48,960 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:36:48,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:49,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:06,086 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:37:15,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:15,989 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:37:15,989 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:37:16,194 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:37:16,313 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:37:16,317 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:37:16,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:16,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:37:16,487 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:37:16,541 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:37:16,682 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:37:18,053 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:37:19,358 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:37:19,785 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:37:22,894 - ispa_next.functions - DEBUG - Updated appointment (HO00000801) customer contact data.
2025-11-17 10:37:23,800 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:37:23,803 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:37:24,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:37:25,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:37:27,462 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:37:27,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:37:27,629 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:37:31,272 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:37:31,273 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:37:31,277 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:37:31,279 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:37:31,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:31,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:36,015 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:37:37,285 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:37:48,564 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:37:48,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:48,677 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:49,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:49,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:49,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:50,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:50,596 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:37:54,398 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:37:54,400 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:37:55,583 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:37:55,587 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:55,591 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:37:55,593 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:55,595 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:37:55,597 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:37:55,598 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:37:55,598 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:37:55,600 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:37:55,602 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:37:55,602 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:37:55,604 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:37:55,609 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:37:55,612 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:37:55,615 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:37:55,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:59,807 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:37:59,810 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:37:59,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:38:00,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:38:01,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:11,035 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:38:11,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:15,119 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:38:31,457 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:38:31,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:32,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:38:32,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:43,809 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:50,074 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:56,493 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:05,104 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:05,105 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:06,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:06,380 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:06,383 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:14,138 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:39:28,212 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:39:28,604 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:39:29,447 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:36,575 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1925
2025-11-17 10:39:36,576 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:42,470 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1172
2025-11-17 10:39:42,471 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:43,528 - ispa_next.appointments.models - DEBUG - Appointment Tom Luib UL-MT 2609 WBA55DP080N172507 ohne Termin.
2025-11-17 10:39:43,536 - ispa_next.main - DEBUG - 



2025-11-17 10:39:43,537 - ispa_next.main - DEBUG - starting with process 9 (UL-CP 93) of 20
2025-11-17 10:39:43,542 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:45,037 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:46,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1925
2025-11-17 10:39:46,462 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1172
2025-11-17 10:39:49,767 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:49,769 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:29,027 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:40:43,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:44,950 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:40:44,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:45,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:45,423 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:40:45,428 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:40:48,558 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:48,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:50,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:52,068 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:52,225 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:55,488 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:55,571 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:40:59,762 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:41:00,770 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:41:00,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:01,299 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:17,162 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:41:17,163 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:41:27,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:27,674 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:27,674 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:41:27,851 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:41:28,009 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:41:28,015 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:41:28,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:28,118 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:28,119 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:41:28,224 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:41:29,541 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:41:29,755 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:41:33,474 - ispa_next.functions - DEBUG - Updated appointment (HO00000793) customer contact data.
2025-11-17 10:41:34,467 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:41:34,472 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:41:36,296 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:41:36,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:37,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:41:41,145 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:41,145 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:41:41,150 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:41:41,151 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:41:41,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:41,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:45,826 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:41:45,832 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:41:45,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:45,957 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:41:51,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:52,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:52,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:53,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:53,129 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:41:55,053 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:41:55,057 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:41:56,356 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:41:56,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:41:56,360 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:41:56,360 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:41:56,362 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:41:56,368 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:41:56,370 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:41:56,372 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:41:56,376 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:41:56,377 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:41:56,378 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:41:56,380 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:41:56,384 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:41:56,386 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:41:56,390 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:41:56,392 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:58,361 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:41:58,366 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:41:58,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:41:59,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:41:59,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:10,677 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:42:10,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:12,609 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:42:29,259 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:42:29,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:30,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:42:30,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:39,988 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:48,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:48,652 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:48,652 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:49,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:49,555 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:49,557 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:42:51,902 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:43:04,014 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:43:04,383 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:43:05,316 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:13,215 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1925
2025-11-17 10:43:13,226 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:20,348 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1172
2025-11-17 10:43:20,349 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:21,997 - ispa_next.main - DEBUG - Found new Appointment: UL-MT 2609
2025-11-17 10:43:22,000 - ispa_next.main - DEBUG - 



2025-11-17 10:43:22,000 - ispa_next.main - DEBUG - starting with process 10 (UL-MT 2609) of 21
2025-11-17 10:43:22,007 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:23,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:25,901 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1925
2025-11-17 10:43:25,902 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1172
2025-11-17 10:43:28,773 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:28,774 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:21,956 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:44:35,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:35,701 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:35,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:41,461 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:44:41,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:41,536 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:41,926 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:44:41,928 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:44:45,171 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:45,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:46,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:48,813 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:48,967 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:49,156 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:49,280 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:44:49,280 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:45:00,852 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:45:09,158 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:45:09,158 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:45:11,357 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:45:12,365 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:45:12,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:13,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:32,600 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:45:44,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:44,382 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:44,382 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:45:44,673 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:45:44,816 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:45:44,820 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:45:44,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:44,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:44,926 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:45:44,985 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:45:46,322 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:45:47,547 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:45:47,770 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:45:51,447 - ispa_next.functions - DEBUG - Updated appointment (GT00001001) customer contact data.
2025-11-17 10:45:52,450 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:45:52,455 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:45:54,532 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:45:54,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:45:55,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:45:59,362 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:59,362 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:45:59,366 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:45:59,366 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:45:59,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:59,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:46:04,075 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:46:05,421 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:46:18,748 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:46:18,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:18,865 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:46:19,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:19,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:19,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:20,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:46:20,753 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:46:26,940 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:46:26,943 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:46:28,318 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:46:28,320 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:46:28,322 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:46:28,324 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:46:28,324 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:46:28,326 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:46:28,328 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:46:28,334 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:46:28,339 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:46:28,341 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:46:28,343 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:46:28,345 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:46:28,349 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:46:28,351 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:46:28,355 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:46:28,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:35,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:36,016 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:46:45,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:04,414 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:47:04,416 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:47:04,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:47:05,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:47:05,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:16,417 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:47:16,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:23,487 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:47:40,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:47,378 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-17 10:47:47,384 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:47:47,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:47:48,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:47:48,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:03,287 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:09,897 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:16,608 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:25,085 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:25,085 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:26,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:26,497 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:26,501 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:48:33,562 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:48:46,302 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:48:46,704 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:48:48,076 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:55,482 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1926
2025-11-17 10:48:55,484 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:01,519 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1174
2025-11-17 10:49:01,519 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:02,489 - ispa_next.appointments.models - DEBUG - Appointment Cerence GmbH MON-CC 480 WBAJJ310505T98663 ohne Termin.
2025-11-17 10:49:02,503 - ispa_next.appointments.models - DEBUG - Appointment Edgard Ponkratenko UL-EP 91 WBAFV31000DP47809 ohne Termin.
2025-11-17 10:49:02,511 - ispa_next.main - DEBUG - 



2025-11-17 10:49:02,511 - ispa_next.main - DEBUG - starting with process 11 (UL-A 3841) of 21
2025-11-17 10:49:02,515 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:03,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:49:05,486 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1926
2025-11-17 10:49:05,488 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1174
2025-11-17 10:49:08,564 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:49:08,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:49,777 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:50:03,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:03,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:03,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:05,872 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:50:05,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:05,981 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:06,210 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:50:06,217 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:50:09,169 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:09,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:11,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:13,029 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:13,161 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:16,477 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:16,555 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:16,555 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:28,787 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:50:29,796 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:50:29,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:30,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:45,760 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:50:55,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:56,054 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:56,054 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:50:56,322 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:50:56,458 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:50:56,463 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:50:56,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:56,574 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:56,575 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:50:56,673 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:50:58,112 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:50:58,327 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:51:02,293 - ispa_next.functions - DEBUG - Updated appointment (GA00001118) customer contact data.
2025-11-17 10:51:03,283 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:51:03,286 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:51:05,293 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:51:05,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:51:06,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:51:10,523 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:51:10,524 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:51:10,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:11,067 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:13,072 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:51:13,217 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:51:13,365 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:51:13,476 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:51:13,476 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:51:24,879 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:51:32,886 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:51:32,886 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:51:37,134 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:51:38,141 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:51:38,143 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:51:38,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:38,272 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:42,477 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:51:42,485 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:51:42,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:42,575 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:51:42,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:43,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:43,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:44,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:44,340 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:51:46,222 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:51:46,224 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:51:47,414 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:51:47,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:47,416 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:51:47,418 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:47,419 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:51:47,421 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:51:47,431 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:51:47,433 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:51:47,435 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:51:47,436 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:51:47,437 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:51:47,439 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:51:47,444 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:51:47,447 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:51:47,449 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:51:47,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:49,475 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:51:49,477 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:51:49,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:51:50,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:51:50,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:59,357 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:51:59,360 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:01,289 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:52:17,858 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:52:18,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:52:19,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:52:19,420 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:28,551 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:52:35,289 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:52:35,293 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:52:35,293 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:52:36,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:52:36,542 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:52:36,545 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:52:39,391 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:52:52,104 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:52:52,471 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:52:53,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:01,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1929
2025-11-17 10:53:01,704 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:07,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 10:53:07,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:08,971 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Braun UL-LX 22 WBAUM91070VP79888 ohne Termin.
2025-11-17 10:53:08,980 - ispa_next.main - DEBUG - Found new Appointment: MON-CC 480
2025-11-17 10:53:08,980 - ispa_next.main - DEBUG - Found new Appointment: UL-EP 91
2025-11-17 10:53:08,983 - ispa_next.main - DEBUG - 



2025-11-17 10:53:08,983 - ispa_next.main - DEBUG - starting with process 12 (MON-CC 480) of 23
2025-11-17 10:53:08,987 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:53:10,418 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:53:11,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1929
2025-11-17 10:53:11,967 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 10:53:14,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:53:14,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:56,296 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:54:10,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:17,905 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:54:17,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:18,007 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:54:18,327 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:54:18,331 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:54:21,365 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:54:21,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:54:22,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:54:24,978 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:54:25,112 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:54:25,251 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:54:25,334 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:54:29,568 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:54:30,577 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:54:30,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:31,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:49,691 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:55:00,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:00,882 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:00,882 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 10:55:01,097 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 10:55:01,222 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 10:55:01,228 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:55:01,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:01,348 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:01,348 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:55:01,409 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:55:01,579 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:55:02,761 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:55:04,108 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:55:04,503 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:55:06,573 - ispa_next.functions - DEBUG - Updated appointment (GZ00000949) customer contact data.
2025-11-17 10:55:07,509 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:55:07,514 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:55:07,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:55:09,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:55:10,893 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:55:10,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:55:11,013 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:55:14,639 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:55:14,639 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:55:14,643 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:55:14,645 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:55:14,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:15,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:19,351 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:55:20,737 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:55:35,507 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:55:35,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:35,620 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:55:36,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:36,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:36,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:37,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:37,401 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:55:44,230 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:55:44,243 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:55:45,910 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:55:45,912 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:55:45,914 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:55:45,914 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:55:45,916 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:55:45,918 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=manual, target=advice_list), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=manual, target=advice_list)}
2025-11-17 10:55:45,924 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:55:45,928 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:55:45,932 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:55:45,934 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:55:45,937 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:55:46,639 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:55:57,766 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:55:57,770 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:55:57,774 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:55:57,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:05,805 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:56:05,809 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:56:05,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:56:07,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:56:07,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:22,416 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:56:22,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:30,287 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:56:49,288 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:56:49,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:56:50,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:56:50,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:05,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:11,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:16,959 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:23,921 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:32,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:38,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:45,738 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:55,374 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:57:55,375 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:56,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:57:56,804 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:57:56,808 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:58:04,339 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:58:17,432 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:58:17,820 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:58:18,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:58:26,355 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1930
2025-11-17 10:58:26,355 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:58:32,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 10:58:32,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:33,975 - ispa_next.appointments.models - DEBUG - Appointment Josef Rieger UL-RJ 54 WBA8G31070AF90240 ohne Termin.
2025-11-17 10:58:33,985 - ispa_next.main - DEBUG - Found new Appointment: UL-LX 22
2025-11-17 10:58:33,986 - ispa_next.main - DEBUG - 



2025-11-17 10:58:33,986 - ispa_next.main - DEBUG - starting with process 13 (UL-LX 22) of 24
2025-11-17 10:58:33,991 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:58:35,923 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:58:37,706 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1930
2025-11-17 10:58:37,708 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 10:58:40,760 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:58:40,761 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:59:21,284 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:59:34,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:34,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:34,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:37,574 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:59:37,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:37,706 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:38,102 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:59:38,106 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:59:41,191 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:59:41,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:42,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:59:44,894 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:59:53,045 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:00:03,579 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:00:04,586 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:00:04,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:05,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:23,070 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:00:33,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:33,459 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:00:33,460 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:00:33,705 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:00:33,869 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:00:33,875 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:00:33,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:33,975 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:00:33,976 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:00:34,098 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:00:34,296 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:00:35,708 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:00:35,972 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:00:40,165 - ispa_next.functions - DEBUG - Updated appointment (HV00000594) customer contact data.
2025-11-17 11:00:41,182 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:00:41,189 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:00:41,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:00:42,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:00:44,958 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:00:44,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:00:45,290 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:00:48,886 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:00:48,887 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:00:48,892 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:00:48,893 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:00:48,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:49,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:00:53,629 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:00:53,634 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:00:53,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:53,741 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:00:54,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:54,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:54,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:55,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:00:55,461 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:00:58,611 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:00:58,616 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:01:00,273 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:01:00,275 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:01:00,277 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:01:00,278 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:01:00,280 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:01:00,281 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:01:00,282 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:01:00,284 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:01:00,285 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:01:00,286 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:01:00,288 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:01:00,289 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:01:00,301 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:01:00,304 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:01:00,307 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:01:00,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:03,869 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:01:03,873 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:01:03,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:01:05,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:01:05,263 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:01:05,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:08,836 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:01:24,280 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:01:24,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:01:25,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:01:25,755 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:36,919 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:01:44,193 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:01:52,493 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:01:52,495 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:01:53,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:01:53,560 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:01:53,562 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:02:00,848 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:02:14,791 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:02:15,186 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 11:02:16,215 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:02:24,681 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1930
2025-11-17 11:02:24,683 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:02:32,700 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 11:02:32,701 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:02:33,980 - ispa_next.main - DEBUG - Found new Appointment: UL-RJ 54
2025-11-17 11:02:33,982 - ispa_next.main - DEBUG - 



2025-11-17 11:02:33,983 - ispa_next.main - DEBUG - starting with process 14 (UL-RJ 54) of 25
2025-11-17 11:02:33,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:02:35,973 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:02:38,041 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1930
2025-11-17 11:02:38,042 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 11:02:41,019 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:02:41,020 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:27,246 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:03:41,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:48,403 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:03:48,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:48,500 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:49,008 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:03:49,012 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:03:52,140 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:03:52,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:03:53,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:03:55,843 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:03:55,958 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:03:59,273 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:03:59,373 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:04:03,605 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:04:04,637 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:04:04,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:05,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:21,899 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:04:33,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:33,178 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:33,178 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:04:33,366 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:04:33,542 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:04:33,547 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:04:33,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:33,704 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:33,705 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:04:33,757 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:04:35,145 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:04:36,514 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:04:36,721 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:04:40,971 - ispa_next.functions - DEBUG - Updated appointment (DI00004360) customer contact data.
2025-11-17 11:04:41,984 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:04:41,995 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:04:44,499 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:04:44,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:04:45,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:04:50,163 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 11:04:50,163 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:04:50,163 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:04:50,167 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:04:50,169 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:04:50,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:50,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:54,877 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:04:54,883 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:04:54,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:55,020 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:04:55,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:55,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:55,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:56,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:56,851 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:05:03,129 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:05:03,134 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:05:04,630 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:05:04,630 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:05:04,634 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:05:04,636 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:05:04,638 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:05:04,642 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:05:04,645 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:05:04,646 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:05:04,649 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:05:04,649 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:05:04,651 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:05:04,652 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:05:04,657 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:05:04,659 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:05:04,662 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:05:04,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:11,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:05:11,791 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:05:24,126 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:05:24,130 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:05:24,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:05:25,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:05:25,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:35,491 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:05:35,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:42,490 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:05:58,106 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:05:58,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:59,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:05:59,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:13,756 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:06:20,988 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:06:29,714 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:06:40,232 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:06:40,234 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:06:41,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:06:41,615 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:06:41,620 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:06:49,876 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:07:05,628 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:07:06,026 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 11:07:07,721 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:15,425 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1930
2025-11-17 11:07:15,426 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:07:21,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 11:07:21,527 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:22,660 - ispa_next.main - DEBUG - 



2025-11-17 11:07:22,660 - ispa_next.main - DEBUG - starting with process 15 (UL-EP 91) of 25
2025-11-17 11:07:22,680 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:07:24,478 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:26,568 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1930
2025-11-17 11:07:26,570 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 11:07:29,723 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:07:29,724 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:08:22,488 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:08:35,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:35,630 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:35,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:37,858 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:08:37,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:37,945 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:38,280 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:08:47,918 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:08:47,922 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:08:50,990 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:08:50,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:52,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:08:54,830 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:09:03,097 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:09:12,768 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:09:13,774 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:09:13,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:14,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:34,120 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:09:43,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:44,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:09:44,094 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:09:44,345 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:09:44,491 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:09:44,497 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:09:44,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:45,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:09:45,427 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:09:45,559 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:09:45,739 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:09:46,954 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:09:48,341 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:09:48,801 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:09:52,257 - ispa_next.functions - DEBUG - Updated appointment (GZ00000945) customer contact data.
2025-11-17 11:09:53,215 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:09:53,292 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:09:53,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:09:54,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:09:56,661 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:09:57,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:09:57,116 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:10:00,849 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:10:00,850 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:10:00,854 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:10:00,856 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:10:00,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:01,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:05,563 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:10:05,569 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:10:05,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:05,682 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:10:06,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:06,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:06,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:07,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:07,496 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:10:10,105 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:10:10,107 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:10:11,559 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:10:11,561 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:10:11,563 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:10:11,563 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:10:11,565 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:10:11,567 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:10:11,569 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:10:11,573 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:10:11,575 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:10:11,579 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:10:11,581 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:10:11,581 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:10:11,585 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:10:11,588 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:10:11,590 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:10:11,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:14,468 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:10:14,471 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:10:14,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:10:15,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:10:15,842 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:10:15,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:18,670 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:10:33,449 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:10:33,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:34,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:10:35,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:45,333 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:51,899 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:58,612 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:58,615 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:10:58,616 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:10:59,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:59,619 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:10:59,623 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:11:02,227 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:11:13,910 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:11:14,305 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 11:11:15,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:11:23,739 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1931
2025-11-17 11:11:23,741 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:11:31,520 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 11:11:31,521 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:11:33,825 - ispa_next.main - DEBUG - 



2025-11-17 11:11:33,825 - ispa_next.main - DEBUG - starting with process 16 (RV-LH 906E) of 25
2025-11-17 11:11:33,831 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:11:35,747 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:11:37,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1931
2025-11-17 11:11:37,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 11:11:41,549 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:11:41,552 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:24,251 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:12:36,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:36,672 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:12:36,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:12:38,914 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:12:38,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:39,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:12:39,306 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:12:39,310 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:12:42,405 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:12:42,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:44,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:12:46,374 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:12:46,531 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:12:49,944 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:12:50,108 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:12:50,108 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:13:02,811 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:13:03,830 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:13:03,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:04,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:24,484 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:13:37,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:37,155 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:37,155 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:13:37,390 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:13:37,515 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:13:37,520 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:13:37,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:37,672 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:37,673 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:13:37,763 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:13:39,339 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:13:40,657 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:13:40,894 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:13:45,820 - ispa_next.functions - DEBUG - Updated appointment (FP00002108) customer contact data.
2025-11-17 11:13:46,777 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:13:46,779 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:13:48,374 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:13:48,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:13:49,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:13:53,221 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:13:53,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:13:53,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:13:55,883 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:13:56,045 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:13:56,267 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:13:56,409 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:13:56,410 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:14:07,981 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:14:15,783 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:14:15,785 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:14:20,031 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:14:21,041 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:14:21,042 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:14:21,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:21,124 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:14:25,309 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:14:25,315 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:14:25,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:25,443 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:14:34,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:35,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:35,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:36,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:14:36,312 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:14:38,332 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:14:38,334 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:14:39,764 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:14:39,766 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:14:39,768 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:14:39,769 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:14:39,771 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:14:39,772 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:14:39,773 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:14:39,774 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:14:39,776 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:14:39,777 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:14:39,778 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:14:39,780 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:14:39,784 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:14:39,787 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:14:39,789 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:14:39,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:41,837 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:14:41,841 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:14:41,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:14:43,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:14:43,664 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:53,159 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:14:53,163 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:55,270 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:15:11,588 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:15:12,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:13,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:15:13,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:23,256 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:30,657 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:15:30,661 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:15:30,661 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:31,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:31,937 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:15:31,941 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:15:35,295 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:15:49,278 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:15:49,648 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 11:15:50,627 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:59,311 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1932
2025-11-17 11:15:59,313 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:16:06,534 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:16:06,535 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:07,726 - ispa_next.main - DEBUG - 



2025-11-17 11:16:07,726 - ispa_next.main - DEBUG - starting with process 17 (UL-XB 915) of 25
2025-11-17 11:16:07,732 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:16:09,341 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:16:10,923 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1932
2025-11-17 11:16:10,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:16:14,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:16:14,187 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:07,062 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:17:21,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:21,151 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:21,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:23,453 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:17:23,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:23,558 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:23,803 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:17:23,807 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:17:26,820 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:26,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:28,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:30,966 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:31,156 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:34,492 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:34,655 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:34,655 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:17:48,013 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:17:49,019 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:17:49,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:49,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:06,993 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:18:06,993 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:18:16,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:16,646 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:16,646 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:18:16,861 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:18:17,042 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:18:17,048 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:18:17,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:17,168 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:17,168 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:18:17,238 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:18:18,554 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:18:20,628 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:18:20,865 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:18:25,143 - ispa_next.functions - DEBUG - Updated appointment (FP00002105) customer contact data.
2025-11-17 11:18:26,088 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:18:26,104 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:18:27,558 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:18:27,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:18:28,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:18:33,076 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:18:33,076 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:18:33,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:33,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:35,683 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:18:35,847 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:18:36,048 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:18:36,171 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:18:36,171 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:18:48,526 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:19:48,529 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:59,534 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:20:07,598 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:20:07,598 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:20:11,839 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:20:12,846 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:20:12,847 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:20:12,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:12,956 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:20:17,120 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:20:17,127 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:20:17,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:17,246 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:20:17,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:18,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:18,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:19,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:20:19,016 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:20:21,053 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:20:21,057 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:20:22,775 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:20:22,777 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:20:22,779 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:20:22,781 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:20:22,787 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:20:22,797 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:20:22,801 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:20:22,803 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:20:22,803 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:20:22,805 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:20:22,809 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:20:22,809 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:20:22,815 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:20:22,817 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:20:22,821 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:20:22,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:24,968 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:20:24,973 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:20:24,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:20:26,138 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:20:26,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:35,356 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:20:35,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:37,328 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:20:53,959 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:20:54,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:20:55,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:20:55,719 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:05,480 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:13,189 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:13,192 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:21:13,193 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:14,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:14,526 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:21:14,528 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:21:17,762 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:21:31,792 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:21:32,175 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 11:21:33,355 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:41,922 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1936
2025-11-17 11:21:41,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:49,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:21:49,104 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:21:50,373 - ispa_next.appointments.models - DEBUG - Appointment Fliesen Galerie Comerc GmbH UL-HA 1066 WBA81CA0309P56642 ohne Termin.
2025-11-17 11:21:50,384 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Fischer UL-M 4427E WBY61EF0105079613 ohne Termin.
2025-11-17 11:21:50,392 - ispa_next.main - DEBUG - Found new Appointment: NU-DZ 1990
2025-11-17 11:21:50,393 - ispa_next.main - DEBUG - 



2025-11-17 11:21:50,393 - ispa_next.main - DEBUG - starting with process 18 (NU-DZ 1990) of 26
2025-11-17 11:21:50,398 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:51,958 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:53,610 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1936
2025-11-17 11:21:53,612 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:21:57,128 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:57,129 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:22:44,542 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:22:59,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:02,786 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:23:02,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:02,923 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:03,370 - ispa_next.functions - DEBUG - HU date already expired after 545 days.
2025-11-17 11:23:13,663 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:23:13,667 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:23:16,696 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:23:16,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:18,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:23:20,642 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:23:20,775 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:23:24,077 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:23:24,182 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:23:28,430 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:23:29,437 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:23:29,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:29,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:47,984 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:23:59,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:59,842 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:59,842 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:24:00,099 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:24:00,216 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:24:00,223 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:24:00,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:00,321 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:24:00,323 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:24:00,369 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:24:00,550 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:24:01,747 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 11:24:03,126 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 11:24:03,545 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:24:06,887 - ispa_next.functions - DEBUG - Updated appointment (KD00000193) customer contact data.
2025-11-17 11:24:07,930 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:24:07,934 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:24:09,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:24:10,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:24:12,461 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:24:12,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:24:13,247 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:24:17,777 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:24:17,777 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:24:17,783 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:24:18,050 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:24:18,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:18,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:24:23,148 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:24:23,154 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:24:23,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:23,260 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:24:26,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:27,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:27,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:28,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:24:28,205 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:24:32,699 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:24:32,704 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:24:34,325 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:24:34,327 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:34,329 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:24:34,329 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:34,331 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:24:34,331 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:24:34,333 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:24:34,333 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:24:34,335 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:24:34,335 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:24:34,337 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:24:34,339 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:24:34,341 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:24:34,345 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:24:34,349 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:24:34,353 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:39,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:39,543 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:24:51,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:08,797 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:25:08,800 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:25:08,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:25:10,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:25:11,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:23,447 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:25:23,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:28,671 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:25:45,036 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:25:45,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:46,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:25:46,747 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:59,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:26:07,670 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:26:16,249 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:26:25,783 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:26:25,784 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:26:27,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:26:27,117 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:26:27,121 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:26:35,153 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:26:59,426 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:26:59,430 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:26:59,432 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:27:00,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:27:00,774 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:27:00,776 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:27:04,027 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:27:04,061 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:27:08,131 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 11:27:08,137 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:27:16,436 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1938
2025-11-17 11:27:16,438 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:27:23,430 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1178
2025-11-17 11:27:23,431 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:27:24,694 - ispa_next.appointments.models - DEBUG - Appointment Matthias Preuß UL-HT 386 WBA71AC0203M97660 ohne Termin.
2025-11-17 11:27:24,703 - ispa_next.main - DEBUG - Found new Appointment: UL-HA 1066
2025-11-17 11:27:24,703 - ispa_next.main - DEBUG - Found new Appointment: UL-M 4427E
2025-11-17 11:27:24,704 - ispa_next.main - DEBUG - 



2025-11-17 11:27:24,704 - ispa_next.main - DEBUG - starting with process 19 (UL-HA 1066) of 28
2025-11-17 11:27:24,709 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:27:26,759 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:27:28,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1938
2025-11-17 11:27:28,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1178
2025-11-17 11:27:32,515 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:27:32,516 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:28:15,631 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:28:29,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:34,207 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:28:34,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:34,348 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:28:34,646 - ispa_next.functions - DEBUG - HU date soon to be invalid in 5 days.
2025-11-17 11:28:44,912 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:28:44,916 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:28:47,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:28:47,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:28:50,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:28:52,062 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:28:52,233 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:28:52,352 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:28:52,491 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:28:56,709 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:28:57,715 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:28:57,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:58,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:29:17,082 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:29:28,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:29:29,084 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:29:29,084 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:29:29,341 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:29:29,476 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:29:29,483 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:29:29,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:29:29,721 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:29:29,721 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:29:29,776 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:29:29,968 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:29:31,283 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:29:31,544 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:29:35,233 - ispa_next.functions - DEBUG - Updated appointment (KD00000195) customer contact data.
2025-11-17 11:29:36,152 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:29:36,156 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:29:36,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:29:38,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:29:40,488 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:29:40,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:29:41,296 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:29:44,965 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:29:44,965 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:29:44,968 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:29:44,970 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:29:44,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:29:45,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:29:49,927 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:29:50,930 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:30:02,004 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:30:02,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:02,117 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:30:09,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:10,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:10,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:11,610 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:30:11,612 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:30:16,769 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:30:16,770 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:30:18,498 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:30:18,500 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:30:18,502 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:30:18,504 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:30:18,506 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:30:18,509 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:30:18,512 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:30:18,513 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:30:18,513 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:30:18,515 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:30:18,517 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:30:18,519 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:30:18,523 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:30:18,526 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:30:18,530 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:30:18,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:24,363 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:30:24,367 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:30:24,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:30:25,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:30:26,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:50,895 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:30:50,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:56,727 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:31:14,579 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:31:15,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:31:16,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:31:16,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:29,862 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:31:37,116 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:31:44,869 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:31:54,766 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:31:54,768 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:31:55,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:31:56,099 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:31:56,102 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:32:05,171 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:32:19,439 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:32:19,832 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 11:32:21,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:32:29,528 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1938
2025-11-17 11:32:29,529 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:32:36,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:32:36,685 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:32:37,990 - ispa_next.main - DEBUG - Found new Appointment: UL-HT 386
2025-11-17 11:32:37,992 - ispa_next.main - DEBUG - 



2025-11-17 11:32:37,992 - ispa_next.main - DEBUG - starting with process 20 (UL-HT 386) of 29
2025-11-17 11:32:37,996 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:32:39,982 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:32:41,989 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1938
2025-11-17 11:32:41,991 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:32:45,686 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:32:45,688 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:33:32,932 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:33:48,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:52,779 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:33:52,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:33:52,898 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:33:53,255 - ispa_next.functions - DEBUG - HU date already expired after 738 days.
2025-11-17 11:34:04,083 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:34:04,087 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:34:07,277 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:34:07,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:09,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:34:11,375 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:34:11,563 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:34:14,948 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:34:26,342 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:34:27,347 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:34:27,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:27,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:45,814 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:34:57,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:58,089 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:58,089 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:34:58,302 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:34:58,452 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:34:58,457 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:34:58,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:58,531 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:58,531 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:34:58,583 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:34:59,922 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:35:01,170 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:35:01,404 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:35:04,937 - ispa_next.functions - DEBUG - Updated appointment (KK00000344) customer contact data.
2025-11-17 11:35:05,842 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:35:05,885 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:35:07,585 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:35:07,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:35:09,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:35:13,360 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 11:35:13,360 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:35:13,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:13,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:35:15,947 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:35:16,136 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:35:16,284 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:35:16,454 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:35:20,709 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:35:21,717 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:35:21,719 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:35:21,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:21,851 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:35:26,050 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:35:26,056 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:35:26,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:26,135 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:35:32,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:33,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:33,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:34,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:35:34,562 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:35:38,398 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:35:38,407 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:35:40,010 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:35:40,010 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:35:40,012 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:35:40,012 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:35:40,014 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:35:40,014 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:35:40,017 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:35:40,017 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:35:40,019 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:35:40,019 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:35:40,022 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:35:40,024 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:35:40,034 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:35:40,036 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:35:40,040 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:35:40,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:44,384 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:35:44,388 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:35:44,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:35:46,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:35:46,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:57,981 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:35:57,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:02,182 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:36:19,858 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:36:20,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:36:21,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:36:21,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:34,688 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:36:43,204 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:36:51,163 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:00,535 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:37:00,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:37:01,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:37:01,612 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:37:01,614 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:37:09,643 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:37:23,859 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:37:24,231 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 11:37:25,420 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:37:33,533 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1939
2025-11-17 11:37:33,535 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:37:40,931 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:37:40,932 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:37:42,414 - ispa_next.main - DEBUG - Found new Appointment: GP-MT 100
2025-11-17 11:37:42,416 - ispa_next.main - DEBUG - 



2025-11-17 11:37:42,417 - ispa_next.main - DEBUG - starting with process 21 (GP-MT 100) of 30
2025-11-17 11:37:42,423 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:37:44,492 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:37:46,305 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1939
2025-11-17 11:37:46,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1177
2025-11-17 11:37:49,648 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:37:49,649 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:33,008 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:38:47,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:38:47,457 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:38:47,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:38:49,720 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:38:49,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:38:49,882 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:38:50,145 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:38:50,147 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:38:53,148 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:38:53,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:38:55,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:38:57,092 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:38:57,259 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:39:00,638 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:39:00,731 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:39:00,731 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:39:13,778 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:39:14,789 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:39:14,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:15,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:34,887 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:39:47,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:47,176 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:47,176 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:39:47,479 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:39:47,620 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:39:47,626 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:39:47,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:47,724 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:47,726 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:39:47,796 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:39:49,516 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:39:49,734 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:39:55,154 - ispa_next.functions - DEBUG - Updated appointment (KN00000208) customer contact data.
2025-11-17 11:39:56,111 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:39:56,114 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:39:57,968 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:39:57,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:39:59,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:40:03,054 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:40:03,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:03,873 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:05,879 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:40:06,060 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:40:06,252 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:40:06,408 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:40:06,410 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:40:18,179 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:40:27,361 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:40:27,361 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:40:31,645 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:40:32,655 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:40:32,655 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:40:32,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:32,728 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:40:36,891 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:40:36,896 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:40:36,896 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 11:40:36,897 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:40:38,849 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:40:38,849 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:40:40,356 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:40:40,356 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:40:40,358 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:40:40,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:40:40,360 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:40:40,360 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:40:40,362 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:40:40,364 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:40:40,367 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:40:40,369 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:40:40,372 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:40:40,375 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:40:40,389 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:40:40,391 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:40:40,393 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:40:40,413 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:42,364 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:40:42,366 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:40:42,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:40:43,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:40:44,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:53,313 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:40:53,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:55,364 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:41:10,823 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:41:11,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:41:12,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:41:12,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:21,820 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:41:28,934 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:41:28,938 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:41:28,938 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:41:30,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:41:30,317 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:41:30,321 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:41:33,685 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:41:47,021 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:41:47,416 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-17 11:41:48,519 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:41:57,005 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1941
2025-11-17 11:41:57,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:42:04,165 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:42:04,167 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:42:05,516 - ispa_next.main - DEBUG - Found new Appointment: UL-WJ 77
2025-11-17 11:42:05,517 - ispa_next.main - DEBUG - Found new Appointment: UL-MR 1590
2025-11-17 11:42:06,423 - ispa_next.main - DEBUG - 



2025-11-17 11:42:06,423 - ispa_next.main - DEBUG - starting with process 22 (UL-WJ 77) of 32
2025-11-17 11:42:06,440 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:42:08,460 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:42:10,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1941
2025-11-17 11:42:10,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:42:13,911 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:42:13,912 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:42:57,978 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:43:11,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:11,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:43:12,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:43:14,230 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:43:14,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:14,316 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:43:14,670 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:43:14,705 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:43:17,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:43:17,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:43:19,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:43:21,788 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:43:21,938 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:43:25,193 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:43:25,321 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:43:25,321 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:43:38,098 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:43:39,103 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:43:39,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:39,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:56,819 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:44:10,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:44:10,279 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:44:10,280 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:44:10,614 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:44:10,803 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:44:10,807 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:44:10,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:44:10,895 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:44:10,895 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:44:10,950 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:44:12,448 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:44:12,657 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:44:17,412 - ispa_next.functions - DEBUG - Updated appointment (KN00000210) customer contact data.
2025-11-17 11:44:18,401 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:44:18,405 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:44:20,085 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:44:20,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:44:21,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:44:25,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:44:25,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:44:25,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:44:27,874 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:44:28,009 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:44:28,228 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:44:28,323 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:44:28,323 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:44:40,934 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:45:40,937 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:45:53,478 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:45:58,482 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:46:11,160 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:46:21,726 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:46:22,733 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:46:22,734 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:46:22,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:46:22,862 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:46:27,022 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:46:27,029 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:46:27,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:46:27,149 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:46:32,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:46:33,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:46:33,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:46:34,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:46:34,695 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:46:36,740 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:46:36,744 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:46:38,531 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:46:38,533 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:46:38,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:46:38,536 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:46:38,537 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:46:38,539 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:46:38,539 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:46:38,541 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:46:38,541 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:46:38,543 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:46:38,545 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:46:38,545 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:46:38,550 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:46:38,554 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:46:38,559 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:46:38,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:46:40,875 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:46:40,879 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:46:40,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:46:42,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:46:42,397 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:46:42,409 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:46:44,478 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:47:00,232 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:47:00,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:47:01,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:47:02,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:11,995 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:19,807 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:19,810 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:47:19,812 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:47:20,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:47:21,090 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:47:21,093 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:47:24,198 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:47:37,766 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:47:38,164 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-17 11:47:39,133 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:47:47,654 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1941
2025-11-17 11:47:47,655 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:47:54,696 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:47:54,697 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:47:56,003 - ispa_next.appointments.models - DEBUG - Appointment Ming Zhang UL-MY 2019 WBA1S510507E28423 ohne Termin.
2025-11-17 11:47:56,015 - ispa_next.main - DEBUG - 



2025-11-17 11:47:56,015 - ispa_next.main - DEBUG - starting with process 23 (UL-MR 1590) of 32
2025-11-17 11:47:56,041 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:47:58,804 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:48:00,786 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1941
2025-11-17 11:48:00,788 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:48:04,115 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:48:04,117 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:48:57,368 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:49:12,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:49:16,252 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:49:16,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:49:16,363 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:49:16,673 - ispa_next.functions - DEBUG - HU date already expired after 59 days.
2025-11-17 11:49:26,408 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:49:26,412 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:49:29,289 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:49:29,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:49:31,133 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:49:33,151 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:49:33,309 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:49:36,659 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:49:47,349 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:49:48,404 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:49:48,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:49:49,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:09,895 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:50:20,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:20,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:50:20,793 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:50:20,994 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:50:21,113 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:50:21,119 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:50:21,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:21,274 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:50:21,274 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:50:21,412 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:50:23,103 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:50:24,389 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:50:24,581 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:50:30,437 - ispa_next.functions - DEBUG - Updated appointment (KN00000209) customer contact data.
2025-11-17 11:50:31,443 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:50:31,445 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:50:33,436 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:50:33,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:50:35,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:50:39,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:50:40,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:41,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:50:43,819 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:50:43,942 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:50:44,154 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:50:44,295 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:50:46,447 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:50:47,457 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:50:47,459 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:50:47,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:47,561 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:50:51,762 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:50:53,059 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:51:06,219 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:51:06,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:51:06,343 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:51:06,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:51:07,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:51:07,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:51:08,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:51:08,874 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:51:13,410 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:51:13,412 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:51:15,138 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:51:15,140 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:51:15,141 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:51:15,147 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:51:15,149 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:51:15,151 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:51:15,153 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:51:15,155 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:51:15,157 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:51:15,159 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:51:15,159 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:51:15,161 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:51:15,167 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:51:15,170 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:51:15,173 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:51:15,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:51:20,282 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:51:20,288 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:51:20,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:51:21,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:51:21,635 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:51:21,637 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:51:26,650 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:51:45,329 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:51:45,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:51:47,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:51:47,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:52:01,109 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:52:08,694 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:52:16,878 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:52:26,643 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:52:26,644 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:52:27,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:52:27,873 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:52:27,876 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:52:36,118 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:52:51,187 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:52:51,567 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 23.
2025-11-17 11:52:52,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:53:01,382 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1941
2025-11-17 11:53:01,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:53:08,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:53:08,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:53:09,891 - ispa_next.main - DEBUG - Found new Appointment: UL-MY 2019
2025-11-17 11:53:09,892 - ispa_next.main - DEBUG - 



2025-11-17 11:53:09,892 - ispa_next.main - DEBUG - starting with process 24 (UL-MY 2019) of 33
2025-11-17 11:53:09,898 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:53:11,932 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:53:13,914 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1941
2025-11-17 11:53:13,916 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:53:17,534 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:53:17,535 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:54:03,286 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:54:17,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:54:17,484 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:54:17,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:54:19,844 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:54:19,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:54:19,967 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:54:20,364 - ispa_next.functions - DEBUG - HU date already expired after 1212 days.
2025-11-17 11:54:31,142 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:54:31,146 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:54:34,184 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:54:34,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:54:36,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:54:38,450 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:54:38,622 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:54:41,913 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:54:42,046 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:54:42,048 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:54:54,689 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:54:55,696 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:54:55,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:54:56,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:16,052 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:55:28,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:28,728 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:28,728 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 11:55:28,941 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 11:55:29,077 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 11:55:29,082 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:55:29,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:29,188 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:29,188 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:55:29,332 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:55:30,808 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:55:31,063 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:55:34,778 - ispa_next.functions - DEBUG - Updated appointment (KK00000348) customer contact data.
2025-11-17 11:55:35,732 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:55:35,735 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:55:37,437 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:55:37,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:55:39,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:55:43,135 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:55:43,135 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:55:43,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:55:43,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:55:45,781 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:55:45,913 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:55:46,119 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:55:46,254 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:55:46,255 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:55:58,758 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:56:58,760 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:57:11,594 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:57:19,750 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:57:19,750 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:57:23,956 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:57:24,963 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:57:24,963 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:57:24,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:25,049 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:57:29,259 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:57:29,264 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:57:29,264 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 11:57:29,266 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:57:31,347 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:57:31,351 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:57:32,999 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:57:33,003 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:57:33,005 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:57:33,009 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:57:33,011 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:57:33,011 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:57:33,015 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:57:33,023 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:57:33,025 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:57:33,031 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:57:33,031 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:57:33,033 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:57:33,037 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:57:33,041 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:57:33,043 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:57:33,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:57:35,074 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:57:35,078 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:57:35,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:57:36,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:57:36,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:57:45,069 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:57:45,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:57:47,061 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:58:03,827 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:58:04,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:58:05,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:58:05,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:16,523 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:58:24,154 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:58:24,157 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:58:24,157 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:58:25,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:58:25,527 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:58:25,531 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:58:28,917 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:58:42,933 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:58:43,314 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 24.
2025-11-17 11:58:44,478 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:58:53,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1942
2025-11-17 11:58:53,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:59:00,314 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:59:00,315 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:59:01,374 - ispa_next.main - DEBUG - 



2025-11-17 11:59:01,374 - ispa_next.main - DEBUG - starting with process 25 (UL-M 4427E) of 33
2025-11-17 11:59:01,405 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:59:03,431 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:59:05,528 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1942
2025-11-17 11:59:05,531 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1179
2025-11-17 11:59:09,264 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:59:09,266 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:59:53,518 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:00:10,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:10,920 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:00:11,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:00:13,337 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:00:13,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:13,475 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:00:13,866 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:00:13,871 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:00:17,083 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:00:17,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:00:19,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:00:21,568 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:00:21,753 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:00:25,092 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:00:25,178 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:00:25,178 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:00:37,842 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:00:38,858 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:00:38,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:39,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:58,061 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:00:58,062 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:01:09,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:01:09,141 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:01:09,143 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:01:09,418 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:01:09,654 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:01:09,659 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:01:09,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:01:09,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:01:09,737 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:01:09,813 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:01:11,315 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:01:11,524 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:01:16,426 - ispa_next.functions - DEBUG - Updated appointment (KD00000194) customer contact data.
2025-11-17 12:01:17,427 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:01:17,491 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:01:19,315 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:01:19,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:01:21,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:01:24,637 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:01:24,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:01:25,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:01:27,313 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:01:27,485 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:01:27,639 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:01:27,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:01:27,759 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:01:38,788 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:01:47,304 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:01:47,304 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:01:51,506 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:01:52,513 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:01:52,515 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:01:52,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:01:52,621 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:01:56,755 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:01:56,760 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:01:56,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:01:56,899 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:02:02,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:02:03,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:02:03,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:02:04,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:02:04,478 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:02:06,537 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:02:06,539 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:02:08,272 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:02:08,274 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:02:08,276 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:02:08,278 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:02:08,280 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:02:08,282 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:02:08,282 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:02:08,284 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:02:08,286 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:02:08,286 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:02:08,288 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:02:08,290 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:02:08,318 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:02:08,322 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:02:08,324 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:02:08,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:02:10,452 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:02:10,455 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:02:10,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:02:12,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:02:12,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:02:24,666 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:02:24,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:02:26,642 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:02:44,554 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:02:45,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:02:46,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:02:46,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:02:57,745 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:03:05,583 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:03:05,587 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:03:05,587 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:03:06,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:03:06,654 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:03:06,656 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:03:09,511 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:03:25,114 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:03:25,499 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 25.
2025-11-17 12:03:26,456 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:03:35,647 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1943
2025-11-17 12:03:35,649 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:03:43,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1180
2025-11-17 12:03:43,512 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:03:45,074 - ispa_next.main - DEBUG - 



2025-11-17 12:03:45,074 - ispa_next.main - DEBUG - starting with process 26 (UL-CD 711) of 33
2025-11-17 12:03:45,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:03:47,159 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:03:49,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1943
2025-11-17 12:03:49,305 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1180
2025-11-17 12:03:53,099 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:03:53,100 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:04:46,541 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:05:03,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:14,598 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:05:14,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:14,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:15,209 - ispa_next.functions - DEBUG - HU date already expired after 25 days.
2025-11-17 12:05:27,316 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:05:27,321 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:05:30,422 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:05:30,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:32,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:34,524 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:05:34,688 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:05:38,055 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:05:38,219 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:05:38,220 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:05:51,314 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:05:52,320 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:05:52,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:53,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:12,008 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:06:12,008 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:06:23,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:23,130 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:06:23,130 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:06:23,343 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:06:23,516 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:06:23,522 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:06:23,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:23,695 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:06:23,696 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:06:23,759 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:06:24,017 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:06:25,413 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:06:25,673 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:06:32,909 - ispa_next.functions - DEBUG - Updated appointment (MJ00000084) customer contact data.
2025-11-17 12:06:34,096 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:06:34,100 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:06:34,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:06:36,846 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:06:39,384 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:06:39,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:06:40,758 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:06:44,415 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:06:44,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:45,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:47,128 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:06:47,331 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:06:47,508 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:06:47,628 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:06:47,629 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:07:00,550 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:07:46,554 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:07:58,820 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:08:11,228 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:08:11,228 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:08:13,377 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:08:14,388 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:08:14,389 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:08:14,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:08:14,521 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:08:18,721 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:08:20,084 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:08:34,373 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:08:34,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:08:34,527 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:08:34,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:35,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:35,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:08:36,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:08:36,993 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:08:47,879 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:08:47,881 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:08:50,011 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:08:50,014 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:08:50,016 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:08:50,018 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:08:50,020 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:08:50,024 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=manual, target=advice_list), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=manual, target=advice_list)}
2025-11-17 12:08:50,026 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:08:50,028 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:08:50,030 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:08:50,031 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:08:50,033 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 12:08:55,701 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:08:56,259 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:08:56,884 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:08:58,500 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:08:59,034 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:08:59,581 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:01,245 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:01,836 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:02,384 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:04,017 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:04,552 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:05,093 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:06,730 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:07,277 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:07,851 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:09,443 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:09,989 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:10,579 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:12,233 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:12,766 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:13,302 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:14,870 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:15,452 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:16,019 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:17,654 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:18,218 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:18,756 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:20,452 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:21,012 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:21,553 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:23,176 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:23,721 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:24,304 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:25,960 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:26,508 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:27,041 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:28,684 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:29,231 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:29,764 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:31,389 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:31,921 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:32,457 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:34,105 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:09:34,650 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:09:35,219 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 12:09:35,755 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-17 12:09:36,300 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-17 12:09:36,881 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-17 12:09:37,444 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-17 12:09:37,444 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-17 12:09:38,748 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-17 12:09:39,716 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:09:39,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:09:41,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:09:43,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:09:43,046 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:09:43,083 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:09:58,212 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 26.
2025-11-17 12:09:58,217 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:09:59,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1945
2025-11-17 12:09:59,086 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:10:08,124 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1181
2025-11-17 12:10:08,125 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:10:09,338 - ispa_next.appointments.models - DEBUG - Appointment Optik Kartaly & Forscht GmbH DLG-KI 800 WBY41DU080SG59885 ohne Termin.
2025-11-17 12:10:09,351 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Ulrich Dr. Willer STA-W 505 WBAAM31080FM84096 ohne Termin.
2025-11-17 12:10:09,359 - ispa_next.main - DEBUG - 



2025-11-17 12:10:09,359 - ispa_next.main - DEBUG - starting with process 27 (UL LK 2000) of 33
2025-11-17 12:10:09,364 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:10:11,235 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:10:13,305 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1945
2025-11-17 12:10:13,307 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1181
2025-11-17 12:10:18,525 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:10:18,527 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:11:07,625 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:11:22,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:26,028 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:11:26,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:26,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:11:26,618 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:11:37,889 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:11:37,893 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:11:41,112 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:11:41,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:43,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:11:45,572 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:11:45,723 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:11:45,896 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:11:45,998 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:11:45,998 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:11:57,106 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:12:05,072 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:12:05,073 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:12:09,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:12:10,317 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:12:10,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:11,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:30,848 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:12:42,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:42,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:12:42,566 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:12:42,967 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-17 12:12:42,970 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:12:42,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:43,125 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:12:43,127 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:12:43,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:12:44,995 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:12:45,298 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:12:49,493 - ispa_next.functions - DEBUG - Updated appointment (CQ00005546) customer contact data.
2025-11-17 12:12:50,618 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:12:50,624 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:12:53,722 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:12:53,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:12:55,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:12:59,379 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:12:59,379 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:12:59,397 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:12:59,397 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:12:59,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:00,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:13:04,315 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:13:04,321 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:13:04,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:04,410 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:13:11,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:13:12,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:13:12,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:13,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:13:13,637 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:13:17,055 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:13:17,057 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:13:19,036 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:13:19,040 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:13:19,043 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:13:19,045 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:13:19,049 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:13:19,049 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:13:19,051 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:13:19,053 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:13:19,053 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:13:19,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:13:19,055 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:13:19,057 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:13:19,061 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:13:19,065 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:13:19,069 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:13:19,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:22,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:22,856 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:13:36,636 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:13:36,642 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:13:36,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:13:38,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:13:39,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:50,929 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:13:50,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:54,824 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:14:13,194 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:14:13,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:14:15,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:14:15,289 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:14:28,487 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:38,637 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:47,721 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:56,708 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:14:56,710 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:14:57,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:14:58,049 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:14:58,051 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:15:06,924 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:15:22,137 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:15:22,523 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 27.
2025-11-17 12:15:32,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:15:34,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1944
2025-11-17 12:15:34,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:15:42,743 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1181
2025-11-17 12:15:42,745 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:15:44,211 - ispa_next.appointments.models - DEBUG - Appointment ASYS Automatisierungssysteme GmbH UL-AG 660 WBA21GW080CU65286 ohne Termin.
2025-11-17 12:15:44,228 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Ulrich Dr. Willer STA-W 505 WBAAM31080FM84096 ohne Termin.
2025-11-17 12:15:44,249 - ispa_next.main - DEBUG - 



2025-11-17 12:15:44,249 - ispa_next.main - DEBUG - starting with process 28 (GA447) of 33
2025-11-17 12:15:44,254 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:15:46,602 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:15:48,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1944
2025-11-17 12:15:48,799 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1181
2025-11-17 12:15:52,651 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:15:52,652 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:16:48,463 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:17:04,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:08,071 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:17:08,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:08,219 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:17:08,556 - ispa_next.functions - DEBUG - HU date already expired after 67 days.
2025-11-17 12:17:20,108 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:17:20,114 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:17:23,291 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:17:23,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:17:25,752 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:17:27,765 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:17:27,947 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:17:28,117 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:17:28,264 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:17:28,264 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:17:41,377 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:17:42,383 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:17:42,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:43,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:02,055 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:18:14,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:14,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:18:14,424 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:18:14,742 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-17 12:18:14,746 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:18:14,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:14,887 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:18:14,889 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:18:14,941 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:18:16,712 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:18:16,969 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:18:21,247 - ispa_next.functions - DEBUG - Updated appointment (FS00001632) customer contact data.
2025-11-17 12:18:22,373 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:18:22,377 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:18:24,066 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:18:24,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:18:26,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:18:29,627 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:18:29,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:30,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:18:32,286 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:18:32,422 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:18:32,580 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:18:32,709 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:18:32,710 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:18:44,877 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:18:53,038 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:18:53,038 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:18:57,278 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:18:58,285 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:18:58,286 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:18:58,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:58,434 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:02,558 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:19:03,659 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:19:16,732 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:19:16,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:16,869 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:20,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:21,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:21,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:22,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:19:22,824 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:19:26,417 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:19:26,419 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:19:28,480 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:19:28,480 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:19:28,482 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:19:28,484 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:19:28,486 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:19:28,488 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:19:28,490 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:19:28,492 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:19:28,492 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:19:28,494 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:19:28,500 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:19:28,511 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:19:28,519 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:19:28,522 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:19:28,525 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:19:28,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:32,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:32,517 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:44,112 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:19:44,115 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:19:44,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:19:45,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:19:45,915 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:19:45,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:49,617 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:20:06,950 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:20:07,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:20:08,634 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:20:08,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:22,105 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:20:32,853 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:20:43,325 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:20:53,663 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:20:53,671 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:20:55,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:20:55,213 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:20:55,215 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:21:03,740 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:21:19,617 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:21:19,989 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 28.
2025-11-17 12:21:21,874 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:30,281 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1946
2025-11-17 12:21:30,281 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:37,681 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:21:37,682 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:21:38,888 - ispa_next.appointments.models - DEBUG - Appointment Erdal Özcan UL-ZK 126 WBATY95030N065119 ohne Termin.
2025-11-17 12:21:38,900 - ispa_next.appointments.models - DEBUG - Appointment Daniela Zagorac UL-DZ 1980 WBA8C51020K733299 ohne Termin.
2025-11-17 12:21:38,913 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Ulrich Dr. Willer STA-W 505 WBAAM31080FM84096 ohne Termin.
2025-11-17 12:21:38,922 - ispa_next.main - DEBUG - Found new Appointment: UL-AG 660
2025-11-17 12:21:38,923 - ispa_next.main - DEBUG - 



2025-11-17 12:21:38,923 - ispa_next.main - DEBUG - starting with process 29 (UL-AG 660) of 34
2025-11-17 12:21:38,928 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:40,644 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:42,462 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1946
2025-11-17 12:21:42,463 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:21:46,294 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:46,295 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:22:35,490 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:22:51,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:51,207 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:51,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:53,617 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:22:53,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:53,714 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:54,171 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:22:54,178 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:22:57,472 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:22:57,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:00,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:23:02,115 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:23:02,308 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:23:05,660 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:23:05,807 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:23:05,808 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:23:18,576 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:23:19,586 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:23:19,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:20,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:37,185 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 12:23:50,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:50,414 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:23:50,414 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:23:50,718 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:23:50,876 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:23:50,882 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:23:50,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:51,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:23:51,028 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:23:51,089 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:23:53,275 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:23:54,677 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:23:54,919 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:24:02,192 - ispa_next.functions - DEBUG - Updated appointment (JH00000239) customer contact data.
2025-11-17 12:24:03,223 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:24:03,226 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:24:05,435 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:24:05,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:24:07,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:24:11,031 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:24:11,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:24:14,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:24:16,074 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:24:16,274 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:24:16,446 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:24:16,545 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:24:16,545 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:24:29,669 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:25:29,672 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:25:42,657 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:25:53,733 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:25:54,740 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:25:54,740 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:25:54,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:54,851 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:25:59,024 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:25:59,030 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:25:59,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:59,117 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:26:08,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:09,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:09,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:10,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:26:10,567 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:26:12,711 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:26:12,713 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:26:14,898 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:26:14,900 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:26:14,902 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:26:14,903 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:26:14,909 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:26:14,911 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:26:14,914 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:26:14,918 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:26:14,920 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:26:14,922 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:26:14,922 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:26:14,924 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:26:14,928 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:26:14,932 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:26:14,935 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:26:14,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:17,084 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:26:17,089 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:26:17,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:26:18,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:26:19,078 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:26:19,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:21,221 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:26:38,145 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:26:38,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:26:39,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:26:40,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:51,780 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:27:00,710 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:27:00,713 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:27:00,713 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:27:01,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:27:02,086 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:27:02,090 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:27:05,573 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:27:21,862 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:27:22,244 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 29.
2025-11-17 12:27:23,349 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:27:32,515 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1946
2025-11-17 12:27:32,517 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:27:39,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:27:39,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:27:40,974 - ispa_next.main - DEBUG - Found new Appointment: UL-ZK 126
2025-11-17 12:27:40,975 - ispa_next.main - DEBUG - Found new Appointment: UL-DZ 1980
2025-11-17 12:27:40,976 - ispa_next.main - DEBUG - 



2025-11-17 12:27:40,976 - ispa_next.main - DEBUG - starting with process 30 (UL-ZK 126) of 36
2025-11-17 12:27:40,981 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:27:42,635 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:27:44,315 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1946
2025-11-17 12:27:44,318 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:27:47,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:27:47,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:35,460 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:28:51,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:54,843 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:28:54,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:28:54,977 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:28:55,299 - ispa_next.functions - DEBUG - HU date already expired after 713 days.
2025-11-17 12:29:05,924 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:29:05,928 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:29:09,004 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:29:09,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:11,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:13,384 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:29:13,556 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:29:13,684 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:29:13,861 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:29:16,021 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:29:17,030 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:29:17,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:17,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:38,385 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:29:49,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:49,742 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:49,742 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:29:49,952 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:29:50,102 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:29:50,108 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:29:50,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:50,260 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:50,261 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:29:50,323 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:29:51,893 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:29:52,151 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:29:57,435 - ispa_next.functions - DEBUG - Updated appointment (JH00000241) customer contact data.
2025-11-17 12:29:58,473 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:29:58,479 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:29:59,903 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:29:59,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:30:01,846 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:30:05,498 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:30:05,498 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:30:05,501 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:30:05,501 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:30:05,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:06,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:10,334 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:30:11,652 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:30:24,352 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:30:24,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:24,500 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:30:31,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:31,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:31,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:33,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:33,154 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:30:36,762 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:30:36,764 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:30:38,840 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:30:38,844 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:30:38,846 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:30:38,848 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:30:38,850 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:30:38,852 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:30:38,854 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:30:38,855 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:30:38,855 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:30:38,857 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:30:38,857 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:30:38,859 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:30:38,863 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:30:38,867 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:30:38,871 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:30:38,877 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:42,496 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:30:42,500 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:30:42,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:30:44,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:30:44,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:56,611 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:30:56,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:00,105 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:31:17,495 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:31:18,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:31:19,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:31:19,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:31,474 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:40,255 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:49,191 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:58,232 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:31:58,234 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:31:59,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:31:59,558 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:31:59,560 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:32:08,009 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:32:24,070 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:32:24,486 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 30.
2025-11-17 12:32:26,075 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:35,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1946
2025-11-17 12:32:35,101 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:42,814 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:32:42,815 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:32:44,218 - ispa_next.main - DEBUG - 



2025-11-17 12:32:44,219 - ispa_next.main - DEBUG - starting with process 31 (UL-DZ 1980) of 36
2025-11-17 12:32:44,224 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:45,975 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:47,673 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1946
2025-11-17 12:32:47,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:32:51,207 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:51,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:33:41,479 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:33:56,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:59,668 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:33:59,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:59,757 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:34:00,114 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:34:00,119 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:34:03,369 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:34:03,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:05,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:34:07,755 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:34:07,950 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:34:11,259 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:34:11,415 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:34:15,619 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:34:16,627 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:34:16,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:17,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:36,091 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:34:36,091 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:34:48,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:48,117 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:34:48,117 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:34:48,366 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:34:48,546 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:34:48,551 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:34:48,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:48,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:34:48,679 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:34:48,798 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:34:48,934 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:34:50,424 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:34:50,669 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:34:56,429 - ispa_next.functions - DEBUG - Updated appointment (JH00000240) customer contact data.
2025-11-17 12:34:57,379 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:34:57,483 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:34:58,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:35:00,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:35:02,533 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:35:02,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:35:03,991 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:35:08,229 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:35:08,230 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:35:08,230 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:35:08,232 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:35:08,235 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:35:08,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:09,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:35:13,175 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:35:13,186 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:35:13,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:13,323 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:35:15,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:16,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:16,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:17,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:35:17,203 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:35:20,703 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:35:20,704 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:35:22,800 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:35:22,801 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:35:22,803 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:35:22,804 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:35:22,806 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:35:22,812 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:35:22,816 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:35:22,820 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:35:22,820 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:35:22,822 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:35:22,822 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:35:22,825 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:35:22,830 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:35:22,833 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:35:22,836 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:35:22,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:26,626 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:35:26,633 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:35:26,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:35:28,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:35:28,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:39,119 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:35:39,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:42,810 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:36:01,024 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:36:01,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:36:02,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:36:03,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:36:16,472 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:25,024 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:33,561 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:42,885 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:42,889 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:36:42,891 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:36:44,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:36:44,333 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:36:44,335 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:36:47,685 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:37:03,274 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:37:03,669 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 31.
2025-11-17 12:37:05,210 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:37:14,366 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1947
2025-11-17 12:37:14,368 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:37:21,642 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1184
2025-11-17 12:37:21,643 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:37:22,887 - ispa_next.appointments.models - DEBUG - Appointment Harry Schmid UL-HR 700 WBA35BG040N076708 ohne Termin.
2025-11-17 12:37:22,897 - ispa_next.main - DEBUG - 



2025-11-17 12:37:22,897 - ispa_next.main - DEBUG - starting with process 32 (NU J 3339) of 36
2025-11-17 12:37:22,902 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:37:25,072 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:37:27,420 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1947
2025-11-17 12:37:27,422 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1184
2025-11-17 12:37:31,528 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:37:31,529 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:38:23,919 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:38:39,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:38:43,226 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:38:43,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:43,304 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:38:43,669 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:38:54,285 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:38:54,290 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:38:57,566 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:38:57,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:39:00,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:39:02,102 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:39:02,229 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:39:02,381 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:39:02,480 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:39:02,480 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:39:15,358 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:39:16,370 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:39:16,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:17,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:22,669 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:39:22,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:22,752 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:39:22,752 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:39:23,068 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-17 12:39:23,072 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:39:23,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:23,163 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:39:23,163 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:39:23,304 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:39:24,890 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:39:26,489 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:39:26,693 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:39:31,333 - ispa_next.functions - DEBUG - Updated appointment (FK00002065) customer contact data.
2025-11-17 12:39:32,384 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:39:32,390 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:39:34,312 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:39:34,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:39:36,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:39:41,325 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:39:41,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:39:43,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:39:45,901 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:39:46,088 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:39:46,240 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:39:46,398 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:39:46,399 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:40:01,109 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:41:01,112 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:41:13,458 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:41:26,620 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:41:26,621 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:41:30,860 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:41:31,868 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:41:31,869 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:41:31,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:41:32,003 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:41:36,141 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:41:37,412 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:41:53,408 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:41:53,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:41:53,513 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:41:58,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:59,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:59,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:00,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:42:00,447 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:42:06,576 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:42:06,578 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:42:08,996 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:42:08,998 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:42:09,002 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:42:09,006 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:42:09,009 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:42:09,011 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:42:09,013 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:42:09,014 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:42:09,015 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:42:09,017 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:42:09,017 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:42:09,019 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:42:09,024 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:42:09,028 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:42:09,032 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:42:09,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:16,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:16,112 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:42:27,781 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:42:27,784 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:42:27,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:42:29,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:42:29,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:46,109 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:42:46,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:52,965 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:43:11,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:43:18,095 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-17 12:43:18,105 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:43:21,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:43:22,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:43:23,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:43:40,253 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:43:49,873 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:43:59,545 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:43:59,546 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:44:00,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:44:00,690 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:44:00,691 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:44:09,360 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:44:25,386 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:44:25,759 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 32.
2025-11-17 12:44:34,798 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:44:36,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1947
2025-11-17 12:44:36,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:44:44,742 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:44:44,743 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:44:46,111 - ispa_next.main - DEBUG - Found new Appointment: UL-HR 700
2025-11-17 12:44:46,113 - ispa_next.main - DEBUG - 



2025-11-17 12:44:46,113 - ispa_next.main - DEBUG - starting with process 33 (UL-HR 700) of 37
2025-11-17 12:44:46,117 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:44:48,243 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:44:50,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1947
2025-11-17 12:44:50,381 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:44:54,478 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:44:54,480 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:45:47,110 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:46:02,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:46:04,611 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:46:04,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:04,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:46:05,191 - ispa_next.functions - DEBUG - HU date soon to be invalid in 58 days.
2025-11-17 12:46:16,376 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:46:16,380 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:46:19,635 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:46:19,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:46:22,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:46:24,133 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:46:24,316 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:46:27,638 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:46:27,760 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:46:31,951 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:46:32,958 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:46:32,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:33,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:39,941 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:46:39,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:40,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:46:40,050 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:46:40,358 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:46:40,505 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:46:40,509 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:46:40,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:40,628 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:46:40,628 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:46:40,672 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:46:42,456 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:46:42,712 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:46:48,478 - ispa_next.functions - DEBUG - Updated appointment (JH00000245) customer contact data.
2025-11-17 12:46:49,498 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:46:49,503 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:46:51,081 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:46:51,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:46:53,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:46:56,770 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:46:56,770 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:46:56,782 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:46:56,784 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:46:56,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:46:57,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:47:01,802 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:47:01,808 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:47:01,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:47:01,908 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:47:06,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:47:06,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:47:06,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:47:08,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:47:08,124 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:47:10,293 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:47:10,295 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:47:12,222 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:47:12,224 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:47:12,226 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:47:12,226 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:47:12,228 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:47:12,229 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:47:12,230 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:47:12,231 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:47:12,232 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:47:12,233 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:47:12,234 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:47:12,235 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:47:12,239 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:47:12,244 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:47:12,248 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:47:12,252 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:14,384 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:47:14,388 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:47:14,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:47:16,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:47:16,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:30,002 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:47:30,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:32,069 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:47:50,208 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:47:50,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:47:52,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:47:52,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:48:04,025 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:48:16,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:48:16,942 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:48:16,944 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:48:18,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:48:18,377 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:48:18,379 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:48:21,816 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:48:36,837 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:48:37,240 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 33.
2025-11-17 12:48:38,787 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:48:48,150 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1949
2025-11-17 12:48:48,154 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:48:55,998 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1184
2025-11-17 12:48:55,999 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:48:57,398 - ispa_next.appointments.models - DEBUG - Appointment Nexhmi Dodaj UL-D 7773 WBA5K11000D297796 ohne Termin.
2025-11-17 12:48:57,411 - ispa_next.appointments.models - DEBUG - Appointment JELD-WEN Deutschland GmbH & DON-JW 119 WBA41EG0405X26266 ohne Termin.
2025-11-17 12:48:57,420 - ispa_next.main - DEBUG - 



2025-11-17 12:48:57,420 - ispa_next.main - DEBUG - starting with process 34 (3508) of 37
2025-11-17 12:48:57,425 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:49:01,301 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:49:03,486 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1949
2025-11-17 12:49:03,487 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1184
2025-11-17 12:49:07,160 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:49:07,162 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:49:53,188 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:50:10,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:50:10,715 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:50:11,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:13,221 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:50:13,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:50:13,309 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:50:13,712 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:50:13,716 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:50:17,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:50:17,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:50:19,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:50:21,711 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:50:21,901 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:50:25,231 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:50:25,416 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:50:25,416 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:50:38,155 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:50:39,166 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:50:39,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:50:39,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:50:59,507 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:51:12,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:51:12,930 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:51:12,930 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:51:13,202 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 12:51:13,304 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 12:51:13,310 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:51:13,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:51:13,413 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:51:13,414 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:51:13,461 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:51:15,729 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:51:15,926 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:51:23,318 - ispa_next.functions - DEBUG - Updated appointment (AE00055844) customer contact data.
2025-11-17 12:51:24,266 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:51:24,373 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:51:26,667 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:51:26,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:51:28,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:51:32,922 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:51:32,923 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:51:32,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:51:34,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:51:36,212 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:51:36,384 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:51:36,503 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:51:36,688 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:51:36,688 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:51:51,717 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:52:51,720 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:53:02,706 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:53:11,604 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:53:11,604 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:53:15,792 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:53:16,801 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:53:16,801 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:53:16,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:16,979 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:53:21,136 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:53:21,140 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:53:21,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:21,218 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:53:27,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:28,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:28,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:31,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:53:31,201 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:53:33,394 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:53:33,398 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:53:35,536 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:53:35,538 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:53:35,540 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:53:35,542 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:53:35,542 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 12:53:35,544 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:53:35,546 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:53:35,547 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:53:35,564 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:53:35,567 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:53:35,571 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:53:35,573 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:53:35,579 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:53:35,582 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:53:35,586 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:53:35,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:37,834 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:53:37,838 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:53:37,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:53:40,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:53:40,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:54,078 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:53:54,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:56,207 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:54:13,361 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:54:13,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:54:15,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:54:15,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:54:27,658 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:54:36,909 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:54:36,913 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:54:36,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:54:38,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:54:38,310 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:54:38,312 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:54:41,908 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:54:56,865 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:54:57,294 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 34.
2025-11-17 12:54:59,076 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:08,149 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1948
2025-11-17 12:55:08,149 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:17,366 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:55:17,366 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:18,811 - ispa_next.appointments.models - DEBUG - Appointment Ulmer Fleisch GmbH UL-M 163 WBA51BY0207R55437 ohne Termin.
2025-11-17 12:55:18,822 - ispa_next.main - DEBUG - 



2025-11-17 12:55:18,822 - ispa_next.main - DEBUG - starting with process 35 (ul vk1010) of 37
2025-11-17 12:55:18,827 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:55:21,108 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:25,061 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1948
2025-11-17 12:55:25,062 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1183
2025-11-17 12:55:29,188 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:29,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:24,260 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:56:41,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:43,984 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:56:43,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:56:44,073 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:56:44,504 - ispa_next.functions - DEBUG - HU date already expired after 6 days.
2025-11-17 12:56:55,651 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:56:55,653 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:56:58,732 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:56:58,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:57:01,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:57:03,290 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:57:03,410 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:57:03,555 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:57:03,665 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:57:03,666 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:57:16,819 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:57:17,826 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:57:17,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:18,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:39,368 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:57:51,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:51,717 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:57:51,717 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 12:57:52,011 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-17 12:57:52,015 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:57:52,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:52,172 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:57:52,173 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:57:52,251 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:57:53,910 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:57:54,155 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:57:59,011 - ispa_next.functions - DEBUG - Updated appointment (GU00001278) customer contact data.
2025-11-17 12:58:00,081 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:58:00,088 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:58:01,824 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:58:01,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:58:03,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:58:07,419 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:58:07,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:08,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:58:10,363 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:58:10,520 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:58:10,706 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:58:10,827 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:58:10,827 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:58:21,917 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:58:29,931 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:58:29,931 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:58:34,195 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:58:35,203 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:58:35,204 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:58:35,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:35,294 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:58:39,476 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:58:39,482 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:58:39,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:39,586 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:58:39,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:40,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:41,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:42,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:58:42,177 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:58:44,942 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:58:44,944 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:58:47,164 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:58:47,166 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:58:47,183 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:58:47,185 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:58:47,187 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 12:58:47,189 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:58:47,192 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=manual, target=advice_list)}
2025-11-17 12:58:47,194 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:58:47,196 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:58:47,198 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:58:47,210 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:58:47,214 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:58:47,954 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:58:56,532 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:58:56,675 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:58:57,381 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:58:57,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:00,855 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:59:00,858 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:59:00,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:59:03,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:59:03,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:16,367 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:59:16,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:19,401 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:59:37,566 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:59:38,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:59:39,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:59:39,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:54,096 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:00:03,538 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:00:18,399 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:00:18,401 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:00:19,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:00:19,799 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:00:19,802 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:00:28,129 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:00:43,022 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:00:43,407 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 35.
2025-11-17 13:00:44,961 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:00:55,052 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1950
2025-11-17 13:00:55,054 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:01:03,418 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1184
2025-11-17 13:01:03,419 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:01:04,728 - ispa_next.appointments.models - DEBUG - Appointment Arthrex GmbH M-AX 1055E WBY21HD000FV23089 ohne Termin.
2025-11-17 13:01:04,737 - ispa_next.main - DEBUG - Found new Appointment: UL-R 930
2025-11-17 13:01:04,737 - ispa_next.main - DEBUG - Found new Appointment: UL-M 163
2025-11-17 13:01:04,740 - ispa_next.main - DEBUG - 



2025-11-17 13:01:04,740 - ispa_next.main - DEBUG - starting with process 36 (UL-R 930) of 39
2025-11-17 13:01:04,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:01:06,636 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:01:08,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1950
2025-11-17 13:01:08,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1184
2025-11-17 13:01:12,843 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:01:12,845 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:02:05,295 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:02:20,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:02:20,076 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:02:20,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:23,223 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:02:23,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:02:23,305 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:02:23,679 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:02:23,682 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:02:27,023 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:02:27,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:02:30,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:02:32,190 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:02:32,395 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:02:35,747 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:02:35,909 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:02:35,909 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:02:49,824 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:02:50,832 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:02:50,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:02:51,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:12,519 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:03:12,519 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:03:25,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:25,256 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:25,256 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:03:25,504 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:03:25,673 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:03:25,680 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:03:25,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:25,845 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:25,847 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:03:25,962 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:03:27,821 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:03:28,069 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:03:34,263 - ispa_next.functions - DEBUG - Updated appointment (DW00003510) customer contact data.
2025-11-17 13:03:35,284 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:03:35,405 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:03:39,589 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:03:39,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:03:41,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:03:45,480 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:03:45,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:46,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:03:48,351 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:03:48,491 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:03:48,689 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:03:48,845 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:03:48,845 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:04:03,516 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:05:03,520 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:05:16,500 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:05:29,425 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:05:30,433 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:05:30,433 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:05:30,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:05:30,568 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:05:34,691 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:05:34,697 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:05:34,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:05:34,873 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:05:35,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:36,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:36,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:05:37,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:05:37,630 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:05:40,590 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:05:40,592 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:05:42,687 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:05:42,687 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:05:42,689 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:05:42,691 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:05:42,691 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:05:42,693 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:05:42,695 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:05:42,695 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:05:42,696 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:05:42,701 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:05:42,704 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:05:42,708 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:05:42,714 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:05:42,718 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:05:42,720 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:05:42,722 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:45,887 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:05:45,890 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:05:45,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:05:47,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:05:47,777 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:05:47,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:50,859 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:06:08,668 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:06:09,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:06:10,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:06:10,846 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:24,293 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:33,538 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:43,081 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:43,084 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:06:43,084 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:06:44,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:06:44,354 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:06:44,357 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:06:47,284 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:07:06,502 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:07:06,872 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 36.
2025-11-17 13:07:08,865 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:18,527 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1951
2025-11-17 13:07:18,527 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:26,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1184
2025-11-17 13:07:26,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:28,528 - ispa_next.main - DEBUG - Found new Appointment: M-AX 1055E
2025-11-17 13:07:28,530 - ispa_next.main - DEBUG - 



2025-11-17 13:07:28,530 - ispa_next.main - DEBUG - starting with process 37 (M-AX 1055E) of 40
2025-11-17 13:07:28,536 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:30,999 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:33,489 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1951
2025-11-17 13:07:33,490 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1184
2025-11-17 13:07:37,788 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:37,790 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:28,368 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:08:43,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:43,221 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:43,474 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:45,732 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:08:45,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:45,815 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:46,225 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:08:46,230 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:08:49,633 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:08:49,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:08:52,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:08:54,375 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:08:54,557 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:08:57,901 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:08:58,083 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:08:58,083 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:09:11,187 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:09:12,196 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:09:12,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:13,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:40,181 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:09:54,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:54,884 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:09:54,884 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:09:55,138 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:09:55,443 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:09:55,450 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:09:55,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:55,535 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:09:55,539 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:09:55,616 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:09:58,223 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:09:58,414 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:10:07,354 - ispa_next.functions - DEBUG - Updated appointment (DW00003512) customer contact data.
2025-11-17 13:10:08,474 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:10:08,477 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:10:11,105 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:10:11,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:10:13,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:10:18,000 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:10:18,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:10:20,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:10:22,917 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:10:23,741 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:10:23,904 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:10:24,060 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:10:24,061 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:10:36,556 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:10:44,235 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:10:44,235 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:10:50,563 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:11:03,064 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:11:04,072 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:11:04,073 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:11:04,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:11:04,236 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:11:08,439 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:11:08,444 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:11:08,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:11:08,533 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:11:08,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:10,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:10,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:11:12,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:11:12,309 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:11:15,348 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:11:15,350 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:11:19,830 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:11:19,831 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:11:19,843 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:11:19,845 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:11:19,847 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:11:19,849 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:11:19,856 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:11:19,860 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:11:19,861 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:11:19,863 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:11:19,867 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:11:19,869 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:11:19,875 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:11:19,877 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:11:19,881 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:11:19,905 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:24,417 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:11:24,421 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:11:24,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:11:26,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:11:26,553 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:11:26,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:29,477 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:11:46,301 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:11:46,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:11:48,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:11:48,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:02,496 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:12:12,188 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:12:21,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:12:21,883 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:12:21,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:23,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:12:23,323 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:12:23,327 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:12:26,531 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:12:41,409 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:12:41,778 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 37.
2025-11-17 13:12:43,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:53,429 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1951
2025-11-17 13:12:53,431 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:13:03,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1185
2025-11-17 13:13:03,924 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:13:05,464 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:13:05,474 - ispa_next.main - DEBUG - 



2025-11-17 13:13:05,475 - ispa_next.main - DEBUG - starting with process 38 (UL-M 163) of 40
2025-11-17 13:13:05,481 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:13:07,577 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:13:09,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1951
2025-11-17 13:13:09,803 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1185
2025-11-17 13:13:14,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:13:14,392 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:14:11,438 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:14:28,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:35,131 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:14:35,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:35,235 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:35,707 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:14:35,712 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:14:39,186 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:39,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:42,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:44,607 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:14:44,719 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:14:44,892 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:14:45,012 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:14:49,295 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:14:50,302 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:14:50,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:51,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:11,721 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:15:25,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:25,349 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:15:25,349 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:15:25,533 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:15:25,807 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:15:25,813 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:15:25,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:15:25,891 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:15:25,891 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:15:25,937 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:15:26,137 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:15:27,851 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:15:28,085 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:15:33,685 - ispa_next.functions - DEBUG - Updated appointment (DV00003723) customer contact data.
2025-11-17 13:15:34,745 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:15:34,749 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:15:35,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:15:38,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:15:41,181 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:15:41,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:15:43,318 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:15:46,943 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:15:46,943 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:15:46,953 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:15:46,954 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:15:46,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:15:48,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:15:52,504 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:15:52,516 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:15:52,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:15:52,618 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:16:05,650 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 13:16:25,278 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 13:16:25,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:27,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:27,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:29,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:29,231 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:16:36,036 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:16:36,041 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:16:38,687 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:16:38,689 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:16:38,691 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart)}
2025-11-17 13:16:38,694 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:16:38,697 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:16:38,701 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:16:38,703 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:16:38,703 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:16:38,705 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:16:38,707 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:16:38,707 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:16:38,709 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:16:38,710 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:17:47,161 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:17:47,566 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 13:17:59,497 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:17:59,503 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:17:59,508 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:17:59,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:08,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:08,669 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:18:24,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:49,446 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:18:49,448 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:18:49,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:18:52,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:18:53,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:16,379 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:19:16,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:27,771 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:19:46,553 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:19:47,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:19:48,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:19:49,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:08,169 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:19,385 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:30,274 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:41,197 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:20:41,197 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:42,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:42,375 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:20:42,378 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:20:50,824 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:21:09,483 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:21:09,866 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 38.
2025-11-17 13:21:19,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:22,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1952
2025-11-17 13:21:22,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:30,315 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1186
2025-11-17 13:21:30,316 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:21:31,481 - ispa_next.appointments.models - DEBUG - Appointment Birce Uca UL-CE 1995 WMW31DK0X02S69364 ohne Termin.
2025-11-17 13:21:31,492 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:21:31,501 - ispa_next.main - DEBUG - 



2025-11-17 13:21:31,501 - ispa_next.main - DEBUG - starting with process 39 (UL-ST2016) of 40
2025-11-17 13:21:31,506 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:21:33,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:35,145 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1952
2025-11-17 13:21:35,146 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1186
2025-11-17 13:21:39,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:39,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:22:46,469 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:23:01,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:23:04,499 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:23:04,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:04,638 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:23:04,935 - ispa_next.functions - DEBUG - HU date soon to be invalid in 86 days.
2025-11-17 13:23:15,314 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:23:15,318 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:23:18,550 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:23:18,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:23:21,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:23:23,671 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:23:23,819 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:23:27,228 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:23:27,322 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:23:27,322 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:23:40,747 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:23:41,754 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:23:41,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:42,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:48,711 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:23:48,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:48,858 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:23:48,858 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:23:49,215 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-17 13:23:49,219 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:23:49,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:49,314 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:23:49,316 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:23:49,398 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:23:51,283 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:23:51,528 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:23:56,769 - ispa_next.functions - DEBUG - Updated appointment (BX00005413) customer contact data.
2025-11-17 13:23:57,945 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:23:57,949 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:24:00,058 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:24:00,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:24:02,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:24:05,972 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:24:05,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:06,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:24:08,957 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:24:09,077 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:24:09,266 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:24:09,398 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:24:09,398 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:24:24,535 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:25:24,538 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:25:35,459 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:25:45,872 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:25:45,872 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:25:48,027 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:25:49,034 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:25:49,036 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:25:49,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:49,204 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:25:53,402 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:25:54,961 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:26:14,096 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:26:14,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:14,236 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:26:14,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:15,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:15,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:16,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:26:16,996 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:26:20,809 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:26:20,812 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:26:23,153 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:26:23,170 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:26:23,172 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:26:23,174 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:26:23,176 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:26:23,177 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:26:23,179 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:26:23,181 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:26:23,185 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:26:23,186 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:26:23,201 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:26:23,203 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:26:23,207 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:26:23,210 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:26:23,214 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:26:23,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:27,185 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:26:27,189 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:26:27,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:26:29,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:26:29,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:45,638 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:26:45,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:49,584 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:27:07,490 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:27:08,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:09,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:27:10,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:24,846 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:44,015 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:53,865 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:27:53,867 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:54,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:55,004 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:27:55,008 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:28:03,507 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:28:19,938 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:28:20,331 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 39.
2025-11-17 13:28:21,571 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:28:31,812 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1953
2025-11-17 13:28:31,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:28:40,094 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1186
2025-11-17 13:28:40,095 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:41,636 - ispa_next.appointments.models - DEBUG - Appointment Elisabeth Magdalene Auth UL-EA 65 WBA21GE0907S96597 ohne Termin.
2025-11-17 13:28:41,649 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:28:41,658 - ispa_next.main - DEBUG - Found new Appointment: UL-CE 1995
2025-11-17 13:28:41,660 - ispa_next.main - DEBUG - 



2025-11-17 13:28:41,660 - ispa_next.main - DEBUG - starting with process 40 (UL-CE 1995) of 41
2025-11-17 13:28:41,665 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:28:43,904 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:28:46,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1953
2025-11-17 13:28:46,308 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1186
2025-11-17 13:28:50,765 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:28:50,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:29:54,982 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:30:12,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:12,983 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:13,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:30:15,456 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:30:15,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:15,530 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:16,017 - ispa_next.functions - DEBUG - HU date already expired after 162 days.
2025-11-17 13:30:26,581 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:30:26,585 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:30:29,806 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:30:29,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:30:32,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:30:34,821 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:30:35,007 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:30:38,413 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:30:38,508 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:30:38,509 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:30:51,492 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:30:52,500 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:30:52,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:53,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:15,126 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:31:28,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:28,247 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:31:28,248 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:31:28,442 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:31:28,648 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:31:28,656 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:31:28,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:28,763 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:31:28,763 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:31:28,878 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:31:29,068 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:31:30,503 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:31:30,766 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:31:34,943 - ispa_next.functions - DEBUG - Updated appointment (GH00001399) customer contact data.
2025-11-17 13:31:35,886 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:31:35,992 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:31:36,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:31:39,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:31:41,578 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:31:43,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:31:44,646 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:31:48,311 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:31:48,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:49,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:51,266 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:31:51,398 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:31:51,582 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:31:51,683 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:31:51,683 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:32:04,864 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:32:55,867 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:33:06,965 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:33:15,511 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:33:15,511 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:33:17,710 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:33:18,731 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:33:18,731 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:33:18,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:18,836 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:23,055 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:33:26,538 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:33:40,849 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:33:40,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:40,944 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:45,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:46,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:46,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:47,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:47,929 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:33:53,358 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:33:53,360 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:33:55,638 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:33:55,640 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:55,642 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:33:55,642 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:55,644 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:33:55,646 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:33:55,647 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:33:55,648 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:33:55,650 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:33:55,652 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:33:55,652 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:33:55,662 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:33:55,668 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:33:55,672 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:33:55,676 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:33:55,678 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:01,379 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:34:01,384 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:34:01,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:34:03,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:34:04,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:20,245 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:34:20,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:25,595 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:34:44,021 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:49,915 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-17 13:34:49,920 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:34:50,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:34:52,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:34:52,453 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:35:11,018 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:35:20,625 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:35:30,237 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:35:39,497 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:35:49,633 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:36:00,502 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:36:00,502 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:36:01,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:02,010 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:36:02,014 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:36:11,205 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:36:36,011 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 13:36:36,509 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:36:38,645 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:36:42,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:42,942 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:36:42,946 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:36:48,335 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 13:36:48,374 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:37:01,977 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 40.
2025-11-17 13:37:01,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:37:03,007 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1952
2025-11-17 13:37:03,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:37:11,662 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1182
2025-11-17 13:37:11,664 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:37:13,056 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:37:13,063 - ispa_next.main - DEBUG - Found new Appointment: UL-EA 65
2025-11-17 13:37:13,064 - ispa_next.main - DEBUG - 



2025-11-17 13:37:13,064 - ispa_next.main - DEBUG - starting with process 41 (UL-EA 65) of 42
2025-11-17 13:37:13,069 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:37:15,398 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:37:17,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1952
2025-11-17 13:37:17,590 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1182
2025-11-17 13:37:22,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:37:22,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:38:14,314 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:38:32,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:32,882 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:38:33,158 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:38:35,367 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:38:35,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:35,575 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:38:35,984 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:38:35,988 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:38:39,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:38:39,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:38:42,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:38:44,284 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:38:44,451 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:38:47,762 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:38:47,923 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:38:47,923 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:39:01,801 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:39:02,808 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:39:02,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:03,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:23,663 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:39:23,664 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:39:36,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:36,099 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:36,100 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:39:36,402 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:39:36,549 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:39:36,553 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:39:36,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:36,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:36,647 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:39:36,702 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:39:38,546 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:39:38,792 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:39:45,541 - ispa_next.functions - DEBUG - Updated appointment (EX00002488) customer contact data.
2025-11-17 13:39:46,456 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:39:46,648 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:39:48,794 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:39:48,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:39:51,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:39:55,539 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 13:39:55,539 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:39:55,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:56,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:58,575 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:39:58,892 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:40:00,747 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:40:00,863 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:40:00,863 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:40:12,037 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:40:20,399 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:40:20,400 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:40:24,644 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:40:25,652 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:40:25,653 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:40:25,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:40:25,818 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:40:29,986 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:40:29,993 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:40:29,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:40:30,073 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:40:36,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:40:37,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:40:37,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:40:39,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:40:39,201 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:40:41,734 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:40:41,735 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:40:44,255 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:40:44,256 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:40:44,257 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:40:44,259 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:40:44,259 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:40:44,262 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:40:44,263 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:40:44,264 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:40:44,265 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:40:44,266 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:40:44,268 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:40:44,269 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:40:44,274 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:40:44,276 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:40:44,279 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:40:44,284 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:40:46,716 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:40:46,718 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:40:46,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:40:49,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:40:49,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:06,166 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:41:06,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:08,429 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:41:27,338 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:41:27,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:41:29,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:41:29,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:44,348 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:41:57,746 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:41:57,748 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:41:57,750 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:41:59,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:41:59,100 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:41:59,104 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:42:02,544 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:42:18,242 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:42:18,636 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 41.
2025-11-17 13:42:20,114 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:42:30,167 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1958
2025-11-17 13:42:30,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:42:38,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1188
2025-11-17 13:42:38,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:42:39,930 - ispa_next.appointments.models - DEBUG - Appointment Ulrike Engelhardt NU-UE 194 WMW21DH0902S14102 ohne Termin.
2025-11-17 13:42:39,942 - ispa_next.appointments.models - DEBUG - Appointment Nihal Özen UL-DP 4444 WMWZD71090WM49156 ohne Termin.
2025-11-17 13:42:39,953 - ispa_next.appointments.models - DEBUG - Appointment Harald Kammerbauer NU-BK 1902 WBATS110209E72787 ohne Termin.
2025-11-17 13:42:39,965 - ispa_next.appointments.models - DEBUG - Appointment Heinz Stärk HDH-SH 57 WBA2C11000V528089 ohne Termin.
2025-11-17 13:42:39,978 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:42:39,984 - ispa_next.main - DEBUG - Found new Appointment: UL-A 1365
2025-11-17 13:42:39,985 - ispa_next.main - DEBUG - 



2025-11-17 13:42:39,986 - ispa_next.main - DEBUG - starting with process 42 (UL-A 1365) of 43
2025-11-17 13:42:39,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:42:42,364 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:42:45,056 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1958
2025-11-17 13:42:45,058 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1188
2025-11-17 13:42:49,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:42:49,393 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:43:46,388 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:44:02,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:02,674 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:44:02,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:44:05,233 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:44:05,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:05,320 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:44:05,782 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:44:05,786 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:44:09,295 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:44:09,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:44:12,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:44:14,323 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:44:14,469 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:44:17,849 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:44:17,977 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:44:17,977 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:44:31,401 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:44:32,408 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:44:32,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:33,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:55,363 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:45:10,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:10,297 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:45:10,297 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:45:10,616 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:45:10,763 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:45:10,769 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:45:10,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:10,874 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:45:10,875 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:45:10,945 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:45:13,615 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:45:13,874 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:45:23,597 - ispa_next.functions - DEBUG - Updated appointment (KH00000201) customer contact data.
2025-11-17 13:45:24,749 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:45:24,753 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:45:26,857 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:45:26,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:45:29,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:45:32,928 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:45:32,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:45:33,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:45:35,875 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:45:36,018 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:45:36,219 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:45:36,379 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:45:36,379 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:45:47,425 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:45:58,406 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:45:58,406 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:46:02,672 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:46:03,690 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:46:03,691 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:46:03,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:46:03,777 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:46:07,923 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:46:07,944 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:46:07,944 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 13:46:07,945 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:46:10,263 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:46:10,265 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:46:12,781 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:46:12,783 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:46:12,785 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:46:12,787 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:46:12,787 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:46:12,789 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:46:12,789 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:46:12,791 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:46:12,791 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:46:12,793 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:46:12,793 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:46:12,795 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:46:12,799 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:46:12,803 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:46:12,805 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:46:12,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:15,057 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:46:15,061 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:46:15,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:46:17,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:46:17,705 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:31,921 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:46:31,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:34,036 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:46:52,920 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:46:53,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:46:55,250 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:46:55,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:47:10,112 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:47:20,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:47:20,347 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:47:20,349 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:47:21,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:47:21,812 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:47:21,816 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:47:25,458 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:47:41,141 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:47:41,509 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 42.
2025-11-17 13:47:43,073 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:47:53,294 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1957
2025-11-17 13:47:53,296 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:48:01,629 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1187
2025-11-17 13:48:01,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:48:03,074 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:48:03,082 - ispa_next.main - DEBUG - Found new Appointment: NU-UE 194
2025-11-17 13:48:03,082 - ispa_next.main - DEBUG - Found new Appointment: UL-DP 4444
2025-11-17 13:48:03,082 - ispa_next.main - DEBUG - Found new Appointment: NU-BK 1902
2025-11-17 13:48:03,083 - ispa_next.main - DEBUG - 



2025-11-17 13:48:03,083 - ispa_next.main - DEBUG - starting with process 43 (NU-UE 194) of 46
2025-11-17 13:48:03,089 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:48:05,401 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:48:07,467 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1957
2025-11-17 13:48:07,469 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1187
2025-11-17 13:48:12,015 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:48:12,017 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:49:18,644 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:49:36,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:37,061 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:49:37,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:39,557 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:49:39,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:39,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:49:40,027 - ispa_next.functions - DEBUG - HU date already expired after 287 days.
2025-11-17 13:49:52,131 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:49:52,135 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:49:55,535 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:49:55,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:58,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:50:00,599 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:50:00,732 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:50:04,124 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:50:04,239 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:50:04,240 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:50:17,817 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:50:18,823 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:50:18,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:19,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:41,411 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:50:54,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:54,097 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:50:54,097 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:50:54,367 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:50:54,510 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:50:54,515 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:50:54,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:54,685 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:50:54,685 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:50:54,786 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:50:54,916 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:50:56,298 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:50:56,519 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:51:03,290 - ispa_next.functions - DEBUG - Updated appointment (KH00000208) customer contact data.
2025-11-17 13:51:04,358 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:51:04,871 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:51:05,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:51:07,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:51:11,361 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:51:11,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:51:12,968 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:51:18,238 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 13:51:18,238 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:51:18,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:51:19,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:51:21,257 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:51:21,385 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:51:21,608 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:51:21,706 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:51:21,706 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:51:34,980 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:52:18,982 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:52:29,994 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:52:38,464 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:52:38,464 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:52:42,699 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:52:43,705 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:52:43,720 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:52:43,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:43,812 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:52:48,011 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:52:48,017 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:52:48,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:48,106 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:52:54,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:56,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:56,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:57,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:57,424 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:53:00,701 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:53:00,703 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:53:03,104 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:53:03,106 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:53:03,108 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:53:03,108 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:53:03,113 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:53:03,117 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:53:03,123 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:53:03,125 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:53:03,127 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:53:03,138 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:53:03,140 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:53:03,162 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:53:03,166 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:53:03,169 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:53:03,173 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:53:03,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:06,465 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:53:06,468 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:53:06,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:53:08,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:53:09,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:20,921 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:53:20,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:23,925 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:53:41,857 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:53:42,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:53:44,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:53:44,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:59,425 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:54:09,483 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:54:19,676 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:54:19,679 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:54:19,680 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:54:21,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:54:21,184 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:54:21,186 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:54:24,669 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:54:42,621 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:54:43,013 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 43.
2025-11-17 13:54:44,703 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:54:54,674 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1957
2025-11-17 13:54:54,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:55:03,234 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1186
2025-11-17 13:55:03,235 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:55:04,684 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 13:55:04,705 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 13:55:04,712 - ispa_next.main - DEBUG - 



2025-11-17 13:55:04,712 - ispa_next.main - DEBUG - starting with process 44 (UL-DP 4444) of 46
2025-11-17 13:55:04,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:55:06,665 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:55:08,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1957
2025-11-17 13:55:08,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1186
2025-11-17 13:55:13,184 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:55:13,185 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:56:22,150 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:56:38,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:38,994 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:56:39,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:45,170 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:56:45,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:45,309 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:56:45,746 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:56:45,750 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:56:49,259 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:56:49,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:52,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:56:54,235 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:57:04,428 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 13:57:16,330 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 13:57:17,349 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:57:17,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:57:18,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:57:39,326 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:57:54,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:57:54,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:57:54,508 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 13:57:54,939 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 13:57:55,051 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 13:57:55,057 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:57:55,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:57:55,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:57:55,160 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:57:55,202 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:57:55,409 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:57:57,320 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:57:57,512 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:58:04,523 - ispa_next.functions - DEBUG - Updated appointment (KH00000207) customer contact data.
2025-11-17 13:58:05,675 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:58:05,678 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:58:06,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:58:09,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:58:14,222 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:58:14,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:58:16,436 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:58:20,907 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:58:20,907 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:58:20,908 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:58:20,911 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:58:20,913 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:58:20,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:21,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:26,167 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:58:26,174 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:58:26,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:26,261 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:58:26,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:27,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:27,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:29,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:29,041 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:58:35,480 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:58:35,482 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:58:38,214 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:58:38,216 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:58:38,217 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:58:38,219 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:58:38,221 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:58:38,222 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:58:38,224 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:58:38,224 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:58:38,226 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:58:38,227 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:58:38,228 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:58:38,230 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:58:38,233 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:58:38,237 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:58:38,239 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:58:38,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:58:44,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:44,994 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:59:01,382 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:59:01,386 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:59:01,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:59:03,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:59:03,717 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:59:03,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:10,297 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:59:29,743 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:59:30,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:59:31,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:59:32,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:48,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:02,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:21,975 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:33,821 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:00:33,821 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:35,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:00:35,519 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:00:35,530 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:00:45,632 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:01:04,228 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:01:04,604 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 44.
2025-11-17 14:01:15,272 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:01:17,778 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1958
2025-11-17 14:01:17,780 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:01:26,525 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1186
2025-11-17 14:01:26,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:01:27,750 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 14:01:27,763 - ispa_next.appointments.models - DEBUG - Appointment Monika Müller RV-MO 809 WBATX31070LB90550 ohne Termin.
2025-11-17 14:01:27,768 - ispa_next.main - DEBUG - 



2025-11-17 14:01:27,768 - ispa_next.main - DEBUG - starting with process 45 (NU-BK 1902) of 46
2025-11-17 14:01:27,773 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:01:29,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:01:34,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1958
2025-11-17 14:01:34,779 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1186
2025-11-17 14:01:39,576 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:01:39,577 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:02:44,709 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:03:01,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:01,410 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:01,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:05,955 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:03:05,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:06,040 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:06,553 - ispa_next.functions - DEBUG - HU date already expired after 726 days.
2025-11-17 14:03:18,382 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:03:18,387 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:03:21,859 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:03:21,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:25,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:03:27,376 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:03:27,516 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:03:27,722 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:03:27,886 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:03:27,886 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:03:39,119 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:03:50,485 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:03:50,485 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:03:52,694 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:03:53,700 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:03:53,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:55,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:15,666 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:04:28,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:28,435 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:04:28,435 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:04:28,760 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:04:28,886 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:04:28,908 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:04:28,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:29,111 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:04:29,112 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:04:29,176 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:04:31,162 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:04:31,366 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:04:39,285 - ispa_next.functions - DEBUG - Updated appointment (KH00000206) customer contact data.
2025-11-17 14:04:40,413 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:04:40,548 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:04:42,826 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:04:42,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:04:46,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:04:51,126 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:04:51,126 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:04:51,383 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:04:51,670 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:04:51,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:55,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:59,225 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:05:00,508 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:05:17,334 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:05:17,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:05:17,503 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:05:26,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:28,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:28,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:05:29,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:05:29,527 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:05:35,904 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:05:35,908 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:05:38,427 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:05:38,429 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:05:38,431 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:05:38,433 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:05:38,433 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:05:38,435 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:05:38,437 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 14:05:38,437 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:05:38,439 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:05:38,440 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:05:38,440 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:05:38,443 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 14:05:43,636 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:05:44,234 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:05:45,782 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:05:46,556 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:05:47,089 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:05:48,726 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:05:49,507 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:05:50,051 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:05:51,773 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:05:52,593 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:05:53,172 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:05:54,844 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:05:55,598 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:05:56,199 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:05:59,943 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:06:01,574 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:06:02,110 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:06:03,266 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:06:06,615 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:06:07,791 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:06:09,772 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:06:09,985 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:06:09,989 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:06:10,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:15,425 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:06:15,429 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:06:15,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:06:18,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:06:18,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:35,098 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:06:35,100 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:40,291 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:06:58,745 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:06:59,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:07:03,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:07:03,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:19,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:31,032 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:43,121 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:07:54,246 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:07:54,246 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:07:55,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:07:55,821 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:07:55,824 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:08:05,438 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:08:22,436 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:08:22,812 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 45.
2025-11-17 14:08:32,443 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:35,177 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1962
2025-11-17 14:08:35,179 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:46,614 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1190
2025-11-17 14:08:46,615 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:08:48,140 - ispa_next.appointments.models - DEBUG - Appointment Werner Frick UL-W 110 WBA21EN0409015072 ohne Termin.
2025-11-17 14:08:48,157 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 14:08:48,163 - ispa_next.main - DEBUG - Found new Appointment: UL-M 8419
2025-11-17 14:08:48,163 - ispa_next.main - DEBUG - Found new Appointment: UL-LM 2912
2025-11-17 14:08:48,164 - ispa_next.main - DEBUG - 



2025-11-17 14:08:48,164 - ispa_next.main - DEBUG - starting with process 46 (UL-M 8419) of 48
2025-11-17 14:08:48,169 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:08:50,547 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:52,920 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1962
2025-11-17 14:08:52,921 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1190
2025-11-17 14:08:57,675 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:57,677 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:09:48,865 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:10:08,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:08,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:09,129 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:11,544 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:10:11,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:11,744 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:12,043 - ispa_next.functions - DEBUG - HU date already expired after 4980 days.
2025-11-17 14:10:22,884 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:10:22,888 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:10:26,275 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:10:26,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:28,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:30,668 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:10:39,507 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 14:10:51,202 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 14:10:52,209 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:10:52,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:53,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:12,948 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:11:25,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:25,849 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:11:25,849 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:11:26,121 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:11:26,275 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:11:26,280 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:11:26,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:26,378 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:11:26,380 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:11:26,435 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:11:26,702 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:11:28,050 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:11:28,341 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:11:35,686 - ispa_next.functions - DEBUG - Updated appointment (FF00002213) customer contact data.
2025-11-17 14:11:38,664 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:11:38,941 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:11:39,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:11:42,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:11:45,213 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:11:45,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:11:47,835 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:11:52,315 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:11:52,315 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:11:52,315 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:11:52,319 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:11:52,321 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:11:52,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:53,443 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:54,831 - ispa_next.functions - DEBUG - check_service_requirement couldn't find CBS table, returning False
2025-11-17 14:11:54,837 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:11:54,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:54,942 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:11:55,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:56,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:56,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:57,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:57,881 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:12:01,387 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:12:01,390 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:12:03,496 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:12:03,498 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:12:03,500 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:12:03,504 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:12:03,505 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:12:03,507 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:12:03,514 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:12:03,525 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:12:03,529 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:12:03,531 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:12:03,535 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:12:03,537 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:12:03,540 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:12:03,544 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:12:03,548 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:12:03,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:07,045 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:12:07,050 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:12:07,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:12:09,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:12:09,444 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:12:09,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:12,716 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:12:29,448 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:12:29,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:12:31,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:12:31,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:46,862 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:57,035 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:08,046 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:08,050 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:13:08,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:09,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:13:09,334 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:13:09,336 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:13:12,560 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:13:29,491 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:13:29,872 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 46.
2025-11-17 14:13:30,981 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:41,575 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1964
2025-11-17 14:13:41,575 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:50,435 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1191
2025-11-17 14:13:50,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:51,698 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 14:13:51,703 - ispa_next.main - DEBUG - Found new Appointment: UL-JR 33
2025-11-17 14:13:51,703 - ispa_next.main - DEBUG - Found new Appointment: UL-W 110
2025-11-17 14:13:51,706 - ispa_next.main - DEBUG - 



2025-11-17 14:13:51,706 - ispa_next.main - DEBUG - starting with process 47 (UL-JR 33) of 50
2025-11-17 14:13:51,711 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:53,569 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:55,632 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1964
2025-11-17 14:13:55,633 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1191
2025-11-17 14:14:00,270 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:14:00,272 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:14:56,015 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:15:12,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:12,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:12,654 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:15,077 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:15:15,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:15,165 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:15,525 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:15:15,529 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:15:19,009 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:15:19,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:22,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:24,578 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:15:24,761 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:15:28,235 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:15:28,355 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:15:28,357 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:15:42,289 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:15:43,306 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:15:43,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:44,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:05,450 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:16:05,451 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:16:17,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:17,687 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:16:17,687 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:16:17,972 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:16:18,076 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:16:18,081 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:16:18,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:18,270 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:16:18,270 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:16:18,333 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:16:18,563 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:16:19,879 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:16:20,091 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:16:25,186 - ispa_next.functions - DEBUG - Updated appointment (KH00000213) customer contact data.
2025-11-17 14:16:26,411 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:16:26,414 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:16:27,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:16:30,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:16:32,784 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:16:33,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:16:34,567 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:16:38,162 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:16:38,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:39,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:16:41,344 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:16:41,455 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:16:41,654 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:16:41,829 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:16:41,829 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:16:53,006 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:17:01,564 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:17:01,566 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:17:05,844 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:17:06,853 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:17:06,853 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:17:06,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:07,005 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:17:11,158 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:17:11,164 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:17:11,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:11,347 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:17:11,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:12,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:12,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:14,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:14,493 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:17:18,304 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:17:18,305 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:17:21,128 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:17:21,129 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:17:21,144 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:17:21,146 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:17:21,148 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:17:21,150 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:17:21,150 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:17:21,154 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:17:21,154 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:17:21,158 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:17:21,158 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:17:21,160 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:17:21,168 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:17:21,170 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:17:21,172 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:17:21,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:24,750 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:17:24,754 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:17:24,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:17:29,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:17:30,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:47,833 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:17:47,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:51,291 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:18:09,899 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:18:10,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:18:12,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:18:12,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:28,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:39,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:50,069 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:50,071 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:18:50,073 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:18:51,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:18:51,361 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:18:51,365 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:18:54,436 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:19:14,719 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:19:15,088 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 47.
2025-11-17 14:19:18,818 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:27,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1964
2025-11-17 14:19:27,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:19:36,353 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1190
2025-11-17 14:19:36,354 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:19:37,739 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 14:19:37,746 - ispa_next.main - DEBUG - 



2025-11-17 14:19:37,746 - ispa_next.main - DEBUG - starting with process 48 (UL-W 110) of 50
2025-11-17 14:19:37,751 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:19:39,700 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:41,597 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1964
2025-11-17 14:19:41,598 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1190
2025-11-17 14:19:45,951 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:19:45,952 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:41,582 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:20:58,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:58,629 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:20:58,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:03,297 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:21:03,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:03,393 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:03,749 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:21:03,754 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:21:07,272 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:07,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:10,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:12,968 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:13,178 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:16,613 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:16,723 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:21:16,723 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:21:30,560 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:21:31,566 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:21:31,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:32,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:54,500 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:21:54,500 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:22:10,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:10,795 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:22:10,795 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:22:11,050 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:22:11,205 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:22:11,211 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:22:11,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:11,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:22:11,403 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:22:11,445 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:22:13,525 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:22:13,759 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:22:23,431 - ispa_next.functions - DEBUG - Updated appointment (KH00000210) customer contact data.
2025-11-17 14:22:24,633 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:22:24,635 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:22:26,725 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:22:26,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:29,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:22:34,523 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:22:35,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:38,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:40,831 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:22:40,981 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:22:41,170 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:22:41,283 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:22:41,284 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:22:54,831 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:23:41,834 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:23:55,502 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:24:11,601 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:24:12,609 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:24:12,610 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:24:12,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:12,706 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:24:17,001 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:24:17,009 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:24:17,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:17,095 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:24:35,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:36,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:36,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:38,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:24:38,164 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:24:43,683 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:24:43,685 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:24:46,873 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:24:46,874 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:24:46,876 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:24:46,879 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:24:46,883 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:24:46,885 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:24:46,886 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:24:46,888 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:24:46,889 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:24:46,890 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:24:46,892 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:24:46,894 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:24:46,899 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:24:46,902 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:24:46,905 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:24:46,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:52,485 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:24:52,489 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:24:52,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:24:55,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:24:55,219 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:24:55,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:00,782 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:25:18,683 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:25:19,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:25:21,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:25:21,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:40,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:25:52,024 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:26:03,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:26:14,738 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:26:26,716 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:26:26,721 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:26:26,721 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:26:28,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:26:28,449 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:26:28,453 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:26:32,211 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:26:48,759 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:26:49,146 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 48.
2025-11-17 14:26:58,520 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:01,275 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1968
2025-11-17 14:27:01,277 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:10,255 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1190
2025-11-17 14:27:10,256 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:11,559 - ispa_next.appointments.models - DEBUG - Appointment Dmitri Klein UL-SV221E WBA61DP0109N34993 ohne Termin.
2025-11-17 14:27:11,571 - ispa_next.appointments.models - DEBUG - Appointment Natalia Jancuk A-JN 1509 WBA7K310607G26815 ohne Termin.
2025-11-17 14:27:11,584 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Häußler UL-GJ 603 WBA2D710X05G20040 ohne Termin.
2025-11-17 14:27:11,600 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 14:27:11,605 - ispa_next.main - DEBUG - 



2025-11-17 14:27:11,605 - ispa_next.main - DEBUG - starting with process 49 (UL-LM 2912) of 50
2025-11-17 14:27:11,610 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:27:13,593 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:15,972 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1968
2025-11-17 14:27:15,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1190
2025-11-17 14:27:22,950 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:22,951 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:28:29,531 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:28:46,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:52,913 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:28:52,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:53,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:28:53,372 - ispa_next.functions - DEBUG - HU date soon to be invalid in 16 days.
2025-11-17 14:29:05,832 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:29:05,834 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:29:09,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:29:09,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:29:15,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:29:17,275 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:29:17,489 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:29:17,638 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:29:17,813 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:29:22,024 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:29:23,031 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:29:23,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:24,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:48,370 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:29:48,370 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:30:03,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:03,494 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:03,494 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:30:03,737 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:30:03,921 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:30:03,927 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:30:03,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:30:04,032 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:30:04,033 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:30:04,087 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:30:07,267 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:30:09,218 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:30:09,476 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:30:20,902 - ispa_next.functions - DEBUG - Updated appointment (FF00002214) customer contact data.
2025-11-17 14:30:22,425 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:30:22,430 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:30:25,384 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:30:25,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:30:28,417 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:30:32,157 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:30:32,157 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:30:32,163 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:30:32,164 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:30:32,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:30:34,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:30:38,150 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:30:39,466 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:31:02,499 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:31:02,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:02,579 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:31:09,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:10,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:10,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:12,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:12,196 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:31:18,612 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:31:18,614 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:31:21,814 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:31:21,818 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:31:21,821 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:31:21,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:31:21,825 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:31:21,827 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:31:21,829 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:31:21,831 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:31:21,831 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:31:21,833 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:31:21,835 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:31:21,837 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:31:21,841 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:31:21,845 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:31:21,848 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:31:21,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:28,319 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:31:28,323 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:31:28,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:31:31,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:31:31,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:05,758 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:32:05,761 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:12,208 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:32:34,998 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:32:35,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:32:37,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:32:37,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:55,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:08,359 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:19,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:33:29,625 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:33:29,627 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:33:30,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:33:31,138 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:33:31,142 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:33:40,729 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:33:57,160 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:33:57,553 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 49.
2025-11-17 14:33:59,741 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:34:10,608 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1968
2025-11-17 14:34:10,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:34:22,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1188
2025-11-17 14:34:22,453 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:34:24,017 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Häußler UL-GJ 603 WBA2D710X05G20040 ohne Termin.
2025-11-17 14:34:24,033 - ispa_next.appointments.models - DEBUG - Appointment Natalie Gröbner NU-NA 93 WMWXN710302D37225 ohne Termin.
2025-11-17 14:34:24,038 - ispa_next.main - DEBUG - Found new Appointment: UL-SV221E
2025-11-17 14:34:24,038 - ispa_next.main - DEBUG - Found new Appointment: A-JN 1509
2025-11-17 14:34:24,039 - ispa_next.main - DEBUG - 



2025-11-17 14:34:24,039 - ispa_next.main - DEBUG - starting with process 50 (UL-SV221E) of 52
2025-11-17 14:34:24,044 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:34:26,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:34:28,495 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1968
2025-11-17 14:34:28,497 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1188
2025-11-17 14:34:35,761 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:34:35,762 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:35:42,580 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:35:59,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:59,699 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:35:59,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:03,543 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:36:03,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:03,681 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:36:04,150 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:36:04,155 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:36:07,696 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:36:07,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:11,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:36:13,215 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:36:13,410 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:36:16,868 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:36:17,005 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:36:17,005 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:36:32,959 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:36:33,965 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:36:33,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:35,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:58,496 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:37:10,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:10,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:37:10,762 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:37:11,039 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:37:11,190 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:37:11,195 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:37:11,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:11,338 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:37:11,340 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:37:11,448 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:37:11,583 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:37:13,004 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:37:13,268 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:37:20,819 - ispa_next.functions - DEBUG - Updated appointment (LU00000097) customer contact data.
2025-11-17 14:37:21,777 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:37:22,053 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:37:22,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:37:25,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:37:28,693 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:37:29,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:37:30,964 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:37:35,507 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 14:37:35,508 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:37:35,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:37:36,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:37:38,675 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:37:38,910 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:37:39,122 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:37:39,231 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:37:39,231 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:37:52,108 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:38:00,614 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:38:00,614 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:38:04,895 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:38:05,937 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:38:05,937 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:38:05,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:06,024 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:38:10,177 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:38:10,183 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:38:10,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:10,386 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:38:10,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:14,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:14,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:16,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:38:16,013 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:38:20,750 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:38:20,756 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:38:23,620 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:38:23,622 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:38:23,624 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:38:23,626 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:38:23,628 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:38:23,630 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:38:23,632 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:38:23,632 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:38:23,634 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:38:23,636 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:38:23,636 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:38:23,638 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:38:23,642 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:38:23,644 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:38:23,648 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:38:23,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:28,073 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:38:28,077 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:38:28,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:38:30,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:38:30,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:58,653 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:38:58,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:03,079 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:39:23,031 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:39:23,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:39:25,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:39:26,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:42,978 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:39:56,487 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:12,444 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:24,012 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:24,016 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:40:24,016 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:40:25,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:40:25,526 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:40:25,530 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:40:29,295 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:40:45,946 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:40:46,327 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 50.
2025-11-17 14:40:46,390 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:40:58,793 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1971
2025-11-17 14:40:58,795 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:41:07,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1192
2025-11-17 14:41:07,778 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:41:09,144 - ispa_next.appointments.models - DEBUG - Appointment Praxisklink Ulm UL-C 507E WBY71HD030FV74205 ohne Termin.
2025-11-17 14:41:09,155 - ispa_next.appointments.models - DEBUG - Appointment Axel Geiger UL-M 1061 WBAUY91070A796749 ohne Termin.
2025-11-17 14:41:09,170 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Häußler UL-GJ 603 WBA2D710X05G20040 ohne Termin.
2025-11-17 14:41:09,174 - ispa_next.main - DEBUG - Found new Appointment: GZ-KS 2007
2025-11-17 14:41:09,175 - ispa_next.main - DEBUG - 



2025-11-17 14:41:09,175 - ispa_next.main - DEBUG - starting with process 51 (GZ-KS 2007) of 53
2025-11-17 14:41:09,180 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:41:11,387 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:41:13,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1971
2025-11-17 14:41:13,668 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1192
2025-11-17 14:41:18,630 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:41:18,631 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:42:14,227 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:42:31,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:31,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:42:31,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:34,496 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:42:34,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:34,727 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:42:34,991 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:42:34,996 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:42:38,809 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:42:38,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:42:42,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:42:44,295 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:42:44,522 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:42:47,986 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:42:48,080 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:42:48,082 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:43:01,984 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:43:02,990 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:43:02,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:43:04,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:43:25,778 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:43:25,778 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:43:41,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:43:41,730 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:43:41,732 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:43:41,981 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:43:42,088 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:43:42,094 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:43:42,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:43:42,175 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:43:42,177 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:43:42,225 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:43:42,443 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:43:43,751 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:43:43,958 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:43:54,315 - ispa_next.functions - DEBUG - Updated appointment (MC00000142) customer contact data.
2025-11-17 14:43:55,494 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:43:55,499 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:43:56,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:43:59,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:44:01,974 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:44:02,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:44:04,834 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:44:09,888 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:44:10,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:14,153 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:16,160 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:44:16,285 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:44:16,491 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:44:16,620 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:44:16,620 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:44:27,887 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:44:36,365 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:44:36,365 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:44:40,581 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:44:41,589 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:44:41,590 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:44:41,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:41,685 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:44:45,894 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:44:45,899 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:44:45,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:46,006 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:44:53,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:54,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:54,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:55,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:55,948 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:45:00,859 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:45:00,860 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:45:03,804 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:45:03,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:45:03,809 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:45:03,811 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:45:03,815 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:45:03,817 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:45:03,819 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:45:03,819 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:45:03,821 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:45:03,821 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:45:03,823 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:45:03,825 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:45:03,829 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:45:03,833 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:45:03,836 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:45:03,843 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:45:08,863 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:45:08,867 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:45:08,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:45:11,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:45:12,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:45:42,855 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:45:42,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:45:47,295 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:46:06,613 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:46:07,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:46:09,225 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:46:09,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:46:26,791 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:46:42,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:46:54,373 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:47:05,905 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:47:05,911 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:47:05,911 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:47:13,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:47:13,280 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:47:13,283 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:47:16,851 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:47:34,135 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:47:34,511 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 51.
2025-11-17 14:47:36,422 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:47:47,370 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1972
2025-11-17 14:47:47,372 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:47:56,273 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1193
2025-11-17 14:47:56,273 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:47:57,636 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Häußler UL-GJ 603 WBA2D710X05G20040 ohne Termin.
2025-11-17 14:47:57,640 - ispa_next.main - DEBUG - Found new Appointment: UL-MZ 46
2025-11-17 14:47:57,640 - ispa_next.main - DEBUG - Found new Appointment: UL-C 507E
2025-11-17 14:47:57,640 - ispa_next.main - DEBUG - Found new Appointment: UL-M 1061
2025-11-17 14:47:57,641 - ispa_next.main - DEBUG - 



2025-11-17 14:47:57,641 - ispa_next.main - DEBUG - starting with process 52 (UL-MZ 46) of 56
2025-11-17 14:47:57,646 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:47:59,483 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:01,422 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1972
2025-11-17 14:48:01,424 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1193
2025-11-17 14:48:05,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:05,950 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:49:01,218 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:49:16,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:16,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:17,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:20,599 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:49:20,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:20,693 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:21,062 - ispa_next.functions - DEBUG - HU date already expired after 3008 days.
2025-11-17 14:49:33,112 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:49:33,118 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:49:36,689 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:49:36,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:49:40,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:49:42,094 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:49:51,953 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 14:50:04,359 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 14:50:05,366 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:50:05,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:06,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:29,906 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:50:45,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:46,074 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:50:46,074 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:50:46,450 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:50:46,561 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:50:46,566 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:50:46,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:46,646 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:50:46,648 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:50:46,794 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:50:46,963 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:50:48,458 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 14:50:53,672 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 14:50:54,063 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:51:00,853 - ispa_next.functions - DEBUG - Updated appointment (MC00000146) customer contact data.
2025-11-17 14:51:02,057 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:51:02,059 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:51:02,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:51:05,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:51:08,368 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:51:08,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:51:11,331 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:51:16,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:51:16,322 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:51:16,667 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:51:16,961 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:51:17,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:20,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:51:24,859 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:51:24,870 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:51:24,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:25,027 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:51:25,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:51:26,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:51:26,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:28,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:51:28,262 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:51:34,065 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:51:34,067 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:51:36,889 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:51:36,890 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:51:36,891 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:51:36,893 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:51:36,894 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:51:36,895 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:51:36,900 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:51:36,902 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:51:36,902 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:51:36,914 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:51:36,918 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:51:36,922 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:51:36,928 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:51:36,931 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:51:36,934 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:51:36,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:42,551 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:51:42,554 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:51:42,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:51:45,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:51:45,146 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:51:45,152 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:50,578 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:52:08,167 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:52:08,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:52:10,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:52:10,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:52:28,451 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:52:45,239 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:52:57,851 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:53:09,011 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:53:20,335 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:53:20,339 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:53:20,339 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:53:21,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:53:21,690 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:53:21,694 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:53:25,080 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:53:41,765 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:53:42,174 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 52.
2025-11-17 14:53:43,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:53:58,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1973
2025-11-17 14:53:58,668 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:07,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1191
2025-11-17 14:54:07,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:54:11,653 - ispa_next.main - DEBUG - Found new Appointment: UL-KA 1206
2025-11-17 14:54:11,655 - ispa_next.main - DEBUG - 



2025-11-17 14:54:11,655 - ispa_next.main - DEBUG - starting with process 53 (UL-KA 1206) of 57
2025-11-17 14:54:11,661 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:54:13,953 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:54:16,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1973
2025-11-17 14:54:16,346 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1191
2025-11-17 14:54:21,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:21,224 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:55:20,402 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:55:39,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:39,892 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:40,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:42,637 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:55:42,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:42,733 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:43,107 - ispa_next.functions - DEBUG - HU date soon to be invalid in 61 days.
2025-11-17 14:55:56,026 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:55:56,030 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:55:59,608 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:55:59,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:03,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:56:05,267 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:56:05,441 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:56:08,989 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:56:09,112 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:56:09,112 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:56:22,999 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:56:24,005 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:56:24,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:25,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:49,064 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:57:02,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:57:03,016 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:57:03,017 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 14:57:03,343 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 14:57:03,485 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 14:57:03,513 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:57:03,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:57:03,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:57:03,626 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:57:03,679 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:57:05,823 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:57:06,054 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:57:16,554 - ispa_next.functions - DEBUG - Updated appointment (EF00003319) customer contact data.
2025-11-17 14:57:17,763 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:57:17,766 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:57:19,741 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:57:19,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:57:22,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:57:27,924 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:57:27,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:57:29,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:57:31,124 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:57:31,243 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:57:31,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:57:31,622 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:57:31,622 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:57:44,393 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:57:53,147 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:57:53,147 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:57:57,326 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:57:58,335 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:57:58,337 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:57:58,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:57:58,417 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:58:02,636 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:58:02,640 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:58:02,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:58:02,748 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:58:07,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:58:09,208 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:58:09,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:58:10,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:58:10,979 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:58:14,005 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:58:14,007 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:58:17,026 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:58:17,028 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:58:17,030 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:58:17,032 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:58:17,034 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 14:58:17,034 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 14:58:17,036 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:58:17,036 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:58:17,038 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:58:17,039 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:58:17,039 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:58:17,041 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:58:17,045 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:58:17,050 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:58:17,121 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:58:17,129 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:19,920 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:58:19,922 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:58:19,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:58:23,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:58:23,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:50,942 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:58:50,943 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:53,543 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:59:20,007 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:59:20,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:59:22,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:59:23,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:59:38,815 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:52,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:59:52,971 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:59:52,972 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:59:54,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:59:54,453 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:59:54,455 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:59:57,937 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:00:17,199 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:00:17,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 53.
2025-11-17 15:00:31,971 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:00:35,282 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1974
2025-11-17 15:00:35,283 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:00:44,933 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1189
2025-11-17 15:00:44,934 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:00:46,310 - ispa_next.appointments.models - DEBUG - Appointment Martin Centmayer NU-C 2200 WBA11CM0308E88486 ohne Termin.
2025-11-17 15:00:46,334 - ispa_next.main - DEBUG - 



2025-11-17 15:00:46,334 - ispa_next.main - DEBUG - starting with process 54 (UL-C 507E) of 57
2025-11-17 15:00:46,342 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:00:51,223 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:00:53,329 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1974
2025-11-17 15:00:53,331 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1189
2025-11-17 15:00:58,750 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:00:58,751 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:02:00,858 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:02:22,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:22,855 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:02:23,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:26,789 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:02:26,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:26,886 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:02:27,261 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:02:27,337 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:02:31,065 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:02:31,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:35,108 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:02:37,136 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:02:37,252 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:02:44,930 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:02:45,077 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:02:45,077 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:03:03,032 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:03:04,037 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:03:04,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:03:05,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:03:31,333 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:03:49,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:03:49,468 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:03:49,470 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:03:49,771 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:03:49,921 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:03:49,927 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:03:49,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:03:50,106 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:03:50,108 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:03:50,163 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:03:53,797 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:03:54,064 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:04:07,731 - ispa_next.functions - DEBUG - Updated appointment (MC00000144) customer contact data.
2025-11-17 15:04:09,380 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:04:09,384 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:04:12,684 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:04:12,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:04:15,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:04:21,859 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:04:21,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:24,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:04:26,844 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:04:27,024 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:04:27,247 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:04:27,355 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:04:27,355 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:04:44,499 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:04:53,431 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:04:53,431 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:04:59,663 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:05:00,714 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:05:00,714 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:05:00,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:05:00,808 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:05:04,945 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:05:04,951 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:05:04,951 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 15:05:04,951 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:05:08,692 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:05:08,692 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:05:11,618 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:05:11,620 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:05:11,622 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:05:11,623 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:05:11,624 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:05:11,626 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:05:11,627 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:05:11,628 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:05:11,630 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:05:11,630 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:05:11,632 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:05:11,634 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:05:11,638 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:05:11,640 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:05:11,644 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:05:11,649 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:14,816 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:05:14,820 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:05:14,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:05:18,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:05:18,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:39,439 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:05:39,441 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:42,413 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:06:01,150 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:06:01,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:06:04,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:06:04,607 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:06:21,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:06:33,981 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:06:33,987 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:06:33,989 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:06:35,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:06:35,581 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:06:35,585 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:06:46,618 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:07:04,412 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:07:04,815 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 54.
2025-11-17 15:07:08,900 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:07:21,545 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1974
2025-11-17 15:07:21,547 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:07:30,626 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1186
2025-11-17 15:07:30,628 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:07:31,980 - ispa_next.main - DEBUG - Found new Appointment: NU-C 2200
2025-11-17 15:07:31,981 - ispa_next.main - DEBUG - 



2025-11-17 15:07:31,981 - ispa_next.main - DEBUG - starting with process 55 (NU-C 2200) of 58
2025-11-17 15:07:32,000 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:07:37,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:07:39,532 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1974
2025-11-17 15:07:39,534 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1186
2025-11-17 15:07:44,638 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:07:44,639 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:08:53,417 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:09:16,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:16,276 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:09:16,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:09:20,416 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:09:20,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:20,590 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:09:20,960 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:09:20,966 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:09:28,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:09:28,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:09:33,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:09:35,152 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:09:39,165 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:09:45,621 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:09:45,721 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:09:45,721 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:10:07,932 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:10:08,941 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:10:08,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:10,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:37,374 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:10:37,375 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:10:51,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:51,852 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:10:51,852 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:10:52,103 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:10:52,275 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:10:52,281 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:10:52,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:52,443 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:10:52,444 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:10:52,493 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:10:54,710 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:10:56,049 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:10:56,318 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:11:04,808 - ispa_next.functions - DEBUG - Updated appointment (LA00000256) customer contact data.
2025-11-17 15:11:05,855 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:11:06,109 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:11:08,599 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:11:08,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:11:12,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:11:18,512 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:11:18,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:11:19,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:11:21,880 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:11:25,802 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:11:26,027 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:11:26,158 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:11:26,160 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:11:37,590 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:11:45,899 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:11:45,899 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:11:53,910 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:11:54,920 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:11:54,921 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:11:54,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:11:55,003 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:11:59,158 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:11:59,165 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:11:59,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:11:59,238 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:11,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:13,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:13,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:14,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:14,969 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:12:18,176 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:12:18,178 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:12:21,643 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:12:21,645 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:21,649 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:12:21,651 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:21,653 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:12:21,655 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:12:21,657 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:12:21,659 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:12:21,659 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:12:21,661 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:12:21,661 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:12:21,663 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:12:21,669 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:12:21,673 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:12:21,675 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:12:21,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:24,808 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:12:24,810 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:12:24,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:12:28,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:12:28,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:47,849 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:12:47,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:50,918 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:13:10,157 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:13:10,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:13:13,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:13:13,775 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:30,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:13:51,644 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:13:51,650 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:13:51,650 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:13:53,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:13:53,361 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:13:53,365 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:13:57,468 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:14:13,553 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:14:13,935 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 55.
2025-11-17 15:14:15,859 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:14:27,609 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1976
2025-11-17 15:14:27,610 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:14:37,382 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1183
2025-11-17 15:14:37,383 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:14:38,772 - ispa_next.appointments.models - DEBUG - Appointment Robert Hefty BC-MH 258 WBA5R710X0FL51673 ohne Termin.
2025-11-17 15:14:38,784 - ispa_next.appointments.models - DEBUG - Appointment Selda Süslü UL-MS 2181 WBAVJ910209C98634 ohne Termin.
2025-11-17 15:14:38,792 - ispa_next.main - DEBUG - 



2025-11-17 15:14:38,792 - ispa_next.main - DEBUG - starting with process 56 (UL-M 1061) of 58
2025-11-17 15:14:38,798 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:14:40,884 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:14:42,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1976
2025-11-17 15:14:42,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1183
2025-11-17 15:14:48,142 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:14:48,144 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:15:49,650 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:16:10,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:10,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:11,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:15,431 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:16:15,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:15,611 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:16,052 - ispa_next.functions - DEBUG - HU date already expired after 1449 days.
2025-11-17 15:16:28,933 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:16:28,939 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:16:32,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:16:32,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:16:36,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:16:38,772 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:16:48,439 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 15:17:01,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 15:17:02,317 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:17:02,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:03,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:27,711 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:17:27,711 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:17:46,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:46,346 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:46,347 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:17:46,655 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:17:46,839 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:17:46,844 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:17:46,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:46,944 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:46,946 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:17:46,997 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:17:47,232 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:17:48,708 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:17:48,990 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:17:57,601 - ispa_next.functions - DEBUG - Updated appointment (MC00000143) customer contact data.
2025-11-17 15:17:58,689 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:17:58,938 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:18:00,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:18:03,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:18:06,487 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:18:06,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:18:10,079 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:18:14,786 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:18:14,786 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:18:14,786 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:18:14,792 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:18:14,792 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:18:14,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:16,235 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:18:20,407 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:18:20,414 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:18:20,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:20,596 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:18:20,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:22,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:22,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:24,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:18:24,047 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:18:29,565 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:18:29,568 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:18:32,803 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:18:32,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:18:32,807 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:18:32,809 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:18:32,809 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:18:32,812 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:18:32,814 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:18:32,815 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:18:32,817 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:18:32,818 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:18:32,827 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:18:32,831 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:18:32,841 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:18:32,845 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:18:32,849 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:18:32,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:38,201 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:18:38,203 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:18:38,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:18:41,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:18:41,061 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:18:41,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:46,480 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:19:05,470 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:19:06,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:19:08,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:19:08,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:34,588 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:19:46,886 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:00,021 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:12,318 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:12,319 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:13,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:13,770 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:13,774 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:23,274 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:20:42,219 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:20:42,589 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 56.
2025-11-17 15:20:52,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:00,493 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1976
2025-11-17 15:21:00,503 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:10,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1174
2025-11-17 15:21:10,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:11,985 - ispa_next.appointments.models - DEBUG - Appointment esko-systems GmbH GZ-EK 3838 WBA71FJ070CW51702 ohne Termin.
2025-11-17 15:21:11,995 - ispa_next.main - DEBUG - Found new Appointment: BC-MH 258
2025-11-17 15:21:11,997 - ispa_next.main - DEBUG - 



2025-11-17 15:21:11,997 - ispa_next.main - DEBUG - starting with process 57 (BC-MH 258) of 59
2025-11-17 15:21:12,003 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:21:14,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:21:17,130 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1976
2025-11-17 15:21:17,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1174
2025-11-17 15:21:25,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:25,333 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:22:26,842 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:22:49,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:49,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:49,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:53,444 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:22:53,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:53,561 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:53,961 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:22:53,965 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:22:57,550 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:22:57,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:01,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:23:03,924 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:23:04,267 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:23:07,772 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:23:07,939 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:23:07,940 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:23:22,046 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:23:23,052 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:23:23,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:24,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:53,016 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:23:53,016 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:24:07,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:07,597 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:07,597 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:24:07,883 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:24:08,048 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:24:08,054 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:24:08,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:08,250 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:08,251 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:24:08,316 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:24:10,779 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:24:12,273 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:24:12,592 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:24:21,733 - ispa_next.functions - DEBUG - Updated appointment (LV00000201) customer contact data.
2025-11-17 15:24:22,993 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:24:22,996 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:24:25,553 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:24:25,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:29,257 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:24:33,972 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:24:33,972 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:33,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:35,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:37,398 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:24:37,568 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:24:37,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:24:37,908 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:24:37,908 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:24:49,260 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:24:57,959 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:24:57,959 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:25:02,254 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:25:03,292 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:25:03,294 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:25:03,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:03,377 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:25:07,531 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:25:07,537 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:25:07,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:07,753 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:25:15,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:25:16,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:25:16,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:18,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:25:18,389 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:25:21,452 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:25:21,454 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:25:24,677 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:25:24,681 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:24,683 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:25:24,685 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:24,692 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:25:24,699 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:25:24,711 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:25:24,713 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:25:24,717 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:25:24,719 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:25:24,742 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:25:24,747 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:25:24,751 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:25:24,755 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:25:24,757 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:25:24,765 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:27,837 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:25:27,839 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:25:27,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:25:31,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:25:31,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:51,979 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:25:51,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:54,955 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:26:13,292 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:26:13,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:16,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:26:16,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:31,612 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:42,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:42,882 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:42,884 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:44,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:44,215 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:44,219 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:47,696 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:27:07,621 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:27:07,992 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 57.
2025-11-17 15:27:17,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:20,606 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1977
2025-11-17 15:27:20,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:30,004 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1175
2025-11-17 15:27:30,005 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:31,554 - ispa_next.appointments.models - DEBUG - Appointment Selcuk Ucaroglu NU-KU 5561 WBATX35090NC14152 ohne Termin.
2025-11-17 15:27:31,570 - ispa_next.appointments.models - DEBUG - Appointment esko-systems GmbH GZ-EK 3838 WBA71FJ070CW51702 ohne Termin.
2025-11-17 15:27:31,580 - ispa_next.main - DEBUG - 



2025-11-17 15:27:31,580 - ispa_next.main - DEBUG - starting with process 58 (A-JN 1509) of 59
2025-11-17 15:27:31,586 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:27:34,116 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:36,707 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1977
2025-11-17 15:27:36,709 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1175
2025-11-17 15:27:41,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:41,697 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:45,039 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:29:03,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:03,459 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:29:03,830 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:09,105 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:29:09,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:09,200 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:29:09,675 - ispa_next.functions - DEBUG - HU date already expired after 94 days.
2025-11-17 15:29:22,366 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:29:22,370 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:29:26,041 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:29:26,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:30,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:29:32,268 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:29:32,474 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:29:32,599 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:29:32,769 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:29:32,769 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:29:45,905 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:29:55,044 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:29:55,044 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:29:59,339 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:30:00,347 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:30:00,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:01,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:26,866 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 15:30:44,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:44,243 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:30:44,243 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:30:44,522 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:30:44,699 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:30:44,705 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:30:44,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:44,795 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:30:44,800 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:30:44,966 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:30:45,147 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:30:46,649 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:30:46,914 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:30:55,498 - ispa_next.functions - DEBUG - Updated appointment (KX00000168) customer contact data.
2025-11-17 15:30:56,798 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:30:56,802 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:30:57,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:31:01,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:31:04,569 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:31:04,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:31:07,048 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:31:12,156 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 15:31:12,157 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:31:12,157 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:31:12,161 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:31:12,161 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:31:12,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:13,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:31:17,807 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:31:17,813 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:31:17,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:17,935 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:31:18,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:19,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:19,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:21,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:31:21,411 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:31:28,216 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:31:28,218 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:31:31,386 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:31:31,389 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:31:31,392 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:31:31,393 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:31:31,395 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:31:31,397 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:31:31,399 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:31:31,400 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:31:31,401 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:31:31,404 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:31:31,405 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:31:31,406 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:31:31,417 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:31:31,421 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:31:31,424 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:31:31,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:38,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:38,420 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:31:57,718 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:24,461 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:32:24,463 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:32:24,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:32:27,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:32:28,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:52,388 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:32:52,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:59,026 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:33:19,683 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:33:20,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:33:22,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:33:22,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:42,050 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:33:55,634 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:34:13,853 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:34:25,145 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:34:25,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:34:26,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:34:26,632 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:34:26,635 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:34:35,616 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:34:53,634 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:34:54,146 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 58.
2025-11-17 15:35:05,355 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:35:08,458 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1978
2025-11-17 15:35:08,460 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:35:18,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 15:35:18,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:35:19,623 - ispa_next.appointments.models - DEBUG - Appointment Capitell Vermögens-Managem. AG F-CA 866 WBAHF11010WX79327 ohne Termin.
2025-11-17 15:35:19,635 - ispa_next.appointments.models - DEBUG - Appointment Selcuk Ucaroglu NU-KU 5561 WBATX35090NC14152 ohne Termin.
2025-11-17 15:35:19,643 - ispa_next.main - DEBUG - 



2025-11-17 15:35:19,643 - ispa_next.main - DEBUG - starting with process 59 (UL-DS 5005) of 59
2025-11-17 15:35:19,648 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:35:21,981 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:35:24,553 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1978
2025-11-17 15:35:24,555 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 15:35:29,896 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:35:29,898 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:36:29,946 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:36:50,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:50,534 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:36:50,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:53,742 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:36:53,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:53,820 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:36:54,145 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:37:06,341 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:37:06,345 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:37:10,021 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:37:10,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:37:14,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:37:16,358 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:37:16,542 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:37:20,002 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:37:20,097 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:37:20,098 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:37:34,388 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:37:35,407 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:37:35,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:36,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:00,594 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:38:17,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:17,806 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:38:17,806 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:38:18,059 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:38:18,227 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:38:18,233 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:38:18,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:38:18,383 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:38:18,383 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:38:18,558 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:38:25,030 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:38:26,361 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:38:26,644 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:38:35,356 - ispa_next.functions - DEBUG - Updated appointment (FY00001621) customer contact data.
2025-11-17 15:38:36,411 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:38:36,653 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:38:38,775 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:38:38,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:38:41,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:38:45,592 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:38:45,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:38:46,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:38:48,886 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:38:49,052 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:38:49,311 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:38:49,426 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:38:49,428 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:39:00,727 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:39:09,649 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:39:09,649 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:39:13,990 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:39:14,999 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:39:15,001 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:39:15,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:39:15,108 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:39:19,271 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:39:19,276 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:39:19,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:39:19,383 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:39:19,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:39:21,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:39:21,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:39:23,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:39:23,315 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:39:26,519 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:39:26,522 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:39:29,887 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:39:29,889 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:39:29,891 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:39:29,893 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:39:29,895 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:39:29,895 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:39:29,897 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:39:29,897 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:39:29,899 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:39:29,901 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:39:29,901 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:39:29,909 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:39:29,921 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:39:29,925 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:39:29,929 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:39:29,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:39:33,086 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:39:33,090 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:39:33,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:39:36,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:39:36,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:39:57,243 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:39:57,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:04,395 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:40:23,118 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:40:23,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:40:26,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:40:26,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:43,621 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:40:56,456 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:41:08,027 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:41:08,029 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:41:09,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:41:09,512 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:41:09,514 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:41:19,293 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:41:36,878 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:41:37,265 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 59.
2025-11-17 15:41:50,507 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:41:53,511 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1978
2025-11-17 15:41:53,513 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:42:05,794 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1176
2025-11-17 15:42:05,795 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:42:07,383 - ispa_next.appointments.models - DEBUG - Appointment Berger KN-DB 240 WBA51CM0108C59502 ohne Termin.
2025-11-17 15:42:07,395 - ispa_next.appointments.models - DEBUG - Appointment Selcuk Ucaroglu NU-KU 5561 WBATX35090NC14152 ohne Termin.
2025-11-17 15:42:07,402 - ispa_next.main - DEBUG - Found new Appointment: F-CA 866
2025-11-17 15:42:07,403 - ispa_next.main - DEBUG - 



2025-11-17 15:42:07,403 - ispa_next.main - DEBUG - starting with process 60 (F-CA 866) of 60
2025-11-17 15:42:07,408 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:42:09,416 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:42:11,828 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1978
2025-11-17 15:42:11,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1176
2025-11-17 15:42:17,158 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:42:17,160 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:43:20,802 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:43:41,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:43:41,788 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:43:42,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:43:45,118 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:43:45,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:43:45,213 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:43:45,647 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:43:45,651 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:43:49,425 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:43:49,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:43:53,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:43:55,171 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:43:55,302 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:43:58,746 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:43:58,854 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:43:58,855 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:44:12,909 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:44:13,916 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:44:13,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:15,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:39,213 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:44:39,213 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:44:56,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:56,880 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:56,880 - ispa_next.functions - DEBUG - check_contact_details
2025-11-17 15:44:57,184 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-17 15:44:57,320 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-17 15:44:57,326 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:44:57,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:57,428 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:57,428 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:44:57,487 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:45:01,338 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:45:03,592 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:45:03,832 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:45:18,056 - ispa_next.functions - DEBUG - Updated appointment (GZ00000954) customer contact data.
2025-11-17 15:45:19,384 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:45:19,386 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:45:21,990 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:45:21,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:45:25,472 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:45:29,119 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:45:29,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:45:30,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:45:32,485 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:45:32,651 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:45:32,915 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:45:33,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:45:33,018 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:45:44,409 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:45:52,880 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:45:52,881 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:45:57,175 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:45:58,183 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:45:58,183 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:45:58,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:45:58,301 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:46:02,425 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:46:02,431 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:46:02,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:46:02,531 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:46:08,050 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 15:46:43,794 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 15:46:44,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:46:51,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:46:51,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:46:53,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:46:53,157 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:46:56,262 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:46:56,266 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:46:59,413 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:46:59,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:46:59,417 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 15:46:59,419 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:46:59,420 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:46:59,422 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:46:59,422 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:46:59,424 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:46:59,426 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:46:59,427 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:46:59,428 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:46:59,430 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:46:59,441 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:47:42,680 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:47:42,921 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 15:47:55,759 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:47:55,764 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:47:55,767 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:47:55,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:00,025 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:48:00,029 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:48:00,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:48:02,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:48:03,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:09,192 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:48:09,194 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:13,374 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:48:35,481 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:48:36,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:48:38,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:48:38,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:56,509 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:49:09,031 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:49:22,592 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:49:34,612 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:49:34,612 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:49:36,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:49:36,222 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:49:36,226 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:49:46,317 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:50:04,984 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:50:05,385 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 60.
2025-11-17 15:50:11,664 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:50:25,841 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1979
2025-11-17 15:50:25,843 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:50:35,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1172
2025-11-17 15:50:35,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:50:37,230 - ispa_next.appointments.models - DEBUG - Appointment Werner Pohl UL-WP 48 WBAWZ510900L12200 ohne Termin.
2025-11-17 15:50:37,242 - ispa_next.appointments.models - DEBUG - Appointment Axians Cloud & IT Automation UL-AH 16E WBY41DU0X0SF67743 ohne Termin.
2025-11-17 15:50:37,258 - ispa_next.appointments.models - DEBUG - Appointment Berger KN-DB 240 WBA51CM0108C59502 ohne Termin.
2025-11-17 15:50:37,300 - ispa_next.appointments.models - DEBUG - Appointment Selcuk Ucaroglu NU-KU 5561 WBATX35090NC14152 ohne Termin.
