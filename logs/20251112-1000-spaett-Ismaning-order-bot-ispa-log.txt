2025-11-12 10:07:31,920 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:07:31,926 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:07:40,530 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:07:52,009 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:08:07,622 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:08:40,883 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:08:53,290 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:08:56,404 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:57,343 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-12 10:08:57,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 498
2025-11-12 10:08:59,477 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-12 10:08:59,478 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:08:59,478 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:09:00,391 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:09:01,270 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:07,408 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,425 - ispa_next.appointments.models - DEBUG - Appointment Livia Veitschegger M-V 5084 WBA61CM0908C93157 ohne Termin.
2025-11-12 10:10:07,453 - ispa_next.appointments.models - DEBUG - Appointment Thomas Löb M-L 5621 WBA8H71010A040968 ohne Termin.
2025-11-12 10:10:07,464 - ispa_next.appointments.models - DEBUG - Appointment Antonio Cavar ED-AC 1986 WBA6L31020FJ84465 ohne Termin.
2025-11-12 10:10:07,469 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,488 - ispa_next.appointments.models - DEBUG - Appointment Rebecca Hurst FS-RA 602 WMW31DH0902V63832 ohne Termin.
2025-11-12 10:10:07,494 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,494 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,495 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,497 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,497 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,510 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schulz M-S 7319 WBA61EE0605Y49885 ohne Termin.
2025-11-12 10:10:07,530 - ispa_next.appointments.models - DEBUG - Appointment Firma NEO - Professional Solutions GmbH M-N 917 WBS31AZ000CM52265 ohne Termin.
2025-11-12 10:10:07,556 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,561 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,572 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,572 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,573 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,590 - ispa_next.appointments.models - DEBUG - Appointment Faton Halilaj M-DF 1991 WBA6L51030FJ39031 ohne Termin.
2025-11-12 10:10:07,604 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,618 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,620 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,638 - ispa_next.appointments.models - DEBUG - Appointment Martin Lamprecht  WBA7K310807P56396 ohne Termin.
2025-11-12 10:10:07,638 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,650 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,672 - ispa_next.appointments.models - DEBUG - Appointment Josef Deimel M-LW 90 WBATX35040NC13555 ohne Termin.
2025-11-12 10:10:07,685 - ispa_next.appointments.models - DEBUG - Appointment Firma Panavia Aircraft GmbH FS-PA 85E WBA65GP040N362472 ohne Termin.
2025-11-12 10:10:07,723 - ispa_next.appointments.models - DEBUG - Appointment Meisterbetrieb Thomas Patitz  WBA21GW060CU43030 ohne Termin.
2025-11-12 10:10:07,757 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Hanika M-WH 6500 WBA4K31030BG88527 ohne Termin.
2025-11-12 10:10:07,777 - ispa_next.appointments.models - DEBUG - Appointment Nina Bernreuther M-NN 369 WMWLV310502L56279 ohne Termin.
2025-11-12 10:10:07,779 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,797 - ispa_next.appointments.models - DEBUG - Appointment Michaela Hartwig M-NR 9641 WBA2E510205G52370 ohne Termin.
2025-11-12 10:10:07,813 - ispa_next.appointments.models - DEBUG - Appointment Firma JTF Beratung und M-JT 700 WBA51AJ0X0CK76754 ohne Termin.
2025-11-12 10:10:07,832 - ispa_next.appointments.models - DEBUG - Appointment Ladislav Kilisek M-JO 1742 WBA2A310207A62139 ohne Termin.
2025-11-12 10:10:07,846 - ispa_next.appointments.models - DEBUG - Appointment Ihor Karnakov M-KA 5871E WBA6N31070FM27147 ohne Termin.
2025-11-12 10:10:07,873 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke AG M-NP 3316 WMW21GA0407S97954 ohne Termin.
2025-11-12 10:10:07,891 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Yazar M-YA 29 WBA6V710005P54227 ohne Termin.
2025-11-12 10:10:07,910 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-12 10:10:07,925 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-12 10:10:07,940 - ispa_next.appointments.models - DEBUG - Appointment Joachim Schubert M-JS 2161 WBA51AB0105U16063 ohne Termin.
2025-11-12 10:10:07,940 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:07,959 - ispa_next.appointments.models - DEBUG - Appointment Imer Jakupi M-LJ 1824 WBA11DY090FK02746 ohne Termin.
2025-11-12 10:10:07,973 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Wydra M-W 5397 WBAJC91010B280060 ohne Termin.
2025-11-12 10:10:07,985 - ispa_next.appointments.models - DEBUG - Appointment   WBABS51040EW00681 ohne Termin.
2025-11-12 10:10:07,998 - ispa_next.appointments.models - DEBUG - Appointment Erwin Jaksch M-EJ 69 WBABG11010ER37920 ohne Termin.
2025-11-12 10:10:08,012 - ispa_next.appointments.models - DEBUG - Appointment Eduard Grimm M-EG 3011 WBS1H91060V916418 ohne Termin.
2025-11-12 10:10:08,028 - ispa_next.appointments.models - DEBUG - Appointment Tarik Sahin M-X 3330 WBAJK51000BJ13877 ohne Termin.
2025-11-12 10:10:08,047 - ispa_next.appointments.models - DEBUG - Appointment Firma ACTRON AG ED-AG 444 WBA5R11080FN22370 ohne Termin.
2025-11-12 10:10:08,059 - ispa_next.appointments.models - DEBUG - Appointment Anja Goetzke M-AG 565 WBAJU810409L17973 ohne Termin.
2025-11-12 10:10:08,083 - ispa_next.appointments.models - DEBUG - Appointment Marco Hübl  WBA21EN0009X29619 ohne Termin.
2025-11-12 10:10:08,100 - ispa_next.appointments.models - DEBUG - Appointment Narayanaswamy Anand M-SN 554 WMWLV710302L69958 ohne Termin.
2025-11-12 10:10:08,132 - ispa_next.appointments.models - DEBUG - Appointment Soria-Vanessa Neumann FS-N 347 WBA2H71010VA14727 ohne Termin.
2025-11-12 10:10:08,134 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:08,153 - ispa_next.appointments.models - DEBUG - Appointment Firma ProSiebenSat.1 Media SE M-P 7308 E WBA21EF0405Z47312 ohne Termin.
2025-11-12 10:10:08,235 - ispa_next.main - DEBUG - Found 20 out of 304 appointments to process (configured limit: 20).
2025-11-12 10:10:08,236 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 10:10:08,236 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 10:10:08,236 - ispa_next.main - DEBUG - All appointments: M-C 9104, FS- , M-L 8233, M-XM 6099E , M-RO 985 E, PF-DN 2121, M-NC 1407, AOIH412, M-S 8543 E, M-ON-120, AS-MY550, FSSP640, H PT 7268, M-S 1739 E, M-ZH-40, M-K 1317, EBE-FA 502, M-P 5330, M-P 1017, M-HR 2366
2025-11-12 10:10:08,239 - ispa_next.main - DEBUG - 



2025-11-12 10:10:08,239 - ispa_next.main - DEBUG - starting with process 1 (M-C 9104) of 20
2025-11-12 10:10:08,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:09,020 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:09,997 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-12 10:10:09,998 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-12 10:10:11,236 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:11,238 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:56,778 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:10:56,861 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:10:56,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:57,374 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-12 10:10:57,374 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:59,864 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 498
2025-11-12 10:10:59,865 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:00,816 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:00,821 - ispa_next.main - DEBUG - Found new Appointment: M-AR 3080
2025-11-12 10:11:00,823 - ispa_next.main - DEBUG - 



2025-11-12 10:11:00,823 - ispa_next.main - DEBUG - starting with process 2 (M-AR 3080) of 21
2025-11-12 10:11:00,829 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:01,799 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:02,685 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-12 10:11:02,686 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 498
2025-11-12 10:11:03,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:03,928 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:27,132 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:11:36,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:40,015 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:11:40,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:40,091 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:40,336 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:11:40,342 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:11:43,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:43,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:44,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:46,249 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:11:46,366 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:11:46,460 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:11:46,528 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:11:50,717 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:11:51,724 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:11:51,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:52,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:05,650 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:12:13,420 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:12:13,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:13,501 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:13,503 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:12:13,562 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:12:14,838 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:12:16,030 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:12:16,294 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:12:20,334 - ispa_next.functions - DEBUG - Updated appointment (AA00023672) customer contact data.
2025-11-12 10:12:21,244 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:12:21,248 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:12:22,081 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:12:22,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:12:22,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:12:26,409 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:26,409 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:12:26,414 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:12:26,418 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:12:26,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:26,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:32,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:33,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:33,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:33,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:33,700 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:12:36,769 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:12:36,770 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:12:37,893 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:12:37,895 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:12:37,897 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:12:37,901 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:12:37,905 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:12:37,923 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:12:37,925 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:12:37,927 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:12:37,929 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:12:37,931 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:12:37,938 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:12:37,941 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:12:37,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:41,248 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:12:41,252 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:12:41,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:44,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:44,551 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:12:53,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:06,534 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:13:06,538 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:13:06,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:13:07,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:13:07,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:19,486 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:13:19,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:22,789 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:13:33,938 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:13:34,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:35,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:13:35,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:06,576 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:11,952 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:18,125 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:14:18,125 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:18,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:14:18,830 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:14:18,834 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:14:22,143 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:14:31,826 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:14:32,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:14:33,496 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:34,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:14:34,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:37,196 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:14:37,197 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:38,001 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:14:38,004 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:14:38,011 - ispa_next.main - DEBUG - 



2025-11-12 10:14:38,012 - ispa_next.main - DEBUG - starting with process 3 (FS- ) of 21
2025-11-12 10:14:38,017 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:39,287 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:40,228 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:14:40,229 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:14:41,354 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:41,355 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:20,774 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:15:20,788 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:15:20,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:15:21,312 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:15:21,313 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:15:24,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:15:24,045 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:24,895 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:15:24,898 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:15:24,904 - ispa_next.main - DEBUG - 



2025-11-12 10:15:24,904 - ispa_next.main - DEBUG - starting with process 4 (M-L 8233) of 21
2025-11-12 10:15:24,910 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:15:26,209 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:15:27,561 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:15:27,563 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:15:29,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:15:29,010 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:53,397 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:16:06,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:08,281 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:16:08,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:08,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:08,560 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:16:08,566 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:16:11,261 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:16:11,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:12,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:14,390 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:16:14,505 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:16:17,748 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:16:17,843 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:16:17,843 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:16:26,457 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:16:27,465 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:16:27,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:27,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:31,629 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 10:16:31,638 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:16:31,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:31,746 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:31,747 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:16:31,781 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:16:32,999 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:16:34,239 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:16:34,490 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:16:37,430 - ispa_next.functions - DEBUG - Updated appointment (AF00012166) customer contact data.
2025-11-12 10:16:38,337 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:16:38,342 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:16:39,212 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:16:39,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:16:39,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:16:43,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:16:43,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:44,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:46,120 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:16:46,225 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:16:46,357 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:16:46,429 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:16:46,429 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:16:54,795 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:17:54,797 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:18:06,368 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:18:10,817 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:18:10,817 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:18:14,965 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:18:15,974 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:18:15,980 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:18:15,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:16,047 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:18:29,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:30,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:30,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:31,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:31,129 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:18:32,993 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:18:32,994 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:18:34,043 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:18:34,044 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:34,045 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:18:34,046 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:34,048 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:18:34,049 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:18:34,050 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:18:34,051 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:18:34,052 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:18:34,053 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:18:34,058 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:18:34,062 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:18:34,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:35,989 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:18:35,993 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:18:35,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:37,870 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:18:37,875 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:18:37,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:18:38,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:18:38,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:59,604 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:18:59,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:01,506 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:19:11,595 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:19:12,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:12,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:19:12,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:30,603 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:35,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:35,006 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:19:35,007 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:35,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:35,558 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:19:35,562 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:19:37,008 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:19:44,816 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:19:45,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:19:45,802 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:19:46,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:19:46,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:19:49,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:19:49,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:19:50,723 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:19:50,726 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:19:50,732 - ispa_next.main - DEBUG - 



2025-11-12 10:19:50,732 - ispa_next.main - DEBUG - starting with process 5 (M-XM 6099E ) of 21
2025-11-12 10:19:50,738 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:51,876 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:19:53,118 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:19:53,120 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:19:54,616 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:19:54,617 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:33,039 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:20:33,051 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:20:33,058 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:33,496 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:20:33,498 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:36,233 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:20:36,233 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:36,874 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:20:36,877 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:20:36,882 - ispa_next.main - DEBUG - 



2025-11-12 10:20:36,882 - ispa_next.main - DEBUG - starting with process 6 (M-RO 985 E) of 21
2025-11-12 10:20:36,887 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:37,795 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:38,802 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:20:38,803 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:20:40,050 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:40,052 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:09,332 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:21:09,344 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:21:09,349 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:09,761 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:21:09,762 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:12,373 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:21:12,373 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:13,195 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:21:13,199 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:13,204 - ispa_next.main - DEBUG - 



2025-11-12 10:21:13,204 - ispa_next.main - DEBUG - starting with process 7 (PF-DN 2121) of 21
2025-11-12 10:21:13,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:14,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:15,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:21:15,563 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:21:17,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:17,055 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:47,935 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:21:47,946 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:21:47,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:48,296 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:21:48,297 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:50,986 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:21:50,987 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:51,846 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:21:51,849 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:51,864 - ispa_next.main - DEBUG - 



2025-11-12 10:21:51,864 - ispa_next.main - DEBUG - starting with process 8 (M-NC 1407) of 21
2025-11-12 10:21:51,873 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:53,162 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:54,255 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:21:54,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:21:55,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:55,647 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:26,520 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:22:26,532 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:22:26,539 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:27,039 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:22:27,039 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:29,820 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:22:29,821 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:30,525 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:22:30,532 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:22:30,540 - ispa_next.main - DEBUG - 



2025-11-12 10:22:30,540 - ispa_next.main - DEBUG - starting with process 9 (AOIH412) of 21
2025-11-12 10:22:30,547 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:31,442 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:32,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:22:32,363 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:22:33,516 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:33,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:03,540 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:23:03,550 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:23:03,555 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:23:03,893 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:23:03,895 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:23:05,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:23:05,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:06,530 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:23:06,533 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:23:06,539 - ispa_next.main - DEBUG - 



2025-11-12 10:23:06,539 - ispa_next.main - DEBUG - starting with process 10 (M-S 8543 E) of 21
2025-11-12 10:23:06,546 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:23:07,717 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:23:08,810 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:23:08,811 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:23:09,994 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:23:09,995 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:37,728 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:23:37,739 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:23:37,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:23:38,167 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:23:38,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:23:40,774 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:23:40,775 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:41,607 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:23:41,610 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:23:41,616 - ispa_next.main - DEBUG - 



2025-11-12 10:23:41,616 - ispa_next.main - DEBUG - starting with process 11 (M-ON-120) of 21
2025-11-12 10:23:41,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:23:42,833 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:23:44,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:23:44,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:23:45,841 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:23:45,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:24:15,643 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:24:15,656 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:24:15,662 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:16,225 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:24:16,227 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:19,081 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:24:19,082 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:24:19,974 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:24:19,977 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:24:19,983 - ispa_next.main - DEBUG - 



2025-11-12 10:24:19,983 - ispa_next.main - DEBUG - starting with process 12 (AS-MY550) of 21
2025-11-12 10:24:19,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:20,943 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:21,780 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:24:21,781 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:24:23,201 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:23,202 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:05,026 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:25:05,039 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:25:05,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:05,642 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:25:05,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:08,250 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:25:08,250 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:09,204 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:25:09,207 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:25:09,213 - ispa_next.main - DEBUG - 



2025-11-12 10:25:09,213 - ispa_next.main - DEBUG - starting with process 13 (FSSP640) of 21
2025-11-12 10:25:09,218 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:10,060 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:11,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:25:11,010 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:25:12,241 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:12,242 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:43,134 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:25:43,144 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:25:43,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:43,526 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:25:43,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:45,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:25:45,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:46,245 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:25:46,248 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:25:46,252 - ispa_next.main - DEBUG - 



2025-11-12 10:25:46,252 - ispa_next.main - DEBUG - starting with process 14 (H PT 7268) of 21
2025-11-12 10:25:46,259 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:47,227 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:48,177 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:25:48,178 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:25:49,446 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:49,447 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:17,076 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:26:17,086 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:26:17,091 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:17,539 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:26:17,541 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:19,586 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:26:19,587 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:20,282 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:26:20,286 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:26:20,295 - ispa_next.main - DEBUG - 



2025-11-12 10:26:20,295 - ispa_next.main - DEBUG - starting with process 15 (M-S 1739 E) of 21
2025-11-12 10:26:20,301 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:26:21,123 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:22,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:26:22,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:26:23,335 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:26:23,336 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:26:59,334 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:26:59,344 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:26:59,350 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:26:59,727 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:26:59,727 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:01,841 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:27:01,841 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:02,605 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:27:02,608 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:27:02,613 - ispa_next.main - DEBUG - 



2025-11-12 10:27:02,613 - ispa_next.main - DEBUG - starting with process 16 (M-ZH-40) of 21
2025-11-12 10:27:02,619 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:03,531 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:04,403 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:27:04,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:27:05,664 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:05,665 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:35,088 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:27:35,098 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 10:27:35,110 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:35,641 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:27:35,642 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:38,817 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:27:38,817 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:39,579 - ispa_next.appointments.models - DEBUG - Appointment Nicolai Bieber M-DR 2907 WBA5K11020D758786 ohne Termin.
2025-11-12 10:27:39,582 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:27:39,588 - ispa_next.main - DEBUG - 



2025-11-12 10:27:39,588 - ispa_next.main - DEBUG - starting with process 17 (M-K 1317) of 21
2025-11-12 10:27:39,594 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:40,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:41,920 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:27:41,922 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:27:43,375 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:43,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:14,691 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:28:16,583 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:28:21,623 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:22,871 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:28:22,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:22,947 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:23,174 - ispa_next.functions - DEBUG - HU date already expired after 10 days.
2025-11-12 10:28:27,083 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:28:27,090 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:28:29,841 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:28:29,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:30,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:32,852 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:28:32,992 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:28:33,072 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:28:33,145 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:28:37,332 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:28:38,341 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:28:38,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:38,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:47,178 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:28:50,234 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:28:50,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:50,326 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:50,326 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:28:50,359 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:28:50,458 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:28:51,649 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:28:52,827 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:28:53,218 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:28:54,898 - ispa_next.functions - DEBUG - Updated appointment (AA00023546) customer contact data.
2025-11-12 10:28:55,830 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:28:55,834 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:28:55,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:56,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:28:57,856 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:28:57,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:28:57,988 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:29:01,619 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:01,621 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:29:01,625 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:29:01,631 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:29:01,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:02,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:02,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:02,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:02,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:03,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:03,744 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:29:05,054 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:29:05,057 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:29:06,464 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:29:06,468 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:29:06,470 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:29:06,472 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:29:06,474 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:29:06,476 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:29:06,476 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:29:06,478 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:29:06,478 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:29:06,480 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:29:06,486 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:29:06,490 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:29:06,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:07,732 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:29:07,736 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:29:07,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:08,938 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:29:08,943 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:29:08,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:29:09,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:29:09,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:17,762 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:29:17,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:18,999 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:29:30,754 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:29:31,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:29:31,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:29:32,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:43,087 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:29:43,093 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:29:43,093 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:29:43,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:29:43,782 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:29:43,786 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:29:45,591 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:29:53,832 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:29:54,231 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 10:29:54,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:29:55,919 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:29:55,921 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:29:58,609 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:29:58,610 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:59,449 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:29:59,454 - ispa_next.main - DEBUG - Found new Appointment: M-DR 2907
2025-11-12 10:29:59,456 - ispa_next.main - DEBUG - 



2025-11-12 10:29:59,457 - ispa_next.main - DEBUG - starting with process 18 (M-DR 2907) of 22
2025-11-12 10:29:59,464 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:00,719 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:01,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-12 10:30:01,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:30:03,346 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:03,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:35,090 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:30:44,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:44,496 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:30:44,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:45,864 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:30:45,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:45,942 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:30:46,086 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:30:46,091 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:30:48,789 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:30:48,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:49,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:51,848 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:30:51,970 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:30:55,177 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:30:55,258 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:30:55,259 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:31:04,080 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:31:05,102 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:31:05,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:05,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:17,639 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:31:24,609 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:31:24,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:31:24,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:31:24,736 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:31:24,781 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:31:24,890 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:31:26,002 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:31:27,234 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:31:27,643 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:31:30,999 - ispa_next.functions - DEBUG - Updated appointment (AA00023683) customer contact data.
2025-11-12 10:31:32,016 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:31:32,020 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:31:32,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:31:32,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:31:34,141 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:31:34,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:31:34,201 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:31:38,606 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:31:38,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:31:39,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:31:41,221 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:31:41,371 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:31:41,457 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:31:41,575 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:31:41,575 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:31:50,190 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:32:50,192 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:32:58,688 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:33:35,690 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:33:44,349 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:33:51,592 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:33:52,600 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:33:52,604 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:33:52,604 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 10:33:52,605 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:33:54,548 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:33:54,550 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:33:56,168 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:33:56,169 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:33:56,171 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:33:56,172 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:33:56,173 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:33:56,174 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:33:56,175 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:33:56,177 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:33:56,182 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:33:56,186 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:33:56,193 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:33:56,197 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:33:56,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:58,115 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:33:58,127 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:33:58,131 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:59,970 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:33:59,974 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:33:59,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:34:00,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:34:00,831 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:34:00,836 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:02,724 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:34:13,601 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:34:14,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:14,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:34:14,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:32,904 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:37,609 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:34:37,613 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:34:37,614 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:34:38,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:34:38,403 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:34:38,407 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:34:40,064 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:34:47,496 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:34:47,884 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 10:34:48,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:49,402 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-12 10:34:49,403 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:52,284 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 498
2025-11-12 10:34:52,284 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:34:53,105 - ispa_next.main - DEBUG - Found new Appointment: M-EG 3011
2025-11-12 10:34:53,116 - ispa_next.main - DEBUG - 



2025-11-12 10:34:53,116 - ispa_next.main - DEBUG - starting with process 19 (M-EG 3011) of 23
2025-11-12 10:34:53,122 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:34:54,345 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:55,491 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-12 10:34:55,492 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 498
2025-11-12 10:34:57,097 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:57,098 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:26,898 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:35:36,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:36,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:36,950 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:39,569 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:35:39,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:39,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:40,009 - ispa_next.functions - DEBUG - HU date already expired after 37 days.
2025-11-12 10:35:47,255 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:35:47,261 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:35:50,014 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:35:50,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:51,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:53,083 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:35:53,203 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:35:56,443 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:35:56,519 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:35:56,519 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:05,239 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:36:06,252 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:36:06,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:06,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:20,151 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:36:27,517 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:36:27,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:27,609 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:27,611 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:36:27,642 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:36:28,862 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:36:29,082 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:36:33,042 - ispa_next.functions - DEBUG - Updated appointment (AA00023684) customer contact data.
2025-11-12 10:36:33,951 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:36:33,955 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:36:34,762 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:36:34,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:36:35,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:36:39,116 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:36:39,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:39,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:36:41,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:36:41,719 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:36:41,808 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:36:41,869 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:36:41,871 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:36:50,254 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:37:50,257 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:38:01,035 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:38:06,415 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:38:06,415 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:38:10,641 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:38:11,648 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:38:11,654 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:38:11,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:11,748 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:12,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:12,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:38:12,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:13,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:38:13,336 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:38:16,892 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:38:16,893 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:38:17,826 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:38:17,826 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:17,828 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:38:17,828 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:38:17,830 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:38:17,833 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:38:17,838 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:38:17,842 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:38:17,844 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:38:17,848 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:38:17,853 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:38:17,857 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:38:17,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:21,771 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:38:21,775 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:38:21,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:25,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:38:25,795 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:38:37,849 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:38:37,853 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:38:37,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:38:38,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:38:38,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:45,581 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:38:45,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:49,546 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:38:59,564 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:39:00,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:00,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:39:00,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:39,035 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:43,605 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:48,470 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:53,262 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:39:59,366 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:59,368 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:40:00,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:40:00,186 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:40:00,189 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:40:03,031 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:40:09,626 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:40:10,013 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 10:40:10,942 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:11,887 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-12 10:40:11,889 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:14,119 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 498
2025-11-12 10:40:14,119 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:14,723 - ispa_next.main - DEBUG - 



2025-11-12 10:40:14,724 - ispa_next.main - DEBUG - starting with process 20 (EBE-FA 502) of 23
2025-11-12 10:40:14,729 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:40:15,586 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:16,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-12 10:40:16,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 498
2025-11-12 10:40:17,656 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:17,657 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:51,987 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:40:53,796 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:40:58,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:00,568 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:41:00,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:00,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:00,890 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:41:00,905 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:41:03,735 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:03,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:04,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:06,876 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:41:07,009 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:41:07,083 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:41:07,224 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:41:11,418 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:41:12,426 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:41:12,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:12,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:24,319 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:41:28,626 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:41:28,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:28,732 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:28,734 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:41:28,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:41:30,008 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:41:30,234 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:41:32,077 - ispa_next.functions - DEBUG - Updated appointment (AF00012098) customer contact data.
2025-11-12 10:41:33,373 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:41:33,378 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:41:34,152 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:41:34,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:41:34,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:41:38,980 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:41:38,980 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:38,980 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:41:38,985 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:41:38,991 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:41:38,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:39,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:45,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:45,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:45,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:46,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:46,440 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:41:48,324 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:41:48,325 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:41:49,123 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:41:49,123 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:41:49,125 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:41:49,127 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:41:49,127 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:41:49,127 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:41:49,129 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:41:49,129 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:41:49,131 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:41:49,132 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:41:49,137 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:41:49,141 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:41:49,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:50,995 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:41:50,999 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:41:51,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:52,912 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:41:52,916 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:41:52,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:41:53,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:41:54,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:03,314 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:42:03,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:05,220 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:42:16,313 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:42:16,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:42:17,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:42:17,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:35,728 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:42:40,640 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:42:40,644 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:42:40,644 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:42:41,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:42:41,383 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:42:41,387 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:42:43,028 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:42:50,769 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:42:51,169 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 10:42:51,754 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:42:52,938 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 900
2025-11-12 10:42:52,939 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:42:55,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:42:55,846 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:42:56,660 - ispa_next.appointments.models - DEBUG - Appointment Alexander Kämpfe M-K 1004 WBACV010909D05781 ohne Termin.
2025-11-12 10:42:56,669 - ispa_next.main - DEBUG - 



2025-11-12 10:42:56,669 - ispa_next.main - DEBUG - starting with process 21 (M-P 5330) of 23
2025-11-12 10:42:56,674 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:42:57,973 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:42:59,150 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 900
2025-11-12 10:42:59,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:43:00,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:43:00,753 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:43:29,663 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:43:31,589 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:43:36,599 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:38,542 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:43:38,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:38,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:43:38,786 - ispa_next.functions - DEBUG - HU date already expired after 412 days.
2025-11-12 10:43:42,724 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:43:42,729 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:43:45,524 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:43:45,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:46,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:43:48,836 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:43:48,940 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:43:49,073 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:43:49,162 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:43:53,323 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:43:54,329 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:43:54,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:54,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:07,706 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:44:11,869 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:44:11,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:11,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:44:11,943 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:44:11,980 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:44:12,103 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:44:13,233 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:44:14,537 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:44:14,940 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:44:17,288 - ispa_next.functions - DEBUG - Updated appointment (AA00023288) customer contact data.
2025-11-12 10:44:18,266 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:44:18,270 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:44:18,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:44:19,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:44:20,156 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:44:20,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:44:20,230 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:44:23,798 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:44:23,798 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:44:23,803 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:44:23,808 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:44:23,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:24,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:24,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:25,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:44:25,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:44:25,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:44:25,936 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:44:27,850 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:44:27,852 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:44:29,296 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:44:29,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:44:29,306 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:44:29,308 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:44:29,308 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:44:29,310 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:44:29,310 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:44:29,312 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:44:29,312 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:44:29,314 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:44:29,318 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:44:29,322 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:44:29,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:31,164 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:44:31,168 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:44:31,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:33,050 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:44:33,053 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:44:33,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:44:34,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:44:34,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:43,497 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:44:43,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:45,395 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:44:56,656 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:44:57,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:44:57,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:44:57,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:15,392 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:45:19,390 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:45:19,394 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:45:19,394 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:45:19,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:45:19,928 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:45:19,932 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:45:21,305 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:45:28,535 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:45:28,910 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-12 10:45:29,578 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:45:31,006 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 900
2025-11-12 10:45:31,008 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:45:33,881 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-12 10:45:33,881 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:45:34,697 - ispa_next.appointments.models - DEBUG - Appointment Alexander Kämpfe M-K 1004 WBACV010909D05781 ohne Termin.
2025-11-12 10:45:34,707 - ispa_next.main - DEBUG - 



2025-11-12 10:45:34,707 - ispa_next.main - DEBUG - starting with process 22 (M-P 1017) of 23
2025-11-12 10:45:34,713 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:45:35,842 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:45:37,124 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 900
2025-11-12 10:45:37,125 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-12 10:45:38,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:45:38,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:46:04,029 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:46:05,689 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:46:10,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:13,419 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:46:13,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:13,497 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:46:13,776 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:46:13,781 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:46:16,617 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:46:16,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:17,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:19,810 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:46:19,927 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:46:20,039 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:46:20,131 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:46:24,258 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:46:25,266 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:46:25,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:25,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:36,598 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:46:36,598 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:46:41,179 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:46:41,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:41,248 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:46:41,248 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:46:41,312 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:46:42,606 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:46:42,827 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:46:44,746 - ispa_next.functions - DEBUG - Updated appointment (AA00023464) customer contact data.
2025-11-12 10:46:45,685 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:46:45,691 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:46:46,489 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:46:46,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:46:47,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:46:51,517 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:46:51,517 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:46:51,523 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:46:51,527 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:46:51,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:52,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:57,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:58,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:58,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:59,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:59,031 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:47:01,498 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:47:01,502 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:47:02,524 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:47:02,526 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:47:02,528 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:47:02,528 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:47:02,530 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:47:02,532 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:47:02,532 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:47:02,534 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:47:02,534 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:47:02,536 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:47:02,540 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:47:02,546 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:47:02,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:05,163 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:47:05,167 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:47:05,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:07,766 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:47:07,768 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:47:07,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:47:08,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:47:08,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:18,626 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:47:18,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:21,292 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:47:32,574 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:47:33,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:47:33,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:47:33,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:59,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:48:03,206 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:48:07,783 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:48:07,787 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:48:07,787 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:48:08,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:48:08,443 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:48:08,447 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:48:10,018 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:48:18,072 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:48:18,471 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-12 10:48:19,142 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:48:20,630 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 902
2025-11-12 10:48:20,632 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:48:23,632 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 501
2025-11-12 10:48:23,633 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:48:24,455 - ispa_next.appointments.models - DEBUG - Appointment Firma Tengelmann Twenty-One KG M-NJ 323 WBA31DZ040FM60809 ohne Termin.
2025-11-12 10:48:24,463 - ispa_next.main - DEBUG - Found new Appointment: M-K 1004
2025-11-12 10:48:24,465 - ispa_next.main - DEBUG - 



2025-11-12 10:48:24,465 - ispa_next.main - DEBUG - starting with process 23 (M-K 1004) of 24
2025-11-12 10:48:24,470 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:48:25,530 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:48:26,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 902
2025-11-12 10:48:26,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 501
2025-11-12 10:48:28,045 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:48:28,046 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:48:52,573 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:49:02,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:49:06,719 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:49:06,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:06,802 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:49:06,948 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-12 10:49:14,023 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:49:14,027 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:49:16,757 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:49:16,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:17,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:49:19,978 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:49:20,104 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:49:20,207 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:49:20,290 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:49:24,446 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:49:25,452 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:49:25,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:25,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:39,243 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:49:46,510 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:49:46,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:49:46,596 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:49:46,597 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:49:46,680 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:49:47,941 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:49:48,139 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:49:52,600 - ispa_next.functions - DEBUG - Updated appointment (AA00023686) customer contact data.
2025-11-12 10:49:53,506 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:49:53,510 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:49:54,448 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:49:54,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:49:55,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:49:59,439 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:49:59,439 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:49:59,439 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:49:59,444 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:49:59,449 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:49:59,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:49:59,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:50:04,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:04,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:50:04,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:50:05,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:50:05,370 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:50:08,984 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:50:08,988 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:50:10,103 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:50:10,120 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:50:10,121 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:50:10,123 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:50:10,125 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:50:10,125 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:50:10,127 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:50:10,127 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:50:10,129 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:50:10,129 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:50:10,135 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:50:10,138 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:50:10,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:14,463 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:50:17,402 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:50:17,407 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:50:17,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:21,724 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:50:21,728 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:50:21,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:50:22,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:50:23,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:38,478 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:50:38,480 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:50:42,575 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:50:54,244 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:50:54,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:50:55,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:50:55,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:51:34,396 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:39,301 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:43,980 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:48,005 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:52,996 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:51:53,000 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:51:53,001 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:51:53,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:51:53,750 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:51:53,753 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:51:55,486 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:52:03,521 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:52:03,906 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 23.
2025-11-12 10:52:04,606 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:52:05,932 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 10:52:05,934 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:52:09,054 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 501
2025-11-12 10:52:09,055 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:52:09,955 - ispa_next.appointments.models - DEBUG - Appointment Firma Tengelmann Twenty-One KG M-NJ 323 WBA31DZ040FM60809 ohne Termin.
2025-11-12 10:52:09,963 - ispa_next.main - DEBUG - 



2025-11-12 10:52:09,963 - ispa_next.main - DEBUG - starting with process 24 (M-HR 2366) of 24
2025-11-12 10:52:09,969 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:52:11,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:52:12,513 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 10:52:12,514 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 501
2025-11-12 10:52:14,027 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:52:14,029 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:52:48,034 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:52:49,770 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:52:54,926 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:52:56,913 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:52:56,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:52:56,993 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:52:57,235 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:52:57,239 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:53:00,194 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:53:00,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:53:01,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:53:03,334 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:53:03,428 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:53:03,574 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:53:03,647 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:53:07,818 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:53:08,826 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:53:08,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:53:09,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:53:20,471 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:53:24,636 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:53:24,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:53:24,714 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:53:24,714 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:53:24,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:53:24,910 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:53:26,198 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:53:26,398 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:53:28,255 - ispa_next.functions - DEBUG - Updated appointment (AA00023662) customer contact data.
2025-11-12 10:53:29,209 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:53:29,212 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:53:29,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:53:30,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:53:31,158 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:53:31,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:53:31,218 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:53:34,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:53:34,825 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:53:34,830 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:53:34,835 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:53:34,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:53:35,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:53:35,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:53:36,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:53:36,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:53:37,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:53:37,004 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:53:38,918 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:53:38,926 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:53:40,355 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:53:40,359 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:53:40,362 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:53:40,366 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:53:40,368 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:53:40,369 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:53:40,370 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:53:40,371 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:53:40,371 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:53:40,373 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:53:40,377 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:53:40,381 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:53:40,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:42,335 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:53:45,059 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:53:45,063 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:53:45,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:47,225 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:53:47,227 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:53:47,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:53:48,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:53:48,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:50,746 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:53:50,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:53:52,720 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:54:04,665 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:54:05,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:54:05,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:54:05,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:54:24,360 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:29,531 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:54:32,863 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:54:32,863 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:54:33,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:54:33,590 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:54:33,594 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:54:37,573 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:54:45,497 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:54:45,874 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 24.
2025-11-12 10:54:46,249 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:54:47,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 902
2025-11-12 10:54:47,968 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:54:50,604 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 500
2025-11-12 10:54:50,604 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:54:51,328 - ispa_next.appointments.models - DEBUG - Appointment Firma Tengelmann Twenty-One KG M-NJ 323 WBA31DZ040FM60809 ohne Termin.
