2025-11-12 09:00:36,380 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:00:36,387 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:00:49,565 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:01:01,623 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:01:17,142 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:02:21,536 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:02:36,143 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:02:40,106 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:02:41,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:02:41,126 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 623
2025-11-12 09:02:42,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 440
2025-11-12 09:02:42,947 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:02:42,947 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:02:43,718 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:02:44,529 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:03:50,475 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:50,533 - ispa_next.appointments.models - DEBUG - Appointment betaplan GmbH LÖ-BS 7119 WBA41CM0108E22810 ohne Termin.
2025-11-12 09:03:50,535 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:50,561 - ispa_next.appointments.models - DEBUG - Appointment Elektro Rütten GmbH LÖ-ER 3003 WBS61AY0X0FS27171 ohne Termin.
2025-11-12 09:03:50,593 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:50,619 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-12 09:03:50,624 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:50,667 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-12 09:03:50,699 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-12 09:03:50,717 - ispa_next.appointments.models - DEBUG - Appointment Vahap Yilmaz LÖ-VY 23 WBAWZ510300M14799 ohne Termin.
2025-11-12 09:03:50,736 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-12 09:03:50,757 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-12 09:03:50,776 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-12 09:03:50,795 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-12 09:03:50,815 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-12 09:03:50,843 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-12 09:03:50,863 - ispa_next.appointments.models - DEBUG - Appointment Mady Wattiau DZ-892-BN WBAVP71090V210069 ohne Termin.
2025-11-12 09:03:50,903 - ispa_next.main - DEBUG - Found 15 out of 147 appointments to process (configured limit: 15).
2025-11-12 09:03:50,903 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 09:03:50,904 - ispa_next.main - DEBUG - Processing 12 already visited appointments (w/ RKR not callable).
2025-11-12 09:03:50,904 - ispa_next.main - DEBUG - All appointments: LÖ-IK 9781, LÖ-M6H, LÖ-AN 995, LÖ-TL 296, LÖ-ZV 777, BL 190121, LÖ-G 6670, GP-708-TR, LÖ-EE 2122, LÖ-H 2406, LÖ-RP 112E, LÖ-AS 801, WT-GR 460, BS 14468, LÖ-DO 6666
2025-11-12 09:03:50,907 - ispa_next.main - DEBUG - 



2025-11-12 09:03:50,907 - ispa_next.main - DEBUG - starting with process 1 (LÖ-IK 9781) of 15
2025-11-12 09:03:50,912 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:03:52,140 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:03:53,606 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:03:53,607 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 440
2025-11-12 09:03:54,981 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:03:54,983 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:04:39,053 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:04:39,135 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:04:39,141 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:04:39,658 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:04:39,659 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:04:41,766 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 623
2025-11-12 09:04:41,766 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:04:42,454 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:04:42,461 - ispa_next.main - DEBUG - Found new Appointment: LÖ-BB 288E
2025-11-12 09:04:42,462 - ispa_next.main - DEBUG - 



2025-11-12 09:04:42,462 - ispa_next.main - DEBUG - starting with process 2 (LÖ-BB 288E) of 16
2025-11-12 09:04:42,468 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:04:43,422 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:04:44,480 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:04:44,481 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 623
2025-11-12 09:04:45,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:04:45,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:05:10,047 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:05:12,052 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:05:17,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:05:19,696 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:05:19,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:19,776 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:05:20,000 - ispa_next.functions - DEBUG - HU date soon to be invalid in 72 days.
2025-11-12 09:05:22,928 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:05:22,932 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:05:25,609 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:05:25,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:05:26,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:05:28,387 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:05:28,505 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:05:28,617 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:05:28,707 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:05:32,927 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:05:33,932 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:05:33,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:34,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:46,350 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:05:46,350 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:05:50,245 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:05:50,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:50,321 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:05:50,323 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:05:50,452 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:05:51,644 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:05:52,868 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:05:53,127 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:05:54,524 - ispa_next.functions - DEBUG - Updated appointment (AD00049338) customer contact data.
2025-11-12 09:05:55,452 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:05:55,456 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:05:56,278 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:05:56,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:05:56,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:06:00,527 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:06:00,527 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:06:00,531 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:06:00,533 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:06:00,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:06:01,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:06:09,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:06:10,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:06:10,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:06:11,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:06:11,127 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:06:13,535 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:06:13,536 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:06:14,862 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:06:14,863 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:06:14,865 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:06:14,865 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:06:14,867 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:06:14,869 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:06:14,873 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:06:14,876 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:06:14,878 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:06:14,884 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:06:14,888 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:06:14,888 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:06:17,497 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:06:17,500 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:06:17,502 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:06:17,504 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:06:17,508 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:06:17,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:06:20,116 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:06:20,120 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:06:20,123 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:06:20,123 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:06:20,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:06:21,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:06:21,646 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:06:23,446 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:06:33,581 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:06:33,953 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:06:34,375 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:06:36,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:06:36,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:06:39,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 09:06:39,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:06:40,045 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:06:40,054 - ispa_next.main - DEBUG - 



2025-11-12 09:06:40,054 - ispa_next.main - DEBUG - starting with process 3 (LÖ-M6H) of 16
2025-11-12 09:06:40,059 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:06:41,312 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:06:42,487 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:06:42,488 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 09:06:43,737 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:06:43,738 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:12,507 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:07:12,519 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:07:12,523 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:07:13,103 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:07:13,105 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:07:15,792 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 09:07:15,792 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:16,651 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:07:16,659 - ispa_next.main - DEBUG - 



2025-11-12 09:07:16,659 - ispa_next.main - DEBUG - starting with process 4 (LÖ-AN 995) of 16
2025-11-12 09:07:16,664 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:07:17,779 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:07:18,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:07:18,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 09:07:20,409 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:07:20,410 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:51,900 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:07:51,914 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:07:51,920 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:07:52,535 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:07:52,536 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:07:55,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 09:07:55,333 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:55,991 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:07:56,033 - ispa_next.main - DEBUG - 



2025-11-12 09:07:56,033 - ispa_next.main - DEBUG - starting with process 5 (LÖ-TL 296) of 16
2025-11-12 09:07:56,052 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:07:57,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:07:58,015 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:07:58,016 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 09:07:59,278 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:07:59,279 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:08:23,402 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:08:25,331 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:08:29,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:08:34,519 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:08:34,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:34,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:08:34,819 - ispa_next.functions - DEBUG - HU date already expired after 363 days.
2025-11-12 09:08:38,144 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:08:38,147 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:08:40,790 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:08:40,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:08:41,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:08:43,620 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:08:43,724 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:08:43,853 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:08:43,919 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:08:46,082 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:08:47,087 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:08:47,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:47,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:58,263 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:09:02,165 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:09:02,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:09:02,277 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:09:02,278 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:09:02,319 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:09:02,418 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:09:03,803 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:09:04,043 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:09:05,539 - ispa_next.functions - DEBUG - Updated appointment (AC00064781) customer contact data.
2025-11-12 09:09:06,455 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:09:06,458 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:09:06,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:09:07,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:09:08,468 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:09:08,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:09:08,551 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:09:12,149 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:09:12,151 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:09:12,155 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:09:12,159 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:09:12,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:09:12,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:09:13,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:09:13,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:09:13,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:09:14,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:09:14,186 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:09:18,293 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:09:18,295 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:09:19,168 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:09:19,168 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:09:19,170 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:09:19,172 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:09:19,175 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:09:19,175 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:09:19,177 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:09:19,177 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:09:19,179 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:09:19,179 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:09:19,185 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:09:19,189 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:09:19,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:23,841 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:09:23,844 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:09:23,846 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:09:23,849 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:09:23,851 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:09:23,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:28,441 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:09:28,445 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:09:28,447 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:09:28,449 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:09:29,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:09:29,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:09:29,969 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:09:31,941 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:09:40,443 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:09:40,825 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:09:41,289 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:09:43,738 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:09:43,739 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:09:46,639 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 623
2025-11-12 09:09:46,640 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:09:47,622 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:09:47,637 - ispa_next.main - DEBUG - 



2025-11-12 09:09:47,637 - ispa_next.main - DEBUG - starting with process 6 (LÖ-ZV 777) of 16
2025-11-12 09:09:47,642 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:09:48,685 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:09:49,695 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:09:49,697 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 623
2025-11-12 09:09:51,093 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:09:51,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:10:11,747 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:10:13,755 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:10:18,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:10:24,165 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:10:24,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:10:24,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:10:24,484 - ispa_next.functions - DEBUG - HU date already expired after 2482 days.
2025-11-12 09:10:28,718 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:10:28,723 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:10:31,517 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:10:31,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:10:32,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:10:34,482 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:10:34,572 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:10:34,694 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:10:34,753 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:10:36,864 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:10:37,869 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:10:37,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:10:38,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:10:52,097 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:10:56,404 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:10:56,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:10:56,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:10:56,511 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:10:56,547 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:10:57,859 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:10:59,147 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:10:59,402 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:11:00,915 - ispa_next.functions - DEBUG - Updated appointment (BA00005034) customer contact data.
2025-11-12 09:11:01,848 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:11:01,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:11:02,699 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:11:02,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:11:03,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:11:07,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:11:07,026 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:11:07,030 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:11:07,032 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:11:07,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:11:07,545 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:11:07,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:08,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:08,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:11:09,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:11:09,067 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:11:13,743 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:11:13,745 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:11:14,705 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:11:14,705 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:11:14,707 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:11:14,707 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:11:14,709 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:11:14,709 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:11:14,713 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:11:14,717 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:11:14,719 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:11:14,723 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:11:14,729 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:11:14,730 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:11:14,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:11:20,052 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:11:20,055 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:11:20,057 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:11:20,059 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:11:20,061 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:11:20,065 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:11:25,333 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:11:25,336 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:11:25,338 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:11:25,339 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:11:26,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:11:26,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:11:26,657 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:11:28,213 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:11:35,673 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:11:36,044 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:11:36,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:11:38,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:11:38,667 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:11:41,629 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 09:11:41,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:42,495 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:11:42,503 - ispa_next.main - DEBUG - 



2025-11-12 09:11:42,503 - ispa_next.main - DEBUG - starting with process 7 (BL 190121) of 16
2025-11-12 09:11:42,507 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:11:43,752 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:11:45,145 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:11:45,147 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 09:11:46,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:11:46,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:12:22,662 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:12:24,788 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:12:29,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:40,458 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:12:40,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:40,520 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:12:40,677 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:12:44,741 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:12:44,745 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:12:47,518 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:12:47,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:48,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:50,592 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:12:50,717 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:12:50,811 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:12:50,920 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:12:53,053 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:12:54,059 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:12:54,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:54,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:07,113 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:13:11,321 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:13:11,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:11,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:13:11,392 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:13:11,490 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:13:11,652 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:13:12,907 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:13:13,128 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:13:14,673 - ispa_next.functions - DEBUG - Updated appointment (AE00033504) customer contact data.
2025-11-12 09:13:15,756 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:13:15,759 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:13:15,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:13:16,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:13:17,765 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:13:17,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:13:17,863 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:13:21,429 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:13:21,429 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:13:21,434 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:13:21,438 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:13:21,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:13:21,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:13:22,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:22,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:22,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:13:23,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:13:23,509 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:13:32,764 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:13:32,766 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:13:33,804 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:13:33,806 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:13:33,808 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:13:33,810 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:13:33,811 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:13:33,813 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:13:33,823 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:13:33,823 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:13:33,825 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:13:33,831 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:13:33,834 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:13:33,837 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:13:33,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:44,603 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:13:47,175 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:13:47,201 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:13:47,455 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:13:47,478 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:13:47,481 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:13:47,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:58,254 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:13:58,256 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:13:58,260 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:13:58,260 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:13:59,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:13:59,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:13:59,943 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:14:02,004 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:14:10,764 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:14:11,168 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:14:11,782 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:14:14,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:14:14,009 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:14:17,093 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 622
2025-11-12 09:14:17,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:14:18,060 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:14:18,069 - ispa_next.main - DEBUG - 



2025-11-12 09:14:18,069 - ispa_next.main - DEBUG - starting with process 8 (LÖ-G 6670) of 16
2025-11-12 09:14:18,073 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:14:19,333 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:14:20,543 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:14:20,544 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 622
2025-11-12 09:14:21,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:14:21,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:14:46,222 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:14:48,011 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:14:52,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:58,705 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:14:58,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:58,834 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:14:59,062 - ispa_next.functions - DEBUG - HU date already expired after 1934 days.
2025-11-12 09:15:02,497 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:15:02,500 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:15:05,148 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:15:05,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:06,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:15:08,223 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:15:08,329 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:15:08,428 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:15:08,518 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:15:10,703 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:15:11,712 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:15:11,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:12,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:26,752 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:15:31,722 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:15:31,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:31,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:15:31,799 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:15:31,859 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:15:31,990 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:15:33,205 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:15:33,434 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:15:34,968 - ispa_next.functions - DEBUG - Updated appointment (AE00033475) customer contact data.
2025-11-12 09:15:35,862 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:15:36,088 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:15:36,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:15:37,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:15:38,159 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:15:38,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:15:38,252 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:15:41,834 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:15:41,834 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:15:41,838 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:15:41,842 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:15:41,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:42,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:15:42,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:43,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:43,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:44,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:15:44,102 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:15:49,516 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:15:49,518 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:15:50,719 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:15:50,720 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:15:50,722 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:15:50,723 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:15:50,725 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:15:50,726 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:15:50,727 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:15:50,728 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:15:50,729 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:15:50,730 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:15:50,734 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:15:50,736 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:15:50,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:15:56,737 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:15:56,739 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:15:56,742 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:15:56,744 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:15:56,746 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:15:56,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:16:02,781 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:16:02,782 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:16:02,789 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:16:02,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:16:03,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:16:04,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:16:04,653 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:16:06,582 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:16:14,370 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:16:14,760 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:16:15,263 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:17,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:16:17,412 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:20,159 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 620
2025-11-12 09:16:20,160 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:21,042 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:16:21,050 - ispa_next.main - DEBUG - 



2025-11-12 09:16:21,051 - ispa_next.main - DEBUG - starting with process 9 (GP-708-TR) of 16
2025-11-12 09:16:21,054 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:16:22,266 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:23,604 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:16:23,605 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 620
2025-11-12 09:16:25,048 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:25,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:49,712 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:16:51,769 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:16:57,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:03,445 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:17:03,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:03,515 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:03,810 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:17:07,213 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:17:07,215 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:17:09,903 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:17:09,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:10,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:12,951 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:17:13,103 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:17:13,170 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:17:13,301 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:17:17,483 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:17:18,488 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:17:18,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:18,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:30,242 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:17:33,757 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:17:33,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:33,834 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:33,834 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:17:33,900 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:17:35,084 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:17:35,306 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:17:36,739 - ispa_next.functions - DEBUG - Updated appointment (AL00012822) customer contact data.
2025-11-12 09:17:37,642 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:17:37,645 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:17:38,532 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:17:38,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:17:39,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:17:43,270 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:17:43,270 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:17:43,270 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:17:43,272 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:17:43,276 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:17:43,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:43,759 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:44,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:44,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:44,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:45,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:45,349 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:17:50,615 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:17:50,627 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:17:51,757 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:17:51,757 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:17:51,759 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:17:51,761 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:17:51,761 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:17:51,763 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:17:51,763 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:17:51,765 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:17:51,766 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:17:51,767 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:17:51,771 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:17:51,773 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:17:51,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:57,900 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:17:57,903 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:17:57,905 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:17:57,909 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:17:57,913 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:17:57,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:03,912 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:18:03,914 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:18:03,916 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:18:03,916 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:04,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:18:05,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:18:05,541 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:18:07,192 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:18:14,542 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:18:14,917 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:18:15,646 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:18,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:18:18,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:21,491 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 619
2025-11-12 09:18:21,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:22,375 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:18:22,383 - ispa_next.main - DEBUG - 



2025-11-12 09:18:22,383 - ispa_next.main - DEBUG - starting with process 10 (LÖ-EE 2122) of 16
2025-11-12 09:18:22,388 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:23,744 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:25,130 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:18:25,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 09:18:26,717 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:26,719 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:59,577 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:19:01,260 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:19:06,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:08,524 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:19:08,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:08,651 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:19:08,812 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:19:08,820 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:19:11,721 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:19:11,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:12,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:14,984 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:19:15,126 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:19:15,206 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:19:15,352 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:19:19,545 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:19:20,552 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:19:20,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:21,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:33,237 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:19:37,254 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:19:37,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:37,344 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:19:37,346 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:19:37,391 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:19:38,706 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:19:38,920 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:19:40,532 - ispa_next.functions - DEBUG - Updated appointment (AD00049115) customer contact data.
2025-11-12 09:19:41,449 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:19:41,451 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:19:42,227 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:19:42,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:19:43,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:19:46,676 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:19:46,676 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:19:46,680 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:19:46,684 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:19:46,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:47,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:50,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:51,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:51,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:52,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:52,171 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:19:54,067 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:19:54,069 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:19:55,262 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:19:55,264 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:19:55,266 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:19:55,267 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:19:55,268 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:19:55,271 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:19:55,275 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:19:55,279 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:19:55,280 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:19:55,281 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:19:55,285 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:19:55,288 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:19:55,289 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:57,185 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:19:57,189 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:19:57,192 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:19:57,194 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:19:57,198 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:19:57,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:59,085 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:19:59,088 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:19:59,090 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:19:59,090 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:19:59,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:20:00,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:20:00,636 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:20:02,475 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:20:10,091 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:20:10,489 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:20:10,764 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:13,640 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:20:13,642 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:17,153 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 619
2025-11-12 09:20:17,154 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:18,181 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:20:18,192 - ispa_next.main - DEBUG - 



2025-11-12 09:20:18,193 - ispa_next.main - DEBUG - starting with process 11 (LÖ-H 2406) of 16
2025-11-12 09:20:18,197 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:20:19,513 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:20,675 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:20:20,676 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 619
2025-11-12 09:20:22,082 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:22,082 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:55,679 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:20:57,260 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:21:01,798 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:21:06,511 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:21:06,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:21:06,643 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:21:06,813 - ispa_next.functions - DEBUG - HU date already expired after 2450 days.
2025-11-12 09:21:11,010 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:21:11,012 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:21:13,714 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:21:13,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:21:14,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:21:16,868 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:21:16,967 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:21:17,043 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:21:17,109 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:21:19,262 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:21:20,268 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:21:20,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:21:20,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:21:34,887 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:21:38,371 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:21:38,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:21:38,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:21:38,473 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:21:38,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:21:38,584 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:21:39,581 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:21:40,772 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:21:41,057 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:21:42,695 - ispa_next.functions - DEBUG - Updated appointment (AK00014048) customer contact data.
2025-11-12 09:21:43,969 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:21:43,972 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:21:44,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:21:44,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:21:46,099 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:21:46,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:21:46,168 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:21:50,230 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:21:50,230 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:21:50,236 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:21:50,242 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:21:50,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:21:50,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:21:51,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:21:51,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:21:51,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:21:52,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:21:52,315 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:21:56,542 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:21:56,543 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:22:01,171 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:22:01,174 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:22:01,177 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:22:01,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:22:01,188 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:22:01,191 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:22:01,194 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:22:01,196 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:22:01,198 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:22:01,199 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:22:01,206 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:22:01,208 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:22:01,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:22:05,918 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:22:05,922 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:22:05,926 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:22:05,928 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:22:05,930 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:22:05,932 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:22:10,566 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:22:10,568 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:22:10,570 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:22:10,570 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:11,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:22:12,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:22:12,465 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:22:14,663 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:22:23,077 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:22:23,444 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:22:24,123 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:26,289 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:22:26,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:29,048 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 618
2025-11-12 09:22:29,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:29,885 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:22:29,894 - ispa_next.main - DEBUG - 



2025-11-12 09:22:29,895 - ispa_next.main - DEBUG - starting with process 12 (LÖ-RP 112E) of 16
2025-11-12 09:22:29,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:30,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:31,974 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2228
2025-11-12 09:22:31,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 618
2025-11-12 09:22:33,360 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:33,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:57,143 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:22:59,321 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:23:05,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:09,053 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:23:09,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:09,136 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:09,387 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:23:09,389 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:23:12,387 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:12,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:13,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:15,617 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:23:15,770 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:23:15,888 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:23:15,965 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:23:20,204 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:23:21,221 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:23:21,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:21,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:32,873 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:23:37,764 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:23:37,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:37,842 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:37,842 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:23:37,934 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:23:39,227 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:23:40,391 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:23:40,612 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:23:42,213 - ispa_next.functions - DEBUG - Updated appointment (AA00108103) customer contact data.
2025-11-12 09:23:43,188 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:23:43,192 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:23:44,375 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:23:44,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:23:45,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:23:48,861 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:48,861 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:23:48,865 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:23:48,870 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:23:48,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:49,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:58,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:58,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:58,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:59,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:59,693 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:24:03,266 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:24:03,270 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:24:04,683 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:24:04,685 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:24:04,687 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:24:04,687 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:24:04,689 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:24:04,691 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:24:04,693 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:24:04,695 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:24:04,698 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:24:04,702 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:24:04,721 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:24:04,723 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:08,738 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:24:08,740 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:24:08,743 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:24:08,746 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:24:08,749 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:24:08,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:12,711 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:24:12,714 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:24:12,718 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:24:12,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:24:13,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:24:14,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:24:14,528 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:24:16,230 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:24:24,537 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:24:24,912 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:24:25,504 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:24:28,504 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2229
2025-11-12 09:24:28,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:24:31,672 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 617
2025-11-12 09:24:31,673 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:24:32,605 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:24:32,614 - ispa_next.main - DEBUG - 



2025-11-12 09:24:32,614 - ispa_next.main - DEBUG - starting with process 13 (LÖ-AS 801) of 16
2025-11-12 09:24:32,633 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:24:33,825 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:24:35,267 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2229
2025-11-12 09:24:35,268 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 617
2025-11-12 09:24:37,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:24:37,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:03,621 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:25:05,806 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:25:11,542 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:15,664 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:25:15,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:15,766 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:25:16,016 - ispa_next.functions - DEBUG - HU date already expired after 2554 days.
2025-11-12 09:25:20,333 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:25:20,337 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:25:23,171 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:25:23,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:24,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:26,924 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:25:27,028 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:25:27,147 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:25:27,234 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:25:29,322 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:25:30,328 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:25:30,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:30,846 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:45,048 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:25:48,875 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:25:48,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:48,955 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:25:48,955 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:25:48,997 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:25:50,162 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:25:50,381 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:25:52,107 - ispa_next.functions - DEBUG - Updated appointment (AA00111686) customer contact data.
2025-11-12 09:25:53,031 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:25:53,033 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:25:53,889 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:25:53,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:25:55,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:25:59,282 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:25:59,282 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:25:59,286 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:25:59,290 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:25:59,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:59,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:26:00,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:00,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:00,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:01,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:26:01,380 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:26:05,047 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:26:05,053 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:26:07,262 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:26:07,262 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:26:07,264 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:26:07,264 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:26:07,271 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:26:07,273 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:26:07,276 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:26:07,279 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:26:07,280 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:26:07,282 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:26:07,284 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:26:07,288 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:26:07,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:11,439 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:26:11,441 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:26:11,443 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:26:11,447 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:26:11,449 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:26:11,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:15,384 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:26:15,387 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:26:15,389 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:26:15,391 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:16,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:26:16,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:26:16,994 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:26:18,973 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:26:27,288 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:26:27,664 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:26:28,289 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:30,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2229
2025-11-12 09:26:30,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:33,224 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 617
2025-11-12 09:26:33,225 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:34,190 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:26:34,198 - ispa_next.main - DEBUG - 



2025-11-12 09:26:34,198 - ispa_next.main - DEBUG - starting with process 14 (WT-GR 460) of 16
2025-11-12 09:26:34,203 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:35,465 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:36,780 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2229
2025-11-12 09:26:36,782 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 617
2025-11-12 09:26:38,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:38,341 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:02,320 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:27:03,744 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:27:08,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:11,926 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:27:11,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:12,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:27:12,258 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:27:12,261 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:27:14,994 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:27:14,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:16,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:27:18,097 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:27:18,251 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:27:18,354 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:27:18,421 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:27:18,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:21,808 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:27:30,973 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:27:31,978 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:27:31,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:32,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:45,594 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:27:50,399 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:27:50,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:50,485 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:27:50,485 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:27:50,528 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:27:51,767 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:27:52,951 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:27:53,164 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:27:54,928 - ispa_next.functions - DEBUG - Updated appointment (AE00033621) customer contact data.
2025-11-12 09:27:55,954 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:27:55,957 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:27:57,189 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:27:57,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:27:58,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:28:02,127 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:28:02,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:02,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:04,627 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:28:04,727 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:28:04,798 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:28:04,909 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:28:04,911 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:08,339 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:28:16,819 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:29:16,821 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:29:25,752 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:30:02,755 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:30:11,298 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:30:19,010 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:30:20,020 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:30:20,026 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:30:20,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:20,115 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:30:25,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:26,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:26,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:26,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:26,783 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:30:29,890 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:30:29,894 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:30:30,866 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:30:30,868 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:30,870 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:30:30,872 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:30,873 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:30:30,875 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:30:30,875 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:30:30,877 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:30:30,877 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:30:30,879 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:30:30,883 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:30:30,884 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:30:30,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:34,248 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:30:34,252 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:30:34,254 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:30:34,258 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:30:34,260 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:30:34,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:37,470 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:30:37,472 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:30:37,474 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:30:37,474 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:38,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:30:38,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:30:38,764 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:30:40,380 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:30:48,506 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:30:48,909 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:30:49,292 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:51,621 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:30:51,621 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:54,247 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 618
2025-11-12 09:30:54,248 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:54,969 - ispa_next.appointments.models - DEBUG - Appointment Michael Liebetanz BS 87278 WBA3K51020K306699 ohne Termin.
2025-11-12 09:30:54,979 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:30:54,987 - ispa_next.main - DEBUG - 



2025-11-12 09:30:54,987 - ispa_next.main - DEBUG - starting with process 15 (BS 14468) of 16
2025-11-12 09:30:54,995 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:56,078 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:57,404 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:30:57,405 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 618
2025-11-12 09:30:58,959 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:58,961 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:35,864 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:31:37,556 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:31:42,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:45,962 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:31:45,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:46,044 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:31:46,254 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:31:50,515 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:31:50,519 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:31:53,321 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:31:53,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:54,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:56,506 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:31:56,607 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:31:56,715 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:31:56,774 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:31:56,775 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:00,128 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:32:08,406 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:32:09,410 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:32:09,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:09,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:23,034 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:32:26,413 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:32:26,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:26,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:26,492 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:32:26,535 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:32:26,694 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:32:28,168 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:32:28,379 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:32:30,070 - ispa_next.functions - DEBUG - Updated appointment (AE00033697) customer contact data.
2025-11-12 09:32:30,993 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:32:30,997 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:32:31,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:32:32,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:32:33,268 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:32:33,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:32:33,352 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:32:37,458 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:32:37,458 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:32:37,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:32:37,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:32:39,971 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:32:40,143 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:32:40,262 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:32:40,336 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:32:40,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:43,684 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:32:52,697 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:33:52,700 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:34:04,270 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 09:34:09,189 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:34:09,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:12,652 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:34:16,852 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:34:17,860 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:34:17,866 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:34:17,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:17,950 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:34:18,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:18,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:18,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:19,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:19,677 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:34:22,780 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:34:22,782 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:34:23,895 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:34:23,897 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:34:23,899 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:34:23,901 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:34:23,901 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:34:23,903 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:34:23,905 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:34:23,907 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:34:23,907 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:34:23,909 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:34:23,911 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:34:23,915 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:34:23,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:27,169 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:34:27,171 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:34:27,175 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:34:27,183 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:34:27,186 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:34:27,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:30,441 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:34:30,443 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:34:30,447 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:34:30,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:34:31,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:34:32,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:34:32,274 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:34:34,247 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:34:43,522 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:34:43,907 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 09:34:44,564 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:46,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:34:46,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:49,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 618
2025-11-12 09:34:49,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:50,259 - ispa_next.appointments.models - DEBUG - Appointment Michael Liebetanz BS 87278 WBA3K51020K306699 ohne Termin.
2025-11-12 09:34:50,270 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:34:50,278 - ispa_next.main - DEBUG - 



2025-11-12 09:34:50,278 - ispa_next.main - DEBUG - starting with process 16 (LÖ-DO 6666) of 16
2025-11-12 09:34:50,282 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:34:51,622 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:52,895 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:34:52,896 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 618
2025-11-12 09:34:54,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:54,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:35:28,956 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:35:31,008 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:35:35,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:40,166 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:35:40,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:40,244 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:35:40,461 - ispa_next.functions - DEBUG - HU date already expired after 3248 days.
2025-11-12 09:35:44,673 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:35:44,677 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:35:47,398 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:35:47,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:48,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:50,581 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:35:50,698 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:35:50,823 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:35:50,896 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:35:50,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:55,720 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:36:04,290 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:36:05,314 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:36:05,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:05,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:18,695 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:36:22,430 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:36:22,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:22,506 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:36:22,506 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:36:22,537 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:36:22,678 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:36:23,853 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:36:24,970 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:36:25,296 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:36:27,133 - ispa_next.functions - DEBUG - Updated appointment (AC00064971) customer contact data.
2025-11-12 09:36:28,099 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:36:28,102 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:36:28,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:36:29,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:36:30,277 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:36:30,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:36:30,360 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:36:34,440 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:36:34,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:34,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:36,934 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:36:37,046 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:36:37,137 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:36:37,198 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:36:37,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:42,059 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:36:50,757 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:37:50,761 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:37:59,819 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:38:29,822 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:38:38,904 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:38:46,862 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:38:47,869 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:38:47,871 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:38:47,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:47,956 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:38:48,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:48,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:48,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:49,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:49,653 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:38:53,868 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:38:53,868 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:38:54,912 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:38:54,914 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:54,914 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:38:54,916 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:54,919 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:38:54,920 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:38:54,921 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:38:54,925 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:38:54,928 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:38:54,931 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:38:54,935 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:38:54,937 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:38:54,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:59,571 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:38:59,574 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:38:59,576 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:38:59,578 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:38:59,584 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:38:59,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:04,231 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:39:04,235 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:39:04,238 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:39:04,239 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:05,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:05,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:39:05,992 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:39:08,018 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:39:16,170 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:39:16,561 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 09:39:17,278 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:19,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:39:19,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:22,676 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 618
2025-11-12 09:39:22,677 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:23,632 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
2025-11-12 09:39:23,640 - ispa_next.main - DEBUG - Found new Appointment: BS 87278
2025-11-12 09:39:23,641 - ispa_next.main - DEBUG - 



2025-11-12 09:39:23,641 - ispa_next.main - DEBUG - starting with process 17 (BS 87278) of 17
2025-11-12 09:39:23,646 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:25,021 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:26,278 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:39:26,279 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 618
2025-11-12 09:39:27,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:27,926 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:57,337 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:40:06,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:08,836 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:40:08,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:08,914 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:09,141 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:40:16,051 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:40:16,055 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:40:18,820 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:18,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:19,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:21,832 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:40:21,916 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:40:25,150 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:40:25,247 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:40:29,441 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:40:30,447 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:40:30,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:30,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:39,835 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:40:46,838 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:40:46,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:46,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:46,917 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:40:46,956 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:40:47,092 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:40:48,257 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:40:48,471 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:40:51,158 - ispa_next.functions - DEBUG - Updated appointment (AB00091551) customer contact data.
2025-11-12 09:40:52,160 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:40:52,162 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:40:52,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:53,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:40:54,840 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:40:55,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:55,350 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:40:59,821 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:59,821 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:40:59,972 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:40:59,977 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:40:59,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:00,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:01,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:01,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:01,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:02,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:02,562 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:41:05,686 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:41:05,688 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:41:06,579 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:41:06,589 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:06,591 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-12 09:41:06,593 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:06,595 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:41:06,597 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:41:06,599 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:41:06,601 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:41:06,603 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:41:06,607 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:41:06,625 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:41:07,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:41:08,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:41:15,635 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:41:15,638 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:41:15,641 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:41:15,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:18,887 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:41:18,892 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:41:18,895 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:41:18,897 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:41:18,900 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:41:18,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:22,162 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:41:22,165 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:41:22,167 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:41:22,167 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:41:23,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:41:23,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:41:23,747 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:41:25,743 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:41:34,248 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:41:34,623 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 09:41:35,470 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:41:37,431 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2230
2025-11-12 09:41:37,432 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:41:40,833 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 618
2025-11-12 09:41:40,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:41:41,748 - ispa_next.appointments.models - DEBUG - Appointment Therese Grolimund BL 7046 WBAPY51030C318645 ohne Termin.
