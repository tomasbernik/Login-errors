2025-11-17 11:00:36,621 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:00:36,627 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:00:49,824 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:01:01,478 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:01:16,963 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:01:41,005 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:01:52,315 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:01:54,832 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:56,038 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 11:01:56,039 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 11:01:58,507 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 11:01:58,507 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:01:58,508 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:01:59,493 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:02:00,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:02:26,793 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 11:02:26,801 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 11:02:26,812 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 11:02:26,823 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 11:02:26,833 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 11:02:26,843 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 11:02:26,854 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 11:02:26,862 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 11:02:26,874 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 11:02:26,900 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 11:02:26,909 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 11:02:26,922 - ispa_next.appointments.models - DEBUG - Appointment Anastasia Huwald KLE-A 1413 WBA1V710805N01313 ohne Termin.
2025-11-17 11:02:26,933 - ispa_next.appointments.models - DEBUG - Appointment Samir Mougawaz KLE-JS 813 WBA2D710105C40715 ohne Termin.
2025-11-17 11:02:26,950 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:02:26,980 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-17 11:02:26,991 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-17 11:02:27,008 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-17 11:02:27,018 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-17 11:02:27,020 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:02:27,023 - ispa_next.main - DEBUG - Found 2 out of 9 appointments to process (configured limit: 15).
2025-11-17 11:02:27,023 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-17 11:02:27,023 - ispa_next.main - DEBUG - All appointments: M-D-3722, KK-B 602
2025-11-17 11:02:27,025 - ispa_next.main - DEBUG - 



2025-11-17 11:02:27,025 - ispa_next.main - DEBUG - starting with process 1 (M-D-3722) of 2
2025-11-17 11:02:27,030 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:02:28,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:02:29,420 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 11:02:29,420 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 11:02:30,843 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:02:30,844 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:08,158 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:03:16,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:21,417 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:03:21,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:21,502 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:21,694 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:03:21,696 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:03:21,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:21,791 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:24,765 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:03:24,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:03:25,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:03:27,789 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:03:27,917 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:03:28,019 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:03:28,094 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:03:28,094 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:03:39,204 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:03:40,210 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:03:40,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:40,716 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:54,881 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:04:02,548 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:04:02,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:02,634 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:02,634 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:04:02,680 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:04:03,877 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:04:04,928 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:04:05,128 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:04:06,849 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:04:06,849 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:04:07,542 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:04:07,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:04:08,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:04:11,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:04:11,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:12,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:14,334 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:04:14,433 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:04:14,541 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:04:14,604 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:04:14,604 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:04:26,378 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:04:33,406 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:04:33,406 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:04:35,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:04:36,547 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:04:36,550 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:04:36,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:36,618 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:04:42,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:42,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:42,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:43,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:43,309 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:04:47,405 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:04:47,407 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:04:48,402 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:04:48,404 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:48,408 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 11:04:48,408 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:48,412 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:04:48,412 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:04:48,414 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:04:48,417 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:04:48,421 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:04:48,426 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:04:48,429 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:04:49,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:04:49,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:04:56,570 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:04:56,571 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:04:56,572 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:04:56,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:01,872 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:05:01,872 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:05:01,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:07,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:05:07,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:05:16,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:31,097 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:05:31,098 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:05:31,099 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:05:31,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:36,426 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 11:05:45,301 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:05:56,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:05:57,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:57,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:05:58,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:07,704 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:06:14,010 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:06:14,010 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:06:14,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:06:14,826 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:06:14,827 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:06:18,209 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:06:22,424 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:06:25,712 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:06:25,716 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:06:26,240 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 11:06:26,242 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:06:29,154 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 11:06:29,155 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:06:29,987 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 11:06:29,994 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 11:06:30,000 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 11:06:30,007 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 11:06:30,013 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 11:06:30,019 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 11:06:30,026 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 11:06:30,033 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 11:06:30,039 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 11:06:30,048 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 11:06:30,052 - ispa_next.main - DEBUG - 



2025-11-17 11:06:30,052 - ispa_next.main - DEBUG - starting with process 2 (KK-B 602) of 2
2025-11-17 11:06:30,055 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:06:31,206 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:06:32,459 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 320
2025-11-17 11:06:32,461 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 11:06:33,941 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:06:33,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:00,444 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:07:13,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:22,338 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:07:22,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:22,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:22,688 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:07:22,690 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:07:22,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:22,789 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:25,743 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:07:25,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:26,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:28,751 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:07:28,980 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:07:29,082 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:07:29,154 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:07:29,154 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:07:40,263 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:07:41,276 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:07:41,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:41,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:54,200 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:08:02,328 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:08:02,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:02,411 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:02,413 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:08:02,446 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:08:03,687 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:08:04,884 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:08:05,138 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:08:08,330 - ispa_next.functions - DEBUG - Updated appointment (AA00073898) customer contact data.
2025-11-17 11:08:09,249 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:08:09,251 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:08:10,372 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:08:10,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:08:11,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:08:14,699 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:08:14,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:15,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:08:17,147 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:08:17,240 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:08:17,370 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:08:17,448 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:08:17,448 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:08:28,220 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:08:35,407 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:08:35,407 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:08:39,639 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:08:40,652 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:08:40,656 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:08:40,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:40,758 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:08:46,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:46,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:46,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:47,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:08:47,519 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:08:55,147 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:08:55,149 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:08:56,174 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:08:56,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:08:56,180 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 11:08:56,182 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:08:56,184 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:08:56,186 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:08:56,186 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:08:56,190 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:08:56,190 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:08:56,193 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:08:56,193 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:08:56,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:08:57,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:09:04,380 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:09:04,382 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:09:04,382 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:09:04,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:13,762 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:09:13,762 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:09:13,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:23,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:23,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:09:41,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:03,513 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:10:03,517 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:10:03,521 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:10:03,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:17,511 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 11:10:26,655 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:10:39,638 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:10:40,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:40,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:10:41,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:51,952 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:10:51,952 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 11:10:54,232 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:10:54,233 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 11:10:57,611 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:10:57,611 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 11:11:02,928 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:11:02,928 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 11:11:13,368 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:11:13,368 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 11:11:31,083 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 11:11:32,125 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 11:11:32,221 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:11:32,221 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:11:32,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:32,855 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:11:32,857 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:11:32,881 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:11:36,455 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:11:36,457 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:11:36,940 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 322
2025-11-17 11:11:36,942 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:11:40,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 214
2025-11-17 11:11:40,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:11:40,924 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hindrichs MO-FH 714 WBAJP31060BT92743 ohne Termin.
2025-11-17 11:11:40,931 - ispa_next.appointments.models - DEBUG - Appointment Rainer Nellessen GEL-C 308 WMW21BR0603P29202 ohne Termin.
2025-11-17 11:11:40,938 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 11:11:40,944 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 11:11:40,949 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 11:11:40,955 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 11:11:40,961 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 11:11:40,966 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 11:11:40,971 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 11:11:40,978 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
