2025-11-12 12:04:06,766 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:04:06,774 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:04:18,233 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:04:31,489 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:04:47,254 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:05:11,818 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:05:26,286 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:05:30,195 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:05:31,784 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1214
2025-11-12 12:05:31,785 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 270
2025-11-12 12:05:34,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 125
2025-11-12 12:05:34,865 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:05:34,866 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:05:36,224 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:05:37,682 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:06:02,571 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:06:02,587 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:06:02,616 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 12:06:02,626 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 12:06:02,644 - ispa_next.appointments.models - DEBUG - Appointment Michaela Sophie Lapschanski RP-RL 3000 WBAJP31020BT75745 ohne Termin.
2025-11-12 12:06:02,653 - ispa_next.appointments.models - DEBUG - Appointment Gamze Fatma Altiparmak HD-XX 918 WMWXR91010TP82490 ohne Termin.
2025-11-12 12:06:02,667 - ispa_next.appointments.models - DEBUG - Appointment Damian Dexler SP-DD 71 WBA2M510X0VF33341 ohne Termin.
2025-11-12 12:06:02,681 - ispa_next.appointments.models - DEBUG - Appointment DS Automobile  WBAVJ51020LP62546 ohne Termin.
2025-11-12 12:06:02,704 - ispa_next.appointments.models - DEBUG - Appointment Erich Simus SP-B 26 WBAJM71050G959849 ohne Termin.
2025-11-12 12:06:02,720 - ispa_next.appointments.models - DEBUG - Appointment Besnik Derguti HD-ND 220 5UXCR6C51KLK82954 ohne Termin.
2025-11-12 12:06:02,761 - ispa_next.appointments.models - DEBUG - Appointment Christine Zimmermann KA-E 1152 WBAUZ35060N035577 ohne Termin.
2025-11-12 12:06:02,773 - ispa_next.appointments.models - DEBUG - Appointment Christine Eichenlaub  WMW11DJ0002V69245 ohne Termin.
2025-11-12 12:06:02,781 - ispa_next.appointments.models - DEBUG - Appointment Schick Vermietung GmbH SP-SV 140 WBA11GW010CS52823 ohne Termin.
2025-11-12 12:06:02,790 - ispa_next.appointments.models - DEBUG - Appointment Nico Hellmann GER-NH 28 WBA7K310807F44939 ohne Termin.
2025-11-12 12:06:02,798 - ispa_next.appointments.models - DEBUG - Appointment Präg Günter GmbH MA-PR 705 WBS11ET0709V00834 ohne Termin.
2025-11-12 12:06:02,806 - ispa_next.appointments.models - DEBUG - Appointment Oliver Menrath RP-OM 55 WBADW51020E364111 ohne Termin.
2025-11-12 12:06:02,814 - ispa_next.appointments.models - DEBUG - Appointment Felix Dominik Hipper DÜW-FE 92 WBSKG91030E854306 ohne Termin.
2025-11-12 12:06:02,823 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Lindner HD-IL 1052 WBAUR31050VL42406 ohne Termin.
2025-11-12 12:06:02,831 - ispa_next.appointments.models - DEBUG - Appointment Martin Zitron SP-ZM 71 WBAUN71070VM20560 ohne Termin.
2025-11-12 12:06:02,840 - ispa_next.appointments.models - DEBUG - Appointment Michael Groel SP-MG 59 WBAVM91000VT71883 ohne Termin.
2025-11-12 12:06:02,858 - ispa_next.main - DEBUG - Found 15 out of 43 appointments to process (configured limit: 15).
2025-11-12 12:06:02,858 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-12 12:06:02,859 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 12:06:02,859 - ispa_next.main - DEBUG - All appointments: GER-C 530E, NW-G 6363, HN-TB 2163, LU EK 32, KA-HG 4600, RP-PL 200, LU II 63, RP-RS 400, SP-CC 123, HD-VM 262, RP-PL 400, LU-GT 232, SP-BK 80, KA-S 9140, GER-HD 777
2025-11-12 12:06:02,862 - ispa_next.main - DEBUG - 



2025-11-12 12:06:02,862 - ispa_next.main - DEBUG - starting with process 1 (GER-C 530E) of 15
2025-11-12 12:06:02,865 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:06:04,234 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:06:05,633 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1214
2025-11-12 12:06:05,634 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 125
2025-11-12 12:06:07,498 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:06:07,499 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:06:41,408 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:06:54,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:54,448 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:54,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:06:56,796 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:06:56,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:57,013 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:57,300 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:07:05,822 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:07:05,826 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:07:08,694 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:07:08,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:10,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:07:12,031 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:07:12,246 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:07:15,477 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:07:25,746 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 12:07:26,751 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:07:26,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:27,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:41,683 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:07:51,181 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:07:51,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:07:51,354 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:07:51,355 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:07:51,438 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:07:52,876 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:07:53,317 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:07:57,142 - ispa_next.functions - DEBUG - Updated appointment (AC00031382) customer contact data.
2025-11-12 12:07:58,033 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:07:58,036 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:07:59,135 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:07:59,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:07:59,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:08:03,999 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:08:04,000 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:08:04,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:08:04,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:08:06,599 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:08:06,755 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:08:06,911 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:08:07,057 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:08:07,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:08,359 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:08:17,164 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:09:17,167 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:09:28,865 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:09:33,859 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:09:33,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:09:35,874 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:09:40,142 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:09:41,149 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:09:41,150 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:09:41,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:09:41,260 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:09:45,388 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:09:45,392 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:09:45,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:09:45,474 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:09:49,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:09:49,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:09:49,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:09:50,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:09:50,672 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:09:52,628 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:09:52,630 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:09:53,821 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:09:53,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:09:53,826 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 12:09:53,827 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:09:53,828 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 12:09:53,829 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:09:53,832 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 12:09:53,833 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 12:09:53,834 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:09:53,837 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:09:53,838 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:09:53,841 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:09:53,843 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:09:54,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:09:55,409 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:10:01,530 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:10:01,531 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 12:10:03,913 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:10:04,456 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:10:05,385 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:10:05,988 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:10:06,526 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:10:08,122 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:10:08,714 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:10:09,250 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:10:10,165 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:10:11,315 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:10:12,292 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:10:12,883 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:10:12,887 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:10:12,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:10:14,790 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:10:14,793 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:10:14,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:10:16,781 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:10:16,782 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:10:16,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:10:17,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:10:17,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:10:27,193 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:10:27,195 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:10:41,310 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:10:41,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:10:42,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:10:42,895 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:01,905 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:11:07,428 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:11:07,432 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:11:07,433 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:11:08,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:11:08,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:11:08,439 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:11:10,882 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:11:24,020 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:11:24,444 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:11:25,399 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:11:28,279 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1215
2025-11-12 12:11:28,280 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:11:31,659 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 270
2025-11-12 12:11:31,660 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:11:32,807 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:11:32,821 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:11:32,834 - ispa_next.main - DEBUG - 



2025-11-12 12:11:32,834 - ispa_next.main - DEBUG - starting with process 2 (NW-G 6363) of 15
2025-11-12 12:11:32,838 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:11:34,240 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:11:35,898 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1215
2025-11-12 12:11:35,899 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 270
2025-11-12 12:11:38,024 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:11:38,025 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:12:21,758 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:12:33,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:38,803 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:12:38,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:12:38,908 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:12:39,129 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:12:39,132 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:12:42,064 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:12:42,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:12:43,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:12:45,461 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:12:45,600 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:12:48,820 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:12:48,900 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:12:48,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:54,529 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:13:03,976 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:13:04,981 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:13:04,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:05,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:18,250 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:13:18,250 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:13:27,813 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:13:27,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:27,953 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:13:27,954 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:13:28,051 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:13:28,278 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:13:29,787 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:13:30,202 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:13:33,164 - ispa_next.functions - DEBUG - Updated appointment (AC00031383) customer contact data.
2025-11-12 12:13:34,049 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:13:34,051 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:13:34,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:13:34,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:13:36,755 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:13:36,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:13:36,886 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:13:40,637 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:13:40,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:13:41,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:13:43,119 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:13:43,273 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:13:43,396 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:13:43,477 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:13:43,478 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:13:49,178 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:14:00,014 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:14:07,018 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:14:07,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:14,609 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 12:14:17,093 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:14:19,554 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:14:20,560 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:14:20,561 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:14:20,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:14:20,687 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:14:24,828 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:14:25,877 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:14:48,249 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:14:48,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:14:48,428 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:14:59,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:59,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:14:59,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:15:01,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:15:01,117 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:15:06,186 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:15:06,188 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:15:09,016 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:15:09,018 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:15:09,021 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 12:15:09,023 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:15:09,024 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 12:15:09,025 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:15:09,028 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:15:09,030 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-12 12:15:09,031 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:15:09,034 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:15:09,036 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:15:09,039 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:15:09,042 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:15:09,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:15:11,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:15:18,533 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:15:18,534 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:15:19,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:15:19,528 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-12 12:15:28,314 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:15:28,317 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:15:28,320 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:15:28,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:34,604 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:15:34,606 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:15:34,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:40,874 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:15:40,877 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:15:40,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:15:41,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:15:42,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:16:01,856 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:16:01,859 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:16:25,814 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:16:26,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:16:27,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:16:27,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:14,994 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:17:14,995 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:17:16,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:17:16,884 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:17:16,885 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:17:26,664 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:17:47,309 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:17:47,722 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:17:52,665 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:17:55,834 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1217
2025-11-12 12:17:55,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:02,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 271
2025-11-12 12:18:02,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:04,437 - ispa_next.appointments.models - DEBUG - Appointment Fahrschule Semar SÜW-SE 111 WBA31AM0407P87288 ohne Termin.
2025-11-12 12:18:04,448 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:18:04,462 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:18:04,471 - ispa_next.main - DEBUG - 



2025-11-12 12:18:04,472 - ispa_next.main - DEBUG - starting with process 3 (HN-TB 2163) of 15
2025-11-12 12:18:04,476 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:07,148 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:10,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1217
2025-11-12 12:18:10,037 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 271
2025-11-12 12:18:13,659 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:13,661 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:04,457 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:19:26,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:30,852 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:19:30,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:31,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:31,499 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:19:31,502 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:19:35,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:35,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:36,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:38,873 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:19:39,166 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:19:39,393 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:19:39,664 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:19:44,008 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:19:45,013 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:19:45,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:45,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:05,997 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:20:20,869 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:20:20,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:21,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:20:21,028 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:20:21,194 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:20:22,851 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:20:23,212 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:20:27,762 - ispa_next.functions - DEBUG - Updated appointment (AC00031325) customer contact data.
2025-11-12 12:20:28,961 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:20:28,963 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:20:31,114 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:20:31,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:20:32,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:20:37,336 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:20:37,336 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:20:37,431 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:20:37,479 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:20:37,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:38,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:42,524 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:20:44,296 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:21:00,065 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:21:00,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:21:00,222 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:21:00,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:01,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:01,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:21:02,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:21:02,511 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:21:07,581 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:21:07,604 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:21:09,488 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:21:09,490 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:21:09,493 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 12:21:09,494 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:21:09,496 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 12:21:09,497 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:21:09,500 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:21:09,501 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-12 12:21:09,503 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:21:09,506 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:21:09,508 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:21:09,511 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:21:09,513 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:21:10,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:21:11,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:21:18,971 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:21:18,973 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:21:19,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:21:19,894 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-12 12:21:28,755 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:21:28,757 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:21:28,759 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:21:28,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:34,357 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:21:34,359 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:21:34,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:40,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:21:40,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:21:54,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:14,157 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:22:14,159 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:22:14,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:22:15,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:22:15,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:29,299 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:22:29,302 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:22:53,507 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:22:54,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:22:54,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:22:55,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:52,408 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:01,224 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:10,326 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:20,816 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:30,454 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:39,008 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:48,428 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:48,430 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:24:48,431 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:24:50,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:24:50,306 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:24:50,308 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:24:56,070 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:25:17,879 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:25:18,404 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:25:23,223 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:24,765 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1218
2025-11-12 12:25:24,767 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:31,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 272
2025-11-12 12:25:31,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:25:33,653 - ispa_next.appointments.models - DEBUG - Appointment Fahrschule Semar SÜW-SE 211 WBA71BX0107N85897 ohne Termin.
2025-11-12 12:25:33,662 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:25:33,673 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:25:33,679 - ispa_next.main - DEBUG - Found new Appointment: SÜW-SE 111
2025-11-12 12:25:33,681 - ispa_next.main - DEBUG - 



2025-11-12 12:25:33,681 - ispa_next.main - DEBUG - starting with process 4 (SÜW-SE 111) of 16
2025-11-12 12:25:33,685 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:36,382 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:39,444 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1218
2025-11-12 12:25:39,446 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 272
2025-11-12 12:25:42,850 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:42,852 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:32,164 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:26:53,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:58,450 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:26:58,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:58,608 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:26:59,047 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:26:59,051 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:27:02,622 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:02,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:04,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:06,593 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:27:06,795 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:27:10,205 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:27:10,375 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:27:14,712 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:27:15,721 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:27:15,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:16,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:36,677 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:27:51,804 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:27:51,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:51,964 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:27:51,965 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:27:52,191 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:27:53,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:27:55,315 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:27:55,676 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:28:00,691 - ispa_next.functions - DEBUG - Updated appointment (AC00031387) customer contact data.
2025-11-12 12:28:01,819 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:28:01,837 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:28:03,880 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:28:03,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:28:05,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:28:09,609 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:28:09,609 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:28:09,609 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:28:09,612 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:28:09,613 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:28:09,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:10,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:14,491 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:28:16,367 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:28:32,683 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:28:32,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:32,860 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:28:41,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:42,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:42,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:43,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:43,448 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:28:48,004 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:28:48,008 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:28:50,034 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:28:50,037 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:28:50,042 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:28:50,045 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart), Package(name=Bremsscheiben vorn auf min. Stärke prüfe, source=from_tab, target=cart)}
2025-11-12 12:28:50,046 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:28:50,050 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:28:50,052 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-12 12:28:50,053 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:28:50,056 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:28:50,057 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:28:50,060 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:28:50,063 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:28:51,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:28:52,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:29:08,571 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:29:08,572 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:29:09,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:29:09,456 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-12 12:29:17,887 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:29:17,889 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:29:17,891 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:29:17,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:24,229 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:29:24,231 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:29:24,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:30,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:29:31,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:29:42,595 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:29:42,597 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:29:42,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:29:44,163 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:29:44,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:08,597 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:30:08,600 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:30:33,582 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:30:34,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:30:35,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:30:35,470 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:39,323 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:31:49,830 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:31:59,102 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:08,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:17,542 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:29,297 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:38,466 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:47,834 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:32:47,836 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:32:47,837 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:32:49,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:32:49,830 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:32:49,831 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:32:54,645 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:33:15,666 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:33:16,107 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:33:20,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:22,642 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1218
2025-11-12 12:33:22,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:33:29,831 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 272
2025-11-12 12:33:29,832 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:33:31,603 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:33:31,617 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:33:31,623 - ispa_next.main - DEBUG - Found new Appointment: SÜW-SE 211
2025-11-12 12:33:31,625 - ispa_next.main - DEBUG - 



2025-11-12 12:33:31,625 - ispa_next.main - DEBUG - starting with process 5 (SÜW-SE 211) of 17
2025-11-12 12:33:31,628 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:33:34,468 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:37,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1218
2025-11-12 12:33:37,628 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 272
2025-11-12 12:33:41,228 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:33:41,230 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:17,192 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:34:35,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:34:35,423 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:34:35,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:38,006 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:34:38,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:34:38,169 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:34:38,652 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:34:38,656 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:34:42,169 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:34:42,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:34:44,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:34:46,719 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:34:46,931 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:34:50,745 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:35:08,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 12:35:09,874 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:35:09,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:10,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:31,085 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:35:46,042 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:35:46,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:46,183 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:46,184 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:35:46,299 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:35:46,525 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:35:48,335 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:35:48,672 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:35:52,762 - ispa_next.functions - DEBUG - Updated appointment (AC00031389) customer contact data.
2025-11-12 12:35:53,927 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:35:54,020 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:35:54,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:35:55,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:35:58,195 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:35:58,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:35:58,481 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:36:02,149 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:36:02,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:02,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:04,693 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:36:04,915 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:36:05,202 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:36:05,334 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:36:05,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:07,543 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:36:18,084 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:37:18,088 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:37:29,592 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:37:37,921 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:37:37,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:40,031 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:37:44,341 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:37:45,349 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:37:45,350 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:37:45,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:37:45,488 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:37:49,748 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:37:51,657 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:38:08,122 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:38:08,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:38:08,260 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:38:17,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:18,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:38:18,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:38:19,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:38:19,625 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:38:21,795 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:38:21,797 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:38:24,253 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:38:24,256 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:38:24,260 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 12:38:24,264 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:38:24,266 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 12:38:24,267 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:38:24,271 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:38:24,273 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-12 12:38:24,274 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:38:24,277 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:38:24,278 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:38:24,281 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:38:24,283 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:38:25,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:38:26,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:38:34,092 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:38:34,093 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:38:34,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:38:35,089 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-12 12:38:44,296 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:38:44,298 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:38:44,300 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:38:44,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:38:47,059 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:38:47,061 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:38:47,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:38:49,792 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:38:49,796 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:38:49,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:38:50,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:38:51,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:03,211 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:39:03,214 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:39:27,941 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:39:28,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:29,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:39:29,824 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:59,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:40:08,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:40:18,071 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:40:18,073 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:40:18,074 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:19,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:40:19,872 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:40:19,874 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:40:24,604 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:40:44,782 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:40:45,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:40:47,563 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:51,312 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1219
2025-11-12 12:40:51,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:58,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 272
2025-11-12 12:40:58,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:00,236 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:41:00,246 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:41:00,253 - ispa_next.main - DEBUG - 



2025-11-12 12:41:00,253 - ispa_next.main - DEBUG - starting with process 6 (LU EK 32) of 17
2025-11-12 12:41:00,257 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:41:02,994 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:06,087 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1219
2025-11-12 12:41:06,089 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 272
2025-11-12 12:41:09,816 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:09,818 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:50,509 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:42:08,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:13,050 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:42:13,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:42:13,210 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:42:13,754 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:42:13,759 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:42:17,145 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:42:17,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:42:19,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:42:21,307 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:42:21,511 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:42:24,867 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:42:41,067 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 12:42:42,074 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:42:42,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:42:42,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:00,131 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:43:15,470 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:43:15,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:15,611 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:43:15,612 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:43:15,699 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:43:17,329 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:43:17,704 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:43:21,725 - ispa_next.functions - DEBUG - Updated appointment (AA00040762) customer contact data.
2025-11-12 12:43:22,880 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:43:22,895 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:43:24,983 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:43:24,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:43:26,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:43:30,119 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:43:30,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:43:30,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:43:32,664 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:43:32,914 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:43:33,184 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:43:33,323 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:43:33,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:43:37,658 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:43:48,872 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:44:48,875 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:45:00,245 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:45:09,054 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:45:09,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:13,292 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:45:15,535 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:45:16,544 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:45:16,548 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:45:16,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:16,711 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:45:20,971 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:45:22,928 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:45:40,378 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:45:40,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:40,548 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:45:44,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:44,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:44,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:45,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:45,989 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:45:50,205 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:45:50,208 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:45:52,277 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:45:52,281 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:52,285 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 12:45:52,286 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:45:52,287 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 12:45:52,289 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:52,292 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:45:52,294 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-12 12:45:52,296 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:45:52,299 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:45:52,300 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:45:52,304 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:45:52,306 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:45:53,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:45:54,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:46:02,487 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:46:02,488 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:46:03,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:46:03,461 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-12 12:46:12,467 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:46:12,489 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:46:12,492 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:46:12,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:17,531 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:46:17,534 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:46:17,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:22,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:23,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:34,403 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:46:34,405 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:46:34,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:46:35,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:46:36,314 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:55,941 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:46:55,944 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:47:20,987 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:47:21,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:47:22,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:47:22,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:13,056 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:23,142 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:32,908 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:42,104 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:48:52,734 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:02,247 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:02,249 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:49:02,250 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:49:04,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:49:04,243 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:49:04,246 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:49:08,994 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:49:29,827 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:49:30,221 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:49:35,403 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:49:39,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 12:49:39,038 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:49:46,528 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 273
2025-11-12 12:49:46,529 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:49:48,277 - ispa_next.appointments.models - DEBUG - Appointment KS Payment GmbH MA-CO 245 E WBA6N71060FL12532 ohne Termin.
2025-11-12 12:49:48,288 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:49:48,298 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:49:48,305 - ispa_next.main - DEBUG - 



2025-11-12 12:49:48,305 - ispa_next.main - DEBUG - starting with process 7 (KA-HG 4600) of 17
2025-11-12 12:49:48,308 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:49:51,061 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:49:54,847 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 12:49:54,849 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 273
2025-11-12 12:49:58,516 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:49:58,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:50:42,959 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:51:01,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:03,785 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:51:03,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:03,897 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:04,306 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:51:18,065 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:51:18,068 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:51:21,371 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:51:21,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:21,887 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 12:51:22,992 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 12:51:23,013 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:51:23,014 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:51:24,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:51:25,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:51:25,883 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 12:51:25,920 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 12:51:33,840 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:51:33,845 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:51:35,186 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 12:51:35,188 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:51:45,061 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 273
2025-11-12 12:51:45,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:51:47,757 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 12:51:47,774 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 12:51:47,783 - ispa_next.main - DEBUG - Found new Appointment: MA-CO 245 E
2025-11-12 12:51:47,785 - ispa_next.main - DEBUG - 



2025-11-12 12:51:47,786 - ispa_next.main - DEBUG - starting with process 8 (MA-CO 245 E) of 18
2025-11-12 12:51:47,789 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:51:50,512 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:51:53,936 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 12:51:53,938 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 273
2025-11-12 12:51:57,686 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:51:57,688 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:52:48,509 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:53:07,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:53:10,971 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:53:10,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:11,120 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:53:11,674 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:53:25,894 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:53:25,897 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:53:29,185 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:53:29,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:53:31,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:53:33,282 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:53:33,530 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:53:36,942 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:53:52,309 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 12:53:53,314 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:53:53,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:53,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:11,302 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:54:26,980 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:54:26,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:27,089 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:54:27,090 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:54:27,270 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:54:28,878 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:54:30,291 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:54:30,713 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:54:35,295 - ispa_next.functions - DEBUG - Updated appointment (AC00031392) customer contact data.
2025-11-12 12:54:36,426 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:54:36,430 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:54:38,517 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:54:38,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:54:40,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:54:44,312 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:54:44,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:44,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:54:46,895 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:54:47,104 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:54:47,408 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:54:47,563 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:54:47,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:51,210 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:55:01,451 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:55:49,455 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:56:01,494 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:56:08,225 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:56:08,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:56:14,923 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:56:17,135 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:56:18,144 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:56:18,148 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:56:18,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:56:18,399 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:56:22,611 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:56:24,475 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:56:41,799 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:56:41,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:56:41,968 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:56:46,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:56:47,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:56:47,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:56:48,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:56:48,542 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:56:52,492 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:56:52,495 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:56:54,295 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:56:54,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:56:54,302 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 12:56:54,304 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 12:56:54,308 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 12:56:54,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:56:54,315 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 12:56:54,316 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:56:54,319 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:56:54,320 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:56:54,323 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:56:54,326 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:56:55,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:56:56,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:57:04,585 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:57:04,586 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 12:57:08,205 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:08,775 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:57:09,776 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:10,395 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:10,979 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:57:11,916 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:12,544 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:13,108 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:57:14,076 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:14,691 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:15,248 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:57:16,196 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:16,807 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:17,371 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:57:19,530 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:20,149 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:20,700 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 12:57:21,636 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:23,419 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 12:57:24,408 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 12:57:25,649 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:57:25,698 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:57:25,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:57:29,930 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:57:29,933 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:57:29,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:57:34,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:57:35,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:57:45,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:04,918 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:58:04,920 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:58:04,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:58:06,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:58:06,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:26,506 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:58:26,508 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:58:50,775 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:58:51,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:58:52,305 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:58:52,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:37,384 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:59:47,547 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:59:58,716 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:00:07,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:00:17,405 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:00:17,408 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:00:17,409 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:00:19,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:00:19,235 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:00:19,237 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:00:24,053 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:00:44,054 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:00:44,444 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:00:49,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:00:51,184 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 13:00:51,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:00:58,782 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 273
2025-11-12 13:00:58,784 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:01:00,681 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:01:00,691 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:01:00,698 - ispa_next.main - DEBUG - 



2025-11-12 13:01:00,698 - ispa_next.main - DEBUG - starting with process 9 (RP-PL 200) of 18
2025-11-12 13:01:00,702 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:01:03,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:01:06,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 13:01:06,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 273
2025-11-12 13:01:10,375 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:01:10,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:01:55,367 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:02:13,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:02:15,274 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:02:15,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:02:15,429 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:02:15,927 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:02:15,937 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:02:19,334 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:02:19,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:02:19,943 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 13:02:20,442 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 13:02:20,468 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:02:20,469 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:02:22,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:02:23,465 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:02:23,466 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:02:23,509 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:02:28,146 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:02:28,151 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:02:33,249 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 13:02:33,250 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:02:40,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 273
2025-11-12 13:02:40,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:02:42,095 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:02:42,105 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:02:42,112 - ispa_next.main - DEBUG - 



2025-11-12 13:02:42,112 - ispa_next.main - DEBUG - starting with process 10 (LU II 63) of 18
2025-11-12 13:02:42,116 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:02:44,861 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:02:48,023 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 13:02:48,026 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 273
2025-11-12 13:02:51,843 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:02:51,845 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:03:46,403 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:03:46,416 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:03:46,420 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:03:47,861 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 13:03:47,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:03:55,643 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 273
2025-11-12 13:03:55,644 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:03:57,377 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:03:57,390 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:03:57,396 - ispa_next.main - DEBUG - 



2025-11-12 13:03:57,396 - ispa_next.main - DEBUG - starting with process 11 (RP-RS 400) of 18
2025-11-12 13:03:57,401 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:04:00,343 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:04:03,433 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1220
2025-11-12 13:04:03,435 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 273
2025-11-12 13:04:07,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:04:07,224 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:55,152 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:05:00,328 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:05:09,054 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:05:11,085 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:05:11,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:11,252 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:05:11,927 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:05:11,930 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:05:15,281 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:05:15,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:05:17,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:05:19,516 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:05:19,732 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:05:20,046 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:05:20,215 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:05:24,509 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:05:25,514 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:05:25,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:26,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:47,032 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:05:57,237 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:05:57,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:57,408 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:05:57,410 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:05:57,569 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:05:59,090 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:05:59,503 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:06:02,107 - ispa_next.functions - DEBUG - Updated appointment (AD00027363) customer contact data.
2025-11-12 13:06:03,203 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:06:03,208 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:06:05,296 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:06:05,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:06:06,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:06:10,474 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:06:10,474 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:06:10,477 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:06:10,478 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:06:10,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:06:11,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:06:15,356 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:06:15,361 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:06:15,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:06:15,512 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:06:21,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:21,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:21,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:06:23,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:06:23,013 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:06:25,116 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:06:25,118 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:06:26,893 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:06:26,895 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:06:26,900 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:06:26,903 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:06:26,905 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:06:26,906 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:06:26,910 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:06:26,911 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:06:26,913 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:06:26,914 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:06:26,917 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:06:26,918 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:06:26,921 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:06:26,925 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:06:26,928 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:06:26,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:06:29,073 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:06:29,076 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:06:29,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:06:31,493 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:06:31,496 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:06:31,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:06:34,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:06:34,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:06:46,514 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:06:46,517 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:07:09,905 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:07:10,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:07:11,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:07:11,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:07:34,410 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:07:44,170 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:07:44,173 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:07:44,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:07:45,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:07:45,937 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:07:45,938 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:07:50,488 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:08:09,672 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:08:10,127 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:08:11,337 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:08:16,522 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1221
2025-11-12 13:08:16,523 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:08:23,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 274
2025-11-12 13:08:23,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:08:25,395 - ispa_next.appointments.models - DEBUG - Appointment Giuseppe Liistro Giuseppe SP-LG 201 WBA11FJ030CS39203 ohne Termin.
2025-11-12 13:08:25,408 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:08:25,418 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:08:25,424 - ispa_next.main - DEBUG - 



2025-11-12 13:08:25,424 - ispa_next.main - DEBUG - starting with process 12 (SP-CC 123) of 18
2025-11-12 13:08:25,427 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:08:28,232 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:08:31,537 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1221
2025-11-12 13:08:31,540 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 274
2025-11-12 13:08:35,377 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:08:35,379 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:09:29,606 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:09:34,202 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:09:42,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:09:43,053 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:09:43,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:09:46,231 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:09:46,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:09:46,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:09:46,928 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:09:56,284 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:09:56,287 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:09:59,544 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:09:59,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:10:01,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:10:03,953 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:10:04,201 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:10:04,431 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:10:04,644 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:10:04,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:10:07,517 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:10:17,831 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:10:18,836 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:10:18,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:19,465 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:38,239 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:10:48,196 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:10:48,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:10:48,351 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:10:48,352 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:10:48,459 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:10:48,729 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:10:50,585 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:10:50,912 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:10:53,543 - ispa_next.functions - DEBUG - Updated appointment (AC00031371) customer contact data.
2025-11-12 13:10:54,554 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:10:54,603 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:10:55,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:10:57,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:10:59,492 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:10:59,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:10:59,647 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:11:03,320 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:11:03,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:11:03,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:11:05,907 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:11:06,097 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:11:06,380 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:11:06,521 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:11:06,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:09,393 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:11:19,574 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:12:19,578 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:12:30,049 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:12:45,425 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:12:46,445 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:12:46,446 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:12:46,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:47,727 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:12:51,954 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:12:51,960 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:12:51,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:52,112 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:12:57,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:58,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:58,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:59,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:59,575 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:13:02,383 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:13:02,411 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:13:04,905 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:13:04,907 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:04,910 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:13:04,911 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:13:04,912 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:13:04,914 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:04,917 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:13:04,918 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:13:04,920 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:13:04,921 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:13:04,923 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:13:04,925 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:13:04,928 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:13:04,932 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:13:04,935 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:13:04,936 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:07,951 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:13:07,953 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:13:07,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:10,842 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:13:10,844 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:13:10,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:13:12,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:13:12,345 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:13:12,348 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:13:34,567 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:13:35,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:13:35,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:13:36,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:06,180 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:15,021 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:24,647 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:14:24,649 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:14:24,650 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:14:26,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:14:26,471 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:14:26,472 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:14:31,848 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:14:50,878 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:14:51,305 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:14:52,568 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:14:56,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1222
2025-11-12 13:14:56,960 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:04,192 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 274
2025-11-12 13:15:04,193 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:15:05,924 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:15:05,944 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:15:05,954 - ispa_next.main - DEBUG - Found new Appointment: SP-LG 201
2025-11-12 13:15:05,956 - ispa_next.main - DEBUG - 



2025-11-12 13:15:05,956 - ispa_next.main - DEBUG - starting with process 13 (SP-LG 201) of 19
2025-11-12 13:15:05,962 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:08,799 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:11,772 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1222
2025-11-12 13:15:11,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 274
2025-11-12 13:15:15,621 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:15,624 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:16:07,235 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:16:28,718 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:31,605 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:16:31,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:31,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:32,273 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:16:32,277 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:16:35,688 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:16:35,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:38,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:40,075 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:16:40,296 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:16:43,704 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:17:01,071 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 13:17:02,076 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:17:02,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:02,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:21,371 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:17:37,262 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:17:37,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:37,462 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:17:37,463 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:17:37,529 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:17:39,189 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:17:40,736 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:17:41,099 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:17:46,750 - ispa_next.functions - DEBUG - Updated appointment (AC00031393) customer contact data.
2025-11-12 13:17:47,921 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:17:48,034 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:17:50,034 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:17:50,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:17:51,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:17:55,260 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:17:55,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:55,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:17:57,833 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:17:58,038 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:17:58,278 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:17:58,462 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:17:58,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:01,622 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:18:11,995 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:19:07,998 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:19:19,462 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 13:19:25,849 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:19:25,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:28,815 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:19:33,175 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:19:34,182 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:19:34,183 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:19:34,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:34,346 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:19:38,580 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:19:38,585 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:19:38,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:38,727 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:19:44,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:45,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:45,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:46,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:46,505 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:19:49,519 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:19:49,523 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:19:51,641 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:19:51,644 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:51,648 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:19:51,651 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:19:51,654 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 13:19:51,658 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:51,664 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:19:51,665 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:19:51,666 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:19:51,668 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:19:51,671 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:19:51,672 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:19:51,675 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:19:51,677 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:19:52,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:19:54,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:20:03,452 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:20:03,454 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:20:03,456 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:20:03,457 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:06,983 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:20:06,985 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:20:07,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:10,836 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:20:10,838 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:20:10,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:20:12,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:20:12,474 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:32,209 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:20:32,212 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:20:56,599 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:20:57,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:20:58,093 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:20:58,485 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:35,713 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:21:45,709 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:21:54,910 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:22:05,518 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:22:05,520 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:22:05,521 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:07,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:22:07,476 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:22:07,479 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:22:12,072 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:22:32,926 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:22:33,349 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 13:22:37,274 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:39,013 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1224
2025-11-12 13:22:39,016 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:45,846 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:22:45,847 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:47,808 - ispa_next.appointments.models - DEBUG - Appointment Anette Teutsch RP-GA 212 WBA21BX0507M58774 ohne Termin.
2025-11-12 13:22:47,822 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:22:47,832 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:22:47,838 - ispa_next.main - DEBUG - 



2025-11-12 13:22:47,838 - ispa_next.main - DEBUG - starting with process 14 (HD-VM 262) of 19
2025-11-12 13:22:47,842 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:50,693 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:54,028 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1224
2025-11-12 13:22:54,030 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:22:57,669 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:57,671 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:53,050 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:23:57,656 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:24:06,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:09,439 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:24:09,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:24:09,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:24:10,255 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:24:10,259 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:24:13,650 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:24:13,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:24:15,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:24:17,854 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:24:18,084 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:24:18,423 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:24:18,574 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:24:22,892 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:24:23,897 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:24:23,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:24:24,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:24:43,299 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:24:43,299 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:24:52,813 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:24:52,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:24:52,942 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:24:52,943 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:24:53,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:24:54,722 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:24:55,131 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:24:57,901 - ispa_next.functions - DEBUG - Updated appointment (AC00031313) customer contact data.
2025-11-12 13:24:58,986 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:24:58,990 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:25:01,253 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:25:01,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:25:02,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:25:06,638 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:25:06,638 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:25:06,641 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:25:06,642 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:25:06,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:07,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:11,399 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:25:11,403 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:25:11,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:11,542 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:25:12,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:12,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:12,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:13,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:13,804 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:25:16,641 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:25:16,643 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:25:18,529 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:25:18,532 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:25:18,537 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:25:18,540 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:25:18,542 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:25:18,543 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:25:18,552 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:25:18,558 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:25:18,564 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:25:18,587 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:25:18,612 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:25:18,627 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:25:18,630 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:25:18,634 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:25:18,637 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:25:18,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:21,675 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:25:21,678 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:25:21,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:25,054 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:25:25,057 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:25:25,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:25:26,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:25:27,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:36,665 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:25:36,667 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:26:00,138 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:26:00,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:26:01,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:26:02,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:32,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:26:41,415 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:26:51,017 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:26:51,020 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:26:51,021 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:52,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:26:52,830 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:26:52,833 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:26:57,369 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:27:18,277 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:27:18,712 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:27:19,938 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:24,646 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1225
2025-11-12 13:27:24,648 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:31,939 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 277
2025-11-12 13:27:31,940 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:33,686 - ispa_next.appointments.models - DEBUG - Appointment Serrala Group GmbH HH-SE 3002 WBA11DZ010FK46108 ohne Termin.
2025-11-12 13:27:33,695 - ispa_next.appointments.models - DEBUG - Appointment Anette Teutsch RP-GA 212 WBA21BX0507M58774 ohne Termin.
2025-11-12 13:27:33,708 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:27:33,716 - ispa_next.main - DEBUG - 



2025-11-12 13:27:33,716 - ispa_next.main - DEBUG - starting with process 15 (RP-PL 400) of 19
2025-11-12 13:27:33,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:36,609 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:39,760 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1225
2025-11-12 13:27:39,762 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 277
2025-11-12 13:27:43,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:43,686 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:39,195 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:28:43,883 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:28:53,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:57,022 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:28:57,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:57,169 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:57,719 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:29:07,447 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:29:07,450 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:29:10,730 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:10,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:13,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:15,322 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:29:16,954 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:29:17,145 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:29:17,316 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:29:21,619 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:29:22,624 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:29:22,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:23,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:40,102 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:29:50,709 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:29:50,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:50,871 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:29:50,872 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:29:51,043 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:29:52,625 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:29:54,225 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:29:54,535 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:29:58,325 - ispa_next.functions - DEBUG - Updated appointment (AD00027502) customer contact data.
2025-11-12 13:29:59,391 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:29:59,397 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:30:01,531 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:30:01,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:30:03,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:30:07,458 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:30:07,459 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:30:07,463 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:30:07,464 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:30:07,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:08,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:12,400 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:30:12,405 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:30:12,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:12,510 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:30:18,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:18,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:18,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:20,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:20,141 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:30:23,637 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:30:23,639 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:30:25,793 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:30:25,796 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:30:25,801 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:30:25,802 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:30:25,803 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:30:25,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:30:25,808 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:30:25,809 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:30:25,810 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:30:25,812 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:30:25,815 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:30:25,816 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:30:25,819 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:30:25,823 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:30:25,826 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:30:25,827 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:29,683 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:30:29,686 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:30:29,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:33,363 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:30:33,365 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:30:33,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:30:35,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:30:35,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:48,388 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:30:48,391 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:31:14,017 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:31:14,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:16,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:31:16,838 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:54,752 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:04,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:14,287 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:23,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:23,900 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:32:23,901 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:32:25,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:25,771 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:32:25,773 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:32:30,325 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:32:50,303 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:32:50,807 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 13:32:52,338 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:32:56,771 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:32:56,773 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:03,806 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:33:03,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:05,611 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:33:05,625 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:33:05,631 - ispa_next.main - DEBUG - 



2025-11-12 13:33:05,632 - ispa_next.main - DEBUG - starting with process 16 (LU-GT 232) of 19
2025-11-12 13:33:05,635 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:08,494 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:11,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:33:11,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:33:15,648 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:15,650 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:13,907 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:34:18,673 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:34:28,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:31,227 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:34:31,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:31,368 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:34:31,939 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:34:31,944 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:34:35,325 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:34:35,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:37,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:39,649 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:34:39,856 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:34:40,126 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:34:40,295 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:34:44,682 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:34:45,687 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:34:45,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:46,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:04,477 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:35:14,360 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:35:14,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:14,507 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:14,508 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:35:14,604 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:35:15,056 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:35:17,613 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:35:19,169 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 13:35:19,824 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:35:22,830 - ispa_next.functions - DEBUG - Updated appointment (AC00031321) customer contact data.
2025-11-12 13:35:24,024 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:35:24,032 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:35:24,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:35:26,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:35:28,468 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:35:28,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:35:28,654 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:35:32,331 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:35:32,331 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:35:32,334 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:35:32,335 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:35:32,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:32,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:37,182 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:35:37,187 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:35:37,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:37,362 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:35:37,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:38,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:38,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:39,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:39,540 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:35:42,427 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:35:42,429 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:35:44,836 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:35:44,844 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:35:44,847 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:35:44,848 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:35:44,849 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:35:44,851 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:35:44,855 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:35:44,856 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:35:44,858 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:35:44,859 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:35:44,862 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:35:44,864 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:35:44,867 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:35:44,870 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:35:44,873 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:35:44,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:48,010 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:35:48,012 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:35:48,014 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:50,918 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:35:50,920 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:35:50,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:35:52,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:35:52,848 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:59,523 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:35:59,525 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:36:25,643 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:36:26,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:36:27,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:36:27,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:59,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:08,613 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:18,409 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:18,411 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:18,412 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:20,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:20,273 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:20,275 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:25,043 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:37:44,906 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:45,431 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 13:37:46,896 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:51,471 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:37:51,473 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:59,017 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:37:59,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:38:00,954 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:38:00,972 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:38:00,982 - ispa_next.main - DEBUG - 



2025-11-12 13:38:00,982 - ispa_next.main - DEBUG - starting with process 17 (SP-BK 80) of 19
2025-11-12 13:38:00,986 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:38:03,832 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:38:06,938 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:38:06,940 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:38:10,815 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:38:10,817 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:39:03,664 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:39:09,544 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:39:18,487 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:22,121 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:39:22,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:22,296 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:39:22,930 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:39:33,353 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:39:33,357 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:39:36,653 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:39:36,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:38,907 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:39:40,910 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:39:41,142 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:39:41,426 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:39:41,556 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:39:45,875 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:39:46,880 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:39:46,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:47,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:06,713 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:40:17,725 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:40:17,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:17,901 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:40:17,902 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:40:18,000 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:40:19,670 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:40:20,042 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:40:23,962 - ispa_next.functions - DEBUG - Updated appointment (AC00031338) customer contact data.
2025-11-12 13:40:25,160 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:40:25,166 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:40:27,429 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:40:27,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:40:29,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:40:33,458 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:40:33,459 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:40:33,463 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:40:33,464 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:40:33,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:34,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:40:38,342 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:40:38,347 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:40:38,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:38,491 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:40:44,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:44,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:44,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:46,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:40:46,043 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:40:49,548 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:40:49,550 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:40:51,408 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:40:51,409 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:40:51,413 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:40:51,414 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:40:51,416 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:40:51,417 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:40:51,422 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:40:51,423 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:40:51,425 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:40:51,465 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:40:51,468 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:40:51,470 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:40:51,473 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:40:51,477 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:40:51,480 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:40:51,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:55,308 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:40:55,310 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:40:55,314 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:58,968 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:40:58,971 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:40:58,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:41:01,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:41:01,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:15,394 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:41:15,396 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:41:39,448 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:41:40,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:41:41,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:41:41,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:20,125 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:42:29,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:42:38,938 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:42:48,806 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:42:48,810 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:42:48,811 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:42:50,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:42:50,689 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:42:50,691 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:42:55,392 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:43:15,375 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:43:15,778 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 13:43:17,577 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:43:21,817 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:43:21,819 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:43:29,294 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:43:29,295 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:43:31,130 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:43:31,140 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:43:31,147 - ispa_next.main - DEBUG - 



2025-11-12 13:43:31,147 - ispa_next.main - DEBUG - starting with process 18 (KA-S 9140) of 19
2025-11-12 13:43:31,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:43:34,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:43:37,430 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:43:37,433 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:43:41,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:43:41,260 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:44:38,466 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:44:43,317 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:44:53,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:56,873 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:44:56,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:57,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:44:57,582 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:45:07,133 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:45:07,136 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:45:10,439 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:45:10,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:45:12,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:45:14,488 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:45:14,705 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:45:15,016 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:45:15,199 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:45:19,562 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:45:20,568 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:45:20,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:21,219 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:29,499 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:45:29,502 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:45:29,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:29,630 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:45:29,632 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:45:29,740 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:45:31,295 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:45:31,653 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:45:34,506 - ispa_next.functions - DEBUG - Updated appointment (AD00027444) customer contact data.
2025-11-12 13:45:35,622 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:45:35,625 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:45:37,884 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:45:37,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:45:39,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:45:43,939 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:45:43,939 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:45:43,944 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:45:43,945 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:45:43,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:45:44,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:45:48,933 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:45:48,938 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:45:48,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:45:49,096 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:45:49,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:50,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:50,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:45:51,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:45:51,296 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:45:54,845 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:45:54,848 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:45:56,775 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:45:56,779 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:45:56,784 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:45:56,786 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:45:56,787 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:45:56,788 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:45:56,791 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:45:56,793 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 13:45:56,794 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:45:56,795 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:45:56,798 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:45:56,799 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:45:56,805 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:45:56,809 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:45:56,812 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:45:56,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:00,697 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:46:00,700 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:46:00,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:05,180 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:46:05,183 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:46:05,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:46:07,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:46:07,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:18,614 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:46:18,616 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:46:43,937 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:46:44,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:46:45,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:46:46,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:23,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:32,670 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:42,025 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:52,076 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:52,079 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:47:52,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:47:53,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:47:53,968 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:47:53,971 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:47:58,833 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:48:19,597 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:48:19,982 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 13:48:21,599 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:26,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:48:26,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:34,880 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 276
2025-11-12 13:48:34,881 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:48:36,714 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:48:36,724 - ispa_next.appointments.models - DEBUG - Appointment Emmanouil Krystalakis LU-EK 32 WBA5F31070FH74392 ohne Termin.
2025-11-12 13:48:36,730 - ispa_next.main - DEBUG - 



2025-11-12 13:48:36,730 - ispa_next.main - DEBUG - starting with process 19 (GER-HD 777) of 19
2025-11-12 13:48:36,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:48:39,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:42,905 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1226
2025-11-12 13:48:42,907 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 276
2025-11-12 13:48:47,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:47,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:49:45,786 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:49:50,695 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:50:00,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:50:07,523 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:50:07,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:07,670 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:50:08,083 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:50:17,924 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:50:17,927 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:50:21,157 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:50:21,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:50:23,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:50:25,400 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:50:25,581 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:50:25,864 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:50:26,000 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:50:30,343 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:50:31,350 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:50:31,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:31,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:51,586 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:51:04,326 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:51:04,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:51:04,474 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:51:04,475 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:51:04,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:51:04,864 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:51:06,585 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:51:08,062 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 13:51:08,701 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:51:11,618 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:51:11,711 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:51:12,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:51:15,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:51:17,477 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:51:17,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:51:17,660 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:51:21,809 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:51:21,810 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:51:21,835 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:51:21,836 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:51:21,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:51:22,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:51:26,716 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:51:26,721 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:51:26,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:51:26,863 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:51:27,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:51:27,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:51:27,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:51:29,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:51:29,099 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:51:35,285 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:51:35,288 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:51:38,484 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:51:38,485 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:51:38,488 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 13:51:38,490 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 13:51:38,491 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:51:38,493 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:51:38,496 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:51:38,497 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:51:38,499 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:51:38,501 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:51:38,503 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:51:38,505 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:51:38,509 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:51:38,512 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:51:38,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:45,418 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:51:45,422 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:51:45,424 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:52,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:51:52,247 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:52:07,913 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:52:29,516 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:52:29,518 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:52:29,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:52:31,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:52:31,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:52:45,818 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:52:45,821 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:53:12,287 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:53:12,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:53:14,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:53:14,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:19,719 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:54:31,896 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:54:43,227 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:54:53,591 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:04,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:13,900 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:23,687 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:34,253 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:34,256 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:55:34,256 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:55:36,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:55:36,325 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:55:36,327 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:55:41,101 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:56:02,734 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:56:03,123 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 13:56:08,482 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:56:10,568 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-12 13:56:10,580 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:56:19,262 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 277
2025-11-12 13:56:19,263 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:56:21,108 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
2025-11-12 13:56:21,116 - ispa_next.main - DEBUG - Found new Appointment: RP-PL 8000
2025-11-12 13:56:21,118 - ispa_next.main - DEBUG - 



2025-11-12 13:56:21,118 - ispa_next.main - DEBUG - starting with process 20 (RP-PL 8000) of 20
2025-11-12 13:56:21,122 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:56:24,067 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:56:28,803 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-12 13:56:28,805 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 277
2025-11-12 13:56:32,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:56:32,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:57:36,956 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:57:55,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:56,047 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:57:56,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:57:57,841 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:57:57,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:57,954 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:57:59,625 - ispa_next.functions - DEBUG - HU date already expired after 202 days.
2025-11-12 13:58:16,322 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:58:16,325 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:58:21,756 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:58:21,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:58:24,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:58:26,862 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:58:27,092 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:58:30,431 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:58:30,644 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:58:30,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:58:32,174 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:58:43,120 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:58:44,125 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:58:44,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:58:44,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:58:51,321 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 13:58:51,324 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:58:51,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:58:51,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:58:51,509 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:58:51,623 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:58:51,917 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:58:53,918 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:58:54,471 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:58:59,951 - ispa_next.functions - DEBUG - Updated appointment (AC00031399) customer contact data.
2025-11-12 13:59:01,831 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:59:01,834 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:59:02,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:59:05,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:59:08,681 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:59:08,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:59:09,475 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:59:13,154 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:59:13,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:59:13,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:59:15,806 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:59:16,087 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:59:16,361 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:59:16,561 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:59:16,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:59:18,056 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:59:28,826 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:00:28,830 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:00:40,884 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 14:00:48,813 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:00:48,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:00:50,239 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:00:54,568 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:00:55,577 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:00:55,582 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 14:00:55,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:00:55,735 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:00:59,943 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 14:00:59,949 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:00:59,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:01:00,111 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:01:03,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:01:04,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:01:04,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:01:05,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:01:05,866 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:01:07,505 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:01:07,508 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:01:10,225 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:01:10,227 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:01:10,231 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 14:01:10,232 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 14:01:10,233 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-12 14:01:10,234 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:01:10,238 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:01:10,239 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 14:01:10,245 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:01:10,246 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:01:10,250 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:01:10,251 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:01:10,254 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:01:10,257 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 14:01:11,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 14:01:12,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 14:01:21,612 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 14:01:21,615 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:01:21,616 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:01:21,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:23,761 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:01:23,764 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:01:23,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:25,903 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:01:25,906 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:01:25,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:01:27,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:01:27,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:37,461 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:01:37,463 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:02:01,917 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:02:02,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:02:03,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:02:04,086 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:02:29,174 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:02:39,418 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:02:39,422 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:02:39,423 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:02:41,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:02:41,404 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:02:41,406 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:02:46,212 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:03:07,373 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:03:07,959 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 14:03:12,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:03:14,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1227
2025-11-12 14:03:14,752 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:03:22,638 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 277
2025-11-12 14:03:22,639 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:03:24,484 - ispa_next.appointments.models - DEBUG - Appointment Thomas Werner KA-X 2067 WBAJX61040BJ23836 ohne Termin.
