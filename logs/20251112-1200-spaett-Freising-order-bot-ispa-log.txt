2025-11-12 12:00:38,306 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:00:38,347 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:00:51,236 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:01:03,126 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:01:18,594 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:03:16,568 - ispa_next.app_start.main - DEBUG - Operation already took 106.65 seconds (more than 80 seconds)
2025-11-12 12:03:18,630 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_l7tlk97o_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_l7tlk97o', 'txt']
2025-11-12 12:03:18,870 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:03:18,874 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:03:18,875 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:05:18,037 - ispa_next.app_start.main - DEBUG - Operation already took 106.70 seconds (more than 80 seconds)
2025-11-12 12:05:20,096 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_e2tb_zg4_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_e2tb_zg4', 'txt']
2025-11-12 12:05:20,349 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:05:20,354 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:05:28,413 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 12:05:37,831 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:05:48,063 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:06:03,590 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:08:01,589 - ispa_next.app_start.main - DEBUG - Operation already took 106.92 seconds (more than 80 seconds)
2025-11-12 12:08:03,656 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_5hy2d44q_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_5hy2d44q', 'txt']
2025-11-12 12:08:03,888 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:08:03,892 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:08:03,893 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:10:02,862 - ispa_next.app_start.main - DEBUG - Operation already took 106.62 seconds (more than 80 seconds)
2025-11-12 12:10:04,940 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_jg4cfjhu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_jg4cfjhu', 'txt']
2025-11-12 12:10:05,175 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:10:05,179 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:10:13,101 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 12:10:22,245 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:10:32,468 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:10:48,500 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:12:46,121 - ispa_next.app_start.main - DEBUG - Operation already took 106.51 seconds (more than 80 seconds)
2025-11-12 12:12:48,185 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_9s65fcti_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_9s65fcti', 'txt']
2025-11-12 12:12:48,425 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:12:48,430 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:12:48,431 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:14:47,409 - ispa_next.app_start.main - DEBUG - Operation already took 106.61 seconds (more than 80 seconds)
2025-11-12 12:14:49,465 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_llw1kyj0_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_llw1kyj0', 'txt']
2025-11-12 12:14:49,695 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:14:49,700 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:14:57,644 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 12:15:06,258 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:15:16,940 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:15:32,518 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:17:29,753 - ispa_next.app_start.main - DEBUG - Operation already took 106.16 seconds (more than 80 seconds)
2025-11-12 12:17:31,807 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_qw1b91yo_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\93b956e1fc86603b\\tess_qw1b91yo', 'txt']
2025-11-12 12:17:32,032 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:17:32,036 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:17:32,037 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:17:58,342 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:18:15,141 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:18:18,486 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:19,623 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:18:19,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 397
2025-11-12 12:18:21,763 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 331
2025-11-12 12:18:21,764 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:18:21,764 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:22,883 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:24,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:09,798 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:19:09,808 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:19:09,814 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:19:09,831 - ispa_next.appointments.models - DEBUG - Appointment Firma REWE Markt GmbH FS-RE 166 WBA11DX000CD76582 ohne Termin.
2025-11-12 12:19:09,855 - ispa_next.appointments.models - DEBUG - Appointment Christina Müller EI-CA 8501 WBA1V710207A22215 ohne Termin.
2025-11-12 12:19:09,883 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:19:09,883 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:19:09,901 - ispa_next.appointments.models - DEBUG - Appointment Julian Marvin Lamberti FS-JL 96 WBAJC510X0G860905 ohne Termin.
2025-11-12 12:19:09,915 - ispa_next.appointments.models - DEBUG - Appointment Luca Weicker M-LW 208 WBA5R11080FH35709 ohne Termin.
2025-11-12 12:19:09,926 - ispa_next.appointments.models - DEBUG - Appointment Michael Rudorfer FS-EV 777 WBA2D710405G19272 ohne Termin.
2025-11-12 12:19:09,940 - ispa_next.appointments.models - DEBUG - Appointment Andreas Lechner FS-LL 300 WBA5R11060AK29564 ohne Termin.
2025-11-12 12:19:09,958 - ispa_next.appointments.models - DEBUG - Appointment Florian Eichinger FS-LS 932 WBAJT91090BR75371 ohne Termin.
2025-11-12 12:19:09,973 - ispa_next.appointments.models - DEBUG - Appointment Michael Rudorfer FS-EV 777 WBA2D710405G19272 ohne Termin.
2025-11-12 12:19:09,991 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:19:10,035 - ispa_next.appointments.models - DEBUG - Appointment Firma TSA Solution GmbH FS-SK 410 WBA11CM0508D75834 ohne Termin.
2025-11-12 12:19:10,055 - ispa_next.appointments.models - DEBUG - Appointment Firma Dr. Schwab Ges. f. Technologie M-S 7134 WBAGV41060CL15774 ohne Termin.
2025-11-12 12:19:10,086 - ispa_next.appointments.models - DEBUG - Appointment Labinot Deda FS-LD 789 WBA3K51030K307246 ohne Termin.
2025-11-12 12:19:10,126 - ispa_next.appointments.models - DEBUG - Appointment Kevin Perleberg FS-CK 149 WBAUS91000A187519 ohne Termin.
2025-11-12 12:19:10,132 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:19:10,145 - ispa_next.appointments.models - DEBUG - Appointment Murat Böcekci FS-MU 79 WBANU31010BX99380 ohne Termin.
2025-11-12 12:19:10,158 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Durak FS-DD 62 WBA4F11020G316587 ohne Termin.
2025-11-12 12:19:10,177 - ispa_next.appointments.models - DEBUG - Appointment Schuberthan Schuberthan DGF-Y 8570 WBA35GP000N338205 ohne Termin.
2025-11-12 12:19:10,194 - ispa_next.appointments.models - DEBUG - Appointment Christine Huber FS-CH 282 WBA8J11090A714964 ohne Termin.
2025-11-12 12:19:10,249 - ispa_next.main - DEBUG - Found 20 out of 216 appointments to process (configured limit: 20).
2025-11-12 12:19:10,250 - ispa_next.main - DEBUG - Processing 16 fresh appointments.
2025-11-12 12:19:10,250 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 12:19:10,250 - ispa_next.main - DEBUG - All appointments: AB-JD 288, FS-LR 218, H-ZL 1004, K-PY 765, M-NK4105, FS-NK 258, R-N 9943E, FS-P 2159, T-P 129, FS-CG 799, FS-SF234, FS-Y 330, FS-BD 344, FS B 93, FS-RR 163, FS-LJ688, FS-SN 135, FS-W 758, FS-MM 939, FS-P 1003
2025-11-12 12:19:10,254 - ispa_next.main - DEBUG - 



2025-11-12 12:19:10,254 - ispa_next.main - DEBUG - starting with process 1 (AB-JD 288) of 20
2025-11-12 12:19:10,263 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:19:11,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:19:12,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:19:12,420 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 331
2025-11-12 12:19:13,679 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:19:13,681 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:39,240 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:19:49,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:51,869 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:19:51,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:51,960 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:52,184 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:19:52,188 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:19:55,018 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:55,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:55,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:58,004 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:19:58,110 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:19:58,219 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:19:58,404 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:20:02,631 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:20:03,638 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:20:03,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:04,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:17,578 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:20:25,043 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:20:25,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:25,162 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:20:25,163 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:20:25,194 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:20:26,471 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:20:26,765 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:20:30,863 - ispa_next.functions - DEBUG - Updated appointment (AB00018924) customer contact data.
2025-11-12 12:20:31,759 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:20:31,763 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:20:32,554 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:20:32,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:20:33,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:20:36,887 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:20:36,888 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:20:36,894 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:20:36,899 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:20:36,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:37,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:45,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:45,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:45,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:46,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:46,655 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:20:49,105 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:20:49,110 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:20:50,074 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:20:50,075 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:50,079 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:20:50,081 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:50,084 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:20:50,085 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:20:50,087 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:20:50,088 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:20:50,089 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:20:50,091 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:20:50,095 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:20:50,098 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:20:50,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:52,642 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:20:52,645 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:20:52,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:55,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:55,301 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:21:07,474 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:21:07,477 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:21:07,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:21:08,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:21:08,600 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:16,912 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:21:16,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:19,477 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:21:29,937 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:21:30,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:30,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:21:31,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:56,036 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:22:00,274 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:22:06,411 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:22:06,412 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:22:07,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:22:07,175 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:22:07,178 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:22:09,850 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:22:18,430 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:22:18,819 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:22:19,419 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:20,637 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:22:20,638 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:23,782 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 397
2025-11-12 12:22:23,783 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:24,500 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:22:24,512 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:22:24,519 - ispa_next.main - DEBUG - 



2025-11-12 12:22:24,519 - ispa_next.main - DEBUG - starting with process 2 (FS-LR 218) of 20
2025-11-12 12:22:24,524 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:22:25,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:22:26,474 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:22:26,475 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 397
2025-11-12 12:22:27,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:22:27,721 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:57,022 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:23:05,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:07,075 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:23:07,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:07,164 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:07,314 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:23:07,318 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:23:10,000 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:10,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:11,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:13,157 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:23:13,247 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:23:13,368 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:23:13,457 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:23:13,457 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:23:21,651 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:23:22,656 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:23:22,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:23,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:34,066 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:23:41,470 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:23:41,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:41,565 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:41,566 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:23:41,617 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:23:42,905 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:23:43,146 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:23:45,989 - ispa_next.functions - DEBUG - Updated appointment (AC00013040) customer contact data.
2025-11-12 12:23:46,907 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:23:46,911 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:23:47,678 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:23:47,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:48,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:23:52,041 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:52,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:52,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:54,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:23:54,630 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:23:54,744 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:23:54,814 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:23:54,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:24:03,236 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:25:03,239 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:25:11,581 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:25:57,583 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:26:05,961 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:26:13,351 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:26:14,358 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:26:14,364 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:26:14,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:26:14,452 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:26:14,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:15,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:15,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:26:16,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:26:16,074 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:26:17,379 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:26:17,380 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:26:18,571 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:26:18,575 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:26:18,578 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:26:18,580 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:26:18,583 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:26:18,584 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:26:18,585 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:26:18,587 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:26:18,588 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:26:18,590 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:26:18,594 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:26:18,597 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:26:18,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:19,794 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:26:19,798 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:26:19,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:21,007 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:26:21,010 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:26:21,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:26:21,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:26:21,814 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:26:21,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:23,002 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:26:33,753 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:26:34,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:34,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:26:34,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:46,468 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:26:46,472 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:26:46,473 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:26:47,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:26:47,220 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:26:47,223 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:26:49,018 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:26:56,866 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:26:57,246 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:26:57,432 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:59,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:26:59,312 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:02,302 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 397
2025-11-12 12:27:02,304 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:03,181 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:27:03,193 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:27:03,200 - ispa_next.main - DEBUG - 



2025-11-12 12:27:03,200 - ispa_next.main - DEBUG - starting with process 3 (H-ZL 1004) of 20
2025-11-12 12:27:03,206 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:27:04,441 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:27:05,782 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:27:05,783 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 397
2025-11-12 12:27:07,116 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:07,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:35,043 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:27:43,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:45,284 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:27:45,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:45,398 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:27:45,643 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:27:52,173 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:27:52,177 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:27:54,879 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:54,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:55,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:57,972 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:27:58,083 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:28:01,309 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:28:01,415 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:28:01,416 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:28:10,151 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:28:11,160 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:28:11,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:11,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:15,203 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 12:28:15,210 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:28:15,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:15,302 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:28:15,303 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:28:15,367 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:28:16,623 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:28:17,809 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:28:18,031 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:28:21,218 - ispa_next.functions - DEBUG - Updated appointment (AC00013039) customer contact data.
2025-11-12 12:28:22,202 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:28:22,206 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:28:23,046 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:28:23,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:28:23,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:28:28,253 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:28:28,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:28,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:30,807 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:28:30,910 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:28:31,002 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:28:31,068 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:28:31,069 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:28:39,586 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:29:39,588 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:29:47,804 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:30:35,807 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:30:44,344 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:30:52,127 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:30:53,141 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:30:53,145 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:30:53,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:53,219 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:30:53,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:54,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:54,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:54,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:54,905 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:30:56,787 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:30:56,791 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:30:57,951 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:30:57,953 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:30:57,955 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:30:57,958 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:30:57,960 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:30:57,961 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:30:57,962 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:30:57,963 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:30:57,964 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:30:57,966 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:30:57,970 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:30:57,974 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:30:57,974 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:59,868 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:30:59,874 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:30:59,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:01,912 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:31:01,915 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:31:01,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:31:02,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:31:02,807 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:31:02,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:04,727 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:31:14,810 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:31:15,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:31:15,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:31:15,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:34,095 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:31:38,468 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:31:38,473 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:31:38,473 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:39,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:31:39,230 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:31:39,234 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:31:40,694 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:31:48,290 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:31:48,681 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:31:48,980 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:50,671 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:31:50,674 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:53,654 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:31:53,654 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:54,463 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:31:54,476 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:31:54,483 - ispa_next.main - DEBUG - 



2025-11-12 12:31:54,483 - ispa_next.main - DEBUG - starting with process 4 (K-PY 765) of 20
2025-11-12 12:31:54,491 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:55,579 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:56,313 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:31:56,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:31:57,558 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:57,559 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:17,748 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:32:31,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:32:35,778 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:32:35,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:35,846 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:32:36,116 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:32:36,120 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:32:39,030 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:32:39,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:32:40,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:32:42,132 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:32:42,248 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:32:42,331 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:32:42,401 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:32:46,561 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:32:47,567 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:32:47,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:48,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:00,848 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:33:08,392 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:33:08,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:08,520 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:08,521 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:33:08,557 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:33:09,808 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:33:11,159 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:33:11,377 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:33:14,280 - ispa_next.functions - DEBUG - Updated appointment (AC00013036) customer contact data.
2025-11-12 12:33:15,193 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:33:15,196 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:33:15,986 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:33:15,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:33:16,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:33:20,848 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 12:33:20,848 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:33:20,849 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:33:20,852 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:33:20,857 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:33:20,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:21,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:21,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:22,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:22,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:22,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:22,948 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:33:27,098 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:33:27,100 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:33:28,304 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:33:28,305 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:33:28,306 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:33:28,308 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:33:28,309 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:33:28,310 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:33:28,311 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:33:28,313 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:33:28,326 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:33:28,339 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:33:28,344 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:33:28,347 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:33:28,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:32,969 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:33:32,972 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:33:32,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:37,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:37,758 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:33:47,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:00,945 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:34:00,948 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:34:00,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:34:01,774 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:34:01,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:13,743 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:34:13,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:18,381 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:34:30,045 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:34:30,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:34:31,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:34:31,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:16,511 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:35:20,579 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:35:24,836 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:35:30,060 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:35:36,494 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:35:36,495 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:35:37,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:35:37,278 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:35:37,281 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:35:40,082 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:35:46,668 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:35:47,053 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:35:47,779 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:48,943 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:35:48,944 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:51,380 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:35:51,380 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:52,464 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:35:52,477 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:35:52,484 - ispa_next.main - DEBUG - 



2025-11-12 12:35:52,484 - ispa_next.main - DEBUG - starting with process 5 (M-NK4105) of 20
2025-11-12 12:35:52,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:35:53,657 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:54,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:35:54,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:35:56,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:56,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:36:34,108 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:36:34,208 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:36:34,213 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:36:34,663 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:36:34,664 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:36:37,059 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:36:37,060 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:36:37,918 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:36:37,930 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:36:37,936 - ispa_next.main - DEBUG - 



2025-11-12 12:36:37,936 - ispa_next.main - DEBUG - starting with process 6 (FS-NK 258) of 20
2025-11-12 12:36:37,941 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:36:39,100 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:36:40,160 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:36:40,161 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:36:41,567 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:36:41,568 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:13,995 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:37:14,008 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:37:14,013 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:14,557 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:37:14,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:17,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:37:17,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:18,050 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:37:18,062 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:37:18,069 - ispa_next.main - DEBUG - 



2025-11-12 12:37:18,069 - ispa_next.main - DEBUG - starting with process 7 (R-N 9943E) of 20
2025-11-12 12:37:18,074 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:37:19,234 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:20,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:37:20,458 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:37:22,126 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:22,128 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:55,036 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:37:55,048 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:37:55,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:55,532 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:37:55,533 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:58,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:37:58,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:58,908 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:37:58,922 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:37:58,927 - ispa_next.main - DEBUG - 



2025-11-12 12:37:58,927 - ispa_next.main - DEBUG - starting with process 8 (FS-P 2159) of 20
2025-11-12 12:37:58,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:00,025 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:01,110 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:38:01,111 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:38:02,462 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:02,464 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:33,487 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:38:33,499 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:38:33,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:33,940 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:38:33,941 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:36,067 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:38:36,068 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:36,796 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:38:36,808 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:38:36,813 - ispa_next.main - DEBUG - 



2025-11-12 12:38:36,813 - ispa_next.main - DEBUG - starting with process 9 (T-P 129) of 20
2025-11-12 12:38:36,818 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:37,751 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:38,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:38:38,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:38:40,156 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:40,157 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:10,240 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:39:10,252 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:39:10,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:39:10,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:39:10,682 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:39:13,152 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:39:13,153 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:13,910 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:39:13,922 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:39:13,928 - ispa_next.main - DEBUG - 



2025-11-12 12:39:13,928 - ispa_next.main - DEBUG - starting with process 10 (FS-CG 799) of 20
2025-11-12 12:39:13,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:39:15,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:39:16,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:39:16,411 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:39:17,978 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:39:17,980 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:48,700 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:39:48,712 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:39:48,726 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:39:49,117 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:39:49,138 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:39:51,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:39:51,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:52,695 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:39:52,717 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:39:52,724 - ispa_next.main - DEBUG - 



2025-11-12 12:39:52,724 - ispa_next.main - DEBUG - starting with process 11 (FS-SF234) of 20
2025-11-12 12:39:52,729 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:39:53,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:39:55,023 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:39:55,024 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:39:56,378 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:39:56,379 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:27,422 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:40:27,434 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:40:27,439 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:27,954 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:40:27,955 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:30,440 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:40:30,440 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:31,130 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:40:31,141 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:40:31,146 - ispa_next.main - DEBUG - 



2025-11-12 12:40:31,146 - ispa_next.main - DEBUG - starting with process 12 (FS-Y 330) of 20
2025-11-12 12:40:31,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:40:32,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:33,140 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:40:33,142 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:40:34,392 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:34,393 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:04,886 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:41:04,899 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:41:04,905 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:05,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:41:05,335 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:07,969 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:41:07,970 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:09,103 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:41:09,116 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:41:09,122 - ispa_next.main - DEBUG - 



2025-11-12 12:41:09,122 - ispa_next.main - DEBUG - starting with process 13 (FS-BD 344) of 20
2025-11-12 12:41:09,128 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:41:10,243 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:11,258 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:41:11,259 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:41:12,594 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:12,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:43,306 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:41:43,316 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:41:43,321 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:43,711 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:41:43,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:46,359 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:41:46,360 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:41:47,138 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:41:47,149 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:41:47,156 - ispa_next.main - DEBUG - 



2025-11-12 12:41:47,156 - ispa_next.main - DEBUG - starting with process 14 (FS B 93) of 20
2025-11-12 12:41:47,160 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:41:48,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:41:49,183 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:41:49,184 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:41:50,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:41:50,472 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:21,487 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:42:21,499 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 12:42:21,504 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:22,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:42:22,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:24,642 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:42:24,643 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:25,751 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:42:25,764 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:42:25,770 - ispa_next.main - DEBUG - 



2025-11-12 12:42:25,770 - ispa_next.main - DEBUG - starting with process 15 (FS-RR 163) of 20
2025-11-12 12:42:25,776 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:42:26,957 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:28,035 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:42:28,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:42:29,464 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:29,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:01,409 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:43:01,420 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 12:43:01,424 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:01,749 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:43:01,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:03,805 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:43:03,806 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:04,563 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:43:04,575 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:43:04,581 - ispa_next.main - DEBUG - 



2025-11-12 12:43:04,581 - ispa_next.main - DEBUG - starting with process 16 (FS-LJ688) of 20
2025-11-12 12:43:04,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:05,750 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:06,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:43:06,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:43:08,329 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:08,330 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:39,113 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:43:39,124 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 12:43:39,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:39,490 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:43:39,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:41,589 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:43:41,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:42,288 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:43:42,303 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:43:42,310 - ispa_next.main - DEBUG - 



2025-11-12 12:43:42,310 - ispa_next.main - DEBUG - starting with process 17 (FS-SN 135) of 20
2025-11-12 12:43:42,317 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:43,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:43,977 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:43:43,978 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:43:45,328 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:45,329 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:09,197 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:44:10,829 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:44:16,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:18,685 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:44:18,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:18,772 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:44:18,960 - ispa_next.functions - DEBUG - HU date already expired after 6 days.
2025-11-12 12:44:22,014 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:44:22,017 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:44:24,774 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:44:24,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:44:26,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:44:28,140 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:44:28,245 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:44:28,339 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:44:28,417 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:44:32,558 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:44:33,564 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:44:33,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:34,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:46,658 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:44:50,124 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:44:50,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:50,214 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:44:50,215 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:44:50,250 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:44:51,677 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:44:52,841 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:44:53,133 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:44:54,869 - ispa_next.functions - DEBUG - Updated appointment (AB00018764) customer contact data.
2025-11-12 12:44:55,783 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:44:55,787 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:44:56,507 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:44:56,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:44:57,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:45:01,779 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:45:01,779 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:01,779 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:45:01,783 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:45:01,789 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:45:01,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:02,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:02,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:03,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:03,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:03,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:03,817 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:45:06,252 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:45:06,257 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:45:07,368 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:45:07,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:07,372 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:45:07,374 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:07,380 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:45:07,382 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:45:07,385 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:45:07,389 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:45:07,390 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:45:07,391 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:45:07,395 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:45:07,398 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:45:07,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:09,980 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:45:12,640 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:45:12,646 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:45:12,649 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:15,386 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:45:15,389 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:45:15,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:45:16,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:45:16,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:20,278 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:45:20,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:22,916 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:45:33,076 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:45:33,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:45:34,022 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:45:34,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:58,754 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:46:02,874 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:46:07,868 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:46:10,811 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:46:10,811 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:46:11,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:46:11,464 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:46:11,467 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:46:14,595 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:46:22,205 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:46:22,589 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 12:46:22,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:46:25,200 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:46:25,202 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:46:28,403 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:46:28,404 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:46:29,204 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:46:29,219 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:46:29,225 - ispa_next.main - DEBUG - 



2025-11-12 12:46:29,225 - ispa_next.main - DEBUG - starting with process 18 (FS-W 758) of 20
2025-11-12 12:46:29,230 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:46:30,348 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:46:31,482 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:46:31,483 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:46:32,729 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:46:32,730 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:46:56,477 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:46:58,317 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:47:03,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:07,783 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:47:07,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:07,899 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:47:08,147 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:47:08,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:08,216 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:47:13,766 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:47:16,743 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:47:16,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:47:17,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:47:19,933 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:47:20,046 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:47:20,154 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:47:20,228 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:47:24,430 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:47:25,437 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:47:25,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:25,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:39,402 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:47:43,539 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:47:43,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:43,624 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:47:43,625 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:47:43,678 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:47:43,812 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:47:45,028 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:47:45,245 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:47:47,375 - ispa_next.functions - DEBUG - Updated appointment (AB00018766) customer contact data.
2025-11-12 12:47:48,330 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:47:48,334 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:47:48,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:47:49,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:47:50,422 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:47:50,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:47:50,528 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:47:54,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:47:54,124 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:47:54,129 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:47:54,134 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:47:54,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:47:54,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:47:55,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:55,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:55,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:47:56,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:47:56,247 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:48:00,645 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:48:00,647 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:48:02,237 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:48:02,238 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:48:02,240 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:48:02,241 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:48:02,243 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:48:02,245 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:48:02,246 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:48:02,247 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:48:02,249 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:48:02,254 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:48:02,260 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:48:02,263 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:48:02,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:06,992 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:48:06,995 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:48:06,996 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:11,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:48:11,836 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:48:20,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:34,999 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:48:35,002 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:48:35,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:48:35,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:48:36,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:48,015 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:48:48,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:52,655 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:49:03,784 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:49:04,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:49:04,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:49:05,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:50,572 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:54,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:50:00,054 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:50:03,774 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:50:03,775 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:50:04,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:50:04,518 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:50:04,521 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:50:07,623 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:50:15,140 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:50:15,517 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 12:50:16,441 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:50:17,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:50:17,668 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:50:20,431 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:50:20,432 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:50:21,554 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:50:21,567 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:50:21,586 - ispa_next.main - DEBUG - 



2025-11-12 12:50:21,586 - ispa_next.main - DEBUG - starting with process 19 (FS-MM 939) of 20
2025-11-12 12:50:21,591 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:50:22,723 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:50:23,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:50:23,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:50:25,295 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:50:25,296 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:50:57,110 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:50:58,922 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:51:04,024 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:05,262 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:51:05,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:05,357 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:05,789 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:51:05,800 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:51:08,622 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:51:08,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:09,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:51:11,931 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:51:12,054 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:51:12,139 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:51:12,226 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:51:16,429 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:51:17,435 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:51:17,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:17,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:28,906 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:51:32,073 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:51:32,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:32,148 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:32,148 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:51:32,176 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:51:33,405 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:51:33,610 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:51:35,352 - ispa_next.functions - DEBUG - Updated appointment (AB00018759) customer contact data.
2025-11-12 12:51:36,289 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:51:36,293 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:51:37,039 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:51:37,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:51:37,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:51:41,529 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:51:41,529 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:51:41,538 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:51:41,543 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:51:41,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:42,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:51:46,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:46,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:46,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:47,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:51:47,385 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:51:48,637 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:51:48,638 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:51:49,817 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:51:49,818 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:51:49,819 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:51:49,820 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:51:49,821 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:51:49,822 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:51:49,823 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:51:49,825 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:51:49,826 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:51:49,827 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:51:49,832 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:51:49,835 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:51:49,836 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:50,998 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:51:51,001 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:51:51,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:52,186 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:51:52,189 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:51:52,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:51:53,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:51:53,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:05,762 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:52:05,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:06,978 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:52:17,894 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:52:18,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:52:18,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:52:19,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:30,390 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:52:30,393 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:52:30,393 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:52:30,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:52:30,957 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:52:30,960 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:52:32,597 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:52:40,194 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:52:40,609 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 12:52:41,051 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:52:42,271 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:52:42,272 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:52:45,215 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:52:45,216 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:52:46,019 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:52:46,030 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-12 12:52:46,037 - ispa_next.main - DEBUG - 



2025-11-12 12:52:46,037 - ispa_next.main - DEBUG - starting with process 20 (FS-P 1003) of 20
2025-11-12 12:52:46,041 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:52:47,161 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:52:48,452 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:52:48,454 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 396
2025-11-12 12:52:50,035 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:52:50,036 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:53:14,434 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:53:16,740 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:53:21,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:53:23,582 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:53:23,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:23,643 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:53:23,817 - ispa_next.functions - DEBUG - HU date already expired after 220 days.
2025-11-12 12:53:27,391 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:53:27,395 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:53:30,173 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:53:30,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:53:31,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:53:33,403 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:53:33,586 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:53:33,683 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:53:33,775 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:53:37,931 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:53:38,943 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:53:38,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:39,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:51,081 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:53:55,402 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:53:55,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:55,525 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:53:55,526 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:53:55,583 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:53:56,893 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:53:57,097 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:53:59,014 - ispa_next.functions - DEBUG - Updated appointment (AB00018801) customer contact data.
2025-11-12 12:53:59,986 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:53:59,990 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:54:00,799 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:54:00,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:54:01,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:54:05,772 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:54:05,772 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:54:05,787 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:54:05,791 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:54:05,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:06,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:54:10,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:11,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:11,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:12,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:54:12,081 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:54:13,986 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:54:13,987 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:54:15,416 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:54:15,418 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:54:15,420 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:54:15,421 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:54:15,423 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:54:15,425 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:54:15,427 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:54:15,429 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:54:15,431 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:54:15,442 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:54:15,448 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:54:15,451 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:54:15,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:17,377 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:54:17,380 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:54:17,382 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:19,358 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:54:19,361 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:54:19,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:54:20,329 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:54:20,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:29,770 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:54:29,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:31,680 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:54:42,387 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:54:42,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:54:43,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:54:43,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:55:02,083 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:55:06,681 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:55:06,684 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:55:06,685 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:55:07,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:55:07,350 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:55:07,352 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:55:09,173 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:55:17,010 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:55:17,420 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 12:55:17,930 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:55:19,214 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 699
2025-11-12 12:55:19,215 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:55:22,321 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 396
2025-11-12 12:55:22,322 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:55:23,218 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-12 12:55:23,230 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
