2025-11-17 11:00:35,944 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:00:35,967 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:00:49,616 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:01:00,911 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:01:16,495 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:01:40,590 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:01:52,612 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:01:56,012 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:57,158 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 928
2025-11-17 11:01:57,159 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-17 11:01:59,293 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 376
2025-11-17 11:01:59,293 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:01:59,294 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:02:00,176 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:02:01,005 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:02:57,531 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:02:57,566 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:02:57,588 - ispa_next.appointments.models - DEBUG - Appointment Franz-Michael von Morenhoffen Herr M-VM 1945 WMW11GD0602W56385 ohne Termin.
2025-11-17 11:02:57,606 - ispa_next.appointments.models - DEBUG - Appointment Andreas Pletschacher Herr M-S 7268 WMW11GA0607N78892 ohne Termin.
2025-11-17 11:02:57,612 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:02:57,627 - ispa_next.appointments.models - DEBUG - Appointment ZEBE-Zeichenbüro Ebersberg Frau EBE-ZB 999 WMWJZ31040TP30810 ohne Termin.
2025-11-17 11:02:57,652 - ispa_next.appointments.models - DEBUG - Appointment Erich Pudelko Herr EBE-EP 11 WBA21EA0307N15581 ohne Termin.
2025-11-17 11:02:57,685 - ispa_next.appointments.models - DEBUG - Appointment Markus Deppe Herr M-MD 6407 WMWLV310802U83186 ohne Termin.
2025-11-17 11:02:57,699 - ispa_next.appointments.models - DEBUG - Appointment Petra Wichert Frau M-PW 2302 WBAUH31030E525919 ohne Termin.
2025-11-17 11:02:57,713 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Trepte Herr STA-GW 131 WBA2A51000V427342 ohne Termin.
2025-11-17 11:02:57,725 - ispa_next.appointments.models - DEBUG - Appointment Firma Open Text Software GmbH M-M 1684E WBA21GV030CW39508 ohne Termin.
2025-11-17 11:02:57,736 - ispa_next.appointments.models - DEBUG - Appointment Herbert Kuhn Herr M-KT 4350 WBAEJ11080AF78090 ohne Termin.
2025-11-17 11:02:57,780 - ispa_next.appointments.models - DEBUG - Appointment Firma curare - Verein zur Förderung EBE-C 204 WBA21EA0307L92610 ohne Termin.
2025-11-17 11:02:57,793 - ispa_next.appointments.models - DEBUG - Appointment Hans-Dieter Krill Herr M-DK 2695 WBA3U11040J871366 ohne Termin.
2025-11-17 11:02:57,803 - ispa_next.appointments.models - DEBUG - Appointment Aldin Hecimovic Herr EBE-AD 216 WBA2E510305G50482 ohne Termin.
2025-11-17 11:02:57,815 - ispa_next.appointments.models - DEBUG - Appointment Firma Global Concerts GmbH M-SZ 1171 WBA21EF0605018576 ohne Termin.
2025-11-17 11:02:57,829 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Fertich Frau EBE-FJ 111 WBAXB31040DW54269 ohne Termin.
2025-11-17 11:02:57,840 - ispa_next.appointments.models - DEBUG - Appointment Daniela Felbrich Frau ED-JS 396 WBY8P210207F54741 ohne Termin.
2025-11-17 11:02:57,853 - ispa_next.appointments.models - DEBUG - Appointment Patrick Gaßler Herr TS-GP 2299 WBA4C31090G785518 ohne Termin.
2025-11-17 11:02:57,862 - ispa_next.main - DEBUG - Found 5 out of 52 appointments to process (configured limit: 15).
2025-11-17 11:02:57,862 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 11:02:57,862 - ispa_next.main - DEBUG - All appointments: M-C 3503, M-L 5712, EBE-BL 54, M-X 8740, EBE-XC 42
2025-11-17 11:02:57,866 - ispa_next.main - DEBUG - 



2025-11-17 11:02:57,866 - ispa_next.main - DEBUG - starting with process 1 (M-C 3503) of 5
2025-11-17 11:02:57,870 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:02:58,876 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:00,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 928
2025-11-17 11:03:00,083 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 376
2025-11-17 11:03:01,477 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:03:01,478 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:30,833 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:03:39,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:40,930 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:03:40,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:41,021 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:41,287 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:03:41,289 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:03:41,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:41,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:44,614 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:03:44,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:03:45,673 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:03:47,678 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:03:47,787 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:03:47,880 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:03:47,998 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:03:52,158 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:03:53,164 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:03:53,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:53,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:06,922 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:04:13,426 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:04:13,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:13,497 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:13,499 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:04:13,533 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:04:14,782 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:04:15,859 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:04:16,065 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:04:20,099 - ispa_next.functions - DEBUG - Updated appointment (AJ00018587) customer contact data.
2025-11-17 11:04:21,000 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:04:21,002 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:04:21,544 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:04:21,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:04:22,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:04:25,791 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:04:25,791 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:04:25,794 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:04:25,796 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:04:25,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:26,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:30,381 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:04:30,386 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:04:30,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:30,466 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:04:36,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:36,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:36,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:37,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:37,358 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:04:38,631 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:04:38,635 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:04:39,532 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:04:39,534 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:39,536 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:04:39,548 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:04:39,551 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:04:39,561 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:39,565 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:04:39,569 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:04:39,569 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:04:39,580 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:04:39,585 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:04:39,587 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:04:39,601 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:04:39,602 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:04:39,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:40,872 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:04:40,874 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:04:40,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:42,048 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:04:42,049 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:04:42,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:43,282 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:04:43,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:04:44,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:04:44,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:54,400 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:04:54,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:55,611 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:05:06,245 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:05:06,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:07,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:05:07,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:19,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:19,440 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:05:19,440 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:19,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:20,015 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:05:20,016 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:05:21,345 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:05:29,809 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:05:30,184 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:05:30,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:32,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 928
2025-11-17 11:05:32,494 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:34,724 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 428
2025-11-17 11:05:34,724 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:05:35,426 - ispa_next.main - DEBUG - Found new Appointment: ED-AS 1005
2025-11-17 11:05:35,428 - ispa_next.main - DEBUG - 



2025-11-17 11:05:35,428 - ispa_next.main - DEBUG - starting with process 2 (ED-AS 1005) of 6
2025-11-17 11:05:35,431 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:36,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:37,224 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 928
2025-11-17 11:05:37,225 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 428
2025-11-17 11:05:38,500 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:38,502 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:06:05,370 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:06:15,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:15,190 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:15,297 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:17,281 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:06:17,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:17,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:17,560 - ispa_next.functions - DEBUG - HU date already expired after 853 days.
2025-11-17 11:06:24,471 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:06:24,473 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:06:24,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:24,538 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:33,889 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:06:33,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:35,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:37,089 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:06:37,207 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:06:37,293 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:06:37,430 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:06:37,430 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:06:48,722 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:06:49,742 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:06:49,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:50,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:03,032 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:07:10,130 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:07:10,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:10,215 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:10,217 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:07:10,251 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:07:11,466 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:07:12,662 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:07:12,911 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:07:16,782 - ispa_next.functions - DEBUG - Updated appointment (AJ00018586) customer contact data.
2025-11-17 11:07:17,706 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:07:17,708 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:07:18,539 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:07:18,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:07:19,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:07:23,691 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:07:23,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:24,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:26,203 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:07:26,300 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:07:26,383 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:07:26,500 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:07:26,500 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:07:37,677 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:08:37,680 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:08:48,768 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:09:05,770 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:09:17,047 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:09:23,964 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:09:24,972 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:09:24,973 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:09:24,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:25,044 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:09:29,186 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:09:29,193 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:09:29,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:29,270 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:09:32,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:33,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:33,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:34,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:09:34,014 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:09:36,463 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:09:36,465 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:09:37,435 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:09:37,437 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:09:37,439 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:09:37,441 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:09:37,442 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:09:37,451 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:09:37,454 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:09:37,456 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:09:37,458 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:09:37,459 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:09:37,461 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:09:37,461 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:09:37,465 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:09:37,465 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:09:37,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:40,110 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:09:40,112 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:09:40,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:42,786 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:09:42,786 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:09:42,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:45,288 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:09:45,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:09:45,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:09:45,964 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:09:45,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:48,486 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 11:09:57,360 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:10:08,596 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:10:09,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:09,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:10:09,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:35,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:39,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:42,814 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:10:42,817 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:10:42,818 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:10:43,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:10:43,313 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:10:43,315 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:10:44,720 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:10:51,246 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:10:51,618 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:10:51,924 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:10:53,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 929
2025-11-17 11:10:53,782 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:10:56,472 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-17 11:10:56,473 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:10:57,349 - ispa_next.main - DEBUG - 



2025-11-17 11:10:57,349 - ispa_next.main - DEBUG - starting with process 3 (M-L 5712) of 6
2025-11-17 11:10:57,357 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:10:58,335 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:10:59,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 929
2025-11-17 11:10:59,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-17 11:11:00,712 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:11:00,714 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:11:31,941 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:11:41,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:41,671 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:11:41,798 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:47,787 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:11:47,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:47,873 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:11:48,282 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:11:48,284 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:11:48,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:48,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:11:51,342 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:11:51,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:11:52,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:11:54,280 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:11:54,391 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:11:54,474 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:11:54,537 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:11:54,539 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:12:05,852 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:12:06,856 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:12:06,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:07,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:15,690 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 11:12:22,248 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:12:22,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:22,311 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:12:22,311 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:12:22,368 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:12:23,525 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:12:24,689 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:12:24,915 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:12:28,736 - ispa_next.functions - DEBUG - Updated appointment (AJ00018537) customer contact data.
2025-11-17 11:12:29,651 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:12:29,651 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:12:30,349 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:12:30,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:12:31,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:12:34,596 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:12:34,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:35,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:12:37,092 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:12:37,196 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:12:37,273 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:12:37,347 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:12:37,348 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:12:48,643 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:13:48,645 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:13:59,993 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:14:31,996 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:14:43,210 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:14:50,758 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:14:51,764 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:14:51,766 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:14:51,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:51,843 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:14:55,934 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:14:55,938 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:14:55,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:56,064 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:15:01,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:15:02,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:15:02,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:15:02,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:15:02,834 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:15:08,390 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:15:08,392 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:15:09,362 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:15:09,362 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:15:09,366 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:15:09,366 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:15:09,368 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:15:09,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:15:09,372 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:15:09,372 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:15:09,374 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:15:09,384 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:15:09,400 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:15:09,400 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:15:09,406 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:15:09,408 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:15:09,408 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:15,516 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:15:18,118 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:15:18,120 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:15:18,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:24,109 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:15:24,109 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:15:24,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:30,077 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:15:30,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:15:30,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:15:30,806 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:15:30,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:36,859 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:15:47,978 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:15:48,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:48,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:15:49,091 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:47,067 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:16:50,387 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:16:54,755 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:16:58,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:02,271 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:06,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:10,563 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:15,244 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:15,246 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:17:15,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:17:15,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:17:16,074 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:17:16,075 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:17:17,856 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:17:24,268 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:17:24,645 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 11:17:25,177 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:17:26,663 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 929
2025-11-17 11:17:26,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:17:28,969 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 429
2025-11-17 11:17:28,970 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:29,640 - ispa_next.main - DEBUG - 



2025-11-17 11:17:29,640 - ispa_next.main - DEBUG - starting with process 4 (EBE-BL 54) of 6
2025-11-17 11:17:29,643 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:17:30,506 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:17:31,436 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 929
2025-11-17 11:17:31,437 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 429
2025-11-17 11:17:32,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:17:32,550 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:59,533 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:18:09,737 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:15,787 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:18:15,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:15,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:16,132 - ispa_next.functions - DEBUG - HU date already expired after 7 days.
2025-11-17 11:18:23,122 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:18:23,125 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:18:23,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:23,197 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:26,274 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:18:26,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:27,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:29,333 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:18:29,491 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:18:29,609 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:18:29,674 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:18:33,899 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:18:34,904 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:18:34,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:35,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:45,281 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:18:45,281 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:18:52,220 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:18:52,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:52,295 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:52,297 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:18:52,367 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:18:53,660 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:18:54,966 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:18:55,203 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:18:58,306 - ispa_next.functions - DEBUG - Updated appointment (AD00038741) customer contact data.
2025-11-17 11:18:59,254 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:18:59,255 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:18:59,827 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:18:59,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:19:00,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:19:04,157 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:19:04,157 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:19:04,163 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:19:04,165 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:19:04,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:04,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:19:08,776 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:19:09,468 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:19:24,632 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:19:24,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:24,780 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:19:30,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:31,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:31,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:31,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:19:31,790 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:19:37,176 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:19:37,178 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:19:38,686 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:19:38,692 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:19:38,694 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:19:38,696 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:19:38,700 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:19:38,702 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:19:38,702 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:19:38,704 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:19:38,704 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:19:38,706 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:19:38,708 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:19:38,709 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:19:38,713 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:19:38,713 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:19:38,715 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:44,875 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:19:48,060 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:19:48,064 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:19:48,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:54,291 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:19:54,291 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:19:54,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:00,589 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:20:00,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:20:01,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:20:01,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:16,514 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:20:16,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:22,586 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:20:36,986 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:20:37,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:20:38,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:20:38,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:37,901 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:42,948 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:47,596 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:51,941 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:56,297 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:22:01,493 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:22:07,629 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:22:13,343 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:22:13,345 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:22:13,347 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:22:14,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:22:14,511 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:22:14,512 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:22:17,229 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:22:28,500 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:22:28,894 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 11:22:29,678 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:22:33,187 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 932
2025-11-17 11:22:33,189 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:22:38,062 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 431
2025-11-17 11:22:38,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:22:39,167 - ispa_next.appointments.models - DEBUG - Appointment Bernard Duperray Herr RO-SO 241 WBA2A51090V428831 ohne Termin.
2025-11-17 11:22:39,173 - ispa_next.main - DEBUG - Found new Appointment: EBE-NE 87
2025-11-17 11:22:39,174 - ispa_next.main - DEBUG - 



2025-11-17 11:22:39,175 - ispa_next.main - DEBUG - starting with process 5 (EBE-NE 87) of 7
2025-11-17 11:22:39,178 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:22:40,453 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:22:41,664 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 932
2025-11-17 11:22:41,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 431
2025-11-17 11:22:43,420 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:22:43,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:23:27,218 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:23:37,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:37,784 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:37,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:43,377 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:23:43,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:43,462 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:43,819 - ispa_next.functions - DEBUG - HU date soon to be invalid in 60 days.
2025-11-17 11:23:52,690 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:23:52,694 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:23:52,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:52,789 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:24:04,849 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:24:04,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:06,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:24:08,326 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:24:08,505 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:24:08,649 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:24:08,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:24:08,758 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:24:20,530 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:24:21,543 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:24:21,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:22,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:35,612 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:24:35,612 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:24:45,379 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:24:45,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:45,475 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:24:45,476 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:24:45,524 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:24:45,703 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:24:47,246 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:24:47,509 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:24:51,888 - ispa_next.functions - DEBUG - Updated appointment (AJ00018606) customer contact data.
2025-11-17 11:24:52,847 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:24:52,853 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:24:53,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:24:54,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:24:56,026 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:24:56,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:24:56,120 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:24:59,748 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:24:59,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:25:00,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:25:02,316 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:25:02,475 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:25:02,644 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:25:02,747 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:25:02,747 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:25:14,454 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:26:14,457 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:26:26,491 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:26:27,494 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:26:39,074 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:26:47,392 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:26:48,398 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:26:48,399 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:26:48,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:48,494 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:26:52,613 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:26:52,617 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:26:52,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:52,691 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:26:53,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:53,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:53,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:54,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:26:54,295 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:26:59,043 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:26:59,045 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:27:00,862 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:27:00,864 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:27:00,866 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:27:00,867 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:27:00,868 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:27:00,869 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:27:00,873 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:27:00,877 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:27:00,880 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:27:00,884 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:27:00,884 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:27:00,886 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:27:00,889 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:27:00,891 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:27:00,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:06,334 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:27:06,336 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:27:06,338 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:12,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:12,188 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:27:24,348 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:27:24,348 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:27:24,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:29,729 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:27:29,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:27:30,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:27:30,653 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:27:30,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:36,041 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:27:50,462 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:27:50,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:27:51,490 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:27:51,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:44,898 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:50,546 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:55,345 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:01,306 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:06,951 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:12,253 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:18,213 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:18,215 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:29:18,216 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:19,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:29:19,496 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:29:19,498 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:29:22,036 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:29:32,030 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:29:32,429 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 11:29:33,377 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:36,878 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:29:36,880 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:41,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 430
2025-11-17 11:29:41,494 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:29:42,673 - ispa_next.main - DEBUG - Found new Appointment: M-J 1605
2025-11-17 11:29:42,674 - ispa_next.main - DEBUG - Found new Appointment: RO-SO 241
2025-11-17 11:29:42,675 - ispa_next.main - DEBUG - 



2025-11-17 11:29:42,675 - ispa_next.main - DEBUG - starting with process 6 (M-J 1605) of 9
2025-11-17 11:29:42,679 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:44,414 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:46,100 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:29:46,101 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 430
2025-11-17 11:29:48,198 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:48,199 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:21,426 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:30:32,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:33,506 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:30:33,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:33,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:33,961 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:30:33,965 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:30:33,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:34,080 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:46,067 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:30:46,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:47,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:30:49,410 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:30:49,538 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:30:49,722 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:30:49,832 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:30:54,082 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:30:55,088 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:30:55,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:55,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:10,351 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:31:10,351 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:31:18,835 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:31:18,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:18,913 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:18,914 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:31:19,040 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:31:20,359 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:31:20,559 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:31:25,121 - ispa_next.functions - DEBUG - Updated appointment (AO00010672) customer contact data.
2025-11-17 11:31:26,029 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:31:26,030 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:31:27,245 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:31:27,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:31:28,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:31:31,932 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:31:31,932 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:31:31,935 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:31:31,935 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:31:31,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:32,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:36,644 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:31:36,658 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:31:36,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:36,775 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:31:40,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:40,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:40,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:41,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:41,630 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:31:42,965 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:31:42,968 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:31:44,181 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:31:44,185 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:31:44,187 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:31:44,191 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:31:44,193 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:31:44,195 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:31:44,197 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:31:44,197 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:31:44,199 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:31:44,201 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:31:44,201 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:31:44,202 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:31:44,204 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:31:44,206 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:31:44,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:45,470 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:31:45,473 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:31:45,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:46,796 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:31:46,796 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:31:46,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:48,024 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:31:48,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:31:49,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:31:49,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:57,388 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:31:57,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:58,608 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:32:11,094 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:32:11,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:32:12,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:32:12,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:25,706 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:25,708 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:32:25,710 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:32:26,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:32:26,689 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:32:26,691 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:32:28,734 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:32:38,837 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:32:39,263 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 11:32:39,954 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:32:43,290 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:32:43,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:32:48,082 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 427
2025-11-17 11:32:48,083 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:32:49,267 - ispa_next.main - DEBUG - 



2025-11-17 11:32:49,268 - ispa_next.main - DEBUG - starting with process 7 (RO-SO 241) of 9
2025-11-17 11:32:49,271 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:32:50,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:32:52,530 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:32:52,532 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 427
2025-11-17 11:32:54,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:32:54,516 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:33:31,706 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:33:43,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:49,851 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:33:49,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:33:49,940 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:33:50,381 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:33:50,383 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:33:50,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:33:50,501 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:03,054 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:34:03,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:04,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:34:06,800 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:34:06,948 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:34:07,062 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:34:07,198 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:34:11,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:34:12,398 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:34:12,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:12,907 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:23,691 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 11:34:32,584 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:34:32,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:32,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:32,696 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:34:32,743 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:34:32,904 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:34:34,178 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:34:34,371 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:34:38,630 - ispa_next.functions - DEBUG - Updated appointment (AJ00018609) customer contact data.
2025-11-17 11:34:39,650 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:34:39,651 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:34:40,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:34:41,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:34:43,202 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:34:43,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:34:43,285 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:34:46,961 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:34:46,961 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:34:46,965 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:34:46,965 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:34:46,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:47,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:34:51,703 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:34:51,707 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:34:51,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:51,804 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:34:57,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:57,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:57,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:58,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:34:58,688 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:35:04,134 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:35:04,137 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:35:05,785 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:35:05,787 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:35:05,789 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 11:35:05,789 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 11:35:05,791 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:35:05,793 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:35:05,795 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:35:05,795 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:35:05,797 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:35:05,799 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:35:05,800 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:35:05,801 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:35:05,804 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:35:05,808 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:35:05,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:11,927 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:35:15,173 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:35:15,177 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:35:15,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:21,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:21,551 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:35:32,059 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:35:32,059 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 11:35:32,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:38,100 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:35:38,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:35:39,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:35:39,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:51,259 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:35:51,260 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:35:57,255 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:36:10,209 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:36:10,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:36:11,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:36:11,504 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:11,570 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:18,245 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:24,168 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:29,677 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:34,849 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:40,789 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:47,048 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:52,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:37:52,174 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:37:52,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:37:52,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:37:52,974 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:37:52,976 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:37:54,984 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:38:04,635 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:38:04,637 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:38:04,637 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:09,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:38:10,021 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:38:10,022 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:38:12,019 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:38:27,134 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:38:27,136 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:38:27,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:27,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:38:28,072 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:38:28,072 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:38:29,930 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:38:29,962 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:38:32,484 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 11:38:32,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:35,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:38:35,732 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:39,974 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 426
2025-11-17 11:38:39,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:40,930 - ispa_next.main - DEBUG - 



2025-11-17 11:38:40,930 - ispa_next.main - DEBUG - starting with process 8 (M-X 8740) of 9
2025-11-17 11:38:40,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:42,223 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:43,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:38:43,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 426
2025-11-17 11:38:45,995 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 11:38:45,997 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:46,347 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 148, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 11:38:46,347 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 11:38:46,350 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:47,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:38:47,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 11:38:51,649 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 426
2025-11-17 11:38:51,650 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:52,830 - ispa_next.main - DEBUG - 



2025-11-17 11:38:52,830 - ispa_next.main - DEBUG - starting with process 9 (EBE-XC 42) of 9
2025-11-17 11:38:52,846 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:54,569 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:56,241 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:38:56,242 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 426
2025-11-17 11:38:58,100 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:58,101 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:39:24,951 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:39:36,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:38,001 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:39:38,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:38,076 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:38,348 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:39:38,351 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:39:38,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:38,436 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:57,029 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:39:57,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:39:57,394 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 11:39:58,257 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 11:39:58,275 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:39:58,277 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:39:59,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:40:00,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:40:00,090 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:40:00,116 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:40:02,697 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 11:40:02,700 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:40:06,937 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 11:40:06,937 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:40:10,983 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 426
2025-11-17 11:40:10,984 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
