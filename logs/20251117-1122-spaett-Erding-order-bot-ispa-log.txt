2025-11-17 11:36:21,417 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 11:36:21,425 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 11:36:32,118 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 11:36:42,471 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 11:36:58,066 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 11:37:21,620 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 11:37:37,243 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 11:37:40,907 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:37:41,936 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:37:41,938 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 11:37:44,330 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 325
2025-11-17 11:37:44,331 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 11:37:44,332 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:37:45,558 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 11:37:46,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:36,244 - ispa_next.appointments.models - DEBUG - Appointment Georg Lorenz Neumaier ED-MN 155 WBA7K310905Y27519 ohne Termin.
2025-11-17 11:38:36,268 - ispa_next.appointments.models - DEBUG - Appointment Giovanni Ciconti ED-GC 1000 WBA31BN070CL81257 ohne Termin.
2025-11-17 11:38:36,304 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-17 11:38:36,316 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:38:36,321 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:38:36,332 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-17 11:38:36,345 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-17 11:38:36,355 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-17 11:38:36,364 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-17 11:38:36,373 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-17 11:38:36,383 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-17 11:38:36,395 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-17 11:38:36,396 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:38:36,409 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-17 11:38:36,422 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-17 11:38:36,433 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-17 11:38:36,466 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-17 11:38:36,477 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-17 11:38:36,484 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:38:36,502 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-17 11:38:36,517 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-17 11:38:36,531 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-17 11:38:36,542 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-17 11:38:36,553 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-17 11:38:36,562 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-17 11:38:36,572 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-17 11:38:36,584 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-17 11:38:36,601 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-17 11:38:36,611 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-17 11:38:36,620 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-17 11:38:36,630 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-17 11:38:36,640 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-17 11:38:36,652 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-17 11:38:36,661 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-17 11:38:36,672 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-17 11:38:36,688 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-17 11:38:36,707 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-17 11:38:36,716 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-17 11:38:36,726 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-17 11:38:36,736 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-17 11:38:36,736 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:38:36,745 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-17 11:38:36,755 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-17 11:38:36,764 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-17 11:38:36,774 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-17 11:38:36,788 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-17 11:38:36,798 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-17 11:38:36,807 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-17 11:38:36,826 - ispa_next.main - DEBUG - Found 9 out of 131 appointments to process (configured limit: 20).
2025-11-17 11:38:36,826 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-17 11:38:36,826 - ispa_next.main - DEBUG - All appointments: H-HN 1902, M-D 7066, ED-GW 660, ED-SX 233, FS XS 200, ED-ZR 368, ED-RH 1905, ED-CH 412, EBE-BU 81
2025-11-17 11:38:36,831 - ispa_next.main - DEBUG - 



2025-11-17 11:38:36,831 - ispa_next.main - DEBUG - starting with process 1 (H-HN 1902) of 9
2025-11-17 11:38:36,835 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:37,633 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:38,513 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:38:38,515 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 325
2025-11-17 11:38:39,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:39,878 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:39:23,099 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:39:31,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:31,855 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:32,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:36,618 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:39:36,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:39:36,688 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:39:36,842 - ispa_next.functions - DEBUG - HU date already expired after 39 days.
2025-11-17 11:39:43,386 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:39:43,389 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:39:46,048 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:39:46,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:39:46,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:39:48,950 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:39:55,110 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:40:02,615 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:40:03,620 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:40:03,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:04,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:16,842 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:40:24,186 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:40:24,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:24,249 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:40:24,251 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:40:24,329 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:40:24,428 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:40:25,593 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:40:25,818 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:40:29,709 - ispa_next.functions - DEBUG - Updated appointment (AA00022573) customer contact data.
2025-11-17 11:40:30,618 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:40:30,620 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:40:30,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:40:31,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:40:32,899 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:40:32,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:40:32,967 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:40:36,991 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:40:36,991 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:40:36,991 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:40:36,995 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:40:37,001 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:40:37,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:37,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:37,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:38,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:38,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:39,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:39,053 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:40:43,195 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:40:43,198 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:40:44,339 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:40:44,340 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:40:44,341 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:40:44,342 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:40:44,343 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:40:44,346 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:40:44,348 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:40:44,350 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:40:44,353 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:40:44,355 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:40:44,359 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:40:44,361 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:40:44,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:48,959 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:40:48,961 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:40:48,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:53,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:53,671 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:41:05,175 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:41:05,178 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:41:05,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:41:05,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:41:05,983 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:41:05,985 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:10,598 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:41:21,281 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:41:21,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:41:22,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:41:22,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:41:54,782 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:41:54,784 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:41:55,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:41:55,546 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:41:55,548 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:41:58,609 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:42:18,010 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:42:18,110 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:42:18,111 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:42:20,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:42:20,119 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:42:20,121 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:42:21,788 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:42:21,822 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:42:23,903 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 11:42:23,907 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:42:25,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:42:25,730 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:42:28,227 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 11:42:28,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:42:28,888 - ispa_next.main - DEBUG - 



2025-11-17 11:42:28,888 - ispa_next.main - DEBUG - starting with process 2 (M-D 7066) of 9
2025-11-17 11:42:28,892 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:42:29,816 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:42:30,658 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:42:30,659 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 11:42:31,868 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:42:31,870 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:42:58,502 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:43:08,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:43:09,518 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:43:09,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:09,589 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:43:09,859 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:43:09,862 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:43:12,741 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:43:12,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:43:13,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:43:15,872 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:43:16,038 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:43:19,313 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:43:19,386 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:43:19,386 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:43:30,556 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:43:31,561 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:43:31,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:32,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:38,261 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:43:38,265 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:43:38,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:38,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:43:38,405 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:43:38,460 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:43:38,585 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:43:39,851 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:43:40,088 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:43:42,514 - ispa_next.functions - DEBUG - Updated appointment (AG00009959) customer contact data.
2025-11-17 11:43:43,431 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:43:43,434 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:43:43,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:43:44,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:43:45,753 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:43:45,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:43:45,829 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:43:49,437 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:43:49,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:43:49,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:43:51,913 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:43:52,004 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:43:52,130 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:43:52,208 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:43:52,209 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:44:03,550 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:45:03,552 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:45:14,827 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:45:58,830 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:46:10,140 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:46:18,186 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:46:19,192 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:46:19,196 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:46:19,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:46:19,314 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:46:28,404 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 11:46:37,986 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 11:46:37,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:46:38,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:46:38,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:46:39,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:46:39,324 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:46:40,624 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:46:40,629 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:46:42,459 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:46:42,459 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:46:42,461 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 11:46:42,463 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:46:42,465 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:46:42,465 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:46:42,471 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:46:42,474 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:46:42,478 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:46:42,490 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:46:42,494 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:47:04,092 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:47:04,093 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 11:47:09,889 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:47:09,892 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:47:09,893 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:11,784 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:47:11,787 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:47:11,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:13,719 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:47:13,721 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:47:13,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:47:14,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:47:14,580 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:47:14,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:16,472 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:47:27,088 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:47:27,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:47:28,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:47:28,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:46,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:51,073 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:51,076 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:47:51,077 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:47:51,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:47:51,729 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:47:51,731 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:47:53,512 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:48:00,826 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:48:01,205 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 11:48:01,534 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:48:03,668 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:48:03,669 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:48:06,557 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 11:48:06,558 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:48:07,271 - ispa_next.main - DEBUG - 



2025-11-17 11:48:07,271 - ispa_next.main - DEBUG - starting with process 3 (ED-GW 660) of 9
2025-11-17 11:48:07,276 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:48:08,471 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:48:09,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:48:09,695 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 11:48:11,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:48:11,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:48:38,219 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:48:47,292 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:48:48,500 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:48:48,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:48:48,587 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:48:48,822 - ispa_next.functions - DEBUG - HU date soon to be invalid in 73 days.
2025-11-17 11:48:55,561 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:48:55,565 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:48:58,428 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:48:58,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:48:59,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:49:01,646 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:49:01,791 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:49:05,010 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:49:05,084 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:49:05,085 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:49:16,519 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:49:17,524 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:49:17,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:49:18,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:49:28,687 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:49:28,687 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:49:35,979 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:49:35,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:49:36,101 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:49:36,102 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:49:36,148 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:49:37,403 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:49:37,594 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:49:40,315 - ispa_next.functions - DEBUG - Updated appointment (AG00009924) customer contact data.
2025-11-17 11:49:41,238 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:49:41,240 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:49:41,989 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:49:41,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:49:42,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:49:46,817 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 11:49:46,818 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:49:46,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:49:47,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:49:49,318 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:49:49,411 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:49:49,530 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:49:49,599 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:49:49,599 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:50:00,887 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:50:08,162 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:50:08,162 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:50:12,365 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:50:13,372 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:50:13,376 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:50:13,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:13,461 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:50:24,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:25,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:25,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:25,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:50:25,965 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:50:27,281 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:50:27,288 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:50:28,725 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:50:28,727 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:50:28,728 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:50:28,729 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:50:28,731 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:50:28,732 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:50:28,733 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:50:28,734 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:50:28,735 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:50:28,737 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:50:28,740 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:50:28,742 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:50:28,743 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:50:29,988 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:50:29,991 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:50:29,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:50:31,196 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:50:31,198 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:50:31,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:50:31,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:50:32,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:50:42,005 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:50:42,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:50:43,231 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:50:54,478 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:50:54,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:50:55,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:50:55,671 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:51:07,741 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:51:07,744 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:51:07,745 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:51:08,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:51:08,493 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:51:08,496 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:51:10,187 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:51:17,654 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:51:18,047 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 11:51:18,333 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:51:19,871 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:51:19,872 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:51:22,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 11:51:22,612 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:51:23,223 - ispa_next.main - DEBUG - 



2025-11-17 11:51:23,223 - ispa_next.main - DEBUG - starting with process 4 (ED-SX 233) of 9
2025-11-17 11:51:23,228 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:51:24,130 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:51:25,057 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:51:25,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 11:51:26,227 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:51:26,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:51:53,812 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:52:02,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:52:03,968 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:52:03,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:04,048 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:52:04,232 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:52:10,942 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:52:10,946 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:52:13,784 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:52:13,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:52:14,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:52:16,926 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:52:22,848 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:52:30,199 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:52:31,205 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:52:31,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:31,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:45,038 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:52:52,495 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:52:52,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:52:52,573 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:52:52,573 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:52:52,613 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:52:52,714 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:52:53,899 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:52:54,120 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:52:57,032 - ispa_next.functions - DEBUG - Updated appointment (AA00022466) customer contact data.
2025-11-17 11:52:57,986 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:52:57,988 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:52:58,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:52:58,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:53:00,298 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:53:00,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:53:00,389 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:53:04,405 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:53:04,405 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:53:04,405 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:53:04,409 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:53:04,414 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:53:04,414 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 11:53:04,415 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:53:05,714 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:53:05,719 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:53:06,725 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:53:06,726 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:53:06,727 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:53:06,729 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:53:06,730 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:53:06,731 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:53:06,732 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:53:06,734 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:53:06,734 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:53:06,736 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:53:06,739 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:53:06,741 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:53:06,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:07,937 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:53:07,939 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:53:07,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:09,197 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:53:09,200 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:53:09,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:53:09,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:53:09,742 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:53:09,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:10,934 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:53:21,834 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:53:22,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:53:22,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:53:22,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:53:34,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:53:34,923 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:53:34,924 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:53:35,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:53:35,452 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:53:35,456 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:53:36,915 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:53:44,292 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:53:44,670 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 11:53:45,000 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:53:46,756 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:53:46,758 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:53:50,109 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 11:53:50,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:53:51,069 - ispa_next.main - DEBUG - 



2025-11-17 11:53:51,070 - ispa_next.main - DEBUG - starting with process 5 (FS XS 200) of 9
2025-11-17 11:53:51,076 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:53:52,346 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:53:53,612 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:53:53,613 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 11:53:55,141 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:53:55,143 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:54:22,554 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:54:32,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:54:35,358 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:54:35,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:54:35,494 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:54:35,719 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:54:42,400 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:54:42,404 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:54:45,228 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:54:45,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:54:46,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:54:48,256 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:54:48,361 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:54:48,508 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:54:48,609 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:54:53,050 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:54:54,057 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:54:54,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:54:54,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:06,976 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:55:14,842 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:55:14,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:14,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:14,928 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:55:14,976 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:55:16,337 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:55:16,560 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:55:19,497 - ispa_next.functions - DEBUG - Updated appointment (AA00022431) customer contact data.
2025-11-17 11:55:20,391 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:55:20,394 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:55:20,960 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:55:20,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:55:21,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:55:25,644 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:55:25,644 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:55:25,649 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:55:25,652 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:55:25,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:55:26,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:55:35,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:35,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:35,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:55:36,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:55:36,671 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:55:39,673 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:55:39,674 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:55:40,666 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:55:40,667 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:55:40,669 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:55:40,670 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:55:40,673 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:55:40,676 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:55:40,679 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:55:40,696 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:55:40,698 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:55:40,699 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:55:40,703 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:55:40,705 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:55:40,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:55:43,953 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:55:43,956 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:55:43,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:55:47,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:55:47,307 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:55:56,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:56:08,919 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:56:08,921 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:56:08,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:56:09,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:56:09,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:56:18,087 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:56:18,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:56:21,334 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:56:32,292 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:56:32,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:56:33,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:56:33,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:57:04,603 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:57:08,796 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:57:15,038 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:57:15,039 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:57:15,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:57:15,779 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:57:15,782 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:57:18,869 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:57:26,859 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:57:27,230 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 11:57:27,812 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:57:29,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:57:29,042 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:57:31,824 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 11:57:31,825 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:57:32,979 - ispa_next.main - DEBUG - 



2025-11-17 11:57:32,980 - ispa_next.main - DEBUG - starting with process 6 (ED-ZR 368) of 9
2025-11-17 11:57:32,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:57:34,178 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:57:35,383 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 11:57:35,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 11:57:36,795 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:57:36,797 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:58:05,507 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:58:14,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:16,097 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:58:16,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:58:16,161 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:58:16,314 - ispa_next.functions - DEBUG - HU date already expired after 263 days.
2025-11-17 11:58:23,195 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:58:23,198 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:58:25,994 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:58:25,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:58:27,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:58:29,204 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:58:35,434 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:58:43,015 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:58:44,021 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:58:44,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:58:44,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:58:58,278 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:59:05,706 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:59:05,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:59:05,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:59:05,801 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:59:05,851 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:59:05,996 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:59:07,210 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:59:07,469 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:59:10,823 - ispa_next.functions - DEBUG - Updated appointment (AA00022408) customer contact data.
2025-11-17 11:59:11,758 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:59:11,761 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:59:11,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:59:12,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:59:14,107 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:59:14,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:59:14,191 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:59:18,239 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:59:18,239 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:59:18,239 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:59:18,241 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:59:18,245 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:59:18,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:59:18,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:59:19,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:59:19,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:59:19,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:59:20,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:59:20,321 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:59:21,583 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:59:21,585 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:59:22,910 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:59:22,912 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:59:22,913 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:59:22,914 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:59:22,915 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:59:22,916 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:59:22,917 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:59:22,919 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:59:22,921 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:59:22,922 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:59:22,925 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:59:22,928 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:59:22,928 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:59:24,116 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:59:24,119 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:59:24,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:59:25,433 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:59:25,437 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:59:25,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:59:26,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:59:26,228 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:59:26,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:59:27,456 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:59:38,645 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:59:39,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:59:39,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:59:39,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:59:50,869 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:59:50,872 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:59:50,872 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:59:51,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:59:51,378 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:59:51,380 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:59:52,783 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:00:00,043 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:00:00,418 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:00:00,791 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:00:02,711 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:00:02,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:00:06,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 12:00:06,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:00:06,842 - ispa_next.main - DEBUG - 



2025-11-17 12:00:06,842 - ispa_next.main - DEBUG - starting with process 7 (ED-RH 1905) of 9
2025-11-17 12:00:06,852 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:00:08,102 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:00:09,476 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:00:09,478 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 12:00:11,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:00:11,390 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:00:42,581 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:00:52,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:00:53,270 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:00:53,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:00:53,343 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:00:53,551 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:00:53,554 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:00:56,316 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:00:56,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:00:57,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:00:59,876 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:00:59,965 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:01:03,286 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:01:03,383 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:01:03,384 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:01:15,013 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:01:16,018 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:01:16,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:01:16,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:01:27,230 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:01:27,230 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:01:33,587 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:01:33,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:01:33,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:01:33,737 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:01:33,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:01:33,856 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:01:35,364 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 12:01:36,551 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 12:01:36,884 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:01:39,868 - ispa_next.functions - DEBUG - Updated appointment (AA00022369) customer contact data.
2025-11-17 12:01:40,853 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:01:40,856 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:01:40,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:01:41,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:01:43,093 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:01:43,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:01:43,160 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:01:46,773 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:01:46,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:01:47,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:01:49,288 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:01:49,405 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:01:49,546 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:01:49,612 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:01:49,613 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:02:01,054 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:03:01,065 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:03:12,594 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:03:19,681 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:03:19,682 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:03:23,834 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:03:24,865 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:03:24,869 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:03:24,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:24,941 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:03:25,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:25,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:25,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:26,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:03:26,477 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:03:27,765 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:03:27,767 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:03:29,299 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:03:29,300 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:03:29,302 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:03:29,307 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:03:29,309 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:03:29,312 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:03:29,314 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:03:29,316 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:03:29,317 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:03:29,318 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:03:29,322 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:03:29,325 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:03:29,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:30,579 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:03:30,582 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:03:30,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:31,836 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:03:31,838 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:03:31,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:03:32,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:03:33,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:41,584 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:03:41,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:42,833 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:03:53,628 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:03:54,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:03:54,705 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:03:54,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:04:06,977 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:04:06,980 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:04:06,982 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:04:07,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:04:07,735 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:04:07,737 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:04:09,281 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:04:17,364 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:04:17,759 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 12:04:18,216 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:04:19,793 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:04:19,794 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:04:22,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 12:04:22,988 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:04:23,991 - ispa_next.main - DEBUG - 



2025-11-17 12:04:23,991 - ispa_next.main - DEBUG - starting with process 8 (ED-CH 412) of 9
2025-11-17 12:04:23,998 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:04:25,409 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:04:26,778 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:04:26,779 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 12:04:28,488 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:04:28,489 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:04:59,010 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:05:10,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:12,225 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:05:12,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:12,356 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:12,706 - ispa_next.functions - DEBUG - HU date already expired after 142 days.
2025-11-17 12:05:19,881 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:05:19,884 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:05:22,760 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:05:22,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:24,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:26,153 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:05:26,253 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:05:29,496 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:05:29,580 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:05:29,581 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:05:41,429 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:05:42,434 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:05:42,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:42,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:57,232 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:06:05,696 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:06:05,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:05,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:06:05,786 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:06:05,897 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:06:07,199 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:06:08,393 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:06:08,631 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:06:12,543 - ispa_next.functions - DEBUG - Updated appointment (AA00022325) customer contact data.
2025-11-17 12:06:13,519 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:06:13,522 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:06:14,397 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:06:14,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:06:15,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:06:19,380 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:06:19,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:19,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:21,882 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:06:21,975 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:06:22,072 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:06:22,165 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:06:22,165 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:06:33,069 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:06:40,370 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:06:40,371 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:06:44,578 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:06:45,587 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:06:45,592 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:06:45,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:45,716 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:06:46,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:46,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:46,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:47,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:47,334 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:06:49,272 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:06:49,279 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:06:50,395 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:06:50,400 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:06:50,402 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:06:50,406 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:06:50,410 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:06:50,412 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:06:50,414 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:06:50,416 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:06:50,417 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:06:50,419 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:06:50,423 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:06:50,426 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:06:50,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:52,341 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:06:52,345 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:06:52,348 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:54,328 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:06:54,332 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:06:54,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:06:55,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:06:55,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:04,878 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:07:04,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:06,833 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:07:18,411 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:07:18,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:07:19,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:07:19,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:38,205 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:43,162 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:43,164 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:07:43,165 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:07:43,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:07:43,950 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:07:43,952 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:07:45,902 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:07:54,166 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:07:54,570 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 12:07:55,115 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:07:56,795 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:07:56,796 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:07:59,849 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 12:07:59,850 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:08:00,678 - ispa_next.main - DEBUG - 



2025-11-17 12:08:00,678 - ispa_next.main - DEBUG - starting with process 9 (EBE-BU 81) of 9
2025-11-17 12:08:00,683 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:08:02,011 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:08:03,433 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:08:03,445 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 346
2025-11-17 12:08:05,066 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:08:05,068 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:08:37,207 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:08:48,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:08:49,343 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:08:49,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:49,442 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:08:49,655 - ispa_next.functions - DEBUG - HU date already expired after 414 days.
2025-11-17 12:08:56,028 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:08:56,033 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:08:58,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:08:58,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:00,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:02,456 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:09:02,627 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:09:05,915 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:09:05,987 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:09:05,987 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:09:18,164 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:09:19,169 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:09:19,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:19,681 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:34,374 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:09:42,760 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:09:42,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:42,877 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:42,878 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:09:42,941 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:09:43,045 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:09:44,298 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:09:44,522 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:09:48,009 - ispa_next.functions - DEBUG - Updated appointment (AA00022323) customer contact data.
2025-11-17 12:09:49,467 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:09:49,469 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:09:49,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:09:50,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:09:52,305 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:09:52,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:09:52,390 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:09:56,860 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:09:57,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:57,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:59,763 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:09:59,906 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:09:59,992 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:10:00,126 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:10:00,126 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:10:11,423 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:11:11,426 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:11:22,959 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:11:30,026 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:11:30,026 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:11:36,200 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:11:43,343 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:11:44,365 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:11:44,369 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:11:44,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:44,489 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:11:44,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:45,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:45,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:46,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:11:46,030 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:11:50,999 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:11:51,001 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:11:52,404 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:11:52,411 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:11:52,413 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:11:52,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:11:52,418 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:11:52,419 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:11:52,420 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:11:52,421 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:11:52,422 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:11:52,428 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:11:52,434 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:11:52,437 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:11:52,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:56,567 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:11:56,571 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:11:56,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:00,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:12:00,744 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:12:05,259 - ispa_next.functions - DEBUG - Motoroil table row seems to be missing the '+' Icon-Button to the left
2025-11-17 12:12:05,262 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:12:05,264 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:12:05,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:12:06,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:12:06,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:18,043 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:12:18,046 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:22,177 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:12:33,281 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:12:33,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:12:34,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:12:34,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:13,696 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:13:18,109 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:13:22,704 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:13:27,900 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:13:33,470 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:13:33,473 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:13:33,474 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:13:34,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:13:34,214 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:13:34,216 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:13:36,279 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:13:44,598 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:13:44,974 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 12:13:45,915 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:13:47,325 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 510
2025-11-17 12:13:47,326 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:13:50,958 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 346
2025-11-17 12:13:50,959 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
