2025-11-17 14:01:02,778 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:01:02,816 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:01:19,478 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:01:31,295 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:01:47,179 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:02:12,864 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:02:27,759 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:02:30,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:02:32,255 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 14:02:32,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 14:02:34,997 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 96
2025-11-17 14:02:34,998 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:02:34,999 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:02:36,735 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:02:38,241 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:02:56,063 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:56,126 - ispa_next.main - DEBUG - Found 15 out of 95 appointments to process (configured limit: 15).
2025-11-17 14:02:56,126 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 14:02:56,126 - ispa_next.main - DEBUG - All appointments: HEF-LK 676, HEF-J 187, HEF-MD 547, ROF-PG 72, HEF-PB 588, HEF-M 726, HEF-AB 332, HEF-XX 99, ROF-NR 1, SM-J 9876 E, HEF-DK 975, WAK-UA 777, HEF-XD 11, HEF-XY 80, HEF-SM 9
2025-11-17 14:02:56,129 - ispa_next.main - DEBUG - 



2025-11-17 14:02:56,129 - ispa_next.main - DEBUG - starting with process 1 (HEF-LK 676) of 15
2025-11-17 14:02:56,134 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:02:57,154 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:02:58,134 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 14:02:58,136 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 96
2025-11-17 14:02:59,346 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:02:59,348 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:03:36,940 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:03:46,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:48,544 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:03:48,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:48,634 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:48,964 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:03:48,967 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:03:51,760 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:03:51,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:52,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:03:54,879 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:03:55,007 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:03:58,274 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:03:58,393 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:04:00,558 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:04:01,564 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:04:01,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:02,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:15,641 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:04:22,874 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:04:22,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:22,951 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:04:22,952 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:04:22,987 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:04:23,117 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:04:24,274 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:04:24,502 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:04:28,407 - ispa_next.functions - DEBUG - Updated appointment (AA00026227) customer contact data.
2025-11-17 14:04:29,331 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:04:29,350 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:04:29,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:04:30,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:04:31,611 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:04:31,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:04:31,709 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:04:36,241 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:04:36,241 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:04:36,245 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:04:36,246 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:04:36,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:36,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:40,972 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:04:41,790 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:04:54,976 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:04:54,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:55,087 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:04:59,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:00,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:00,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:05:01,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:05:01,045 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:05:04,230 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:05:04,232 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:05:05,653 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:05:05,657 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:05:05,663 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:05:05,665 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:05:05,667 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:05:05,669 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:05:05,670 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:05:05,673 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:05:05,675 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:05:05,677 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:05:05,680 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:05:06,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:05:07,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:05:19,364 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:05:19,367 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:05:19,370 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:05:19,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:23,487 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:05:28,481 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:05:28,483 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:05:28,532 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:32,687 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:05:32,691 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:05:32,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:05:33,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:05:33,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:48,861 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:05:48,863 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:06:03,827 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:06:04,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:06:04,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:06:05,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:28,269 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:06:28,273 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:06:29,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:06:29,351 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:06:29,353 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:06:29,387 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:06:33,874 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:06:33,879 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:06:34,615 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:06:34,616 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:06:39,131 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 14:06:39,132 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:06:40,180 - ispa_next.main - DEBUG - Found new Appointment: R-VT 442
2025-11-17 14:06:40,183 - ispa_next.main - DEBUG - 



2025-11-17 14:06:40,183 - ispa_next.main - DEBUG - starting with process 2 (R-VT 442) of 16
2025-11-17 14:06:40,188 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:06:41,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:06:43,338 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:06:43,339 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 14:06:45,382 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:06:45,384 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:07:32,462 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:07:44,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:45,059 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:07:45,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:46,545 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:07:46,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:46,648 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:07:47,027 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:07:47,030 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:07:50,162 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:07:50,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:07:52,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:07:54,032 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:07:54,210 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:07:57,488 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:07:57,621 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:07:57,624 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:58,923 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:08:11,409 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:08:12,416 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:08:12,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:12,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:28,178 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:08:38,481 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:08:38,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:38,584 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:08:38,586 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:08:38,716 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:08:38,905 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:08:40,385 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:08:40,665 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:08:44,788 - ispa_next.functions - DEBUG - Updated appointment (AA00026230) customer contact data.
2025-11-17 14:08:45,735 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:08:45,738 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:08:46,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:08:46,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:08:48,836 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:08:48,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:08:48,964 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:08:53,583 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:08:53,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:54,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:08:56,142 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:08:56,289 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:08:56,412 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:08:56,537 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:08:56,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:08:59,366 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:09:11,314 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:09:19,127 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:09:19,128 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:21,839 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:09:26,054 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:09:27,061 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:09:27,062 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:09:27,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:27,244 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:09:31,470 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:09:31,475 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:09:31,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:31,637 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:09:41,924 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 14:09:49,011 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-17 14:09:58,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:58,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:58,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:59,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:09:59,562 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:10:02,175 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:10:02,177 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:10:03,778 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:10:03,781 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:10:03,784 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:10:03,794 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:10:03,798 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:10:03,799 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:10:03,801 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:10:03,812 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:10:03,815 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:10:03,819 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:10:03,833 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:10:04,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:10:05,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:10:17,794 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:10:17,797 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:10:17,799 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:10:17,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:21,185 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:10:21,188 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:10:21,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:24,452 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:10:24,455 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:10:24,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:10:24,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:10:25,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:37,866 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:10:37,868 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:10:53,786 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:10:54,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:10:54,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:10:55,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:29,865 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:35,576 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:40,937 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:46,259 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:46,261 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:11:46,262 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:11:47,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:11:47,242 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:11:47,243 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:11:47,272 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:11:51,459 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:11:51,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:11:52,199 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:11:52,202 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:11:57,135 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 14:11:57,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:11:58,111 - ispa_next.main - DEBUG - 



2025-11-17 14:11:58,111 - ispa_next.main - DEBUG - starting with process 3 (HEF-J 187) of 16
2025-11-17 14:11:58,115 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:11:59,483 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:12:00,946 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:12:00,947 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 14:12:02,835 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:12:02,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:12:50,244 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:13:01,932 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:04,538 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:13:04,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:04,651 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:13:04,896 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:13:04,899 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:13:07,896 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:13:07,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:09,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:13:11,272 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:13:11,479 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:13:14,726 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:13:14,858 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:13:14,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:17,530 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:13:29,729 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:13:30,735 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:13:30,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:31,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:47,355 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:13:57,386 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:13:57,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:57,532 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:13:57,533 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:13:57,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:13:59,044 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:14:00,325 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:14:00,541 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:14:04,778 - ispa_next.functions - DEBUG - Updated appointment (AA00026226) customer contact data.
2025-11-17 14:14:05,711 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:14:05,717 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:14:06,803 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:14:06,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:14:07,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:14:11,429 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:14:11,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:14:11,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:14:13,949 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:14:14,092 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:14:14,268 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:14:14,397 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:14:14,398 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:17,139 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:14:29,261 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:15:29,265 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:15:40,334 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:15:48,091 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:15:48,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:50,774 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:15:54,989 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:15:56,008 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:15:56,012 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:15:56,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:56,144 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:16:00,336 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:16:01,564 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:16:14,004 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:16:14,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:14,131 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:16:18,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:19,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:16:19,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:16:20,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:16:20,085 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:16:22,632 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:16:22,634 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:16:23,819 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:16:23,819 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:16:23,821 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:16:23,822 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:16:23,824 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:16:23,825 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:16:23,826 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:16:23,828 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:16:23,829 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:16:23,830 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:16:23,836 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:16:24,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:16:25,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:16:37,227 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:16:37,233 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:16:37,236 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:16:37,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:40,660 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:16:40,663 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:16:40,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:44,064 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:16:44,066 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:16:44,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:16:44,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:16:44,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:53,281 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:16:53,283 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:17:09,054 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:17:09,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:17:10,219 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:17:10,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:44,107 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:17:49,882 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:17:56,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:03,311 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:18:03,315 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:18:03,316 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:18:04,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:18:04,443 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:18:04,445 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:18:04,475 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:18:08,662 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:18:08,668 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:18:09,316 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:18:09,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:18:13,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 14:18:13,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:18:14,636 - ispa_next.main - DEBUG - 



2025-11-17 14:18:14,636 - ispa_next.main - DEBUG - starting with process 4 (HEF-MD 547) of 16
2025-11-17 14:18:14,640 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:18:16,560 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:18:18,341 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:18:18,343 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 14:18:20,562 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:18:20,564 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:19:10,101 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:19:22,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:22,714 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:19:22,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:24,319 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:19:24,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:24,433 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:19:24,894 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:19:24,897 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:19:28,096 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:19:28,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:29,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:19:31,866 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:19:31,998 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:19:35,273 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:19:35,473 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:19:35,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:37,002 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:19:49,353 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:19:50,359 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:19:50,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:50,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:04,456 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:20:13,936 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:20:13,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:14,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:20:14,050 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:20:14,109 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:20:14,314 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:20:15,675 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 14:20:17,081 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 14:20:17,556 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:20:21,234 - ispa_next.functions - DEBUG - Updated appointment (AA00026220) customer contact data.
2025-11-17 14:20:22,222 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:20:22,226 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:20:22,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:20:23,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:20:25,738 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:20:25,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:20:25,910 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:20:29,769 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:20:29,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:20:30,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:20:32,293 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:20:32,459 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:20:32,639 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:20:32,764 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:20:32,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:34,772 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:20:45,992 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:20:54,017 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:20:54,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:56,080 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:21:00,354 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:21:01,363 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:21:01,364 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:21:01,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:01,566 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:21:05,768 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:21:05,774 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:21:05,774 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 14:21:05,775 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:21:07,730 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:21:07,732 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:21:08,976 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:21:08,978 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:21:08,979 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:21:08,980 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:21:08,982 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:21:08,983 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:21:08,984 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:21:08,988 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:21:08,992 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:21:08,997 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:21:09,011 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:21:09,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:21:10,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:21:21,944 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:21:21,947 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:21:21,949 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:21:21,949 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:24,693 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:21:24,696 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:21:24,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:27,359 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:21:27,362 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:21:27,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:21:27,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:21:28,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:39,919 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:21:39,923 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:21:56,672 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:21:57,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:21:57,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:21:58,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:26,045 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:22:31,685 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:22:37,910 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:22:37,913 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:22:37,914 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:22:38,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:22:39,092 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:22:39,094 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:22:39,126 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:22:43,676 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:22:43,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:22:44,457 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:22:44,458 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:22:49,085 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 14:22:49,086 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:22:50,280 - ispa_next.main - DEBUG - 



2025-11-17 14:22:50,280 - ispa_next.main - DEBUG - starting with process 5 (ROF-PG 72) of 16
2025-11-17 14:22:50,289 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:22:52,506 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:22:54,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:22:54,390 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 14:22:56,547 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:22:56,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:23:45,340 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:23:58,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:59,661 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:23:59,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:59,765 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:24:00,106 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:24:00,109 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:24:03,314 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:24:03,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:04,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:24:06,824 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:24:06,977 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:24:10,284 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:24:10,420 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:24:14,642 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:24:15,652 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:24:15,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:16,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:31,294 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:24:41,384 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:24:41,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:41,506 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:24:41,507 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:24:41,557 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:24:43,038 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:24:43,250 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:24:48,029 - ispa_next.functions - DEBUG - Updated appointment (AA00026211) customer contact data.
2025-11-17 14:24:48,955 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:24:48,957 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:24:50,375 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:24:50,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:24:51,863 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:24:55,518 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:24:55,518 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:24:55,525 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:24:55,527 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:24:55,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:56,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:00,302 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:25:00,307 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:25:00,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:00,474 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:25:04,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:05,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:05,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:06,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:06,261 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:25:07,655 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:25:07,659 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:25:09,124 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:25:09,125 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:25:09,127 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:25:09,128 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:25:09,130 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:25:09,131 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:25:09,133 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:25:09,134 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:25:09,135 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:25:09,137 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:25:09,139 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:25:09,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:25:10,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:25:23,316 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:25:23,318 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:25:23,321 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:25:23,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:25,294 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:25:25,297 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:25:25,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:27,267 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:25:27,270 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:25:27,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:25:27,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:25:28,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:34,536 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:25:34,539 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:25:50,220 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:25:50,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:25:51,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:25:51,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:12,891 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:26:18,904 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:26:18,906 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:26:18,907 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:26:19,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:26:19,798 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:26:19,800 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:26:19,848 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:26:24,025 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:26:24,028 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:24,690 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:26:24,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:29,485 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 14:26:29,486 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:26:30,863 - ispa_next.main - DEBUG - 



2025-11-17 14:26:30,864 - ispa_next.main - DEBUG - starting with process 6 (HEF-PB 588) of 16
2025-11-17 14:26:30,869 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:26:32,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:26:34,752 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:26:34,754 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 14:26:36,742 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:26:36,745 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:15,754 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:27:28,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:28,938 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:27:29,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:27:31,240 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:27:31,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:27:31,341 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:27:31,801 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:27:31,805 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:27:35,040 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:27:35,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:27:36,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:27:38,840 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:27:47,682 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 14:27:58,251 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 14:27:59,258 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:27:59,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:00,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:06,404 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:28:06,409 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:28:06,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:06,514 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:28:06,514 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:28:06,613 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:28:06,826 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:28:08,221 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:28:08,434 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:28:12,851 - ispa_next.functions - DEBUG - Updated appointment (AB00024172) customer contact data.
2025-11-17 14:28:13,801 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:28:13,807 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:28:14,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:28:15,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:28:17,502 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:28:17,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:28:17,668 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:28:21,422 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:28:21,422 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:28:21,431 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:28:21,432 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:28:21,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:21,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:26,200 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:28:26,205 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:28:26,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:26,313 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:28:26,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:27,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:27,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:28,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:28,155 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:28:30,741 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:28:30,743 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:28:32,170 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:28:32,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:32,178 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:28:32,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:32,190 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:28:32,194 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:28:32,196 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:28:32,197 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:28:32,209 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:28:32,229 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:28:32,238 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:28:32,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:28:33,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:28:46,347 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:28:46,351 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:28:46,353 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:28:46,353 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:49,842 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:28:49,844 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:28:49,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:53,208 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:28:53,210 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:28:53,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:28:53,749 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:28:53,848 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:28:53,850 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:29:09,740 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:29:10,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:29:10,873 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:29:11,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:43,873 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:29:49,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:29:54,367 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:30:00,547 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:30:00,550 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:30:00,551 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:30:01,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:30:01,714 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:30:01,716 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:30:01,750 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:30:06,588 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:30:06,594 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:30:07,366 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:30:07,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:30:11,528 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 14:30:11,529 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:30:12,519 - ispa_next.main - DEBUG - 



2025-11-17 14:30:12,519 - ispa_next.main - DEBUG - starting with process 7 (HEF-M 726) of 16
2025-11-17 14:30:12,524 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:30:14,030 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:30:15,877 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:30:15,878 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 14:30:17,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:30:17,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:31:07,383 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:31:21,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:24,609 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:31:24,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:24,730 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:25,130 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 14:31:35,114 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:31:35,118 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:31:38,339 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:31:38,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:40,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:42,066 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:31:42,243 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:31:42,468 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:31:42,575 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:31:42,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:46,113 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:31:57,152 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:32:05,116 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:32:05,118 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:32:09,384 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:32:13,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:32:14,614 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:32:14,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:15,151 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:30,961 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:32:30,961 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:32:41,703 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:32:41,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:41,858 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:32:41,859 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:32:41,950 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:32:43,480 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:32:43,713 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:32:48,450 - ispa_next.functions - DEBUG - Updated appointment (AB00024171) customer contact data.
2025-11-17 14:32:49,404 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:32:49,406 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:32:51,328 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:32:51,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:32:52,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:32:56,263 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:32:56,263 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:32:56,267 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:32:56,267 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:32:56,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:56,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:33:01,044 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:33:02,276 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:33:14,392 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:33:14,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:14,556 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:33:14,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:15,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:15,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:16,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:33:16,482 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:33:20,166 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:33:20,170 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:33:21,603 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:33:21,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:33:21,620 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:33:21,621 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:33:21,623 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:33:21,624 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:33:21,626 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:33:21,628 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:33:21,630 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:33:21,632 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:33:21,635 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:33:22,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:33:23,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:33:35,158 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:33:35,161 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:33:35,163 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:33:35,165 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:39,950 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:33:39,952 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:33:39,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:44,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:45,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:33:58,197 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:33:58,200 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:33:58,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:33:59,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:33:59,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:13,090 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:34:13,092 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:34:28,228 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:34:28,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:34:29,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:34:29,529 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:17,297 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:23,160 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:29,623 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:36,734 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:43,193 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:49,720 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:49,723 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:35:49,724 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:35:50,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:35:50,894 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:35:50,896 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:35:50,926 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:35:56,428 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:35:56,431 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:35:57,302 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:35:57,304 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:36:02,529 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 14:36:02,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:36:04,270 - ispa_next.main - DEBUG - 



2025-11-17 14:36:04,271 - ispa_next.main - DEBUG - starting with process 8 (HEF-AB 332) of 16
2025-11-17 14:36:04,276 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:36:06,274 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:36:08,223 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:36:08,225 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 14:36:10,353 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:36:10,355 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:36:55,359 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:37:07,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:08,104 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:37:08,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:09,676 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:37:09,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:09,763 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:37:10,130 - ispa_next.functions - DEBUG - HU date already expired after 726 days.
2025-11-17 14:37:19,728 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:37:19,732 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:37:22,849 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:37:22,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:37:24,687 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:37:26,693 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:37:35,232 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 14:37:44,216 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 14:37:45,247 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:37:45,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:45,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:01,064 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:38:10,574 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:38:10,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:10,685 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:38:10,686 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:38:10,747 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:38:10,951 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:38:12,383 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:38:12,629 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:38:17,266 - ispa_next.functions - DEBUG - Updated appointment (AB00024164) customer contact data.
2025-11-17 14:38:18,283 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:38:18,288 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:38:19,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:38:20,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:38:21,714 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:38:21,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:38:21,847 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:38:26,311 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:38:26,311 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:38:26,440 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:38:26,442 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:38:26,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:26,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:38:31,164 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:38:31,170 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:38:31,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:31,284 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:38:31,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:32,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:38:32,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:38:33,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:38:33,129 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:38:35,669 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:38:35,674 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:38:37,309 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:38:37,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:38:37,313 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:38:37,314 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:38:37,316 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:38:37,317 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:38:37,318 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:38:37,320 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:38:37,327 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:38:37,331 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:38:37,335 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:38:38,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:38:39,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:38:51,530 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:38:51,533 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:38:51,535 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:38:51,535 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:54,946 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:38:54,948 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:38:54,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:38:58,264 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:38:58,267 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:38:58,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:38:58,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:38:58,899 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:38:58,902 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:39:14,549 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:39:15,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:39:15,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:39:15,877 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:49,640 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:39:55,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:02,108 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:08,624 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:08,627 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:40:08,627 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:40:09,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:40:09,696 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:40:09,697 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:40:09,727 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:40:14,255 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 14:40:14,258 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:40:15,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:40:15,010 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:40:19,904 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 14:40:19,906 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:40:21,221 - ispa_next.main - DEBUG - 



2025-11-17 14:40:21,221 - ispa_next.main - DEBUG - starting with process 9 (HEF-XX 99) of 16
2025-11-17 14:40:21,235 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:40:23,201 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:40:25,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:40:25,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 14:40:27,674 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:40:27,675 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:41:12,709 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:41:25,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:25,986 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:41:26,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:41:27,493 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:41:27,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:27,623 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:41:28,009 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:41:28,012 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:41:31,132 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:41:31,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:41:32,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:41:34,971 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:41:35,147 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:41:38,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:41:38,551 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:41:38,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:41:39,837 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:41:51,952 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:41:52,958 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:41:52,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:53,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:08,822 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:42:19,121 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:42:19,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:19,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:42:19,241 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:42:19,304 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:42:20,780 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:42:20,987 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:42:26,262 - ispa_next.functions - DEBUG - Updated appointment (AB00024160) customer contact data.
2025-11-17 14:42:27,236 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:42:27,239 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:42:28,709 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:42:28,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:42:29,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:42:33,476 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:42:33,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:42:34,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:42:36,027 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:42:36,176 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:42:36,339 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:42:36,507 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:42:36,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:37,752 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:42:49,899 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:43:49,902 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:44:00,930 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:44:08,757 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:44:08,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:10,057 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:44:14,286 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:44:15,296 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:44:15,297 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:44:15,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:15,448 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:44:19,662 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:44:19,668 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:44:19,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:19,819 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:44:24,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:24,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:24,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:25,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:25,559 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:44:27,049 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:44:27,052 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:44:28,320 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:44:28,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:44:28,328 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:44:28,331 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:44:28,332 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:44:28,334 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:44:28,335 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:44:28,336 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:44:28,338 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:44:28,339 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:44:28,342 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:44:29,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:44:29,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:44:42,778 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:44:42,780 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:44:42,782 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:44:42,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:44,743 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:44:44,745 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:44:44,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:46,705 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:44:46,708 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:44:46,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:44:47,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:44:47,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:55,579 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:44:55,581 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:45:10,473 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:45:10,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:45:11,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:45:11,747 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:45:31,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:45:37,411 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:45:37,414 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:45:37,414 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:45:38,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:45:38,514 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:45:38,516 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:45:38,549 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:45:43,089 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 14:45:43,093 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:45:43,880 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:45:43,881 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:45:48,617 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 14:45:48,618 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:45:49,955 - ispa_next.main - DEBUG - 



2025-11-17 14:45:49,956 - ispa_next.main - DEBUG - starting with process 10 (ROF-NR 1) of 16
2025-11-17 14:45:49,961 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:45:51,871 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:45:53,832 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 14:45:53,834 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 14:45:55,967 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:45:55,969 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:46:44,839 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:46:58,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:46:58,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:46:58,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:00,070 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:47:00,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:00,216 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:47:00,633 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:47:00,636 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:47:03,768 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:47:03,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:47:05,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:47:07,484 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:47:07,672 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:47:10,924 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:47:11,050 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:47:11,052 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:47:12,276 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:47:24,780 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:47:25,786 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:47:25,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:26,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:41,336 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:47:41,336 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:47:51,775 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:47:51,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:51,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:47:51,925 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:47:52,029 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:47:53,475 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:47:53,683 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:47:58,542 - ispa_next.functions - DEBUG - Updated appointment (AB00024157) customer contact data.
2025-11-17 14:47:59,525 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:47:59,528 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:48:01,656 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:48:01,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:48:02,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:48:06,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:48:06,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:48:07,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:48:09,087 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:48:09,234 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:48:09,367 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:48:09,514 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:48:09,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:10,760 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:48:21,836 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:48:29,359 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:48:29,360 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:30,717 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:48:34,972 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:48:35,993 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:48:35,995 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:48:35,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:48:36,094 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:48:40,315 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:48:40,320 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:48:40,320 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 14:48:40,321 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:48:41,749 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:48:41,751 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:48:42,992 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:48:42,994 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:48:42,996 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:48:42,997 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:48:42,999 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:48:43,002 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:48:43,005 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:48:43,017 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:48:43,018 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:48:43,020 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:48:43,021 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:48:43,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:48:44,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:48:57,149 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:48:57,151 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:48:57,154 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:48:57,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:59,161 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:48:59,163 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:48:59,168 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:01,099 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:49:01,101 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:49:01,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:49:01,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:49:02,172 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:11,399 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:49:11,403 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:49:27,190 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:49:27,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:49:28,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:49:28,765 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:50,738 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:49:57,256 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:49:57,258 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:49:57,260 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:49:58,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:49:58,393 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:49:58,395 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:49:58,443 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:50:03,215 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 14:50:03,219 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:50:03,970 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 14:50:03,971 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:50:09,181 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 14:50:09,182 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:50:10,441 - ispa_next.appointments.models - DEBUG - Appointment Rudolf Hollstein HEF-HR 949 WBA6S110907G75586 ohne Termin.
2025-11-17 14:50:10,454 - ispa_next.main - DEBUG - 



2025-11-17 14:50:10,454 - ispa_next.main - DEBUG - starting with process 11 (SM-J 9876 E) of 16
2025-11-17 14:50:10,458 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:50:12,442 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:50:14,427 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 14:50:14,429 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 14:50:16,975 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:50:16,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:51:08,974 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:51:22,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:26,965 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:51:26,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:51:27,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:51:27,411 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:51:27,414 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:51:30,570 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:51:30,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:51:32,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:51:34,362 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:51:34,530 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:51:34,718 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:51:34,838 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:51:34,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:51:39,831 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:51:51,136 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:51:59,184 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:51:59,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:52:04,472 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:52:08,722 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:52:09,742 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:52:09,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:52:10,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:52:28,270 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:52:39,207 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:52:39,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:52:39,314 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:52:39,316 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:52:39,368 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:52:40,774 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:52:40,990 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:52:44,684 - ispa_next.functions - DEBUG - Updated appointment (AA00026206) customer contact data.
2025-11-17 14:52:45,669 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:52:45,671 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:52:47,194 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:52:47,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:52:48,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:52:52,721 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:52:52,721 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:52:52,725 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:52:52,726 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:52:52,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:52:53,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:52:57,439 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:52:57,444 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:52:57,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:52:57,549 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:53:07,092 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:53:17,146 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:53:17,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:53:18,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:53:18,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:53:19,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:53:19,216 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:53:23,565 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:53:23,571 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:53:25,160 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:53:25,166 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:53:25,169 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:53:25,171 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:53:25,173 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:53:25,175 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:53:25,176 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:53:25,177 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:53:25,179 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:53:25,180 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:53:25,183 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:53:25,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:53:27,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:54:02,409 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-17 14:54:02,556 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:54:02,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:54:03,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:54:05,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:54:05,048 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 14:54:05,090 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:54:10,025 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 14:54:10,030 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:54:10,766 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 14:54:10,768 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:15,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 14:54:15,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:54:16,824 - ispa_next.appointments.models - DEBUG - Appointment Rudolf Hollstein HEF-HR 949 WBA6S110907G75586 ohne Termin.
2025-11-17 14:54:16,836 - ispa_next.main - DEBUG - 



2025-11-17 14:54:16,836 - ispa_next.main - DEBUG - starting with process 12 (HEF-DK 975) of 16
2025-11-17 14:54:16,840 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:54:18,684 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:54:20,703 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 14:54:20,705 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 14:54:22,872 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:22,874 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:55:14,732 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:55:27,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:28,330 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:55:28,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:28,449 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:28,712 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:55:28,715 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:55:31,713 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:55:31,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:55:33,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:55:35,658 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:55:35,819 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:55:39,106 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:55:39,221 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:55:39,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:40,504 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:55:53,046 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:55:54,052 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:55:54,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:54,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:09,807 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:56:20,517 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:56:20,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:56:20,685 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:56:20,687 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:56:20,779 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:56:20,953 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:56:22,375 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:56:22,604 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:56:26,235 - ispa_next.functions - DEBUG - Updated appointment (AA00026205) customer contact data.
2025-11-17 14:56:27,263 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:56:27,282 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:56:28,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:56:29,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:56:31,422 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:56:31,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:56:31,925 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:56:36,072 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:56:36,072 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:56:36,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:36,596 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:56:38,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:56:38,750 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:56:38,921 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:56:39,069 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:56:39,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:56:41,106 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:56:53,458 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:57:53,461 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:58:05,675 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:58:15,678 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:58:27,696 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:58:39,027 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:58:40,034 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:58:40,034 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:58:40,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:58:40,122 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:58:44,311 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:58:44,315 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:58:44,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:58:44,437 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:58:53,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:58:54,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:58:54,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:58:55,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:58:55,534 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:58:57,478 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:58:57,481 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:58:58,930 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:58:58,931 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:58:58,933 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 14:58:58,934 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:58:58,936 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:58:58,938 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:58:58,940 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:58:58,943 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:58:58,946 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:58:58,949 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:58:58,953 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:58:59,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:59:00,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:59:13,112 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:59:13,114 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:59:13,117 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:59:13,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:59:15,755 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:59:15,758 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:59:15,765 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:59:18,408 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:59:18,410 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:59:18,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:59:19,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:59:19,101 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:59:19,103 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:59:34,339 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:59:34,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:59:35,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:59:35,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:00:03,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:00:10,825 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:00:19,038 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:00:19,040 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:00:19,041 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:00:20,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:00:20,207 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:00:20,209 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:00:20,240 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:00:25,845 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 15:00:25,848 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:00:26,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:00:26,704 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:00:31,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 15:00:31,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:00:32,917 - ispa_next.appointments.models - DEBUG - Appointment Rudolf Hollstein HEF-HR 949 WBA6S110907G75586 ohne Termin.
2025-11-17 15:00:32,930 - ispa_next.main - DEBUG - 



2025-11-17 15:00:32,930 - ispa_next.main - DEBUG - starting with process 13 (WAK-UA 777) of 16
2025-11-17 15:00:32,936 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:00:34,673 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:00:36,726 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:00:36,728 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 15:00:39,772 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:00:39,774 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:01:31,554 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:01:45,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:01:49,996 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:01:49,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:01:50,091 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:01:50,559 - ispa_next.functions - DEBUG - HU date already expired after 4 days.
2025-11-17 15:02:01,548 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:02:01,551 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:02:04,545 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:02:04,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:02:06,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:02:08,197 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:02:08,373 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:02:08,580 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:02:08,689 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:02:08,692 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:02:13,010 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:02:25,841 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:02:26,846 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:02:26,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:27,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:45,081 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:02:55,826 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:02:55,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:02:55,952 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:02:55,953 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:02:56,029 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:02:56,316 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:02:57,828 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:02:58,062 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:03:01,059 - ispa_next.functions - DEBUG - Updated appointment (AG00006941) customer contact data.
2025-11-17 15:03:02,031 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:03:02,035 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:03:02,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:03:03,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:03:06,013 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:03:06,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:03:06,764 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:03:10,405 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:03:10,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:03:10,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:03:12,950 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:03:13,149 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:03:13,363 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:03:13,520 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:03:13,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:18,498 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:03:30,908 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:04:30,911 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:04:43,469 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:04:54,461 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:04:55,469 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:04:55,470 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:04:55,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:55,576 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:04:59,746 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:04:59,750 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:04:59,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:04:59,870 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:05:00,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:00,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:00,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:05:01,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:05:01,637 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:05:06,018 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:05:06,020 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:05:07,436 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:05:07,440 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:05:07,444 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 15:05:07,446 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:05:07,448 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:05:07,449 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:05:07,451 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:05:07,452 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:05:07,453 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:05:07,456 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:05:07,458 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:05:08,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:05:09,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:05:22,734 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:05:22,738 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:05:22,740 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:05:22,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:28,305 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:05:28,308 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:05:28,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:33,856 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:05:33,858 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:05:33,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:05:34,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:05:34,661 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:05:34,664 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:05:51,634 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:05:52,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:05:52,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:05:53,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:06:49,023 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:06:56,731 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:03,942 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:10,695 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:18,834 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:25,016 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:31,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:07:31,102 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:07:31,103 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:07:31,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:07:32,069 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:07:32,071 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:07:32,097 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:07:37,122 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 15:07:37,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:07:38,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:07:38,091 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:07:44,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 15:07:44,333 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:07:45,855 - ispa_next.main - DEBUG - Found new Appointment: HEF-HR 949
2025-11-17 15:07:45,857 - ispa_next.main - DEBUG - 



2025-11-17 15:07:45,857 - ispa_next.main - DEBUG - starting with process 14 (HEF-HR 949) of 17
2025-11-17 15:07:45,863 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:07:48,015 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:07:49,727 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:07:49,729 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 15:07:51,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:07:51,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:08:41,437 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:08:55,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:08:55,572 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:08:55,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:08:57,109 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:08:57,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:08:57,263 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:08:57,661 - ispa_next.functions - DEBUG - HU date already expired after 787 days.
2025-11-17 15:09:08,071 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:09:08,075 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:09:11,285 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:09:11,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:09:13,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:09:15,444 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:09:15,654 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:09:18,917 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:09:19,080 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:09:19,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:09:20,344 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:09:32,457 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:09:33,463 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:09:33,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:34,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:09:50,494 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:09:50,495 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:10:02,064 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:10:02,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:10:02,215 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:10:02,216 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:10:02,318 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:10:02,492 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:10:03,921 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:10:04,152 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:10:09,076 - ispa_next.functions - DEBUG - Updated appointment (AA00026232) customer contact data.
2025-11-17 15:10:10,046 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:10:10,049 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:10:10,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:10:11,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:10:13,873 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:10:14,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:10:14,690 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:10:19,295 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:10:19,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:10:20,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:10:22,548 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:10:22,715 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:10:22,891 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:10:23,046 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:10:23,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:10:25,878 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:10:38,318 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:11:38,320 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:11:49,651 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:11:57,737 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:11:57,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:00,445 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:12:04,711 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:12:05,731 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:12:05,732 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:12:05,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:05,851 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:10,023 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:12:10,028 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:12:10,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:10,122 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:12:10,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:11,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:11,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:12,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:12,000 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:12:14,605 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:12:14,607 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:12:16,043 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:12:16,044 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:16,046 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 15:12:16,047 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:12:16,049 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:12:16,050 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:12:16,051 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:12:16,052 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:12:16,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:12:16,059 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:12:16,063 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:12:16,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:12:17,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:12:31,512 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:12:31,515 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:12:31,517 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:12:31,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:35,074 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:12:35,077 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:12:35,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:38,364 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:12:38,377 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:12:38,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:12:39,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:12:39,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:12:50,539 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:12:50,541 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:13:07,003 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:13:07,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:13:08,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:13:08,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:13:43,221 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:13:49,286 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:13:55,145 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:01,198 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:14:01,200 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:14:01,201 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:14:02,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:14:02,224 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:14:02,226 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:14:02,251 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:14:07,018 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 15:14:07,021 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:14:07,809 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:14:07,812 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:14:13,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 15:14:13,711 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:14:15,064 - ispa_next.main - DEBUG - 



2025-11-17 15:14:15,064 - ispa_next.main - DEBUG - starting with process 15 (HEF-XD 11) of 17
2025-11-17 15:14:15,069 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:14:17,089 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:14:19,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:14:19,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 15:14:21,007 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:14:21,008 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:15:07,095 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:15:22,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:15:24,162 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:15:24,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:15:24,257 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:15:24,724 - ispa_next.functions - DEBUG - HU date soon to be invalid in 36 days.
2025-11-17 15:15:35,507 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:15:35,511 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:15:38,751 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:15:38,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:15:40,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:15:42,948 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:15:52,548 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 15:16:03,151 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 15:16:04,164 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:16:04,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:04,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:20,361 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:16:20,361 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:16:31,686 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:16:31,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:31,822 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:31,823 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:16:31,907 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:16:32,085 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:16:33,658 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:16:33,948 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:16:36,975 - ispa_next.functions - DEBUG - Updated appointment (AG00006940) customer contact data.
2025-11-17 15:16:37,920 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:16:37,923 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:16:38,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:16:39,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:16:42,224 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:16:42,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:16:42,906 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:16:47,089 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:16:47,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:16:47,090 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:16:47,093 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:16:47,094 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:16:47,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:16:47,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:16:51,944 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:16:51,957 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:16:51,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:16:52,053 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:16:52,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:53,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:53,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:16:54,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:16:54,010 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:16:56,617 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:16:56,622 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:16:58,588 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:16:58,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:16:58,602 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 15:16:58,607 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:16:58,610 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:16:58,612 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:16:58,613 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:16:58,627 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:16:58,629 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:16:58,634 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:16:58,637 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:16:59,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:17:00,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:17:13,916 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:17:13,919 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:17:13,922 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:17:13,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:17,392 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:17:17,395 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:17:17,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:20,862 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:17:20,866 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:17:20,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:17:21,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:17:21,822 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:17:21,826 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:17:37,783 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:17:38,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:17:39,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:17:39,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:18:13,673 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:21,531 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:28,159 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:35,044 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:18:35,047 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:18:35,048 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:18:35,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:18:36,111 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:18:36,113 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:18:36,144 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:18:40,984 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 15:18:40,987 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:18:41,631 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:18:41,633 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:18:46,733 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 15:18:46,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:18:47,862 - ispa_next.main - DEBUG - 



2025-11-17 15:18:47,863 - ispa_next.main - DEBUG - starting with process 16 (HEF-XY 80) of 17
2025-11-17 15:18:47,868 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:18:49,475 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:18:51,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:18:51,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 15:18:53,192 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:18:53,194 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:19:39,472 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:19:54,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:59,255 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:19:59,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:59,433 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:19:59,841 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:19:59,845 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:20:03,270 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:20:03,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:20:05,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:20:07,152 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:20:07,323 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:20:07,512 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:20:07,701 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:20:07,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:12,914 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:20:24,376 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:20:32,650 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:20:32,653 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:37,828 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:20:42,148 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:20:43,179 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:20:43,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:20:43,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:00,695 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:21:00,695 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:21:12,325 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:21:12,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:12,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:12,488 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:21:12,551 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:21:14,010 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:21:14,239 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:21:18,426 - ispa_next.functions - DEBUG - Updated appointment (AE00013897) customer contact data.
2025-11-17 15:21:19,360 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:21:19,384 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:21:20,999 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:21:21,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:21:23,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:21:27,051 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:21:27,051 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:21:27,056 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:21:27,057 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:21:27,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:27,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:21:31,832 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:21:33,055 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:21:45,842 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:21:45,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:46,003 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:21:50,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:50,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:50,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:51,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:21:51,850 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:21:56,246 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:21:56,250 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:21:57,973 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:21:57,975 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:21:57,978 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 15:21:57,982 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:21:57,985 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:21:57,993 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:21:58,004 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:21:58,006 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:21:58,008 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:21:58,012 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:21:58,017 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:21:58,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:22:00,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:22:13,819 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:22:13,824 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:22:13,827 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:22:13,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:19,440 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:22:19,442 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:22:19,444 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:25,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:22:25,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:36,341 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:22:36,345 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:22:36,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:22:38,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:22:38,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:50,803 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:22:50,806 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:23:09,213 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:23:09,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:23:10,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:23:10,954 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:05,947 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:14,693 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:21,500 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:29,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:36,656 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:43,243 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:49,623 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:24:49,626 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:24:49,626 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:24:50,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:24:50,606 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:24:50,608 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:24:50,636 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:24:56,467 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 15:24:56,472 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:24:57,335 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:24:57,337 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:25:03,405 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 15:25:03,406 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:25:04,727 - ispa_next.main - DEBUG - 



2025-11-17 15:25:04,728 - ispa_next.main - DEBUG - starting with process 17 (HEF-SM 9) of 17
2025-11-17 15:25:04,733 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:25:06,799 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:25:08,980 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:25:08,982 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 104
2025-11-17 15:25:11,315 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:25:11,317 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:25:55,477 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:26:10,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:11,344 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:26:11,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:26:11,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:26:11,872 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:26:11,876 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:26:15,079 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:26:15,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:26:16,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:26:18,760 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:26:18,886 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:26:22,160 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:26:22,299 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:26:22,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:23,602 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:26:35,854 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:26:36,860 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:26:36,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:26:37,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:26:54,921 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:26:54,921 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:27:05,077 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:27:05,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:05,204 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:05,205 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:27:05,253 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:27:05,423 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:27:06,702 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:27:06,924 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:27:11,925 - ispa_next.functions - DEBUG - Updated appointment (AA00026192) customer contact data.
2025-11-17 15:27:12,834 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:27:12,837 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:27:13,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:27:14,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:27:16,525 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:27:16,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:27:16,758 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:27:20,611 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:27:20,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:27:21,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:27:23,138 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:27:23,319 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:27:23,450 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:27:23,579 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:27:23,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:25,662 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:27:37,789 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:28:37,805 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:28:49,271 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:28:57,032 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:28:57,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:59,070 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:29:03,452 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:29:04,461 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:29:04,462 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:29:04,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:04,598 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:29:08,828 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:29:08,834 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:29:08,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:08,937 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:29:13,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:13,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:13,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:14,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:29:14,711 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:29:16,754 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:29:16,756 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:29:18,210 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:29:18,212 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:29:18,215 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 15:29:18,216 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:29:18,218 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:29:18,219 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:29:18,220 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:29:18,221 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:29:18,222 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:29:18,224 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:29:18,227 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:29:18,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:29:20,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:29:33,222 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:29:33,225 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:29:33,227 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:29:33,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:35,934 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:29:35,936 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:29:35,938 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:38,593 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:29:38,595 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:29:38,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:29:39,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:29:39,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:55,748 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:29:55,751 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:30:11,536 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:30:12,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:30:13,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:30:13,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:41,856 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:30:48,584 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:30:55,936 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:30:55,939 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:30:55,940 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:30:57,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:30:57,151 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:30:57,154 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 15:30:57,211 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:31:02,746 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 15:31:02,752 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:31:03,545 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 15:31:03,546 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:31:08,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 104
2025-11-17 15:31:08,719 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
