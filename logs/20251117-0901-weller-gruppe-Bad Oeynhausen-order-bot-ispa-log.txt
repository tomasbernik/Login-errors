2025-11-17 09:08:24,972 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:08:24,989 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:08:36,015 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:08:48,674 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:09:04,554 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:11:06,078 - ispa_next.app_start.main - DEBUG - Operation already took 110.09 seconds (more than 80 seconds)
2025-11-17 09:11:08,171 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_30gr6o9a_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_30gr6o9a', 'txt']
2025-11-17 09:11:08,680 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:11:08,685 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:11:08,685 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:13:09,876 - ispa_next.app_start.main - DEBUG - Operation already took 108.87 seconds (more than 80 seconds)
2025-11-17 09:13:11,950 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_drhqkc2u_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_drhqkc2u', 'txt']
2025-11-17 09:13:12,249 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:13:12,254 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:13:16,312 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 09:13:26,989 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:13:38,489 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:13:54,372 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:15:55,925 - ispa_next.app_start.main - DEBUG - Operation already took 110.45 seconds (more than 80 seconds)
2025-11-17 09:15:58,017 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_d2uc2vzu_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_d2uc2vzu', 'txt']
2025-11-17 09:15:58,322 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:15:58,328 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:15:58,333 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:17:59,763 - ispa_next.app_start.main - DEBUG - Operation already took 109.04 seconds (more than 80 seconds)
2025-11-17 09:18:01,853 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_yrqu9yqj_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_yrqu9yqj', 'txt']
2025-11-17 09:18:02,179 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:18:02,183 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:18:06,258 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 09:18:17,928 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:18:28,464 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:18:44,311 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:20:46,041 - ispa_next.app_start.main - DEBUG - Operation already took 110.54 seconds (more than 80 seconds)
2025-11-17 09:20:48,135 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_eyspuqza_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_eyspuqza', 'txt']
2025-11-17 09:20:48,462 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:20:48,467 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:20:48,467 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:22:49,459 - ispa_next.app_start.main - DEBUG - Operation already took 108.53 seconds (more than 80 seconds)
2025-11-17 09:22:51,576 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_c2jodw5d_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_c2jodw5d', 'txt']
2025-11-17 09:22:51,883 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:22:51,888 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:22:55,937 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 09:23:05,458 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:23:18,081 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:23:34,011 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:25:33,768 - ispa_next.app_start.main - DEBUG - Operation already took 108.70 seconds (more than 80 seconds)
2025-11-17 09:25:35,854 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_1xxrw5r9_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_1xxrw5r9', 'txt']
2025-11-17 09:25:36,183 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:25:36,187 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:25:36,188 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:27:37,798 - ispa_next.app_start.main - DEBUG - Operation already took 109.21 seconds (more than 80 seconds)
2025-11-17 09:27:39,884 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_j0fbgqr__input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_j0fbgqr_', 'txt']
2025-11-17 09:27:40,259 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:27:40,263 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:27:44,271 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-17 09:27:53,339 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:28:05,682 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:28:21,501 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:30:22,115 - ispa_next.app_start.main - DEBUG - Operation already took 109.51 seconds (more than 80 seconds)
2025-11-17 09:30:24,197 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_jwtoo3ya_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fa89e4bd3c07107a\\tess_jwtoo3ya', 'txt']
2025-11-17 09:30:24,491 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:30:24,495 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:30:24,496 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:31:38,334 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:31:57,479 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:32:01,007 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:32:02,805 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:32:02,806 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 89
2025-11-17 09:32:06,114 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 73
2025-11-17 09:32:06,115 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:32:06,116 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:32:07,746 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:32:09,236 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:24,012 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:24,045 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:32:24,095 - ispa_next.main - DEBUG - Found 9 out of 17 appointments to process (configured limit: 15).
2025-11-17 09:32:24,095 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-17 09:32:24,096 - ispa_next.main - DEBUG - All appointments: MI-NL 86, MI-S 2871, MI-B 3297, HF-DB 2903, MI-ZW 472, MI-BS 1921, HFNU2969, HF-KT 524, mi mp 200
2025-11-17 09:32:24,099 - ispa_next.main - DEBUG - 



2025-11-17 09:32:24,099 - ispa_next.main - DEBUG - starting with process 1 (MI-NL 86) of 9
2025-11-17 09:32:24,104 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:32:25,617 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:32:27,258 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:32:27,259 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 73
2025-11-17 09:32:29,181 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:32:29,183 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:33:03,679 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:33:15,025 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:16,981 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:33:16,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:17,071 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:17,364 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:33:25,597 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:33:25,600 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:33:28,595 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:33:28,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:29,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:31,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:33:32,068 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:33:35,395 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:33:35,532 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:33:39,786 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:33:40,791 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:33:40,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:41,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:53,279 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:34:02,121 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:34:02,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:02,251 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:34:02,252 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:34:02,375 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:34:03,771 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:34:04,389 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:34:06,391 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:34:06,393 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:34:07,432 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:34:07,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:34:08,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:34:12,491 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:34:12,492 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:34:12,492 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:34:12,495 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:34:12,496 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:34:12,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:13,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:17,809 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:34:17,813 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:34:17,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:17,894 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:34:18,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:18,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:34:18,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:34:19,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:34:19,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:34:21,638 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:34:21,640 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:34:22,981 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:34:22,982 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:22,985 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-17 09:34:22,986 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:34:22,989 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:34:22,990 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:34:22,992 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:34:22,994 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:34:22,995 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:34:22,998 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:34:22,999 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:34:23,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:34:24,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:34:30,951 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:34:30,954 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:34:30,955 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:34:30,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:33,540 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:34:33,541 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:34:33,545 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:36,264 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:34:36,264 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:34:36,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:38,913 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:34:38,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:34:39,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:34:39,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:48,969 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:34:48,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:34:51,727 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:35:05,432 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:35:05,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:06,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:35:06,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:34,238 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:39,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:44,250 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:35:44,253 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:35:44,254 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:35:45,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:45,415 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:35:45,417 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:35:47,659 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:36:04,067 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:36:04,848 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:36:06,509 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:07,329 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:36:07,331 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:15,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 89
2025-11-17 09:36:15,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:36:17,832 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:36:17,839 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:36:17,845 - ispa_next.main - DEBUG - 



2025-11-17 09:36:17,845 - ispa_next.main - DEBUG - starting with process 2 (MI-S 2871) of 9
2025-11-17 09:36:17,848 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:36:19,400 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:21,061 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:36:21,063 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 89
2025-11-17 09:36:22,820 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:22,822 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:37:00,615 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:37:11,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:12,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:37:12,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:37:14,996 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:37:14,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:15,103 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:37:15,396 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:37:15,399 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:37:18,515 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:37:18,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:37:20,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:37:22,095 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:37:22,318 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:37:25,621 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:37:25,703 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:37:25,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:37:28,518 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:37:40,041 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:37:41,046 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:37:41,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:41,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:51,498 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 09:38:00,438 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:38:00,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:00,523 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:38:00,524 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:38:00,656 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:38:00,876 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:38:02,496 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:38:02,903 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:38:07,109 - ispa_next.functions - DEBUG - Updated appointment (AA00050618) customer contact data.
2025-11-17 09:38:08,060 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:38:08,061 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:38:08,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:38:09,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:38:10,900 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:38:10,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:38:11,087 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:38:14,745 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:38:14,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:38:15,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:38:17,220 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:38:17,355 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:38:17,475 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:38:17,560 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:38:17,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:21,178 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:38:33,011 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:39:33,015 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:39:44,916 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:39:52,937 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:39:52,938 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:39:59,443 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:40:02,624 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:40:05,952 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:40:10,342 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:40:11,350 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:40:11,351 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:40:11,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:11,479 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:40:15,621 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:40:16,609 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:40:35,364 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:40:35,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:35,546 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:40:41,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:41,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:41,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:42,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:40:42,906 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:40:46,185 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:40:46,199 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:40:49,111 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:40:49,112 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:40:49,115 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-17 09:40:49,116 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:40:49,120 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:40:49,121 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:40:49,144 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:40:49,163 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:40:49,210 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:40:49,214 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:40:49,231 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:40:50,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:40:51,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:40:58,692 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:40:58,694 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:40:58,695 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:40:58,696 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:02,914 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:41:02,917 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:41:02,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:07,086 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:41:07,087 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:41:07,089 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:11,283 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:41:11,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:41:12,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:41:12,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:28,352 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:41:28,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:32,712 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:41:55,120 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:41:55,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:41:56,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:41:56,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:42:39,523 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:42:47,527 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:42:55,948 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:43:04,147 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:43:13,064 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:43:13,066 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:43:13,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:43:14,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:43:14,773 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:43:14,775 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:43:19,230 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:43:38,022 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:43:38,475 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:43:40,881 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:43:42,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:43:42,410 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:43:49,073 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 89
2025-11-17 09:43:49,074 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:43:51,054 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:43:51,062 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:43:51,069 - ispa_next.main - DEBUG - 



2025-11-17 09:43:51,069 - ispa_next.main - DEBUG - starting with process 3 (MI-B 3297) of 9
2025-11-17 09:43:51,072 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:43:53,878 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:43:57,245 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:43:57,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 89
2025-11-17 09:44:00,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:44:00,655 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:44:53,820 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:45:10,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:10,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:11,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:14,125 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:45:14,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:14,306 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:14,796 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:45:14,800 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:45:18,244 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:45:18,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:45:20,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:45:22,529 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:45:22,823 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:45:26,215 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:45:26,460 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:45:26,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:29,414 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:45:42,521 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:45:43,526 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:45:43,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:44,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:51,556 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 09:45:51,560 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:45:51,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:45:51,762 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:45:51,763 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:45:51,864 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:45:53,517 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:45:54,916 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:45:56,456 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:45:57,320 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:46:01,689 - ispa_next.functions - DEBUG - Updated appointment (AA00050616) customer contact data.
2025-11-17 09:46:02,822 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:46:02,856 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:46:04,888 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:46:04,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:46:06,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:46:09,964 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:46:09,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:46:10,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:46:12,509 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:46:12,714 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:46:12,934 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:46:13,216 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:46:13,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:46:16,072 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:46:29,250 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:47:29,252 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:47:41,919 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:47:50,580 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:47:50,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:53,403 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:47:57,721 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:47:58,728 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:47:58,729 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:47:58,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:58,866 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:48:03,125 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:48:03,130 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:48:03,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:48:03,274 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:48:12,512 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 09:48:30,841 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 09:48:31,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:32,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:48:32,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:48:33,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:48:33,461 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:48:36,184 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:48:36,190 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:48:38,087 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:48:38,089 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:48:38,093 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Wischerblätter ersetzen in Ihrem Leasingvertrag en, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart)}
2025-11-17 09:48:38,096 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:48:38,100 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:48:38,101 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:48:38,102 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:48:38,106 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:48:38,107 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:48:38,111 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:48:38,113 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:48:39,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:48:40,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:48:47,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 09:48:48,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 09:49:51,609 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:49:51,792 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 09:50:03,300 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:50:03,347 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:50:03,348 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:09,192 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:50:09,194 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:50:09,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:14,851 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:50:14,851 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:50:14,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:20,594 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:50:20,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:50:21,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:50:21,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:36,436 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:50:36,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:42,135 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:51:05,845 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:51:06,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:51:07,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:51:07,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:51:59,929 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:51:59,929 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:52:01,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:52:01,671 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:52:01,673 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:52:09,980 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:52:31,582 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 09:52:31,584 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:52:31,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:52:33,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:52:34,151 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:52:34,154 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:52:38,487 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 09:52:38,519 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 09:52:43,971 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:52:43,974 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:52:45,358 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:52:45,360 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:52:52,090 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 09:52:52,091 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:52:53,957 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:52:53,966 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:52:53,989 - ispa_next.main - DEBUG - 



2025-11-17 09:52:53,989 - ispa_next.main - DEBUG - starting with process 4 (HF-DB 2903) of 9
2025-11-17 09:52:53,993 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:52:56,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:53:00,119 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 09:53:00,121 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 09:53:03,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:53:03,393 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:53:50,154 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:54:08,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:08,878 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:54:09,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:54:11,234 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:54:11,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:11,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:54:11,924 - ispa_next.functions - DEBUG - HU date soon to be invalid in 40 days.
2025-11-17 09:54:24,876 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:54:24,879 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:54:28,227 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:54:28,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:30,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:54:32,327 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:54:45,511 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 09:55:00,160 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 09:55:01,165 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:55:01,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:55:01,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:55:08,857 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 09:55:08,861 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:55:08,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:55:09,055 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:55:09,057 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:55:09,161 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:55:09,435 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:55:10,889 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 09:55:12,362 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 09:55:13,012 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:55:15,949 - ispa_next.functions - DEBUG - Updated appointment (AA00050615) customer contact data.
2025-11-17 09:55:17,125 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:55:17,138 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:55:17,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:55:18,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:55:21,207 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:55:21,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:55:21,611 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:55:26,519 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:55:26,519 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:55:26,643 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:55:26,645 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:55:26,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:55:27,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:55:31,597 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:55:31,601 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:55:31,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:55:31,708 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:55:32,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:55:32,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:55:32,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:55:33,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:55:33,955 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:55:37,227 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:55:37,231 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:55:39,434 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:55:39,436 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:55:39,438 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-17 09:55:39,440 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:55:39,443 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:55:39,444 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:55:39,445 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:55:39,448 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:55:39,449 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:55:39,451 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:55:39,454 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:55:40,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:55:41,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:55:49,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 09:55:50,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 09:56:07,419 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:56:07,421 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:56:07,422 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:56:07,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:12,396 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:56:12,397 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:56:12,400 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:17,393 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:56:17,393 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 09:56:17,396 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:22,366 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:56:22,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:56:22,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:56:23,085 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:56:23,087 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:28,057 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:56:50,028 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:56:50,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:56:51,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:56:51,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:57:41,211 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:57:48,444 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:57:56,711 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:05,413 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:13,774 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:22,894 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:22,896 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:58:22,897 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:58:24,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:58:24,552 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:58:24,554 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:58:28,875 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:58:47,704 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:58:48,096 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:58:50,994 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:58:52,540 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 254
2025-11-17 09:58:52,542 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:58:59,593 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 89
2025-11-17 09:58:59,594 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:59:01,917 - ispa_next.appointments.models - DEBUG - Appointment Schwarz Mobility HN-DL 992 WBA21BX0X07S26459 ohne Termin.
2025-11-17 09:59:01,929 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 09:59:01,948 - ispa_next.main - DEBUG - 



2025-11-17 09:59:01,948 - ispa_next.main - DEBUG - starting with process 5 (MI-ZW 472) of 9
2025-11-17 09:59:01,952 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:59:07,074 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:59:10,391 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 254
2025-11-17 09:59:10,393 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 89
2025-11-17 09:59:13,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:59:13,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:00:08,935 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:00:26,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:00:26,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:00:26,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:29,689 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:00:29,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:00:30,020 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:00:30,544 - ispa_next.functions - DEBUG - HU date already expired after 608 days.
2025-11-17 10:00:44,147 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:00:44,151 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:00:47,548 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:00:47,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:00:48,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:00:50,785 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:01:02,028 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:01:17,129 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:01:18,136 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:01:18,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:01:18,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:01:36,169 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:01:50,665 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:01:50,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:01:50,836 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:01:50,837 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:01:50,939 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:01:51,248 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:01:52,901 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:01:54,300 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:01:55,003 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:01:59,643 - ispa_next.functions - DEBUG - Updated appointment (AA00050613) customer contact data.
2025-11-17 10:02:00,725 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:02:00,766 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:02:01,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:02:02,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:02:04,997 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:02:04,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:02:05,304 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:02:09,451 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:02:09,452 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:02:09,452 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:02:09,456 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:02:09,457 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:02:09,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:02:10,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:02:11,691 - ispa_next.functions - DEBUG - check_service_requirement couldn't find CBS table, returning False
2025-11-17 10:02:11,694 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:02:11,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:02:11,896 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:02:12,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:12,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:12,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:02:13,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:02:13,998 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:02:17,234 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:02:17,238 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:02:18,609 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:02:18,611 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:02:18,615 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-17 10:02:18,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:02:18,621 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:02:18,623 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:02:18,624 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:02:18,626 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:02:18,627 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:02:18,629 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:02:18,632 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:02:19,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:02:20,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:02:28,106 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:02:28,108 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:02:28,109 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:02:28,110 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:02:32,301 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:02:32,302 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:02:32,304 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:02:36,626 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:02:36,627 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:02:36,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:02:40,837 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:02:40,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:02:41,447 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:02:41,591 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:02:41,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:02:45,784 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:03:07,610 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:03:08,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:03:08,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:03:09,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:03:52,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:02,504 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:10,455 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:18,677 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:27,206 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:27,208 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:04:27,209 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:28,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:04:28,876 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:04:28,878 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:04:33,291 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:04:51,795 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:04:52,313 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:04:54,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:56,017 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 10:04:56,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:03,027 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 10:05:03,028 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:05,257 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:05:05,274 - ispa_next.main - DEBUG - Found new Appointment: HN-DL 992
2025-11-17 10:05:05,301 - ispa_next.main - DEBUG - 



2025-11-17 10:05:05,301 - ispa_next.main - DEBUG - starting with process 6 (HN-DL 992) of 10
2025-11-17 10:05:05,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:05:10,791 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:14,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 252
2025-11-17 10:05:14,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 10:05:18,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:18,045 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:06:11,472 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:06:28,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:32,220 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:06:32,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:32,397 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:32,904 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:06:32,907 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:06:36,307 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:06:36,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:38,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:40,479 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:06:40,704 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:06:40,964 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:06:41,237 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:06:45,534 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:06:46,540 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:06:46,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:47,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:54,187 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:06:54,190 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:06:54,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:54,337 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:54,341 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:06:54,486 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:06:56,081 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:06:57,480 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:06:57,836 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:07:02,371 - ispa_next.functions - DEBUG - Updated appointment (AA00050620) customer contact data.
2025-11-17 10:07:03,489 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:07:03,517 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:07:05,431 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:07:05,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:07:06,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:07:10,589 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:07:10,589 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:07:10,593 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:07:10,594 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:07:10,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:11,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:15,346 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:07:17,037 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:07:35,917 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:07:35,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:36,178 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:07:41,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:43,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:43,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:44,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:44,623 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:07:48,009 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:07:48,012 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:07:49,963 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:07:49,968 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:49,971 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-17 10:07:49,972 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:49,974 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:07:49,976 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:07:49,977 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:07:49,979 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:07:49,981 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:07:49,983 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:07:49,986 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:07:50,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:07:52,069 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:07:59,291 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:07:59,293 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:07:59,295 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:07:59,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:03,524 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:08:03,526 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:08:03,529 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:07,826 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:08:07,826 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:08:07,830 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:11,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:12,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:19,264 - ispa_next.functions - DEBUG - added beide Bremsscheiben vorne to cart
2025-11-17 10:08:26,493 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:08:26,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:08:29,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:08:29,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:50,997 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:08:50,999 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:56,223 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:09:19,423 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:09:20,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:09:20,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:09:21,194 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:58,862 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:09:58,863 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:00,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:10:00,665 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:10:00,667 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:10:08,957 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:10:28,093 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:10:28,500 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:10:30,658 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:33,065 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 10:10:33,067 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:39,526 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 89
2025-11-17 10:10:39,527 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:41,396 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:10:41,404 - ispa_next.main - DEBUG - 



2025-11-17 10:10:41,404 - ispa_next.main - DEBUG - starting with process 7 (MI-BS 1921) of 10
2025-11-17 10:10:41,407 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:44,423 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:47,504 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 253
2025-11-17 10:10:47,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 89
2025-11-17 10:10:50,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:50,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:11:43,253 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:12:00,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:03,485 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:12:03,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:03,673 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:12:04,320 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:12:04,323 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:12:07,693 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:12:07,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:10,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:12,095 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:12:12,419 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:12:15,778 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:12:15,959 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:12:18,205 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:12:19,210 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:12:19,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:19,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:35,699 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:12:50,293 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:12:50,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:50,462 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:12:50,463 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:12:50,620 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:12:52,081 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:12:53,628 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:12:54,209 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:12:57,650 - ispa_next.functions - DEBUG - Updated appointment (AA00050614) customer contact data.
2025-11-17 10:12:58,852 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:12:58,871 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:13:00,754 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:13:00,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:13:02,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:13:05,965 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:13:05,965 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:13:05,969 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:13:05,970 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:13:05,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:06,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:10,751 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:13:19,084 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:13:35,195 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:13:35,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:35,368 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:44,414 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 10:14:06,433 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:14:07,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:08,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:08,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:10,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:10,023 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:14:12,803 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:14:12,806 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:14:14,687 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:14:14,697 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:14:14,701 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Wischerblätter ersetzen in Ihrem Leasingvertrag en, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:14:14,704 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:14:14,708 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:14:14,713 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:14:14,717 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:14:14,723 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:14:14,727 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:14:14,733 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:14:14,761 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:14:15,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:14:17,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:14:24,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:14:25,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:15:03,702 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:15:04,034 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:15:16,157 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:15:16,161 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:15:16,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:21,231 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:15:21,234 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:15:21,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:26,312 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:15:26,312 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 10:15:26,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:31,375 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:15:31,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:15:32,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:15:32,165 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:15:32,168 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:37,271 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:16:00,382 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:16:00,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:16:01,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:16:02,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:54,631 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:03,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:11,676 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:20,822 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:29,508 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:39,658 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:39,660 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:17:39,661 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:41,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:41,384 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:17:41,385 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:17:45,791 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:18:05,210 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:18:05,594 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:18:08,502 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:10,132 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 10:18:10,134 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:17,423 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 10:18:17,424 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:18:19,768 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:18:19,781 - ispa_next.main - DEBUG - 



2025-11-17 10:18:19,781 - ispa_next.main - DEBUG - starting with process 8 (HFNU2969) of 10
2025-11-17 10:18:19,785 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:18:22,655 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:26,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 10:18:26,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 10:18:29,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:29,482 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:18,661 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 10:19:18,844 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:19:18,849 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:20,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 10:19:20,210 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:26,428 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 10:19:26,429 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:28,321 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:19:28,334 - ispa_next.main - DEBUG - 



2025-11-17 10:19:28,334 - ispa_next.main - DEBUG - starting with process 9 (HF-KT 524) of 10
2025-11-17 10:19:28,345 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:31,239 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:34,840 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 251
2025-11-17 10:19:34,842 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 10:19:38,268 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:38,270 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:20:32,635 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:20:51,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:00,130 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:21:00,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:00,278 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:00,807 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:21:00,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:00,981 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:14,635 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:21:18,244 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:18,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:20,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:22,399 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:21:22,649 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:21:22,832 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:21:23,067 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:21:23,069 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:32,067 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:21:45,439 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:21:46,445 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:21:46,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:47,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:06,294 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:22:22,901 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:22:22,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:23,064 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:23,065 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:22:23,154 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:22:24,708 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:22:26,357 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:22:26,908 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:22:29,881 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-17 10:22:31,111 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:22:31,183 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:22:33,780 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:22:33,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:22:35,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:22:39,246 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:39,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:39,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:41,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:22:42,152 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:22:42,466 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:22:42,644 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:22:42,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:51,692 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:23:03,275 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:23:12,874 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:23:12,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:21,939 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:23:26,248 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:23:27,254 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:23:27,255 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:23:27,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:27,402 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:23:31,624 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:23:33,457 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:23:48,431 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:23:48,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:48,583 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:23:49,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:49,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:49,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:50,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:50,893 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:23:58,811 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:23:58,814 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:24:00,938 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:24:00,940 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:24:00,942 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-17 10:24:00,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:24:00,946 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:24:00,948 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:24:00,950 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:24:00,951 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:24:00,954 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:24:00,957 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:24:01,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:24:03,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:24:11,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:24:13,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:24:31,570 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:24:31,571 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:24:36,882 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:37,430 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:37,982 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:39,647 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:40,225 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:40,785 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:42,464 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:43,022 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:43,581 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:45,239 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:45,795 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:46,353 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:47,973 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:48,569 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:49,120 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:50,796 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:51,355 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:51,902 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:53,521 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:54,086 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:54,642 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:24:56,275 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:24:56,832 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:24:57,409 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:25:00,579 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:25:01,174 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:25:01,728 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:25:03,425 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:25:03,995 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:25:04,555 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:25:06,249 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:25:06,808 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:25:07,387 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:25:09,030 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:25:09,591 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:25:10,145 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:25:11,820 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:25:12,405 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:25:12,960 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:25:13,540 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-17 10:25:14,091 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-17 10:25:14,642 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-17 10:25:15,222 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-17 10:25:15,222 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-17 10:25:16,430 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-17 10:25:17,630 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:25:17,631 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:19,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:21,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:25:21,011 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:25:21,044 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:25:28,392 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:25:28,397 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:29,859 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 10:25:29,860 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:36,848 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 10:25:36,849 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:38,769 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:25:38,777 - ispa_next.main - DEBUG - 



2025-11-17 10:25:38,777 - ispa_next.main - DEBUG - starting with process 10 (mi mp 200) of 10
2025-11-17 10:25:38,780 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:41,675 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:45,054 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 10:25:45,057 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 10:25:48,404 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:48,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:38,289 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 10:26:38,303 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:26:38,310 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:39,734 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 250
2025-11-17 10:26:39,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:47,050 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 10:26:47,051 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:48,902 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
