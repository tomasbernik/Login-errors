2025-11-17 10:00:35,832 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:35,838 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:49,913 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:01:00,803 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:16,138 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:01:40,695 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:01:52,113 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:01:54,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:01:55,878 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 591
2025-11-17 10:01:55,879 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 10:01:58,183 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-17 10:01:58,184 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:01:58,184 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:01:59,088 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:00,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:21,632 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-17 10:02:21,642 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-17 10:02:21,649 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-17 10:02:21,656 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-17 10:02:21,668 - ispa_next.main - DEBUG - Found 10 out of 43 appointments to process (configured limit: 15).
2025-11-17 10:02:21,668 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-17 10:02:21,668 - ispa_next.main - DEBUG - All appointments: MI-OV 77, HF-CM 9945, HF-LF 3030, HF-WJ 29 E, HF-XN44, HF-X 1020, BÜNDE, HF L 1612, OS-CW177, BÜNDE
2025-11-17 10:02:21,670 - ispa_next.main - DEBUG - 



2025-11-17 10:02:21,670 - ispa_next.main - DEBUG - starting with process 1 (MI-OV 77) of 10
2025-11-17 10:02:21,674 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:02:22,427 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:23,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 591
2025-11-17 10:02:23,337 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-17 10:02:24,454 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:02:24,456 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:54,753 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:03:04,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:04,274 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:04,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:03:06,365 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:03:06,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:06,457 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:06,637 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:03:06,640 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:03:06,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:06,720 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:16,909 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:03:16,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:17,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:19,966 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:03:20,094 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:03:23,297 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:03:23,410 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:03:29,642 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:03:36,327 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:03:37,332 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:03:37,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:37,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:47,266 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:03:54,332 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:03:54,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:54,445 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:03:54,445 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:03:54,482 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:03:54,616 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:03:55,909 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:03:56,225 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:03:59,253 - ispa_next.functions - DEBUG - Updated appointment (AA00044710) customer contact data.
2025-11-17 10:04:00,177 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:04:00,189 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:04:00,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:04:01,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:04:02,574 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:04:02,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:04:02,663 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:04:06,661 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:04:06,662 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:04:06,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:07,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:09,144 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:04:09,272 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:04:09,377 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:04:09,472 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:04:15,673 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:04:24,791 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:04:25,817 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:04:25,822 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:04:25,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:25,911 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:04:26,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:26,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:26,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:27,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:27,540 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:04:30,012 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:04:30,013 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:04:31,053 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:04:31,057 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:04:31,060 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:04:31,063 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:04:31,065 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:04:31,066 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:04:31,068 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:04:31,069 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:04:31,070 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:04:31,072 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:04:31,073 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:04:31,075 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:04:31,077 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:04:31,079 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:04:31,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:33,633 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:04:33,634 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:04:33,636 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:36,224 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:04:36,225 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:04:36,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:04:36,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:04:37,032 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:04:37,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:39,563 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:04:39,564 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:04:40,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:04:40,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:04:40,724 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:47,534 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:51,538 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:56,019 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:56,021 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:04:56,021 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:56,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:04:56,704 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:04:56,705 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:04:58,191 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:05:06,848 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:05:07,228 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:05:07,630 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:08,924 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 591
2025-11-17 10:05:08,926 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:11,862 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 319
2025-11-17 10:05:11,863 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:12,601 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:05:12,613 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:05:12,619 - ispa_next.main - DEBUG - 



2025-11-17 10:05:12,619 - ispa_next.main - DEBUG - starting with process 2 (HF-CM 9945) of 10
2025-11-17 10:05:12,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:05:13,764 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:15,006 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 591
2025-11-17 10:05:15,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 319
2025-11-17 10:05:16,375 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:16,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:45,355 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:05:54,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:00,478 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:06:00,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:00,548 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:00,767 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:06:00,770 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:06:00,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:00,856 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:04,123 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:06:04,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:05,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:07,153 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:06:07,349 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:06:10,575 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:06:10,672 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:06:14,893 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:06:15,899 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:06:15,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:16,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:30,042 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:06:37,370 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:06:37,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:37,458 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:37,459 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:06:37,499 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:06:38,698 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:06:38,934 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:06:41,995 - ispa_next.functions - DEBUG - Updated appointment (AA00044711) customer contact data.
2025-11-17 10:06:42,926 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:06:42,928 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:06:43,833 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:06:43,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:06:44,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:06:48,115 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:06:48,116 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:06:48,119 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:06:48,122 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:06:48,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:48,619 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:54,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:54,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:54,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:55,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:55,540 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:07:00,836 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:07:00,839 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:07:01,955 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:07:01,956 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:01,959 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:07:01,962 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:07:01,964 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:07:01,966 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:01,969 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:07:01,973 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:07:01,974 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:07:01,976 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:07:01,977 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:07:01,978 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:07:01,981 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:07:01,982 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:07:01,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:08,049 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:07:08,052 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:07:08,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:14,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:14,097 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:07:26,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:41,795 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:07:41,797 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:07:41,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:07:42,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:07:42,849 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:07:42,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:48,887 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:07:48,889 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:07:49,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:49,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:07:49,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:00,084 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:04,199 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:07,905 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:11,686 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:17,056 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:08:17,057 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:17,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:08:17,579 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:08:17,580 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:08:20,910 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:08:29,161 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:08:29,540 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:08:30,567 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:31,230 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:08:31,232 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:34,238 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:08:34,239 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:35,125 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:08:35,134 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:08:35,146 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:08:35,150 - ispa_next.main - DEBUG - 



2025-11-17 10:08:35,150 - ispa_next.main - DEBUG - starting with process 3 (HF-LF 3030) of 10
2025-11-17 10:08:35,154 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:36,039 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:36,893 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:08:36,895 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:08:38,317 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:38,319 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:07,083 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:09:17,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:24,862 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:09:24,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:24,938 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:25,202 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:09:25,204 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:09:25,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:25,307 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:28,533 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:09:28,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:29,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:31,875 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:09:32,013 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:09:35,258 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:09:35,338 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:09:35,339 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:09:46,705 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:09:47,709 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:09:47,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:48,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:59,009 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:09:59,009 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:10:05,819 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:10:05,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:05,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:05,935 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:10:06,007 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:10:07,266 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:10:08,423 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:10:08,657 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:10:11,936 - ispa_next.functions - DEBUG - Updated appointment (AA00044696) customer contact data.
2025-11-17 10:10:12,871 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:10:12,874 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:10:13,989 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:10:13,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:10:14,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:10:18,300 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:18,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:18,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:20,815 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:10:20,934 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:21,131 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:21,233 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:10:21,233 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:10:32,882 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:11:32,885 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:11:44,552 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:12:07,554 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:19,200 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:12:26,498 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:12:26,499 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:12:30,699 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:12:31,705 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:12:31,707 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:12:31,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:31,829 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:12:41,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:42,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:42,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:42,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:42,912 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:12:50,049 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:12:50,051 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:12:51,073 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:12:51,073 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:12:51,075 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:12:51,076 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:12:51,078 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:12:51,086 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:12:51,090 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:12:51,093 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:12:51,096 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:12:51,098 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:12:51,099 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:12:51,101 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:12:51,104 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:12:51,106 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:12:51,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:59,193 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:12:59,194 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:12:59,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:07,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:07,237 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:15,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:33,863 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:13:33,865 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:13:33,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:13:34,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:13:34,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:55,608 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:13:55,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:03,648 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:14:03,650 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:14:04,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:04,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:14:04,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:14,199 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:14:14,199 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 10:14:16,365 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:14:16,365 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 10:14:19,598 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:14:19,599 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 10:14:24,826 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:14:24,826 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 10:14:34,300 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:14:34,300 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 10:14:51,667 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 10:14:52,342 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 10:14:52,443 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:14:52,443 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:53,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:53,217 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:14:53,218 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:14:53,240 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:14:56,453 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:14:56,457 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:56,922 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:14:56,923 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:59,465 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:14:59,466 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:00,133 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:15:00,139 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:15:00,152 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:15:00,157 - ispa_next.main - DEBUG - 



2025-11-17 10:15:00,157 - ispa_next.main - DEBUG - starting with process 4 (HF-WJ 29 E) of 10
2025-11-17 10:15:00,160 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:01,176 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:02,094 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:15:02,095 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:15:03,526 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:03,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:33,007 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:15:42,949 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:44,222 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:15:44,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:44,324 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:44,555 - ispa_next.functions - DEBUG - HU date already expired after 617 days.
2025-11-17 10:15:51,583 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:15:51,586 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:15:51,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:51,661 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:54,824 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:54,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:55,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:57,779 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:57,896 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:01,118 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:01,234 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:01,234 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:12,708 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:16:13,712 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:16:13,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:14,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:27,817 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:16:35,524 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:16:35,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:35,624 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:35,624 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:16:35,668 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:16:36,945 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:16:37,260 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:16:39,504 - ispa_next.functions - DEBUG - Updated appointment (AB00040642) customer contact data.
2025-11-17 10:16:40,411 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:16:40,413 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:16:40,994 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:16:40,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:41,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:16:45,839 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:16:45,839 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:45,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:46,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:48,371 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:48,484 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:48,569 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:48,691 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:48,691 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:59,876 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:17:59,879 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:18:11,748 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:18:18,720 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:18:18,721 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:18:22,914 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:18:23,920 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:18:23,922 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:18:23,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:24,026 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:18:29,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:30,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:30,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:30,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:30,793 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:18:32,701 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:18:32,703 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:18:33,638 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:18:33,643 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:33,646 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:18:33,649 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:18:33,651 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:18:33,652 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:33,654 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:18:33,655 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:18:33,656 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:18:33,657 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:18:33,659 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:18:33,661 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:18:35,453 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:36,044 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:37,014 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:18:37,590 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:38,109 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:39,418 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:18:40,462 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:41,529 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:18:41,933 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:18:41,934 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:18:41,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:43,134 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:18:43,135 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:18:43,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:44,298 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:18:44,301 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:18:44,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:18:44,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:18:45,144 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:52,882 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:18:52,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:54,106 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:18:54,107 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:18:54,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:18:55,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:18:55,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:00,497 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:00,499 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:19:00,499 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:01,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:01,491 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:19:01,493 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:19:03,470 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:19:10,807 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:19:11,188 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:19:11,516 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:12,544 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:19:12,545 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:15,240 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:19:15,241 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:16,003 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:19:16,011 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:19:16,023 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:19:16,028 - ispa_next.main - DEBUG - 



2025-11-17 10:19:16,028 - ispa_next.main - DEBUG - starting with process 5 (HF-XN44) of 10
2025-11-17 10:19:16,032 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:17,247 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:18,530 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:19:18,531 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:19:19,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:19,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:48,924 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:19:58,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:00,757 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:20:00,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:00,840 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:01,102 - ispa_next.functions - DEBUG - HU date already expired after 843 days.
2025-11-17 10:20:07,402 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:20:07,404 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:20:07,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:07,482 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:16,526 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:16,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:17,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:19,631 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:20:19,745 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:20:19,829 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:20:19,951 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:20:19,951 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:20:31,171 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:20:38,355 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:20:38,356 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:20:42,569 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:20:43,574 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:20:43,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:44,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:58,918 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:21:06,178 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:21:06,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:06,255 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:06,256 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:21:06,287 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:21:07,439 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:21:07,655 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:21:10,216 - ispa_next.functions - DEBUG - Updated appointment (AJ00014914) customer contact data.
2025-11-17 10:21:11,127 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:21:11,129 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:21:11,725 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:21:11,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:21:12,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:21:16,449 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:21:16,450 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:16,450 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:21:16,452 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:21:16,456 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:21:16,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:16,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:17,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:17,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:17,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:18,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:18,609 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:21:21,601 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:21:21,603 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:21:22,729 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:21:22,732 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:22,736 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:21:22,739 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:21:22,741 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:21:22,744 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:22,746 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:21:22,747 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:21:22,748 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:21:22,750 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:21:22,751 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:21:22,752 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:21:22,754 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:21:22,756 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:21:22,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:26,133 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:21:26,135 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:21:26,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:29,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:29,476 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:21:38,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:51,002 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:21:51,004 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:21:51,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:21:51,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:21:52,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:01,772 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:22:01,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:05,097 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:22:05,099 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:22:05,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:06,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:22:06,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:13,543 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:18,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:24,338 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:22:24,339 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:25,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:25,082 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:22:25,083 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:22:27,853 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:22:34,529 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:22:34,930 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:22:36,296 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:36,944 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:22:36,945 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:40,113 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:22:40,114 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:40,814 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:22:40,820 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:22:40,828 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:22:40,832 - ispa_next.main - DEBUG - 



2025-11-17 10:22:40,832 - ispa_next.main - DEBUG - starting with process 6 (HF-X 1020) of 10
2025-11-17 10:22:40,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:41,661 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:42,605 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:22:42,606 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:22:43,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:43,914 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:25,148 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:23:34,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:42,450 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:23:42,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:42,516 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:42,737 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-17 10:23:49,504 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:23:49,507 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:23:49,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:49,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:59,484 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:59,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:00,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:02,560 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:02,694 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:05,885 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:05,956 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:05,957 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:24:17,174 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:24:18,187 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:24:18,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:18,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:33,093 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:24:40,424 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:24:40,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:40,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:40,488 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:24:40,519 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:24:41,907 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:24:43,040 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:24:44,219 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:24:44,559 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:24:47,285 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-17 10:24:48,232 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:24:48,234 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:24:49,118 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:24:49,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:24:50,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:24:54,450 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:24:54,450 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:54,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:55,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:57,015 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:57,163 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:57,316 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:57,409 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:57,409 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:25:08,582 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:26:08,587 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:20,094 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:26:26,097 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:36,892 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:26:44,770 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:26:44,770 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:26:47,129 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:26:48,138 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:26:48,141 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:26:48,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:48,242 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:26:48,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:49,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:49,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:50,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:50,282 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:26:58,760 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:26:58,762 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:26:59,832 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:26:59,834 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:26:59,836 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-17 10:26:59,838 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:26:59,839 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:26:59,841 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:26:59,842 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:26:59,843 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:26:59,844 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:26:59,846 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:26:59,847 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:27:14,048 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 366, in _add_to_container_from_aw
    raise RuntimeError("Button 'Warenkorb' and 'Beratungsliste' are disabled")
RuntimeError: Button 'Warenkorb' and 'Beratungsliste' are disabled

2025-11-17 10:27:14,065 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:27:14,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:27:15,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:27:15,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:27:15,831 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:27:15,854 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:27:18,741 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:27:18,744 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:27:19,102 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:27:19,103 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:27:21,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:27:21,472 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:27:22,176 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:27:22,193 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:27:22,205 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:27:22,211 - ispa_next.main - DEBUG - 



2025-11-17 10:27:22,211 - ispa_next.main - DEBUG - starting with process 7 (BÜNDE) of 10
2025-11-17 10:27:22,214 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:27:23,395 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:27:24,665 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:27:24,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:27:26,086 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:27:26,088 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:27:54,366 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:28:04,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:04,536 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:04,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:06,668 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:28:06,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:06,745 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:07,020 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:28:07,023 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:28:07,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:07,125 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:10,148 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:28:10,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:11,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:13,457 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:28:13,557 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:28:16,809 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:28:16,875 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:28:16,875 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:28:28,708 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:28:29,712 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:28:29,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:30,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:41,224 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:28:48,496 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:28:48,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:48,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:48,567 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:28:48,674 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:28:49,907 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:28:51,101 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:28:51,318 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:28:55,082 - ispa_next.functions - DEBUG - Updated appointment (AF00021373) customer contact data.
2025-11-17 10:28:56,042 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:28:56,044 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:28:56,674 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:28:56,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:28:57,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:29:01,436 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:29:01,437 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:29:01,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:29:01,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:29:03,915 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:29:04,053 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:29:04,174 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:29:04,291 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:29:04,291 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:29:15,304 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:29:22,780 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:29:22,780 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:29:26,990 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:29:27,997 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:29:27,999 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:29:28,000 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:29:28,000 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:29:29,880 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:29:29,881 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:29:30,844 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:29:30,846 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:29:30,848 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:29:30,849 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:29:30,850 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:29:30,850 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:29:30,853 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:29:30,857 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:29:30,859 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:29:30,863 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:29:30,865 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:29:30,867 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:29:30,870 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:29:30,871 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:29:30,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:32,805 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:29:32,808 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:29:32,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:34,677 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:29:34,679 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:29:34,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:29:35,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:29:35,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:46,569 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:29:46,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:48,463 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:29:48,464 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:29:48,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:49,536 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:29:49,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:55,647 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:59,470 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:29:59,472 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:29:59,473 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:59,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:30:00,024 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:30:00,028 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:30:01,370 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:30:09,892 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:30:10,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:30:11,001 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:11,585 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:30:11,586 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:14,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:30:14,130 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:14,744 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:30:14,751 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:30:14,760 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:30:14,766 - ispa_next.main - DEBUG - 



2025-11-17 10:30:14,766 - ispa_next.main - DEBUG - starting with process 8 (HF L 1612) of 10
2025-11-17 10:30:14,769 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:30:15,712 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:30:16,694 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:30:16,696 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:30:18,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:30:18,183 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:57,221 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:31:07,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:10,348 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:31:10,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:10,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:10,675 - ispa_next.functions - DEBUG - HU date already expired after 877 days.
2025-11-17 10:31:17,741 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:31:17,743 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:31:17,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:17,857 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:27,705 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:31:27,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:28,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:30,685 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:31:30,853 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:31:30,936 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:31:31,011 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:31:31,012 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:42,499 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:31:43,503 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:31:43,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:44,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:55,194 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:32:03,178 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:32:03,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:03,263 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:03,264 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:32:03,317 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:32:04,498 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:32:04,719 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:32:07,626 - ispa_next.functions - DEBUG - Updated appointment (AM00008749) customer contact data.
2025-11-17 10:32:08,555 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:32:08,557 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:32:09,317 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:32:09,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:32:10,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:32:13,728 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:32:13,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:14,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:32:16,239 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:32:16,345 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:32:16,444 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:32:16,526 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:32:16,527 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:32:27,590 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:33:27,594 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:33:39,516 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:33:47,170 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:33:47,170 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:33:51,378 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:33:52,386 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:33:52,389 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:33:52,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:52,473 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:33:59,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:00,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:00,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:01,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:01,118 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:34:04,277 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:34:04,278 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:34:05,244 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:34:05,245 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:34:05,247 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:34:05,248 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:34:05,249 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=HU/AU Dekra Lemgo, source=from_tab, target=cart)}
2025-11-17 10:34:05,250 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:34:05,252 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:34:05,253 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:34:05,254 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:34:05,256 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 10:34:05,261 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:34:05,266 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:34:05,271 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:34:05,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:34:07,371 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:34:21,313 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:34:21,313 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:34:23,811 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:34:24,330 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:34:25,265 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:34:25,844 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:34:26,430 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:34:27,390 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:34:27,944 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:34:28,480 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:34:29,389 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:34:30,009 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:34:30,532 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:34:32,423 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:34:33,340 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:34:33,343 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:34:33,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:36,084 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:34:36,086 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:34:36,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:38,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:39,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:49,420 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:34:49,422 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:34:49,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:34:50,219 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:34:50,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:00,383 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:35:00,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:02,994 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:35:02,995 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:35:03,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:35:04,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:35:04,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:11,916 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:35:17,931 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:35:17,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:35:18,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:35:18,686 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:35:18,687 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:35:21,460 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:35:29,420 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:35:29,807 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:35:31,346 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:32,131 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:35:32,132 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:35,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 320
2025-11-17 10:35:35,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:35:36,154 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:35:36,162 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:35:36,175 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 10:35:36,184 - ispa_next.main - DEBUG - 



2025-11-17 10:35:36,184 - ispa_next.main - DEBUG - starting with process 9 (OS-CW177) of 10
2025-11-17 10:35:36,212 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:35:37,443 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:35:38,783 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 592
2025-11-17 10:35:38,784 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 320
2025-11-17 10:35:40,392 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:35:40,394 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:36:13,303 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:36:24,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:26,190 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:36:26,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:26,271 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:26,561 - ispa_next.functions - DEBUG - HU date already expired after 550 days.
2025-11-17 10:36:33,154 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:36:33,158 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:36:33,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:33,269 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:36,357 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:36:36,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:37,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:39,826 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:36:40,008 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:36:43,619 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:36:43,694 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:36:43,694 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:55,421 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:36:56,426 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:36:56,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:56,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:09,107 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:37:17,526 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:37:17,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:17,647 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:37:17,648 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:37:17,700 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:37:19,153 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:37:20,277 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:37:20,573 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:37:23,613 - ispa_next.functions - DEBUG - Updated appointment (AN00006788) customer contact data.
2025-11-17 10:37:24,600 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:37:24,602 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:37:25,436 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:37:25,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:37:26,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:37:30,371 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:37:30,371 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:37:30,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:30,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:32,874 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:37:32,993 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:37:33,075 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:37:33,157 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:37:33,158 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:37:44,967 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:38:44,979 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:38:56,587 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:39:03,843 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:39:03,844 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:39:08,063 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:39:09,072 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:39:09,078 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:39:09,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:09,145 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:39:12,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:13,235 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:13,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:14,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:14,019 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:39:15,914 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:39:15,918 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:39:16,990 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:39:16,991 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:39:16,996 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:39:16,997 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:39:16,999 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:39:17,000 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:39:17,003 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:39:17,005 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:39:17,006 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:39:17,007 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:39:17,008 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:39:17,010 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:39:17,012 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:39:17,014 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:39:17,014 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:18,947 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:39:22,001 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:39:22,003 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:39:22,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:24,211 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:39:24,212 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:39:24,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:39:25,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:39:25,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:32,910 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:39:32,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:34,938 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:39:34,940 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:39:35,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:36,133 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:39:36,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:44,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:49,062 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:49,063 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:49,064 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:49,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:49,670 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:49,672 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:51,361 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:39:59,564 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:39:59,962 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:40:00,946 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:40:01,755 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 594
2025-11-17 10:40:01,756 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:40:05,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 321
2025-11-17 10:40:05,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:06,503 - ispa_next.appointments.models - DEBUG - Appointment Jörg Hachmeister Kartoffelhaus MI-YH 6666 WBAYH310405W04954 ohne Termin.
2025-11-17 10:40:06,513 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:40:06,521 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:40:06,527 - ispa_next.main - DEBUG - Found new Appointment: HF-PA 711
2025-11-17 10:40:06,529 - ispa_next.main - DEBUG - 



2025-11-17 10:40:06,529 - ispa_next.main - DEBUG - starting with process 10 (HF-PA 711) of 11
2025-11-17 10:40:06,532 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:40:07,602 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:40:08,592 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 594
2025-11-17 10:40:08,593 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 321
2025-11-17 10:40:09,892 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:40:09,894 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:48,535 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:40:58,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:59,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:59,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:00,446 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:41:00,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:00,530 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:00,816 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:41:00,818 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:41:00,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:00,909 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:11,439 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:11,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:12,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:14,668 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:41:20,978 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:41:28,260 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:41:29,265 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:41:29,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:29,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:41,064 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:41:48,880 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:41:48,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:49,004 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:49,005 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:41:49,052 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:41:49,148 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:41:50,409 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:41:50,669 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:41:54,926 - ispa_next.functions - DEBUG - Updated appointment (AF00021425) customer contact data.
2025-11-17 10:41:55,898 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:41:55,900 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:41:56,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:57,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:41:58,526 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:41:58,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:58,613 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:42:02,651 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:42:02,651 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:42:02,652 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:42:02,654 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:42:02,656 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:42:02,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:42:03,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:42:03,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:04,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:04,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:42:04,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:42:04,726 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:42:06,671 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:42:06,674 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:42:07,685 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:42:07,687 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:07,689 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:42:07,690 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:42:07,696 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:42:07,699 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:07,702 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:42:07,705 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:42:07,709 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:42:07,711 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:42:07,712 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:42:07,714 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:42:07,716 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:42:07,718 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:42:07,719 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:09,803 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:42:09,804 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:42:09,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:11,684 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:42:11,685 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:42:11,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:42:12,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:42:12,472 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:42:12,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:14,411 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:42:14,412 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:42:14,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:15,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:42:15,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:22,053 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:26,932 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:26,935 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:26,936 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:27,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:27,899 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:27,901 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:42:29,858 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:42:49,242 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:42:49,243 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:49,244 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:50,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:50,489 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:50,491 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:42:52,891 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:42:52,922 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:42:55,492 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:42:55,496 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:56,660 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 594
2025-11-17 10:42:56,661 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:00,173 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 321
2025-11-17 10:43:00,174 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:01,211 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:43:01,219 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:43:01,225 - ispa_next.main - DEBUG - Found new Appointment: MI-YH 6666
2025-11-17 10:43:01,227 - ispa_next.main - DEBUG - 



2025-11-17 10:43:01,228 - ispa_next.main - DEBUG - starting with process 11 (MI-YH 6666) of 12
2025-11-17 10:43:01,231 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:03,187 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:04,441 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 594
2025-11-17 10:43:04,442 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 321
2025-11-17 10:43:06,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:06,066 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:38,452 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:43:49,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:53,097 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:43:53,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:53,163 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:53,420 - ispa_next.functions - DEBUG - HU date soon to be invalid in 17 days.
2025-11-17 10:43:59,628 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:43:59,631 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:43:59,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:59,732 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:02,708 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:02,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:04,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:06,485 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:06,665 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:09,902 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:09,959 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:44:09,959 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:44:21,247 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:44:22,253 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:44:22,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:22,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:37,861 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:44:45,908 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:44:45,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:45,988 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:45,989 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:44:46,032 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:44:46,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:44:47,500 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:44:47,784 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:44:51,955 - ispa_next.functions - DEBUG - Updated appointment (AA00044728) customer contact data.
2025-11-17 10:44:52,932 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:44:52,935 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:44:53,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:44:54,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:44:55,845 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:44:55,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:44:55,927 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:45:00,373 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:00,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:01,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:03,116 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:45:03,375 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:45:03,553 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:45:03,651 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:45:03,652 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:45:15,017 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:46:15,020 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:25,981 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:46:33,386 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:46:33,386 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:46:37,598 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:46:38,614 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:46:38,619 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:46:38,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:38,685 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:46:47,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:48,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:48,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:49,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:46:49,007 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:46:53,900 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:46:53,902 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:46:55,000 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:46:55,006 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:46:55,011 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:46:55,014 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:46:55,016 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:46:55,017 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:46:55,019 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:46:55,020 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:46:55,021 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:46:55,023 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:46:55,024 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:46:55,026 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:46:55,029 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:46:55,031 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:46:55,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:00,498 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:47:00,500 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:47:00,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:05,917 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:47:05,918 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:47:05,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:47:06,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:47:07,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:18,999 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:47:19,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:24,459 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:47:24,461 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:47:24,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:47:25,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:47:25,852 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:35,978 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:40,171 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:45,244 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:49,539 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:54,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:47:59,328 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:04,490 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:04,493 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:04,493 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:05,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:05,275 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:05,277 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:48:07,153 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:48:20,301 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:48:20,303 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:20,304 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:21,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:21,203 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:21,205 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:48:23,356 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:48:23,402 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:48:26,532 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:48:26,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:27,014 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:48:27,016 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:30,109 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 10:48:30,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:48:31,031 - ispa_next.appointments.models - DEBUG - Appointment Weilburger Coatings GmbH WEL-CO 55 WBA15BZ070N263087 ohne Termin.
2025-11-17 10:48:31,040 - ispa_next.appointments.models - DEBUG - Appointment Andreas Lücking HF-XE 555E WBATA610909K70896 ohne Termin.
2025-11-17 10:48:31,052 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:48:31,061 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:48:31,068 - ispa_next.main - DEBUG - 



2025-11-17 10:48:31,068 - ispa_next.main - DEBUG - starting with process 12 (BÜNDE) of 12
2025-11-17 10:48:31,073 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:32,412 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:33,525 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:48:33,527 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 10:48:35,148 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:35,150 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:04,767 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:49:15,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:15,637 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:15,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:17,008 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:49:17,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:17,096 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:17,274 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:49:24,271 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:49:24,274 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:49:24,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:24,343 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:27,305 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:49:27,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:28,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:49:30,893 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:49:31,035 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:49:34,259 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:49:34,335 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:49:34,335 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:49:46,576 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:49:47,582 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:49:47,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:48,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:01,114 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:50:01,114 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:50:08,893 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:50:08,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:09,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:50:09,027 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:50:09,146 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:50:10,395 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:50:11,527 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:50:11,770 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:50:16,020 - ispa_next.functions - DEBUG - Updated appointment (AA00044015) customer contact data.
2025-11-17 10:50:17,051 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:50:17,053 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:50:17,735 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:50:17,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:50:18,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:50:22,612 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:50:22,612 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:22,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:23,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:25,138 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:25,252 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:25,352 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:25,447 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:25,448 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:36,436 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:50:43,502 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:50:43,502 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:50:47,654 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:50:48,677 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:50:48,681 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:50:48,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:48,772 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:50:57,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:58,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:58,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:59,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:59,318 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:51:00,695 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:51:00,697 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:51:01,742 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:51:01,743 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:01,745 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:51:01,749 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:51:01,753 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:51:01,757 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:51:01,760 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:51:01,762 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:51:01,772 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:51:01,777 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:51:01,784 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:51:01,794 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:51:01,797 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:51:01,799 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:51:01,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:03,088 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:51:03,090 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:51:03,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:04,334 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:51:04,336 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:51:04,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:51:05,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:51:05,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:15,826 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:51:15,828 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:17,106 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:51:17,108 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:51:17,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:51:18,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:51:18,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:24,561 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:24,563 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:51:24,564 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:51:25,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:51:25,395 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:51:25,397 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:51:27,414 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:51:35,747 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:51:36,142 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:51:37,124 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:51:37,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:51:37,929 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:51:41,021 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 323
2025-11-17 10:51:41,021 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:51:41,959 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:51:41,974 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:51:41,979 - ispa_next.main - DEBUG - Found new Appointment: WEL-CO 55
2025-11-17 10:51:41,979 - ispa_next.main - DEBUG - Found new Appointment: HF-XE 555E
2025-11-17 10:51:41,980 - ispa_next.main - DEBUG - 



2025-11-17 10:51:41,980 - ispa_next.main - DEBUG - starting with process 13 (WEL-CO 55) of 14
2025-11-17 10:51:41,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:51:43,187 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:51:44,623 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:51:44,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 323
2025-11-17 10:51:46,264 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:51:46,266 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:52:19,449 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:52:30,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:34,541 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:52:34,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:52:34,630 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:52:34,882 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:52:34,886 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:52:34,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:52:35,016 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:52:38,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:52:38,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:52:39,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:52:41,644 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:52:41,791 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:52:41,888 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:52:41,989 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:52:46,147 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:52:47,170 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:52:47,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:52:47,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:03,080 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:53:11,734 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:53:11,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:11,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:53:11,870 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:53:11,924 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:53:13,394 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:53:14,506 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:53:14,753 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:53:18,648 - ispa_next.functions - DEBUG - Updated appointment (AA00044731) customer contact data.
2025-11-17 10:53:19,690 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:53:19,692 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:53:20,497 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:53:20,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:53:21,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:53:25,685 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:53:25,685 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:53:25,685 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:53:25,688 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:53:25,691 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:53:25,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:26,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:32,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:32,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:32,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:33,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:33,702 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:53:37,464 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:53:37,467 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:53:38,452 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:53:38,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:38,455 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:53:38,457 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:53:38,458 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:53:38,459 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:38,461 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:53:38,462 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:53:38,463 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:53:38,465 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:53:38,475 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:53:38,479 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:53:38,485 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:53:38,487 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:53:38,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:42,508 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:53:42,510 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:53:42,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:46,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:46,668 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:57,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:11,868 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:54:11,869 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:54:11,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:54:13,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:54:13,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:23,121 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:54:23,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:27,181 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:54:27,182 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:54:27,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:28,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:54:28,372 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:36,351 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:41,667 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:48,157 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:54:48,158 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:54:48,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:48,898 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:54:48,899 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:54:52,387 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:55:01,201 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:55:01,577 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:55:03,081 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:55:03,766 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:55:03,767 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:55:07,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 322
2025-11-17 10:55:07,518 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:55:08,248 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:55:08,256 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
2025-11-17 10:55:08,262 - ispa_next.main - DEBUG - 



2025-11-17 10:55:08,262 - ispa_next.main - DEBUG - starting with process 14 (HF-XE 555E) of 14
2025-11-17 10:55:08,265 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:55:09,507 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:55:10,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:55:10,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 322
2025-11-17 10:55:12,247 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:55:12,248 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:55:45,985 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:55:57,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:57,105 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:57,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:59,243 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:55:59,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:59,317 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:55:59,581 - ispa_next.functions - DEBUG - HU date already expired after 264 days.
2025-11-17 10:56:06,834 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:56:06,838 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:56:06,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:06,917 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:56:10,167 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:56:10,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:11,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:13,713 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:56:13,907 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:56:17,149 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:56:17,276 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:56:17,276 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:56:29,482 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:56:30,487 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:56:30,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:31,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:46,234 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:56:54,943 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:56:54,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:55,039 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:56:55,047 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:56:55,116 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:56:55,210 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:56:56,526 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:56:57,736 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:56:58,066 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:57:02,061 - ispa_next.functions - DEBUG - Updated appointment (AA00044729) customer contact data.
2025-11-17 10:57:03,028 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:57:03,030 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:57:03,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:57:04,225 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:57:06,043 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:57:06,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:57:06,388 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:57:10,477 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:57:10,477 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:57:10,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:11,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:57:13,017 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:57:13,129 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:57:13,261 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:57:13,362 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:57:13,362 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:57:24,385 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:57:31,983 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:57:31,983 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:57:36,211 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:57:37,217 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:57:37,222 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:57:37,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:37,290 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:57:40,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:41,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:41,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:41,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:57:41,945 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:57:45,090 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:57:45,094 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:57:46,358 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:57:46,360 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:46,362 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:57:46,365 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:57:46,367 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:57:46,372 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:46,382 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:57:46,384 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:57:46,389 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:57:46,390 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:57:46,393 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:57:46,395 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:57:49,006 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:49,544 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:50,464 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:51,039 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:51,584 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:52,505 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:53,067 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:53,602 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:54,506 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:55,068 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:57:55,603 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:57:57,642 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:57:59,076 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:58:00,017 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:58:00,665 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:58:00,686 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:58:00,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:03,349 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:58:03,350 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:58:03,353 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:06,007 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:58:06,010 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:58:06,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:58:07,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:58:07,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:14,177 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:58:14,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:16,823 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:58:16,825 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:58:17,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:58:17,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:58:18,067 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:24,741 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:58:29,021 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:58:33,563 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:58:33,566 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:58:33,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:58:34,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:58:34,159 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:58:34,160 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:58:35,755 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:58:44,709 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:58:44,711 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:58:44,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:58:46,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:58:46,210 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:58:46,211 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:58:48,023 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:58:48,053 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:58:51,153 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 10:58:51,156 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:58:51,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 596
2025-11-17 10:58:51,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:58:54,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 322
2025-11-17 10:58:54,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:55,746 - ispa_next.appointments.models - DEBUG - Appointment Bünder Lichtspiele HF-GX 396 WBA5V31020FH79342 ohne Termin.
2025-11-17 10:58:55,756 - ispa_next.appointments.models - DEBUG - Appointment Grigori Leinweber MI-L 7264 WBAJB31030WC14931 ohne Termin.
