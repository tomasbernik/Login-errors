2025-11-12 11:00:35,394 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:00:35,400 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:01:03,930 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:01:15,620 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:01:31,216 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:03:29,142 - ispa_next.app_start.main - DEBUG - Operation already took 106.36 seconds (more than 80 seconds)
2025-11-12 11:03:31,223 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e8607dd323c5dec0\\tess_llhd668x_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\e8607dd323c5dec0\\tess_llhd668x', 'txt']
2025-11-12 11:03:31,478 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:03:31,482 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:03:31,482 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:03:56,053 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:04:10,666 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:04:13,150 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:04:14,322 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 706
2025-11-12 11:04:14,324 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-12 11:04:16,395 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 167
2025-11-12 11:04:16,396 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:04:16,396 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:04:17,407 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:04:18,594 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:04:41,656 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:04:41,667 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:04:41,721 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-12 11:04:41,755 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-12 11:04:41,770 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-12 11:04:41,780 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-12 11:04:41,790 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-12 11:04:41,800 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-12 11:04:41,807 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-12 11:04:41,814 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-12 11:04:41,858 - ispa_next.main - DEBUG - Found 15 out of 145 appointments to process (configured limit: 15).
2025-11-12 11:04:41,858 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 11:04:41,859 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 11:04:41,859 - ispa_next.main - DEBUG - All appointments: MKK-MG 366, FB-OM 288, BÜD-JX 2, F-BF 400, MKK-AM 806, OF Z 6061, BÜD XP 42, FCG1203, HEF-TT 369, M-FB 6992, FB-RM 411, HU-SU 2014, HU-AS 262, F-CA 525, HN FL 983
2025-11-12 11:04:41,862 - ispa_next.main - DEBUG - 



2025-11-12 11:04:41,862 - ispa_next.main - DEBUG - starting with process 1 (MKK-MG 366) of 15
2025-11-12 11:04:41,866 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:04:42,899 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:04:43,925 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 706
2025-11-12 11:04:43,926 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 167
2025-11-12 11:04:45,260 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:04:45,262 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:05:11,677 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:05:14,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:05:20,056 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:05:20,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:20,154 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:05:20,356 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:05:20,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:20,458 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:05:27,401 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:05:27,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:27,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:05:33,816 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:05:33,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:05:34,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:05:36,642 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:05:42,288 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:05:46,365 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:05:47,370 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:05:47,377 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:05:47,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:47,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:47,869 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:05:47,957 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:05:48,053 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:05:49,209 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:05:49,429 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:05:51,145 - ispa_next.functions - DEBUG - Updated appointment (AD00021124) customer contact data.
2025-11-12 11:05:52,043 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:05:52,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:05:52,139 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:05:53,730 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:05:53,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:05:54,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:05:55,387 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:05:55,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:05:55,468 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:05:59,515 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:05:59,515 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:05:59,515 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:05:59,520 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:05:59,521 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:05:59,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:06:00,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:06:04,140 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:06:06,858 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:06:06,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:06:06,958 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:06:07,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:08,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:06:08,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:06:08,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:06:08,818 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:06:13,573 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:06:13,575 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:06:14,464 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:06:14,466 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:06:14,466 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:06:14,470 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:06:14,470 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:06:14,472 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:06:14,472 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:06:14,474 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:06:14,474 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:06:14,476 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:06:14,478 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:06:14,481 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:06:14,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:19,724 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:06:19,726 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:06:19,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:25,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:06:25,065 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:06:36,924 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:06:36,926 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:06:36,928 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:06:36,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:06:42,221 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:06:42,223 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:06:42,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:06:43,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:06:43,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:07:20,099 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:07:20,100 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:20,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:07:20,718 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:07:20,720 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:07:24,127 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:07:35,069 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:07:35,447 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:07:36,567 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:37,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 706
2025-11-12 11:07:37,263 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:40,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-12 11:07:40,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:07:40,845 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:07:40,853 - ispa_next.main - DEBUG - 



2025-11-12 11:07:40,853 - ispa_next.main - DEBUG - starting with process 2 (FB-OM 288) of 15
2025-11-12 11:07:40,857 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:07:41,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:07:42,796 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 706
2025-11-12 11:07:42,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-12 11:07:43,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:07:43,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:08:12,041 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:08:15,416 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:18,032 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:08:18,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:18,153 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:18,415 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:08:18,419 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:08:18,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:18,481 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:21,848 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:08:21,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:22,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:24,840 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:08:24,961 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:08:25,045 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:08:25,112 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:08:29,277 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:08:30,290 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:08:30,294 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:08:30,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:30,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:30,740 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:08:30,794 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:08:31,985 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:08:33,204 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:08:33,416 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:08:35,044 - ispa_next.functions - DEBUG - Updated appointment (AD00021123) customer contact data.
2025-11-12 11:08:35,947 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:08:35,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:36,017 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:08:36,225 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:08:36,229 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:08:37,057 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:08:37,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:08:37,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:08:41,802 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:08:41,802 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:08:41,806 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:08:41,807 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:08:41,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:42,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:46,444 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:08:46,450 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:08:46,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:46,533 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:08:46,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:47,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:08:47,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:08:48,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:08:48,121 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:08:50,537 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:08:50,539 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:08:51,614 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:08:51,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:08:51,620 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:08:51,622 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:08:51,624 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:08:51,626 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:08:51,626 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:08:51,628 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:08:51,628 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:08:51,630 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:08:51,634 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:08:51,636 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:08:51,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:54,210 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:08:54,212 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:08:54,215 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:56,781 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:08:56,784 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:08:56,788 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:08:56,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:08:59,391 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:08:59,394 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:09:00,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:09:00,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:09:01,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:25,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:09:29,751 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:09:33,845 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:09:33,848 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:09:33,849 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:34,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:09:34,416 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:09:34,419 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:09:36,322 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:09:49,930 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:09:50,319 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:09:51,080 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:51,720 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 706
2025-11-12 11:09:51,722 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:54,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-12 11:09:54,667 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:55,574 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:09:55,583 - ispa_next.main - DEBUG - 



2025-11-12 11:09:55,583 - ispa_next.main - DEBUG - starting with process 3 (BÜD-JX 2) of 15
2025-11-12 11:09:55,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:56,502 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:57,448 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 706
2025-11-12 11:09:57,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-12 11:09:58,854 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:58,855 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:19,951 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:10:23,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:24,386 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:10:24,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:24,447 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:24,720 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:10:24,724 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:10:24,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:24,811 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:27,774 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:27,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:28,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:30,805 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:10:30,915 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:10:30,999 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:10:31,067 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:10:35,233 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:10:36,239 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:10:36,243 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:10:36,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:36,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:36,746 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:10:36,785 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:10:38,009 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:10:39,266 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:10:39,497 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:10:41,057 - ispa_next.functions - DEBUG - Updated appointment (AD00021122) customer contact data.
2025-11-12 11:10:41,947 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:10:41,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:42,022 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:42,173 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:10:42,176 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:10:42,776 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:10:42,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:43,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:10:46,988 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:46,988 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:10:46,991 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:10:46,992 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:10:46,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:47,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:51,573 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:10:51,577 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:10:51,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:51,636 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:11:00,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:00,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:00,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:11:01,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:01,571 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:11:02,855 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:11:02,857 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:11:03,851 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:11:03,852 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:11:03,857 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:11:03,859 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:11:03,864 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:11:03,868 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:11:03,879 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:11:03,883 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:11:03,885 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:11:03,887 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:11:03,902 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:11:03,904 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:11:03,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:05,098 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:11:05,100 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:11:05,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:06,313 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:11:06,317 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:11:06,319 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:11:06,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:07,520 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:11:07,524 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:11:08,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:08,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:11:08,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:22,656 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:11:22,660 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:11:22,660 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:23,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:11:23,433 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:11:23,436 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:11:25,252 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:11:32,297 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:11:32,662 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:11:33,346 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:34,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:11:34,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:36,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-12 11:11:36,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:37,280 - ispa_next.appointments.models - DEBUG - Appointment Vanessa Kyritz RV-HC 1960 WBA4E91060G596905 ohne Termin.
2025-11-12 11:11:37,297 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:11:37,305 - ispa_next.main - DEBUG - 



2025-11-12 11:11:37,305 - ispa_next.main - DEBUG - starting with process 4 (F-BF 400) of 15
2025-11-12 11:11:37,311 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:38,249 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:39,357 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:11:39,359 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-12 11:11:40,923 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:40,923 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:04,778 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:12:08,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:09,945 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:12:09,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:10,013 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:10,229 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:12:10,232 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:12:10,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:10,356 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:13,621 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:13,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:14,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:16,663 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:16,805 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:16,943 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:17,008 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:21,168 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:12:22,175 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:22,181 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:22,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:22,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:22,695 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:22,752 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:24,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:12:25,211 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:25,429 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:12:27,130 - ispa_next.functions - DEBUG - Updated appointment (AD00021115) customer contact data.
2025-11-12 11:12:28,040 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:12:28,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:28,130 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:28,317 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:12:28,321 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:12:29,091 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:12:29,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:29,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:12:33,868 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:12:33,868 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:33,868 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:12:33,873 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:12:33,877 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:12:33,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:34,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:38,449 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:12:41,244 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:12:41,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:41,357 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:12:41,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:42,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:42,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:42,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:42,833 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:12:44,719 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:12:44,721 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:12:45,633 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:12:45,635 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:45,637 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:12:45,637 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:45,639 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:12:45,639 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:12:45,639 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:12:45,642 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:12:45,646 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:12:45,648 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:12:45,654 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:12:45,657 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:12:45,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:47,583 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:12:49,825 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:12:49,827 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:12:49,844 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:51,912 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:12:51,914 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:12:51,915 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:12:51,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:53,739 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:12:53,741 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:12:54,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:12:55,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:12:55,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:12,828 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:13:19,668 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:13:19,671 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:13:19,673 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:20,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:13:20,374 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:13:20,378 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:13:22,403 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:13:29,591 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:13:30,004 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:13:30,565 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:31,418 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:13:31,419 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:34,449 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-12 11:13:34,450 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:35,261 - ispa_next.appointments.models - DEBUG - Appointment Vanessa Kyritz RV-HC 1960 WBA4E91060G596905 ohne Termin.
2025-11-12 11:13:35,276 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:13:35,285 - ispa_next.main - DEBUG - 



2025-11-12 11:13:35,285 - ispa_next.main - DEBUG - starting with process 5 (MKK-AM 806) of 15
2025-11-12 11:13:35,289 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:36,170 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:36,995 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:13:36,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-12 11:13:38,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:38,260 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:11,693 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:14:11,793 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:14:11,801 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:12,400 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:14:12,402 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:14,854 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-12 11:14:14,855 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:15,532 - ispa_next.appointments.models - DEBUG - Appointment Vanessa Kyritz RV-HC 1960 WBA4E91060G596905 ohne Termin.
2025-11-12 11:14:15,548 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:14:15,556 - ispa_next.main - DEBUG - 



2025-11-12 11:14:15,556 - ispa_next.main - DEBUG - starting with process 6 (OF Z 6061) of 15
2025-11-12 11:14:15,560 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:16,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:17,307 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:14:17,308 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-12 11:14:18,628 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:18,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:49,559 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:14:49,570 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:14:49,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:50,019 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:14:50,020 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:52,741 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-12 11:14:52,741 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:53,578 - ispa_next.appointments.models - DEBUG - Appointment Vanessa Kyritz RV-HC 1960 WBA4E91060G596905 ohne Termin.
2025-11-12 11:14:53,594 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:14:53,601 - ispa_next.main - DEBUG - 



2025-11-12 11:14:53,602 - ispa_next.main - DEBUG - starting with process 7 (BÜD XP 42) of 15
2025-11-12 11:14:53,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:54,812 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:55,992 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:14:55,993 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-12 11:14:57,591 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:57,592 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:32,663 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:15:32,673 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:15:32,678 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:33,168 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:15:33,170 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:36,033 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-12 11:15:36,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:37,161 - ispa_next.appointments.models - DEBUG - Appointment Vanessa Kyritz RV-HC 1960 WBA4E91060G596905 ohne Termin.
2025-11-12 11:15:37,178 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:15:37,185 - ispa_next.main - DEBUG - 



2025-11-12 11:15:37,185 - ispa_next.main - DEBUG - starting with process 8 (FCG1203) of 15
2025-11-12 11:15:37,190 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:38,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:39,199 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:15:39,200 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-12 11:15:40,491 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:40,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:12,789 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:16:12,798 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:16:12,804 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:13,380 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:16:13,382 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:15,943 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-12 11:16:15,944 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:16,807 - ispa_next.appointments.models - DEBUG - Appointment Vanessa Kyritz RV-HC 1960 WBA4E91060G596905 ohne Termin.
2025-11-12 11:16:16,822 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:16:16,829 - ispa_next.main - DEBUG - 



2025-11-12 11:16:16,829 - ispa_next.main - DEBUG - starting with process 9 (HEF-TT 369) of 15
2025-11-12 11:16:16,833 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:18,124 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:19,344 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:16:19,346 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-12 11:16:20,829 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:20,830 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:45,602 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:16:48,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:53,549 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:16:53,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:53,622 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:53,869 - ispa_next.functions - DEBUG - HU date already expired after 747 days.
2025-11-12 11:16:57,261 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:16:57,265 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:16:57,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:57,350 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:04,034 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:04,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:05,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:07,080 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:17:07,183 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:17:07,276 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:17:07,358 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:17:11,541 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:17:12,546 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:17:12,550 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:17:12,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:13,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:13,055 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:17:13,131 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:17:14,317 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:17:15,419 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:17:15,624 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:17:17,675 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:17:17,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:17,776 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:17,920 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:17:17,924 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:17:18,726 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:17:18,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:17:19,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:17:23,585 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:23,585 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:17:23,589 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:17:23,589 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:17:23,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:24,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:28,279 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:17:28,283 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:17:28,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:28,354 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:17:28,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:29,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:29,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:30,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:30,008 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:17:34,225 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:17:34,227 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:17:35,203 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:17:35,207 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:35,210 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:17:35,211 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:35,213 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:17:35,215 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:17:35,216 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:17:35,218 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:17:35,218 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:17:35,220 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:17:35,222 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:17:35,226 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:17:35,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:39,887 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:17:42,562 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:17:42,586 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:17:42,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:47,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:47,311 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:17:59,578 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:17:59,580 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:17:59,582 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:17:59,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:04,299 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:04,301 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:05,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:05,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:05,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:45,289 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:49,650 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:53,790 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:57,220 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:01,328 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:19:01,332 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:19:01,332 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:02,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:19:02,121 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:19:02,123 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:19:04,019 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:19:11,809 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:19:12,189 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:19:13,189 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:13,774 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:19:13,775 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:16,276 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-12 11:19:16,276 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:16,970 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:19:16,977 - ispa_next.main - DEBUG - Found new Appointment: RV-HC 1960
2025-11-12 11:19:16,979 - ispa_next.main - DEBUG - 



2025-11-12 11:19:16,979 - ispa_next.main - DEBUG - starting with process 10 (RV-HC 1960) of 16
2025-11-12 11:19:16,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:17,901 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:18,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:19:18,754 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-12 11:19:20,195 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:20,197 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:56,037 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:59,107 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:02,359 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:20:02,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:02,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:02,683 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:20:02,689 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:20:02,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:02,806 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:12,992 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:12,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:13,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:15,911 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:20:16,037 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:20:16,123 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:20:16,178 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:20:18,321 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:20:19,325 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:20:19,330 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:19,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:19,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:19,825 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:19,972 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:21,193 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:21,405 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:25,504 - ispa_next.functions - DEBUG - Updated appointment (AD00021127) customer contact data.
2025-11-12 11:20:26,472 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:26,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:27,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:27,335 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:20:27,336 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:28,067 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:28,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:28,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:33,324 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:33,324 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:20:33,329 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:33,330 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:20:33,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:33,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:38,138 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:20:38,948 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:20:50,205 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:50,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:50,321 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:20:54,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:54,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:54,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:55,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:55,437 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:59,151 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:59,153 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:21:00,283 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:21:00,284 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:21:00,285 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:21:00,287 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:21:00,288 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:21:00,290 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:21:00,292 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:21:00,298 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:21:00,302 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:21:00,304 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:21:00,309 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:21:00,311 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:21:00,311 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:04,255 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:21:04,257 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:21:04,259 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:08,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:21:08,270 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:21:19,686 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:21:19,689 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:21:19,692 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:19,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:23,772 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:23,776 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:24,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:25,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:25,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:59,699 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:06,453 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:12,580 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:17,979 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:17,982 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:17,983 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:18,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:18,842 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:18,844 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:21,129 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:32,786 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:33,166 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:22:35,545 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:36,380 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:22:36,382 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:41,410 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-12 11:22:41,410 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:42,721 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:22:42,731 - ispa_next.main - DEBUG - 



2025-11-12 11:22:42,731 - ispa_next.main - DEBUG - starting with process 11 (M-FB 6992) of 16
2025-11-12 11:22:42,737 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:44,619 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:46,321 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 707
2025-11-12 11:22:46,322 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-12 11:22:48,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:48,481 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:19,685 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:23:23,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:25,994 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:23:25,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:26,120 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:26,472 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:23:31,704 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:23:31,708 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:23:31,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:31,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:35,181 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:35,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:36,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:38,816 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:38,944 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:39,108 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:39,259 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:23:39,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:42,036 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:23:51,279 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:23:52,285 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:23:52,292 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:23:52,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:52,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:52,838 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:23:52,926 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:23:53,075 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:23:54,229 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:23:55,535 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:23:55,898 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:23:57,828 - ispa_next.functions - DEBUG - Updated appointment (AZ00002280) customer contact data.
2025-11-12 11:23:58,721 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:23:58,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:58,940 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:59,165 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:23:59,167 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:23:59,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:00,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:24:01,536 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:24:01,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:01,631 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:24:05,717 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:05,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:06,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:08,221 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:08,362 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:24:08,488 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:24:08,601 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:24:08,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:11,283 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:24:20,425 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:25:20,428 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:25:29,520 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:26:20,523 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:26:29,484 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:26:34,178 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:26:35,203 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:26:35,204 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:26:35,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:35,317 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:26:39,440 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:26:39,447 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:26:39,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:39,571 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:26:45,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:45,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:45,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:46,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:46,458 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:26:48,965 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:26:48,967 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:26:50,197 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:26:50,199 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:50,200 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:26:50,202 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:50,206 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:26:50,208 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:26:50,210 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:26:50,210 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:26:50,212 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:26:50,212 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:26:50,216 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:26:50,218 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:26:50,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:52,857 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:26:52,861 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:26:52,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:55,519 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:26:55,523 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:26:55,525 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:26:55,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:58,142 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:26:58,146 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:26:58,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:26:59,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:00,052 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:26,268 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:31,611 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:37,150 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:37,154 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:27:37,154 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:38,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:38,163 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:27:38,166 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:27:40,920 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:27:51,223 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:27:51,592 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:27:53,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:27:54,267 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 708
2025-11-12 11:27:54,267 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:58,305 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-12 11:27:58,306 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:59,246 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:27:59,253 - ispa_next.main - DEBUG - 



2025-11-12 11:27:59,253 - ispa_next.main - DEBUG - starting with process 12 (FB-RM 411) of 16
2025-11-12 11:27:59,258 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:00,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:02,025 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 708
2025-11-12 11:28:02,026 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-12 11:28:03,815 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:03,816 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:33,591 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:28:37,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:40,599 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:28:40,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:40,715 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:40,970 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:28:40,974 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:28:40,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:41,078 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:28:44,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:28:44,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:28:46,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:28:48,007 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:28:48,175 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:28:48,339 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:28:48,474 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:28:52,721 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:28:53,727 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:28:53,733 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:28:53,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:54,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:28:54,289 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:28:54,349 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:28:56,092 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:28:57,319 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:28:57,524 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:28:59,400 - ispa_next.functions - DEBUG - Updated appointment (AA00029960) customer contact data.
2025-11-12 11:29:00,363 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:29:00,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:00,585 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:29:03,571 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:29:04,803 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:29:04,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:29:05,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:29:09,541 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:29:09,541 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:29:09,546 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:29:09,547 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:29:09,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:10,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:14,252 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:29:14,256 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:29:14,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:14,377 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:29:23,247 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 11:29:35,590 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:29:35,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:36,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:29:36,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:37,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:29:37,763 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:29:40,848 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:29:40,852 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:29:42,144 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:29:42,146 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:42,147 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:29:42,147 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:29:42,149 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:29:42,151 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:29:42,152 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:29:42,154 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:29:42,155 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:29:42,156 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:29:42,160 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:29:42,163 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:29:42,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:45,483 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:29:45,489 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:29:45,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:48,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:29:48,943 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:30:00,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:13,991 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:30:13,993 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:30:13,995 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:30:13,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:17,345 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:30:17,347 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:30:18,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:30:20,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:30:20,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:53,539 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:01,215 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:07,084 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:13,958 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:31:13,962 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:31:13,962 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:14,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:31:15,066 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:31:15,070 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:31:17,493 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:31:29,296 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:31:29,683 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:31:32,314 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:33,267 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 709
2025-11-12 11:31:33,269 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:37,572 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-12 11:31:37,573 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:38,516 - ispa_next.appointments.models - DEBUG - Appointment Ralf Becker HU-GB 757 E WMW11DJ0102S73280 ohne Termin.
2025-11-12 11:31:38,529 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:31:38,536 - ispa_next.main - DEBUG - 



2025-11-12 11:31:38,536 - ispa_next.main - DEBUG - starting with process 13 (HU-SU 2014) of 16
2025-11-12 11:31:38,539 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:39,993 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:41,779 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 709
2025-11-12 11:31:41,781 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-12 11:31:43,994 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:43,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:17,451 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:32:21,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:24,585 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:32:24,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:24,669 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:25,000 - ispa_next.functions - DEBUG - HU date already expired after 16 days.
2025-11-12 11:32:30,587 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:32:30,591 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:32:30,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:30,674 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:39,721 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:32:39,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:41,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:32:43,480 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:32:43,654 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:32:43,800 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:32:43,894 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:32:48,062 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:32:49,069 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:32:49,082 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:32:49,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:49,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:49,557 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:32:49,612 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:32:49,756 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:32:51,098 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:32:51,339 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:32:53,865 - ispa_next.functions - DEBUG - Updated appointment (AT00004939) customer contact data.
2025-11-12 11:32:54,810 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:32:54,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:55,003 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:55,229 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:32:55,233 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:32:55,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:32:56,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:32:57,898 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:32:57,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:32:58,014 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:33:01,632 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:33:01,633 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:33:01,639 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:33:01,639 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:33:01,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:02,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:06,376 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:33:11,998 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:33:11,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:12,079 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:33:15,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:16,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:16,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:17,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:17,051 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:33:20,331 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:33:20,335 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:33:23,052 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:33:23,054 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:23,056 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:33:23,056 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:23,058 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:33:23,060 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:33:23,060 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:33:23,062 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:33:23,064 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:33:23,066 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:33:23,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:33:23,075 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:33:23,089 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:26,427 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:33:26,431 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:33:26,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:29,718 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:33:29,721 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:33:29,723 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:33:29,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:33,021 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:33:33,023 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:33:33,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:33:34,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:33:35,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:07,618 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:12,083 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:16,568 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:22,397 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:34:22,401 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:34:22,403 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:23,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:23,530 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:34:23,533 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:34:26,273 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:34:37,284 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:34:37,682 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:34:39,797 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:40,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 710
2025-11-12 11:34:40,799 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:45,818 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-12 11:34:45,819 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:34:47,053 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:34:47,061 - ispa_next.main - DEBUG - 



2025-11-12 11:34:47,061 - ispa_next.main - DEBUG - starting with process 14 (HU-AS 262) of 16
2025-11-12 11:34:47,065 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:34:48,905 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:34:50,274 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 710
2025-11-12 11:34:50,275 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-12 11:34:52,063 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:34:52,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:35:32,040 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:35:35,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:37,466 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:35:37,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:37,548 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:37,779 - ispa_next.functions - DEBUG - HU date already expired after 261 days.
2025-11-12 11:35:42,088 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:35:42,099 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:35:42,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:35:42,169 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:35:49,601 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:35:49,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:35:50,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:35:52,981 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:36:01,057 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:36:06,707 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:36:07,714 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:36:07,718 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:36:07,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:08,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:08,244 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:36:08,316 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:36:08,513 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:36:09,823 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:36:10,061 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:36:12,268 - ispa_next.functions - DEBUG - Updated appointment (AG00016916) customer contact data.
2025-11-12 11:36:13,216 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:36:13,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:13,453 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:36:13,675 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:36:13,681 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:36:13,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:36:14,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:36:16,040 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:36:16,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:36:16,174 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:36:20,188 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:36:20,188 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:36:20,188 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:36:20,190 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:36:20,192 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:36:20,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:20,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:24,875 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:36:24,879 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:36:24,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:24,958 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:36:25,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:25,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:25,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:26,545 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:26,545 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:36:28,411 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:36:28,413 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:36:29,654 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:36:29,655 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:29,656 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:36:29,658 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:29,659 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:36:29,660 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:36:29,667 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:36:29,671 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:36:29,673 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:36:29,681 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:36:29,687 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:36:29,691 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:36:29,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:31,684 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:36:34,827 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:36:34,866 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:36:34,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:37,648 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:36:37,651 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:36:37,654 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:36:37,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:39,563 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:36:39,567 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:36:40,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:41,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:36:41,576 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:01,167 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:37:06,152 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:37:06,156 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:37:06,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:37:06,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:37:06,952 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:37:06,954 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:37:09,042 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:37:17,913 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:37:18,305 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:37:20,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:20,862 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 710
2025-11-12 11:37:20,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:25,112 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-12 11:37:25,113 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:37:26,033 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:37:26,041 - ispa_next.main - DEBUG - 



2025-11-12 11:37:26,041 - ispa_next.main - DEBUG - starting with process 15 (F-CA 525) of 16
2025-11-12 11:37:26,045 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:37:27,448 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:37:28,811 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 710
2025-11-12 11:37:28,812 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-12 11:37:30,614 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:30,616 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:38:01,073 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:38:04,747 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:06,688 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:38:06,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:06,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:07,170 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 11:38:13,296 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:38:13,302 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:38:13,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:13,409 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:16,855 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:38:16,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:18,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:20,486 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:38:20,688 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:38:20,820 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:38:20,964 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:38:20,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:23,059 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:38:31,952 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:38:32,957 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:38:32,963 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:38:32,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:33,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:33,527 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:38:33,579 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:38:33,753 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:38:34,986 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:38:35,220 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:38:37,347 - ispa_next.functions - DEBUG - Updated appointment (AV00003233) customer contact data.
2025-11-12 11:38:38,247 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:38:38,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:38,455 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:38,708 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:38:38,713 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:38:38,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:38:39,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:38:41,445 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:38:41,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:38:41,548 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:38:45,129 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:38:45,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:45,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:47,650 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:38:47,799 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:38:47,988 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:38:48,144 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:38:48,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:50,221 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:38:59,020 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:39:59,023 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:40:08,478 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:41:01,482 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:41:10,194 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:41:15,570 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:41:16,576 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:41:16,576 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:41:16,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:16,717 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:41:20,840 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:41:20,844 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:41:20,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:20,950 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:41:26,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:27,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:27,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:27,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:27,772 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:41:29,792 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:41:29,794 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:41:31,143 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:41:31,144 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:31,146 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:41:31,147 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:31,148 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:41:31,150 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:41:31,150 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:41:31,152 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:41:31,153 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:41:31,154 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:41:31,158 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:41:31,160 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:41:31,160 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:33,146 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:41:33,148 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:41:33,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:35,098 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:41:35,100 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:41:35,102 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:41:35,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:37,088 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:41:37,092 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:41:37,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:41:38,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:41:39,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:58,579 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:04,516 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:42:04,520 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:42:04,520 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:05,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:42:05,595 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:42:05,597 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:42:08,265 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:42:19,523 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:42:19,898 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:42:21,848 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:22,943 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 709
2025-11-12 11:42:22,944 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:27,506 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 11:42:27,507 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:42:28,659 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
2025-11-12 11:42:28,670 - ispa_next.main - DEBUG - 



2025-11-12 11:42:28,670 - ispa_next.main - DEBUG - starting with process 16 (HN FL 983) of 16
2025-11-12 11:42:28,674 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:30,439 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:32,220 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 709
2025-11-12 11:42:32,221 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 11:42:34,268 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:34,269 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:43:11,297 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:43:11,310 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 11:43:11,320 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:43:12,151 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 709
2025-11-12 11:43:12,152 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:43:16,405 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 11:43:16,406 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:43:17,607 - ispa_next.appointments.models - DEBUG - Appointment Erich Reichert MKK-ER 741 WBAJG31070EE22351 ohne Termin.
