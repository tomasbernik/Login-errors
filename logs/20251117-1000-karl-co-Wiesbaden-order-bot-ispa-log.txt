2025-11-17 10:07:34,014 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:07:34,022 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:07:42,939 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:07:53,245 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:08:08,847 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:10:07,060 - ispa_next.app_start.main - DEBUG - Operation already took 106.93 seconds (more than 80 seconds)
2025-11-17 10:10:09,144 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c74cb78ab4ea7f2e\\tess_sm93_v61_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c74cb78ab4ea7f2e\\tess_sm93_v61', 'txt']
2025-11-17 10:10:09,481 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 10:10:09,485 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 10:10:09,486 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:12:08,626 - ispa_next.app_start.main - DEBUG - Operation already took 106.77 seconds (more than 80 seconds)
2025-11-17 10:12:10,703 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c74cb78ab4ea7f2e\\tess_gsz50w39_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c74cb78ab4ea7f2e\\tess_gsz50w39', 'txt']
2025-11-17 10:12:10,934 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 10:12:10,940 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 10:12:17,349 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 10:12:26,191 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:12:36,429 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:12:52,019 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:13:32,301 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:13:43,904 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:13:46,789 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:48,044 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1332
2025-11-17 10:13:48,044 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 37
2025-11-17 10:13:50,679 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 35
2025-11-17 10:13:50,680 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:13:50,681 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:13:51,922 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:13:53,134 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:13:57,321 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,326 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,326 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,327 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,327 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,327 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,328 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,328 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:13:57,335 - ispa_next.main - DEBUG - Found 9 out of 17 appointments to process (configured limit: 15).
2025-11-17 10:13:57,335 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-17 10:13:57,335 - ispa_next.main - DEBUG - All appointments: BI-D 3116, WI-MR 503E, WI-US 808, rüd-0628, WI-P-1860, MJIJ233, WI-LI187E, ZH694412, MZ S 2350E
2025-11-17 10:13:57,338 - ispa_next.main - DEBUG - 



2025-11-17 10:13:57,338 - ispa_next.main - DEBUG - starting with process 1 (BI-D 3116) of 9
2025-11-17 10:13:57,341 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:58,481 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:59,670 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1332
2025-11-17 10:13:59,671 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 35
2025-11-17 10:14:03,262 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:03,263 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:34,971 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:14:44,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:44,799 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:44,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:46,252 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:14:46,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:46,325 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:46,494 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:14:46,498 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:14:49,364 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:14:49,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:50,472 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:52,478 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:14:52,580 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:14:55,834 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:14:55,906 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:14:55,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:57,148 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:08,467 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:15:09,471 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:15:09,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:09,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:20,300 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:15:27,257 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:15:27,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:27,336 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:27,338 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:15:27,369 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:15:28,615 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:15:29,757 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:15:30,041 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:15:35,669 - ispa_next.functions - DEBUG - Updated appointment (AE00049818) customer contact data.
2025-11-17 10:15:36,600 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:15:36,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:36,669 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:38,519 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:15:39,371 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:15:39,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:15:40,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:15:44,589 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:44,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:45,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:47,113 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:47,229 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:15:47,335 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:15:47,406 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:15:47,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:49,329 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:00,823 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:16:07,890 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:16:07,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:09,860 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:16:14,029 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:16:15,033 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:16:15,035 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:16:15,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:15,109 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:19,244 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:16:19,248 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:16:19,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:19,317 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:24,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:25,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:25,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:26,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:26,074 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:16:27,956 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:16:27,958 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:16:28,972 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:16:28,977 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:28,979 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:16:28,987 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:16:28,989 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:28,990 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:16:28,992 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:16:28,992 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:16:28,994 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:16:28,996 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:16:28,996 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:16:29,013 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:16:29,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:16:30,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:16:42,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:16:43,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:16:56,264 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:16:56,266 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:16:56,266 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:16:56,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:59,478 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:16:59,478 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:16:59,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:02,731 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:17:02,733 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:17:02,733 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:17:02,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:05,952 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:17:20,298 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:17:20,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:21,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:17:21,945 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:35,573 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:17:35,573 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:36,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:36,125 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:17:36,126 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:17:40,682 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:17:51,462 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:17:51,831 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:17:52,824 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:17:53,916 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1332
2025-11-17 10:17:53,918 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:17:56,939 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 37
2025-11-17 10:17:56,940 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:17:57,765 - ispa_next.appointments.models - DEBUG - Appointment Firma Christian Gemmerich WI-C 800 WBAJD51040BT98268 ohne Termin.
2025-11-17 10:17:57,773 - ispa_next.main - DEBUG - 



2025-11-17 10:17:57,773 - ispa_next.main - DEBUG - starting with process 2 (WI-MR 503E) of 9
2025-11-17 10:17:57,776 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:59,002 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:00,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1332
2025-11-17 10:18:00,305 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 37
2025-11-17 10:18:01,749 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:01,749 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:18:33,116 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:18:43,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:49,216 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:18:49,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:49,293 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:49,525 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:18:49,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:49,628 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:54,414 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:18:57,090 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:18:57,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:57,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:59,785 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:18:59,898 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:19:03,092 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:19:03,236 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:19:05,338 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:19:06,342 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:19:06,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:06,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:18,872 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:19:26,814 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:19:26,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:26,900 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:26,900 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:19:26,930 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:19:28,177 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:19:28,397 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:19:34,089 - ispa_next.functions - DEBUG - Updated appointment (AE00049811) customer contact data.
2025-11-17 10:19:35,063 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:19:35,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:35,138 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:35,359 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:19:35,361 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:19:36,168 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:19:36,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:19:36,846 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:19:40,404 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:40,405 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:19:40,408 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:19:40,409 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:19:40,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:40,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:45,054 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:19:45,711 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:19:58,505 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:19:58,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:58,665 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:19:59,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:59,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:59,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:00,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:00,328 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:20:05,177 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:20:05,181 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:20:06,511 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:20:06,513 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:06,515 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:20:06,517 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:20:06,519 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:06,521 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:20:06,521 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:20:06,524 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:20:06,526 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:20:06,532 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:20:06,537 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:20:07,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:20:08,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:20:21,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:20:22,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:20:36,302 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:20:36,302 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:20:39,337 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:39,868 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:40,838 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:41,423 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:41,956 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:43,415 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:44,045 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:44,606 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:45,534 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:46,140 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:46,676 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:47,617 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:48,215 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:48,749 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:49,683 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:50,243 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:50,814 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:51,837 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:52,446 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:52,993 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:53,940 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:54,534 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:55,082 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:56,016 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:56,623 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:20:57,169 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:20:58,134 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:20:59,366 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:21:00,342 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:21:01,240 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:21:01,253 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:21:01,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:07,391 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:21:13,868 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:21:13,923 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:21:13,926 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:20,144 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:21:20,145 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:21:20,147 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:21:20,149 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:26,274 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:21:46,356 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:21:47,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:47,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:21:48,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:48,860 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:57,265 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:03,357 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:08,816 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:14,383 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:20,812 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:26,888 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:32,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:32,244 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:23:32,244 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:33,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:33,203 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:23:33,203 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:23:35,709 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:23:47,600 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:23:47,984 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:23:50,230 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:51,167 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1335
2025-11-17 10:23:51,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:55,329 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 40
2025-11-17 10:23:55,330 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:56,399 - ispa_next.appointments.models - DEBUG - Appointment Firma SteMan GmbH Beteiligungen WI-S 2797E WBY31AW0X0FR99696 ohne Termin.
2025-11-17 10:23:56,413 - ispa_next.appointments.models - DEBUG - Appointment Firma S Broker AG & Co. KG WI-MB 628 WBA61FZ000FP33687 ohne Termin.
2025-11-17 10:23:56,419 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:23:56,429 - ispa_next.appointments.models - DEBUG - Appointment Firma Christian Gemmerich WI-C 800 WBAJD51040BT98268 ohne Termin.
2025-11-17 10:23:56,435 - ispa_next.main - DEBUG - 



2025-11-17 10:23:56,436 - ispa_next.main - DEBUG - starting with process 3 (WI-US 808) of 9
2025-11-17 10:23:56,439 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:57,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:59,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1335
2025-11-17 10:23:59,305 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 40
2025-11-17 10:24:00,968 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:24:00,969 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:50,357 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:25:03,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:03,289 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:03,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:06,861 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:25:06,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:06,940 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:07,273 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:25:07,278 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:25:10,321 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:10,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:11,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:13,920 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:25:14,070 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:25:17,416 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:25:17,540 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:25:17,541 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:21,111 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:25:38,613 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:25:39,631 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:25:39,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:40,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:55,428 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:25:55,428 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:26:05,123 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:26:05,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:05,257 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:26:05,259 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:26:05,304 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:26:06,672 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:26:06,940 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:26:13,222 - ispa_next.functions - DEBUG - Updated appointment (AE00049810) customer contact data.
2025-11-17 10:26:14,188 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:26:14,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:14,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:26:14,669 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:26:14,671 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:26:15,931 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:26:15,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:26:16,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:26:20,401 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:26:20,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:20,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:22,919 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:26:23,059 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:26:23,233 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:26:23,378 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:26:23,380 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:26,742 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:38,057 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:26:45,647 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:26:45,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:49,063 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:26:53,251 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:26:54,259 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:26:54,260 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:26:54,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:54,358 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:26:58,520 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:26:58,522 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:26:58,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:58,635 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:27:04,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:04,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:04,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:05,697 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:05,697 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:27:08,739 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:27:08,741 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:27:09,869 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:27:09,871 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:09,873 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:27:09,875 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:27:09,879 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:09,881 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:27:09,882 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:27:09,883 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:27:09,885 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:27:09,886 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:27:09,887 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:27:09,889 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:27:10,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:27:11,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:27:23,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:27:24,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:27:38,671 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:27:38,673 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:27:38,674 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:27:38,675 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:43,472 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:27:43,473 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:27:43,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:48,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:48,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:59,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:16,255 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:28:16,257 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:28:16,260 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:28:16,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:21,046 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:28:39,743 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:28:40,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:28:41,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:28:41,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:04,478 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:29:04,480 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:05,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:05,414 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:29:05,414 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:29:10,885 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:29:23,417 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:29:23,795 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:29:26,209 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:29:27,261 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1334
2025-11-17 10:29:27,263 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:29:31,447 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 40
2025-11-17 10:29:31,448 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:29:32,713 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:29:32,724 - ispa_next.appointments.models - DEBUG - Appointment Firma Christian Gemmerich WI-C 800 WBAJD51040BT98268 ohne Termin.
2025-11-17 10:29:32,730 - ispa_next.main - DEBUG - Found new Appointment: WI-S 2797E
2025-11-17 10:29:32,730 - ispa_next.main - DEBUG - Found new Appointment: WI-MB 628
2025-11-17 10:29:32,732 - ispa_next.main - DEBUG - 



2025-11-17 10:29:32,732 - ispa_next.main - DEBUG - starting with process 4 (WI-S 2797E) of 11
2025-11-17 10:29:32,737 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:29:34,622 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:29:36,325 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1334
2025-11-17 10:29:36,327 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 40
2025-11-17 10:29:38,324 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:29:38,326 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:30:21,621 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:30:34,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:34,901 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:35,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:36,475 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:30:36,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:36,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:30:37,041 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:30:37,045 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:30:40,133 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:30:40,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:41,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:30:43,537 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:30:43,698 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:30:46,983 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:30:47,117 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:30:47,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:48,362 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:00,297 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:31:01,302 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:31:01,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:01,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:16,193 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:31:25,654 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:31:25,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:25,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:25,738 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:31:25,805 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:31:27,333 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:31:28,615 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:31:29,278 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:31:35,506 - ispa_next.functions - DEBUG - Updated appointment (AE00049828) customer contact data.
2025-11-17 10:31:37,026 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:31:37,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:31:37,131 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:31:37,404 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:31:37,405 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:31:38,634 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:31:38,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:31:39,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:31:43,212 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:31:43,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:43,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:45,731 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:31:45,878 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:31:46,040 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:31:46,167 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:31:46,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:47,460 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:31:58,572 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:32:06,261 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:32:06,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:07,854 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:32:12,018 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:32:13,023 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:32:13,023 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:32:13,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:13,131 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:32:17,313 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:32:17,318 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:32:17,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:17,427 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:32:23,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:23,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:23,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:24,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:32:24,394 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:32:25,678 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:32:25,681 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:32:27,099 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:32:27,102 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:32:27,105 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:32:27,107 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:32:27,109 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:32:27,112 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:32:27,116 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:32:27,134 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:32:27,136 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:32:27,136 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:32:27,139 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:32:27,141 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:32:27,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:32:28,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:32:41,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:32:42,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:32:56,835 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:32:56,837 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:32:56,837 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:32:56,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:59,472 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:32:59,474 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:32:59,476 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:02,123 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:33:02,126 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:33:02,128 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:33:02,130 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:04,724 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:33:22,385 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:33:23,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:33:23,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:33:24,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:39,306 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:33:39,307 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:33:40,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:33:40,531 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:33:40,532 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:33:48,143 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:34:01,219 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:34:01,605 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:34:03,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:34:04,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1336
2025-11-17 10:34:04,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:34:09,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 42
2025-11-17 10:34:09,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:34:10,618 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:34:10,623 - ispa_next.main - DEBUG - Found new Appointment: HH-ZC 444
2025-11-17 10:34:10,623 - ispa_next.main - DEBUG - Found new Appointment: WI-MR 503E
2025-11-17 10:34:10,625 - ispa_next.main - DEBUG - 



2025-11-17 10:34:10,625 - ispa_next.main - DEBUG - starting with process 5 (HH-ZC 444) of 13
2025-11-17 10:34:10,629 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:34:12,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:34:14,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1336
2025-11-17 10:34:14,457 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 42
2025-11-17 10:34:16,617 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:34:16,618 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:35:02,426 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:35:14,676 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:15,910 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:35:15,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:16,029 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:16,347 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:35:24,707 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:35:24,709 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:35:27,505 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:27,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:28,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:30,845 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:35:30,959 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:35:34,224 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:35:34,331 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:35:38,548 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:35:39,553 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:35:39,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:40,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:55,124 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:36:04,639 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:36:04,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:04,736 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:04,738 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:36:04,805 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:36:06,231 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:36:07,526 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:36:07,823 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:36:13,668 - ispa_next.functions - DEBUG - Updated appointment (AE00049832) customer contact data.
2025-11-17 10:36:14,583 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:36:14,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:15,081 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:36:15,442 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:36:15,444 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:36:16,713 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:36:16,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:36:17,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:36:21,521 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:36:21,523 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:36:21,525 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:36:21,525 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:36:21,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:22,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:26,203 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:36:26,207 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:36:26,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:26,281 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:36:35,798 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-17 10:36:43,416 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:36:43,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:44,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:44,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:45,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:45,321 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:36:46,705 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:36:46,707 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:36:47,835 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:36:47,836 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:36:47,839 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:36:47,843 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:36:47,845 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:36:47,847 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:36:47,848 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=advice_list)}
2025-11-17 10:36:47,850 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:36:47,852 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:36:47,853 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:36:47,855 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:36:47,857 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:36:48,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:36:49,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:37:01,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:37:03,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:37:17,377 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:37:17,379 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:37:39,691 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:37:39,691 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:37:47,719 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:37:47,720 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:37:47,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:50,464 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:37:54,221 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:37:54,325 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:37:54,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:57,036 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:37:57,038 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:37:57,040 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:37:57,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:59,813 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:38:18,133 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:38:18,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:19,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:38:19,987 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:49,522 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:55,947 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:01,163 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:01,165 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:01,167 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:02,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:02,104 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:02,105 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:04,932 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:39:18,254 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:39:18,255 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:18,256 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:20,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:20,279 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:20,280 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:22,752 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:39:22,780 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:39:27,119 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:39:27,122 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:28,038 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1335
2025-11-17 10:39:28,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:32,647 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-17 10:39:32,648 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:34,009 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:39:34,014 - ispa_next.main - DEBUG - 



2025-11-17 10:39:34,015 - ispa_next.main - DEBUG - starting with process 6 (WI-MR 503E) of 13
2025-11-17 10:39:34,018 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:36,077 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:38,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1335
2025-11-17 10:39:38,006 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-17 10:39:40,324 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:40,326 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:18,367 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:40:31,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:31,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:32,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:33,414 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:40:33,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:33,529 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:33,842 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:40:33,845 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:40:36,844 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:36,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:38,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:40,275 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:40,407 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:43,670 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:43,802 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:40:43,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:45,090 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:40:56,852 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:40:57,857 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:40:57,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:58,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:13,782 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:41:23,753 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:41:23,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:23,848 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:23,849 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:41:23,914 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:41:25,294 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:41:25,598 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:41:32,470 - ispa_next.functions - DEBUG - Updated appointment (AE00049831) customer contact data.
2025-11-17 10:41:33,448 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:41:33,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:33,674 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:33,959 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 10:41:33,959 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:41:35,302 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:41:35,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:36,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:41:40,695 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:41:40,695 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:40,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:41,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:43,193 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:41:43,312 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:41:43,441 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:41:43,540 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:41:43,542 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:44,754 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:41:56,464 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:42:56,466 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:43:08,276 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:43:19,280 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:43:31,236 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:43:41,639 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:43:42,645 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:43:42,647 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:43:42,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:42,736 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:43:46,919 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:43:46,924 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:43:46,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:47,014 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:43:47,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:47,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:47,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:48,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:43:48,899 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:43:50,244 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:43:50,247 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:43:51,622 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:43:51,624 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:43:51,626 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:43:51,628 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:43:51,628 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:43:51,630 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:43:51,632 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:43:51,634 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:43:51,636 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:43:51,636 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:43:51,638 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:43:51,640 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:43:52,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:43:53,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:44:06,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:44:07,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:44:21,157 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:44:21,159 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:44:21,159 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:44:21,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:23,898 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:44:27,609 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:44:27,613 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:44:27,652 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:30,446 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:44:30,448 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:44:30,448 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:44:30,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:33,111 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:44:52,409 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:44:53,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:44:53,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:44:54,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:21,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:45:26,957 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:45:32,396 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:45:32,398 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:45:32,398 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:45:33,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:45:33,287 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:45:33,289 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:45:35,628 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:45:45,848 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:45:46,224 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:45:48,491 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:45:49,591 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1336
2025-11-17 10:45:49,593 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:45:53,896 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 42
2025-11-17 10:45:53,897 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:45:55,160 - ispa_next.appointments.models - DEBUG - Appointment Lampros Konstantinidis WI-KG 377 WBAPA91080WA19312 ohne Termin.
2025-11-17 10:45:55,171 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:45:55,178 - ispa_next.main - DEBUG - 



2025-11-17 10:45:55,178 - ispa_next.main - DEBUG - starting with process 7 (WI-MB 628) of 13
2025-11-17 10:45:55,181 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:45:57,126 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:45:58,932 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1336
2025-11-17 10:45:58,934 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 42
2025-11-17 10:46:01,229 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:46:01,231 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:46:48,841 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:47:01,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:01,935 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:47:02,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:03,436 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:47:03,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:03,528 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:47:03,819 - ispa_next.functions - DEBUG - HU date soon to be invalid in 75 days.
2025-11-17 10:47:12,781 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:47:12,783 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:47:15,905 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:47:15,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:17,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:19,765 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:47:19,903 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:47:23,200 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:47:23,344 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:47:23,348 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:24,648 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:47:36,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:47:37,560 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:47:37,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:38,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:54,433 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:48:05,330 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:48:05,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:05,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:48:05,440 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:48:05,502 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:48:06,943 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:48:07,262 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:48:13,633 - ispa_next.functions - DEBUG - Updated appointment (AE00049826) customer contact data.
2025-11-17 10:48:14,640 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:48:14,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:15,406 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:48:18,357 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:48:19,632 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:48:19,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:48:20,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:48:25,014 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:48:25,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:48:25,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:48:27,651 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:48:27,785 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:48:27,935 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:48:28,055 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:48:28,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:30,072 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:48:41,622 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:48:49,531 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:48:49,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:53,811 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse hinten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:48:58,248 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:49:02,634 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:49:03,641 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:49:03,641 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:49:03,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:03,733 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:49:07,914 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:49:08,932 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:49:21,269 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:49:21,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:21,410 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:49:30,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:31,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:31,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:32,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:49:32,123 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:49:34,169 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:49:34,179 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:49:36,337 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:49:36,339 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:49:36,341 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:49:36,343 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:49:36,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:49:36,346 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:49:36,348 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:49:36,353 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:49:36,355 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:49:36,356 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:49:36,370 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:49:36,373 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:49:37,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:49:38,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:49:51,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:49:52,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:50:06,901 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:50:06,903 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:50:06,905 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:50:06,905 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:10,435 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:50:14,187 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:50:14,259 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:50:14,327 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:17,940 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:50:17,941 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:50:17,943 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:50:17,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:21,300 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:50:41,042 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:50:41,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:50:42,634 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:50:42,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:17,859 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:24,334 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:29,876 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:36,313 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:36,315 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:51:36,316 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:51:37,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:51:37,478 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:51:37,479 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:51:40,713 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:51:54,416 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:51:54,783 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:51:57,237 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:51:58,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1336
2025-11-17 10:51:58,507 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:52:02,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-17 10:52:02,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:52:04,112 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:52:04,118 - ispa_next.main - DEBUG - 



2025-11-17 10:52:04,118 - ispa_next.main - DEBUG - starting with process 8 (rüd-0628) of 13
2025-11-17 10:52:04,122 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:52:05,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:52:07,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1336
2025-11-17 10:52:07,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-17 10:52:10,246 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:52:10,247 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:52:50,276 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:53:03,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:06,413 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:53:06,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:06,519 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:53:06,918 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:53:06,920 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:53:10,096 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:53:10,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:11,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:13,686 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:53:13,824 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:53:17,091 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:53:17,229 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:53:17,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:20,055 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:53:31,918 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:53:32,922 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:53:32,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:33,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:47,353 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:53:58,430 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:53:58,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:58,526 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:53:58,527 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:53:58,605 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:54:00,006 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:54:01,384 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:54:01,640 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:54:08,214 - ispa_next.functions - DEBUG - Updated appointment (AE00049807) customer contact data.
2025-11-17 10:54:09,229 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:54:09,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:09,464 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:54:12,190 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:54:13,537 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:54:13,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:54:14,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:54:19,164 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:54:19,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:54:20,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:54:22,422 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:54:22,570 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:54:22,713 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:54:22,884 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:54:22,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:26,374 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:54:37,681 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:54:45,301 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:54:45,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:48,796 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:54:51,008 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:54:52,016 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:54:52,016 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:54:52,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:54:52,109 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:54:56,287 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:54:57,586 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:55:08,707 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:55:08,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:08,826 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:55:14,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:14,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:55:14,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:55:15,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:55:15,883 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:55:19,172 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:55:19,177 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:55:20,589 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:55:20,591 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:55:20,593 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 10:55:20,593 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 10:55:20,595 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:55:20,597 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:55:20,599 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:55:20,599 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:55:20,601 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:55:20,603 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:55:20,605 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:55:20,614 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:55:21,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:55:22,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:55:35,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:55:37,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:55:51,749 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:55:51,751 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:55:51,753 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:55:51,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:56,572 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:55:56,577 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:55:56,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:01,866 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:56:01,868 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:56:01,870 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:56:01,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:06,713 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:56:25,712 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:56:26,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:56:27,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:56:27,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:15,569 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:21,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:28,637 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:34,846 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:41,677 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:47,890 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:57:47,892 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:57:47,894 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:48,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:57:48,898 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:57:48,899 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:57:51,277 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:58:02,648 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:58:03,030 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:58:05,747 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:58:06,809 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1337
2025-11-17 10:58:06,811 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:58:10,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 42
2025-11-17 10:58:10,699 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:11,995 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 10:58:12,001 - ispa_next.main - DEBUG - 



2025-11-17 10:58:12,001 - ispa_next.main - DEBUG - starting with process 9 (WI-P-1860) of 13
2025-11-17 10:58:12,021 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:58:13,758 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:58:15,604 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1337
2025-11-17 10:58:15,606 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 42
2025-11-17 10:58:17,849 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:58:17,851 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:59,992 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:59:12,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:14,814 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:59:14,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:14,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:15,166 - ispa_next.functions - DEBUG - HU date already expired after 11 days.
2025-11-17 10:59:25,097 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:59:25,099 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:59:28,093 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:59:28,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:30,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:59:32,202 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:59:32,346 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:59:35,645 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:59:35,784 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:59:35,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:37,829 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:59:49,912 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:59:50,917 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:59:50,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:51,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:56,718 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:59:56,722 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:59:56,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:56,814 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:56,816 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:59:56,857 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:59:58,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:59:58,372 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:00:03,992 - ispa_next.functions - DEBUG - Updated appointment (AB00061387) customer contact data.
2025-11-17 11:00:04,972 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:00:04,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:00:05,229 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:00:05,506 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:00:05,508 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:00:12,240 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:00:12,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:00:14,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:00:17,854 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:00:17,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:00:18,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:00:20,394 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:00:20,522 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:00:20,730 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:00:20,882 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:00:20,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:22,969 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:00:35,401 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:01:35,404 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:01:46,813 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:01:56,311 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:01:56,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:01,266 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:02:04,931 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:02:08,466 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:02:13,534 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:02:14,566 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:02:14,568 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:02:14,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:14,664 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:02:18,877 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:02:20,208 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:02:34,485 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:02:34,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:34,678 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:02:40,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:40,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:40,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:41,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:02:41,742 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:02:43,659 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:02:43,661 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:02:46,210 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:02:46,211 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:02:46,213 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:02:46,215 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:02:46,216 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:02:46,218 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:02:46,220 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:02:46,221 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:02:46,223 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:02:46,224 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:02:46,226 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:02:46,235 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:02:46,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:02:48,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:03:01,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:03:02,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:03:17,445 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:03:17,449 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:03:17,451 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:03:17,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:20,922 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:03:20,926 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:03:20,928 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:24,455 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:03:24,457 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:03:24,459 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:03:24,461 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:27,895 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:03:49,730 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:03:50,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:03:51,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:03:51,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:27,046 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:04:32,779 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:04:38,411 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:04:45,921 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:04:45,922 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:04:45,923 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:04:46,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:04:47,082 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:04:47,082 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:04:50,114 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:05:03,485 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:05:03,869 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 11:05:06,708 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:07,960 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1339
2025-11-17 11:05:07,962 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:12,597 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 43
2025-11-17 11:05:12,598 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:05:13,910 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 11:05:13,915 - ispa_next.main - DEBUG - Found new Appointment: WI-LD 585
2025-11-17 11:05:13,918 - ispa_next.main - DEBUG - 



2025-11-17 11:05:13,918 - ispa_next.main - DEBUG - starting with process 10 (WI-LD 585) of 14
2025-11-17 11:05:13,922 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:15,812 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:17,802 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1339
2025-11-17 11:05:17,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 43
2025-11-17 11:05:20,323 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:20,324 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:06:04,907 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:06:17,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:18,605 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:06:18,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:18,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:19,029 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:06:19,031 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:06:22,059 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:06:22,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:23,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:25,940 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:06:35,518 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:06:44,804 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:06:45,810 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:06:45,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:46,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:01,341 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:07:12,218 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:07:12,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:12,311 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:12,313 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:07:12,406 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:07:12,613 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:07:14,097 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:07:14,393 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:07:20,678 - ispa_next.functions - DEBUG - Updated appointment (AS00013552) customer contact data.
2025-11-17 11:07:21,617 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:07:21,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:21,894 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:22,126 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:07:22,127 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:07:22,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:07:23,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:07:25,512 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:07:25,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:07:25,622 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:07:29,225 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:07:29,225 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:07:29,229 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:07:29,230 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:07:29,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:29,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:33,999 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:07:34,004 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:07:34,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:34,091 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:07:34,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:34,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:34,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:35,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:35,808 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:07:37,127 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:07:37,129 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:07:38,795 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:07:38,797 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:07:38,799 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:07:38,799 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:07:38,800 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:07:38,802 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:07:38,804 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:07:38,806 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:07:38,808 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:07:38,808 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:07:38,812 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:07:38,812 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:07:39,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:07:40,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:07:53,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:07:54,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:08:09,717 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:08:09,719 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:08:09,721 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:08:09,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:12,569 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:08:12,571 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:08:12,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:15,243 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:08:15,245 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:08:15,247 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:08:15,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:18,044 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:08:36,011 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:08:36,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:08:37,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:08:38,118 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:09:06,092 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:09:13,303 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:09:19,606 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:09:19,608 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:09:19,608 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:09:20,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:09:20,598 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:09:20,600 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:09:23,122 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:09:35,234 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:09:35,617 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 11:09:38,250 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:09:39,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1339
2025-11-17 11:09:39,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:09:43,176 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 43
2025-11-17 11:09:43,177 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:09:44,496 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 11:09:44,502 - ispa_next.main - DEBUG - 



2025-11-17 11:09:44,502 - ispa_next.main - DEBUG - starting with process 11 (MJIJ233) of 14
2025-11-17 11:09:44,506 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:09:46,466 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:09:48,401 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1339
2025-11-17 11:09:48,403 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 43
2025-11-17 11:09:50,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:09:50,648 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:10:36,091 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:10:49,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:51,674 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:10:51,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:51,787 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:10:52,237 - ispa_next.functions - DEBUG - HU date soon to be invalid in 23 days.
2025-11-17 11:11:02,705 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:11:02,708 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:11:05,740 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:11:05,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:11:08,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:11:10,061 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:11:10,202 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:11:13,476 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:11:13,589 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:11:13,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:15,611 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:11:27,913 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:11:28,917 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:11:28,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:29,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:34,181 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:11:34,183 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:11:34,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:34,307 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:11:34,309 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:11:34,374 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:11:35,682 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:11:35,992 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:11:42,123 - ispa_next.functions - DEBUG - Updated appointment (AC00064312) customer contact data.
2025-11-17 11:11:43,076 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:11:43,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:43,411 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:11:43,678 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:11:43,680 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:11:45,101 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:11:45,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:11:46,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:11:50,937 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:11:51,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:11:52,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:11:54,127 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:11:54,282 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:11:54,447 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:11:54,560 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:11:54,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:57,439 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:12:08,568 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:12:16,404 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:12:16,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:12:19,247 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:12:23,499 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:12:24,506 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:12:24,506 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:12:24,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:24,640 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:12:28,842 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:12:28,859 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:12:28,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:29,002 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:12:39,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:39,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:12:39,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:12:40,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:12:40,640 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:12:43,216 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:12:43,218 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:12:44,865 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:12:44,867 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:12:44,869 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:12:44,870 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:12:44,870 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:12:44,873 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:12:44,875 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:12:44,876 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:12:44,879 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:12:44,879 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:12:44,881 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:12:44,883 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:12:45,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:12:47,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:13:01,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:13:02,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:13:17,054 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:13:17,056 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:13:17,058 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:13:17,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:21,509 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:13:21,511 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:13:21,514 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:25,868 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:13:25,870 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:13:25,872 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:13:25,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:30,078 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:13:48,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:13:49,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:13:50,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:13:50,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:14:32,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:39,408 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:46,367 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:53,205 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:59,945 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:14:59,947 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:14:59,947 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:01,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:15:01,932 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:15:01,934 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:15:05,210 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:15:17,511 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:15:17,897 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 11:15:20,838 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:22,064 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1342
2025-11-17 11:15:22,065 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:15:27,062 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 46
2025-11-17 11:15:27,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:15:28,367 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:15:28,381 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 11:15:28,384 - ispa_next.main - DEBUG - Found new Appointment: MZ-MJ 2623
2025-11-17 11:15:28,385 - ispa_next.main - DEBUG - 



2025-11-17 11:15:28,385 - ispa_next.main - DEBUG - starting with process 12 (MZ-MJ 2623) of 15
2025-11-17 11:15:28,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:15:30,354 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:15:32,404 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1342
2025-11-17 11:15:32,406 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 46
2025-11-17 11:15:34,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:15:34,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:16:24,191 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:16:38,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:38,155 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:38,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:39,600 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:16:39,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:39,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:16:39,936 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:16:39,937 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:16:42,923 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:16:42,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:44,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:16:46,895 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:16:47,072 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:16:50,425 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:17:02,723 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:17:03,734 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:17:03,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:04,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:21,022 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:17:31,301 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:17:31,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:31,406 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:31,406 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:17:31,459 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:17:33,461 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:17:34,798 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:17:35,028 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:17:41,967 - ispa_next.functions - DEBUG - Updated appointment (AE00049839) customer contact data.
2025-11-17 11:17:42,960 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:17:42,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:17:43,902 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:17:44,164 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:17:44,166 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:17:45,314 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:17:45,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:17:46,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:17:50,158 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:17:50,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:50,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:52,714 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:17:52,876 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:17:53,016 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:17:53,145 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:17:53,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:54,463 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:18:06,627 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:19:06,633 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:18,545 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:19:24,548 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:35,518 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:19:43,563 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:19:43,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:44,858 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:19:49,089 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:19:50,095 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:19:50,096 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:19:50,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:50,268 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:19:54,494 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:19:54,498 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:19:54,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:54,633 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:19:59,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:00,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:00,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:00,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:20:00,898 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:20:02,266 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:20:02,268 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:20:03,514 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:20:03,516 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:20:03,518 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:20:03,518 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:20:03,520 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:20:03,522 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:20:03,522 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:20:03,524 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:20:03,526 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:20:03,526 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:20:03,528 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:20:03,534 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:20:04,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:20:05,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:20:19,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:20:20,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:20:35,330 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:20:35,333 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:20:35,334 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:20:35,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:38,080 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:20:42,215 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:20:42,259 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:20:42,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:45,183 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:20:45,184 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:20:45,185 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:20:45,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:47,824 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:21:07,037 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:21:07,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:08,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:21:09,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:38,691 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:45,213 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:51,871 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:51,873 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:21:51,873 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:52,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:52,867 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:21:52,868 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:21:55,399 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:22:08,975 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:22:09,361 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 11:22:12,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:22:13,660 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1342
2025-11-17 11:22:13,661 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:22:18,217 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 46
2025-11-17 11:22:18,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:22:19,359 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:22:19,371 - ispa_next.appointments.models - DEBUG - Appointment Firma MEWA Textil-Service SE & Co. WI-ER 252 WBA11GF0707T19238 ohne Termin.
2025-11-17 11:22:19,375 - ispa_next.main - DEBUG - 



2025-11-17 11:22:19,375 - ispa_next.main - DEBUG - starting with process 13 (WI-LI187E) of 15
2025-11-17 11:22:19,383 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:22:20,932 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:22:22,520 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1342
2025-11-17 11:22:22,522 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 46
2025-11-17 11:22:24,575 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:22:24,576 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:23:05,694 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:23:18,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:21,991 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:23:21,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:22,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:22,427 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:23:22,430 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:23:25,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:23:25,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:27,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:23:29,094 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:23:29,261 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:23:32,491 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:23:32,611 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:23:32,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:36,159 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:23:48,096 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:23:49,101 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:23:49,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:49,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:55,037 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:23:55,042 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:23:55,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:55,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:55,136 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:23:55,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:23:56,487 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:23:56,751 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:24:02,791 - ispa_next.functions - DEBUG - Updated appointment (AC00064311) customer contact data.
2025-11-17 11:24:03,798 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:24:03,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:04,105 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:24:04,379 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:24:04,381 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:24:05,803 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:24:05,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:24:06,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:24:10,591 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:24:10,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:11,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:24:13,100 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:24:13,292 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:24:13,448 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:24:13,559 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:24:13,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:17,420 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:24:29,642 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:25:29,645 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:25:41,552 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:26:06,555 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:26:18,681 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:26:30,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:26:31,400 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:26:31,402 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:26:31,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:31,495 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:26:35,677 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:26:35,681 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:26:35,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:35,819 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:26:41,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:42,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:26:42,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:26:43,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:26:43,009 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:26:46,197 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:26:46,199 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:26:47,676 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:26:47,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:26:47,680 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:26:47,682 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:26:47,684 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:26:47,690 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:26:47,692 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:26:47,694 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:26:47,696 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:26:47,701 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:26:47,703 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:26:47,703 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:26:48,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:26:49,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:27:03,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:27:05,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:27:20,090 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:27:20,092 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:27:20,093 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:27:20,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:25,108 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:27:25,110 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:27:25,112 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:30,173 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:27:30,173 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:27:30,175 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:27:30,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:35,173 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:27:54,570 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:27:55,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:27:56,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:27:56,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:45,449 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:52,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:28:59,124 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:05,721 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:11,437 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:17,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:29:17,794 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:29:17,794 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:18,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:29:18,976 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:29:18,978 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:29:21,506 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:29:35,762 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:29:36,138 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 11:29:38,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:40,229 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:29:40,231 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:45,604 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 47
2025-11-17 11:29:45,605 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:29:46,734 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:29:46,740 - ispa_next.main - DEBUG - Found new Appointment: WI-BH 850
2025-11-17 11:29:46,741 - ispa_next.main - DEBUG - 



2025-11-17 11:29:46,742 - ispa_next.main - DEBUG - starting with process 14 (WI-BH 850) of 16
2025-11-17 11:29:46,751 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:29:48,320 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:29:50,273 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:29:50,275 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 47
2025-11-17 11:29:53,448 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:29:53,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:30:39,401 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:30:52,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:54,965 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:30:54,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:55,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:30:55,571 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:30:55,573 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:30:58,660 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:30:58,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:00,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:02,275 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:31:02,441 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:31:02,545 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:31:02,667 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:31:06,925 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:31:07,930 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:31:07,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:08,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:23,841 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:31:33,551 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:31:33,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:33,651 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:33,651 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:31:33,728 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:31:35,079 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:31:36,399 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:31:36,645 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:31:44,106 - ispa_next.functions - DEBUG - Updated appointment (AE00049845) customer contact data.
2025-11-17 11:31:45,082 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:31:45,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:31:45,523 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:31:46,492 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:31:46,494 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:31:48,041 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:31:48,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:31:49,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:31:54,044 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:31:54,044 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:31:54,206 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:31:54,427 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:31:54,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:31:55,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:31:59,517 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:32:00,567 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:32:11,972 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:32:11,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:32:12,055 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:32:16,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:16,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:32:16,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:32:17,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:32:17,677 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:32:20,983 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:32:20,985 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:32:22,428 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:32:22,430 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:32:22,436 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:32:22,438 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:32:22,442 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:32:22,444 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:32:22,446 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:32:22,447 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:32:22,449 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:32:22,449 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:32:22,453 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:32:22,455 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:32:23,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:32:24,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:32:38,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:32:39,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:32:54,138 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:32:54,140 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:32:54,143 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:32:54,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:59,218 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:33:03,084 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:33:03,184 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:33:03,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:08,518 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:33:08,520 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:33:08,520 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:33:08,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:33:13,433 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:33:33,815 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:33:34,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:33:35,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:33:35,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:24,060 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:31,243 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:37,875 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:44,859 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:51,946 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:59,125 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:34:59,127 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:34:59,127 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:35:00,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:35:00,397 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:35:00,399 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:35:03,084 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:35:17,284 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:35:17,666 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 11:35:20,496 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:21,835 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:35:21,835 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:26,327 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 47
2025-11-17 11:35:26,328 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:35:27,673 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:35:27,682 - ispa_next.main - DEBUG - 



2025-11-17 11:35:27,682 - ispa_next.main - DEBUG - starting with process 15 (ZH694412) of 16
2025-11-17 11:35:27,687 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:35:29,710 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:35:31,472 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:35:31,474 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 47
2025-11-17 11:35:33,474 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:35:33,475 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:36:19,842 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:36:33,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:35,788 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:36:35,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:35,894 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:36:36,138 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:36:44,821 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:36:44,823 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:36:47,730 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:36:47,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:49,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:36:51,676 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:36:51,821 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:36:55,110 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:36:55,239 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:36:55,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:57,415 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:37:09,571 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:37:10,575 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:37:10,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:37:11,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:37:15,845 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:37:15,847 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:37:15,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:37:15,926 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:37:15,926 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:37:15,992 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:37:17,295 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:37:18,543 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:37:18,819 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:37:25,212 - ispa_next.functions - DEBUG - Updated appointment (AC00064310) customer contact data.
2025-11-17 11:37:26,168 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:37:26,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:37:26,505 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:37:26,858 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:37:26,860 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:37:28,091 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:37:28,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:37:29,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:37:33,924 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:37:34,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:37:35,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:37:37,156 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:37:37,522 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:37:37,658 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:37:37,800 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:37:37,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:40,685 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:37:52,215 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:37:59,829 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:37:59,831 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:38:06,497 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:38:10,391 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:38:14,704 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse hinten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 11:38:19,546 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:38:22,702 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:38:23,743 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:38:23,744 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:38:23,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:38:23,854 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:38:27,984 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:38:29,011 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:38:38,963 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:38:38,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:38:39,062 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:38:44,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:38:45,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:38:45,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:38:46,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:38:46,208 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:38:48,836 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:38:48,840 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:38:52,002 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:38:52,003 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:38:52,006 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:38:52,007 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:38:52,008 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:38:52,010 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:38:52,010 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:38:52,012 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:38:52,014 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:38:52,014 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:38:52,017 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:38:52,019 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:38:52,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:38:53,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:39:09,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:39:10,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:39:25,068 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:39:25,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:39:25,071 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:39:25,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:29,378 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:39:29,381 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:39:29,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:33,608 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:39:33,610 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:39:33,612 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:39:33,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:39:38,023 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:39:58,162 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:39:58,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:39:59,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:40:00,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:40,805 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:40:48,431 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:40:55,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:41:02,256 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:41:09,452 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:41:09,454 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:41:09,456 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:41:10,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:41:10,780 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:41:10,780 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:41:13,842 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:41:25,780 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:41:26,164 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 11:41:29,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:41:30,443 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:41:30,443 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:41:35,080 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 47
2025-11-17 11:41:35,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:41:36,431 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:41:36,439 - ispa_next.main - DEBUG - 



2025-11-17 11:41:36,439 - ispa_next.main - DEBUG - starting with process 16 (MZ S 2350E) of 16
2025-11-17 11:41:36,443 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:41:37,970 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:41:39,483 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:41:39,484 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 47
2025-11-17 11:41:41,646 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:41:41,647 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:42:25,241 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:42:39,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:42:40,583 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:42:40,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:42:40,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:42:41,087 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:42:41,091 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:42:44,276 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:42:44,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:42:46,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:42:48,273 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:42:48,438 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:42:51,821 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:43:02,608 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:43:03,615 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:43:03,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:04,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:09,104 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:43:09,108 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:43:09,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:09,257 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:43:09,258 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:43:09,330 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:43:10,665 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:43:10,913 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:43:16,658 - ispa_next.functions - DEBUG - Updated appointment (AA00053697) customer contact data.
2025-11-17 11:43:17,637 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:43:17,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:43:18,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:43:18,326 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 11:43:18,328 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:43:19,666 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:43:19,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:43:20,875 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:43:24,489 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:43:24,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:43:24,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:43:27,002 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:43:27,161 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:43:27,285 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:43:27,418 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:43:27,420 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:43:28,733 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:43:40,953 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:44:40,956 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:44:53,005 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:45:26,008 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:45:38,924 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:45:49,709 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:45:50,744 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:45:50,744 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:45:50,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:45:50,884 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:45:55,074 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:45:55,078 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:45:55,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:45:55,215 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:46:00,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:46:01,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:46:01,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:46:02,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:46:02,289 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:46:03,684 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:46:03,686 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:46:05,193 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:46:05,195 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:46:05,197 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-17 11:46:05,199 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-17 11:46:05,200 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:46:05,202 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:46:05,203 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:46:05,209 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:46:05,213 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:46:05,216 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:46:05,220 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:46:05,224 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:46:05,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:46:07,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:46:21,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 11:46:22,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 11:46:37,550 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:46:37,552 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:46:37,554 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:46:37,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:46:40,347 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:46:40,347 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:46:40,352 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:46:43,046 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:46:43,047 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:46:43,049 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:46:43,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:46:45,691 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:47:05,297 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:47:06,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:47:07,176 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:47:07,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:36,054 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:42,061 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:49,101 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:47:49,103 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:47:49,104 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:47:50,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:47:50,478 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:47:50,480 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:47:53,656 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:48:06,933 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:48:07,317 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 11:48:10,073 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:48:11,181 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1344
2025-11-17 11:48:11,183 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:48:15,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 47
2025-11-17 11:48:15,252 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:48:16,579 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
