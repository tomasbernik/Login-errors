2025-11-12 12:14:37,570 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:14:37,576 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:14:46,169 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:14:56,543 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:15:12,346 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:17:10,283 - ispa_next.app_start.main - DEBUG - Operation already took 106.60 seconds (more than 80 seconds)
2025-11-12 12:17:12,349 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\4213f29d24897b3a\\tess_sn_idgm0_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\4213f29d24897b3a\\tess_sn_idgm0', 'txt']
2025-11-12 12:17:12,726 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:17:12,732 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:17:12,734 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:17:37,807 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:17:54,612 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:17:58,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:17:59,614 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:17:59,615 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:18:01,402 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 345
2025-11-12 12:18:01,403 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:18:01,403 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:02,212 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:03,010 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:48,468 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:18:48,481 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,489 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,502 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-12 12:18:48,518 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-12 12:18:48,530 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-12 12:18:48,543 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-12 12:18:48,558 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 12:18:48,571 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 12:18:48,588 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Fiedler ED-F 1818 WBA25DP090N149286 ohne Termin.
2025-11-12 12:18:48,604 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-12 12:18:48,606 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,648 - ispa_next.appointments.models - DEBUG - Appointment Sami Polat ED-N 4423 WBA21BY0907N23883 ohne Termin.
2025-11-12 12:18:48,670 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-12 12:18:48,686 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-12 12:18:48,700 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-12 12:18:48,706 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,722 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-12 12:18:48,734 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-12 12:18:48,741 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,761 - ispa_next.appointments.models - DEBUG - Appointment Josefine Hintermeier ED-AD 71 WMWZM31080T767604 ohne Termin.
2025-11-12 12:18:48,774 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-12 12:18:48,798 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-12 12:18:48,820 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-12 12:18:48,839 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-12 12:18:48,840 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,854 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-12 12:18:48,868 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-12 12:18:48,881 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-12 12:18:48,883 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:48,898 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-12 12:18:48,927 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-12 12:18:48,940 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-12 12:18:48,954 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-12 12:18:48,968 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-12 12:18:48,985 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-12 12:18:49,005 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-12 12:18:49,020 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-12 12:18:49,036 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-12 12:18:49,049 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-12 12:18:49,082 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-12 12:18:49,098 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-12 12:18:49,114 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-12 12:18:49,129 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-12 12:18:49,129 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:49,145 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-12 12:18:49,160 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-12 12:18:49,174 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-12 12:18:49,187 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-12 12:18:49,202 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-12 12:18:49,215 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-12 12:18:49,234 - ispa_next.appointments.models - DEBUG - Appointment Eduard Gehl FS-EG 174 WBAJN31090B095696 ohne Termin.
2025-11-12 12:18:49,248 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-12 12:18:49,279 - ispa_next.main - DEBUG - Found 20 out of 149 appointments to process (configured limit: 20).
2025-11-12 12:18:49,280 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 12:18:49,280 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 12:18:49,280 - ispa_next.main - DEBUG - All appointments: FS-MS 633, ED-RG133, ED-DY 9 E, ED-OZ 54, ED M 2304, ED RU 101, ED-SX 274, MNK3076, ED-MH-171, ED-A1024, ED-K2010, ED-AL59, M-ED-2001, ED N 1926, ED SN 4108, EBE-AB 202, ED-CT 178, ED-O 1909, ED-RD 212, ED-WI 283
2025-11-12 12:18:49,283 - ispa_next.main - DEBUG - 



2025-11-12 12:18:49,283 - ispa_next.main - DEBUG - starting with process 1 (FS-MS 633) of 20
2025-11-12 12:18:49,289 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:50,205 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:51,344 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:18:51,345 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 345
2025-11-12 12:18:52,554 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:52,556 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:24,430 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:19:24,508 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:19:24,513 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:19:24,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:19:24,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:19:27,356 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:19:27,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:28,178 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:19:28,187 - ispa_next.main - DEBUG - 



2025-11-12 12:19:28,187 - ispa_next.main - DEBUG - starting with process 2 (ED-RG133) of 20
2025-11-12 12:19:28,191 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:19:29,356 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:19:30,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:19:30,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:19:31,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:19:31,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:20:11,135 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:20:11,146 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:20:11,151 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:20:11,584 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:20:11,586 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:20:13,919 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:20:13,919 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:20:14,755 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:20:14,762 - ispa_next.main - DEBUG - 



2025-11-12 12:20:14,762 - ispa_next.main - DEBUG - starting with process 3 (ED-DY 9 E) of 20
2025-11-12 12:20:14,767 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:20:16,009 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:20:16,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:20:16,999 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:20:18,488 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:20:18,490 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:20:49,137 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:20:49,149 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:20:49,155 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:20:49,436 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:20:49,437 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:20:51,443 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:20:51,444 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:20:52,026 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:20:52,034 - ispa_next.main - DEBUG - 



2025-11-12 12:20:52,034 - ispa_next.main - DEBUG - starting with process 4 (ED-OZ 54) of 20
2025-11-12 12:20:52,045 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:20:52,913 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:20:54,134 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:20:54,135 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:20:55,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:20:55,519 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:21:17,901 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:21:26,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:28,770 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:21:28,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:28,861 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:21:29,059 - ispa_next.functions - DEBUG - HU date already expired after 676 days.
2025-11-12 12:21:35,793 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:21:35,796 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:21:38,475 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:21:38,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:21:39,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:21:41,559 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:21:41,684 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:21:44,887 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:21:44,960 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:21:44,961 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:21:53,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:21:54,548 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:21:54,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:55,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:06,679 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:22:14,636 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:22:14,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:14,724 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:14,725 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:22:14,806 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:22:16,062 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:22:17,206 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:22:17,465 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:22:20,132 - ispa_next.functions - DEBUG - Updated appointment (AA00022376) customer contact data.
2025-11-12 12:22:21,031 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:22:21,033 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:22:21,547 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:22:21,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:22:22,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:22:26,210 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:22:26,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:26,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:28,712 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:22:28,806 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:22:28,930 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:22:28,990 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:22:28,990 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:22:37,301 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:23:37,301 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:23:45,553 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:24:18,555 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:24:27,054 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:24:34,372 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:24:35,378 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:24:35,396 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:24:35,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:35,484 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:24:35,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:36,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:36,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:37,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:24:37,035 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:24:38,909 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:24:38,910 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:24:39,996 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:24:39,997 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:24:39,999 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:24:40,000 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:24:40,002 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:24:40,003 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:24:40,004 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:24:40,009 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:24:40,014 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:24:40,018 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:24:40,029 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:24:40,032 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:24:40,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:41,881 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:24:41,884 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:24:41,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:43,868 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:24:43,871 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:24:43,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:24:44,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:24:44,864 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:24:44,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:46,769 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:24:57,707 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:24:58,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:24:58,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:24:58,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:25:16,927 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:20,937 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:20,940 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:25:20,941 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:21,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:25:21,701 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:25:21,703 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:25:23,553 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:25:33,962 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:25:34,337 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:25:34,689 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:36,582 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:25:36,584 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:39,313 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:25:39,313 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:25:40,001 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:25:40,011 - ispa_next.main - DEBUG - 



2025-11-12 12:25:40,011 - ispa_next.main - DEBUG - starting with process 5 (ED M 2304) of 20
2025-11-12 12:25:40,015 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:41,170 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:42,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:25:42,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:25:43,655 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:43,656 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:20,903 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:26:20,913 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:26:20,918 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:21,434 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:26:21,436 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:23,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:26:23,599 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:24,247 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:26:24,255 - ispa_next.main - DEBUG - 



2025-11-12 12:26:24,255 - ispa_next.main - DEBUG - starting with process 6 (ED RU 101) of 20
2025-11-12 12:26:24,261 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:26:25,109 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:25,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:26:25,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:26:27,240 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:27,241 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:57,579 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:26:57,589 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:26:57,593 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:57,978 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:26:57,979 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:00,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:27:00,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:01,043 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:27:01,051 - ispa_next.main - DEBUG - 



2025-11-12 12:27:01,051 - ispa_next.main - DEBUG - starting with process 7 (ED-SX 274) of 20
2025-11-12 12:27:01,054 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:27:01,895 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:27:02,691 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:27:02,692 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:27:03,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:27:03,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:27:22,917 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:27:32,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:33,906 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:27:33,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:33,969 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:27:34,166 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:27:40,464 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:27:40,467 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:27:43,125 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:43,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:44,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:46,104 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:27:46,266 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:27:49,476 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:27:49,547 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:27:49,547 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:27:58,029 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:27:59,035 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:27:59,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:59,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:02,878 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 12:28:02,883 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:28:02,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:02,969 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:28:02,970 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:28:03,003 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:28:04,212 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:28:04,427 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:28:07,290 - ispa_next.functions - DEBUG - Updated appointment (AA00022340) customer contact data.
2025-11-12 12:28:08,223 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:28:08,225 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:28:08,796 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:28:08,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:28:09,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:28:13,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:28:13,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:14,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:16,017 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:28:16,121 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:28:16,221 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:28:16,313 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:28:16,313 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:28:24,618 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:29:24,620 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:29:35,875 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:29:40,984 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:29:40,985 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:29:45,154 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:29:46,173 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:29:46,177 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:29:46,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:29:46,289 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:29:46,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:29:47,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:29:47,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:29:48,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:29:48,049 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:29:49,989 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:29:49,991 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:29:51,084 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:29:51,085 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:29:51,087 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:29:51,088 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:29:51,090 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:29:51,091 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:29:51,093 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:29:51,094 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:29:51,095 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:29:51,105 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:29:51,112 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:29:51,116 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:29:51,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:53,022 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:29:53,024 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:29:53,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:54,885 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:29:54,887 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:29:54,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:29:55,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:29:55,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:04,801 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:30:04,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:06,720 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:30:16,863 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:30:17,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:30:17,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:30:18,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:36,075 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:30:39,814 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:30:39,817 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:30:39,817 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:30:40,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:30:40,535 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:30:40,538 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:30:42,349 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:30:50,091 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:30:50,498 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:30:50,868 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:30:52,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:30:52,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:30:55,858 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:30:55,859 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:30:56,694 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:30:56,703 - ispa_next.main - DEBUG - 



2025-11-12 12:30:56,703 - ispa_next.main - DEBUG - starting with process 8 (MNK3076) of 20
2025-11-12 12:30:56,707 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:30:57,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:30:59,039 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:30:59,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:31:00,240 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:00,241 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:31,360 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:31:31,371 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:31:31,376 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:31,790 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:31:31,794 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:34,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:31:34,179 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:34,962 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:31:34,972 - ispa_next.main - DEBUG - 



2025-11-12 12:31:34,972 - ispa_next.main - DEBUG - starting with process 9 (ED-MH-171) of 20
2025-11-12 12:31:34,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:35,976 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:37,152 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:31:37,154 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:31:38,520 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:38,522 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:09,732 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:32:09,743 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:32:09,747 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:32:10,216 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:32:10,217 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:12,645 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:32:12,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:13,406 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:32:13,413 - ispa_next.main - DEBUG - 



2025-11-12 12:32:13,413 - ispa_next.main - DEBUG - starting with process 10 (ED-A1024) of 20
2025-11-12 12:32:13,424 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:32:14,679 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:32:15,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:32:15,700 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:32:17,149 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:17,151 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:48,862 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:32:48,871 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:32:48,875 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:32:49,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:32:49,255 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:51,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:32:51,710 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:32:52,460 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:32:52,469 - ispa_next.main - DEBUG - 



2025-11-12 12:32:52,469 - ispa_next.main - DEBUG - starting with process 11 (ED-K2010) of 20
2025-11-12 12:32:52,474 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:32:53,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:32:54,941 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:32:54,942 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:32:56,310 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:32:56,312 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:33:38,025 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:33:38,035 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:33:38,038 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:38,428 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:33:38,430 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:33:40,866 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:33:40,867 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:33:41,669 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:33:41,677 - ispa_next.main - DEBUG - 



2025-11-12 12:33:41,677 - ispa_next.main - DEBUG - starting with process 12 (ED-AL59) of 20
2025-11-12 12:33:41,681 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:33:42,891 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:33:44,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:33:44,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:33:45,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:33:45,550 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:16,102 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:34:16,113 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:34:16,117 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:16,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:34:16,637 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:19,088 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:34:19,089 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:20,024 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:34:20,033 - ispa_next.main - DEBUG - 



2025-11-12 12:34:20,033 - ispa_next.main - DEBUG - starting with process 13 (M-ED-2001) of 20
2025-11-12 12:34:20,038 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:21,202 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:22,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:34:22,482 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:34:23,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:23,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:54,697 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:34:54,706 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:34:54,710 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:55,070 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:34:55,071 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:57,549 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:34:57,550 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:58,317 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:34:58,325 - ispa_next.main - DEBUG - 



2025-11-12 12:34:58,325 - ispa_next.main - DEBUG - starting with process 14 (ED N 1926) of 20
2025-11-12 12:34:58,330 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:59,611 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:00,529 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:35:00,531 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:35:01,716 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:01,717 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:33,409 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:35:33,420 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 12:35:33,424 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:33,919 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:35:33,921 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:36,549 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:35:36,550 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:37,318 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:35:37,326 - ispa_next.main - DEBUG - 



2025-11-12 12:35:37,327 - ispa_next.main - DEBUG - starting with process 15 (ED SN 4108) of 20
2025-11-12 12:35:37,331 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:35:38,484 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:35:39,861 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:35:39,862 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:35:41,270 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:35:41,271 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:36:11,918 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:36:11,929 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 12:36:11,933 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:36:12,423 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:36:12,424 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:36:15,143 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:36:15,144 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:36:16,049 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:36:16,057 - ispa_next.main - DEBUG - 



2025-11-12 12:36:16,057 - ispa_next.main - DEBUG - starting with process 16 (EBE-AB 202) of 20
2025-11-12 12:36:16,062 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:36:17,263 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:36:18,363 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:36:18,364 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:36:19,521 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:36:19,522 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:36:42,495 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:36:44,263 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:36:49,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:50,670 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:36:50,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:50,746 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:36:50,921 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:36:50,924 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:36:53,885 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:36:53,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:54,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:56,931 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:36:57,054 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:36:57,176 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:36:57,249 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:37:01,400 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:37:02,407 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:37:02,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:02,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:13,883 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:37:13,884 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:37:17,709 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:37:17,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:17,845 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:37:17,846 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:37:17,887 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:37:17,984 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:37:19,185 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:37:19,402 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:37:21,112 - ispa_next.functions - DEBUG - Updated appointment (AB00024097) customer contact data.
2025-11-12 12:37:22,023 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:37:22,025 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:37:22,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:37:23,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:37:23,979 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:37:23,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:37:24,091 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:37:28,140 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 12:37:28,140 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:37:28,140 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:37:28,144 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:37:28,148 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:37:28,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:37:28,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:37:28,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:29,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:29,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:37:30,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:37:30,256 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:37:31,563 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:37:31,568 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:37:33,083 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:37:33,085 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:37:33,086 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:37:33,087 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:37:33,089 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:37:33,090 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:37:33,091 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:37:33,093 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:37:33,100 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:37:33,103 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:37:33,109 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:37:33,112 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:37:33,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:34,328 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:37:34,331 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:37:34,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:35,545 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:37:35,548 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:37:35,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:37:36,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:37:36,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:44,451 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:37:44,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:45,677 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:37:56,456 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:37:56,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:57,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:37:57,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:38:09,078 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:38:09,081 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:38:09,082 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:09,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:38:09,840 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:38:09,843 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:38:11,572 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:38:20,084 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:38:20,458 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 12:38:20,800 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:22,577 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:38:22,579 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:25,624 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:38:25,624 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:26,375 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:38:26,384 - ispa_next.main - DEBUG - Found new Appointment: ED-O 123
2025-11-12 12:38:26,386 - ispa_next.main - DEBUG - 



2025-11-12 12:38:26,387 - ispa_next.main - DEBUG - starting with process 17 (ED-O 123) of 21
2025-11-12 12:38:26,393 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:27,652 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:28,790 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:38:28,791 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:38:30,172 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:30,174 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:53,496 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:39:03,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:05,404 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:39:05,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:05,515 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:39:05,696 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:39:05,700 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:39:08,589 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:39:08,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:09,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:11,720 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:39:11,834 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:39:15,084 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:39:15,143 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:39:15,143 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:39:23,719 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:39:24,725 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:39:24,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:25,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:36,342 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:39:42,976 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:39:42,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:43,077 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:39:43,078 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:39:43,118 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:39:43,240 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:39:44,281 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:39:45,522 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:39:45,737 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:39:48,587 - ispa_next.functions - DEBUG - Updated appointment (AG00009941) customer contact data.
2025-11-12 12:39:49,651 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:39:49,656 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:39:49,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:39:50,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:39:51,647 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:39:51,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:39:51,710 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:39:55,282 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:39:55,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:55,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:57,773 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:39:57,886 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:39:57,977 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:39:58,083 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:39:58,084 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:40:06,584 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:41:06,587 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:41:17,421 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:41:21,817 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:41:21,817 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:41:25,994 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:41:27,020 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:41:27,025 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:41:27,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:27,104 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:41:27,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:28,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:28,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:28,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:28,719 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:41:30,665 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:41:30,667 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:41:31,897 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:41:31,899 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:31,901 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:41:31,902 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:31,904 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:41:31,914 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:41:31,916 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:41:31,918 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:41:31,919 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:41:31,920 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:41:31,924 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:41:31,926 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:41:31,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:33,851 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:41:33,853 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:41:33,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:35,747 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:41:35,750 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:41:35,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:41:36,536 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:41:36,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:40,702 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:41:40,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:42,639 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:41:53,444 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:41:53,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:41:54,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:41:54,543 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:11,934 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:42:15,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:42:15,841 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:42:15,841 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:42:16,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:42:16,377 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:42:16,380 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:42:17,716 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:42:24,950 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:42:25,331 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 12:42:25,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:27,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:42:27,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:30,825 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:42:30,826 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:42:31,594 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:42:31,604 - ispa_next.main - DEBUG - 



2025-11-12 12:42:31,604 - ispa_next.main - DEBUG - starting with process 18 (ED-CT 178) of 21
2025-11-12 12:42:31,614 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:42:32,744 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:42:33,912 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:42:33,914 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:42:35,385 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:42:35,386 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:06,711 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:43:08,309 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:43:13,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:43:15,130 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:43:15,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:15,248 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:43:15,450 - ispa_next.functions - DEBUG - HU date already expired after 591 days.
2025-11-12 12:43:19,410 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:43:19,414 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:43:22,093 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:43:22,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:43:23,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:43:25,116 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:43:25,225 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:43:25,325 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:43:25,430 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:43:29,588 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:43:30,608 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:43:30,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:31,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:42,201 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:43:46,438 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:43:46,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:46,511 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:43:46,512 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:43:46,588 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:43:46,718 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:43:47,833 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:43:48,958 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:43:49,240 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:43:50,832 - ispa_next.functions - DEBUG - Updated appointment (AB00024324) customer contact data.
2025-11-12 12:43:51,741 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:43:51,743 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:43:52,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:43:52,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:43:53,606 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:43:53,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:43:53,700 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:43:57,681 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:43:57,681 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:43:57,684 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:43:57,688 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:43:57,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:43:58,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:43:58,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:59,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:43:59,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:43:59,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:43:59,700 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:44:01,557 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:44:01,559 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:44:02,872 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:44:02,873 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:44:02,876 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:44:02,878 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:44:02,880 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:44:02,881 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:44:02,882 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:44:02,883 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:44:02,884 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:44:02,885 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:44:02,889 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:44:02,891 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:44:02,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:04,847 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:44:04,849 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:44:04,852 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:06,735 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:44:06,737 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:44:06,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:44:07,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:44:07,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:16,794 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:44:16,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:18,733 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:44:29,027 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:44:29,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:44:30,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:44:30,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:48,240 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:44:52,659 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:44:52,662 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:44:52,663 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:44:53,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:44:53,367 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:44:53,370 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:44:55,108 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:45:01,201 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:45:01,580 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 12:45:01,906 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:45:03,682 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:45:03,684 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:45:06,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:45:06,635 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:45:07,386 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:45:07,403 - ispa_next.main - DEBUG - 



2025-11-12 12:45:07,403 - ispa_next.main - DEBUG - starting with process 19 (ED-O 1909) of 21
2025-11-12 12:45:07,420 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:45:08,702 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:45:09,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:45:09,929 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:45:11,189 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:45:11,190 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:45:33,195 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:45:36,673 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:45:44,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:50,287 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:45:50,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:50,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:50,543 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 12:45:56,976 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:45:56,980 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:45:59,759 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:59,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:00,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:02,907 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:46:03,009 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:46:03,102 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:46:03,214 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:46:05,305 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:46:06,312 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:46:06,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:06,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:09,888 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 12:46:09,893 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:46:09,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:09,961 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:46:09,962 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:46:09,995 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:46:11,214 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:46:12,367 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:46:12,570 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:46:14,495 - ispa_next.functions - DEBUG - Updated appointment (AA00022415) customer contact data.
2025-11-12 12:46:15,404 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:46:15,406 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:46:16,197 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:46:16,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:46:17,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:46:20,624 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:46:20,624 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:46:20,628 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:46:20,632 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:46:20,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:21,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:30,664 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 12:46:37,686 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 12:46:37,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:38,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:38,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:39,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:39,171 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:46:43,997 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:46:44,011 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:46:45,076 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:46:45,077 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:46:45,079 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:46:45,080 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:46:45,081 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:46:45,082 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:46:45,083 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:46:45,085 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:46:45,086 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:46:45,088 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:46:45,092 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:46:45,094 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:46:45,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:50,515 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:46:50,518 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:46:50,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:55,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:55,959 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:47:05,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:20,384 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:47:20,387 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:47:20,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:47:21,247 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:47:21,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:34,044 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:47:34,046 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:39,448 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:47:50,881 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:47:51,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:47:51,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:47:52,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:08,983 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:48:08,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:48:09,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:48:09,857 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:48:09,859 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:48:13,139 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:48:21,114 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:48:21,517 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 12:48:22,300 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:48:24,430 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:48:24,432 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:48:27,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:48:27,464 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:48:28,242 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:48:28,250 - ispa_next.main - DEBUG - 



2025-11-12 12:48:28,250 - ispa_next.main - DEBUG - starting with process 20 (ED-RD 212) of 21
2025-11-12 12:48:28,254 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:48:29,448 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:48:30,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:48:30,525 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:48:32,173 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:48:32,174 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:48:56,279 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:48:58,094 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:49:03,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:06,097 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:49:06,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:06,184 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:49:06,430 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:49:06,434 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:49:09,179 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:49:09,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:49:10,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:49:12,389 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:49:12,510 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:49:12,643 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:49:12,719 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:49:16,900 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:49:17,907 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:49:17,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:18,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:29,889 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:49:33,975 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:49:33,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:34,082 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:49:34,084 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:49:34,115 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:49:34,210 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:49:35,400 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:49:35,600 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:49:37,498 - ispa_next.functions - DEBUG - Updated appointment (AB00024344) customer contact data.
2025-11-12 12:49:38,457 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:49:38,459 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:49:38,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:49:39,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:49:40,850 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:49:40,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:49:40,940 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:49:44,529 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:49:44,529 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:49:44,532 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:49:44,536 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:49:44,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:49:45,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:49:45,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:45,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:45,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:49:46,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:49:46,532 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:49:48,993 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:49:48,995 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:49:50,431 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:49:50,432 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:49:50,436 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:49:50,440 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:49:50,442 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:49:50,445 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:49:50,448 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:49:50,450 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:49:50,451 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:49:50,452 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:49:50,455 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:49:50,458 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:49:50,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:53,109 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:49:53,112 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:49:53,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:55,778 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:49:55,780 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:49:55,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:49:56,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:49:56,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:50:05,945 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:50:05,946 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:50:08,510 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:50:19,636 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:50:20,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:50:20,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:50:20,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:50:45,475 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:50:49,646 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:50:53,847 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:50:53,850 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:50:53,850 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:50:54,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:50:54,410 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:50:54,412 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:50:55,674 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:51:02,696 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:51:03,085 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 12:51:03,540 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:51:05,264 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:51:05,266 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:51:08,158 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:51:08,158 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:51:08,961 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
2025-11-12 12:51:08,970 - ispa_next.main - DEBUG - 



2025-11-12 12:51:08,970 - ispa_next.main - DEBUG - starting with process 21 (ED-WI 283) of 21
2025-11-12 12:51:08,976 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:51:09,855 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:51:10,977 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 542
2025-11-12 12:51:10,979 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 12:51:12,451 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:51:12,452 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:51:48,071 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:51:49,833 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:51:54,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:57,180 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:51:57,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:57,270 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:57,476 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:51:57,480 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:52:00,384 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:52:00,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:01,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:52:03,573 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:52:03,706 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:52:03,797 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:52:03,897 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:52:08,115 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:52:09,121 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:52:09,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:09,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:22,855 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:52:26,687 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:52:26,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:26,758 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:52:26,759 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:52:26,808 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:52:26,939 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:52:28,182 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:52:28,382 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:52:30,258 - ispa_next.functions - DEBUG - Updated appointment (AB00024334) customer contact data.
2025-11-12 12:52:31,236 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:52:31,239 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:52:31,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:52:32,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:52:33,294 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:52:33,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:52:33,402 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:52:36,964 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:52:36,965 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:52:36,968 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:52:36,975 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:52:36,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:37,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:52:37,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:38,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:38,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:39,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:52:39,063 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:52:41,495 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:52:41,497 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:52:42,911 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:52:42,912 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:52:42,914 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:52:42,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:52:42,916 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:52:42,917 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:52:42,918 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:52:42,919 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:52:42,920 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:52:42,921 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:52:42,925 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:52:42,928 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:52:42,928 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:45,500 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:52:45,503 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:52:45,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:48,115 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:52:48,118 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:52:48,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:52:49,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:52:49,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:59,143 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:52:59,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:53:01,852 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:53:13,424 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:53:13,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:53:14,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:53:14,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:53:39,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:43,900 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:48,319 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:53:48,322 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:53:48,323 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:53:48,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:53:49,038 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:53:49,041 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:53:50,819 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:53:58,922 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:53:59,295 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-12 12:53:59,732 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:54:01,606 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 541
2025-11-12 12:54:01,607 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:54:04,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 12:54:04,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:54:05,161 - ispa_next.appointments.models - DEBUG - Appointment Rainer Betz FFB-WA 5 WBA5K71060G295553 ohne Termin.
