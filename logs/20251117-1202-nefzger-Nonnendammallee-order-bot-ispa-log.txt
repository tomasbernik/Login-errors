2025-11-17 12:02:27,351 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:02:27,354 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:02:32,555 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:02:45,866 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:03:01,566 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:03:25,661 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:03:45,175 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:03:49,879 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:03:50,820 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:03:50,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:03:52,993 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 332
2025-11-17 12:03:52,994 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:03:52,995 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:03:53,935 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:03:54,848 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:04:45,332 - ispa_next.appointments.models - DEBUG - Appointment Yasemin Bülbül-Miersch LN-ZE22E WBATA610009N27119 ohne Termin.
2025-11-17 12:04:45,368 - ispa_next.appointments.models - DEBUG - Appointment Dirk Silbermann B-DC1869 WBA6S110X07J70542 ohne Termin.
2025-11-17 12:04:45,383 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81DP0709K09211 ohne Termin.
2025-11-17 12:04:45,402 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY41DU070S518688 ohne Termin.
2025-11-17 12:04:45,412 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF51030WY39437 ohne Termin.
2025-11-17 12:04:45,433 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY8P610707H78448 ohne Termin.
2025-11-17 12:04:45,449 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AL0207R09669 ohne Termin.
2025-11-17 12:04:45,460 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW11GD0602W43409 ohne Termin.
2025-11-17 12:04:45,470 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FZ060FN39207 ohne Termin.
2025-11-17 12:04:45,487 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GF0207R57756 ohne Termin.
2025-11-17 12:04:45,508 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW71DH0602W03642 ohne Termin.
2025-11-17 12:04:45,527 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF51030WY39437 ohne Termin.
2025-11-17 12:04:45,551 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81FY080FT52812 ohne Termin.
2025-11-17 12:04:45,581 - ispa_next.appointments.models - DEBUG - Appointment Marie Grysla PM-VX343 WMWYT110303E87434 ohne Termin.
2025-11-17 12:04:45,594 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AV070FR60670 ohne Termin.
2025-11-17 12:04:45,605 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHS910405H66834 ohne Termin.
2025-11-17 12:04:45,616 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0307R96836 ohne Termin.
2025-11-17 12:04:45,627 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA7K310407E93147 ohne Termin.
2025-11-17 12:04:45,637 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAYH110805U65786 ohne Termin.
2025-11-17 12:04:45,653 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AG020CL43319 ohne Termin.
2025-11-17 12:04:45,665 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY41AW090FR07448 ohne Termin.
2025-11-17 12:04:45,687 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAYK910405V31475 ohne Termin.
2025-11-17 12:04:45,709 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51AJ020CK75517 ohne Termin.
2025-11-17 12:04:45,724 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA15BZ070N151888 ohne Termin.
2025-11-17 12:04:45,736 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBS41HK090CU55009 ohne Termin.
2025-11-17 12:04:45,747 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FY000FT70917 ohne Termin.
2025-11-17 12:04:45,758 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GM0305015388 ohne Termin.
2025-11-17 12:04:45,772 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21AT050CG42297 ohne Termin.
2025-11-17 12:04:45,790 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41GV010CW11067 ohne Termin.
2025-11-17 12:04:45,802 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 B-NF6001 WBA11EY0809Y64502 ohne Termin.
2025-11-17 12:04:45,813 - ispa_next.appointments.models - DEBUG - Appointment Milan Knezevic B-MK3467 WBAJF31010WC66496 ohne Termin.
2025-11-17 12:04:45,825 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AL0X07H27110 ohne Termin.
2025-11-17 12:04:45,836 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA55DP000N309942 ohne Termin.
2025-11-17 12:04:45,846 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51BY0007P59464 ohne Termin.
2025-11-17 12:04:45,867 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31EE0605126010 ohne Termin.
2025-11-17 12:04:45,878 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0307U42695 ohne Termin.
2025-11-17 12:04:45,897 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0607U42710 ohne Termin.
2025-11-17 12:04:45,911 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0607U43565 ohne Termin.
2025-11-17 12:04:45,925 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW21HF0XSTB17405 ohne Termin.
2025-11-17 12:04:45,937 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31EG0905259552 ohne Termin.
2025-11-17 12:04:45,948 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21BX0207P87450 ohne Termin.
2025-11-17 12:04:45,961 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31EG0905259552 ohne Termin.
2025-11-17 12:04:45,972 - ispa_next.appointments.models - DEBUG - Appointment Jörg Eberhard Dr. Priemer B-JP560E WBA61DP0909T07325 ohne Termin.
2025-11-17 12:04:45,983 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAYH110205T09209 ohne Termin.
2025-11-17 12:04:45,994 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY11CF020CK44997 ohne Termin.
2025-11-17 12:04:46,005 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBATY95040N120449 ohne Termin.
2025-11-17 12:04:46,021 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Kühn B-WK224 WBAJG110005N50089 ohne Termin.
2025-11-17 12:04:46,033 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY71EG0705Z84330 ohne Termin.
2025-11-17 12:04:46,044 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBADZ41070CL17914 ohne Termin.
2025-11-17 12:04:46,055 - ispa_next.appointments.models - DEBUG - Appointment Klaus Bernd Bullerdieck B-MW5635E WBA31EF0605Z06362 ohne Termin.
2025-11-17 12:04:46,066 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 TF-PJ496 WBA11AK0807L55295 ohne Termin.
2025-11-17 12:04:46,085 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21EM0009Y33660 ohne Termin.
2025-11-17 12:04:46,102 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31DT0909W35160 ohne Termin.
2025-11-17 12:04:46,116 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA71AB0805V55325 ohne Termin.
2025-11-17 12:04:46,127 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY41DU010S494419 ohne Termin.
2025-11-17 12:04:46,139 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA25DP020N316149 ohne Termin.
2025-11-17 12:04:46,150 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA28FF0408E59660 ohne Termin.
2025-11-17 12:04:46,163 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 B-CB6060 WBSUR91000VP74965 ohne Termin.
2025-11-17 12:04:46,174 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31BK050CJ72958 ohne Termin.
2025-11-17 12:04:46,185 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY7X41040S014907 ohne Termin.
2025-11-17 12:04:46,197 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF510X0WY41136 ohne Termin.
2025-11-17 12:04:46,207 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA6X110105T79228 ohne Termin.
2025-11-17 12:04:46,222 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY8P610807L39255 ohne Termin.
2025-11-17 12:04:46,233 - ispa_next.appointments.models - DEBUG - Appointment Mirko Baumann  WBA21BY0107R75410 ohne Termin.
2025-11-17 12:04:46,244 - ispa_next.appointments.models - DEBUG - Appointment Andreas Jäger OHV-J3161 WBA61EE0105W16982 ohne Termin.
2025-11-17 12:04:46,255 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31AA0X05T53666 ohne Termin.
2025-11-17 12:04:46,266 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61DP0209W98902 ohne Termin.
2025-11-17 12:04:46,276 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY21CF080CM28197 ohne Termin.
2025-11-17 12:04:46,288 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA6N31010FM96349 ohne Termin.
2025-11-17 12:04:46,309 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61CM0508E37609 ohne Termin.
2025-11-17 12:04:46,325 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAJG110405N31822 ohne Termin.
2025-11-17 12:04:46,336 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBATR55080ND36569 ohne Termin.
2025-11-17 12:04:46,348 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBS11EC0109U63862 ohne Termin.
2025-11-17 12:04:46,359 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW11GD0X02W43686 ohne Termin.
2025-11-17 12:04:46,371 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AV0X0FN27974 ohne Termin.
2025-11-17 12:04:46,384 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA7K310505P86547 ohne Termin.
2025-11-17 12:04:46,395 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA71BX0307P36500 ohne Termin.
2025-11-17 12:04:46,407 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA6S110007K21546 ohne Termin.
2025-11-17 12:04:46,418 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GE0507U23927 ohne Termin.
2025-11-17 12:04:46,429 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAFY61050CU07070 ohne Termin.
2025-11-17 12:04:46,440 - ispa_next.appointments.models - DEBUG - Appointment Serhat Kagitci B-O3404 WBS81CH030CG32149 ohne Termin.
2025-11-17 12:04:46,451 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61DP0909K93670 ohne Termin.
2025-11-17 12:04:46,462 - ispa_next.appointments.models - DEBUG - Appointment ASS Athletic Sport Sponsoring GmbH BO-QX6883 WBA11BZ0609W26323 ohne Termin.
2025-11-17 12:04:46,474 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA58FF0908E61823 ohne Termin.
2025-11-17 12:04:46,492 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY8P610807L21113 ohne Termin.
2025-11-17 12:04:46,507 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21BX0307L11465 ohne Termin.
2025-11-17 12:04:46,518 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF11040WX86479 ohne Termin.
2025-11-17 12:04:46,530 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FL080CS40487 ohne Termin.
2025-11-17 12:04:46,541 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBS11ET0709Y73534 ohne Termin.
2025-11-17 12:04:46,552 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51CM0808E89909 ohne Termin.
2025-11-17 12:04:46,564 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61DP0909K93670 ohne Termin.
2025-11-17 12:04:46,575 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAJU810909K24494 ohne Termin.
2025-11-17 12:04:46,586 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FY090FT58281 ohne Termin.
2025-11-17 12:04:46,598 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GE0907P98025 ohne Termin.
2025-11-17 12:04:46,609 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA25DP010N131980 ohne Termin.
2025-11-17 12:04:46,620 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FY030FT71088 ohne Termin.
2025-11-17 12:04:46,631 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AU090CH53655 ohne Termin.
2025-11-17 12:04:46,642 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41CM0508E30277 ohne Termin.
2025-11-17 12:04:46,653 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FZ090FT30110 ohne Termin.
2025-11-17 12:04:46,665 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41CM0008E48122 ohne Termin.
2025-11-17 12:04:46,677 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61EE0205Z98343 ohne Termin.
2025-11-17 12:04:46,688 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41CM0808D25233 ohne Termin.
2025-11-17 12:04:46,703 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA7K310207P36144 ohne Termin.
2025-11-17 12:04:46,719 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAJU810009R84894 ohne Termin.
2025-11-17 12:04:46,731 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA58FU0308E59679 ohne Termin.
2025-11-17 12:04:46,744 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61CA0909P80872 ohne Termin.
2025-11-17 12:04:46,755 - ispa_next.appointments.models - DEBUG - Appointment R-Projekt FN Verwaltung GmbH HG-VS225 WBA2A71060VZ32541 ohne Termin.
2025-11-17 12:04:46,767 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBATA610309H05351 ohne Termin.
2025-11-17 12:04:46,778 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AU090CH53655 ohne Termin.
2025-11-17 12:04:46,789 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 B-DI2920 WBA7N510X07P81318 ohne Termin.
2025-11-17 12:04:46,826 - ispa_next.main - DEBUG - Found 15 out of 71 appointments to process (configured limit: 15).
2025-11-17 12:04:46,826 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 12:04:46,827 - ispa_next.main - DEBUG - All appointments: B-CJ1077, 0 34 16, B SB4307, B-AR 8589, BTM6020E, HD - DL 155E, B DB4010, HD-KO 183 E, HVL IP 313, HN TA 552, B-IG 1371, BFI1121, B-WU877, OHV-ZH 9, HN BO 135
2025-11-17 12:04:46,829 - ispa_next.main - DEBUG - 



2025-11-17 12:04:46,829 - ispa_next.main - DEBUG - starting with process 1 (B-CJ1077) of 15
2025-11-17 12:04:46,833 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:04:47,775 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:04:48,716 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:04:48,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 332
2025-11-17 12:04:50,114 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:04:50,115 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:05:20,252 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:05:29,637 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:31,499 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:05:31,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:31,596 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:31,817 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:05:31,820 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:05:34,596 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:05:34,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:35,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:37,831 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:05:37,978 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:05:38,090 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:05:38,186 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:05:44,508 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:05:51,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:05:52,873 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:05:52,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:53,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:03,822 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 12:06:10,723 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:06:10,725 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:06:10,727 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:06:11,357 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:06:11,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:06:12,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:06:15,787 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:06:15,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:16,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:18,531 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:06:18,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:06:18,794 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:06:18,921 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:06:25,196 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:06:32,623 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:06:33,628 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:06:33,629 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:06:33,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:33,711 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:06:37,852 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:06:37,857 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:06:37,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:37,939 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:06:38,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:38,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:38,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:39,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:39,487 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:06:41,312 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:06:41,314 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:06:42,694 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:06:42,696 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:06:42,701 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:06:42,702 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:06:42,716 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:06:42,717 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:06:42,719 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:06:42,725 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:06:42,726 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:06:42,732 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:06:42,740 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:06:42,744 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:06:42,745 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:44,619 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:06:44,621 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:06:44,622 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:46,450 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:06:46,455 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:06:46,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:06:47,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:06:47,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:51,284 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:06:51,286 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:53,151 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:07:03,404 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:07:03,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:07:04,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:07:04,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:13,038 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:17,942 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:07:17,944 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:07:17,945 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:07:18,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:07:18,587 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:07:18,589 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:07:20,231 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:07:29,805 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:07:30,189 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:07:30,835 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:07:32,674 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:07:32,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:07:35,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:07:35,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:07:36,371 - ispa_next.main - DEBUG - 



2025-11-17 12:07:36,371 - ispa_next.main - DEBUG - starting with process 2 (0 34 16) of 15
2025-11-17 12:07:36,375 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:07:37,363 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:07:38,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:07:38,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:07:39,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:07:39,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:07:55,600 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:07:55,713 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:07:55,719 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:07:56,187 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:07:56,189 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:07:58,809 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:07:58,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:07:59,655 - ispa_next.main - DEBUG - 



2025-11-17 12:07:59,655 - ispa_next.main - DEBUG - starting with process 3 (B SB4307) of 15
2025-11-17 12:07:59,659 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:08:00,706 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:08:01,751 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:08:01,752 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:08:03,184 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:08:03,185 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:08:23,798 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 12:08:23,808 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 12:08:23,812 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:08:24,270 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:08:24,272 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:08:26,944 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:08:26,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:08:27,806 - ispa_next.main - DEBUG - 



2025-11-17 12:08:27,806 - ispa_next.main - DEBUG - starting with process 4 (B-AR 8589) of 15
2025-11-17 12:08:27,810 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:08:28,808 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:08:29,831 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:08:29,833 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:08:31,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:08:31,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:09:00,523 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:09:09,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:15,146 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:09:15,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:15,227 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:15,456 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:09:15,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:15,552 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:19,226 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:09:22,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:09:22,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:23,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:25,459 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:09:25,591 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:09:28,809 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:09:28,914 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:09:28,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:34,279 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:09:45,442 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:09:46,447 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:09:46,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:46,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:50,106 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:09:50,110 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:09:50,116 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:09:50,118 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:09:50,766 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:09:50,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:09:51,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:09:55,068 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:09:55,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:55,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:57,536 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:09:57,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:09:57,801 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:09:57,900 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:09:57,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:03,205 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:10:14,563 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:11:14,565 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:11:25,719 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:12:00,722 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:12:11,909 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:12:19,554 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:12:20,560 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:12:20,561 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:12:20,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:12:20,647 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:12:24,787 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:12:24,791 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:12:24,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:12:24,864 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:12:33,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:34,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:34,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:12:34,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:12:34,702 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:12:39,379 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:12:39,381 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:12:40,409 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:12:40,410 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:12:40,415 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:12:40,416 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:12:40,426 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:12:40,427 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:12:40,428 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:12:40,432 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:12:40,433 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:12:40,437 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:12:40,439 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:12:41,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:12:41,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:12:50,901 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:12:50,906 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:12:50,910 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:12:50,911 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:56,959 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:12:56,961 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:12:56,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:02,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:03,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:13:12,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:28,039 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:13:28,042 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:13:28,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:13:28,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:13:28,795 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:13:28,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:34,602 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:13:45,394 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:13:45,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:13:46,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:13:46,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:56,815 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:01,857 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:07,810 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:14:07,811 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:14:08,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:14:08,523 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:14:08,525 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:14:13,160 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:14:21,139 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:14:21,522 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 12:14:23,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:14:24,931 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 12:14:24,933 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:14:27,915 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:14:27,917 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:14:28,786 - ispa_next.main - DEBUG - 



2025-11-17 12:14:28,786 - ispa_next.main - DEBUG - starting with process 5 (BTM6020E) of 15
2025-11-17 12:14:28,790 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:14:29,793 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:14:30,822 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 12:14:30,824 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:14:32,344 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:14:32,346 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:15:02,056 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:15:11,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:13,202 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:15:13,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:13,304 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:15:13,523 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:15:13,526 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:15:16,333 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:15:16,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:15:17,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:15:19,768 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:15:19,898 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:15:23,166 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:15:23,261 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:15:23,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:25,193 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:15:36,425 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:15:37,430 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:15:37,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:37,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:41,035 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:15:41,040 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:15:41,042 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:15:41,047 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:15:41,671 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:15:41,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:15:42,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:15:46,382 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:15:46,383 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:15:46,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:15:46,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:15:48,846 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:15:48,977 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:15:49,114 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:15:49,218 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:15:49,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:51,092 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:16:02,276 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:17:02,278 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:17:13,713 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:17:21,030 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:17:21,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:22,930 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:17:27,135 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:17:28,140 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:17:28,141 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:17:28,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:17:28,227 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:17:32,381 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:17:32,385 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:17:32,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:17:32,459 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:17:42,339 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 12:17:47,117 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:17:47,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:47,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:47,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:17:48,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:17:48,679 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:17:50,557 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:17:50,559 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:17:51,724 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:17:51,725 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:17:51,731 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:17:51,732 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:17:51,742 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:17:51,744 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:17:51,745 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:17:51,750 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:17:51,751 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:17:51,757 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:17:51,759 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:17:52,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:17:53,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:18:23,441 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:18:23,456 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:18:24,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:18:24,226 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:18:32,592 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:18:32,593 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 12:18:38,370 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:18:38,373 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:18:38,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:41,600 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:18:41,602 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:18:41,608 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:44,796 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:18:44,798 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:18:44,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:18:45,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:18:45,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:57,414 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:18:57,416 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:00,619 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:19:11,609 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:19:12,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:19:12,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:19:12,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:20,541 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:19:25,048 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:19:30,349 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:19:35,784 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:19:35,786 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:19:35,787 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:19:36,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:19:36,454 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:19:36,455 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:19:38,213 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:19:46,720 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:19:47,115 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 12:19:48,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:19:49,673 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:19:49,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:19:52,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 12:19:52,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:19:53,683 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:19:53,695 - ispa_next.appointments.models - DEBUG - Appointment Kristina Kiriia B-GK2805E WBA71FJ060CT91289 ohne Termin.
2025-11-17 12:19:53,710 - ispa_next.main - DEBUG - 



2025-11-17 12:19:53,710 - ispa_next.main - DEBUG - starting with process 6 (HD - DL 155E) of 15
2025-11-17 12:19:53,714 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:19:54,755 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:19:55,796 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:19:55,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 878
2025-11-17 12:19:57,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:19:57,397 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:20:28,973 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:20:38,360 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:39,537 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:20:39,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:20:39,615 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:20:39,860 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:20:39,863 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:20:42,689 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:20:42,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:20:44,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:20:46,135 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:20:46,270 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:20:49,510 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:20:49,627 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:20:49,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:50,843 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:21:02,173 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:21:03,177 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:21:03,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:21:03,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:21:06,815 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:21:06,819 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:21:06,821 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:21:06,826 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:21:07,464 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:21:07,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:21:08,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:21:11,939 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:21:11,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:21:12,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:21:14,399 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:21:14,528 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:21:14,654 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:21:14,747 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:21:14,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:21:15,932 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:21:27,494 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:22:27,496 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:22:38,362 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:22:45,435 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:22:45,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:46,671 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:22:50,921 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:22:51,928 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:22:51,929 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:22:51,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:52,022 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:22:56,160 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:22:56,164 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:22:56,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:56,237 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:23:01,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:02,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:02,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:02,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:23:02,918 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:23:04,192 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:23:04,194 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:23:05,187 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:23:05,188 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:23:05,194 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:23:05,195 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:23:05,204 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:23:05,206 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:23:05,207 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:23:05,212 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:23:05,213 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:23:05,216 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:23:05,218 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:23:05,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:23:06,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:23:15,832 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:23:15,834 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:23:16,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:23:16,708 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:23:25,207 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:23:25,209 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:23:25,211 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:23:25,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:27,051 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:23:27,053 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:23:27,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:28,927 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:23:28,929 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:23:28,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:23:29,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:23:29,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:40,290 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:23:40,292 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:42,165 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:23:53,192 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:23:53,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:23:54,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:23:54,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:24:00,868 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:24:06,507 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:24:06,509 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:24:06,509 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:24:07,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:24:07,208 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:24:07,211 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:24:08,934 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:24:16,916 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:24:17,301 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:24:18,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:24:20,143 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1654
2025-11-17 12:24:20,145 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:24:23,436 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 12:24:23,437 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:24:24,340 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:24:24,349 - ispa_next.appointments.models - DEBUG - Appointment Kristina Kiriia B-GK2805E WBA71FJ060CT91289 ohne Termin.
2025-11-17 12:24:24,359 - ispa_next.main - DEBUG - Found new Appointment: B-WR7070
2025-11-17 12:24:24,361 - ispa_next.main - DEBUG - 



2025-11-17 12:24:24,361 - ispa_next.main - DEBUG - starting with process 7 (B-WR7070) of 16
2025-11-17 12:24:24,364 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:24:25,498 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:24:27,031 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1654
2025-11-17 12:24:27,033 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 878
2025-11-17 12:24:28,689 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:24:28,691 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:25:01,023 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:25:10,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:11,915 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:25:11,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:12,005 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:25:12,231 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:25:12,234 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:25:15,046 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:25:15,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:16,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:25:18,629 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:25:18,758 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:25:23,943 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:25:24,029 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:25:24,030 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:25,244 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:25:36,709 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:25:37,714 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:25:37,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:38,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:50,522 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:25:57,983 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:25:57,985 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:25:57,987 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:25:58,628 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:25:58,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:25:59,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:26:03,220 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:26:03,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:03,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:26:05,686 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:26:05,833 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:26:05,954 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:26:06,060 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:26:06,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:07,670 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:26:18,374 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:26:25,562 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:26:25,564 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:26,844 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:26:31,066 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:26:32,074 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:26:32,075 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:26:32,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:32,172 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:26:36,347 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:26:36,351 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:26:36,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:36,424 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:26:36,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:37,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:37,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:38,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:26:38,038 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:26:39,331 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:26:39,333 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:26:40,405 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:26:40,406 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:26:40,410 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:26:40,412 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:26:40,421 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:26:40,423 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:26:40,424 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:26:40,429 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:26:40,430 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:26:40,454 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:26:40,456 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:26:41,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:26:41,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:26:51,184 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:26:51,185 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:26:51,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:26:51,986 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:27:00,957 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:27:00,959 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:27:00,961 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:27:00,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:02,815 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:27:02,818 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:27:02,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:04,676 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:27:04,678 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:27:04,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:27:05,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:27:05,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:14,551 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:27:14,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:16,402 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:27:27,631 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:27:28,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:27:28,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:27:28,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:35,593 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:27:41,423 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:27:41,425 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:27:41,426 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:27:42,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:27:42,156 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:27:42,158 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:27:43,937 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:27:53,153 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:27:53,550 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 12:27:54,643 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:27:56,468 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1654
2025-11-17 12:27:56,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:27:59,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 877
2025-11-17 12:27:59,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:00,778 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:28:00,791 - ispa_next.main - DEBUG - 



2025-11-17 12:28:00,791 - ispa_next.main - DEBUG - starting with process 8 (B DB4010) of 16
2025-11-17 12:28:00,795 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:28:01,870 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:28:02,967 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1654
2025-11-17 12:28:02,969 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 877
2025-11-17 12:28:04,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:28:04,762 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:38,936 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:28:48,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:49,908 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:28:49,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:28:49,998 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:28:50,229 - ispa_next.functions - DEBUG - HU date already expired after 3 days.
2025-11-17 12:28:57,120 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:28:57,123 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:29:00,869 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:29:00,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:02,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:04,602 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:29:04,735 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:29:07,984 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:29:08,064 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:29:08,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:09,272 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:29:20,707 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:29:21,711 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:29:21,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:22,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:25,420 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:29:25,425 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:29:25,427 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:29:25,429 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:29:26,172 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:29:26,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:29:27,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:29:31,222 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:29:31,222 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:29:31,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:31,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:33,697 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:29:33,832 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:29:33,983 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:29:34,062 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:29:34,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:35,280 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:29:46,577 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:30:46,579 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:30:57,757 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:31:04,932 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:31:04,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:06,180 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:31:10,376 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:31:11,382 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:31:11,383 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:31:11,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:31:11,462 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:31:15,627 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:31:15,631 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:31:15,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:31:15,706 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:31:19,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:31:20,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:31:20,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:31:21,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:31:21,103 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:31:22,379 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:31:22,382 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:31:23,467 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:31:23,468 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:31:23,473 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:31:23,474 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:31:23,483 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:31:23,488 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:31:23,489 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:31:23,494 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:31:23,497 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:31:23,503 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:31:23,505 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:31:24,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:31:25,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:31:34,740 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:31:34,741 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:31:35,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:31:35,606 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:31:44,487 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:31:44,490 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:31:44,492 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:31:44,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:46,327 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:31:46,330 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:31:46,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:48,169 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:31:48,171 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:31:48,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:31:49,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:31:49,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:58,216 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:31:58,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:00,144 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:32:11,493 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:32:12,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:32:12,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:32:12,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:19,794 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:25,772 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:25,775 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:32:25,775 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:26,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:32:26,491 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:32:26,494 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:32:28,965 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:32:37,388 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:32:37,775 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 12:32:38,958 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:40,861 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:32:40,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:44,220 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 12:32:44,221 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:32:45,135 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:32:45,146 - ispa_next.main - DEBUG - Found new Appointment: B-M1040
2025-11-17 12:32:45,147 - ispa_next.main - DEBUG - 



2025-11-17 12:32:45,147 - ispa_next.main - DEBUG - starting with process 9 (B-M1040) of 17
2025-11-17 12:32:45,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:46,244 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:47,380 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:32:47,381 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 878
2025-11-17 12:32:49,212 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:49,214 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:33:23,069 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:33:33,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:33,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:33:33,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:35,004 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:33:35,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:35,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:33:35,391 - ispa_next.functions - DEBUG - HU date already expired after 296 days.
2025-11-17 12:33:42,654 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:33:42,657 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:33:45,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:33:45,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:33:47,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:33:49,171 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:33:49,298 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:33:52,544 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:33:52,654 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:33:52,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:54,426 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:34:05,769 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:34:06,773 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:34:06,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:07,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:22,759 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:34:31,207 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:34:31,210 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:34:31,211 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:34:31,923 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:34:31,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:34:33,069 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:34:36,654 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:34:36,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:37,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:34:39,147 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:34:39,302 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:34:39,412 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:34:39,505 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:34:39,507 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:40,691 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:34:52,017 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:35:52,019 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:36:03,352 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:36:23,355 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:36:34,710 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:36:42,674 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:36:43,680 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:36:43,681 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:36:43,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:43,764 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:36:47,937 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:36:47,942 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:36:47,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:48,014 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:36:48,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:36:48,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:36:48,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:49,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:36:49,605 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:36:50,870 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:36:50,872 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:36:52,034 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:36:52,036 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:36:52,044 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:36:52,045 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:36:52,049 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:36:52,050 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:36:52,051 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:36:52,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:36:52,056 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:36:52,062 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:36:52,064 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:36:52,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:36:53,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:37:04,016 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:37:04,017 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:37:04,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:37:04,827 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:37:13,953 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:37:13,956 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:37:13,957 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:37:13,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:37:15,812 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:37:15,814 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:37:15,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:37:17,660 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:37:17,665 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:37:17,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:37:18,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:37:18,506 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:37:18,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:37:20,384 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:37:31,219 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:37:31,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:37:32,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:37:32,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:37:41,379 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:37:47,602 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:37:47,604 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:37:47,605 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:37:48,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:37:48,342 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:37:48,344 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:37:50,383 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:37:59,450 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:37:59,828 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 12:38:01,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:38:03,404 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1656
2025-11-17 12:38:03,405 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:38:07,137 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 877
2025-11-17 12:38:07,138 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:38:08,067 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 12:38:08,081 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:38:08,094 - ispa_next.main - DEBUG - 



2025-11-17 12:38:08,094 - ispa_next.main - DEBUG - starting with process 10 (HD-KO 183 E) of 17
2025-11-17 12:38:08,099 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:38:09,241 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:38:10,395 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1656
2025-11-17 12:38:10,397 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 877
2025-11-17 12:38:12,456 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:38:12,458 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:38:48,823 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:39:01,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:05,608 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:39:05,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:05,690 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:39:05,949 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:39:05,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:06,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:39:10,822 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:39:14,055 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:39:14,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:39:15,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:39:17,846 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:39:18,031 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:39:21,297 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:39:21,386 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:39:21,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:25,351 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:39:36,781 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:39:37,786 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:39:37,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:38,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:41,674 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:39:41,678 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:39:41,680 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:39:41,682 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:39:42,420 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:39:42,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:39:43,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:39:47,121 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:39:47,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:39:47,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:39:49,608 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:39:49,743 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:39:49,891 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:39:49,986 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:39:49,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:53,971 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:40:06,071 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:41:06,073 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:41:17,386 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:41:49,388 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:42:00,818 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:42:08,958 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:42:09,963 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:42:09,965 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:42:09,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:10,075 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:42:14,216 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:42:14,221 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:42:14,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:14,297 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:42:19,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:42:20,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:42:20,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:21,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:42:21,197 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:42:25,016 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:42:25,018 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:42:26,274 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:42:26,276 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:42:26,280 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:42:26,281 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:42:26,287 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:42:26,293 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:42:26,298 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:42:26,304 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:42:26,306 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:42:26,312 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:42:26,315 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:42:26,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:42:28,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:42:37,889 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:42:37,891 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:42:38,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:42:39,023 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:42:48,045 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:42:48,047 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:42:48,049 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:42:48,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:52,897 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:42:52,899 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:42:52,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:57,515 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:42:57,517 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:42:57,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:42:58,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:42:58,427 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:42:58,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:43:02,949 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:43:14,195 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:43:14,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:43:15,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:43:15,637 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:43:26,151 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:43:32,553 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:43:32,554 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:43:33,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:43:33,296 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:43:33,298 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:43:38,898 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:43:48,259 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:43:48,638 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 12:43:49,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:43:52,125 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:43:52,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:43:55,822 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:43:55,823 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:43:56,759 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 12:43:56,769 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:43:56,779 - ispa_next.main - DEBUG - 



2025-11-17 12:43:56,779 - ispa_next.main - DEBUG - starting with process 11 (HVL IP 313) of 17
2025-11-17 12:43:56,783 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:43:57,921 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:43:59,045 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:43:59,046 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:44:01,041 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:44:01,043 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:44:36,991 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:44:48,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:44:51,046 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:44:51,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:44:51,168 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:44:51,373 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:44:51,376 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:44:54,232 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:44:54,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:44:56,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:44:58,106 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:44:58,237 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:45:03,376 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:45:03,486 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:45:03,487 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:45:06,055 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:45:17,505 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:45:18,510 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:45:18,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:45:19,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:45:22,449 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:45:22,453 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:45:22,455 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:45:22,457 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:45:23,183 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:45:23,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:45:24,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:45:28,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:45:28,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:45:28,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:45:30,591 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:45:30,718 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:45:30,841 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:45:30,976 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:45:30,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:45:33,582 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:45:44,961 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:46:44,964 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:46:56,962 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:47:04,259 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:47:04,260 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:06,958 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:47:11,153 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:47:12,159 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:47:12,160 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:47:12,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:47:12,238 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:47:16,402 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:47:17,148 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:47:31,406 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:47:31,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:47:31,511 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:47:40,330 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 12:47:50,019 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:47:50,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:47:51,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:47:51,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:47:52,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:47:52,895 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:47:55,487 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:47:55,490 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:47:57,214 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:47:57,216 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:47:57,221 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:47:57,226 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:47:57,232 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:47:57,233 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:47:57,235 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:47:57,239 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:47:57,240 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:47:57,245 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:47:57,247 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:47:57,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:47:59,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:48:38,033 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:48:38,169 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:48:40,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:48:40,521 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:48:50,918 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:48:50,919 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 12:49:00,091 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:49:00,094 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:49:00,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:04,201 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:49:04,203 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:49:04,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:08,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:09,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:49:18,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:37,451 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:49:37,453 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:49:37,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:49:39,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:49:39,601 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:46,617 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:49:46,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:50,667 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:50:07,947 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:50:08,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:50:09,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:50:09,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:23,934 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:50:33,220 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:50:33,221 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:50:34,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:50:34,481 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:50:34,483 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:50:40,959 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:50:54,765 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:50:55,137 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 12:50:58,218 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:51:05,234 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:51:05,236 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:12,920 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:51:12,921 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:51:14,295 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 12:51:14,308 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:51:14,319 - ispa_next.main - DEBUG - 



2025-11-17 12:51:14,319 - ispa_next.main - DEBUG - starting with process 12 (HN TA 552) of 17
2025-11-17 12:51:14,323 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:51:16,217 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:51:18,243 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1655
2025-11-17 12:51:18,245 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 12:51:22,015 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:22,017 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:52:13,994 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:52:27,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:52:29,669 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:52:29,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:52:29,779 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:52:30,164 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:52:30,167 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:52:33,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:52:33,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:52:35,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:52:37,965 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:52:38,113 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:52:41,457 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:52:41,586 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:52:41,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:52:43,530 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:52:56,115 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:52:57,120 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:52:57,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:52:57,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:02,761 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:53:02,765 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:53:02,768 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:53:02,770 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:53:03,997 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:53:03,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:53:05,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:53:09,305 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:53:09,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:09,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:53:11,924 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:53:12,114 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:53:12,293 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:53:12,452 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:53:12,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:14,977 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:53:27,298 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:54:27,300 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:54:38,277 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:54:46,476 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:54:46,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:54:48,407 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:54:52,650 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:54:53,656 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:54:53,657 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:54:53,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:54:53,841 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:54:58,024 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:54:59,274 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:55:10,590 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:55:10,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:55:10,726 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:55:16,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:55:17,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:55:17,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:55:18,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:55:18,239 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:55:20,240 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:55:20,243 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:55:22,118 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:55:22,120 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:55:22,124 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 12:55:22,129 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:55:22,133 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:55:22,135 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 12:55:22,137 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:55:22,141 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:55:22,142 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:55:22,146 - ispa_next.package_manager.main - DEBUG - found packages to update: {Package(name=Service Bremse vorn, source=cart, target=update)}
2025-11-17 12:55:22,149 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:55:22,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:55:24,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:55:36,175 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:55:36,284 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:55:36,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:55:37,126 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:55:47,542 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:55:47,543 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 12:55:50,702 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:55:51,244 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:55:52,198 - ispa_next.package_manager.helper - DEBUG - _update_parts_in_package
2025-11-17 12:55:57,057 - ispa_next.package_manager.helper - DEBUG - Part with number '83192413695' cannot be removed / replaced.
2025-11-17 12:55:59,536 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:56:00,250 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:56:00,792 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:56:01,715 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:56:02,435 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:56:02,975 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:56:03,902 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:56:05,927 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:56:06,899 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:56:07,864 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:56:08,022 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:56:08,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:11,017 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 12:56:18,294 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:56:18,385 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:56:18,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:23,380 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:56:23,382 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:56:23,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:56:24,183 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:56:25,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:35,685 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:56:35,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:38,358 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:56:54,704 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:56:55,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:56:56,401 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:56:56,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:57:09,643 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:57:18,779 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:57:18,785 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:57:19,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:57:19,990 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:57:19,992 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:57:26,572 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:57:40,367 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:57:40,767 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 12:57:42,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:57:51,431 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1657
2025-11-17 12:57:51,433 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:57:59,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 877
2025-11-17 12:57:59,300 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:00,673 - ispa_next.appointments.models - DEBUG - Appointment Michael Sous Wasseraufbereitun TF-BB2711 WBA21FY020FS47205 ohne Termin.
2025-11-17 12:58:00,688 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 12:58:00,703 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:58:00,715 - ispa_next.main - DEBUG - 



2025-11-17 12:58:00,715 - ispa_next.main - DEBUG - starting with process 13 (B-IG 1371) of 17
2025-11-17 12:58:00,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:58:02,655 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:58:04,650 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1657
2025-11-17 12:58:04,652 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 877
2025-11-17 12:58:09,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:58:09,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:35,885 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:58:36,148 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 12:58:36,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:58:37,009 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1657
2025-11-17 12:58:37,011 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:58:44,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 877
2025-11-17 12:58:44,333 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:45,720 - ispa_next.appointments.models - DEBUG - Appointment Michael Sous Wasseraufbereitun TF-BB2711 WBA21FY020FS47205 ohne Termin.
2025-11-17 12:58:45,730 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 12:58:45,740 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 12:58:45,750 - ispa_next.main - DEBUG - 



2025-11-17 12:58:45,750 - ispa_next.main - DEBUG - starting with process 14 (BFI1121) of 17
2025-11-17 12:58:45,754 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:58:47,750 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:58:49,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1657
2025-11-17 12:58:49,827 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 877
2025-11-17 12:58:53,634 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:58:53,636 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:59:46,193 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:00:00,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:00:05,198 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:00:05,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:05,298 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:00:05,663 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:00:05,667 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:00:08,801 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:00:08,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:00:11,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:00:13,661 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:00:13,827 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:00:17,226 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:00:17,362 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:00:17,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:00:22,249 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:00:34,847 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:00:35,851 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:00:35,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:36,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:41,823 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:00:41,828 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:00:41,830 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:00:41,832 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:00:43,164 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:00:43,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:00:44,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:00:49,490 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:00:50,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:00:51,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:00:53,481 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:00:53,637 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:00:53,832 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:00:53,962 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:00:53,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:00:59,022 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:01:10,163 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:01:18,493 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:01:18,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:23,376 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:01:27,647 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:01:28,653 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:01:28,654 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:01:28,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:28,765 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:01:32,961 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:01:32,965 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:01:32,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:33,074 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:01:33,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:34,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:34,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:35,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:01:35,511 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:01:39,850 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:01:39,852 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:01:42,505 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:01:42,507 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:01:42,512 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 13:01:42,513 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:01:42,518 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:01:42,519 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 13:01:42,520 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:01:42,526 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:01:42,527 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:01:42,536 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:01:42,539 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:01:43,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:01:44,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:01:56,727 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:01:56,728 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 13:01:57,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:01:58,265 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 13:02:08,767 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:02:08,770 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:02:08,772 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:02:08,773 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:14,444 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:02:14,446 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:02:14,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:20,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:02:20,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:02:33,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:54,196 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:02:54,198 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:02:54,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:02:55,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:02:56,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:12,273 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:03:12,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:17,713 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:03:35,103 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:03:35,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:03:36,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:03:37,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:54,168 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:04:03,780 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:04:03,781 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:04:04,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:04:05,089 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:04:05,092 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:04:11,868 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:04:26,197 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:04:26,602 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 13:04:35,603 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:04:37,254 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:04:37,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:04:45,102 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 13:04:45,103 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:04:46,497 - ispa_next.appointments.models - DEBUG - Appointment Job Impulse GmbH MZ-JI30E WMW21BS0803P55360 ohne Termin.
2025-11-17 13:04:46,507 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 13:04:46,518 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 13:04:46,527 - ispa_next.main - DEBUG - 



2025-11-17 13:04:46,527 - ispa_next.main - DEBUG - starting with process 15 (B-WU877) of 17
2025-11-17 13:04:46,531 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:04:48,503 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:04:51,663 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:04:51,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 878
2025-11-17 13:04:55,453 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:04:55,455 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:05:43,576 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:05:58,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:59,020 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:05:59,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:00,544 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:06:00,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:00,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:06:01,001 - ispa_next.functions - DEBUG - HU date already expired after 5638 days.
2025-11-17 13:06:11,489 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:06:11,493 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:06:15,641 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:06:15,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:18,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:06:20,082 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:06:28,950 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 13:06:39,770 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 13:06:40,775 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:06:40,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:41,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:03,331 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:07:16,012 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:07:16,014 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:07:16,016 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:07:16,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:07:18,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:07:20,514 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:07:20,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:07:21,132 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:07:25,230 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:07:25,230 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:07:25,231 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:07:25,233 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:07:25,234 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:07:25,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:26,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:07:30,426 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:07:30,431 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:07:30,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:30,534 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:07:31,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:32,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:07:32,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:07:33,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:07:33,513 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:07:34,799 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:07:34,801 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:07:37,067 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:07:37,068 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:07:37,072 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 13:07:37,073 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:07:37,077 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:07:37,079 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 13:07:37,080 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:07:37,084 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:07:37,086 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:07:37,096 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:07:37,103 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:07:37,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:07:39,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:07:53,663 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:07:53,846 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 13:07:54,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:07:54,644 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 13:08:07,079 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:08:07,259 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:08:07,261 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:08:07,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:09,298 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:08:09,300 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:08:09,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:11,315 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:08:11,318 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:08:11,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:08:12,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:08:12,600 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:08:12,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:14,511 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:08:31,424 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:08:31,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:08:33,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:08:33,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:46,784 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:08:57,768 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:08:57,770 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:08:57,771 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:08:58,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:08:59,049 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:08:59,050 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:09:02,157 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:09:15,627 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:09:16,007 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 13:09:17,928 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:26,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:09:26,594 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:34,398 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 13:09:34,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:35,844 - ispa_next.appointments.models - DEBUG - Appointment Job Impulse GmbH MZ-JI30E WMW21BS0803P55360 ohne Termin.
2025-11-17 13:09:35,854 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 13:09:35,868 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 13:09:35,882 - ispa_next.main - DEBUG - 



2025-11-17 13:09:35,882 - ispa_next.main - DEBUG - starting with process 16 (OHV-ZH 9) of 17
2025-11-17 13:09:35,887 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:37,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:39,973 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:09:39,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 878
2025-11-17 13:09:44,012 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:44,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:07,711 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:10:08,145 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 13:10:08,149 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:09,173 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:10:09,175 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:16,919 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 13:10:16,920 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:18,314 - ispa_next.appointments.models - DEBUG - Appointment Job Impulse GmbH MZ-JI30E WMW21BS0803P55360 ohne Termin.
2025-11-17 13:10:18,329 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 13:10:18,341 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
2025-11-17 13:10:18,351 - ispa_next.main - DEBUG - 



2025-11-17 13:10:18,351 - ispa_next.main - DEBUG - starting with process 17 (HN BO 135) of 17
2025-11-17 13:10:18,355 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:10:20,447 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:22,572 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:10:22,574 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 878
2025-11-17 13:10:26,597 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:26,598 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:47,322 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:10:47,777 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 13:10:47,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:48,824 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 13:10:48,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:57,736 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 878
2025-11-17 13:10:57,737 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:59,156 - ispa_next.appointments.models - DEBUG - Appointment Job Impulse GmbH MZ-JI30E WMW21BS0803P55360 ohne Termin.
2025-11-17 13:10:59,166 - ispa_next.appointments.models - DEBUG - Appointment Jacqueline Reimann B-JR7227 WMWXM710302B89189 ohne Termin.
2025-11-17 13:10:59,176 - ispa_next.appointments.models - DEBUG - Appointment Dr. Ulrike Schmelter-Mühle B-US2864 WBAJT11010CD36660 ohne Termin.
