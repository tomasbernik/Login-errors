2025-11-12 13:08:22,128 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:08:22,136 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:08:33,408 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:08:45,293 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:09:01,113 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:11:01,255 - ispa_next.app_start.main - DEBUG - Operation already took 108.73 seconds (more than 80 seconds)
2025-11-12 13:11:03,355 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\04f96e5edacca5a7\\tess_yow3vi3h_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\04f96e5edacca5a7\\tess_yow3vi3h', 'txt']
2025-11-12 13:11:03,692 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:11:03,696 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:11:03,697 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:11:30,371 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:11:49,483 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:11:52,643 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:54,504 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:11:54,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 13:11:57,907 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 66
2025-11-12 13:11:57,908 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:11:57,908 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:11:59,462 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:12:00,936 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:12:12,937 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:12:12,974 - ispa_next.main - DEBUG - Found 6 out of 7 appointments to process (configured limit: 15).
2025-11-12 13:12:12,974 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-12 13:12:12,975 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 13:12:12,975 - ispa_next.main - DEBUG - All appointments: HF-KT 524, mi mp 200, GT-WK 7070, OS-MW 37, MI-JH356, MI-EI 121E
2025-11-12 13:12:12,979 - ispa_next.main - DEBUG - 



2025-11-12 13:12:12,979 - ispa_next.main - DEBUG - starting with process 1 (HF-KT 524) of 6
2025-11-12 13:12:12,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:12:14,484 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:12:16,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:12:16,338 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 66
2025-11-12 13:12:17,978 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:12:17,979 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:12:56,434 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:13:08,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:16,927 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:13:16,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:17,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:13:17,389 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:13:17,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:17,534 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:13:25,676 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:13:28,591 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:13:28,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:29,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:31,862 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:13:32,021 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:13:32,140 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:13:32,261 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:13:32,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:13:40,639 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:49,494 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:13:50,498 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:13:50,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:51,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:01,666 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:14:10,905 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:14:10,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:11,051 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:14:11,052 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:14:11,141 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:14:12,518 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:14:14,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:14:14,520 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:14:16,552 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-12 13:14:17,516 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:14:17,518 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:14:18,651 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:14:18,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:14:19,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:14:23,245 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:14:23,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:23,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:14:25,722 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:14:25,867 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:14:26,057 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:14:26,146 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:14:26,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:34,543 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:14:43,319 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:15:43,322 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:15:54,999 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 13:16:01,483 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:16:01,485 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:10,330 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:16:14,560 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:16:15,565 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:16:15,565 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:16:15,566 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:15,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:16:19,903 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:16:20,870 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 13:16:36,252 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:16:36,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:36,395 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:16:36,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:37,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:37,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:38,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:38,737 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:16:46,434 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:16:46,460 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:16:48,349 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:16:48,352 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:16:48,356 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-12 13:16:48,359 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:16:48,364 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 13:16:48,367 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:16:48,369 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:16:48,370 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:16:48,373 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:16:48,375 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:16:49,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:16:50,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:16:57,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 13:16:58,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 13:17:17,501 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:17:17,502 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 13:17:22,283 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:22,839 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:23,423 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:25,102 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:25,670 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:26,226 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:27,834 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:28,424 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:28,974 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:30,658 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:31,211 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:31,762 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:33,355 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:33,904 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:34,483 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:36,076 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:36,638 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:37,188 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:38,818 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:39,366 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:39,915 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:41,476 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:42,038 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:42,587 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:45,267 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:45,830 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:46,382 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:47,985 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:48,543 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:49,099 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:50,684 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:51,266 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:51,840 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:53,460 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:54,012 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:54,562 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:56,168 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 13:17:56,718 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 13:17:57,287 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 13:17:57,860 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-12 13:17:58,420 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-12 13:17:58,970 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-12 13:17:59,522 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-12 13:17:59,522 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-12 13:18:01,529 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-12 13:18:02,070 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:18:02,071 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:18:04,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:18:05,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:18:05,943 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:18:06,039 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:18:14,468 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:18:14,472 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:15,883 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:18:15,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:22,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 13:18:22,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:24,957 - ispa_next.main - DEBUG - Found new Appointment: DH-GA 3333
2025-11-12 13:18:24,958 - ispa_next.main - DEBUG - 



2025-11-12 13:18:24,958 - ispa_next.main - DEBUG - starting with process 2 (DH-GA 3333) of 7
2025-11-12 13:18:24,962 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:18:27,834 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:18:31,301 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:18:31,303 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 13:18:35,102 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:18:35,104 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:19:25,747 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:19:42,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:43,045 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:43,396 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:46,181 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:19:46,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:46,452 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:46,960 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:19:46,962 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:19:50,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:19:50,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:53,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:55,009 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:19:55,190 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:19:55,409 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:19:55,567 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:19:55,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:19:58,514 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:20:09,904 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:20:17,698 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:20:17,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:20:20,518 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:20:24,813 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:20:25,820 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:20:25,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:26,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:44,679 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:20:59,540 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:20:59,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:59,706 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:20:59,707 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:20:59,792 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:21:01,361 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:21:01,745 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:21:04,743 - ispa_next.functions - DEBUG - Updated appointment (AA00050559) customer contact data.
2025-11-12 13:21:05,769 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:21:05,894 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:21:07,987 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:21:07,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:21:09,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:21:13,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:21:13,089 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:21:13,092 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:21:13,093 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:21:13,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:21:13,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:21:17,935 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:21:17,939 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:21:17,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:21:18,129 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:21:23,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:21:24,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:21:24,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:21:25,568 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:21:25,569 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:21:28,243 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:21:28,260 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:21:30,438 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:21:30,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:21:30,442 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-12 13:21:30,443 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:21:30,446 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:21:30,447 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:21:30,449 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:21:30,452 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:21:30,453 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:21:30,456 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:21:30,459 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:21:31,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:21:32,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:21:39,768 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:21:39,770 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:21:39,771 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:21:39,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:43,311 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:21:43,313 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:21:43,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:46,875 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:21:46,876 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:21:46,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:50,512 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:21:50,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:21:51,568 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:21:52,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:26,718 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:22:26,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:30,276 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:22:53,039 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:22:53,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:22:54,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:22:55,103 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:31,068 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:23:39,202 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:23:49,267 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:23:58,262 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:23:58,263 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:23:58,265 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:23:59,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:23:59,897 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:23:59,899 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:24:04,257 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:24:26,557 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:24:26,953 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:24:29,359 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:30,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:24:30,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:37,680 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 13:24:37,682 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:39,800 - ispa_next.main - DEBUG - 



2025-11-12 13:24:39,800 - ispa_next.main - DEBUG - starting with process 3 (mi mp 200) of 7
2025-11-12 13:24:39,809 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:24:42,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:24:45,803 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:24:45,805 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 13:24:49,002 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:24:49,004 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:32,828 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:25:32,841 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:25:32,845 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:34,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:25:34,308 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:40,925 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 13:25:40,926 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:42,745 - ispa_next.main - DEBUG - 



2025-11-12 13:25:42,745 - ispa_next.main - DEBUG - starting with process 4 (GT-WK 7070) of 7
2025-11-12 13:25:42,749 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:25:45,722 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:49,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:25:49,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 13:25:52,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:52,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:39,902 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:26:44,517 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:26:53,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:57,312 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:26:57,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:57,528 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:57,971 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:27:06,631 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:27:06,634 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:27:09,960 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:27:09,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:27:12,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:27:14,095 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:27:14,302 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:27:14,560 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:27:14,784 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:27:19,061 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:27:20,065 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:27:20,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:20,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:37,394 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:27:46,074 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:27:46,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:46,209 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:27:46,210 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:27:46,335 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:27:47,925 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:27:48,591 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:27:53,541 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:27:53,599 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:27:55,522 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:27:55,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:27:56,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:28:00,496 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:00,496 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:28:00,499 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:28:00,499 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:28:00,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:01,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:05,256 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:28:05,260 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:28:05,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:05,421 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:28:14,360 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:28:29,611 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:28:30,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:30,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:30,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:31,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:31,987 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:28:35,929 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:28:35,931 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:28:38,277 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:28:38,280 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:28:38,283 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:28:38,284 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:28:38,286 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:28:38,288 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:28:38,289 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:28:38,292 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:28:38,293 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:28:38,296 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:28:38,299 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:28:38,301 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:28:38,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:42,662 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:28:42,664 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:28:42,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:46,925 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:28:46,925 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:28:46,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:51,273 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:28:51,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:28:54,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:28:54,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:15,687 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:29:15,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:20,057 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:29:43,569 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:29:44,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:29:45,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:29:45,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:28,607 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:30:36,905 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:30:45,372 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:30:53,745 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:03,931 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:03,933 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:31:03,934 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:31:05,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:05,743 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:31:05,744 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:31:10,123 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:31:28,808 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:31:29,203 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:31:31,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:31:32,955 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:31:32,957 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:31:40,075 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 13:31:40,076 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:31:42,290 - ispa_next.main - DEBUG - 



2025-11-12 13:31:42,290 - ispa_next.main - DEBUG - starting with process 5 (OS-MW 37) of 7
2025-11-12 13:31:42,294 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:31:45,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:31:48,497 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 288
2025-11-12 13:31:48,500 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 13:31:51,879 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:31:51,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:44,827 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:32:49,249 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:32:57,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:02,847 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:33:02,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:03,032 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:03,514 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:33:03,517 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:33:07,024 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:33:07,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:09,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:11,051 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:33:11,275 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:33:11,499 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:33:11,678 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:33:16,002 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:33:17,008 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:33:17,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:17,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:34,364 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:33:43,440 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:33:43,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:43,556 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:43,557 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:33:43,716 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:33:43,916 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:33:46,174 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:33:46,535 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:33:49,177 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:33:49,178 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:33:49,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:33:50,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:33:52,990 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:33:52,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:33:53,153 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:33:56,809 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:33:56,809 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:33:56,813 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:33:56,814 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:33:56,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:57,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:01,661 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:34:01,665 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:34:01,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:01,774 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:34:10,949 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:34:25,127 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:34:25,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:26,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:26,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:27,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:27,681 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:34:32,339 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:34:32,342 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:34:34,703 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:34:34,707 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:34:34,711 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:34:34,712 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:34:34,716 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:34:34,717 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:34:34,718 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:34:34,721 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:34:34,722 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:34:34,724 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:34:34,728 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:34:34,730 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:34:34,731 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:39,960 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:34:39,961 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:34:39,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:44,878 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:34:44,879 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:34:44,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:50,970 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:34:50,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:34:52,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:34:52,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:01,212 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:35:01,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:06,174 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:35:28,843 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:35:29,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:35:30,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:35:30,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:20,590 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:29,498 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:37,945 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:46,921 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:55,976 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:05,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:05,244 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:05,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:06,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:06,960 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:06,962 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:11,450 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:37:30,949 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:31,337 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:37:33,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:35,173 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 13:37:35,175 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:42,253 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-12 13:37:42,257 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:44,132 - ispa_next.appointments.models - DEBUG - Appointment Schwarz Mobility HN-VA 631 WBA11AK0707P88462 ohne Termin.
2025-11-12 13:37:44,141 - ispa_next.main - DEBUG - 



2025-11-12 13:37:44,141 - ispa_next.main - DEBUG - starting with process 6 (MI-JH356) of 7
2025-11-12 13:37:44,145 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:47,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:51,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 13:37:51,006 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-12 13:37:54,423 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:54,425 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:38:50,566 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:38:55,718 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:39:04,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:10,138 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:39:10,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:10,324 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:39:10,761 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:39:19,901 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:39:19,903 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:39:23,167 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:39:23,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:25,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:39:27,446 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:39:27,682 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:39:27,890 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:39:28,098 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:39:32,378 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:39:33,385 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:39:33,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:33,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:39:52,725 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:40:01,857 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:40:01,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:01,990 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:40:01,991 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:40:02,092 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:40:03,687 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:40:04,018 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:40:07,055 - ispa_next.functions - DEBUG - Updated appointment (AA00050351) customer contact data.
2025-11-12 13:40:08,152 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:40:08,157 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:40:10,226 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:40:10,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:40:11,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:40:15,309 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:40:15,309 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:40:15,312 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:40:15,313 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:40:15,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:15,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:40:20,062 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:40:20,066 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:40:20,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:20,224 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:40:29,503 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 13:40:44,547 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:40:45,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:46,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:40:46,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:40:47,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:40:47,867 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:40:53,216 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:40:53,246 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:40:55,357 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:40:55,361 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:40:55,366 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:40:55,368 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:40:55,372 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:40:55,373 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:40:55,375 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:40:55,378 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:40:55,379 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:40:55,382 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:40:55,385 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:40:55,387 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:40:55,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:01,246 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:41:01,248 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:41:01,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:06,928 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:41:06,928 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:41:06,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:12,675 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:41:12,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:41:14,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:41:15,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:29,858 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:41:29,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:35,488 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:41:59,386 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:42:00,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:42:00,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:42:01,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:50,259 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:42:50,260 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:42:51,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:42:51,979 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:42:51,980 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:43:00,647 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:43:20,868 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:43:21,290 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:43:23,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:43:25,280 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 13:43:25,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:43:32,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 82
2025-11-12 13:43:32,515 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:43:34,734 - ispa_next.main - DEBUG - 



2025-11-12 13:43:34,734 - ispa_next.main - DEBUG - starting with process 7 (MI-EI 121E) of 7
2025-11-12 13:43:34,738 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:43:37,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:43:41,056 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 13:43:41,058 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 82
2025-11-12 13:43:44,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:43:44,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:44:34,718 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:44:39,091 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:44:47,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:51,361 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:44:51,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:51,556 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:44:52,082 - ispa_next.functions - DEBUG - HU date already expired after 265 days.
2025-11-12 13:45:00,927 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:45:00,930 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:45:04,278 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:45:04,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:45:06,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:45:08,164 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:45:08,461 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:45:08,706 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:45:08,937 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:45:13,284 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:45:14,290 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:45:14,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:14,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:31,755 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:45:44,019 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:45:44,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:45:44,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:45:44,159 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:45:44,283 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:45:45,862 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:45:46,191 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:45:49,761 - ispa_next.functions - DEBUG - Updated appointment (AA00050549) customer contact data.
2025-11-12 13:45:50,832 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:45:50,891 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:45:52,940 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:45:52,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:45:54,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:45:58,247 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:45:58,248 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:45:58,251 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:45:58,252 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:45:58,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:45:58,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:46:03,155 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:46:03,159 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:46:03,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:46:03,353 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:46:03,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:04,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:04,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:46:05,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:46:05,661 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:46:09,284 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:46:09,286 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:46:11,344 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:46:11,346 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:46:11,349 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:46:11,350 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:46:11,353 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:46:11,354 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:46:11,356 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:46:11,358 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:46:11,360 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:46:11,386 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:46:11,388 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:46:11,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:15,184 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:46:15,185 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:46:15,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:18,789 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:46:18,789 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:46:18,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:22,362 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:46:22,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:46:23,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:46:23,794 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:46:23,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:27,342 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:46:51,859 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:46:52,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:46:53,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:46:53,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:29,938 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:38,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:47,063 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:55,946 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:47:55,947 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:47:55,948 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:47:57,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:47:57,650 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:47:57,651 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:48:02,066 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:48:20,560 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:48:20,958 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:48:23,154 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:24,852 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 289
2025-11-12 13:48:24,854 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:32,264 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 80
2025-11-12 13:48:32,265 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
