2025-11-17 10:07:33,946 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:07:33,952 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:07:43,263 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:07:53,626 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:08:09,317 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:08:33,184 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:08:46,449 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:08:49,965 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:50,922 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 796
2025-11-17 10:08:50,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 411
2025-11-17 10:08:53,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 401
2025-11-17 10:08:53,267 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:08:53,268 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:08:55,165 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:08:56,283 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:52,112 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,116 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,118 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,172 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,189 - ispa_next.appointments.models - DEBUG - Appointment Bayram Sahin M-S 2289 WBA6X510405S02325 ohne Termin.
2025-11-17 10:09:52,198 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,218 - ispa_next.appointments.models - DEBUG - Appointment Thomas Löb M-L 5621 WBA8H71010A040968 ohne Termin.
2025-11-17 10:09:52,229 - ispa_next.appointments.models - DEBUG - Appointment Antonio Cavar ED-AC 1986 WBA6L31020FJ84465 ohne Termin.
2025-11-17 10:09:52,234 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,247 - ispa_next.appointments.models - DEBUG - Appointment Rebecca Hurst FS-RA 602 WMW31DH0902V63832 ohne Termin.
2025-11-17 10:09:52,252 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,254 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,255 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,255 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,267 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schulz M-S 7319 WBA61EE0605Y49885 ohne Termin.
2025-11-17 10:09:52,282 - ispa_next.appointments.models - DEBUG - Appointment Firma NEO - Professional Solutions GmbH M-N 917 WBS31AZ000CM52265 ohne Termin.
2025-11-17 10:09:52,298 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,311 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,311 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,337 - ispa_next.appointments.models - DEBUG - Appointment Faton Halilaj M-DF 1991 WBA6L51030FJ39031 ohne Termin.
2025-11-17 10:09:52,360 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,377 - ispa_next.appointments.models - DEBUG - Appointment Martin Lamprecht  WBA7K310807P56396 ohne Termin.
2025-11-17 10:09:52,388 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,404 - ispa_next.appointments.models - DEBUG - Appointment Josef Deimel M-LW 90 WBATX35040NC13555 ohne Termin.
2025-11-17 10:09:52,416 - ispa_next.appointments.models - DEBUG - Appointment Firma Panavia Aircraft GmbH FS-PA 85E WBA65GP040N362472 ohne Termin.
2025-11-17 10:09:52,439 - ispa_next.appointments.models - DEBUG - Appointment Meisterbetrieb Thomas Patitz  WBA21GW060CU43030 ohne Termin.
2025-11-17 10:09:52,450 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Hanika M-WH 6500 WBA4K31030BG88527 ohne Termin.
2025-11-17 10:09:52,468 - ispa_next.appointments.models - DEBUG - Appointment Nina Bernreuther M-NN 369 WMWLV310502L56279 ohne Termin.
2025-11-17 10:09:52,470 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,491 - ispa_next.appointments.models - DEBUG - Appointment Ladislav Kilisek M-JO 1742 WBA2A310207A62139 ohne Termin.
2025-11-17 10:09:52,507 - ispa_next.appointments.models - DEBUG - Appointment Ihor Karnakov M-KA 5871E WBA6N31070FM27147 ohne Termin.
2025-11-17 10:09:52,542 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke AG M-NP 3316 WMW21GA0407S97954 ohne Termin.
2025-11-17 10:09:52,557 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Yazar M-YA 29 WBA6V710005P54227 ohne Termin.
2025-11-17 10:09:52,571 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-17 10:09:52,584 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-17 10:09:52,604 - ispa_next.appointments.models - DEBUG - Appointment Joachim Schubert M-JS 2161 WBA51AB0105U16063 ohne Termin.
2025-11-17 10:09:52,620 - ispa_next.appointments.models - DEBUG - Appointment Imer Jakupi M-LJ 1824 WBA11DY090FK02746 ohne Termin.
2025-11-17 10:09:52,632 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Wydra M-W 5397 WBAJC91010B280060 ohne Termin.
2025-11-17 10:09:52,648 - ispa_next.appointments.models - DEBUG - Appointment   WBABS51040EW00681 ohne Termin.
2025-11-17 10:09:52,663 - ispa_next.appointments.models - DEBUG - Appointment Erwin Jaksch M-EJ 69 WBABG11010ER37920 ohne Termin.
2025-11-17 10:09:52,678 - ispa_next.appointments.models - DEBUG - Appointment Eduard Grimm M-EG 3011 WBS1H91060V916418 ohne Termin.
2025-11-17 10:09:52,695 - ispa_next.appointments.models - DEBUG - Appointment Tarik Sahin M-X 3330 WBAJK51000BJ13877 ohne Termin.
2025-11-17 10:09:52,712 - ispa_next.appointments.models - DEBUG - Appointment Firma ACTRON AG ED-AG 444 WBA5R11080FN22370 ohne Termin.
2025-11-17 10:09:52,725 - ispa_next.appointments.models - DEBUG - Appointment Anja Goetzke M-AG 565 WBAJU810409L17973 ohne Termin.
2025-11-17 10:09:52,753 - ispa_next.appointments.models - DEBUG - Appointment Marco Hübl  WBA21EN0009X29619 ohne Termin.
2025-11-17 10:09:52,767 - ispa_next.appointments.models - DEBUG - Appointment Narayanaswamy Anand M-SN 554 WMWLV710302L69958 ohne Termin.
2025-11-17 10:09:52,784 - ispa_next.appointments.models - DEBUG - Appointment Soria-Vanessa Neumann FS-N 347 WBA2H71010VA14727 ohne Termin.
2025-11-17 10:09:52,784 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:52,800 - ispa_next.appointments.models - DEBUG - Appointment Firma ProSiebenSat.1 Media SE M-P 7308 E WBA21EF0405Z47312 ohne Termin.
2025-11-17 10:09:52,858 - ispa_next.main - DEBUG - Found 20 out of 246 appointments to process (configured limit: 20).
2025-11-17 10:09:52,858 - ispa_next.main - DEBUG - Processing 20 fresh appointments.
2025-11-17 10:09:52,858 - ispa_next.main - DEBUG - All appointments: FS-BT 90, STA-AR 62, M-I 7993, M-K 1636, M-S 5764E, M-MR 9200 E, M-C 9104, FS- , M-OT 572, M-XM 6099E , M-RO 985 E, ED-P 2711 E, PF-DN 2121, M-S 2250, M-NC 1407, M-H 8435, FS-MX13, M-ON-120, AS-MY550, FSSP640
2025-11-17 10:09:52,861 - ispa_next.main - DEBUG - 



2025-11-17 10:09:52,861 - ispa_next.main - DEBUG - starting with process 1 (FS-BT 90) of 20
2025-11-17 10:09:52,869 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:53,661 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:54,586 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 796
2025-11-17 10:09:54,587 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 401
2025-11-17 10:09:55,939 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:55,940 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:27,988 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:10:36,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:10:40,644 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:10:40,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:40,715 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:40,997 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:10:41,002 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:10:43,863 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:43,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:44,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:46,838 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:10:46,960 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:47,037 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:47,101 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:10:47,101 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:10:58,480 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:10:59,487 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:10:59,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:00,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:10,712 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:11:17,459 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:11:17,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:17,561 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:17,561 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:11:17,607 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:11:18,842 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:11:20,154 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:11:20,383 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:11:23,038 - ispa_next.functions - DEBUG - Updated appointment (AC00017095) customer contact data.
2025-11-17 10:11:23,930 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:11:23,933 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:11:24,483 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:11:24,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:11:25,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:11:28,688 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:28,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:29,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:31,201 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:11:31,356 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:11:31,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:11:31,596 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:11:31,596 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:11:43,059 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:12:43,060 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:54,907 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:13:28,924 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:40,434 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:13:46,933 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:13:47,943 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:13:47,947 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:13:47,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:48,028 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:52,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:53,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:53,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:53,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:53,971 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:13:57,572 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:13:57,575 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:13:58,733 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:13:58,735 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:58,737 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:13:58,739 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:58,741 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:13:58,741 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:13:58,746 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:13:58,748 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:13:58,764 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:13:58,767 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:13:58,771 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:13:58,775 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:13:58,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:02,700 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:14:02,704 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:14:02,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:06,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:06,655 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:14:15,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:29,351 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:14:29,353 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:14:29,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:14:30,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:14:30,077 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:14:30,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:33,995 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:14:44,977 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:14:45,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:45,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:14:46,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:23,902 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:15:27,540 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:15:32,473 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:15:38,606 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:15:38,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:39,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:15:39,431 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:15:39,436 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:15:42,811 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:15:52,669 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:15:53,049 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:15:53,762 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:54,648 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:15:54,650 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:56,901 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 411
2025-11-17 10:15:56,902 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:57,523 - ispa_next.appointments.models - DEBUG - Appointment Martina Pawlik FS-HP 960 WBA2C31050V239785 ohne Termin.
2025-11-17 10:15:57,525 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:15:57,526 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:15:57,527 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:15:57,532 - ispa_next.main - DEBUG - 



2025-11-17 10:15:57,532 - ispa_next.main - DEBUG - starting with process 2 (STA-AR 62) of 20
2025-11-17 10:15:57,537 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:58,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:59,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:15:59,304 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 411
2025-11-17 10:16:00,508 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:16:00,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:16:36,517 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:16:46,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:48,113 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:16:48,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:48,208 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:48,421 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:16:48,425 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:16:51,202 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:51,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:52,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:54,182 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:54,275 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:57,485 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:57,553 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:57,553 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:08,841 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:17:09,847 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:17:09,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:10,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:20,692 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:17:26,912 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:17:26,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:26,980 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:17:26,981 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:17:27,046 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:17:28,238 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:17:28,429 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:17:31,227 - ispa_next.functions - DEBUG - Updated appointment (AC00017092) customer contact data.
2025-11-17 10:17:32,178 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:17:32,182 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:17:32,789 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:17:32,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:17:33,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:17:37,400 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:17:37,400 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:17:37,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:17:37,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:17:39,917 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:17:40,032 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:17:40,138 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:17:40,201 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:17:40,201 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:51,431 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:17:58,699 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:17:58,699 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:18:02,899 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:18:03,947 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:18:03,954 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:18:03,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:04,025 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:18:09,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:10,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:10,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:10,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:10,978 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:18:12,825 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:18:12,827 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:18:13,732 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:18:13,734 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:13,736 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:18:13,738 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:13,738 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:18:13,740 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:18:13,740 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:18:13,744 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:18:13,744 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:18:13,749 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:18:13,765 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:18:13,767 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:18:13,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:15,639 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:18:15,642 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:18:15,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:17,502 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:18:17,505 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:18:17,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:18:18,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:18:18,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:29,134 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:18:29,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:31,045 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:18:41,850 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:18:42,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:18:42,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:18:43,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:00,590 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:04,529 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:19:04,533 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:19:04,533 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:05,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:05,110 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:19:05,114 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:19:06,634 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:19:13,999 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:19:14,392 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:19:14,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:15,985 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:19:15,985 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:19,069 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 411
2025-11-17 10:19:19,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:19,938 - ispa_next.appointments.models - DEBUG - Appointment Martina Pawlik FS-HP 960 WBA2C31050V239785 ohne Termin.
2025-11-17 10:19:19,940 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:19:19,942 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:19:19,948 - ispa_next.main - DEBUG - 



2025-11-17 10:19:19,949 - ispa_next.main - DEBUG - starting with process 3 (M-I 7993) of 20
2025-11-17 10:19:19,964 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:21,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:22,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:19:22,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 411
2025-11-17 10:19:23,918 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:23,919 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:50,964 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:20:01,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:03,323 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:20:03,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:03,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:03,603 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:20:03,608 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:20:06,491 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:06,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:07,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:09,437 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:20:09,543 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:20:09,651 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:20:09,708 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:20:11,837 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:20:12,845 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:20:12,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:13,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:26,414 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:20:34,465 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:20:34,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:34,579 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:34,581 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:20:34,613 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:20:35,896 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:20:37,036 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:20:37,257 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:20:40,168 - ispa_next.functions - DEBUG - Updated appointment (AC00017089) customer contact data.
2025-11-17 10:20:41,114 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:20:41,118 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:20:41,911 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:20:41,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:20:42,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:20:46,341 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:46,341 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:20:46,350 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:20:46,354 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:20:46,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:46,853 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:47,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:47,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:47,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:48,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:48,734 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:20:50,568 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:20:50,570 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:20:51,399 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:20:51,400 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:51,402 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:20:51,402 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:51,406 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:20:51,408 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:20:51,412 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:20:51,414 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:20:51,416 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:20:51,416 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:20:51,423 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:20:51,428 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:20:51,428 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:53,380 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:20:55,842 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:20:55,846 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:20:55,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:57,855 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:20:57,859 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:20:57,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:20:58,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:20:58,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:10,899 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:21:10,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:12,773 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:21:22,851 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:21:23,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:23,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:21:24,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:42,844 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:48,000 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:21:48,002 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:48,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:48,774 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:21:48,779 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:21:52,639 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:21:59,282 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:21:59,673 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:22:00,237 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:01,420 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:22:01,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:04,435 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 409
2025-11-17 10:22:04,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:05,237 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:22:05,240 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:22:05,246 - ispa_next.main - DEBUG - Found new Appointment: FS-HP 960
2025-11-17 10:22:05,249 - ispa_next.main - DEBUG - 



2025-11-17 10:22:05,249 - ispa_next.main - DEBUG - starting with process 4 (FS-HP 960) of 21
2025-11-17 10:22:05,256 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:06,453 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:07,709 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:22:07,710 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 409
2025-11-17 10:22:09,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:09,187 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:35,435 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:22:46,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:46,088 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:46,290 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:49,572 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:22:49,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:49,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:49,821 - ispa_next.functions - DEBUG - HU date already expired after 732 days.
2025-11-17 10:22:55,928 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:22:55,932 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:22:58,621 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:58,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:59,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:01,964 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:23:02,105 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:23:02,224 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:23:02,392 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:23:02,392 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:23:13,211 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:23:20,549 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:23:20,549 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:23:24,773 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:23:25,781 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:23:25,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:26,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:38,706 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:23:45,490 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:23:45,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:45,572 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:45,573 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:23:45,608 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:23:45,755 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:23:46,890 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:23:48,089 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:23:48,421 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:23:51,689 - ispa_next.functions - DEBUG - Updated appointment (AA00023752) customer contact data.
2025-11-17 10:23:52,586 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:23:52,591 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:23:52,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:23:53,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:23:55,238 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:23:55,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:23:55,306 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:23:58,901 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:58,901 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:23:58,907 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:23:58,913 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:23:58,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:59,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:59,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:00,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:00,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:00,990 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:00,991 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:24:03,992 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:24:03,993 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:24:05,512 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:24:05,515 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:24:05,516 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:24:05,518 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:24:05,521 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:24:05,537 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:24:05,540 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:24:05,541 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:24:05,543 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:24:05,543 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:24:05,549 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:24:05,553 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:24:05,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:08,987 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:24:08,991 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:24:08,996 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:12,293 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:24:12,297 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:24:12,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:24:13,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:24:13,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:22,492 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:24:22,497 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:25,788 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:24:37,365 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:24:37,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:24:38,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:24:38,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:10,107 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:14,263 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:18,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:23,811 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:23,815 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:25:23,816 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:24,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:24,488 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:25:24,492 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:25:26,679 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:25:33,677 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:25:34,046 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:25:34,644 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:35,741 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:25:35,743 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:38,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 406
2025-11-17 10:25:38,187 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:38,896 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:25:38,897 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:25:38,898 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:25:38,909 - ispa_next.main - DEBUG - 



2025-11-17 10:25:38,909 - ispa_next.main - DEBUG - starting with process 5 (M-K 1636) of 21
2025-11-17 10:25:38,917 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:39,769 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:40,695 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:25:40,695 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 406
2025-11-17 10:25:41,996 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:41,997 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:53,435 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:25:53,516 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:25:53,523 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:53,992 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:25:53,994 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:56,126 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 406
2025-11-17 10:25:56,127 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:56,885 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:25:56,886 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:25:56,887 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:25:56,891 - ispa_next.main - DEBUG - 



2025-11-17 10:25:56,891 - ispa_next.main - DEBUG - starting with process 6 (M-S 5764E) of 21
2025-11-17 10:25:56,896 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:57,779 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:58,647 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:25:58,648 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 406
2025-11-17 10:25:59,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:59,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:27,491 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:26:37,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:40,449 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:26:40,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:40,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:26:40,720 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:26:40,733 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:26:43,583 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:26:43,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:44,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:46,629 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:26:46,731 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:26:49,981 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:26:50,060 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:26:50,060 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:27:01,964 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:27:02,971 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:27:02,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:03,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:15,643 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:27:23,318 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:27:23,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:23,413 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:23,415 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:27:23,459 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:27:24,672 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:27:24,970 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:27:28,400 - ispa_next.functions - DEBUG - Updated appointment (AC00017063) customer contact data.
2025-11-17 10:27:29,331 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:27:29,335 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:27:30,201 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:27:30,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:27:30,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:27:34,557 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:27:34,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:35,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:37,075 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:27:37,192 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:27:37,269 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:27:37,369 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:27:37,369 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:27:49,057 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:28:49,059 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:29:00,396 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:29:28,397 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:29:40,232 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:29:47,551 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:29:48,558 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:29:48,563 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:29:48,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:29:48,625 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:29:52,817 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 10:30:05,613 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:30:05,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:06,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:06,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:07,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:30:07,499 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:30:10,065 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:30:10,067 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:30:11,165 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:30:11,166 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:30:11,168 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:30:11,169 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:30:11,171 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:30:11,172 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:30:11,173 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:30:11,175 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:30:11,176 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:30:11,177 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:30:11,179 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:30:53,556 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:30:53,588 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:30:59,409 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:30:59,413 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:30:59,413 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:03,461 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:31:03,464 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:31:03,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:07,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:07,581 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:31:16,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:30,200 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:31:30,204 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:31:30,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:31:30,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:31:31,038 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:31:31,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:35,054 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:31:46,364 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:31:46,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:31:47,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:31:47,470 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:25,983 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:30,266 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:34,446 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:39,975 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:32:39,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:40,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:32:40,586 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:32:40,589 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:32:43,567 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:32:51,804 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:32:52,213 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:32:53,467 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:54,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:32:54,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:56,795 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 405
2025-11-17 10:32:56,795 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:57,557 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:32:57,559 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:32:57,559 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:32:57,566 - ispa_next.main - DEBUG - 



2025-11-17 10:32:57,566 - ispa_next.main - DEBUG - starting with process 7 (M-MR 9200 E) of 21
2025-11-17 10:32:57,579 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:58,560 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:59,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:32:59,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 405
2025-11-17 10:33:01,364 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:33:01,365 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:33:29,789 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:33:40,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:43,432 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:33:43,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:43,545 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:43,772 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:33:43,776 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:33:46,536 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:33:46,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:47,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:49,971 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:33:50,074 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:33:53,312 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:33:53,388 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:33:53,388 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:05,213 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:34:06,220 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:34:06,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:07,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:10,334 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:34:10,340 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:34:10,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:10,410 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:34:10,411 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:34:10,465 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:34:11,637 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:34:11,897 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:34:15,033 - ispa_next.functions - DEBUG - Updated appointment (AD00013315) customer contact data.
2025-11-17 10:34:15,955 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:34:15,959 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:34:17,235 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:34:17,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:34:18,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:34:21,743 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:34:21,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:22,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:24,260 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:34:24,377 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:34:24,461 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:34:24,586 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:34:24,587 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:36,604 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:35:36,607 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:35:48,664 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:36:30,667 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:42,814 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:36:50,893 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:36:51,944 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:36:51,951 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:36:51,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:52,055 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:01,578 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:37:06,648 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:37:06,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:07,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:07,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:07,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:07,905 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:37:10,414 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:37:10,415 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:37:11,474 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:37:11,474 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:11,476 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:37:11,478 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:11,479 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:37:11,480 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:37:11,481 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:37:11,483 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:37:11,484 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:37:11,486 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:37:11,488 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:37:32,021 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:37:32,022 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:37:38,232 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:37:38,237 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:37:38,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:41,591 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:37:41,595 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:37:41,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:44,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:44,999 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:53,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:07,361 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:38:07,365 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:38:07,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:38:08,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:38:08,164 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:38:08,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:11,463 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:38:22,002 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:38:22,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:22,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:38:23,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:55,063 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:59,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:05,983 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:05,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:06,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:06,738 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:06,742 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:10,224 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:39:19,309 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:39:19,695 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:39:21,292 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:22,090 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:39:22,092 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:25,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 404
2025-11-17 10:39:25,260 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:26,083 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:39:26,085 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:39:26,086 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:39:26,094 - ispa_next.main - DEBUG - 



2025-11-17 10:39:26,094 - ispa_next.main - DEBUG - starting with process 8 (M-C 9104) of 21
2025-11-17 10:39:26,101 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:27,357 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:28,714 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:39:28,715 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 404
2025-11-17 10:39:30,203 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:30,205 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:00,270 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:40:10,049 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:11,235 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:40:11,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:11,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:11,544 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:40:11,549 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:40:14,379 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:14,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:15,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:17,889 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:18,018 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:21,208 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:21,280 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:40:21,280 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:40:32,903 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:40:33,911 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:40:33,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:34,447 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:37,499 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:40:37,511 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:40:37,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:37,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:37,600 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:40:37,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:40:38,885 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:40:40,165 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:40:41,166 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:40:41,647 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:40:45,251 - ispa_next.functions - DEBUG - Updated appointment (AA00023633) customer contact data.
2025-11-17 10:40:46,168 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:40:46,173 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:40:47,601 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:40:47,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:40:48,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:40:52,952 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:52,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:53,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:55,437 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:55,562 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:55,645 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:55,733 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:40:55,735 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:41:07,221 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:42:07,236 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:42:18,361 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:42:25,545 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:42:25,545 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:42:29,708 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:42:30,743 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:42:30,749 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:42:30,749 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:42:30,751 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:42:32,644 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:42:32,646 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:42:33,596 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:42:33,597 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:33,598 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:42:33,600 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:33,602 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:42:33,602 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:42:33,604 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:42:33,606 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:42:33,606 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:42:33,608 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:42:33,613 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:42:33,619 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:42:33,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:35,564 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:42:35,568 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:42:35,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:37,468 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:42:37,470 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:42:37,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:42:38,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:42:38,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:42,469 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:42:42,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:44,367 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:42:56,297 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:42:56,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:57,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:42:57,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:16,259 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:43:20,626 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:43:20,630 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:43:20,630 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:21,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:43:21,374 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:43:21,378 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:43:23,492 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:43:31,274 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:43:31,662 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:43:32,485 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:33,747 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:43:33,749 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:36,891 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 404
2025-11-17 10:43:36,892 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:37,593 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:43:37,594 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:43:37,594 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:43:37,599 - ispa_next.main - DEBUG - 



2025-11-17 10:43:37,599 - ispa_next.main - DEBUG - starting with process 9 (FS- ) of 21
2025-11-17 10:43:37,605 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:38,462 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:39,439 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:43:39,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 404
2025-11-17 10:43:40,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 10:43:40,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:40,973 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 142, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 10:43:40,974 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:43:40,978 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:41,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:43:41,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 10:43:43,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 404
2025-11-17 10:43:43,801 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:44,533 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:43:44,534 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:43:44,535 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:43:44,539 - ispa_next.main - DEBUG - 



2025-11-17 10:43:44,539 - ispa_next.main - DEBUG - starting with process 10 (M-OT 572) of 21
2025-11-17 10:43:44,552 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:43:45,529 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:43:46,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:43:46,591 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 404
2025-11-17 10:43:48,226 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:43:48,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:19,820 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:44:31,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:34,571 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:44:34,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:34,639 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:34,916 - ispa_next.functions - DEBUG - HU date soon to be invalid in 41 days.
2025-11-17 10:44:42,117 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:44:42,123 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:44:45,008 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:45,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:46,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:48,294 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:48,411 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:48,536 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:48,605 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:44:52,856 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:44:53,864 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:44:53,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:54,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:07,061 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:45:15,070 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:45:15,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:15,149 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:15,150 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:45:15,198 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:45:16,475 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:45:16,751 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:45:20,790 - ispa_next.functions - DEBUG - Updated appointment (AD00013297) customer contact data.
2025-11-17 10:45:21,826 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:45:21,832 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:45:22,542 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:45:22,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:45:23,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:45:27,578 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:45:27,578 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:27,578 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:45:27,581 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:45:27,588 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:45:27,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:28,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:28,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:28,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:28,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:29,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:29,772 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:45:33,073 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:45:33,075 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:45:34,165 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:45:34,167 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:45:34,167 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:45:34,169 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:45:34,171 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:45:34,172 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:45:34,174 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:45:34,177 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:45:34,179 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:45:34,182 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:45:34,190 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:45:34,193 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:45:34,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:37,630 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:45:40,135 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:45:40,221 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:45:40,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:43,644 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:45:43,648 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:45:43,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:45:44,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:45:44,787 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:55,361 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:45:55,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:58,734 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:46:11,243 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:46:11,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:46:12,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:46:12,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:44,331 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:46:48,656 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:46:53,703 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:46:58,662 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:46:58,666 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:46:58,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:46:59,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:46:59,414 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:46:59,417 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:47:01,548 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:47:09,562 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:47:09,941 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:47:11,590 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:47:12,497 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:47:12,503 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:47:15,672 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:47:15,673 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:47:17,177 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:47:17,179 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:47:17,180 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:47:17,186 - ispa_next.main - DEBUG - 



2025-11-17 10:47:17,186 - ispa_next.main - DEBUG - starting with process 11 (M-XM 6099E ) of 21
2025-11-17 10:47:17,192 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:47:18,180 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:47:19,258 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:47:19,259 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:47:20,784 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:47:20,785 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:47:32,946 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:47:32,958 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:47:32,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:47:33,318 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:47:33,319 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:47:35,654 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:47:35,655 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:47:36,734 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:47:36,736 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:47:36,736 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:47:36,742 - ispa_next.main - DEBUG - 



2025-11-17 10:47:36,742 - ispa_next.main - DEBUG - starting with process 12 (M-RO 985 E) of 21
2025-11-17 10:47:36,761 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:47:38,041 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:47:39,210 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 797
2025-11-17 10:47:39,211 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:47:40,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:47:40,903 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:48:10,209 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:48:20,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:21,835 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:48:21,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:21,946 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:48:22,118 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:48:22,124 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:48:25,051 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:48:25,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:48:26,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:48:28,479 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:48:28,605 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:48:31,806 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:48:31,873 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:48:31,873 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:48:44,453 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:48:45,460 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:48:45,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:46,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:58,805 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:49:05,958 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:49:05,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:06,028 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:06,028 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:49:06,089 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:49:07,440 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:49:07,670 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:49:10,902 - ispa_next.functions - DEBUG - Updated appointment (AF00012147) customer contact data.
2025-11-17 10:49:11,818 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:49:11,822 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:49:13,151 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:49:13,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:49:14,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:49:17,669 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:49:17,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:18,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:49:20,178 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:49:20,293 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:49:20,376 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:49:20,463 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:49:20,463 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:49:31,475 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:49:38,530 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:49:38,530 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:49:42,697 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:49:43,739 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:49:43,747 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:49:43,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:43,825 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:49:53,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:53,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:53,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:49:54,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:49:54,584 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:49:55,890 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:49:55,896 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:49:57,064 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:49:57,066 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:49:57,068 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:49:57,068 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:49:57,072 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:49:57,072 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:49:57,074 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:49:57,084 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:49:57,088 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:49:57,096 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:49:57,104 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:49:57,109 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:49:57,110 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:58,283 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:49:58,287 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:49:58,289 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:59,466 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:49:59,470 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:49:59,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:50:00,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:50:00,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:17,316 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:50:17,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:18,590 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:50:30,691 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:50:31,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:50:31,837 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:50:32,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:44,384 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:50:44,390 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:50:44,391 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:50:45,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:50:45,178 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:50:45,182 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:50:47,124 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:50:56,142 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:50:56,533 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:50:57,694 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:50:58,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:50:58,551 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:51:01,687 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:51:01,688 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:51:02,576 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:51:02,578 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:51:02,578 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:51:02,583 - ispa_next.main - DEBUG - 



2025-11-17 10:51:02,583 - ispa_next.main - DEBUG - starting with process 13 (ED-P 2711 E) of 21
2025-11-17 10:51:02,589 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:51:03,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:51:05,246 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:51:05,248 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:51:06,877 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:51:06,879 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:51:39,099 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:51:50,576 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:56,143 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:51:56,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:56,228 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:51:56,436 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:52:03,746 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:52:03,750 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:52:06,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:52:06,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:52:07,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:52:09,792 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:52:09,891 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:52:13,151 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:52:13,223 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:52:13,223 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:52:25,270 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:52:26,277 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:52:26,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:52:26,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:52:29,962 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:52:29,970 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:52:29,971 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:52:30,038 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:52:30,040 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:52:30,134 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:52:31,378 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:52:31,620 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:52:35,008 - ispa_next.functions - DEBUG - Updated appointment (AF00012144) customer contact data.
2025-11-17 10:52:35,914 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:52:35,923 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:52:37,488 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:52:37,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:52:38,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:52:42,410 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:52:42,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:52:42,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:52:44,965 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:52:45,055 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:52:45,168 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:52:45,246 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:52:45,246 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:52:56,310 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:53:03,433 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:53:03,433 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:53:05,569 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:53:06,577 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:53:06,581 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:53:06,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:06,644 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:20,494 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:53:26,564 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:53:26,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:27,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:27,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:28,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:28,086 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:53:33,092 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:53:33,094 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:53:34,208 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:53:34,210 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:34,212 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:53:34,214 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:34,214 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:53:34,216 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:53:34,218 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:53:34,218 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:53:34,220 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:53:34,221 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:53:34,223 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:53:56,545 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:53:56,545 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:54:02,448 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:54:02,452 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:54:02,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:08,705 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:54:08,712 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:54:08,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:14,953 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:54:14,957 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:54:14,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:54:16,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:54:16,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:30,167 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:54:30,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:36,367 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:54:48,747 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:54:49,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:49,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:54:50,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:55:49,476 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:55:53,925 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:55:59,090 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:56:05,715 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:56:05,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:56:06,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:56:06,477 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:56:06,480 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:56:10,212 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:56:19,932 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:56:20,312 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:56:21,643 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:56:22,657 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:56:22,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:56:25,872 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:56:25,873 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:56:26,713 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:56:26,715 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:56:26,715 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:56:26,721 - ispa_next.main - DEBUG - 



2025-11-17 10:56:26,721 - ispa_next.main - DEBUG - starting with process 14 (PF-DN 2121) of 21
2025-11-17 10:56:26,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:56:28,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:56:29,272 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:56:29,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:56:30,791 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:56:30,792 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:56:45,607 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:56:45,663 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 10:56:45,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:56:46,210 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:56:46,212 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:56:49,149 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:56:49,150 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:56:50,430 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:56:50,431 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:56:50,432 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:56:50,452 - ispa_next.main - DEBUG - 



2025-11-17 10:56:50,452 - ispa_next.main - DEBUG - starting with process 15 (M-S 2250) of 21
2025-11-17 10:56:50,471 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:56:51,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:56:53,023 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:56:53,024 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:56:54,652 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 10:56:54,654 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:56:55,033 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 142, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 10:56:55,033 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 10:56:55,039 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:56:55,683 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:56:55,697 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 10:56:59,870 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:56:59,871 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:57:00,705 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:00,706 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:00,707 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:00,722 - ispa_next.main - DEBUG - 



2025-11-17 10:57:00,722 - ispa_next.main - DEBUG - starting with process 16 (M-NC 1407) of 21
2025-11-17 10:57:00,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:02,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:03,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:57:03,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:57:04,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:57:04,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:57:19,007 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:57:19,110 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 10:57:19,116 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:19,554 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:57:19,555 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:57:22,080 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:57:22,080 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:57:22,787 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:22,788 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:22,789 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:22,794 - ispa_next.main - DEBUG - 



2025-11-17 10:57:22,794 - ispa_next.main - DEBUG - starting with process 17 (M-H 8435) of 21
2025-11-17 10:57:22,813 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:24,345 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:25,347 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:57:25,348 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:57:26,908 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 10:57:26,909 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:57:27,160 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 142, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 10:57:27,160 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 10:57:27,164 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:27,682 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:57:27,684 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 10:57:30,901 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 10:57:30,902 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:57:31,747 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:31,747 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:31,748 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:57:31,753 - ispa_next.main - DEBUG - 



2025-11-17 10:57:31,753 - ispa_next.main - DEBUG - starting with process 18 (FS-MX13) of 21
2025-11-17 10:57:31,759 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:57:33,069 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:57:34,292 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 10:57:34,293 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 10:57:35,949 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:57:35,950 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:58:09,900 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:58:20,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:26,153 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:58:26,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:26,243 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:58:26,556 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:58:33,241 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:58:33,245 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:58:36,793 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:58:36,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:38,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:58:40,410 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:58:40,529 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:58:43,729 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:58:43,812 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:58:43,812 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:58:55,589 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:58:56,597 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:58:56,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:57,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:09,747 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:59:18,116 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:59:18,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:59:18,181 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:59:18,182 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:59:18,223 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:59:20,125 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:59:20,376 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:59:23,881 - ispa_next.functions - DEBUG - Updated appointment (AC00016833) customer contact data.
2025-11-17 10:59:24,920 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:59:24,924 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:59:25,788 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:59:25,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:59:26,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:59:30,446 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:59:30,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:59:30,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:59:32,966 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:59:33,121 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:59:33,784 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:59:33,883 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:59:33,883 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:59:45,743 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:00:45,747 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:00:57,612 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:01:04,910 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:01:04,912 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:01:09,133 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:01:10,141 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:01:10,146 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:01:10,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:01:10,226 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:01:10,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:11,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:11,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:01:11,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:01:11,935 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:01:16,813 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:01:16,815 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:01:18,150 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:01:18,152 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:01:18,154 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:01:18,154 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:01:18,156 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:01:18,156 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:01:18,158 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:01:18,160 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:01:18,160 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:01:18,162 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:01:18,166 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:01:18,172 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:01:18,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:23,765 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:01:23,768 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:01:23,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:29,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:01:29,336 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:01:38,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:54,168 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:01:54,172 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:01:54,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:01:55,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:01:55,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:08,962 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:02:08,964 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:14,550 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:02:25,790 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:02:26,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:02:27,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:02:27,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:21,261 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:26,220 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:03:31,966 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:03:31,968 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:03:32,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:03:32,606 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:03:32,610 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:03:35,938 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:03:45,022 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:03:45,401 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 11:03:47,360 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:48,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 11:03:48,139 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:03:51,022 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 11:03:51,023 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:03:51,650 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:03:51,651 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:03:51,652 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:03:51,657 - ispa_next.main - DEBUG - 



2025-11-17 11:03:51,657 - ispa_next.main - DEBUG - starting with process 19 (M-ON-120) of 21
2025-11-17 11:03:51,664 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:03:52,579 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:03:53,552 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 11:03:53,554 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 11:03:55,107 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:03:55,109 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:04:28,719 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:04:38,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:40,137 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:04:40,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:40,223 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:04:40,565 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:04:40,571 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:04:43,627 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:04:43,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:46,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:48,188 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:04:48,295 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:04:51,641 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:04:51,747 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:04:51,749 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:05:03,882 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:05:04,901 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:05:04,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:05,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:20,345 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:05:28,170 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:05:28,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:05:28,269 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:05:28,269 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:05:28,332 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:05:29,653 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:05:29,953 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:05:34,551 - ispa_next.functions - DEBUG - Updated appointment (AC00016800) customer contact data.
2025-11-17 11:05:35,474 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:05:35,480 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:05:36,645 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:05:36,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:05:37,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:05:41,538 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:05:41,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:05:42,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:05:44,048 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:05:44,169 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:05:44,280 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:05:44,377 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:05:44,377 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:05:55,550 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:06:02,725 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:06:02,725 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:06:06,908 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:06:07,933 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:06:07,939 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:06:07,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:08,051 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:06:08,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:08,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:08,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:09,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:09,784 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:06:11,099 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:06:11,110 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:06:12,596 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:06:12,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:06:12,601 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:06:12,605 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:06:12,608 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:06:12,610 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:06:12,611 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:06:12,614 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:06:12,615 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:06:12,616 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:06:12,621 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:06:12,625 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:06:12,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:13,831 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:06:13,835 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:06:13,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:15,086 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:06:15,091 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:06:15,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:06:16,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:06:16,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:25,305 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:06:25,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:26,612 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:06:37,251 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:06:37,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:06:38,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:06:38,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:50,927 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:06:50,931 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:06:50,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:06:51,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:06:51,741 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:06:51,744 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:06:53,719 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:07:02,527 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:07:02,901 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 11:07:04,393 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:05,498 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 11:07:05,500 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:07:08,974 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 11:07:08,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:09,924 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:09,925 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:09,925 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:07:09,931 - ispa_next.main - DEBUG - 



2025-11-17 11:07:09,931 - ispa_next.main - DEBUG - starting with process 20 (AS-MY550) of 21
2025-11-17 11:07:09,936 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:07:11,196 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:07:12,547 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 798
2025-11-17 11:07:12,547 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 11:07:14,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:07:14,252 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:48,793 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:07:59,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:00,687 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:08:00,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:00,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:00,980 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 11:08:08,658 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:08:08,662 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:08:11,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:08:11,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:13,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:08:15,135 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:08:15,254 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:08:15,349 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:08:15,465 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:08:15,465 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:08:28,379 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:08:29,386 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:08:29,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:29,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:45,982 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:08:54,830 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:08:54,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:54,958 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:54,958 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:08:54,996 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:08:56,252 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:08:56,504 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:09:00,374 - ispa_next.functions - DEBUG - Updated appointment (AC00016799) customer contact data.
2025-11-17 11:09:01,287 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:09:01,295 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:09:03,187 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:09:03,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:09:04,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:09:07,943 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:09:07,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:08,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:09:10,460 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:09:10,630 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:09:10,740 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:09:10,827 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:09:10,827 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:09:22,838 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:10:22,840 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:10:34,913 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:10:48,916 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:11:01,363 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:11:10,815 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:11:11,823 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:11:11,827 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:11:11,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:11:11,933 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:11:12,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:12,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:11:12,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:11:13,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:11:13,712 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:11:15,098 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:11:15,102 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:11:16,488 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:11:16,494 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:11:16,498 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:11:16,501 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:11:16,508 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:11:16,517 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:11:16,522 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:11:16,525 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:11:16,528 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:11:16,529 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:11:16,534 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:11:16,536 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:11:16,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:17,749 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:11:17,753 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:11:17,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:19,009 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:11:19,013 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:11:19,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:11:20,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:11:20,196 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:11:20,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:21,446 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:11:33,219 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:11:33,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:34,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:11:34,444 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:47,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:47,163 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:11:47,164 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:11:47,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:47,873 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:11:47,877 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:11:49,502 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:11:56,697 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:11:57,088 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 11:11:57,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:11:59,437 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 801
2025-11-17 11:11:59,439 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:02,660 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 403
2025-11-17 11:12:02,660 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:03,646 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:12:03,647 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:12:03,656 - ispa_next.main - DEBUG - Found new Appointment: M-Y 9065
2025-11-17 11:12:03,658 - ispa_next.main - DEBUG - 



2025-11-17 11:12:03,658 - ispa_next.main - DEBUG - starting with process 21 (M-Y 9065) of 22
2025-11-17 11:12:03,664 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:12:05,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:06,394 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 801
2025-11-17 11:12:06,395 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 403
2025-11-17 11:12:08,230 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:08,232 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:50,127 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:13:01,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:01,198 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:01,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:02,629 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:13:02,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:02,772 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:02,977 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:13:02,980 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:13:05,773 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:13:05,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:13:07,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:13:09,282 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:13:09,420 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:13:12,624 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:13:12,744 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:13:12,744 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:13:24,801 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:13:25,807 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:13:25,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:26,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:38,786 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:13:46,957 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:13:46,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:47,047 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:47,056 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:13:47,122 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:13:47,271 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:13:48,461 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:13:48,755 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:13:53,697 - ispa_next.functions - DEBUG - Updated appointment (AA00023755) customer contact data.
2025-11-17 11:13:54,777 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:13:54,781 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:13:54,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:13:56,067 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:13:57,989 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:13:58,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:13:59,335 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:14:02,940 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:14:02,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:03,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:14:05,457 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:14:05,614 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:14:05,749 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:14:05,823 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:14:05,824 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:14:17,482 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:15:17,485 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:15:30,401 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:15:50,404 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:16:02,052 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:16:09,979 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:16:10,988 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:16:11,022 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:16:11,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:11,129 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:16:15,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:15,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:15,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:16,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:16:16,522 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:16:17,871 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:16:17,872 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:16:19,557 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:16:19,559 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:16:19,561 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:16:19,561 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:16:19,563 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:16:19,567 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:16:19,569 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:16:19,574 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:16:19,576 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:16:19,578 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:16:19,582 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:16:19,586 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:16:19,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:20,787 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:16:20,790 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:16:20,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:22,033 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:16:22,037 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:16:22,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:16:23,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:16:23,216 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:16:23,229 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:24,484 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:16:36,451 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:16:36,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:16:37,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:16:37,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:50,703 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:16:50,706 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:16:50,708 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:16:51,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:16:51,546 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:16:51,550 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:16:53,684 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:17:02,246 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:17:02,613 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-17 11:17:03,179 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:17:04,740 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 802
2025-11-17 11:17:04,741 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:17:07,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 404
2025-11-17 11:17:07,880 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:08,794 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:17:08,795 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:17:08,802 - ispa_next.main - DEBUG - 



2025-11-17 11:17:08,802 - ispa_next.main - DEBUG - starting with process 22 (FSSP640) of 22
2025-11-17 11:17:08,809 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:17:09,816 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:17:10,810 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 802
2025-11-17 11:17:10,811 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 404
2025-11-17 11:17:12,423 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:17:12,424 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:55,315 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:18:06,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:18:07,814 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:18:07,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:07,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:08,184 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:18:08,188 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:18:11,234 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:18:11,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:13,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:15,186 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:18:15,292 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:18:18,524 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:18:18,614 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:18:18,614 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:18:30,893 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:18:31,900 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:18:31,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:33,231 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:36,987 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:18:36,995 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:18:36,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:18:37,060 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:18:37,061 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:18:37,125 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:18:38,302 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:18:38,552 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:18:42,197 - ispa_next.functions - DEBUG - Updated appointment (AC00016784) customer contact data.
2025-11-17 11:18:43,261 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:18:43,263 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:18:43,874 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:18:43,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:18:44,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:18:48,562 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:18:48,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:18:49,067 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:18:51,071 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:18:51,217 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:18:51,359 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:18:51,450 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:18:51,450 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:03,319 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:20:03,322 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:20:14,659 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:20:22,034 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:20:22,034 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:20:26,263 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:20:27,273 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:20:27,277 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:20:27,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:27,418 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:20:32,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:32,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:32,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:33,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:20:33,700 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:20:34,991 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:20:34,992 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:20:36,492 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:20:36,494 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:20:36,496 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:20:36,497 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:20:36,511 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:20:36,514 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:20:36,514 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:20:36,516 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:20:36,516 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:20:36,518 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:20:36,522 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:20:36,527 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:20:36,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:37,740 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:20:37,744 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:20:37,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:39,046 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:20:39,050 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:20:39,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:20:40,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:20:40,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:49,487 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:20:49,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:50,808 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:21:01,860 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:21:02,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:03,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:21:03,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:21:15,541 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:21:15,545 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:21:15,547 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:16,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:16,147 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:21:16,151 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:21:17,784 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:21:25,860 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:21:26,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-17 11:21:27,699 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:28,645 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 802
2025-11-17 11:21:28,647 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:31,818 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 404
2025-11-17 11:21:31,818 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:21:32,530 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 11:21:32,531 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
