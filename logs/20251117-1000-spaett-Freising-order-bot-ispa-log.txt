2025-11-17 10:00:36,594 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:36,616 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:48,147 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:01:00,560 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:15,958 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:01:39,685 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:01:53,195 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:01:56,568 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:01:57,770 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:01:57,771 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 367
2025-11-17 10:02:00,234 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 313
2025-11-17 10:02:00,235 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:02:00,236 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:01,402 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:02,856 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:02:49,109 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:49,145 - ispa_next.appointments.models - DEBUG - Appointment Michael Helmlinger  WBY11CF020CR13544 ohne Termin.
2025-11-17 10:02:49,161 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-17 10:02:49,170 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-17 10:02:49,174 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:49,186 - ispa_next.appointments.models - DEBUG - Appointment Firma REWE Markt GmbH FS-RE 166 WBA11DX000CD76582 ohne Termin.
2025-11-17 10:02:49,214 - ispa_next.appointments.models - DEBUG - Appointment Christina Müller EI-CA 8501 WBA1V710207A22215 ohne Termin.
2025-11-17 10:02:49,231 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:49,231 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:49,244 - ispa_next.appointments.models - DEBUG - Appointment Julian Marvin Lamberti FS-JL 96 WBAJC510X0G860905 ohne Termin.
2025-11-17 10:02:49,255 - ispa_next.appointments.models - DEBUG - Appointment Luca Weicker M-LW 208 WBA5R11080FH35709 ohne Termin.
2025-11-17 10:02:49,266 - ispa_next.appointments.models - DEBUG - Appointment Michael Rudorfer FS-EV 777 WBA2D710405G19272 ohne Termin.
2025-11-17 10:02:49,281 - ispa_next.appointments.models - DEBUG - Appointment Andreas Lechner FS-LL 300 WBA5R11060AK29564 ohne Termin.
2025-11-17 10:02:49,296 - ispa_next.appointments.models - DEBUG - Appointment Florian Eichinger FS-LS 932 WBAJT91090BR75371 ohne Termin.
2025-11-17 10:02:49,308 - ispa_next.appointments.models - DEBUG - Appointment Michael Rudorfer FS-EV 777 WBA2D710405G19272 ohne Termin.
2025-11-17 10:02:49,347 - ispa_next.appointments.models - DEBUG - Appointment Firma TSA Solution GmbH FS-SK 410 WBA11CM0508D75834 ohne Termin.
2025-11-17 10:02:49,365 - ispa_next.appointments.models - DEBUG - Appointment Firma Dr. Schwab Ges. f. Technologie M-S 7134 WBAGV41060CL15774 ohne Termin.
2025-11-17 10:02:49,391 - ispa_next.appointments.models - DEBUG - Appointment Labinot Deda FS-LD 789 WBA3K51030K307246 ohne Termin.
2025-11-17 10:02:49,424 - ispa_next.appointments.models - DEBUG - Appointment Kevin Perleberg FS-CK 149 WBAUS91000A187519 ohne Termin.
2025-11-17 10:02:49,428 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:02:49,440 - ispa_next.appointments.models - DEBUG - Appointment Murat Böcekci FS-MU 79 WBANU31010BX99380 ohne Termin.
2025-11-17 10:02:49,451 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Durak FS-DD 62 WBA4F11020G316587 ohne Termin.
2025-11-17 10:02:49,468 - ispa_next.appointments.models - DEBUG - Appointment Schuberthan Schuberthan DGF-Y 8570 WBA35GP000N338205 ohne Termin.
2025-11-17 10:02:49,480 - ispa_next.appointments.models - DEBUG - Appointment Christine Huber FS-CH 282 WBA8J11090A714964 ohne Termin.
2025-11-17 10:02:49,526 - ispa_next.main - DEBUG - Found 20 out of 163 appointments to process (configured limit: 20).
2025-11-17 10:02:49,527 - ispa_next.main - DEBUG - Processing 20 fresh appointments.
2025-11-17 10:02:49,527 - ispa_next.main - DEBUG - All appointments: FS-KD 59 E, FS-MT 886, FS-JM 484, FS-LA 175, FS AM 4, FS-SX 21, FS-NK 258, R-N 9943E, FS-P 2159, T-P 129, FS-CG 799, FS-SF234, FS-Y 330, FS-BD 344, FS B 93, FS-LJ688, ED-MH 198, FS-LE 78, FS AN 102, PAF-EV 511
2025-11-17 10:02:49,529 - ispa_next.main - DEBUG - 



2025-11-17 10:02:49,529 - ispa_next.main - DEBUG - starting with process 1 (FS-KD 59 E) of 20
2025-11-17 10:02:49,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:02:50,305 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:51,203 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:02:51,204 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 313
2025-11-17 10:02:52,524 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:02:52,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:15,517 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:03:15,618 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:03:15,624 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:16,059 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:03:16,060 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:18,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 367
2025-11-17 10:03:18,392 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:19,089 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:19,097 - ispa_next.main - DEBUG - 



2025-11-17 10:03:19,098 - ispa_next.main - DEBUG - starting with process 2 (FS-MT 886) of 20
2025-11-17 10:03:19,102 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:03:19,924 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:20,927 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:03:20,928 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 367
2025-11-17 10:03:22,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:22,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:33,605 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:03:33,613 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:03:33,617 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:33,952 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:03:33,954 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:35,956 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 367
2025-11-17 10:03:35,957 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:36,831 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:36,840 - ispa_next.main - DEBUG - 



2025-11-17 10:03:36,840 - ispa_next.main - DEBUG - starting with process 3 (FS-JM 484) of 20
2025-11-17 10:03:36,845 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:03:38,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:39,076 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:03:39,077 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 367
2025-11-17 10:03:40,355 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:40,357 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:51,799 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:03:51,815 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:03:51,833 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:52,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:03:52,362 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:54,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 367
2025-11-17 10:03:54,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:55,748 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:55,781 - ispa_next.main - DEBUG - 



2025-11-17 10:03:55,781 - ispa_next.main - DEBUG - starting with process 4 (FS-LA 175) of 20
2025-11-17 10:03:55,812 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:03:57,058 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:58,330 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:03:58,331 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 367
2025-11-17 10:03:59,784 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:59,785 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:11,113 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:04:11,123 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:04:11,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:11,543 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:04:11,544 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:04:14,109 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 367
2025-11-17 10:04:14,111 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:14,934 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:04:14,943 - ispa_next.main - DEBUG - 



2025-11-17 10:04:14,943 - ispa_next.main - DEBUG - starting with process 5 (FS AM 4) of 20
2025-11-17 10:04:14,948 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:15,916 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:16,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:04:16,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 367
2025-11-17 10:04:17,892 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:04:17,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:45,084 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:04:54,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:56,416 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:04:56,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:56,495 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:56,689 - ispa_next.functions - DEBUG - HU date already expired after 16 days.
2025-11-17 10:05:03,084 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:05:03,087 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:05:05,811 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:05,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:06,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:08,765 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:05:08,956 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:05:09,063 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:05:09,140 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:05:09,140 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:05:20,659 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:05:27,686 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:05:27,686 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:05:31,887 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:05:32,895 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:05:32,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:33,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:36,677 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:05:36,682 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:05:36,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:36,764 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:36,766 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:05:36,827 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:05:38,078 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:05:38,377 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:05:41,368 - ispa_next.functions - DEBUG - Updated appointment (AC00013041) customer contact data.
2025-11-17 10:05:42,267 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:05:42,270 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:05:43,083 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:05:43,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:05:43,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:05:47,393 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:47,393 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:05:47,398 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:05:47,402 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:05:47,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:47,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:55,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:56,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:56,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:57,208 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:57,209 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:06:00,189 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:06:00,191 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:06:01,092 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:06:01,093 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:01,094 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:06:01,095 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:01,096 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:06:01,097 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:06:01,098 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:06:01,099 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:06:01,100 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:06:01,102 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:06:01,105 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:06:01,107 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:06:01,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:04,428 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:06:06,756 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:06:06,759 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:06:06,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:10,019 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:06:10,022 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:06:10,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:06:10,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:06:11,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:21,574 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:06:21,576 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:24,911 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:06:35,171 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:06:35,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:06:36,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:06:36,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:08,524 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:12,170 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:15,974 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:19,621 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:19,626 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:07:19,626 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:20,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:20,124 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:07:20,127 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:07:21,656 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:07:31,474 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:07:31,849 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:07:32,263 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:33,741 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:07:33,742 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:07:36,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:07:36,699 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:37,560 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:07:37,569 - ispa_next.main - DEBUG - 



2025-11-17 10:07:37,569 - ispa_next.main - DEBUG - starting with process 6 (FS-SX 21) of 20
2025-11-17 10:07:37,574 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:38,767 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:40,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:07:40,109 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:07:41,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:07:41,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:03,069 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:08:03,079 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:08:03,084 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:03,719 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:08:03,720 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:06,235 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:08:06,235 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:06,960 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:08:06,976 - ispa_next.main - DEBUG - 



2025-11-17 10:08:06,976 - ispa_next.main - DEBUG - starting with process 7 (FS-NK 258) of 20
2025-11-17 10:08:06,982 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:08,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:08,951 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:08:08,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:08:10,062 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:10,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:22,400 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:08:22,409 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:08:22,414 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:22,887 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:08:22,889 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:25,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:08:25,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:26,285 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:08:26,294 - ispa_next.main - DEBUG - 



2025-11-17 10:08:26,294 - ispa_next.main - DEBUG - starting with process 8 (R-N 9943E) of 20
2025-11-17 10:08:26,299 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:27,208 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:28,100 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:08:28,101 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:08:29,321 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:29,322 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:41,087 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:08:41,098 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:08:41,104 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:41,515 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:08:41,516 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:43,982 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:08:43,982 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:44,915 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:08:44,924 - ispa_next.main - DEBUG - 



2025-11-17 10:08:44,924 - ispa_next.main - DEBUG - starting with process 9 (FS-P 2159) of 20
2025-11-17 10:08:44,930 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:46,132 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:47,342 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:08:47,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:08:48,546 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:48,547 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:02,838 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:09:02,846 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:09:02,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:03,294 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:03,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:05,315 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:09:05,316 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:05,889 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:05,898 - ispa_next.main - DEBUG - 



2025-11-17 10:09:05,898 - ispa_next.main - DEBUG - starting with process 10 (T-P 129) of 20
2025-11-17 10:09:05,905 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:07,042 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:08,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:08,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:09:09,566 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:09,567 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:18,004 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:09:18,011 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:09:18,015 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:18,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:18,346 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:20,572 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:09:20,573 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:21,252 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:21,260 - ispa_next.main - DEBUG - 



2025-11-17 10:09:21,261 - ispa_next.main - DEBUG - starting with process 11 (FS-CG 799) of 20
2025-11-17 10:09:21,265 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:22,074 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:22,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:22,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:09:24,171 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:24,172 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:35,184 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:09:35,208 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:09:35,213 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:35,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:35,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:37,556 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:09:37,556 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:38,212 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:38,220 - ispa_next.main - DEBUG - 



2025-11-17 10:09:38,220 - ispa_next.main - DEBUG - starting with process 12 (FS-SF234) of 20
2025-11-17 10:09:38,224 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:39,090 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:40,000 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:40,001 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:09:41,359 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:41,360 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:58,557 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:09:58,565 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:09:58,569 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:58,871 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:09:58,873 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:01,430 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:10:01,431 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:02,345 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:10:02,354 - ispa_next.main - DEBUG - 



2025-11-17 10:10:02,354 - ispa_next.main - DEBUG - starting with process 13 (FS-Y 330) of 20
2025-11-17 10:10:02,359 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:03,479 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:04,448 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:10:04,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:10:05,806 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:05,807 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:17,208 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:10:17,218 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:10:17,223 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:17,536 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:10:17,538 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:20,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:10:20,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:21,033 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:10:21,041 - ispa_next.main - DEBUG - 



2025-11-17 10:10:21,041 - ispa_next.main - DEBUG - starting with process 14 (FS-BD 344) of 20
2025-11-17 10:10:21,046 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:22,262 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:23,506 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:10:23,507 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:10:24,995 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:24,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:37,012 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:10:37,021 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 10:10:37,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:37,415 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:10:37,417 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:39,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:10:39,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:40,572 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:10:40,582 - ispa_next.main - DEBUG - 



2025-11-17 10:10:40,583 - ispa_next.main - DEBUG - starting with process 15 (FS B 93) of 20
2025-11-17 10:10:40,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:41,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:42,849 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:10:42,850 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:10:44,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:44,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:11:11,505 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:11:20,677 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:21,896 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:11:21,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:21,979 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:22,265 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:11:22,268 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:11:25,142 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:25,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:26,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:28,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:11:28,559 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:11:31,833 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:11:38,899 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 10:11:39,904 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:11:39,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:40,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:50,823 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:11:57,608 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:11:57,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:57,710 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:57,711 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:11:57,757 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:11:59,118 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:12:00,527 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:12:00,781 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:12:03,654 - ispa_next.functions - DEBUG - Updated appointment (AB00018777) customer contact data.
2025-11-17 10:12:04,606 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:12:04,610 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:12:05,409 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:12:05,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:12:06,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:12:09,702 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:12:09,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:10,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:12,200 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:12:12,297 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:12:12,449 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:12:12,536 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:12:12,536 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:24,197 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:13:24,200 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:35,013 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:13:42,310 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:13:42,310 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:13:46,539 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:13:47,547 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:13:47,550 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:13:47,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:47,674 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:51,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:52,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:52,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:53,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:53,077 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:13:54,392 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:13:54,408 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:13:55,437 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:13:55,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:55,440 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:13:55,443 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:13:55,444 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:13:55,447 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:13:55,448 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:13:55,449 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:13:55,456 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:13:55,459 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:13:55,466 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:13:55,469 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:13:55,470 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:56,646 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:13:56,649 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:13:56,652 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:57,904 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:13:57,907 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:13:57,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:13:58,716 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:13:58,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:06,630 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:14:06,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:07,869 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:14:18,024 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:14:18,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:19,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:14:19,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:30,749 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:14:30,752 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:14:30,753 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:31,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:31,289 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:14:31,292 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:14:32,756 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:14:39,157 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:14:39,533 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 10:14:39,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:41,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:14:41,656 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:44,161 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:14:44,162 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:44,826 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:14:44,834 - ispa_next.main - DEBUG - 



2025-11-17 10:14:44,834 - ispa_next.main - DEBUG - starting with process 16 (FS-LJ688) of 20
2025-11-17 10:14:44,854 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:45,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:46,837 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:14:46,838 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:14:48,080 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:48,081 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:09,156 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:15:09,165 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 10:15:09,169 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:09,566 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:15:09,567 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:11,972 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:15:11,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:12,692 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:15:12,701 - ispa_next.main - DEBUG - 



2025-11-17 10:15:12,701 - ispa_next.main - DEBUG - starting with process 17 (ED-MH 198) of 20
2025-11-17 10:15:12,709 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:13,559 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:14,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:15:14,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:15:15,811 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:15,812 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:26,854 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:15:26,863 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 10:15:26,867 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:27,275 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:15:27,276 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:29,061 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:15:29,061 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:29,738 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:15:29,751 - ispa_next.main - DEBUG - 



2025-11-17 10:15:29,751 - ispa_next.main - DEBUG - starting with process 18 (FS-LE 78) of 20
2025-11-17 10:15:29,758 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:30,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:31,415 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 666
2025-11-17 10:15:31,416 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:15:32,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:32,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:16:00,512 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:16:10,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:11,860 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:16:11,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:11,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:12,187 - ispa_next.functions - DEBUG - HU date already expired after 191 days.
2025-11-17 10:16:18,829 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:16:18,834 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:16:21,718 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:21,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:22,873 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:24,878 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:25,024 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:28,231 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:16:35,578 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 10:16:36,592 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:16:36,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:37,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:40,034 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:16:40,039 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:16:40,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:40,099 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:40,100 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:16:40,151 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:16:40,246 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:16:41,419 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:16:42,366 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:16:42,812 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:16:45,007 - ispa_next.functions - DEBUG - Updated appointment (AC00012912) customer contact data.
2025-11-17 10:16:45,903 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:16:45,906 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:16:45,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:46,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:16:48,034 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:16:48,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:48,100 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:16:52,539 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:52,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:53,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:55,127 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:55,278 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:55,384 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:55,477 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:55,478 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:06,987 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:18:06,990 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:18:18,445 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:19:01,448 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:19:12,480 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:19:19,730 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:19:19,730 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:19:23,944 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:19:24,951 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:19:24,954 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:19:24,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:25,073 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:19:25,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:26,022 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:26,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:26,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:26,651 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:19:28,559 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:19:28,561 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:19:30,014 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:19:30,022 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:19:30,024 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:19:30,025 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:19:30,028 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:19:30,029 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:19:30,030 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:19:30,031 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:19:30,034 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:19:30,036 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:19:30,039 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:19:30,043 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:19:30,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:31,966 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:19:31,969 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:19:31,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:33,897 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:19:33,900 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:19:33,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:19:34,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:19:34,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:41,171 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:19:41,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:43,089 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:19:53,881 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:19:54,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:54,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:19:54,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:13,029 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:17,597 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:17,600 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:20:17,600 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:20:18,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:20:18,401 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:20:18,404 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:20:20,325 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:20:26,657 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:20:27,030 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 10:20:27,380 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:20:28,437 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:20:28,438 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:20:31,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:20:31,337 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:20:32,163 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:20:32,175 - ispa_next.main - DEBUG - Found new Appointment: M-LW 208
2025-11-17 10:20:32,177 - ispa_next.main - DEBUG - 



2025-11-17 10:20:32,177 - ispa_next.main - DEBUG - starting with process 19 (M-LW 208) of 21
2025-11-17 10:20:32,184 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:20:33,419 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:20:34,724 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:20:34,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:20:36,127 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:20:36,129 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:21:05,473 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:21:15,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:16,338 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:21:16,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:16,446 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:16,619 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:21:16,623 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:21:19,425 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:19,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:20,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:22,556 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:21:22,694 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:21:25,932 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:21:26,048 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:21:30,223 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:21:31,230 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:21:31,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:31,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:43,133 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:21:49,468 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:21:49,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:49,535 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:49,536 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:21:49,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:21:50,807 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:21:51,912 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:21:52,144 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:21:56,020 - ispa_next.functions - DEBUG - Updated appointment (AB00018984) customer contact data.
2025-11-17 10:21:56,940 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:21:56,944 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:21:57,995 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:21:57,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:21:58,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:22:03,348 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:03,348 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:22:03,381 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:22:03,387 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:22:03,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:03,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:04,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:04,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:04,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:05,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:05,595 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:22:07,488 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:22:07,490 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:22:08,367 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:22:08,368 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:22:08,369 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:22:08,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:22:08,371 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:22:08,372 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:22:08,373 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:22:08,374 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:22:08,375 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:22:08,376 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:22:08,379 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:22:08,382 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:22:08,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:10,305 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:22:10,308 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:22:10,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:12,199 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:22:12,202 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:22:12,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:22:12,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:22:13,100 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:20,746 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:22:20,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:22,764 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:22:34,618 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:22:35,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:35,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:22:35,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:53,897 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:58,458 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:58,461 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:22:58,462 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:59,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:59,146 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:22:59,150 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:23:01,090 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:23:10,183 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:23:10,185 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:23:10,186 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:11,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:11,147 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:23:11,149 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:23:13,148 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:23:13,183 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:23:15,022 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 10:23:15,026 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:16,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:23:16,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:19,430 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:23:19,431 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:20,085 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:23:20,095 - ispa_next.main - DEBUG - 



2025-11-17 10:23:20,096 - ispa_next.main - DEBUG - starting with process 20 (FS AN 102) of 21
2025-11-17 10:23:20,103 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:21,291 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:22,367 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:23:22,369 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:23:23,956 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:23,958 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:52,053 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:24:01,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:02,939 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:24:02,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:03,035 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:03,282 - ispa_next.functions - DEBUG - HU date already expired after 433 days.
2025-11-17 10:24:10,675 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:24:10,679 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:24:13,471 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:13,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:14,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:16,881 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:16,990 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:20,246 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:20,305 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:20,306 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:24:31,932 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:24:32,953 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:24:32,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:33,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:47,112 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:24:53,624 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:24:53,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:53,707 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:53,707 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:24:53,752 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:24:54,935 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:24:56,007 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:24:56,235 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:24:59,699 - ispa_next.functions - DEBUG - Updated appointment (AB00018755) customer contact data.
2025-11-17 10:25:00,623 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:25:00,626 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:25:01,475 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:25:01,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:25:02,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:25:05,821 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:05,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:06,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:08,315 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:25:08,441 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:25:08,548 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:25:08,651 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:25:08,651 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:25:20,551 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:26:20,553 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:26:31,931 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:26:52,934 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:27:04,375 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:27:12,566 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:27:13,591 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:27:13,595 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:27:13,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:13,703 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:27:14,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:14,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:14,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:15,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:15,335 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:27:16,693 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:27:16,698 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:27:17,819 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:27:17,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:17,826 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:27:17,829 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:17,833 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:27:17,834 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:27:17,836 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:27:17,837 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:27:17,839 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:27:17,841 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:27:17,844 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:27:17,847 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:27:17,848 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:19,055 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:27:19,058 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:27:19,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:20,332 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:27:20,334 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:27:20,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:27:21,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:27:21,142 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:27:21,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:22,452 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:27:33,309 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:27:33,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:27:34,247 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:27:34,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:46,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:27:46,580 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:27:46,581 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:27:47,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:27:47,267 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:27:47,270 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:27:48,847 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:27:56,513 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:27:56,900 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 10:27:57,308 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:27:59,527 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:27:59,529 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:28:02,590 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:28:02,591 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:28:03,655 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:28:03,665 - ispa_next.main - DEBUG - 



2025-11-17 10:28:03,665 - ispa_next.main - DEBUG - starting with process 21 (PAF-EV 511) of 21
2025-11-17 10:28:03,670 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:28:04,941 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:28:06,196 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:28:06,197 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 366
2025-11-17 10:28:07,650 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:28:07,652 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:28:24,810 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:28:24,820 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-17 10:28:24,829 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:28:25,356 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 10:28:25,360 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:28:28,022 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 366
2025-11-17 10:28:28,023 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:28:28,909 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
