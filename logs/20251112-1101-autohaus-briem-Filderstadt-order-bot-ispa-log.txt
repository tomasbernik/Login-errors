2025-11-12 11:08:24,567 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:08:24,583 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:08:38,284 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:08:49,922 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:09:05,693 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:09:31,725 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:09:51,262 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:09:54,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:55,832 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 702
2025-11-12 11:09:55,832 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 282
2025-11-12 11:09:58,768 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 11:09:58,769 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:09:58,770 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:10:00,170 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:10:01,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:28,804 - ispa_next.appointments.models - DEBUG - Appointment Herr Bernd Mann BB-HB 72 E WBA6Y310507D84559 ohne Termin.
2025-11-12 11:10:28,872 - ispa_next.appointments.models - DEBUG - Appointment Frau Stefanie Bühler-Frischeisen ES-SF 5995 WBA1V710X07D15537 ohne Termin.
2025-11-12 11:10:28,889 - ispa_next.appointments.models - DEBUG - Appointment Herr Hans-Günter Rischer ES-HG 2535 WBAJP31020BT94747 ohne Termin.
2025-11-12 11:10:28,921 - ispa_next.appointments.models - DEBUG - Appointment Firma Autohaus Briem GmbH & Co. KG ES-RR 1018 WBA1S51080P756612 ohne Termin.
2025-11-12 11:10:28,946 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Herr Chandan Bekkalale Marigowda ES-CH 301.3 WBA71AC0703M93913, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='ES-CH 301.3', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-12 11:10:28,962 - ispa_next.appointments.models - DEBUG - Appointment   WMW11GD0502X84620 ohne Termin.
2025-11-12 11:10:28,963 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:29,000 - ispa_next.main - DEBUG - Found 6 out of 56 appointments to process (configured limit: 15).
2025-11-12 11:10:29,001 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-12 11:10:29,001 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 11:10:29,002 - ispa_next.main - DEBUG - All appointments: ES-R 357, ES-MK 353 E, ES-FI 567E, S-QA 1510, S-EN 2411, ES-AG 1420
2025-11-12 11:10:29,005 - ispa_next.main - DEBUG - 



2025-11-12 11:10:29,005 - ispa_next.main - DEBUG - starting with process 1 (ES-R 357) of 6
2025-11-12 11:10:29,016 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:30,336 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:31,744 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 702
2025-11-12 11:10:31,745 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 11:10:33,561 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:33,563 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:19,755 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:11:30,677 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:34,082 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:11:34,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:34,177 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:34,544 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:11:34,544 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:11:37,603 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:11:37,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:11:38,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:40,931 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:11:41,106 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:11:44,335 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:11:44,432 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:11:48,695 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:11:49,713 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:11:49,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:50,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:03,725 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:12:12,486 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:12,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:12,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:12,644 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:12,744 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:12,863 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:12:14,455 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:15,097 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:12:19,550 - ispa_next.functions - DEBUG - Updated appointment (AC00021227) customer contact data.
2025-11-12 11:12:20,472 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:12:20,484 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:12:20,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:21,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:12:23,378 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:12:23,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:23,549 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:12:27,191 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:27,191 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:12:27,191 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:12:27,191 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:12:27,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:27,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:31,972 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:12:32,873 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:12:50,083 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:12:50,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:50,207 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:12:50,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:51,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:51,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:52,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:52,273 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:12:56,102 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:12:56,102 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FZG Fussraum aussaugen, source=manual, target=cart)}
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:12:58,004 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:12:58,020 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:12:58,020 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:12:58,020 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:12:58,020 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:12:58,925 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:13:04,753 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:13:04,757 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:13:04,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:09,722 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:13:09,722 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:13:09,722 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:14,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:14,847 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:13:25,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:43,737 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:13:43,737 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:13:43,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:13:44,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:13:44,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:51,996 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:13:52,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:57,043 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:14:17,603 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:14:18,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:14:18,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:14:19,237 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:08,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:15:17,515 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:15:25,300 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:15:32,948 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:15:40,487 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:15:48,283 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:15:48,283 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:15:48,283 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:50,238 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:15:50,409 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:15:50,413 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:15:54,380 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:16:17,239 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:16:17,684 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:16:21,885 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:23,049 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 703
2025-11-12 11:16:23,049 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:29,139 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 283
2025-11-12 11:16:29,140 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:30,738 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:16:30,747 - ispa_next.main - DEBUG - 



2025-11-12 11:16:30,747 - ispa_next.main - DEBUG - starting with process 2 (ES-MK 353 E) of 6
2025-11-12 11:16:30,751 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:33,273 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:36,161 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 703
2025-11-12 11:16:36,163 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 283
2025-11-12 11:16:39,345 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:39,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:36,768 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:17:54,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:54,178 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:54,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:01,488 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:18:01,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:01,615 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:02,163 - ispa_next.functions - DEBUG - HU date already expired after 2 days.
2025-11-12 11:18:17,079 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:18:17,079 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:18:20,398 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:18:20,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:22,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:24,558 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:18:24,746 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:18:24,987 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:18:25,159 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:18:25,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:32,387 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:18:44,741 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:18:51,548 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:18:51,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:00,378 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 11:19:03,943 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:19:07,190 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:19:08,196 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:08,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:08,804 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:27,001 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:19:41,267 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:19:41,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:41,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:41,425 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:19:41,567 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:19:41,814 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:19:43,819 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:19:44,417 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:19:48,955 - ispa_next.functions - DEBUG - Updated appointment (AC00021225) customer contact data.
2025-11-12 11:19:50,100 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:19:50,100 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:19:50,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:51,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:19:54,553 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:19:54,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:54,707 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:19:58,376 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:58,376 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:19:58,376 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:19:58,376 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:19:58,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:59,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:03,285 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:20:05,016 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:20:18,932 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:18,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:19,159 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:20:27,990 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:20:44,021 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:20:45,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:45,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:45,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:46,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:46,845 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:53,907 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:53,919 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:56,298 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:56,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:56,298 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FZG Fussraum aussaugen, source=manual, target=cart), Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 11:20:56,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:56,298 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:56,313 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:56,313 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:56,313 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:56,313 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:56,313 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:56,313 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:21:18,536 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:21:25,505 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 11:21:37,571 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:21:37,571 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:21:37,586 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:46,928 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:21:51,515 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:21:51,641 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:21:51,641 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:00,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:01,010 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:14,674 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:37,582 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:22:37,582 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:22:37,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:22:39,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:22:39,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:03,544 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:23:03,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:13,253 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:23:37,882 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:23:38,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:39,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:23:39,531 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:08,672 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:24:08,672 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:24:10,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:24:10,381 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:24:10,381 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:24:16,474 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:24:35,024 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:24:35,412 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:24:39,778 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:24:41,130 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:24:41,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:24:47,535 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:24:47,536 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:49,399 - ispa_next.appointments.models - DEBUG - Appointment Frau Elisabeth Meißner ES-AB 351 E WBY8P210807F02210 ohne Termin.
2025-11-12 11:24:49,409 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:24:49,426 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:24:49,435 - ispa_next.main - DEBUG - Found new Appointment: S-KK 7839
2025-11-12 11:24:49,439 - ispa_next.main - DEBUG - 



2025-11-12 11:24:49,439 - ispa_next.main - DEBUG - starting with process 3 (S-KK 7839) of 7
2025-11-12 11:24:49,445 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:24:52,046 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:24:54,908 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:24:54,910 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:24:58,120 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:24:58,122 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:39,515 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:25:55,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:55,223 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:55,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:56,874 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:25:56,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:57,007 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:57,489 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:26:09,405 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:26:09,405 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:26:12,648 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:26:12,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:14,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:16,406 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:26:27,733 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:26:40,515 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:26:41,536 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:26:41,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:42,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:03,360 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:27:16,233 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:27:16,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:16,421 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:16,421 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:27:16,524 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:27:16,703 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:27:18,240 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:27:19,773 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:27:20,568 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:27:24,200 - ispa_next.functions - DEBUG - Updated appointment (AC00021229) customer contact data.
2025-11-12 11:27:25,282 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:27:25,297 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:27:25,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:27:26,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:27:29,358 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:27:29,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:27:29,570 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:27:34,371 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:27:34,372 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:27:34,511 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:27:34,513 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:27:34,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:35,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:39,346 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:27:39,346 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:27:39,346 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 11:27:39,346 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:27:41,907 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:27:41,920 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:27:43,702 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:27:43,702 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:27:43,702 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FZG Fussraum aussaugen, source=manual, target=cart)}
2025-11-12 11:27:43,702 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:27:43,702 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:27:43,702 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:27:43,718 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:27:43,718 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:27:43,718 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:27:43,718 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:27:43,718 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:27:44,548 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:27:50,056 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:27:50,061 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:27:50,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:53,732 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:27:53,732 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:27:53,745 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:57,284 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:27:57,284 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:27:57,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:27:58,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:27:58,639 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:27:58,639 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:02,075 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:28:24,676 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:28:25,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:25,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:28:26,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:29:00,920 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:29:08,509 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:29:15,894 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:29:23,998 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:29:23,998 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:29:23,998 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:25,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:29:25,462 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:29:25,462 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:29:29,213 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:29:45,016 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:29:45,396 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:29:48,908 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:50,111 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:29:50,120 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:56,494 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 285
2025-11-12 11:29:56,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:58,178 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:29:58,189 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:29:58,194 - ispa_next.main - DEBUG - Found new Appointment: ES-AB 351 E
2025-11-12 11:29:58,195 - ispa_next.main - DEBUG - 



2025-11-12 11:29:58,195 - ispa_next.main - DEBUG - starting with process 4 (ES-AB 351 E) of 8
2025-11-12 11:29:58,199 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:30:00,764 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:03,648 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:30:03,650 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 285
2025-11-12 11:30:06,623 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:30:06,626 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:53,326 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:31:09,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:10,109 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:10,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:14,570 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:31:14,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:14,717 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:31:15,300 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:31:15,300 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:31:18,592 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:18,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:20,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:22,595 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:31:22,821 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:31:23,098 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:31:23,385 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:31:23,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:27,779 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:31:39,283 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:31:44,891 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:31:44,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:49,497 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:31:51,748 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:31:52,754 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:31:52,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:53,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:13,185 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:32:13,200 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:32:27,076 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:32:27,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:32:27,204 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:32:27,204 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:32:27,299 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:32:27,529 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:32:29,286 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:32:29,635 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:32:32,544 - ispa_next.functions - DEBUG - Updated appointment (AC00021231) customer contact data.
2025-11-12 11:32:33,641 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:32:33,644 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:32:33,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:32:35,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:32:38,176 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:32:38,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:32:38,449 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:32:42,185 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:32:42,185 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:32:42,185 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:32:42,185 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:32:42,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:32:42,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:32:46,997 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:32:48,498 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:33:05,497 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:33:05,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:05,653 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:33:06,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:06,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:06,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:07,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:33:07,690 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:33:12,193 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:33:12,193 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:33:13,703 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:33:13,703 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:13,703 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FZG Fussraum aussaugen, source=manual, target=cart)}
2025-11-12 11:33:13,703 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:33:13,716 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 11:33:13,716 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:33:13,716 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:33:13,716 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:33:13,716 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:33:13,716 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:33:14,594 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:33:22,602 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:33:27,166 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:27,716 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:28,709 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:29,309 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:29,882 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:31,690 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:32,341 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:32,907 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:33,872 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:34,528 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:35,091 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:36,041 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:36,702 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:37,731 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:38,694 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:39,294 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:39,850 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:40,819 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:41,482 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:42,028 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:33:43,008 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:44,528 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:33:45,560 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:33:46,735 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:33:46,802 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:33:46,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:51,842 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:33:51,842 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:33:51,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:56,773 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:33:56,773 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:33:56,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:33:57,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:33:58,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:17,216 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:34:17,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:34:22,501 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:34:46,809 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:34:47,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:34:48,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:34:48,424 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:35:37,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:35:45,090 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:35:53,309 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:36:01,402 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:36:09,309 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:36:17,175 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:36:17,175 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:36:17,184 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:36:18,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:36:18,795 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:36:18,795 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:36:22,914 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:36:40,689 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:36:41,079 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:36:44,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:36:46,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:36:46,164 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:36:52,915 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 11:36:52,916 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:36:54,508 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:36:54,518 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:36:54,523 - ispa_next.main - DEBUG - 



2025-11-12 11:36:54,524 - ispa_next.main - DEBUG - starting with process 5 (ES-FI 567E) of 8
2025-11-12 11:36:54,527 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:36:57,097 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:36:59,948 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:36:59,951 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 11:37:02,997 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:37:02,999 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:37:45,746 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:37:49,673 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:37:57,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:59,919 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:37:59,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:00,110 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:00,540 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:38:00,540 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:38:04,013 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:38:04,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:38:06,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:38:08,179 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:38:08,480 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:38:08,686 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:38:08,892 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:38:08,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:10,996 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:38:21,074 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:38:22,082 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:38:22,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:22,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:42,363 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:38:55,199 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:38:55,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:38:55,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:38:55,422 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:38:55,543 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:38:57,392 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:38:59,020 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:38:59,605 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:39:02,174 - ispa_next.functions - DEBUG - Updated appointment (AC00021090) customer contact data.
2025-11-12 11:39:03,277 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:39:03,283 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:39:05,058 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:39:05,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:39:06,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:39:10,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:39:10,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:10,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:39:12,788 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:39:12,992 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:39:13,278 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:39:13,500 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:39:13,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:15,652 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:39:25,503 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:40:25,519 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:40:36,542 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:40:46,549 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:40:56,329 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:41:10,604 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:41:11,620 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:41:11,620 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:41:11,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:11,798 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:41:16,026 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:41:16,026 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:41:16,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:16,200 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:41:25,423 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 11:41:35,901 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 11:41:36,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:36,903 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:36,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:38,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:38,058 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:41:40,168 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:41:40,168 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:41:42,089 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:41:42,089 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:42,089 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 11:41:42,089 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:41:42,101 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:41:42,101 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:41:42,101 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:41:42,101 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:41:42,101 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:41:42,101 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:41:42,101 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:42:07,838 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 11:42:08,041 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:42:08,041 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:09,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:42:10,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:42:10,851 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 11:42:10,878 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:42:17,995 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:42:18,010 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:19,172 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:42:19,182 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:25,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 11:42:25,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:42:27,628 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:42:27,644 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:42:27,652 - ispa_next.main - DEBUG - 



2025-11-12 11:42:27,652 - ispa_next.main - DEBUG - starting with process 6 (S-QA 1510) of 8
2025-11-12 11:42:27,657 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:42:30,184 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:42:33,204 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:42:33,206 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 11:42:36,226 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:42:36,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:43:20,744 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:43:24,813 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:43:33,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:36,065 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:43:36,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:36,213 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:43:36,900 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:43:36,904 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:43:40,285 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:43:40,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:42,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:44,061 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:43:44,280 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:43:44,543 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:43:44,776 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:43:49,088 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:43:50,094 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:43:50,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:50,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:12,713 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:44:21,351 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:44:21,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:21,540 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:44:21,540 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:44:21,625 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:44:23,201 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:44:24,906 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:44:25,338 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:44:27,963 - ispa_next.functions - DEBUG - Updated appointment (AC00021123) customer contact data.
2025-11-12 11:44:29,119 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:44:29,244 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:44:31,275 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:44:31,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:44:32,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:44:36,276 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:44:36,276 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:44:36,276 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:44:36,276 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:44:36,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:36,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:44:41,027 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:44:41,027 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:44:41,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:41,170 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:44:46,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:47,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:44:47,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:48,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:44:48,624 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:44:51,275 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:44:51,286 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:44:53,141 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:44:53,141 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:44:53,152 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:44:53,152 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:44:53,167 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:44:53,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:55,977 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:44:55,977 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:44:55,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:58,928 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:44:58,931 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:44:58,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:45:00,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:45:00,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:11,062 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:45:11,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:13,816 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:45:36,520 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:45:37,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:45:38,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:45:38,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:15,650 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:22,900 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:31,712 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:46:31,712 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:46:31,712 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:46:33,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:46:33,215 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:46:33,215 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:46:38,807 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:46:55,642 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:46:56,044 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:46:59,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:01,003 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:47:01,009 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:07,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 11:47:07,464 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:47:09,166 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:47:09,177 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:47:09,183 - ispa_next.main - DEBUG - 



2025-11-12 11:47:09,183 - ispa_next.main - DEBUG - starting with process 7 (S-EN 2411) of 8
2025-11-12 11:47:09,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:47:11,885 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:14,785 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:47:14,788 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 11:47:17,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:17,906 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:48:07,618 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:48:11,540 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:48:19,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:48:22,683 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:48:22,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:22,837 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:48:23,493 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:48:23,493 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:48:26,810 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:48:26,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:48:28,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:48:30,988 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:48:31,210 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:48:31,484 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:48:31,706 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:48:35,993 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:48:36,999 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:48:36,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:37,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:59,165 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:49:07,758 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:49:07,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:07,926 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:49:07,930 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:49:08,075 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:49:08,305 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:49:10,000 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:49:11,544 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:49:12,149 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:49:14,805 - ispa_next.functions - DEBUG - Updated appointment (AC00021165) customer contact data.
2025-11-12 11:49:15,977 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:49:16,005 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:49:16,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:49:18,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:49:20,086 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:49:20,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:49:20,224 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:49:23,868 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:49:23,868 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:49:23,868 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:49:23,868 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:49:23,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:24,504 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:49:28,742 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:49:28,742 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:49:28,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:28,883 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:49:29,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:29,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:49:29,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:31,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:49:31,078 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:49:33,711 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:49:33,712 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:49:35,413 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:49:35,420 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:49:35,420 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:49:35,430 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:49:35,436 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:49:35,436 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:49:35,436 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:49:35,436 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:49:35,436 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:49:35,436 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:49:35,436 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:49:35,436 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:49:35,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:49:38,461 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:49:38,461 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:49:38,461 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:49:41,274 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:49:41,274 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:49:41,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:49:42,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:49:42,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:49:49,464 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:49:49,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:49:52,299 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:50:12,656 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:50:13,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:50:13,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:50:14,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:50:42,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:50:50,166 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:50:58,460 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:50:58,460 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:50:58,460 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:50:59,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:50:59,953 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:50:59,953 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:51:03,742 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:51:19,954 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:51:20,326 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:51:24,066 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:51:25,446 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:51:25,446 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:51:32,075 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 11:51:32,076 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:51:33,752 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:51:33,762 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
2025-11-12 11:51:33,768 - ispa_next.main - DEBUG - 



2025-11-12 11:51:33,768 - ispa_next.main - DEBUG - starting with process 8 (ES-AG 1420) of 8
2025-11-12 11:51:33,771 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:51:36,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:51:39,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:51:39,348 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 284
2025-11-12 11:51:42,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:51:42,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:52:30,507 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:52:34,527 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:52:43,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:52:48,991 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:52:48,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:52:49,132 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:52:49,585 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:52:49,592 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:52:52,950 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:52:52,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:52:54,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:52:56,921 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:52:57,126 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:52:57,295 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:52:57,507 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:53:01,837 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:53:02,845 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:53:02,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:03,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:25,616 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:53:34,501 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:53:34,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:53:34,659 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:53:34,659 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:53:34,741 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:53:34,944 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:53:36,468 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:53:38,075 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:53:38,915 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:53:41,625 - ispa_next.functions - DEBUG - Updated appointment (AC00021220) customer contact data.
2025-11-12 11:53:42,786 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:53:42,791 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:53:43,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:53:45,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:53:46,948 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:53:46,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:53:47,107 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:53:50,772 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:53:50,772 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:53:50,772 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:53:50,772 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:53:50,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:53:51,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:53:55,741 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:54:03,913 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:54:03,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:04,014 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:54:04,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:05,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:05,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:06,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:54:06,353 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:54:10,522 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:54:10,522 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:54:12,780 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:54:12,780 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:54:12,790 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:54:12,806 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:54:12,822 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:54:12,822 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:54:12,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:17,272 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:54:17,272 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:54:17,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:21,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:21,688 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:54:34,835 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:54:34,835 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:54:34,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:54:36,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:54:36,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:48,445 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:54:48,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:52,808 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:55:14,345 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:55:14,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:55:15,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:55:16,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:55:58,685 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:56:07,791 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:56:15,928 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:56:24,068 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:56:32,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:56:32,148 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:56:32,148 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:56:33,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:56:33,678 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:56:33,678 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:56:37,600 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:56:54,912 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:56:55,356 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:56:59,819 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:57:01,366 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 705
2025-11-12 11:57:01,366 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:57:08,045 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 284
2025-11-12 11:57:08,047 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:57:09,785 - ispa_next.appointments.models - DEBUG - Appointment Herr Steffen Helmut Günther S-UN 999 WMWJZ910602U21767 ohne Termin.
2025-11-12 11:57:09,795 - ispa_next.appointments.models - DEBUG - Appointment Herr Erik Barth LEO-LI 28 WMWXM510902E20262 ohne Termin.
