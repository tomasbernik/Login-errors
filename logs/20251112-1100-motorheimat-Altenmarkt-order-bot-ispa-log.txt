2025-11-12 11:21:35,517 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:21:35,534 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:21:45,225 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:21:55,633 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:22:11,157 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:24:09,803 - ispa_next.app_start.main - DEBUG - Operation already took 107.35 seconds (more than 80 seconds)
2025-11-12 11:24:11,882 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_9c0pv5oq_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_9c0pv5oq', 'txt']
2025-11-12 11:24:12,261 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:24:12,267 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:24:12,267 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:26:11,386 - ispa_next.app_start.main - DEBUG - Operation already took 106.84 seconds (more than 80 seconds)
2025-11-12 11:26:13,441 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_znk0q9rg_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_znk0q9rg', 'txt']
2025-11-12 11:26:13,672 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:26:13,678 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:26:19,974 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 11:26:28,795 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:26:39,187 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:26:54,827 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:28:52,697 - ispa_next.app_start.main - DEBUG - Operation already took 106.76 seconds (more than 80 seconds)
2025-11-12 11:28:54,785 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_dbiar03x_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_dbiar03x', 'txt']
2025-11-12 11:28:55,026 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:28:55,031 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:28:55,032 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:30:54,290 - ispa_next.app_start.main - DEBUG - Operation already took 106.96 seconds (more than 80 seconds)
2025-11-12 11:30:56,410 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_mcweobup_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_mcweobup', 'txt']
2025-11-12 11:30:56,638 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:30:56,642 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:31:02,789 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 11:31:11,128 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:31:21,648 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:31:37,327 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:33:34,967 - ispa_next.app_start.main - DEBUG - Operation already took 106.52 seconds (more than 80 seconds)
2025-11-12 11:33:37,033 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess__qwg81gu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess__qwg81gu', 'txt']
2025-11-12 11:33:37,247 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:33:37,251 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:33:37,252 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:35:35,464 - ispa_next.app_start.main - DEBUG - Operation already took 106.02 seconds (more than 80 seconds)
2025-11-12 11:35:37,563 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_otcz1cb2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_otcz1cb2', 'txt']
2025-11-12 11:35:37,778 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:35:37,784 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:35:44,013 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 11:35:52,017 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:36:03,071 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:36:18,497 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:38:16,213 - ispa_next.app_start.main - DEBUG - Operation already took 106.62 seconds (more than 80 seconds)
2025-11-12 11:38:18,281 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_n411n2z1_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6a798d98d9448ffb\\tess_n411n2z1', 'txt']
2025-11-12 11:38:18,510 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:38:18,516 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:38:18,517 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:38:43,162 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:38:55,866 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:38:58,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:38:59,415 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:38:59,417 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 11:39:01,389 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 55
2025-11-12 11:39:01,390 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:39:01,392 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:39:02,413 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:39:03,446 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:11,306 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:39:11,335 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:39:11,336 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:39:11,341 - ispa_next.main - DEBUG - Found 3 out of 12 appointments to process (configured limit: 15).
2025-11-12 11:39:11,341 - ispa_next.main - DEBUG - Processing 0 fresh appointments.
2025-11-12 11:39:11,341 - ispa_next.main - DEBUG - Processing 3 already visited appointments (w/ RKR not callable).
2025-11-12 11:39:11,341 - ispa_next.main - DEBUG - All appointments: TS-M 2679, TS-MV 266 E, TS-SU 348
2025-11-12 11:39:11,351 - ispa_next.main - DEBUG - 



2025-11-12 11:39:11,351 - ispa_next.main - DEBUG - starting with process 1 (TS-M 2679) of 3
2025-11-12 11:39:11,355 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:39:12,444 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:13,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:39:13,551 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 55
2025-11-12 11:39:14,702 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:14,703 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:41,968 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:39:43,755 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:39:48,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:39:51,651 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:39:51,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:51,746 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:51,997 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:39:51,999 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:39:51,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:39:52,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:39:54,994 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:39:54,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:39:55,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:39:57,905 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:39:58,029 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:39:58,118 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:39:58,191 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:40:02,354 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:40:03,359 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:40:03,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:03,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:14,483 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:40:14,483 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:40:17,870 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:40:17,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:17,948 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:17,950 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:40:18,006 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:40:19,201 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:40:19,475 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:40:21,191 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:40:21,192 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:40:21,667 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:40:21,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:40:22,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:40:25,861 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:40:25,861 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:40:25,864 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:40:25,864 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:40:25,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:26,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:30,479 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:40:30,482 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:40:30,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:30,603 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:40:36,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:36,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:36,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:37,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:37,428 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:40:40,387 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:40:40,388 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:40:41,235 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:40:41,237 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:40:41,239 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:40:41,241 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:40:41,243 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:40:41,245 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:40:41,247 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:40:41,249 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:40:41,249 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:40:41,251 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:40:41,251 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:40:41,253 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:40:41,255 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:40:41,255 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:40:41,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:44,510 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:40:44,512 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:40:44,514 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:47,710 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:40:47,710 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:40:47,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:50,972 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:40:50,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:40:51,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:40:51,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:56,665 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:40:56,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:59,919 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:41:09,378 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:41:09,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:41:10,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:41:10,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:41:20,948 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:41:20,949 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:41:21,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:41:21,540 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:41:21,542 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:41:23,706 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:41:36,658 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:41:37,066 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:41:37,792 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:41:38,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:41:38,349 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:41:40,703 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 11:41:40,703 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:41:41,487 - ispa_next.main - DEBUG - 



2025-11-12 11:41:41,487 - ispa_next.main - DEBUG - starting with process 2 (TS-MV 266 E) of 3
2025-11-12 11:41:41,490 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:41:42,520 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:41:43,635 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:41:43,637 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 11:41:44,875 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:41:44,877 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:42:09,790 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:42:11,261 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:42:15,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:42:19,050 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:42:19,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:19,142 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:42:19,404 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:42:23,009 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:42:23,011 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:42:23,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:23,074 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:42:26,072 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:42:26,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:42:26,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:42:28,925 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:42:29,051 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:42:29,154 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:42:29,234 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:42:33,415 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:42:34,420 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:42:34,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:34,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:45,400 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:42:49,081 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:42:49,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:42:49,215 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:42:49,215 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:42:49,253 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:42:50,463 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:42:51,546 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:42:51,785 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:42:53,433 - ispa_next.functions - DEBUG - Updated appointment (AJ00018011) customer contact data.
2025-11-12 11:42:54,349 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:42:54,350 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:42:55,062 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:42:55,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:42:55,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:42:59,824 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:42:59,824 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:42:59,827 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:42:59,827 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:42:59,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:00,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:04,448 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:43:04,452 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:43:04,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:04,574 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:43:10,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:10,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:10,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:11,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:11,219 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:43:14,204 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:43:14,208 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:43:15,899 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:43:15,901 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:43:15,903 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:43:15,903 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:43:15,904 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:43:15,906 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:43:15,906 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:43:15,908 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:43:15,910 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:43:15,910 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:43:15,912 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:43:15,914 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:43:15,914 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:43:15,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:19,194 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:43:19,196 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:43:19,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:22,391 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:43:22,391 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:43:22,393 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:25,626 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:43:25,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:43:26,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:43:26,595 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:42,321 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:43:42,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:43:45,599 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:43:55,800 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:43:56,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:43:56,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:43:56,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:28,184 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:32,086 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:35,702 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:39,521 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:44:39,522 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:44:39,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:44:39,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:44:40,045 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:44:40,046 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:44:41,583 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:44:48,420 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:44:48,822 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:44:49,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:44:50,062 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:44:50,064 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:44:52,734 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 11:44:52,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:44:53,566 - ispa_next.main - DEBUG - 



2025-11-12 11:44:53,566 - ispa_next.main - DEBUG - starting with process 3 (TS-SU 348) of 3
2025-11-12 11:44:53,571 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:44:54,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:44:55,755 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:44:55,757 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 81
2025-11-12 11:44:56,966 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:44:56,967 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:45:25,379 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:45:27,137 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:45:31,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:33,760 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:45:33,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:33,830 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:45:34,000 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:45:34,001 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:45:34,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:34,069 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:45:37,036 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:45:37,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:45:37,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:45:39,896 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:45:40,044 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:45:40,159 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:45:40,254 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:45:44,447 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:45:45,452 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:45:45,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:45,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:45:56,731 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:45:56,757 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:46:00,199 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:46:00,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:00,261 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:46:00,263 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:46:00,291 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:46:01,502 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:46:01,742 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:46:03,297 - ispa_next.functions - DEBUG - Updated appointment (AJ00018087) customer contact data.
2025-11-12 11:46:04,191 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:46:04,191 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:46:04,662 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:46:04,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:46:05,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:46:08,889 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:46:08,889 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:46:08,892 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:46:08,892 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:46:08,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:09,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:46:13,475 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:46:13,478 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:46:13,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:13,540 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:46:22,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:23,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:46:23,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:46:23,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:46:23,716 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:46:25,618 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:46:25,620 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:46:27,007 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:46:27,007 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:46:27,009 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:46:27,011 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:46:27,012 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:46:27,013 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:46:27,021 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:46:27,023 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:46:27,025 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:46:27,027 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:46:27,027 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:46:27,029 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:46:27,031 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:46:27,031 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:46:27,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:28,953 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:46:28,954 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:46:28,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:30,811 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:46:30,811 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 11:46:30,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:32,700 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:46:32,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:46:33,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:46:33,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:47,542 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:46:47,544 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:46:49,450 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:46:59,828 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:47:00,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:47:00,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:47:00,979 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:47:18,071 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:21,640 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:47:21,641 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:47:21,642 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:47:22,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:47:22,117 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:47:22,118 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:47:23,527 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:47:30,028 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:47:30,451 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:47:31,118 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:31,671 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 192
2025-11-12 11:47:31,673 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:34,410 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 81
2025-11-12 11:47:34,410 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
