2025-11-17 10:07:34,462 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:07:34,468 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:07:43,358 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:07:53,716 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:08:09,348 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:08:41,658 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:08:52,763 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:08:55,402 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:56,194 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:08:56,196 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-17 10:08:58,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-17 10:08:58,337 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:08:58,337 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:08:59,782 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:09:00,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:14,458 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:14,489 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:09:14,511 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Hirsch LIP-B 8307 WBAJM71090B068525 ohne Termin.
2025-11-17 10:09:14,519 - ispa_next.appointments.models - DEBUG - Appointment Janecke Möbeltechnik GmbH LIP-L 179 E WBY21HH050CU09424 ohne Termin.
2025-11-17 10:09:14,528 - ispa_next.main - DEBUG - Found 12 out of 29 appointments to process (configured limit: 15).
2025-11-17 10:09:14,528 - ispa_next.main - DEBUG - Processing 12 fresh appointments.
2025-11-17 10:09:14,529 - ispa_next.main - DEBUG - All appointments: LIP-AK 706, BI-DD 5400, LIP-EA 122, LIP-QV 657, LIP-GD-24E, WAK E 11, LIP-KR 1965, LIP-JL 179, LIP-L 0921, HX PA 5010, Lip-qz 95 e, LIP-KS 331
2025-11-17 10:09:14,533 - ispa_next.main - DEBUG - 



2025-11-17 10:09:14,533 - ispa_next.main - DEBUG - starting with process 1 (LIP-AK 706) of 12
2025-11-17 10:09:14,537 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:15,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:16,735 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:09:16,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-17 10:09:18,067 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:18,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:31,498 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:09:31,570 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:09:31,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:31,918 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:09:31,920 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:33,816 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 171
2025-11-17 10:09:33,817 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:34,476 - ispa_next.appointments.models - DEBUG - Appointment Mouhamad Males LIP-M 153 WBAVC31000VC37149 ohne Termin.
2025-11-17 10:09:34,483 - ispa_next.main - DEBUG - 



2025-11-17 10:09:34,483 - ispa_next.main - DEBUG - starting with process 2 (BI-DD 5400) of 12
2025-11-17 10:09:34,487 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:35,284 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:09:36,284 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:09:36,285 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-17 10:09:37,665 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:09:37,666 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:04,798 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:10:13,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:10:15,663 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:10:15,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:15,745 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:15,941 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:10:15,943 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:10:15,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:16,033 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:19,055 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:19,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:20,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:22,052 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:10:22,152 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:10:25,381 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:10:25,448 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:10:29,672 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:10:30,678 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:10:30,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:31,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:45,683 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:10:52,659 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:10:52,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:52,750 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:52,751 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:10:52,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:10:53,984 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:10:55,113 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:10:55,351 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:10:58,640 - ispa_next.functions - DEBUG - Updated appointment (AA00044716) customer contact data.
2025-11-17 10:10:59,554 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:10:59,556 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:11:00,191 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:11:00,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:11:00,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:11:04,397 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:04,397 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:11:04,403 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:11:04,406 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:11:04,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:04,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:10,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:11,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:11,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:11,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:11,755 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:11:14,235 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:11:14,237 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:11:15,069 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:11:15,071 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:11:15,073 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:11:15,074 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:11:15,075 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:11:15,076 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:11:15,078 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:11:15,078 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:11:15,078 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:11:15,080 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:11:15,082 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:11:15,087 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:11:15,091 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:11:15,092 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:11:15,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:17,686 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:11:17,686 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:11:17,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:20,282 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:11:20,283 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:11:20,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:11:20,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:11:20,991 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:11:21,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:23,555 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:11:23,557 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:11:24,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:11:24,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:11:24,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:30,806 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:11:34,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:11:37,911 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:11:37,913 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:11:37,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:11:38,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:11:38,430 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:11:38,432 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:11:39,867 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:11:48,334 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:11:48,729 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:11:49,044 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:11:50,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:11:50,029 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:11:52,580 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 171
2025-11-17 10:11:52,580 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:11:53,493 - ispa_next.appointments.models - DEBUG - Appointment Mouhamad Males LIP-M 153 WBAVC31000VC37149 ohne Termin.
2025-11-17 10:11:53,501 - ispa_next.main - DEBUG - 



2025-11-17 10:11:53,501 - ispa_next.main - DEBUG - starting with process 3 (LIP-EA 122) of 12
2025-11-17 10:11:53,504 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:11:54,643 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:11:56,044 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:11:56,045 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-17 10:11:57,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:11:57,389 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:12:32,616 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:12:41,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:41,919 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:12:42,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:43,357 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:12:43,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:43,418 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:12:43,614 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:12:43,616 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:12:43,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:43,683 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:12:46,852 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:12:46,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:47,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:49,810 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:12:49,904 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:12:53,097 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:12:53,153 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:12:53,154 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:04,213 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:13:05,217 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:13:05,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:05,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:16,872 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:13:16,872 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:13:23,219 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:13:23,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:23,300 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:13:23,301 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:13:23,344 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:13:24,695 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:13:24,904 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:13:28,018 - ispa_next.functions - DEBUG - Updated appointment (AA00044715) customer contact data.
2025-11-17 10:13:28,920 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:13:28,920 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:13:29,420 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:13:29,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:13:30,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:13:34,056 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:13:34,056 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:13:34,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:34,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:36,538 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:13:36,662 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:13:36,783 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:13:36,863 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:13:36,863 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:48,281 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:13:55,305 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:13:55,305 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:13:59,525 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:14:00,532 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:14:00,539 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:14:00,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:00,610 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:14:06,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:06,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:06,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:07,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:07,476 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:14:08,787 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:14:08,789 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:14:09,769 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:14:09,773 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:14:09,775 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:14:09,779 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:14:09,779 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:14:09,786 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:14:09,792 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:14:09,794 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:14:09,796 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:14:09,800 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:14:09,808 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:14:09,812 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:14:09,816 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:14:09,818 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:14:09,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:11,018 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:14:11,019 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:14:11,021 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:12,207 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:14:12,209 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:14:12,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:14:12,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:14:13,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:22,970 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:14:22,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:24,204 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:14:24,206 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:14:24,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:25,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:14:25,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:30,360 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:14:30,362 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:14:30,362 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:30,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:30,834 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:14:30,836 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:14:32,212 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:14:39,474 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:14:39,882 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:14:40,315 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:41,123 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:14:41,123 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:43,600 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 171
2025-11-17 10:14:43,600 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:44,285 - ispa_next.appointments.models - DEBUG - Appointment Mouhamad Males LIP-M 153 WBAVC31000VC37149 ohne Termin.
2025-11-17 10:14:44,292 - ispa_next.main - DEBUG - 



2025-11-17 10:14:44,292 - ispa_next.main - DEBUG - starting with process 4 (LIP-QV 657) of 12
2025-11-17 10:14:44,297 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:14:45,103 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:14:46,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:14:46,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-17 10:14:47,880 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:14:47,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:59,532 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:14:59,540 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:14:59,542 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:00,021 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:15:00,022 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:02,223 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 171
2025-11-17 10:15:02,225 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:02,944 - ispa_next.appointments.models - DEBUG - Appointment Mouhamad Males LIP-M 153 WBAVC31000VC37149 ohne Termin.
2025-11-17 10:15:02,951 - ispa_next.main - DEBUG - 



2025-11-17 10:15:02,951 - ispa_next.main - DEBUG - starting with process 5 (LIP-GD-24E) of 12
2025-11-17 10:15:02,954 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:04,185 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:05,323 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 462
2025-11-17 10:15:05,324 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-17 10:15:06,729 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:06,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:34,715 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:15:44,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:48,086 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:15:48,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:48,163 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:48,333 - ispa_next.functions - DEBUG - HU date already expired after 705 days.
2025-11-17 10:15:54,663 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:15:54,665 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:15:54,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:54,747 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:15:57,846 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:57,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:59,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:01,068 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:01,204 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:04,434 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:04,551 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:04,553 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:15,764 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:16:16,785 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:16:16,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:17,299 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:28,994 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:16:28,994 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:16:36,273 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:16:36,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:36,373 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:36,373 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:16:36,434 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:16:37,641 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:16:37,861 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:16:39,867 - ispa_next.functions - DEBUG - Updated appointment (AA00044683) customer contact data.
2025-11-17 10:16:40,793 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:16:40,793 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:16:41,514 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:16:41,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:16:42,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:16:45,736 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:45,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:46,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:48,215 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:48,335 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:48,429 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:48,499 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:48,499 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:59,725 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:17:59,727 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:18:10,656 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:18:17,902 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:18:17,902 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:18:22,074 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:18:23,080 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:18:23,083 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:18:23,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:23,185 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:18:23,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:24,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:24,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:24,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:24,776 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:18:30,047 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:18:30,048 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:18:31,034 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:18:31,036 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:31,039 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:18:31,041 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:18:31,042 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=HU/AU Dekra Lemgo, source=from_tab, target=cart)}
2025-11-17 10:18:31,042 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:18:31,044 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:18:31,046 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:18:31,055 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 10:18:31,060 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:18:31,065 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:18:31,066 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:18:31,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:18:32,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:18:40,036 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:18:40,036 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:18:42,507 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:43,041 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:43,622 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:18:45,155 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:45,679 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:46,220 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:18:47,674 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:48,206 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:48,728 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:18:50,219 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:50,748 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:51,289 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:18:52,799 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:53,323 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:53,858 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:18:55,410 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:55,931 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:56,463 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 10:18:57,897 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:18:58,455 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:18:59,009 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:18:59,920 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:00,471 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:01,008 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:01,933 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:02,482 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:03,024 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:04,005 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:04,615 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:05,136 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:06,057 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:07,131 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:08,076 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:08,654 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:19:10,984 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:11,506 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:12,419 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:13,048 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:13,629 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:14,600 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:15,160 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:15,712 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:16,621 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:17,204 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:17,730 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:18,640 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:19,221 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:19,742 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:20,654 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:21,240 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:21,854 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:23,705 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:24,285 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:24,818 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:25,747 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:26,307 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:26,843 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:27,806 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:28,386 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:28,906 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:19:29,814 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:30,852 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:19:31,777 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:19:32,319 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:19:32,327 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:19:32,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:38,418 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:19:40,597 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:19:40,599 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:19:40,601 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:46,635 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:19:46,637 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:19:46,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:19:47,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:19:47,317 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:00,626 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:20:00,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:06,680 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:20:06,681 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:20:07,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:20:07,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:20:07,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:17,589 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:21,672 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:25,576 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:29,719 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:33,559 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:37,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:42,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:47,264 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:20:47,266 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:20:47,266 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:20:47,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:20:48,037 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:20:48,038 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:20:49,878 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:20:58,191 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:20:58,566 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:20:59,225 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:20:59,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:20:59,807 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:21:02,869 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:21:02,870 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:21:03,668 - ispa_next.appointments.models - DEBUG - Appointment Monika Kiehn LIP-MW 147 WBA31EE0805W15640 ohne Termin.
2025-11-17 10:21:03,674 - ispa_next.main - DEBUG - Found new Appointment: LIP-M 153
2025-11-17 10:21:03,676 - ispa_next.main - DEBUG - 



2025-11-17 10:21:03,676 - ispa_next.main - DEBUG - starting with process 6 (LIP-M 153) of 13
2025-11-17 10:21:03,679 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:04,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:21:05,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:21:05,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:21:07,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:21:07,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:21:39,243 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:21:48,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:48,816 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:48,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:50,216 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:21:50,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:50,286 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:50,451 - ispa_next.functions - DEBUG - HU date already expired after 6914 days.
2025-11-17 10:21:56,625 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:21:56,627 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:21:56,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:56,697 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:05,658 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:05,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:06,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:08,782 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:22:13,811 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:22:20,836 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:22:21,841 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:22:21,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:22,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:36,052 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:22:43,374 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:22:43,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:43,462 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:43,463 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:22:43,510 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:22:43,677 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:22:44,547 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:22:45,815 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:22:46,185 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:22:48,876 - ispa_next.functions - DEBUG - Updated appointment (AA00044722) customer contact data.
2025-11-17 10:22:49,899 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:22:49,903 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:22:50,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:22:50,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:22:52,471 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:22:52,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:22:52,592 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:22:56,825 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:22:56,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:56,825 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:22:56,827 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:22:56,829 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:22:56,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:57,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:57,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:58,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:58,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:59,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:59,014 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:23:00,982 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:23:00,995 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:23:02,078 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:23:02,080 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:02,084 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:23:02,088 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:23:02,089 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:23:02,090 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:02,092 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:23:02,093 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:23:02,094 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:23:02,096 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:23:02,096 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:23:02,098 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:23:02,100 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:23:02,101 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:23:02,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:04,058 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:23:04,060 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:23:04,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:06,047 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:23:06,048 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:23:06,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:23:06,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:23:06,856 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:23:06,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:08,747 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:23:08,749 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:23:09,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:09,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:23:09,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:23:15,486 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:19,542 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:23:19,544 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:23:19,544 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:20,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:23:20,287 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:23:20,288 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:23:21,970 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:23:30,340 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:23:30,720 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:23:31,299 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:31,937 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:23:31,937 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:35,086 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:23:35,086 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:35,967 - ispa_next.main - DEBUG - Found new Appointment: LIP-MW 147
2025-11-17 10:23:35,968 - ispa_next.main - DEBUG - 



2025-11-17 10:23:35,969 - ispa_next.main - DEBUG - starting with process 7 (LIP-MW 147) of 14
2025-11-17 10:23:35,971 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:37,026 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:38,326 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:23:38,327 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:23:39,869 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:39,870 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:24:08,081 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:24:18,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:21,101 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:24:21,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:21,185 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:21,367 - ispa_next.functions - DEBUG - HU date already expired after 698 days.
2025-11-17 10:24:28,494 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:24:28,496 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:24:28,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:28,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:31,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:31,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:32,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:34,794 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:34,895 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:38,122 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:38,189 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:38,189 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:24:49,609 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:24:50,613 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:24:50,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:51,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:03,318 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:25:10,621 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:25:10,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:10,698 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:25:10,700 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:25:10,730 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:25:11,939 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:25:13,332 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:25:13,589 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:25:16,861 - ispa_next.functions - DEBUG - Updated appointment (AA00044725) customer contact data.
2025-11-17 10:25:17,794 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:25:17,794 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:25:18,416 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:25:18,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:25:19,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:25:22,605 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:25:22,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:23,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:25,091 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:25:25,252 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:25:25,333 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:25:25,409 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:25:25,409 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:25:36,102 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:25:43,302 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:25:43,302 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:25:47,472 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:25:48,479 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:25:48,481 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:25:48,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:48,602 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:25:58,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:58,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:58,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:59,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:59,636 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:26:02,104 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:26:02,110 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:26:03,253 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:26:03,255 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:26:03,257 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:26:03,257 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:26:03,259 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:26:03,259 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:26:03,266 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:26:03,269 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:26:03,272 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:26:03,274 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:26:03,276 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:26:03,278 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:26:03,280 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:26:03,280 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:26:03,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:05,889 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:26:05,889 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:26:05,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:08,617 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:26:08,619 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:26:08,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:26:09,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:26:09,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:24,839 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:26:24,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:27,431 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:26:27,431 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:26:27,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:26:28,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:26:28,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:34,715 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:26:38,138 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:26:42,615 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:26:42,616 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:26:42,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:43,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:26:43,093 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:26:43,095 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:26:44,455 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:26:51,995 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:26:52,374 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:26:53,165 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:53,806 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:26:53,808 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:26:57,034 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:26:57,035 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:26:57,897 - ispa_next.main - DEBUG - 



2025-11-17 10:26:57,897 - ispa_next.main - DEBUG - starting with process 8 (WAK E 11) of 14
2025-11-17 10:26:57,902 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:58,814 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:26:59,744 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:26:59,745 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:27:01,151 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:27:01,153 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:27:31,421 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:27:40,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:44,069 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:27:44,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:44,228 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:44,400 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:27:44,401 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:27:44,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:44,491 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:27:47,493 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:27:47,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:48,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:50,740 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:27:50,892 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:27:54,129 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:27:54,196 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:27:54,197 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:28:05,568 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:28:06,572 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:28:06,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:07,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:10,233 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:28:10,237 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:28:10,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:10,299 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:10,299 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:28:10,378 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:28:11,500 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:28:11,717 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:28:13,805 - ispa_next.functions - DEBUG - Updated appointment (AJ00014913) customer contact data.
2025-11-17 10:28:14,718 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:28:14,718 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:28:15,275 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:28:15,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:28:16,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:28:19,635 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:28:19,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:20,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:22,119 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:28:22,232 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:28:22,313 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:28:22,399 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:28:22,399 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:28:33,627 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:29:33,630 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:29:44,903 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:29:51,889 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:29:51,889 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:29:56,415 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:29:57,423 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:29:57,429 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:29:57,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:29:57,525 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:30:06,662 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:30:21,497 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:30:21,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:22,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:22,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:23,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:30:23,137 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:30:26,180 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:30:26,180 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:30:27,176 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:30:27,177 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:30:27,179 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:30:27,179 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:30:27,181 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:30:27,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:30:27,183 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:30:27,185 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:30:27,185 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:30:27,187 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:30:27,189 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:30:27,191 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:30:27,193 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:30:47,823 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:30:47,824 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:30:53,422 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:30:53,422 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:30:53,424 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:57,342 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:30:57,344 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:30:57,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:01,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:01,401 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:31:10,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:24,187 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:31:24,188 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:31:24,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:31:24,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:31:25,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:31,928 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:31:31,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:36,025 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:31:36,026 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:31:36,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:31:37,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:31:37,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:45,555 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:50,387 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:31:50,387 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:31:50,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:31:50,917 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:31:50,919 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:31:53,717 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:32:00,332 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:32:00,718 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:32:01,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:02,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:32:02,307 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:05,049 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:32:05,050 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:05,712 - ispa_next.main - DEBUG - 



2025-11-17 10:32:05,712 - ispa_next.main - DEBUG - starting with process 9 (LIP-KR 1965) of 14
2025-11-17 10:32:05,716 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:06,614 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:07,429 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:32:07,431 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:32:08,584 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:08,585 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:20,870 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:32:20,881 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:32:20,890 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:21,458 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:32:21,460 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:24,071 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:32:24,072 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:24,848 - ispa_next.main - DEBUG - 



2025-11-17 10:32:24,848 - ispa_next.main - DEBUG - starting with process 10 (LIP-JL 179) of 14
2025-11-17 10:32:24,851 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:26,103 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:32:27,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:32:27,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:32:28,635 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:32:28,636 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:59,683 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:33:10,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:14,660 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:33:14,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:14,725 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:15,019 - ispa_next.functions - DEBUG - HU date already expired after 1390 days.
2025-11-17 10:33:41,744 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:33:41,772 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:33:41,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:41,908 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:52,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:33:52,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:33:53,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:55,523 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:33:55,622 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:33:58,821 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:33:58,888 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:33:58,888 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:10,465 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:34:11,469 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:34:11,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:11,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:23,958 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:34:32,381 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:34:32,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:34:32,506 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:34:32,508 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:34:32,540 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:34:33,809 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:34:35,192 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:34:35,472 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:34:38,213 - ispa_next.functions - DEBUG - Updated appointment (AL00010313) customer contact data.
2025-11-17 10:34:39,128 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:34:39,150 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:34:40,004 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:34:40,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:34:40,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:34:44,444 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:34:44,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:44,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:46,971 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:34:47,102 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:34:47,250 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:34:47,350 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:34:47,350 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:58,677 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:35:58,681 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:09,463 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:36:16,889 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:36:16,889 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:36:19,000 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:36:20,006 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:36:20,008 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:36:20,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:20,074 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:36:20,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:20,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:36:20,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:21,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:36:21,599 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:36:26,924 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:36:26,926 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:36:28,244 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:36:28,246 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:36:28,246 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:36:28,248 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart)}
2025-11-17 10:36:28,250 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:36:28,252 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:36:28,252 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:36:28,254 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:36:28,256 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:36:28,260 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:36:28,264 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:36:28,268 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:36:58,007 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:36:58,009 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:36:58,011 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:36:58,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:04,843 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:37:07,757 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:37:07,782 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:37:07,786 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:14,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:14,749 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:26,348 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:37:26,350 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:37:26,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:37:27,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:37:27,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:41,565 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:37:41,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:48,342 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:37:48,344 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:37:48,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:37:49,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:37:49,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:00,934 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:38:06,875 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:38:06,875 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:38:07,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:07,462 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:38:07,464 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:38:10,359 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:38:17,736 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 10:38:17,738 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:38:17,740 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:38:18,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:18,394 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:38:18,395 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:38:19,844 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 10:38:19,871 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:38:22,433 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:38:22,437 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:38:23,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:38:23,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:38:26,276 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:38:26,277 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:38:26,956 - ispa_next.main - DEBUG - 



2025-11-17 10:38:26,957 - ispa_next.main - DEBUG - starting with process 11 (LIP-L 0921) of 14
2025-11-17 10:38:26,965 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:38:28,227 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:38:29,146 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:38:29,147 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:38:30,594 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:38:30,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:38:42,612 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:38:42,636 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:38:42,652 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:38:43,057 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:38:43,059 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:38:45,079 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-17 10:38:45,080 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:38:45,822 - ispa_next.main - DEBUG - 



2025-11-17 10:38:45,822 - ispa_next.main - DEBUG - starting with process 12 (HX PA 5010) of 14
2025-11-17 10:38:45,825 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:38:46,632 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:38:47,581 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 463
2025-11-17 10:38:47,582 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-17 10:38:48,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:38:48,896 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:19,612 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:39:30,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:34,486 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:39:34,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:34,596 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:39:34,783 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:39:34,787 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:39:34,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:34,866 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:39:38,061 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:39:38,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:39,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:41,904 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:39:42,287 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:39:45,539 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:39:45,611 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:39:45,611 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:39:56,758 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:39:57,762 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:39:57,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:58,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:00,955 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:40:00,959 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:40:00,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:40:01,036 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:40:01,036 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:40:01,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:40:02,277 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:40:02,518 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:40:05,054 - ispa_next.functions - DEBUG - Updated appointment (AJ00014911) customer contact data.
2025-11-17 10:40:06,038 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:40:06,041 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:40:06,892 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:40:06,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:40:07,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:40:11,288 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:40:11,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:40:11,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:13,798 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:40:13,913 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:40:14,072 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:40:14,185 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:40:14,185 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:40:25,956 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:41:25,958 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:41:37,185 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:41:44,415 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:41:44,415 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:41:48,624 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:41:49,630 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:41:49,634 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:41:49,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:49,717 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:41:53,893 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:42:07,993 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:42:08,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:09,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:42:09,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:42:10,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:42:10,364 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:42:15,185 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:42:15,187 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:42:16,254 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:42:16,258 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:16,262 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:42:16,264 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:42:16,266 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 10:42:16,268 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:42:16,270 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:42:16,272 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:42:16,272 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:42:16,274 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:42:16,274 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:42:16,276 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:42:16,278 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:42:36,978 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:42:36,979 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 10:42:43,711 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:42:43,713 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:42:43,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:49,803 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:42:49,805 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:42:49,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:42:55,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:42:56,006 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:43:05,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:21,184 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:43:21,186 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:43:21,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:43:21,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:43:22,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:35,332 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:43:35,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:41,441 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:43:41,443 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:43:41,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:43:42,513 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:43:42,692 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:53,629 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:43:59,244 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:44:05,795 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:44:05,797 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:44:06,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:44:06,558 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:44:06,560 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:44:10,082 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:44:19,403 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:44:19,774 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:44:21,030 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:44:21,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 464
2025-11-17 10:44:21,588 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:44:24,669 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 174
2025-11-17 10:44:24,669 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:25,532 - ispa_next.appointments.models - DEBUG - Appointment   WBA71AA0205P51150 ohne Termin.
2025-11-17 10:44:25,541 - ispa_next.main - DEBUG - 



2025-11-17 10:44:25,542 - ispa_next.main - DEBUG - starting with process 13 (Lip-qz 95 e) of 14
2025-11-17 10:44:25,545 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:44:26,865 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:44:28,185 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 464
2025-11-17 10:44:28,186 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 174
2025-11-17 10:44:29,546 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:44:29,550 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:49,279 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:44:49,291 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:44:49,296 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:44:49,620 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 464
2025-11-17 10:44:49,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:44:52,063 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 174
2025-11-17 10:44:52,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:44:52,930 - ispa_next.appointments.models - DEBUG - Appointment   WBA71AA0205P51150 ohne Termin.
2025-11-17 10:44:52,938 - ispa_next.main - DEBUG - 



2025-11-17 10:44:52,938 - ispa_next.main - DEBUG - starting with process 14 (LIP-KS 331) of 14
2025-11-17 10:44:52,940 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:44:54,063 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:44:55,155 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 464
2025-11-17 10:44:55,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 174
2025-11-17 10:44:56,591 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:44:56,592 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:45:26,099 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:45:36,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:36,612 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:36,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:45:39,344 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:45:39,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:39,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:39,607 - ispa_next.functions - DEBUG - HU date already expired after 611 days.
2025-11-17 10:45:47,259 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:45:47,262 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:45:47,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:45:47,343 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:45:50,641 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:45:50,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:45:52,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:45:54,110 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:45:54,294 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:45:57,535 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:45:57,625 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:45:57,627 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:09,139 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:46:10,144 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:46:10,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:10,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:20,702 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:46:27,690 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:46:27,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:27,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:46:27,760 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:46:27,802 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:46:28,993 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:46:29,221 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:46:32,566 - ispa_next.functions - DEBUG - Updated appointment (AF00021422) customer contact data.
2025-11-17 10:46:33,488 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:46:33,490 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:46:34,029 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:46:34,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:46:35,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:46:39,311 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:46:39,311 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:46:39,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:39,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:46:41,798 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:46:41,905 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:46:42,016 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:46:42,073 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:46:42,074 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:53,409 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:47:53,413 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:48:04,789 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:48:12,327 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:48:12,328 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:48:16,528 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:48:17,581 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:48:17,586 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:48:17,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:48:17,678 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:48:25,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:26,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:48:26,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:48:26,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:48:26,756 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:48:30,934 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:48:30,936 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:48:31,981 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:48:31,983 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:48:31,985 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 10:48:31,987 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 10:48:31,987 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:48:31,989 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:48:31,991 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:48:31,991 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:48:31,992 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:48:31,993 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:48:31,995 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:48:31,997 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:48:31,998 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:48:32,000 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:48:32,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:36,693 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:48:39,615 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:48:39,617 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:48:39,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:44,621 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:48:44,623 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:48:44,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:48:45,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:48:45,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:10,326 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:49:10,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:15,074 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:49:15,076 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:49:15,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:49:16,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:49:16,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:25,997 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:29,923 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:34,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:39,380 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:44,728 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:49,341 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:49:49,343 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:49:49,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:49:50,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:49:50,139 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:49:50,141 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:49:52,113 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:49:59,863 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:50:00,270 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 10:50:01,649 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:50:02,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 464
2025-11-17 10:50:02,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:50:05,962 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 174
2025-11-17 10:50:05,963 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:50:06,830 - ispa_next.appointments.models - DEBUG - Appointment   WBA71AA0205P51150 ohne Termin.
