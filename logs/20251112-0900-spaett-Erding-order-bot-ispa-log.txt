2025-11-12 09:14:34,726 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:14:34,734 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:14:45,275 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:14:55,758 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:15:11,340 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:15:35,625 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:15:47,276 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:15:51,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:15:52,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 563
2025-11-12 09:15:52,452 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 374
2025-11-12 09:15:54,744 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 09:15:54,745 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:15:54,746 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:15:55,863 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:15:56,997 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:47,766 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:47,774 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:47,786 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-12 09:16:47,800 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-12 09:16:47,812 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-12 09:16:47,831 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-12 09:16:47,843 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 09:16:47,854 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 09:16:47,866 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Fiedler ED-F 1818 WBA25DP090N149286 ohne Termin.
2025-11-12 09:16:47,879 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-12 09:16:47,880 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:47,892 - ispa_next.appointments.models - DEBUG - Appointment Sami Polat ED-N 4423 WBA21BY0907N23883 ohne Termin.
2025-11-12 09:16:47,898 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:47,909 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-12 09:16:47,922 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-12 09:16:47,936 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-12 09:16:47,942 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:47,957 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-12 09:16:47,967 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-12 09:16:47,973 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:47,995 - ispa_next.appointments.models - DEBUG - Appointment Josefine Hintermeier ED-AD 71 WMWZM31080T767604 ohne Termin.
2025-11-12 09:16:48,010 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-12 09:16:48,017 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:48,036 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-12 09:16:48,054 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-12 09:16:48,069 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-12 09:16:48,070 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:48,080 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-12 09:16:48,093 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-12 09:16:48,104 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-12 09:16:48,106 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:48,120 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-12 09:16:48,150 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-12 09:16:48,160 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-12 09:16:48,171 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-12 09:16:48,195 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-12 09:16:48,209 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-12 09:16:48,226 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-12 09:16:48,240 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-12 09:16:48,250 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-12 09:16:48,260 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-12 09:16:48,280 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-12 09:16:48,290 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-12 09:16:48,302 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-12 09:16:48,314 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-12 09:16:48,314 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:16:48,325 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-12 09:16:48,335 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-12 09:16:48,345 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-12 09:16:48,355 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-12 09:16:48,368 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-12 09:16:48,378 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-12 09:16:48,387 - ispa_next.appointments.models - DEBUG - Appointment Eduard Gehl FS-EG 174 WBAJN31090B095696 ohne Termin.
2025-11-12 09:16:48,399 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-12 09:16:48,433 - ispa_next.main - DEBUG - Found 20 out of 151 appointments to process (configured limit: 20).
2025-11-12 09:16:48,433 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 09:16:48,434 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 09:16:48,434 - ispa_next.main - DEBUG - All appointments: ED-PS 1206, ED-VJ 188 E, FS-MS 633, ED-RG133, ED-DY 9 E, EBE-GK 406, ED M 2304, ED RU 101, FS-I 4702, MNK3076, ED-MH-171, ED-A1024, ED-K2010, ED-AL59, M-ED-2001, EBE-AB 202, ED-CT 178, ED-O 1909, ED-RD 212, ED-WI 283
2025-11-12 09:16:48,436 - ispa_next.main - DEBUG - 



2025-11-12 09:16:48,436 - ispa_next.main - DEBUG - starting with process 1 (ED-PS 1206) of 20
2025-11-12 09:16:48,440 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:16:49,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:50,591 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 563
2025-11-12 09:16:50,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 09:16:51,997 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:51,998 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:17:16,936 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:17:26,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:29,041 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:17:29,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:29,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:29,293 - ispa_next.functions - DEBUG - HU date already expired after 293 days.
2025-11-12 09:17:35,979 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:17:35,984 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:17:38,690 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:17:38,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:39,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:41,658 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:17:41,760 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:17:45,027 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:17:45,120 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:17:47,288 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:17:48,293 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:17:48,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:48,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:02,488 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:18:09,417 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:18:09,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:09,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:18:09,488 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:18:09,531 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:18:09,628 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:18:10,741 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:18:11,938 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:18:12,268 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:18:15,511 - ispa_next.functions - DEBUG - Updated appointment (AA00022522) customer contact data.
2025-11-12 09:18:16,440 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:18:16,442 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:18:16,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:18:17,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:18:18,908 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:18:18,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:18:18,990 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:18:22,605 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:18:22,605 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:18:22,626 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:18:22,631 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:18:22,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:18:23,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:18:23,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:24,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:24,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:18:24,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:18:24,859 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:18:27,335 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:18:27,336 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:18:28,678 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:18:28,680 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:18:28,681 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:18:28,682 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:18:28,684 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:18:28,685 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:18:28,686 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:18:28,687 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:18:28,688 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:18:28,690 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:18:28,693 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:18:28,697 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:18:28,698 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:31,326 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:18:31,329 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:18:31,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:33,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:18:34,066 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:18:45,730 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:18:45,733 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:18:45,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:18:46,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:18:46,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:56,350 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:18:56,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:58,878 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:19:09,368 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:19:09,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:19:10,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:19:10,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:35,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:19:39,651 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:19:44,526 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:19:44,527 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:19:44,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:19:45,052 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:19:45,055 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:19:47,600 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:19:58,344 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:19:58,718 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:19:59,283 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:01,098 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:20:01,100 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:03,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 374
2025-11-12 09:20:03,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:04,155 - ispa_next.main - DEBUG - 



2025-11-12 09:20:04,156 - ispa_next.main - DEBUG - starting with process 2 (ED-VJ 188 E) of 20
2025-11-12 09:20:04,159 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:20:05,126 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:06,030 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:20:06,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 374
2025-11-12 09:20:07,157 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:07,158 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:45,767 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:20:45,867 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:20:45,872 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:46,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:20:46,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:48,742 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 374
2025-11-12 09:20:48,743 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:49,559 - ispa_next.main - DEBUG - 



2025-11-12 09:20:49,559 - ispa_next.main - DEBUG - starting with process 3 (FS-MS 633) of 20
2025-11-12 09:20:49,563 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:20:50,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:52,025 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:20:52,026 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 374
2025-11-12 09:20:53,335 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:53,337 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:22,215 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:21:22,227 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:21:22,232 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:22,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:21:22,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:24,988 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 374
2025-11-12 09:21:24,989 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:25,720 - ispa_next.main - DEBUG - 



2025-11-12 09:21:25,720 - ispa_next.main - DEBUG - starting with process 4 (ED-RG133) of 20
2025-11-12 09:21:25,725 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:26,580 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:27,834 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:21:27,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 374
2025-11-12 09:21:29,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:29,244 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:59,116 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:21:59,124 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:21:59,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:59,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:21:59,551 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:02,119 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 374
2025-11-12 09:22:02,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:02,941 - ispa_next.main - DEBUG - 



2025-11-12 09:22:02,941 - ispa_next.main - DEBUG - starting with process 5 (ED-DY 9 E) of 20
2025-11-12 09:22:02,945 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:04,089 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:05,322 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:22:05,322 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 374
2025-11-12 09:22:06,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:06,712 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:37,598 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:22:37,608 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:22:37,611 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:37,951 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:22:37,957 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:40,185 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 374
2025-11-12 09:22:40,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:40,960 - ispa_next.main - DEBUG - 



2025-11-12 09:22:40,960 - ispa_next.main - DEBUG - starting with process 6 (EBE-GK 406) of 20
2025-11-12 09:22:40,965 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:41,837 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:43,144 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:22:43,146 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 374
2025-11-12 09:22:44,559 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:44,561 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:23:05,321 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:23:14,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:16,931 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:23:16,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:17,036 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:17,278 - ispa_next.functions - DEBUG - HU date already expired after 74 days.
2025-11-12 09:23:24,412 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:23:24,416 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:23:27,124 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:27,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:28,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:30,347 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:23:30,528 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:23:33,804 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:23:33,886 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:23:33,886 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:23:42,506 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:23:43,513 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:23:43,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:44,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:57,499 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:24:03,871 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:24:03,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:03,950 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:24:03,950 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:24:03,986 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:24:05,216 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:24:05,473 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:24:08,264 - ispa_next.functions - DEBUG - Updated appointment (AA00022404) customer contact data.
2025-11-12 09:24:09,155 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:24:09,159 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:24:09,926 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:24:09,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:24:10,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:24:14,679 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:24:14,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:24:15,257 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:24:17,264 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:24:17,372 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:24:17,476 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:24:17,547 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:24:17,547 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:24:26,252 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:25:26,255 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:25:37,677 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:25:41,726 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:25:41,726 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:25:45,907 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:25:46,915 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:25:46,919 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:25:46,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:47,057 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:25:47,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:47,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:47,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:48,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:48,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:25:50,588 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:25:50,590 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:25:51,766 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:25:51,768 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:25:51,771 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:25:51,772 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:25:51,773 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:25:51,774 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:25:51,775 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:25:51,776 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:25:51,777 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:25:51,778 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:25:51,782 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:25:51,785 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:25:51,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:53,707 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:25:53,709 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:25:53,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:55,651 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:25:55,654 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:25:55,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:25:56,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:25:56,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:04,461 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:26:04,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:06,379 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:26:17,632 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:26:18,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:26:18,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:26:18,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:36,270 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:26:39,929 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:26:39,932 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:26:39,933 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:40,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:26:40,462 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:26:40,464 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:26:42,350 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:26:50,110 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:26:50,494 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:26:50,854 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:52,023 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:26:52,025 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:54,502 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:26:54,503 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:55,377 - ispa_next.main - DEBUG - 



2025-11-12 09:26:55,377 - ispa_next.main - DEBUG - starting with process 7 (ED M 2304) of 20
2025-11-12 09:26:55,381 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:56,533 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:57,725 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:26:57,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:26:59,045 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:59,046 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:38,077 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:27:38,086 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:27:38,089 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:27:38,508 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:27:38,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:27:40,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:27:40,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:41,718 - ispa_next.main - DEBUG - 



2025-11-12 09:27:41,718 - ispa_next.main - DEBUG - starting with process 8 (ED RU 101) of 20
2025-11-12 09:27:41,725 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:27:42,847 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:27:43,913 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:27:43,914 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:27:45,345 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:27:45,346 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:16,121 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:28:16,132 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:28:16,136 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:16,620 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:28:16,621 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:18,996 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:28:18,997 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:19,725 - ispa_next.main - DEBUG - 



2025-11-12 09:28:19,725 - ispa_next.main - DEBUG - starting with process 9 (FS-I 4702) of 20
2025-11-12 09:28:19,731 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:20,632 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:21,420 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:28:21,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:28:22,552 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:22,553 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:43,728 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:28:52,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:54,074 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:28:54,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:54,148 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:28:54,344 - ispa_next.functions - DEBUG - HU date already expired after 286 days.
2025-11-12 09:29:00,166 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:29:00,169 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:29:02,843 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:29:02,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:03,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:05,894 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:29:06,009 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:29:09,237 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:29:09,296 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:29:09,297 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:29:17,750 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:29:18,755 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:29:18,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:19,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:30,686 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:29:38,245 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:29:38,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:38,329 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:38,330 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:29:38,396 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:29:39,620 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:29:40,752 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:29:40,965 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:29:44,184 - ispa_next.functions - DEBUG - Updated appointment (AA00022312) customer contact data.
2025-11-12 09:29:45,112 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:29:45,115 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:29:45,711 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:29:45,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:29:46,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:29:50,036 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:29:50,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:50,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:52,554 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:29:52,648 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:29:52,737 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:29:52,834 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:29:52,835 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:30:03,691 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:30:07,873 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:30:07,873 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:30:12,094 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:30:13,111 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:30:13,115 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:30:13,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:13,224 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:30:13,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:14,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:14,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:14,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:14,925 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:30:16,283 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:30:16,285 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:30:17,475 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:30:17,479 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:17,481 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:30:17,483 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:17,484 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:30:17,487 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:30:17,488 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:30:17,489 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:30:17,490 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:30:17,491 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:30:17,494 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:30:17,497 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:30:17,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:18,724 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:30:18,726 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:30:18,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:19,935 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:30:19,939 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:30:19,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:30:20,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:30:21,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:29,656 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:30:29,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:30,890 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:30:42,365 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:30:42,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:30:43,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:30:43,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:54,753 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:30:54,756 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:30:54,756 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:55,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:30:55,479 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:30:55,482 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:30:57,345 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:31:04,418 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:31:04,803 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:31:05,075 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:07,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:31:07,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:09,740 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:31:09,741 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:10,376 - ispa_next.main - DEBUG - 



2025-11-12 09:31:10,376 - ispa_next.main - DEBUG - starting with process 10 (MNK3076) of 20
2025-11-12 09:31:10,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:11,446 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:12,616 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:31:12,618 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:31:13,982 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:13,983 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:45,466 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:31:45,475 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:31:45,479 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:45,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:31:45,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:47,791 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:31:47,792 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:48,480 - ispa_next.main - DEBUG - 



2025-11-12 09:31:48,480 - ispa_next.main - DEBUG - starting with process 11 (ED-MH-171) of 20
2025-11-12 09:31:48,486 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:49,426 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:50,275 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:31:50,276 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:31:51,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:51,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:22,348 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:32:22,359 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:32:22,364 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:22,814 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:32:22,815 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:25,311 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:32:25,312 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:26,098 - ispa_next.main - DEBUG - 



2025-11-12 09:32:26,098 - ispa_next.main - DEBUG - starting with process 12 (ED-A1024) of 20
2025-11-12 09:32:26,108 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:27,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:28,501 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:32:28,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:32:30,085 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:30,086 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:01,565 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:33:01,574 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:33:01,581 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:01,869 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:33:01,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:04,220 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:33:04,220 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:05,029 - ispa_next.main - DEBUG - 



2025-11-12 09:33:05,029 - ispa_next.main - DEBUG - starting with process 13 (ED-K2010) of 20
2025-11-12 09:33:05,033 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:33:06,179 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:07,343 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:33:07,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:33:08,761 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:08,763 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:39,921 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:33:39,932 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:33:39,936 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:40,435 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:33:40,436 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:42,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:33:42,942 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:43,775 - ispa_next.main - DEBUG - 



2025-11-12 09:33:43,775 - ispa_next.main - DEBUG - starting with process 14 (ED-AL59) of 20
2025-11-12 09:33:43,782 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:33:45,006 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:46,083 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:33:46,085 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:33:47,438 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:47,439 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:19,107 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:34:19,117 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:34:19,131 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:19,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:34:19,654 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:22,238 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:34:22,239 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:23,350 - ispa_next.main - DEBUG - 



2025-11-12 09:34:23,350 - ispa_next.main - DEBUG - starting with process 15 (M-ED-2001) of 20
2025-11-12 09:34:23,355 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:34:24,617 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:25,907 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:34:25,908 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:34:27,337 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:34:27,339 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:59,140 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:34:59,151 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 09:34:59,156 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:34:59,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:34:59,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:35:02,244 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 372
2025-11-12 09:35:02,245 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:35:03,101 - ispa_next.main - DEBUG - 



2025-11-12 09:35:03,101 - ispa_next.main - DEBUG - starting with process 16 (EBE-AB 202) of 20
2025-11-12 09:35:03,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:35:04,228 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:35:05,438 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 562
2025-11-12 09:35:05,439 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 372
2025-11-12 09:35:06,692 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:35:06,694 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:35:29,795 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:35:31,266 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:35:36,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:37,515 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:35:37,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:37,636 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:35:37,810 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:35:37,815 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:35:40,706 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:35:40,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:41,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:43,865 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:35:43,970 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:35:44,095 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:35:44,166 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:35:48,338 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:35:49,344 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:35:49,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:49,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:00,582 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:36:00,583 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:36:03,796 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:36:03,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:03,880 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:36:03,881 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:36:03,951 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:36:04,096 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:36:05,320 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:36:05,581 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:36:07,233 - ispa_next.functions - DEBUG - Updated appointment (AB00024097) customer contact data.
2025-11-12 09:36:08,154 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:36:08,156 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:36:08,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:36:09,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:36:10,098 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:36:10,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:36:10,200 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:36:14,305 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 09:36:14,305 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:36:14,305 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:36:14,309 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:36:14,313 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:36:14,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:14,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:15,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:15,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:15,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:16,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:16,412 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:36:17,690 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:36:17,695 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:36:19,125 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:36:19,130 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:36:19,132 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:36:19,133 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:36:19,136 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:36:19,137 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:36:19,138 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:36:19,139 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:36:19,140 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:36:19,141 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:36:19,144 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:36:19,147 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:36:19,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:20,322 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:36:20,325 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:36:20,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:21,495 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:36:21,498 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:36:21,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:36:22,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:36:22,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:29,892 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:36:29,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:31,125 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:36:41,542 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:36:41,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:36:42,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:36:42,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:54,312 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:36:54,315 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:36:54,316 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:36:54,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:36:55,037 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:36:55,040 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:36:56,810 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:37:04,054 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:37:04,424 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 09:37:04,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:37:06,402 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:37:06,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:37:09,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 09:37:09,340 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:37:10,052 - ispa_next.main - DEBUG - 



2025-11-12 09:37:10,052 - ispa_next.main - DEBUG - starting with process 17 (ED-CT 178) of 20
2025-11-12 09:37:10,057 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:37:10,819 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:37:11,685 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:37:11,686 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 09:37:12,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:37:12,879 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:37:35,125 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:37:37,006 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:37:41,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:43,882 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:37:43,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:43,948 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:44,211 - ispa_next.functions - DEBUG - HU date already expired after 591 days.
2025-11-12 09:37:48,070 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:37:48,074 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:37:50,893 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:37:50,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:51,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:37:53,952 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:37:54,091 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:37:54,225 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:37:54,326 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:37:58,524 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:37:59,529 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:37:59,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:00,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:11,084 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:38:15,006 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:38:15,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:15,086 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:38:15,087 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:38:15,116 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:38:15,232 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:38:16,310 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:38:17,643 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:38:17,944 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:38:19,717 - ispa_next.functions - DEBUG - Updated appointment (AB00024324) customer contact data.
2025-11-12 09:38:20,614 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:38:20,617 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:38:20,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:38:21,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:38:22,517 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:38:22,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:38:22,607 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:38:26,641 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:38:26,641 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:38:26,645 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:38:26,649 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:38:26,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:27,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:27,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:28,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:28,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:29,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:29,097 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:38:30,979 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:38:30,981 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:38:32,311 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:38:32,316 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:32,319 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:38:32,321 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:32,323 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:38:32,324 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:38:32,325 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:38:32,326 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:38:32,327 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:38:32,329 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:38:32,332 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:38:32,334 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:38:32,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:34,245 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:38:34,249 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:38:34,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:36,182 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:38:36,184 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:38:36,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:38:36,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:38:37,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:46,178 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:38:46,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:48,136 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:38:59,233 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:38:59,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:00,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:39:00,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:18,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:22,403 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:22,405 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:39:22,405 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:22,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:23,053 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:39:23,055 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:39:24,698 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:39:31,230 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:39:31,610 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 09:39:32,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:33,075 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:39:33,076 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:35,929 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 09:39:35,930 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:36,766 - ispa_next.main - DEBUG - 



2025-11-12 09:39:36,766 - ispa_next.main - DEBUG - starting with process 18 (ED-O 1909) of 20
2025-11-12 09:39:36,771 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:37,959 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:38,986 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:39:38,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 09:39:40,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:40,244 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:40:05,047 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:40:06,816 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:40:12,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:17,336 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:40:17,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:17,441 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:17,634 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 09:40:21,528 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:40:21,531 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:40:24,265 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:24,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:25,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:27,791 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:40:27,936 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:40:28,032 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:40:28,129 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:40:30,241 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:40:31,247 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:40:31,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:31,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:35,140 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 09:40:35,145 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:40:35,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:35,235 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:35,236 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:40:35,287 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:40:36,488 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:40:37,683 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:40:37,907 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:40:39,798 - ispa_next.functions - DEBUG - Updated appointment (AA00022415) customer contact data.
2025-11-12 09:40:40,717 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:40:40,719 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:40:41,543 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:40:41,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:42,315 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:40:45,903 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:45,903 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:40:45,907 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:40:45,911 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:40:45,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:46,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:55,810 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:41:02,829 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:41:02,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:03,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:03,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:04,613 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:04,614 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:41:09,351 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:41:09,353 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:41:10,419 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:41:10,420 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:10,422 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:41:10,423 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:10,424 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:41:10,425 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:41:10,427 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:41:10,429 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:41:10,430 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:41:10,432 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:41:10,450 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:41:10,453 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:41:10,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:15,829 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:41:15,831 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:41:15,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:21,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:21,246 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:41:30,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:45,225 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:41:45,228 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:41:45,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:41:46,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:41:46,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:58,925 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:41:58,926 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:04,308 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:42:14,459 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:42:14,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:42:15,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:42:15,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:32,004 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:42:32,004 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:42:32,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:42:32,658 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:42:32,661 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:42:35,667 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:42:43,807 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:42:44,202 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 09:42:44,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:42:46,141 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:42:46,143 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:42:49,519 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 09:42:49,519 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:42:50,143 - ispa_next.main - DEBUG - 



2025-11-12 09:42:50,143 - ispa_next.main - DEBUG - starting with process 19 (ED-RD 212) of 20
2025-11-12 09:42:50,148 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:42:51,015 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:42:51,756 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:42:51,757 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 09:42:53,096 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:42:53,097 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:43:16,099 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:43:17,578 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:43:22,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:25,105 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:43:25,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:25,210 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:25,423 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:43:25,427 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:43:28,371 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:43:28,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:29,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:43:31,497 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:43:31,632 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:43:31,736 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:43:31,831 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:43:36,051 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:43:37,058 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:43:37,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:37,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:49,327 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:43:53,665 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:43:53,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:53,739 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:53,739 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:43:53,771 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:43:53,952 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:43:55,211 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:43:55,419 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:43:57,258 - ispa_next.functions - DEBUG - Updated appointment (AB00024344) customer contact data.
2025-11-12 09:43:58,205 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:43:58,208 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:43:58,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:43:59,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:44:00,795 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:44:00,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:44:00,869 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:44:04,433 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:44:04,434 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:44:04,438 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:44:04,443 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:44:04,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:44:04,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:44:05,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:05,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:05,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:44:06,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:44:06,541 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:44:08,988 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:44:08,990 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:44:10,421 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:44:10,423 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:44:10,424 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:44:10,425 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:44:10,426 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:44:10,428 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:44:10,429 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:44:10,430 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:44:10,432 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:44:10,439 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:44:10,445 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:44:10,448 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:44:10,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:13,065 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:44:13,067 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:44:13,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:15,778 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:44:15,781 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:44:15,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:44:16,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:44:16,954 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:26,104 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:44:26,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:28,721 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:44:39,489 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:44:39,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:40,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:44:40,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:04,919 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:08,996 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:13,489 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:13,492 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:45:13,494 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:14,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:45:14,181 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:45:14,183 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:45:16,026 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:45:23,446 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:45:23,826 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 09:45:24,323 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:26,124 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:45:26,125 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:29,068 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 09:45:29,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:29,825 - ispa_next.main - DEBUG - 



2025-11-12 09:45:29,825 - ispa_next.main - DEBUG - starting with process 20 (ED-WI 283) of 20
2025-11-12 09:45:29,829 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:30,914 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:32,161 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:45:32,166 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 09:45:33,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:33,635 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:07,556 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:46:09,350 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:46:13,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:16,511 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:46:16,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:16,588 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:16,777 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:46:16,780 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:46:19,504 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:46:19,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:46:20,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:46:22,751 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:46:22,861 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:46:22,933 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:46:23,055 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:46:27,239 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:46:28,245 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:46:28,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:28,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:41,424 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:46:44,566 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:46:44,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:44,672 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:44,673 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:46:44,710 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:46:44,806 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:46:45,929 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:46:46,162 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:46:47,853 - ispa_next.functions - DEBUG - Updated appointment (AB00024334) customer contact data.
2025-11-12 09:46:48,766 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:46:48,768 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:46:48,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:46:49,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:46:50,519 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:46:50,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:46:50,603 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:46:54,214 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:46:54,214 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:46:54,218 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:46:54,223 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:46:54,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:46:54,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:46:55,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:55,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:55,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:46:56,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:46:56,296 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:46:58,821 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:46:58,823 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:47:00,253 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:47:00,254 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:47:00,255 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:47:00,256 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:47:00,258 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:47:00,259 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:47:00,260 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:47:00,261 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:47:00,262 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:47:00,264 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:47:00,269 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:47:00,272 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:47:00,273 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:02,862 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:47:02,865 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:47:02,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:05,444 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:47:05,446 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:47:05,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:47:06,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:47:06,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:16,508 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:47:16,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:19,151 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:47:30,865 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:47:31,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:47:31,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:47:32,078 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:57,010 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:48:00,835 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:48:05,602 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:48:05,605 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:48:05,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:48:06,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:48:06,268 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:48:06,270 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:48:08,122 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:48:15,572 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:48:15,950 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 09:48:16,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:48:17,632 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 09:48:17,633 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:48:21,034 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 09:48:21,035 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
