2025-11-12 11:07:37,782 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:07:37,788 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:07:53,191 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:08:03,644 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:08:18,958 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:10:17,363 - ispa_next.app_start.main - DEBUG - Operation already took 106.82 seconds (more than 80 seconds)
2025-11-12 11:10:19,426 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\17e574ce71415f04\\tess_i7mj2q11_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\17e574ce71415f04\\tess_i7mj2q11', 'txt']
2025-11-12 11:10:19,765 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 11:10:19,771 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 11:10:19,773 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:10:44,888 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:10:57,779 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:11:00,596 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:01,790 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1435
2025-11-12 11:11:01,791 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 19
2025-11-12 11:11:04,183 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 18
2025-11-12 11:11:04,184 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:11:04,185 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:11:05,203 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:11:06,050 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:08,071 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,079 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,080 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,081 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,081 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,082 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,083 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,084 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:11:08,094 - ispa_next.main - DEBUG - Found 6 out of 6 appointments to process (configured limit: 15).
2025-11-12 11:11:08,094 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 11:11:08,095 - ispa_next.main - DEBUG - Processing 2 already visited appointments (w/ RKR not callable).
2025-11-12 11:11:08,095 - ispa_next.main - DEBUG - All appointments: WI-PH 990E, WI-HD 313, WI-AF169, 0, WI-HW 385, RÜD-WP 71E
2025-11-12 11:11:08,109 - ispa_next.main - DEBUG - 



2025-11-12 11:11:08,109 - ispa_next.main - DEBUG - starting with process 1 (WI-PH 990E) of 6
2025-11-12 11:11:08,113 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:11:09,284 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:11:10,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1435
2025-11-12 11:11:10,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 18
2025-11-12 11:11:11,814 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:11:11,816 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:11:38,647 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:11:48,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:52,004 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:11:52,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:52,088 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:52,437 - ispa_next.functions - DEBUG - HU date already expired after 11 days.
2025-11-12 11:11:59,806 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:11:59,808 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:12:02,578 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:02,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:03,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:05,491 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:05,616 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:08,813 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:12:16,273 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:12:17,277 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:12:17,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:17,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:31,891 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:12:39,958 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:12:39,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:40,056 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:40,058 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:12:40,093 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:12:41,274 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:12:42,467 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:12:42,749 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:12:47,892 - ispa_next.functions - DEBUG - Updated appointment (AK00021365) customer contact data.
2025-11-12 11:12:48,807 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:12:48,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:48,971 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:12:49,107 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:12:49,108 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:12:50,032 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:12:50,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:12:50,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:12:55,470 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:12:55,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:55,989 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:57,991 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:12:58,097 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:12:58,230 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:12:58,295 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:12:58,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:02,252 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:13:10,331 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:14:10,333 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:14:18,621 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:14:39,623 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:14:51,078 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:14:55,308 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:14:55,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:15:00,623 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:15:04,840 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:15:05,847 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:15:05,847 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:15:05,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:05,977 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:15:10,090 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:15:10,911 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:15:26,576 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:15:26,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:26,801 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:15:32,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:33,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:15:33,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:15:33,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:15:33,907 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:15:38,202 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:15:38,204 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:15:39,299 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:15:39,300 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:15:39,302 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:15:39,303 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:15:39,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:15:39,306 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 11:15:39,307 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:15:39,308 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:15:39,310 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:15:39,312 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:15:39,315 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:15:40,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:15:40,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:15:43,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:15:44,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:15:57,708 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:15:57,708 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 11:16:00,470 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:01,016 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:01,935 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:02,523 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:03,061 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:03,981 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:04,600 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:05,177 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:06,134 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:06,732 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:07,265 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:08,181 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:08,794 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:09,346 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:10,274 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:10,838 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:11,372 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:12,743 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:13,379 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:13,922 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 11:16:14,854 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:15,997 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 11:16:16,967 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 11:16:17,803 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:16:17,809 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:16:17,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:22,449 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:16:26,067 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:16:26,070 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:16:26,086 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:30,873 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:16:30,875 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:16:30,884 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:16:30,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:35,529 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:16:53,594 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:16:54,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:16:55,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:16:55,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:41,254 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:46,516 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:51,651 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:58,118 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:02,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:08,517 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:08,519 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:08,519 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:09,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:09,769 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:09,770 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:12,952 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:18:28,240 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:18:28,644 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:18:30,484 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:31,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1436
2025-11-12 11:18:31,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:35,429 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:18:35,430 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:36,690 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:18:36,703 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:18:36,705 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:18:36,708 - ispa_next.main - DEBUG - Found new Appointment: DO-FM 482
2025-11-12 11:18:36,710 - ispa_next.main - DEBUG - 



2025-11-12 11:18:36,710 - ispa_next.main - DEBUG - starting with process 2 (DO-FM 482) of 7
2025-11-12 11:18:36,713 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:38,360 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:40,038 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1436
2025-11-12 11:18:40,039 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 11:18:42,273 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:42,275 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:13,711 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:27,157 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:28,370 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:28,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:28,482 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:28,869 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:28,871 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:31,904 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:31,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:33,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:35,198 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:35,326 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:38,617 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:38,783 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:19:42,995 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:19:43,999 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:44,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:44,482 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:00,456 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:20:10,622 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:10,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:10,728 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:10,730 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:10,796 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:12,176 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:12,427 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:15,380 - ispa_next.functions - DEBUG - Updated appointment (AK00021369) customer contact data.
2025-11-12 11:20:16,304 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:16,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:16,581 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:16,857 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:20:16,859 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:18,097 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:18,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:19,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:23,643 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:23,644 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:20:23,647 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:23,648 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:20:23,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:24,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:28,369 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:20:28,373 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:28,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:28,471 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:20:28,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:29,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:29,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:30,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:30,295 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:32,250 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:32,252 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:33,354 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:33,356 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:33,358 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:20:33,359 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:20:33,360 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:33,362 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:33,363 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:33,367 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:33,369 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:33,369 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:33,371 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:33,375 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:20:34,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:20:34,841 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:20:47,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:20:48,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:21:02,573 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:21:02,575 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:21:02,575 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:21:02,575 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:05,878 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:21:05,881 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:21:05,883 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:09,141 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:21:09,143 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:21:09,145 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:09,149 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:12,425 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:30,196 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:30,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:31,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:32,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:05,722 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:11,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:17,398 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:22,966 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:22,968 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:22,970 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:23,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:23,975 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:23,977 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:27,008 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:39,527 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:39,923 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:22:41,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:42,594 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1438
2025-11-12 11:22:42,594 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:45,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 15
2025-11-12 11:22:45,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:46,824 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:22:46,826 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:22:46,834 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:22:46,835 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:22:46,835 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:22:46,838 - ispa_next.main - DEBUG - Found new Appointment: RÜD FA 811
2025-11-12 11:22:46,839 - ispa_next.main - DEBUG - 



2025-11-12 11:22:46,840 - ispa_next.main - DEBUG - starting with process 3 (RÜD FA 811) of 8
2025-11-12 11:22:46,844 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:48,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:49,501 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1438
2025-11-12 11:22:49,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 15
2025-11-12 11:22:51,305 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:51,307 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:29,364 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:23:29,451 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:23:29,454 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:30,168 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1438
2025-11-12 11:23:30,170 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:32,761 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 15
2025-11-12 11:23:32,761 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:33,676 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:23:33,677 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:23:33,684 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:23:33,685 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:23:33,685 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:23:33,688 - ispa_next.main - DEBUG - 



2025-11-12 11:23:33,688 - ispa_next.main - DEBUG - starting with process 4 (WI-HD 313) of 8
2025-11-12 11:23:33,691 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:34,867 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:36,091 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1438
2025-11-12 11:23:36,092 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 15
2025-11-12 11:23:37,732 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:37,733 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:04,007 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:24:16,500 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:19,136 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:24:19,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:19,215 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:19,552 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:24:19,554 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:24:22,488 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:22,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:23,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:25,860 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:24:25,974 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:24:29,233 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:24:29,342 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:24:29,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:32,025 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:24:41,310 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:24:42,315 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:24:42,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:42,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:59,985 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:25:09,820 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:25:09,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:09,913 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:09,915 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:25:09,981 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:25:11,247 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:25:11,486 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:25:17,046 - ispa_next.functions - DEBUG - Updated appointment (AI00026202) customer contact data.
2025-11-12 11:25:18,033 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:25:18,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:18,476 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:18,687 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 11:25:18,689 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:25:20,011 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:25:20,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:25:20,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:25:25,429 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:25,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:25,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:28,002 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:25:28,137 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:25:28,299 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:25:28,425 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:25:28,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:31,846 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:25:42,871 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:25:49,210 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:25:49,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:52,623 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:25:56,865 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:25:57,871 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:25:57,872 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:25:57,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:57,995 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:26:02,178 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 11:26:03,560 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 11:26:15,634 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:26:15,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:15,770 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:26:25,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:26,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:26,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:27,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:27,289 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:26:30,395 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:26:30,397 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:26:31,634 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:26:31,636 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:31,638 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 11:26:31,638 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 11:26:31,640 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:31,642 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:26:31,642 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:26:31,644 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:26:31,646 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:26:31,646 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:26:31,648 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:26:31,650 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:26:32,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:26:33,209 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:26:46,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 11:26:47,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 11:27:01,336 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:27:01,339 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:27:01,341 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:27:01,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:06,088 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:27:06,090 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:27:06,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:10,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:11,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:21,640 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:27:21,640 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:27:21,642 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:27:21,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:26,414 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:27:46,490 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:27:47,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:48,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:48,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:18,677 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:28:18,677 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:19,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:19,962 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:28:19,964 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:28:25,636 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:28:37,067 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:28:37,451 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:28:39,514 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:40,678 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:28:40,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:44,206 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:28:44,206 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:45,465 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:28:45,466 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:28:45,474 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:28:45,475 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:28:45,478 - ispa_next.main - DEBUG - Found new Appointment: WI TW 337
2025-11-12 11:28:45,479 - ispa_next.main - DEBUG - 



2025-11-12 11:28:45,479 - ispa_next.main - DEBUG - starting with process 5 (WI TW 337) of 9
2025-11-12 11:28:45,483 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:47,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:48,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:28:48,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 11:28:50,927 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:50,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:28,443 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:29:28,455 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:29:28,459 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:29,337 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:29:29,357 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:32,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:29:32,697 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:33,912 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:29:33,913 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:29:33,923 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:29:33,924 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:29:33,929 - ispa_next.main - DEBUG - 



2025-11-12 11:29:33,929 - ispa_next.main - DEBUG - starting with process 6 (WI-AF169) of 9
2025-11-12 11:29:33,939 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:35,611 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:37,196 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:29:37,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 11:29:39,399 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:39,400 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:16,713 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:30:16,721 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:30:16,723 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:17,374 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:30:17,375 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:30:20,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:30:20,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:22,062 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:30:22,063 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:30:22,071 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:30:22,072 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:30:22,075 - ispa_next.main - DEBUG - 



2025-11-12 11:30:22,075 - ispa_next.main - DEBUG - starting with process 7 (0) of 9
2025-11-12 11:30:22,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:30:23,834 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:30:25,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:30:25,591 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 11:30:27,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:30:27,715 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:03,966 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:31:03,978 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:31:03,982 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:04,909 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:31:04,909 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:31:08,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:31:08,078 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:09,298 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:31:09,299 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:31:09,308 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:31:09,309 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:31:09,316 - ispa_next.main - DEBUG - 



2025-11-12 11:31:09,316 - ispa_next.main - DEBUG - starting with process 8 (WI-HW 385) of 9
2025-11-12 11:31:09,320 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:11,063 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:12,689 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:31:12,690 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 11:31:14,857 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 11:31:14,859 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:15,390 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 42, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 146, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-12 11:31:15,390 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:31:15,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:16,405 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:31:16,406 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 11:31:19,288 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:31:19,289 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:20,273 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:31:20,274 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:31:20,282 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:31:20,283 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:31:20,286 - ispa_next.main - DEBUG - 



2025-11-12 11:31:20,286 - ispa_next.main - DEBUG - starting with process 9 (RÜD-WP 71E) of 9
2025-11-12 11:31:20,290 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:31:21,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:23,605 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:31:23,607 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 11:31:25,457 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 11:31:25,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:25,981 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 42, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 146, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-12 11:31:25,981 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:31:25,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:31:26,686 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1440
2025-11-12 11:31:26,688 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 11:31:29,463 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 11:31:29,463 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:31:30,499 - ispa_next.appointments.models - DEBUG - Appointment Firma Mac Metzler Energietechnik Gm EMS-MM 344 WBY71AW020FR90962 ohne Termin.
2025-11-12 11:31:30,500 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:31:30,507 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 11:31:30,508 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
