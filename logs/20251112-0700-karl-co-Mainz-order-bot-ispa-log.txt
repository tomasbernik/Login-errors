2025-11-12 07:00:38,106 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:00:38,113 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:00:51,049 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:01:02,159 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:01:17,752 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:03:15,772 - ispa_next.app_start.main - DEBUG - Operation already took 106.68 seconds (more than 80 seconds)
2025-11-12 07:03:17,876 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_5t567n5w_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_5t567n5w', 'txt']
2025-11-12 07:03:18,153 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:03:18,158 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:03:18,158 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:05:17,188 - ispa_next.app_start.main - DEBUG - Operation already took 106.75 seconds (more than 80 seconds)
2025-11-12 07:05:19,276 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_p4n27pvp_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_p4n27pvp', 'txt']
2025-11-12 07:05:19,511 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:05:19,516 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:05:26,745 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 07:05:35,791 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:05:46,223 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:06:01,839 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:08:00,257 - ispa_next.app_start.main - DEBUG - Operation already took 107.31 seconds (more than 80 seconds)
2025-11-12 07:08:02,337 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_nbdxr4nc_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_nbdxr4nc', 'txt']
2025-11-12 07:08:02,576 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:08:02,580 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:08:02,581 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:10:01,655 - ispa_next.app_start.main - DEBUG - Operation already took 106.69 seconds (more than 80 seconds)
2025-11-12 07:10:03,711 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_27xnddp9_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_27xnddp9', 'txt']
2025-11-12 07:10:03,947 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:10:03,953 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:10:11,590 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 07:10:18,456 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:10:30,100 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:10:45,716 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:12:43,724 - ispa_next.app_start.main - DEBUG - Operation already took 106.91 seconds (more than 80 seconds)
2025-11-12 07:12:45,801 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_z2fxm6qu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_z2fxm6qu', 'txt']
2025-11-12 07:12:46,042 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:12:46,045 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:12:46,046 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:14:45,224 - ispa_next.app_start.main - DEBUG - Operation already took 106.89 seconds (more than 80 seconds)
2025-11-12 07:14:47,301 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_nlsohvw2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_nlsohvw2', 'txt']
2025-11-12 07:14:47,535 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:14:47,540 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:14:54,572 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-12 07:15:02,501 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:15:13,095 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:15:28,737 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:17:26,702 - ispa_next.app_start.main - DEBUG - Operation already took 106.91 seconds (more than 80 seconds)
2025-11-12 07:17:28,765 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_va4cg6lg_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_va4cg6lg', 'txt']
2025-11-12 07:17:28,976 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:17:28,980 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:17:28,981 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:19:27,778 - ispa_next.app_start.main - DEBUG - Operation already took 106.43 seconds (more than 80 seconds)
2025-11-12 07:19:29,889 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_juqe2krs_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\8eb09fdd66e07dcf\\tess_juqe2krs', 'txt']
2025-11-12 07:19:30,106 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 07:19:30,112 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 07:19:37,714 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-12 07:19:45,695 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:19:56,345 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:20:11,882 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:20:35,576 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:20:46,693 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:20:50,167 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:51,114 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:20:51,115 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:20:53,130 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 223
2025-11-12 07:20:53,130 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:20:53,131 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:20:54,015 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:20:54,923 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:21:29,620 - ispa_next.appointments.models - DEBUG - Appointment Hatidzhe Dhevdzhet Chaylyak GG-HI 889 WBAVJ11040LF60481 ohne Termin.
2025-11-12 07:21:29,655 - ispa_next.appointments.models - DEBUG - Appointment Ulas Korkmaz  WBAJM710X0B068176 ohne Termin.
2025-11-12 07:21:29,676 - ispa_next.appointments.models - DEBUG - Appointment Florian Goertz RPL 11-3 WBA2D310505C65769 ohne Termin.
2025-11-12 07:21:29,677 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:21:29,736 - ispa_next.main - DEBUG - Found 15 out of 109 appointments to process (configured limit: 15).
2025-11-12 07:21:29,737 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 07:21:29,737 - ispa_next.main - DEBUG - Processing 7 already visited appointments (w/ RKR not callable).
2025-11-12 07:21:29,737 - ispa_next.main - DEBUG - All appointments: MZJK217, MZ - AW 77E, KI-KI 0815, KI-KI 0815, KI-KI 0815, MZ-ME 141E, RÜD CS 677, MZ MV 279, WI-AZ 44, WI-DF 901, AZ-EL 7777, MZ-S 7911 E, MZ NE 4752, MZ-EN 245, MZ-GN 118
2025-11-12 07:21:29,740 - ispa_next.main - DEBUG - 



2025-11-12 07:21:29,740 - ispa_next.main - DEBUG - starting with process 1 (MZJK217) of 15
2025-11-12 07:21:29,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:21:31,040 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:21:32,484 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:21:32,486 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 223
2025-11-12 07:21:34,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:21:34,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:12,733 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:22:12,856 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:22:12,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:13,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:22:13,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:16,322 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:22:16,323 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:17,049 - ispa_next.main - DEBUG - 



2025-11-12 07:22:17,049 - ispa_next.main - DEBUG - starting with process 2 (MZ - AW 77E) of 15
2025-11-12 07:22:17,055 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:18,011 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:18,948 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:22:18,949 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:22:20,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:20,252 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:52,987 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:22:52,998 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:22:53,001 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:53,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:22:53,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:56,241 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:22:56,242 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:57,023 - ispa_next.main - DEBUG - 



2025-11-12 07:22:57,023 - ispa_next.main - DEBUG - starting with process 3 (KI-KI 0815) of 15
2025-11-12 07:22:57,027 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:58,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:59,063 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:22:59,064 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:23:00,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:00,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:23,675 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 07:23:23,687 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:23:23,691 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:24,346 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:23:24,347 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:27,047 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:23:27,048 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:27,992 - ispa_next.main - DEBUG - 



2025-11-12 07:23:27,992 - ispa_next.main - DEBUG - starting with process 4 (KI-KI 0815) of 15
2025-11-12 07:23:27,997 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:29,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:30,639 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:23:30,641 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:23:32,287 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:32,289 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:52,773 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 07:23:52,782 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:23:52,785 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:53,202 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:23:53,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:55,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:23:55,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:56,544 - ispa_next.main - DEBUG - 



2025-11-12 07:23:56,544 - ispa_next.main - DEBUG - starting with process 5 (KI-KI 0815) of 15
2025-11-12 07:23:56,548 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:57,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:59,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:23:59,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:24:00,921 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:00,922 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:23,669 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 179, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-12 07:24:23,681 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:24:23,685 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:24,312 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:24:24,312 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:27,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:24:27,044 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:27,695 - ispa_next.main - DEBUG - 



2025-11-12 07:24:27,696 - ispa_next.main - DEBUG - starting with process 6 (MZ-ME 141E) of 15
2025-11-12 07:24:27,701 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:28,882 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:30,165 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:24:30,166 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:24:31,562 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:31,563 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:03,886 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:25:03,898 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:25:03,902 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:04,576 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:25:04,577 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:07,273 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:25:07,273 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:08,157 - ispa_next.main - DEBUG - 



2025-11-12 07:25:08,158 - ispa_next.main - DEBUG - starting with process 7 (RÜD CS 677) of 15
2025-11-12 07:25:08,162 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:25:09,562 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:10,873 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:25:10,874 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:25:12,579 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:12,580 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:45,433 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:25:45,444 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:25:45,448 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:45,850 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:25:45,851 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:48,446 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:25:48,447 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:49,398 - ispa_next.main - DEBUG - 



2025-11-12 07:25:49,398 - ispa_next.main - DEBUG - starting with process 8 (MZ MV 279) of 15
2025-11-12 07:25:49,402 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:25:50,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:51,981 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:25:51,983 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:25:53,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:53,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:28,383 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:26:28,394 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:26:28,399 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:28,955 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:26:28,957 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:31,538 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:26:31,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:32,340 - ispa_next.main - DEBUG - 



2025-11-12 07:26:32,341 - ispa_next.main - DEBUG - starting with process 9 (WI-AZ 44) of 15
2025-11-12 07:26:32,347 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:33,589 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:26:34,831 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:26:34,833 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:26:36,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:26:36,259 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:26:59,046 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:27:00,757 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:27:05,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:08,088 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:27:08,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:08,177 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:08,405 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:27:08,414 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:27:11,213 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:27:11,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:27:12,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:27:14,244 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:27:14,346 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:27:14,459 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:27:14,525 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:27:14,526 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:17,156 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:27:25,295 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:27:26,299 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:27:26,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:26,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:38,619 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:27:42,300 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:27:42,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:27:42,386 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:27:42,387 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:27:42,455 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:27:43,614 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:27:43,973 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:27:47,834 - ispa_next.functions - DEBUG - Updated appointment (AG00036607) customer contact data.
2025-11-12 07:27:48,778 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:27:48,785 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:27:56,122 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:27:56,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:27:59,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:28:03,342 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:03,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:04,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:06,051 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:28:06,157 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:28:06,257 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:28:06,324 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:28:06,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:08,905 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:28:20,417 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:28:25,262 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:28:25,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:27,875 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:28:32,069 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:28:33,076 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:28:33,077 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:28:33,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:33,172 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:28:37,304 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:28:37,308 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:28:37,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:37,377 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:28:41,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:42,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:42,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:42,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:42,820 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:28:45,246 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:28:45,251 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:28:46,429 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:28:46,431 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:28:46,432 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 07:28:46,433 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:28:46,441 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:28:46,444 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:28:46,447 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:28:46,449 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:28:46,450 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:28:46,451 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:28:46,454 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:28:46,457 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:28:46,459 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:28:46,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:49,075 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:28:49,078 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:28:49,079 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:28:49,082 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:28:49,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:28:49,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:28:50,001 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:58,334 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:28:58,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:00,914 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:29:13,663 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:29:14,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:14,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:29:14,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:40,074 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:44,228 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:48,664 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:29:48,666 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:29:48,667 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:29:49,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:49,478 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:29:49,480 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:29:51,356 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:30:00,440 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:30:00,828 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:30:01,210 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:02,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:30:02,350 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:05,162 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:30:05,163 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:05,967 - ispa_next.main - DEBUG - 



2025-11-12 07:30:05,968 - ispa_next.main - DEBUG - starting with process 10 (WI-DF 901) of 15
2025-11-12 07:30:05,972 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:30:07,173 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:08,203 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:30:08,205 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:30:09,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:09,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:32,243 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:30:33,881 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:30:38,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:43,222 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:30:43,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:43,306 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:30:43,590 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 07:30:47,781 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:30:47,784 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:30:50,674 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:30:50,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:51,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:53,550 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:30:53,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:30:53,761 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:30:53,835 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:30:53,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:58,549 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:31:06,882 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:31:07,887 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:31:07,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:08,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:18,937 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:31:18,937 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:31:23,624 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:31:23,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:23,724 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:31:23,725 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:31:23,765 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:31:23,881 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:31:25,056 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:31:25,315 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:31:28,586 - ispa_next.functions - DEBUG - Updated appointment (AR00013972) customer contact data.
2025-11-12 07:31:29,531 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:31:29,533 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:31:29,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:31:30,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:31:31,454 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:31:31,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:31:31,522 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:31:35,090 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:31:35,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:35,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:31:37,574 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:31:37,700 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:31:37,791 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:31:37,863 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:31:37,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:42,493 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:31:50,756 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:32:50,759 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:33:01,544 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:33:05,954 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:33:05,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:12,122 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 07:33:13,833 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:33:18,207 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:33:19,214 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:33:19,216 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:33:19,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:19,289 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:33:23,426 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:33:27,070 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:33:27,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:27,167 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:33:31,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:31,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:31,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:32,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:32,215 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:33:36,433 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:33:36,438 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:33:37,798 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:33:37,804 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:33:37,806 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 07:33:37,818 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:33:37,819 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:33:37,821 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:33:37,824 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:33:37,825 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:33:37,828 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:33:37,831 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:33:37,832 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:33:37,837 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:33:37,839 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:33:37,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:42,428 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 07:33:44,752 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:33:44,828 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:33:44,882 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:33:44,884 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:33:44,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:33:45,664 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:33:45,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:57,635 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:33:57,637 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:02,179 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:34:14,770 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:34:15,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:34:15,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:34:15,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:00,810 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:04,846 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:09,685 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:14,010 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:18,999 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:23,095 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:23,097 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:35:23,097 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:23,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:35:23,701 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:35:23,703 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:35:25,429 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:35:32,930 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:35:33,325 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:35:33,704 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:34,949 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:35:34,950 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:35:37,915 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:35:37,916 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:35:38,772 - ispa_next.main - DEBUG - 



2025-11-12 07:35:38,772 - ispa_next.main - DEBUG - starting with process 11 (AZ-EL 7777) of 15
2025-11-12 07:35:38,775 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:39,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:41,168 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:35:41,170 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:35:42,758 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:35:42,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:12,964 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:36:14,763 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:36:20,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:22,559 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:36:22,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:22,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:22,834 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:36:22,837 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:36:25,601 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:36:25,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:26,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:36:28,484 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:36:28,583 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:36:28,670 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:36:28,800 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:36:32,937 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:36:33,953 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:36:33,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:34,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:46,294 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:36:46,294 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:36:50,336 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:36:50,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:50,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:50,427 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:36:50,476 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:36:51,608 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:36:51,830 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:36:54,822 - ispa_next.functions - DEBUG - Updated appointment (BA00011080) customer contact data.
2025-11-12 07:36:55,742 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:36:55,745 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:36:56,499 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:36:56,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:36:57,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:37:00,806 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:37:00,807 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:37:00,810 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:37:00,811 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:37:00,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:01,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:05,424 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 07:37:08,362 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:37:08,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:08,487 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:37:17,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:17,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:17,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:18,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:18,568 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:37:21,020 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:37:21,035 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:37:22,912 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:37:22,913 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:37:22,914 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 07:37:22,915 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:37:22,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:37:22,917 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:37:22,918 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:37:22,919 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:37:22,920 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:37:22,921 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:37:22,922 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:37:22,925 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:37:22,926 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:37:22,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:25,475 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:37:25,477 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:37:25,479 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:37:25,480 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:37:25,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:37:26,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:37:26,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:36,167 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:37:36,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:38,759 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:37:51,297 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:37:51,794 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:37:52,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:37:52,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:38:17,918 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:22,089 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:26,909 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:26,911 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:38:26,912 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:27,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:27,783 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:38:27,786 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:38:29,763 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:38:38,021 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:38:38,417 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:38:38,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:40,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:38:40,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:43,350 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:38:43,351 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:38:44,131 - ispa_next.main - DEBUG - 



2025-11-12 07:38:44,131 - ispa_next.main - DEBUG - starting with process 12 (MZ-S 7911 E) of 15
2025-11-12 07:38:44,135 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:45,459 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:46,387 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:38:46,388 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:38:47,796 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:47,798 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:14,630 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:39:16,318 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:39:21,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:39:23,066 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:39:23,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:23,140 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:23,345 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:39:23,349 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:39:26,282 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:39:26,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:39:27,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:39:29,171 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:39:29,285 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:39:29,386 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:39:29,457 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:39:29,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:39:31,387 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:39:39,790 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:39:40,800 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:39:40,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:41,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:52,308 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:39:56,548 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:39:56,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:56,661 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:56,662 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:39:56,704 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:39:57,924 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:39:59,113 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:39:59,321 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:40:02,487 - ispa_next.functions - DEBUG - Updated appointment (AZ00011291) customer contact data.
2025-11-12 07:40:03,388 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:40:03,390 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:40:04,285 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:40:04,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:40:05,082 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:40:08,648 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:40:08,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:09,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:40:11,132 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:40:11,267 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:40:11,361 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:40:11,449 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:40:11,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:13,350 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:40:21,520 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:41:21,522 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:41:32,849 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:41:37,233 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:41:37,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:39,878 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:41:44,047 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:41:45,053 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:41:45,054 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:41:45,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:45,120 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:41:49,236 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:41:49,241 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:41:49,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:49,326 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:41:49,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:50,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:41:50,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:41:50,943 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:41:50,944 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:41:53,386 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:41:53,388 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:41:54,286 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:41:54,287 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:54,289 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 07:41:54,290 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:41:54,291 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:41:54,293 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 07:41:54,294 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:41:54,296 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:41:54,298 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:41:54,299 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:41:54,301 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 07:41:56,198 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:41:56,721 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:41:57,629 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:41:58,207 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:41:58,729 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:41:59,647 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:42:00,229 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:42:00,754 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:42:02,092 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:42:03,132 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:42:04,063 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:42:04,475 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:42:04,478 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:42:04,480 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:06,347 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:42:06,349 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:42:06,352 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:42:06,354 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:42:06,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:42:07,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:42:07,461 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:16,530 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:42:16,532 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:18,433 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:42:30,172 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:42:30,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:42:31,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:42:31,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:49,402 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:42:53,971 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:42:53,974 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:42:53,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:42:54,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:42:54,818 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:42:54,820 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:42:56,760 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:43:04,566 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:43:04,946 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:43:05,317 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:07,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:43:07,389 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:10,274 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:43:10,274 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:11,150 - ispa_next.main - DEBUG - 



2025-11-12 07:43:11,150 - ispa_next.main - DEBUG - starting with process 13 (MZ NE 4752) of 15
2025-11-12 07:43:11,155 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:12,419 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:13,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:43:13,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:43:15,143 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:15,145 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:49,173 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:43:49,185 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:43:49,188 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:49,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:43:49,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:52,434 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:43:52,435 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:43:53,275 - ispa_next.main - DEBUG - 



2025-11-12 07:43:53,275 - ispa_next.main - DEBUG - starting with process 14 (MZ-EN 245) of 15
2025-11-12 07:43:53,279 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:43:54,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:43:55,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:43:55,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:43:57,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:43:57,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:44:23,152 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:44:25,076 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:44:30,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:34,865 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:44:34,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:34,939 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:44:35,104 - ispa_next.functions - DEBUG - HU date already expired after 2 days.
2025-11-12 07:44:39,181 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:44:39,184 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:44:41,942 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:44:41,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:44:42,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:44:44,948 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:44:45,063 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:44:45,176 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:44:45,250 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:44:49,483 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:44:50,489 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:44:50,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:44:51,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:02,812 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:45:07,221 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:45:07,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:07,321 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:45:07,323 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:45:07,357 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:45:07,497 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:45:08,684 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:45:08,902 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:45:11,977 - ispa_next.functions - DEBUG - Updated appointment (AD00056147) customer contact data.
2025-11-12 07:45:13,036 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:45:13,040 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:45:13,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:45:13,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:45:15,036 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:45:15,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:45:15,106 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:45:18,677 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:45:18,677 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:45:18,680 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:45:18,681 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:45:18,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:19,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:45:23,326 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:45:23,329 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:45:23,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:23,408 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:45:27,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:28,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:28,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:45:28,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:45:28,649 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:45:32,785 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:45:32,787 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:45:33,670 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:45:33,671 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:45:33,672 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 07:45:33,673 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:45:33,674 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:45:33,677 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:45:33,679 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:45:33,681 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:45:33,685 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:45:33,689 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:45:33,690 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:45:33,693 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:45:33,695 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:45:33,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:38,262 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:45:38,264 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:45:38,265 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:45:38,267 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:45:38,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:45:39,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:45:39,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:50,862 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:45:50,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:55,517 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:46:08,204 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:46:08,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:46:09,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:46:09,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:46:55,058 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:46:59,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:47:04,394 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:47:08,681 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:47:13,295 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:47:18,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:47:18,583 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:47:18,584 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:47:19,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:47:19,446 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:47:19,448 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:47:21,538 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:47:30,318 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:47:30,695 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 07:47:31,087 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:47:32,530 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:47:32,531 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:47:35,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 460
2025-11-12 07:47:35,480 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:47:36,288 - ispa_next.main - DEBUG - 



2025-11-12 07:47:36,288 - ispa_next.main - DEBUG - starting with process 15 (MZ-GN 118) of 15
2025-11-12 07:47:36,293 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:47:37,535 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:47:38,712 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:47:38,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 460
2025-11-12 07:47:40,489 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:47:40,490 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:48:13,295 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:48:15,137 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:48:20,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:22,820 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:48:22,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:22,889 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:48:23,105 - ispa_next.functions - DEBUG - HU date already expired after 2 days.
2025-11-12 07:48:27,366 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:48:27,370 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:48:30,149 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:48:30,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:48:31,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:48:33,102 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:48:33,217 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:48:33,294 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:48:33,354 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:48:33,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:35,922 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:48:44,580 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:48:45,595 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:48:45,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:46,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:48:57,597 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:49:01,911 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:49:01,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:01,984 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:49:01,985 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:49:02,046 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:49:03,288 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:49:03,518 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:49:06,537 - ispa_next.functions - DEBUG - Updated appointment (AB00061245) customer contact data.
2025-11-12 07:49:07,446 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:49:07,448 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:49:08,316 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:49:08,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:49:09,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:49:12,643 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:49:12,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:49:13,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:49:15,158 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:49:15,283 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:49:15,361 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:49:15,456 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:49:15,456 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:18,064 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:49:26,398 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:50:26,400 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:50:37,688 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:50:41,709 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:50:41,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:44,323 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:50:48,510 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:50:49,517 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:50:49,517 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:50:49,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:49,642 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:50:53,761 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:50:53,766 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:50:53,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:53,841 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:50:54,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:54,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:54,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:55,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:55,529 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:50:58,045 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:50:58,047 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:50:59,423 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:50:59,428 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:50:59,430 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 07:50:59,432 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:50:59,434 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:50:59,436 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:50:59,437 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:50:59,438 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:50:59,439 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:50:59,440 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:50:59,442 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:50:59,445 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:50:59,448 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:50:59,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:02,016 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:51:02,018 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:51:02,020 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:51:02,022 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:51:02,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:51:02,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:51:02,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:15,664 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:51:15,666 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:18,218 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-12 07:51:27,062 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:51:38,812 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:51:39,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:51:39,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:51:40,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:05,572 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:10,344 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:15,663 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:15,666 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:52:15,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:52:16,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:52:16,453 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:52:16,455 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:52:18,601 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:52:27,407 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:52:27,785 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:52:28,157 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:52:29,690 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1607
2025-11-12 07:52:29,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:52:32,716 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 455
2025-11-12 07:52:32,717 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
