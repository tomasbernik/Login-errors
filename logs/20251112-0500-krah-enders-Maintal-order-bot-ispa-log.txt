2025-11-12 05:00:34,448 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 05:00:34,454 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 05:00:49,063 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:00:59,900 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:01:15,487 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:03:13,949 - ispa_next.app_start.main - DEBUG - Operation already took 107.18 seconds (more than 80 seconds)
2025-11-12 05:03:16,061 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_szu4dyjk_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_szu4dyjk', 'txt']
2025-11-12 05:03:16,400 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:03:16,406 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:03:16,406 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:05:15,376 - ispa_next.app_start.main - DEBUG - Operation already took 106.69 seconds (more than 80 seconds)
2025-11-12 05:05:17,465 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_u4nhcubp_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_u4nhcubp', 'txt']
2025-11-12 05:05:17,690 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:05:17,694 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:05:24,394 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 05:05:33,424 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:05:44,001 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:05:59,352 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:07:56,591 - ispa_next.app_start.main - DEBUG - Operation already took 106.17 seconds (more than 80 seconds)
2025-11-12 05:07:58,651 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_p3qm5uul_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_p3qm5uul', 'txt']
2025-11-12 05:07:58,873 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:07:58,877 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:07:58,879 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:09:57,882 - ispa_next.app_start.main - DEBUG - Operation already took 106.64 seconds (more than 80 seconds)
2025-11-12 05:09:59,964 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_t0nfppgi_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_t0nfppgi', 'txt']
2025-11-12 05:10:00,237 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:10:00,242 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:10:06,267 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 05:10:14,213 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:10:25,805 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:10:41,539 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:12:39,102 - ispa_next.app_start.main - DEBUG - Operation already took 106.48 seconds (more than 80 seconds)
2025-11-12 05:12:41,180 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_jtv_zo09_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7b7bf23b78755446\\tess_jtv_zo09', 'txt']
2025-11-12 05:12:41,403 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:12:41,407 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:12:41,407 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:13:20,930 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 05:13:32,747 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 05:13:35,177 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:13:36,117 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:13:36,118 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:13:38,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 173
2025-11-12 05:13:38,187 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 05:13:38,187 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:13:38,992 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:13:39,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:14:05,613 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:14:05,625 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:14:05,639 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:14:05,688 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-12 05:14:05,728 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-12 05:14:05,787 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-12 05:14:05,799 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-12 05:14:05,809 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-12 05:14:05,819 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-12 05:14:05,829 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-12 05:14:05,839 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-12 05:14:05,885 - ispa_next.main - DEBUG - Found 15 out of 148 appointments to process (configured limit: 15).
2025-11-12 05:14:05,885 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 05:14:05,886 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 05:14:05,886 - ispa_next.main - DEBUG - All appointments: FCG1203, HEF-TT 369, M-FB 6992, MKK-RR 51 E, FB-RM 411, HU-SU 2014, HU-AS 262, F-CA 525, HN FL 983, HU LJ 3118, HG-PL 4219, GN-A 713, BIR-F 196, HU-RM 109, GN-JK 7275
2025-11-12 05:14:05,889 - ispa_next.main - DEBUG - 



2025-11-12 05:14:05,889 - ispa_next.main - DEBUG - starting with process 1 (FCG1203) of 15
2025-11-12 05:14:05,894 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:14:07,023 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:14:08,269 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:14:08,270 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 173
2025-11-12 05:14:09,753 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:14:09,755 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:14:44,045 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:14:44,168 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 05:14:44,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:14:44,860 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:14:44,862 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:14:46,918 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:14:46,919 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:14:47,626 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:14:47,638 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:14:47,648 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:14:47,659 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:14:47,665 - ispa_next.main - DEBUG - 



2025-11-12 05:14:47,665 - ispa_next.main - DEBUG - starting with process 2 (HEF-TT 369) of 15
2025-11-12 05:14:47,669 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:14:48,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:14:49,319 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:14:49,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:14:50,762 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:14:50,763 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:15:16,926 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:15:19,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:15:24,602 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:15:24,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:24,680 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:15:24,829 - ispa_next.functions - DEBUG - HU date already expired after 747 days.
2025-11-12 05:15:27,930 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:15:27,933 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:15:27,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:28,031 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:15:33,751 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:15:33,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:15:34,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:15:36,594 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:15:36,704 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:15:36,826 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:15:36,897 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:15:36,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:15:41,589 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:15:49,712 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:15:50,717 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:15:50,721 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:15:50,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:51,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:51,270 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:15:51,309 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:15:52,466 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:15:53,599 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:15:53,874 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:15:55,533 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:15:55,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:55,637 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:15:55,759 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:15:55,762 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:15:56,372 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:15:56,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:15:56,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:16:01,005 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:16:01,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:16:01,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:16:03,550 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:16:03,663 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:16:03,757 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:16:03,838 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:16:03,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:08,559 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:16:17,030 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:17:17,032 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:17:25,123 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:18:17,125 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:18:28,415 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:18:32,375 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:18:32,375 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:37,108 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:18:41,249 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:18:42,255 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:18:42,256 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:18:42,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:42,329 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:18:46,465 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:18:46,471 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:18:46,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:46,532 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:18:46,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:47,421 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:47,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:48,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:18:48,096 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:18:52,223 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:18:52,229 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:18:53,241 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:18:53,242 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:18:53,244 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:18:53,245 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:18:53,247 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:18:53,248 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:18:53,249 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:18:53,250 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:18:53,252 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:18:53,260 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:18:53,266 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:18:53,268 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:18:53,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:57,863 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 05:19:00,175 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:19:00,177 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:19:00,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:04,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:19:04,812 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:19:16,815 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:19:16,819 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:19:16,823 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:19:16,827 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:21,428 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:19:21,432 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:19:22,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:19:22,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:19:23,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:20:01,374 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:20:05,435 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:20:08,980 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:20:12,206 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:20:16,461 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:20:16,463 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:20:16,465 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:20:17,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:20:17,214 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:20:17,216 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:20:19,111 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:20:28,015 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:20:28,398 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 05:20:29,391 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:20:29,852 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:20:29,852 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:20:32,144 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:20:32,145 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:20:32,697 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:20:32,714 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:20:32,723 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:20:32,734 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:20:32,740 - ispa_next.main - DEBUG - 



2025-11-12 05:20:32,740 - ispa_next.main - DEBUG - starting with process 3 (M-FB 6992) of 15
2025-11-12 05:20:32,744 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:20:33,445 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:20:34,321 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:20:34,322 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:20:35,434 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:20:35,435 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:21:02,315 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:21:05,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:07,916 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:21:07,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:08,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:21:08,171 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 05:21:12,192 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:21:12,196 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:21:12,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:12,280 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:21:15,282 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:21:15,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:21:16,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:21:18,324 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:21:18,421 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:21:18,494 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:21:18,602 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:21:18,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:21,251 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:21:29,544 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:21:30,560 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:21:30,577 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:21:30,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:31,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:31,125 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:21:31,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:21:31,276 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:21:32,282 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 05:21:33,493 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 05:21:33,832 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:21:35,442 - ispa_next.functions - DEBUG - Updated appointment (AZ00002280) customer contact data.
2025-11-12 05:21:36,368 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:21:36,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:36,453 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:21:36,637 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:21:36,641 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:21:36,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:21:37,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:21:38,617 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:21:38,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:21:38,697 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:21:42,841 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:21:42,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:21:43,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:21:45,337 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:21:45,471 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:21:45,598 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:21:45,688 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:21:45,690 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:48,372 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:21:56,462 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:22:56,463 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:23:04,830 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:24:02,832 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:24:11,166 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 05:24:15,136 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 05:24:16,165 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:24:16,167 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:24:16,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:24:16,263 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:24:20,401 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:24:20,405 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:24:20,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:24:20,472 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:24:25,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:24:26,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:24:26,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:24:27,133 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:24:27,134 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:24:29,620 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:24:29,622 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:24:30,666 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:24:30,670 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:24:30,672 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:24:30,672 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:24:30,674 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:24:30,675 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:24:30,676 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:24:30,678 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:24:30,678 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:24:30,680 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:24:30,684 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:24:30,686 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:24:30,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:33,314 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:24:33,316 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:24:33,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:35,968 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:24:35,970 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:24:35,972 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:24:35,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:38,526 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:24:38,528 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:24:39,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:24:39,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:24:40,021 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:25:04,766 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:08,725 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:12,399 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:12,402 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:25:12,403 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:25:12,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:25:13,024 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:25:13,026 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:25:14,879 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:25:22,798 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:25:23,176 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 05:25:23,938 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:25:24,517 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:25:24,518 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:25:26,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:25:26,846 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:25:27,510 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:25:27,523 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:25:27,543 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:25:27,556 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:25:27,574 - ispa_next.main - DEBUG - 



2025-11-12 05:25:27,574 - ispa_next.main - DEBUG - starting with process 4 (MKK-RR 51 E) of 15
2025-11-12 05:25:27,578 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:25:28,641 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:25:29,737 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:25:29,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:25:31,271 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:25:31,273 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:26:01,278 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:26:04,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:07,018 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:26:07,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:07,092 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:26:07,383 - ispa_next.functions - DEBUG - HU date already expired after 12 days.
2025-11-12 05:26:10,742 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:26:10,746 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:26:10,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:10,832 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:26:13,631 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:26:13,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:14,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:26:16,482 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:26:16,591 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:26:16,703 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:26:16,768 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:26:16,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:19,305 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:26:27,361 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:26:28,366 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:26:28,371 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:26:28,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:28,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:28,916 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:26:28,956 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:26:30,209 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:26:30,447 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:26:32,045 - ispa_next.functions - DEBUG - Updated appointment (AA00029962) customer contact data.
2025-11-12 05:26:32,960 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:26:32,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:33,031 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:26:33,242 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:26:33,245 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:26:34,083 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:26:34,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:26:34,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:26:38,376 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:26:38,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:38,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:26:40,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:26:40,994 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:26:41,087 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:26:41,181 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:26:41,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:43,779 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:26:52,225 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:27:52,227 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:28:03,076 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:28:07,384 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:28:07,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:11,045 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:28:15,180 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:28:16,200 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:28:16,201 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:28:16,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:16,278 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:28:20,408 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:28:24,206 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:28:24,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:24,299 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:28:27,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:28,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:28,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:28,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:28:28,999 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:28:31,954 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:28:31,956 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:28:32,905 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:28:32,909 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:28:32,911 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:28:32,913 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:28:32,915 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 05:28:32,917 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:28:32,919 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:28:32,920 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:28:32,921 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:28:32,923 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 05:28:35,073 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:28:35,607 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:28:36,571 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:28:37,137 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:28:37,664 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:28:38,576 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:28:39,134 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:28:39,655 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:28:40,579 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:28:41,169 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:28:41,691 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:28:43,031 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:28:44,097 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:28:45,029 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:28:45,453 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:28:45,459 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:28:45,461 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:48,012 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 05:28:50,280 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:28:50,284 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:28:50,286 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:52,855 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:28:52,859 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:28:52,861 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:28:52,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:55,489 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:28:55,491 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:28:56,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:28:56,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:28:57,047 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:29:15,339 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:18,758 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:18,761 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:29:18,761 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:19,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:29:19,289 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:29:19,291 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:29:20,754 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:29:28,857 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:29:29,246 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 05:29:29,907 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:30,430 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:29:30,432 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:32,592 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:29:32,593 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:29:33,811 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:29:33,822 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:29:33,831 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:29:33,840 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:29:33,845 - ispa_next.main - DEBUG - 



2025-11-12 05:29:33,845 - ispa_next.main - DEBUG - starting with process 5 (FB-RM 411) of 15
2025-11-12 05:29:33,849 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:34,714 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:35,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:29:35,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:29:36,889 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:36,890 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:30:06,284 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:30:09,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:12,997 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:30:12,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:13,070 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:13,283 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:30:13,287 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:30:13,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:13,405 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:16,477 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:16,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:17,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:30:19,490 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:30:19,629 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:30:19,712 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:30:19,801 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:30:19,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:23,141 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:30:31,487 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:30:32,493 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:30:32,498 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:30:32,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:33,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:33,008 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:30:33,061 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:30:34,271 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:30:35,498 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:30:35,739 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:30:37,386 - ispa_next.functions - DEBUG - Updated appointment (AA00029960) customer contact data.
2025-11-12 05:30:38,302 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:30:38,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:38,390 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:40,365 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:30:41,083 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:30:41,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:30:41,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:30:45,406 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:45,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:45,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:30:47,976 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:30:48,072 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:30:48,172 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:30:48,260 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:30:48,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:51,649 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:31:00,084 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:32:00,088 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:32:11,108 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:32:15,280 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:32:15,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:18,670 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:32:22,869 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:32:23,876 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:32:23,878 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:32:23,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:24,003 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:32:28,149 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:32:28,153 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:32:28,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:28,243 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:32:36,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:37,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:37,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:38,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:32:38,188 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:32:41,487 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:32:41,489 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:32:42,308 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:32:42,310 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:32:42,310 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:32:42,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:32:42,313 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:32:42,315 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:32:42,319 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:32:42,322 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:32:42,324 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:32:42,325 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:32:42,328 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:32:42,331 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:32:42,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:45,530 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:32:45,534 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:32:45,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:48,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:48,933 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:32:59,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:12,030 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:33:12,033 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:33:12,034 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:33:12,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:15,254 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:33:15,256 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:33:16,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:33:17,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:33:17,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:49,232 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:33:54,188 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:33:58,024 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:02,221 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:34:02,225 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:34:02,225 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:34:02,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:34:02,805 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:34:02,807 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:34:04,235 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:34:10,847 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:34:11,245 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 05:34:12,204 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:12,722 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:34:12,724 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:34:14,949 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:34:14,950 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:34:15,641 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:34:15,654 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:34:15,668 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:34:15,679 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:34:15,685 - ispa_next.main - DEBUG - 



2025-11-12 05:34:15,685 - ispa_next.main - DEBUG - starting with process 6 (HU-SU 2014) of 15
2025-11-12 05:34:15,689 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:34:16,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:17,930 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:34:17,931 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:34:19,295 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:34:19,296 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:34:49,069 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:34:52,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:55,404 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:34:55,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:34:55,479 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:34:55,654 - ispa_next.functions - DEBUG - HU date already expired after 16 days.
2025-11-12 05:34:58,758 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:34:58,762 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:34:58,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:34:58,833 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:04,723 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:35:04,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:35:05,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:35:07,827 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:35:07,918 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:35:08,019 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:35:08,083 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:35:08,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:11,396 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:35:19,899 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:35:20,904 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:35:20,908 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:35:20,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:21,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:21,431 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:35:21,462 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:35:21,584 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:35:22,798 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:35:23,073 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:35:24,810 - ispa_next.functions - DEBUG - Updated appointment (AT00004939) customer contact data.
2025-11-12 05:35:25,709 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:35:25,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:25,803 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:25,940 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:35:25,943 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:35:26,116 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:35:26,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:35:27,862 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:35:27,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:35:27,935 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:35:31,561 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:35:31,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:35:32,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:35:34,043 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:35:34,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:35:34,231 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:35:34,288 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:35:34,289 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:37,595 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:35:45,737 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:36:45,740 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:36:56,748 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:37:02,379 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:37:02,379 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:08,544 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:37:11,493 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:37:14,161 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:37:15,831 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:37:20,658 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:37:21,664 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:37:21,666 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:37:21,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:37:21,755 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:37:25,865 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:37:29,418 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:37:29,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:37:29,508 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:37:33,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:37:34,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:37:34,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:37:34,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:37:34,815 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:37:37,779 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:37:37,793 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:37:40,169 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:37:40,171 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:37:40,171 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:37:40,173 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:37:40,173 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:37:40,175 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:37:40,175 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:37:40,177 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:37:40,177 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:37:40,178 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:37:40,182 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:37:40,185 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:37:40,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:43,437 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:37:43,439 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:37:43,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:46,653 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:37:46,656 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:37:46,659 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:37:46,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:49,885 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:37:49,889 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:37:50,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:37:51,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:37:51,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:38:22,947 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:27,159 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:31,009 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:35,539 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:35,541 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:38:35,545 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:38:36,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:38:36,290 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:38:36,292 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:38:38,224 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:38:46,271 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:38:46,673 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 05:38:47,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:38:48,193 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:38:48,193 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:38:51,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:38:51,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:38:51,870 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:38:51,884 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:38:51,894 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:38:51,906 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:38:51,911 - ispa_next.main - DEBUG - 



2025-11-12 05:38:51,911 - ispa_next.main - DEBUG - starting with process 7 (HU-AS 262) of 15
2025-11-12 05:38:51,916 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:38:52,954 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:38:53,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:38:53,989 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:38:55,332 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:38:55,333 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:39:18,247 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:39:21,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:23,403 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:39:23,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:23,475 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:39:23,723 - ispa_next.functions - DEBUG - HU date already expired after 261 days.
2025-11-12 05:39:27,538 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:39:27,542 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:39:27,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:27,617 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:39:34,097 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:39:34,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:39:35,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:39:37,129 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:39:42,798 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 05:39:45,830 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 05:39:46,835 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:39:46,840 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:39:46,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:47,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:47,328 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:39:47,391 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:39:47,497 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:39:48,593 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:39:48,823 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:39:50,431 - ispa_next.functions - DEBUG - Updated appointment (AG00016916) customer contact data.
2025-11-12 05:39:51,362 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:39:51,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:51,444 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:39:51,649 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:39:51,653 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:39:51,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:39:52,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:39:53,595 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:39:53,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:39:53,677 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:39:57,686 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 05:39:57,686 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:39:57,686 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:39:57,690 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:39:57,691 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:39:57,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:39:58,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:40:02,397 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:40:02,403 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:40:02,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:40:02,480 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:40:02,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:40:03,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:40:03,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:40:04,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:40:04,043 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:40:05,956 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:40:05,960 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:40:06,880 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:40:06,882 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:40:06,884 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:40:06,887 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:40:06,889 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:40:06,891 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:40:06,891 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:40:06,893 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:40:06,893 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:40:06,895 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:40:06,897 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:40:06,901 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:40:06,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:40:08,811 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 05:40:11,059 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:40:11,074 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:40:11,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:40:13,085 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:40:13,087 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:40:13,089 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:40:13,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:40:14,971 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:40:14,973 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:40:15,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:40:16,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:40:16,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:40:34,407 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:40:38,455 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:40:38,459 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:40:38,459 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:40:39,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:40:39,205 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:40:39,207 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:40:41,067 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:40:48,897 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:40:49,266 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 05:40:49,963 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:40:50,584 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:40:50,586 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:40:53,368 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:40:53,369 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:40:54,116 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:40:54,128 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:40:54,148 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:40:54,157 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:40:54,163 - ispa_next.main - DEBUG - 



2025-11-12 05:40:54,163 - ispa_next.main - DEBUG - starting with process 8 (F-CA 525) of 15
2025-11-12 05:40:54,167 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:40:55,261 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:40:56,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:40:56,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:40:57,955 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:40:57,956 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:41:21,535 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:41:24,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:41:26,643 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:41:26,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:26,709 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:41:26,947 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 05:41:30,723 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:41:30,725 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:41:30,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:30,789 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:41:33,866 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:41:33,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:41:34,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:41:36,922 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:41:37,039 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:41:37,149 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:41:37,249 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:41:37,250 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:41:39,209 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:41:47,679 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:41:48,684 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:41:48,688 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:41:48,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:49,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:49,282 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:41:49,370 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:41:49,472 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:41:50,530 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:41:50,750 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:41:52,416 - ispa_next.functions - DEBUG - Updated appointment (AV00003233) customer contact data.
2025-11-12 05:41:53,330 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:41:53,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:41:53,414 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:41:53,531 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:41:53,533 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:41:53,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:41:54,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:41:55,419 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:41:55,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:41:55,492 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:41:59,058 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:41:59,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:41:59,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:42:01,584 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:42:01,685 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:42:01,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:42:01,860 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:42:01,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:03,762 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:42:12,068 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:43:12,070 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:43:20,629 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:44:20,631 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:44:29,098 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 05:44:33,034 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 05:44:34,041 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:44:34,042 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:44:34,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:44:34,106 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:44:38,239 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:44:38,244 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:44:38,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:44:38,317 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:44:43,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:44:44,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:44:44,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:44:45,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:44:45,084 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:44:46,991 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:44:46,993 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:44:48,413 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:44:48,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:44:48,417 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:44:48,419 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:44:48,419 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:44:48,421 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:44:48,421 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:44:48,423 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:44:48,423 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:44:48,425 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:44:48,427 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:44:48,431 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:44:48,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:50,373 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:44:50,375 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:44:50,379 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:52,217 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:44:52,221 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:44:52,223 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:44:52,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:44:54,121 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:44:54,123 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:44:54,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:44:55,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:44:55,649 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:45:13,683 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:45:18,280 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:45:18,282 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:45:18,283 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:45:18,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:45:19,051 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:45:19,052 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:45:20,891 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:45:28,079 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:45:28,483 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 05:45:28,811 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:45:29,796 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:45:29,797 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:45:32,518 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:45:32,518 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:45:33,420 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:45:33,433 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:45:33,444 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:45:33,454 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:45:33,460 - ispa_next.main - DEBUG - 



2025-11-12 05:45:33,460 - ispa_next.main - DEBUG - starting with process 9 (HN FL 983) of 15
2025-11-12 05:45:33,464 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:45:35,155 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:45:36,277 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:45:36,277 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:45:37,723 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:45:37,724 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:46:09,924 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:46:09,952 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 05:46:09,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:46:10,502 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:46:10,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:46:13,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:46:13,065 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:46:13,856 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:46:13,870 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:46:13,879 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:46:13,890 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:46:13,895 - ispa_next.main - DEBUG - 



2025-11-12 05:46:13,895 - ispa_next.main - DEBUG - starting with process 10 (HU LJ 3118) of 15
2025-11-12 05:46:13,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:46:15,106 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:46:16,323 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:46:16,325 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:46:17,829 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:46:17,830 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:46:51,363 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:46:51,374 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 05:46:51,380 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:46:51,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:46:51,904 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:46:54,415 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:46:54,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:46:55,499 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:46:55,511 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:46:55,522 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:46:55,532 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:46:55,540 - ispa_next.main - DEBUG - 



2025-11-12 05:46:55,540 - ispa_next.main - DEBUG - starting with process 11 (HG-PL 4219) of 15
2025-11-12 05:46:55,544 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:46:56,817 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:46:58,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:46:58,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:46:59,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:46:59,588 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:47:24,451 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:47:27,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:47:32,309 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:47:32,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:32,390 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:47:32,586 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:47:32,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:32,676 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:47:37,213 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:47:37,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:37,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:47:40,458 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:47:40,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:47:41,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:47:43,536 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:47:43,661 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:47:43,736 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:47:43,852 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:47:43,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:47:48,537 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:47:56,913 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:47:57,918 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:47:57,922 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:47:57,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:58,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:47:58,408 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:47:58,458 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:47:59,608 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:48:00,843 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:48:01,094 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:48:02,905 - ispa_next.functions - DEBUG - Updated appointment (AA00029929) customer contact data.
2025-11-12 05:48:03,796 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:48:03,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:48:03,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:48:04,011 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:48:04,013 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:48:04,784 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:48:04,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:48:05,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:48:09,212 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:48:09,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:48:09,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:48:11,698 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:48:11,818 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:48:11,894 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:48:11,981 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:48:11,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:48:16,689 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:48:24,999 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:49:25,002 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:49:36,052 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:49:40,600 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:49:40,602 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:49:45,334 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:49:49,484 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:49:50,492 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:49:50,492 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:49:50,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:49:50,581 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:49:54,703 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:49:58,214 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:49:58,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:49:58,283 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:50:01,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:50:02,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:50:02,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:50:03,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:50:03,033 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:50:07,194 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:50:07,194 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:50:08,245 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:50:08,249 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:50:08,252 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:50:08,254 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:50:08,256 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:50:08,257 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:50:08,258 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:50:08,259 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:50:08,260 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:50:08,261 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:50:08,265 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:50:08,267 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:50:08,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:50:12,909 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:50:12,911 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:50:12,913 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:50:17,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:50:17,579 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:50:26,140 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:50:40,232 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:50:40,233 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:50:40,235 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:50:40,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:50:44,905 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:50:44,909 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:50:45,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:50:46,295 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:50:46,420 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:51:32,021 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:38,337 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:43,333 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:47,734 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:52,376 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:57,372 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:51:57,376 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:51:57,376 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:51:57,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:51:58,060 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:51:58,064 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:52:00,004 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:52:08,337 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:52:08,729 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 05:52:10,320 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:52:11,291 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:52:11,293 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:52:14,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:52:14,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:52:15,682 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:52:15,694 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:52:15,703 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:52:15,714 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:52:15,720 - ispa_next.main - DEBUG - 



2025-11-12 05:52:15,720 - ispa_next.main - DEBUG - starting with process 12 (GN-A 713) of 15
2025-11-12 05:52:15,723 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:52:20,617 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:52:24,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:52:24,614 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:52:27,672 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:52:27,673 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:53:02,819 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:53:05,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:09,100 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:53:09,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:09,206 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:53:09,514 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:53:09,516 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:53:09,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:09,592 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:53:12,888 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:53:12,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:53:14,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:53:16,014 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:53:16,111 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:53:16,199 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:53:16,287 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:53:16,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:19,574 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:53:27,920 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:53:28,925 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:53:28,943 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:53:28,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:29,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:29,442 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:53:29,485 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:53:29,606 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:53:30,707 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:53:30,945 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:53:33,091 - ispa_next.functions - DEBUG - Updated appointment (AB00028015) customer contact data.
2025-11-12 05:53:33,996 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:53:33,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:34,065 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:53:34,193 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:53:34,195 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:53:34,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:53:35,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:53:36,227 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:53:36,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:53:36,300 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:53:39,928 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:53:39,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:53:40,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:53:42,441 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:53:42,549 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:53:42,659 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:53:42,720 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:53:42,722 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:46,097 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:53:54,701 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:54:54,704 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:55:05,531 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:55:10,880 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:55:10,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:55:14,257 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:55:18,420 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:55:19,426 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:55:19,426 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:55:19,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:55:19,497 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:55:23,669 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:55:27,165 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:55:27,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:55:27,236 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:55:32,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:55:33,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:55:33,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:55:34,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:55:34,065 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:55:37,100 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:55:37,102 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:55:38,051 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:55:38,057 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:55:38,059 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:55:38,061 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:55:38,065 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:55:38,066 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:55:38,067 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:55:38,068 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:55:38,070 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:55:38,071 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:55:38,075 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:55:38,077 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:55:38,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:55:41,359 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:55:41,360 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:55:41,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:55:44,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:55:44,620 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:55:53,610 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:05,966 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:56:05,968 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:56:05,970 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:56:05,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:09,284 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:56:09,286 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:56:09,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:56:10,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:56:10,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:42,729 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:56:49,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:56:53,709 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:56:58,747 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:56:58,751 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:56:58,751 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:56:59,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:56:59,594 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:56:59,596 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:57:01,446 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:57:09,820 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:57:10,196 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 05:57:11,508 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:57:12,307 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:57:12,309 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:57:14,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-12 05:57:14,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:57:15,580 - ispa_next.appointments.models - DEBUG - Appointment Willy Ludwig F-WA 2906 WBAJM71070G953163 ohne Termin.
2025-11-12 05:57:15,592 - ispa_next.appointments.models - DEBUG - Appointment Adam Heinrich GN-R 113 WBAFV31060DW18246 ohne Termin.
2025-11-12 05:57:15,602 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 05:57:15,611 - ispa_next.appointments.models - DEBUG - Appointment Süleyman Sagdic HU-AS 1515 WBA5N610X0D926825 ohne Termin.
2025-11-12 05:57:15,616 - ispa_next.main - DEBUG - 



2025-11-12 05:57:15,616 - ispa_next.main - DEBUG - starting with process 13 (BIR-F 196) of 15
2025-11-12 05:57:15,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:57:16,457 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:57:17,415 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 734
2025-11-12 05:57:17,417 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-12 05:57:18,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:57:18,956 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:57:50,470 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:57:53,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:57:56,248 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:57:56,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:57:56,326 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:57:56,513 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:57:56,516 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:57:56,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:57:56,606 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:57:59,702 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:57:59,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:58:01,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:58:03,343 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:58:03,448 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:58:03,541 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:58:03,604 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:58:03,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:06,227 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:58:14,410 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:58:15,416 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:58:15,421 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:58:15,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:16,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:16,266 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:58:16,313 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:58:16,459 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:58:17,629 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:58:17,876 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:58:19,590 - ispa_next.functions - DEBUG - Updated appointment (AE00018235) customer contact data.
2025-11-12 05:58:20,527 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:58:20,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:20,607 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:58:20,728 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:58:20,731 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:58:20,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:58:21,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:58:22,721 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:58:22,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:58:22,816 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:58:26,394 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:58:26,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:58:27,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:58:29,190 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:58:29,293 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:58:29,420 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:58:29,509 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:58:29,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:32,105 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:58:40,469 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:59:40,472 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:59:49,055 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:00:49,057 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:00:57,312 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 06:01:05,239 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 06:01:06,246 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:01:06,246 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 06:01:06,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:01:06,323 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:01:10,479 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 06:01:14,281 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:01:14,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:01:14,391 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:01:25,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:01:25,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:01:25,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:01:26,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:01:26,398 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:01:28,848 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:01:28,850 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:01:30,888 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:01:30,889 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:01:30,890 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:01:30,891 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:01:30,898 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:01:30,900 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:01:30,902 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:01:30,906 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:01:30,906 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:01:30,909 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:01:30,911 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:01:30,914 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:01:30,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:01:33,481 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:01:33,483 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:01:33,485 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:01:36,218 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:01:36,221 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:01:36,224 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:01:36,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:01:38,814 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:01:38,816 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:01:39,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:01:40,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:01:40,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:05,250 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:02:09,226 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:02:13,454 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:02:13,457 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:02:13,458 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:02:14,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:02:14,248 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:02:14,250 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:02:16,019 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:02:41,787 - ispa_next.appointment_ending - DEBUG - return from complete process to close_process save=False after error_dialog appeared.
2025-11-12 06:02:41,872 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 06:02:44,667 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 06:02:44,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:02:46,291 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 0
2025-11-12 06:02:46,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:47,662 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:47,663 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:02:47,995 - ispa_next.main - DEBUG - 



2025-11-12 06:02:47,995 - ispa_next.main - DEBUG - starting with process 14 (HU-RM 109) of 15
2025-11-12 06:02:48,004 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:02:48,627 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:02:49,189 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 0
2025-11-12 06:02:49,190 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:50,446 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:50,447 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:02:50,843 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 42, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 146, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-12 06:02:50,843 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 06:02:50,846 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:02:51,404 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 0
2025-11-12 06:02:51,405 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:52,579 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:52,579 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:02:52,851 - ispa_next.main - DEBUG - 



2025-11-12 06:02:52,851 - ispa_next.main - DEBUG - starting with process 15 (GN-JK 7275) of 15
2025-11-12 06:02:52,855 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:02:53,897 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:02:54,327 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 0
2025-11-12 06:02:54,329 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:55,405 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:55,406 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:02:55,749 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 42, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 146, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-12 06:02:55,749 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 06:02:55,752 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:02:56,357 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 0
2025-11-12 06:02:56,359 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:57,479 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-12 06:02:57,480 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
