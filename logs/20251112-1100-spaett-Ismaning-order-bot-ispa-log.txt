2025-11-12 11:07:34,755 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:07:34,761 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:07:45,013 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:07:55,428 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:08:11,209 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:08:36,588 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:08:53,876 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:08:57,007 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:58,278 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:08:58,279 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 495
2025-11-12 11:09:00,601 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 11:09:00,602 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:09:00,602 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:09:01,443 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:09:02,279 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:11,453 - ispa_next.appointments.models - DEBUG - Appointment Firma Tengelmann Twenty-One KG M-NJ 323 WBA31DZ040FM60809 ohne Termin.
2025-11-12 11:10:11,459 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,470 - ispa_next.appointments.models - DEBUG - Appointment Livia Veitschegger M-V 5084 WBA61CM0908C93157 ohne Termin.
2025-11-12 11:10:11,523 - ispa_next.appointments.models - DEBUG - Appointment Thomas Löb M-L 5621 WBA8H71010A040968 ohne Termin.
2025-11-12 11:10:11,536 - ispa_next.appointments.models - DEBUG - Appointment Antonio Cavar ED-AC 1986 WBA6L31020FJ84465 ohne Termin.
2025-11-12 11:10:11,541 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,558 - ispa_next.appointments.models - DEBUG - Appointment Rebecca Hurst FS-RA 602 WMW31DH0902V63832 ohne Termin.
2025-11-12 11:10:11,563 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,563 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,565 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,566 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,566 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,577 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schulz M-S 7319 WBA61EE0605Y49885 ohne Termin.
2025-11-12 11:10:11,593 - ispa_next.appointments.models - DEBUG - Appointment Firma NEO - Professional Solutions GmbH M-N 917 WBS31AZ000CM52265 ohne Termin.
2025-11-12 11:10:11,615 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,631 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,631 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,632 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,649 - ispa_next.appointments.models - DEBUG - Appointment Faton Halilaj M-DF 1991 WBA6L51030FJ39031 ohne Termin.
2025-11-12 11:10:11,667 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,683 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,686 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,746 - ispa_next.appointments.models - DEBUG - Appointment Martin Lamprecht  WBA7K310807P56396 ohne Termin.
2025-11-12 11:10:11,746 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,758 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,780 - ispa_next.appointments.models - DEBUG - Appointment Josef Deimel M-LW 90 WBATX35040NC13555 ohne Termin.
2025-11-12 11:10:11,792 - ispa_next.appointments.models - DEBUG - Appointment Firma Panavia Aircraft GmbH FS-PA 85E WBA65GP040N362472 ohne Termin.
2025-11-12 11:10:11,821 - ispa_next.appointments.models - DEBUG - Appointment Meisterbetrieb Thomas Patitz  WBA21GW060CU43030 ohne Termin.
2025-11-12 11:10:11,835 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Hanika M-WH 6500 WBA4K31030BG88527 ohne Termin.
2025-11-12 11:10:11,855 - ispa_next.appointments.models - DEBUG - Appointment Nina Bernreuther M-NN 369 WMWLV310502L56279 ohne Termin.
2025-11-12 11:10:11,857 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:11,877 - ispa_next.appointments.models - DEBUG - Appointment Michaela Hartwig M-NR 9641 WBA2E510205G52370 ohne Termin.
2025-11-12 11:10:11,893 - ispa_next.appointments.models - DEBUG - Appointment Firma JTF Beratung und M-JT 700 WBA51AJ0X0CK76754 ohne Termin.
2025-11-12 11:10:11,916 - ispa_next.appointments.models - DEBUG - Appointment Ladislav Kilisek M-JO 1742 WBA2A310207A62139 ohne Termin.
2025-11-12 11:10:11,928 - ispa_next.appointments.models - DEBUG - Appointment Ihor Karnakov M-KA 5871E WBA6N31070FM27147 ohne Termin.
2025-11-12 11:10:11,955 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke AG M-NP 3316 WMW21GA0407S97954 ohne Termin.
2025-11-12 11:10:11,971 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Yazar M-YA 29 WBA6V710005P54227 ohne Termin.
2025-11-12 11:10:11,983 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-12 11:10:11,995 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-12 11:10:12,012 - ispa_next.appointments.models - DEBUG - Appointment Joachim Schubert M-JS 2161 WBA51AB0105U16063 ohne Termin.
2025-11-12 11:10:12,033 - ispa_next.appointments.models - DEBUG - Appointment Imer Jakupi M-LJ 1824 WBA11DY090FK02746 ohne Termin.
2025-11-12 11:10:12,049 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Wydra M-W 5397 WBAJC91010B280060 ohne Termin.
2025-11-12 11:10:12,062 - ispa_next.appointments.models - DEBUG - Appointment   WBABS51040EW00681 ohne Termin.
2025-11-12 11:10:12,074 - ispa_next.appointments.models - DEBUG - Appointment Erwin Jaksch M-EJ 69 WBABG11010ER37920 ohne Termin.
2025-11-12 11:10:12,087 - ispa_next.appointments.models - DEBUG - Appointment Eduard Grimm M-EG 3011 WBS1H91060V916418 ohne Termin.
2025-11-12 11:10:12,102 - ispa_next.appointments.models - DEBUG - Appointment Tarik Sahin M-X 3330 WBAJK51000BJ13877 ohne Termin.
2025-11-12 11:10:12,128 - ispa_next.appointments.models - DEBUG - Appointment Firma ACTRON AG ED-AG 444 WBA5R11080FN22370 ohne Termin.
2025-11-12 11:10:12,144 - ispa_next.appointments.models - DEBUG - Appointment Anja Goetzke M-AG 565 WBAJU810409L17973 ohne Termin.
2025-11-12 11:10:12,166 - ispa_next.appointments.models - DEBUG - Appointment Marco Hübl  WBA21EN0009X29619 ohne Termin.
2025-11-12 11:10:12,179 - ispa_next.appointments.models - DEBUG - Appointment Narayanaswamy Anand M-SN 554 WMWLV710302L69958 ohne Termin.
2025-11-12 11:10:12,193 - ispa_next.appointments.models - DEBUG - Appointment Soria-Vanessa Neumann FS-N 347 WBA2H71010VA14727 ohne Termin.
2025-11-12 11:10:12,194 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:10:12,212 - ispa_next.appointments.models - DEBUG - Appointment Firma ProSiebenSat.1 Media SE M-P 7308 E WBA21EF0405Z47312 ohne Termin.
2025-11-12 11:10:12,297 - ispa_next.main - DEBUG - Found 20 out of 303 appointments to process (configured limit: 20).
2025-11-12 11:10:12,298 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 11:10:12,301 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 11:10:12,301 - ispa_next.main - DEBUG - All appointments: M-DB 9094, HN-MD 369, M-S 5261 E, M-C 9104, M-C 2873, M-QM 521, FS- , M-GA 1515, M-XM 6099E , M-RO 985 E, M-RM 7111, PF-DN 2121, M-BD 1618, M-DA 9696, EBE-SI 16, M-K 1317, EBE-FA 502, M-P 5330, M-P 1017, M-V 5786
2025-11-12 11:10:12,303 - ispa_next.main - DEBUG - 



2025-11-12 11:10:12,303 - ispa_next.main - DEBUG - starting with process 1 (M-DB 9094) of 20
2025-11-12 11:10:12,310 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:10:13,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:10:13,925 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:10:13,926 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 11:10:14,997 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:10:14,998 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:10:40,098 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:10:49,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:10:52,290 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:10:52,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:52,390 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:52,708 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:10:52,714 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:10:55,423 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:55,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:56,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:58,388 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:11:03,708 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 11:11:09,671 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 11:11:10,678 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:11:10,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:11,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:23,916 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:11:31,292 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:11:31,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:31,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:11:31,393 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:11:31,437 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:11:31,561 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:11:32,752 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:11:32,968 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:11:35,808 - ispa_next.functions - DEBUG - Updated appointment (AK00008343) customer contact data.
2025-11-12 11:11:36,761 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:11:36,778 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:11:36,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:11:37,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:11:39,120 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:11:39,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:11:39,205 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:11:43,211 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:11:43,213 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:11:43,213 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:11:43,218 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:11:43,224 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:11:43,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:11:43,794 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:44,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:44,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:11:44,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:11:45,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:11:45,380 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:11:47,894 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:11:47,896 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:11:49,177 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:11:49,179 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:11:49,179 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:11:49,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:11:49,183 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:11:49,183 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:11:49,185 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:11:49,187 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:11:49,187 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:11:49,189 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:11:49,201 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:11:49,206 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:11:49,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:51,815 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:11:51,819 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:11:51,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:54,429 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:11:54,433 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:11:54,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:11:55,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:11:55,184 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:11:55,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:11:57,685 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:12:07,941 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:12:08,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:12:08,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:12:09,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:34,153 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:12:38,179 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:12:42,134 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:12:42,137 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:12:42,139 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:42,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:12:42,720 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:12:42,725 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:12:44,311 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:12:53,125 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:12:53,532 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:12:54,179 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:12:55,201 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:12:55,202 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:12:57,468 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 495
2025-11-12 11:12:57,469 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:12:58,185 - ispa_next.appointments.models - DEBUG - Appointment Firma Tengelmann Twenty-One KG M-NJ 323 WBA31DZ040FM60809 ohne Termin.
2025-11-12 11:12:58,192 - ispa_next.main - DEBUG - Found new Appointment: M-DR 2907
2025-11-12 11:12:58,204 - ispa_next.main - DEBUG - 



2025-11-12 11:12:58,204 - ispa_next.main - DEBUG - starting with process 2 (M-DR 2907) of 21
2025-11-12 11:12:58,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:59,203 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:00,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:13:00,552 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 495
2025-11-12 11:13:01,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:01,861 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:32,417 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:13:34,335 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:13:39,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:39,160 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:39,359 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:13:41,375 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:13:41,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:41,451 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:13:41,717 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:13:41,723 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:13:44,791 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:13:44,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:13:45,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:13:47,985 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:13:48,080 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:13:48,174 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:13:48,276 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:13:48,277 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:13:57,011 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:13:58,018 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:13:58,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:13:58,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:11,372 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:14:14,586 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:14:14,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:14:14,650 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:14:14,650 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:14:14,708 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:14:14,806 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:14:15,937 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 11:14:17,086 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 11:14:17,404 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:14:18,928 - ispa_next.functions - DEBUG - Updated appointment (AA00023683) customer contact data.
2025-11-12 11:14:19,838 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:14:19,842 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:14:20,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:14:20,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:14:21,931 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:14:21,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:14:22,001 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:14:25,966 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:14:25,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:14:26,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:14:28,496 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:14:28,646 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:14:28,774 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:14:28,861 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:14:28,861 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:14:37,470 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:15:37,474 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:15:46,191 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:16:33,192 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:16:41,600 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:16:48,174 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:16:49,186 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:16:49,196 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:16:49,196 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 11:16:49,196 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:16:51,146 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:16:51,148 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:16:52,487 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:16:52,489 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:52,491 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:16:52,491 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:16:52,493 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:16:52,495 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:16:52,495 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:16:52,497 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:16:52,497 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:16:52,499 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:16:52,516 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:16:52,520 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:16:52,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:54,419 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:16:54,423 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:16:54,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:56,368 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:16:56,372 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:16:56,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:16:57,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:16:57,074 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:16:57,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:58,945 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:17:08,750 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:17:09,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:17:09,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:17:09,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:27,097 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:30,813 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:17:30,817 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:17:30,818 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:31,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:17:31,382 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:17:31,386 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:17:33,014 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:17:39,857 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:17:40,240 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:17:40,864 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:41,925 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:17:41,925 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:44,675 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 493
2025-11-12 11:17:44,676 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:17:45,523 - ispa_next.appointments.models - DEBUG - Appointment Firma Tengelmann Twenty-One KG M-NJ 323 WBA31DZ040FM60809 ohne Termin.
2025-11-12 11:17:45,531 - ispa_next.main - DEBUG - 



2025-11-12 11:17:45,531 - ispa_next.main - DEBUG - starting with process 3 (HN-MD 369) of 21
2025-11-12 11:17:45,538 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:17:46,460 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:17:47,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:17:47,297 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 493
2025-11-12 11:17:48,434 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:17:48,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:14,564 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:18:23,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:25,876 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:18:25,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:25,962 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:26,356 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:18:26,360 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:18:29,087 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:18:29,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:18:30,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:18:32,224 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:18:32,357 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:18:35,588 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:18:35,655 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:18:35,656 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:18:44,567 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:18:45,574 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:18:45,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:46,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:49,240 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 11:18:49,248 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:18:49,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:18:49,339 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:18:49,339 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:18:49,393 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:18:50,551 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:18:51,646 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:18:51,851 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:18:54,643 - ispa_next.functions - DEBUG - Updated appointment (AK00008340) customer contact data.
2025-11-12 11:18:55,554 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:18:55,558 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:18:56,509 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:18:56,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:18:57,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:19:00,938 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:00,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:01,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:03,459 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:03,592 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:03,701 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:19:03,773 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:19:03,773 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:19:12,634 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:20:12,636 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:20:23,982 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:20:29,368 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:20:29,368 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:20:31,525 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:20:32,551 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:20:32,555 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:20:32,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:32,622 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:20:38,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:38,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:38,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:39,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:39,404 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:20:41,352 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:20:41,354 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:20:42,554 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:20:42,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:42,558 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:20:42,558 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:20:42,560 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:20:42,564 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:20:42,566 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:20:42,570 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:20:42,574 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:20:42,576 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:20:42,581 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:20:42,585 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:20:42,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:44,496 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:20:47,359 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:20:47,367 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:20:47,370 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:20:49,564 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:20:49,568 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:20:49,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:20:50,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:20:50,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:04,575 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:21:04,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:06,493 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:21:16,143 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:21:16,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:17,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:21:17,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:21:35,194 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:40,588 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:21:46,796 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:21:46,798 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:21:47,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:21:47,653 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:21:47,656 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:21:51,133 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:21:57,435 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:21:57,830 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:21:58,365 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:21:59,411 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:21:59,413 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:01,967 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:22:01,968 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:02,771 - ispa_next.main - DEBUG - Found new Appointment: M-NJ 323
2025-11-12 11:22:02,773 - ispa_next.main - DEBUG - 



2025-11-12 11:22:02,773 - ispa_next.main - DEBUG - starting with process 4 (M-NJ 323) of 22
2025-11-12 11:22:02,779 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:03,736 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:04,661 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:22:04,662 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:22:05,972 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:05,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:27,504 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:22:36,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:36,774 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:36,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:39,572 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:22:39,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:39,647 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:22:39,898 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:22:39,901 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:22:42,824 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:22:42,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:44,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:46,153 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:22:46,258 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:22:49,465 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:22:49,541 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:22:49,543 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:22:58,183 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:22:59,192 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:22:59,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:59,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:13,107 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:23:21,835 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:23:21,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:21,990 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:21,990 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:23:22,027 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:23:23,301 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:23:23,516 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:23:27,488 - ispa_next.functions - DEBUG - Updated appointment (AA00023687) customer contact data.
2025-11-12 11:23:28,436 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:23:28,440 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:23:29,053 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:23:29,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:23:29,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:23:33,373 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:33,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:33,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:35,994 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:36,118 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:36,204 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:36,309 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:23:36,309 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:23:47,170 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:23:51,243 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:23:51,244 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:23:55,440 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:23:56,448 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:23:56,453 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:23:56,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:56,555 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:24:01,343 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 11:24:10,454 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 11:24:18,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:19,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:19,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:19,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:19,920 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:24:22,354 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:24:22,359 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:24:23,401 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:24:23,402 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:23,406 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:24:23,408 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:23,410 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:24:23,412 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:24:23,414 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:24:23,416 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:24:23,418 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:24:23,418 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:24:23,424 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:24:23,428 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:24:23,428 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:26,030 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:24:26,036 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:24:26,040 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:28,617 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:24:28,621 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:24:28,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:24:29,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:24:29,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:44,055 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:24:44,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:46,671 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:24:58,149 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:24:58,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:24:59,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:24:59,386 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:24,449 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:29,014 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:33,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:33,358 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:25:33,358 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:33,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:34,066 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:25:34,070 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:25:36,017 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:25:42,735 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:25:43,110 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:25:43,656 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:44,654 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:25:44,655 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:46,957 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:25:46,957 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:47,586 - ispa_next.main - DEBUG - 



2025-11-12 11:25:47,586 - ispa_next.main - DEBUG - starting with process 5 (M-S 5261 E) of 22
2025-11-12 11:25:47,592 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:48,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:49,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 903
2025-11-12 11:25:49,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:25:51,261 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:51,263 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:13,261 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:26:23,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:24,966 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:26:24,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:25,043 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:25,294 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:26:25,299 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:26:28,223 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:26:28,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:29,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:31,489 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:26:31,695 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:26:34,966 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:26:35,080 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:26:35,080 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:26:43,588 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:26:44,595 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:26:44,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:45,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:56,456 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:27:04,559 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:27:04,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:04,634 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:27:04,635 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:27:04,710 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:27:05,954 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:27:07,212 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:27:07,433 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:27:09,132 - ispa_next.functions - DEBUG - Updated appointment (AK00008336) customer contact data.
2025-11-12 11:27:10,032 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:27:10,034 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:27:10,758 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:27:10,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:27:11,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:27:15,499 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:27:15,499 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:27:15,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:16,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:18,037 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:27:18,231 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:27:18,642 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:27:18,759 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:27:18,759 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:27:29,622 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:27:33,729 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:27:33,729 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:27:37,929 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:27:38,937 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:27:38,944 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:27:38,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:39,005 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:27:48,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:48,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:48,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:49,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:49,561 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:27:51,389 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:27:51,391 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:27:52,148 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:27:52,150 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:27:52,152 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:27:52,154 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:27:52,156 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:27:52,157 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:27:52,159 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:27:52,163 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:27:52,165 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:27:52,167 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:27:52,173 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:27:52,177 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:27:52,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:54,077 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:27:54,081 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:27:54,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:55,981 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:27:55,987 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:27:55,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:27:56,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:27:56,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:06,343 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:28:06,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:08,271 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:28:19,731 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:28:20,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:20,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:28:20,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:28:39,412 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:44,108 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:44,112 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:28:44,112 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:44,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:44,838 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:28:44,841 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:28:46,552 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:28:54,798 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:28:55,202 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:28:55,522 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:56,660 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:28:56,662 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:00,110 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:29:00,111 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:00,883 - ispa_next.main - DEBUG - 



2025-11-12 11:29:00,883 - ispa_next.main - DEBUG - starting with process 6 (M-C 9104) of 22
2025-11-12 11:29:00,891 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:01,736 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:02,971 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:29:02,972 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:29:04,214 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:04,215 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:35,996 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:29:36,087 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:29:36,091 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:36,607 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:29:36,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:39,126 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:29:39,127 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:29:39,784 - ispa_next.main - DEBUG - 



2025-11-12 11:29:39,785 - ispa_next.main - DEBUG - starting with process 7 (M-C 2873) of 22
2025-11-12 11:29:39,792 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:29:40,644 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:29:41,553 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:29:41,554 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:29:42,817 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:29:42,818 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:30:04,865 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:30:15,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:30:17,137 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:30:17,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:17,206 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:30:17,565 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:30:17,571 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:30:20,437 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:30:20,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:30:21,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:30:23,723 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:30:23,816 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:30:27,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:30:27,127 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:30:27,127 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:30:35,824 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:30:36,832 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:30:36,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:37,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:47,427 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 11:30:55,499 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:30:55,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:30:55,562 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:30:55,564 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:30:55,612 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:30:56,843 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:30:57,960 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:30:58,213 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:30:59,876 - ispa_next.functions - DEBUG - Updated appointment (AK00008327) customer contact data.
2025-11-12 11:31:00,765 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:31:00,769 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:31:01,595 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:31:01,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:31:02,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:31:06,769 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:31:06,769 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:31:06,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:07,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:09,320 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:31:09,453 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:31:09,601 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:31:09,685 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:31:09,686 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:31:20,621 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:31:25,684 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:31:25,684 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:31:29,863 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:31:30,870 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:31:30,890 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:31:30,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:31,030 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:31:40,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:40,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:31:40,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:31:41,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:31:41,664 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:31:43,580 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:31:43,582 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:31:44,586 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:31:44,590 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:31:44,592 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:31:44,594 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:31:44,597 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:31:44,599 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:31:44,601 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:31:44,602 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:31:44,603 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:31:44,605 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:31:44,610 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:31:44,614 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:31:44,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:46,544 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:31:46,548 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:31:46,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:48,430 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:31:48,434 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:31:48,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:31:49,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:31:49,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:31:58,756 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:31:58,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:00,665 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:32:12,411 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:32:12,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:32:13,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:32:13,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:32:31,783 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:32:36,529 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:32:36,534 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:32:36,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:32:37,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:32:37,274 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:32:37,278 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:32:39,277 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:32:47,742 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:32:48,159 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:32:48,853 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:50,138 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:32:50,138 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:52,577 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:32:52,577 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:32:53,338 - ispa_next.main - DEBUG - 



2025-11-12 11:32:53,338 - ispa_next.main - DEBUG - starting with process 8 (M-QM 521) of 22
2025-11-12 11:32:53,345 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:32:54,272 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:32:55,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:32:55,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:32:56,422 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:32:56,423 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:33:31,478 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:33:42,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:33:47,581 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:33:47,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:33:47,661 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:33:47,875 - ispa_next.functions - DEBUG - HU date already expired after 77 days.
2025-11-12 11:33:55,519 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:33:55,525 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:33:58,425 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:33:58,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:33:59,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:34:01,750 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:34:01,862 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:34:05,110 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:34:05,186 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:34:05,186 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:34:13,911 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:34:14,918 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:34:14,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:15,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:29,332 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:34:38,015 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:34:38,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:34:38,097 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:34:38,097 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:34:38,148 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:34:39,419 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:34:39,628 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:34:42,581 - ispa_next.functions - DEBUG - Updated appointment (AK00008326) customer contact data.
2025-11-12 11:34:43,517 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:34:43,771 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:34:44,424 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:34:44,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:34:45,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:34:48,742 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:34:48,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:34:49,220 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:34:51,224 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:34:51,340 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:34:51,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:34:51,548 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:34:51,548 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:35:00,299 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:36:00,303 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:36:11,351 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:36:15,499 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:36:15,499 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:36:17,986 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:36:19,143 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:36:19,149 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:36:19,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:19,375 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:36:23,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:24,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:36:24,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:24,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:36:24,807 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:36:30,826 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:36:30,828 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:36:31,914 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:36:31,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:31,919 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:36:31,919 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:36:31,921 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:36:31,923 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:36:31,923 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:36:31,925 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:36:31,926 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:36:31,927 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:36:31,938 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:36:31,942 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:36:31,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:38,757 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:36:41,654 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:36:41,664 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:36:41,668 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:36:48,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:36:48,801 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:36:59,653 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:36:59,657 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:36:59,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:37:00,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:37:00,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:16,938 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:37:16,941 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:37:23,839 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:37:35,268 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:37:35,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:37:36,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:37:36,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:38:42,597 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:47,797 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:38:54,101 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:38:54,101 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:38:54,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:38:54,957 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:38:54,961 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:38:58,319 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:39:07,357 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:39:07,727 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:39:08,825 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:09,753 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:39:09,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:12,750 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:39:12,751 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:13,602 - ispa_next.main - DEBUG - 



2025-11-12 11:39:13,602 - ispa_next.main - DEBUG - starting with process 9 (FS- ) of 22
2025-11-12 11:39:13,609 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:39:14,833 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:15,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:39:15,967 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:39:17,571 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:39:17,572 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:39:57,598 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:39:57,610 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:39:57,618 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:39:58,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:39:58,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:40:00,668 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-12 11:40:00,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:40:01,514 - ispa_next.main - DEBUG - 



2025-11-12 11:40:01,514 - ispa_next.main - DEBUG - starting with process 10 (M-GA 1515) of 22
2025-11-12 11:40:01,520 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:40:02,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:40:03,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:40:03,892 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-12 11:40:05,291 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:40:05,293 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:40:31,668 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:40:41,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:40:44,449 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:40:44,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:40:44,521 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:40:44,685 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:40:44,693 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:40:47,376 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:40:47,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:40:48,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:40:50,485 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:40:50,587 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:40:53,813 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:41:01,459 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:41:02,474 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:41:02,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:03,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:14,713 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:41:22,162 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:41:22,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:41:22,256 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:41:22,257 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:41:22,322 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:41:23,822 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:41:24,034 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:41:27,074 - ispa_next.functions - DEBUG - Updated appointment (AD00013304) customer contact data.
2025-11-12 11:41:28,080 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:41:28,085 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:41:28,887 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:41:28,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:41:29,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:41:33,787 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:41:33,787 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:41:33,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:41:34,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:41:36,611 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:41:36,733 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:41:36,822 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:41:36,887 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:41:36,887 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:41:45,614 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:42:45,616 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:42:54,093 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:43:32,099 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:43:43,000 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 11:43:47,360 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:43:47,360 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:43:51,733 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:43:52,742 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:43:52,747 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:43:52,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:52,831 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:43:56,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:57,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:43:57,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:43:58,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:43:58,214 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:44:01,265 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:44:01,267 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:44:02,257 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:44:02,259 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:44:02,259 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:44:02,261 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:44:02,264 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:44:02,265 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:44:02,265 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:44:02,267 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:44:02,274 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:44:02,277 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:44:02,287 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:44:02,291 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:44:02,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:05,553 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:44:05,559 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:44:05,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:08,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:44:08,919 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:44:19,107 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:44:19,110 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:44:19,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:44:19,956 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:44:20,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:35,314 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:44:35,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:44:38,703 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:44:50,796 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:44:51,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:44:51,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:44:51,979 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:45:23,440 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:27,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:31,959 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:45:38,270 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:45:38,270 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:45:39,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:45:39,091 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:45:39,096 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:45:42,477 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:45:50,951 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:45:51,318 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:45:52,754 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:45:53,662 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:45:53,664 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:45:56,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 486
2025-11-12 11:45:56,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:45:57,122 - ispa_next.main - DEBUG - 



2025-11-12 11:45:57,122 - ispa_next.main - DEBUG - starting with process 11 (M-XM 6099E ) of 22
2025-11-12 11:45:57,128 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:45:58,013 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:45:58,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:45:59,000 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 486
2025-11-12 11:46:00,620 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:46:00,621 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:46:40,727 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:46:40,739 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 11:46:40,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:46:41,282 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:46:41,283 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:46:44,569 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 486
2025-11-12 11:46:44,570 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:46:45,422 - ispa_next.main - DEBUG - 



2025-11-12 11:46:45,422 - ispa_next.main - DEBUG - starting with process 12 (M-RO 985 E) of 22
2025-11-12 11:46:45,428 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:46:46,584 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:46:47,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:46:47,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 486
2025-11-12 11:46:49,289 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:46:49,291 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:47:20,232 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:47:20,244 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 11:47:20,250 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:20,699 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:47:20,701 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:23,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 486
2025-11-12 11:47:23,406 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:47:24,644 - ispa_next.main - DEBUG - 



2025-11-12 11:47:24,645 - ispa_next.main - DEBUG - starting with process 13 (M-RM 7111) of 22
2025-11-12 11:47:24,651 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:47:25,880 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:47:27,131 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:47:27,133 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 486
2025-11-12 11:47:28,720 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:47:28,722 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:47:53,073 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:48:03,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:48:06,874 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:48:06,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:06,969 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:48:07,153 - ispa_next.functions - DEBUG - HU date already expired after 140 days.
2025-11-12 11:48:14,894 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:48:14,899 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:48:17,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:48:17,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:48:18,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:48:20,712 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:48:20,807 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:48:24,006 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:48:24,071 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:48:24,071 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:48:32,780 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:48:33,787 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:48:33,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:34,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:46,520 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:48:54,341 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:48:54,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:48:54,407 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:48:54,407 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:48:54,470 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:48:55,725 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:48:55,950 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:48:59,136 - ispa_next.functions - DEBUG - Updated appointment (AF00012146) customer contact data.
2025-11-12 11:49:00,042 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:49:00,047 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:49:00,805 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:49:00,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:49:01,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:49:05,204 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:49:05,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:49:06,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:49:08,015 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:49:08,138 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:49:08,217 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:49:08,289 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:49:08,289 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:49:16,959 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:50:16,961 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:50:25,762 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:50:53,764 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:51:02,154 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:51:09,703 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:51:10,712 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:51:10,716 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:51:10,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:51:10,778 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:51:11,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:51:11,649 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:51:11,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:51:12,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:51:12,436 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:51:15,481 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:51:15,483 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:51:16,528 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:51:16,530 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:51:16,530 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:51:16,532 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:51:16,532 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:51:16,534 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:51:16,534 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:51:16,534 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:51:16,536 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:51:16,537 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:51:16,542 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:51:16,546 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:51:16,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:19,934 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:51:19,938 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:51:19,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:23,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:51:23,374 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:51:35,894 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:51:35,898 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:51:35,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:51:36,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:51:36,612 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:51:36,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:51:39,950 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:51:51,160 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:51:51,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:51:52,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:51:52,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:52:24,382 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:52:29,119 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:52:35,060 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:52:35,061 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:52:35,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:52:35,778 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:52:35,783 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:52:39,280 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 11:52:48,139 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:52:48,534 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 11:52:50,009 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:52:50,788 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:52:50,789 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:52:53,955 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 11:52:53,955 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:52:54,882 - ispa_next.main - DEBUG - 



2025-11-12 11:52:54,883 - ispa_next.main - DEBUG - starting with process 14 (PF-DN 2121) of 22
2025-11-12 11:52:54,889 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:52:56,036 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:52:57,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:52:57,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 11:52:58,763 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:52:58,764 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:53:39,426 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:53:39,439 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 11:53:39,446 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:53:40,001 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:53:40,003 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:53:42,840 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 11:53:42,841 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:53:43,673 - ispa_next.main - DEBUG - 



2025-11-12 11:53:43,674 - ispa_next.main - DEBUG - starting with process 15 (M-BD 1618) of 22
2025-11-12 11:53:43,681 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:53:44,905 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:53:46,183 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 11:53:46,184 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 11:53:47,726 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:53:47,727 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:54:14,913 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:54:25,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:54:30,559 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:54:30,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:30,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:54:30,912 - ispa_next.functions - DEBUG - HU date already expired after 77 days.
2025-11-12 11:54:38,810 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:54:38,814 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:54:41,585 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:54:41,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:54:42,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:54:44,682 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:54:44,789 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:54:47,971 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:54:48,063 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:54:48,063 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:54:56,786 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:54:57,792 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:54:57,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:54:58,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:55:10,345 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:55:10,345 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:55:17,834 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:55:17,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:55:18,002 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:55:18,002 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:55:18,042 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:55:18,603 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:55:19,823 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:55:20,040 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:55:23,356 - ispa_next.functions - DEBUG - Updated appointment (AF00012123) customer contact data.
2025-11-12 11:55:24,371 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:55:24,374 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:55:24,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:55:25,416 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:55:27,534 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:55:27,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:55:27,606 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:55:31,201 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:55:31,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:55:31,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:55:33,733 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:55:33,821 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:55:33,937 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:55:33,998 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:55:33,998 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:55:42,573 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:56:42,575 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:56:51,506 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:57:15,508 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:57:24,041 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:57:32,350 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:57:33,360 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:57:33,365 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:57:33,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:57:33,429 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:57:33,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:57:34,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:57:34,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:57:35,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:57:35,029 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:57:39,271 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:57:39,273 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:57:40,746 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:57:40,748 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:57:40,749 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:57:40,749 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:57:40,751 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:57:40,753 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:57:40,753 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:57:40,755 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:57:40,756 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:57:40,758 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:57:40,763 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:57:40,767 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:57:40,767 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:57:45,529 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:57:45,535 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:57:45,535 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:57:50,244 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:57:50,248 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:57:50,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:57:50,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:57:51,069 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:57:51,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:57:55,730 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:58:06,923 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:58:07,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:58:07,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:58:08,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:58:53,786 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:58:58,611 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:02,841 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:07,870 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:12,068 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:17,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:59:17,461 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:59:17,461 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:59:18,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:59:18,197 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:59:18,201 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:59:20,088 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:59:28,211 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:59:28,592 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 11:59:29,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:59:31,130 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 11:59:31,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:59:34,136 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 11:59:34,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:59:34,900 - ispa_next.main - DEBUG - 



2025-11-12 11:59:34,900 - ispa_next.main - DEBUG - starting with process 16 (M-DA 9696) of 22
2025-11-12 11:59:34,906 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:59:36,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:59:37,310 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 11:59:37,311 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 11:59:38,931 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:59:38,933 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:00:12,224 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:00:22,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:00:24,774 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:00:24,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:00:24,858 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:00:25,140 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:00:25,183 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:00:28,069 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:00:28,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:00:29,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:00:31,505 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:00:31,630 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:00:34,838 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:00:34,991 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:00:34,991 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:00:44,367 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:00:45,374 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:00:45,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:00:45,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:00:56,715 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:01:04,035 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:01:04,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:01:04,127 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:01:04,127 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:01:04,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:01:05,469 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:01:05,693 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:01:09,246 - ispa_next.functions - DEBUG - Updated appointment (AF00012106) customer contact data.
2025-11-12 12:01:10,316 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:01:10,320 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:01:11,028 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:01:11,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:01:12,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:01:16,113 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:01:16,113 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:01:16,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:01:16,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:01:18,620 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:01:18,772 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:01:18,855 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:01:18,956 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:01:18,956 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:01:27,780 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:02:27,782 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:02:36,998 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:03:13,001 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:03:21,668 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 12:03:29,460 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 12:03:30,482 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:03:30,486 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:03:30,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:03:30,567 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:03:30,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:03:31,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:03:31,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:03:32,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:03:32,183 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:03:34,118 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:03:34,120 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:03:35,505 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:03:35,506 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:03:35,508 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:03:35,520 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:03:35,522 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:03:35,524 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:03:35,524 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:03:35,526 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:03:35,528 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:03:35,528 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:03:35,532 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:03:35,538 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:03:35,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:37,565 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:03:37,569 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:03:37,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:39,971 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:03:39,975 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:03:39,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:03:40,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:03:40,835 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:03:40,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:03:42,774 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:03:54,180 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:03:54,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:03:55,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:03:55,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:04:13,609 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:18,154 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:04:18,158 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:04:18,160 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:04:18,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:04:18,778 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:04:18,781 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:04:20,457 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:04:28,003 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:04:28,402 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 12:04:29,056 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:04:30,409 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:04:30,411 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:04:33,642 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 12:04:33,643 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:04:34,618 - ispa_next.main - DEBUG - 



2025-11-12 12:04:34,618 - ispa_next.main - DEBUG - starting with process 17 (EBE-SI 16) of 22
2025-11-12 12:04:34,625 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:04:35,762 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:04:36,754 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:04:36,755 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 12:04:38,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:04:38,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:05:15,279 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:05:25,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:05:27,805 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:05:27,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:05:27,914 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:05:28,147 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:05:28,154 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:05:31,017 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:05:31,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:05:32,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:05:34,331 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:05:34,447 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:05:37,686 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:05:37,779 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:05:37,779 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:05:46,801 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:05:47,808 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:05:47,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:05:48,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:00,142 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:06:00,142 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:06:07,911 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:06:07,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:06:07,993 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:06:07,994 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:06:08,031 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:06:09,281 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:06:10,442 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:06:10,662 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:06:14,720 - ispa_next.functions - DEBUG - Updated appointment (AF00012099) customer contact data.
2025-11-12 12:06:15,624 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:06:15,628 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:06:16,630 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:06:16,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:06:17,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:06:21,290 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:06:21,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:06:21,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:06:23,838 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:06:23,986 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:06:24,101 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:06:24,212 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:06:24,214 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:06:33,082 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:07:33,089 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:07:44,188 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:07:49,461 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:07:49,461 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:07:53,625 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:07:54,634 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:07:54,638 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:07:54,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:07:54,736 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:08:00,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:08:00,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:08:00,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:08:01,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:08:01,673 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:08:04,269 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:08:04,274 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:08:05,297 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:08:05,299 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:08:05,301 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:08:05,302 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:08:05,304 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:08:05,305 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:08:05,306 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:08:05,307 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:08:05,312 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:08:05,312 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:08:05,318 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:08:05,322 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:08:05,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:07,954 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:08:07,960 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:08:07,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:10,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:08:10,753 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:08:20,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:33,574 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:08:33,581 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:08:33,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:08:34,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:08:35,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:42,957 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:08:42,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:08:45,661 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:08:57,828 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:08:58,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:08:58,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:08:59,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:09:24,353 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:09:29,023 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:09:35,058 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:09:35,064 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:35,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:09:35,649 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:09:35,653 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:09:38,739 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:09:47,646 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:09:48,025 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 12:09:49,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:50,489 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:09:50,489 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:53,836 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 12:09:53,836 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:09:54,688 - ispa_next.main - DEBUG - 



2025-11-12 12:09:54,688 - ispa_next.main - DEBUG - starting with process 18 (M-K 1317) of 22
2025-11-12 12:09:54,698 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:09:55,897 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:09:57,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:09:57,130 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 12:09:59,819 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:09:59,820 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:10:34,677 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:10:36,281 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:10:41,130 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:10:42,360 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:10:42,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:42,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:10:42,609 - ispa_next.functions - DEBUG - HU date already expired after 10 days.
2025-11-12 12:10:45,919 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:10:45,923 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:10:48,615 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:10:48,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:10:50,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:10:52,019 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:10:52,186 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:10:52,273 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:10:52,373 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:10:56,561 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:10:57,567 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:10:57,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:10:58,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:07,627 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:11:11,997 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:11:11,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:12,124 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:11:12,124 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:11:12,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:11:12,281 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:11:13,536 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:11:14,870 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:11:15,296 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:11:17,427 - ispa_next.functions - DEBUG - Updated appointment (AA00023546) customer contact data.
2025-11-12 12:11:18,498 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:11:18,502 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:11:18,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:11:19,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:11:20,838 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:11:20,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:11:20,979 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:11:24,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:11:24,599 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:11:24,604 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:11:24,608 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:11:24,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:11:25,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:11:25,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:26,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:11:26,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:11:26,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:11:26,758 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:11:28,093 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:11:28,095 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:11:29,607 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:11:29,609 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:11:29,611 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:11:29,611 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:11:29,613 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:11:29,614 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:11:29,614 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:11:29,616 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:11:29,617 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:11:29,618 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:11:29,623 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:11:29,626 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:11:29,627 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:30,838 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:11:30,843 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:11:30,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:32,008 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:11:32,012 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:11:32,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:11:33,133 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:11:33,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:41,333 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:11:41,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:11:42,630 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:11:55,332 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:11:55,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:11:56,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:11:56,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:12:08,988 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:12:08,994 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:12:08,994 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:12:09,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:12:09,729 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:12:09,733 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:12:11,430 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:12:18,831 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:12:19,226 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 12:12:20,182 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:12:21,714 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:12:21,716 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:12:25,198 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 12:12:25,199 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:12:26,046 - ispa_next.main - DEBUG - 



2025-11-12 12:12:26,047 - ispa_next.main - DEBUG - starting with process 19 (EBE-FA 502) of 22
2025-11-12 12:12:26,055 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:12:26,926 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:12:27,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:12:27,893 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 12:12:29,388 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:12:29,390 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:12:58,581 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:13:00,736 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:13:07,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:13:09,071 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:13:09,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:09,191 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:13:09,402 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:13:09,408 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:13:12,403 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:13:12,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:13:13,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:13:15,969 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:13:16,096 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:13:16,216 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:13:16,281 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:13:20,466 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:13:21,474 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:13:21,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:21,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:33,520 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:13:37,595 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:13:37,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:37,654 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:13:37,655 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:13:37,704 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:13:38,899 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:13:39,125 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:13:41,126 - ispa_next.functions - DEBUG - Updated appointment (AF00012098) customer contact data.
2025-11-12 12:13:42,138 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:13:42,142 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:13:42,713 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:13:42,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:13:43,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:13:47,746 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:13:47,746 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:13:47,746 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:13:47,750 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:13:47,754 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:13:47,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:13:48,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:13:53,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:54,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:13:54,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:13:55,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:13:55,110 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:13:57,106 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:13:57,108 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:13:58,358 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:13:58,359 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:13:58,359 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:13:58,362 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:13:58,363 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:13:58,364 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:13:58,365 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:13:58,366 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:13:58,367 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:13:58,368 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:13:58,374 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:13:58,383 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:13:58,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:00,357 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:14:00,361 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:14:00,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:02,279 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:14:02,283 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:14:02,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:14:03,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:14:03,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:13,210 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:14:13,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:15,308 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:14:26,000 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:14:26,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:14:27,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:14:27,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:14:45,416 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:14:50,624 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:14:50,627 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:14:50,629 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:14:51,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:14:51,452 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:14:51,456 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:14:53,292 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:15:01,966 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:15:02,336 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 12:15:03,350 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:15:04,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:15:04,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:15:08,637 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 12:15:08,638 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:15:09,660 - ispa_next.main - DEBUG - 



2025-11-12 12:15:09,660 - ispa_next.main - DEBUG - starting with process 20 (M-P 5330) of 22
2025-11-12 12:15:09,670 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:15:10,773 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:15:11,601 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:15:11,602 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 12:15:13,168 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:15:13,170 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:15:41,939 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:15:43,842 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:15:49,545 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:15:51,473 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:15:51,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:15:51,580 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:15:51,903 - ispa_next.functions - DEBUG - HU date already expired after 412 days.
2025-11-12 12:15:56,076 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:15:56,107 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:15:58,997 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:15:58,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:16:01,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:16:03,620 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:16:03,759 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:16:03,908 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:16:03,982 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:16:08,224 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:16:09,232 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:16:09,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:09,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:25,201 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:16:29,748 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:16:29,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:29,855 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:16:29,855 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:16:29,908 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:16:30,006 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:16:31,126 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:16:32,947 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:16:33,292 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:16:35,441 - ispa_next.functions - DEBUG - Updated appointment (AA00023288) customer contact data.
2025-11-12 12:16:36,472 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:16:36,478 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:16:36,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:16:37,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:16:38,929 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:16:38,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:16:38,996 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:16:42,595 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:16:42,595 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:16:42,601 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:16:42,607 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:16:42,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:16:43,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:16:43,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:44,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:16:44,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:16:44,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:16:44,826 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:16:46,875 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:16:46,890 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:16:48,586 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:16:48,588 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:16:48,590 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:16:48,592 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:16:48,595 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:16:48,597 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:16:48,598 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:16:48,600 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:16:48,604 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:16:48,606 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:16:48,610 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:16:48,614 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:16:48,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:16:50,725 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:16:50,728 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:16:50,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:16:52,599 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:16:52,603 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:16:52,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:16:53,938 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:16:54,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:03,468 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:17:03,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:05,471 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:17:17,052 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:17:17,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:17:18,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:17:18,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:17:36,635 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:17:41,878 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:17:41,882 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:17:41,884 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:17:42,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:17:42,632 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:17:42,636 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:17:44,413 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:17:52,467 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:17:52,879 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 12:17:53,963 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:17:55,620 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:17:55,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:17:58,931 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 485
2025-11-12 12:17:58,932 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:17:59,868 - ispa_next.main - DEBUG - 



2025-11-12 12:17:59,869 - ispa_next.main - DEBUG - starting with process 21 (M-P 1017) of 22
2025-11-12 12:17:59,875 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:01,225 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:02,657 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 906
2025-11-12 12:18:02,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 485
2025-11-12 12:18:04,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:04,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:32,945 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:18:35,203 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:18:41,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:18:44,315 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:18:44,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:18:44,415 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:18:44,649 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:18:44,653 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:18:47,518 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:18:47,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:18:49,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:18:51,091 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:18:51,240 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:18:51,357 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:18:51,468 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:18:55,663 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:18:56,676 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:18:56,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:18:57,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:10,679 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:19:10,679 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:19:15,576 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:19:15,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:15,637 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:15,638 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:19:15,687 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:19:17,027 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:19:17,236 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:19:20,530 - ispa_next.functions - DEBUG - Updated appointment (AA00023464) customer contact data.
2025-11-12 12:19:21,600 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:19:21,604 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:19:22,208 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:19:22,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:19:23,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:19:27,001 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:27,001 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:19:27,006 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:19:27,013 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:19:27,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:27,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:33,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:33,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:33,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:34,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:34,445 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:19:37,017 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:19:37,017 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:19:38,149 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:19:38,151 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:19:38,151 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:19:38,153 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:19:38,153 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:19:38,155 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:19:38,161 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:19:38,164 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:19:38,168 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:19:38,171 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:19:38,177 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:19:38,182 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:19:38,183 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:40,815 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:19:40,819 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:19:40,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:43,533 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:19:43,537 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:19:43,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:19:44,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:19:44,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:54,839 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:19:54,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:57,386 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:20:07,719 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:20:08,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:20:08,951 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:20:09,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:34,843 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:20:39,833 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:20:45,638 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:20:45,643 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:20:45,644 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:20:46,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:20:46,415 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:20:46,419 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:20:48,353 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:20:57,447 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:20:57,831 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-12 12:20:58,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:01,609 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:21:01,611 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:05,166 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 484
2025-11-12 12:21:05,167 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:21:06,051 - ispa_next.main - DEBUG - 



2025-11-12 12:21:06,051 - ispa_next.main - DEBUG - starting with process 22 (M-V 5786) of 22
2025-11-12 12:21:06,057 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:07,231 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:08,582 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 905
2025-11-12 12:21:08,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 484
2025-11-12 12:21:11,111 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:11,113 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:21:38,974 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:21:40,895 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:21:46,907 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:48,204 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:21:48,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:21:48,293 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:21:48,630 - ispa_next.functions - DEBUG - HU date already expired after 49 days.
2025-11-12 12:21:52,826 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:21:52,831 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:21:55,685 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:21:55,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:21:58,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:00,303 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:22:00,410 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:22:00,512 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:22:00,583 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:22:00,584 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:22:09,577 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:22:10,585 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:22:10,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:11,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:24,882 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:22:30,065 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:22:30,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:30,143 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:30,145 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:22:30,206 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:22:31,489 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:22:31,726 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:22:34,296 - ispa_next.functions - DEBUG - Updated appointment (AA00023660) customer contact data.
2025-11-12 12:22:35,218 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:22:35,232 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:22:37,170 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:22:37,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:22:38,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:22:42,156 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:22:42,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:42,634 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:44,637 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:22:44,778 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:22:44,870 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:22:45,000 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:22:45,002 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:22:56,362 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:23:00,747 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:23:00,747 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:23:04,967 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:23:05,975 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:23:05,981 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:23:05,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:06,057 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:23:11,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:12,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:12,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:13,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:13,281 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:23:14,618 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:23:14,620 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:23:16,192 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:23:16,192 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:23:16,194 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:23:16,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:23:16,196 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:23:16,196 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:23:16,198 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:23:16,198 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:23:16,200 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:23:16,200 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:23:16,205 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:23:16,210 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:23:16,210 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:17,394 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:23:17,398 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:23:17,400 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:18,592 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:23:18,596 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:23:18,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 12:23:19,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 12:23:19,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:33,966 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:23:33,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:35,236 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:23:46,911 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:23:47,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:23:48,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:23:48,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:01,333 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:01,338 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:24:01,339 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:24:01,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:24:01,884 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:24:01,887 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:24:03,503 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:24:11,952 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:24:12,329 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-12 12:24:13,839 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:24:14,915 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 904
2025-11-12 12:24:14,916 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:24:19,300 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 12:24:19,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
