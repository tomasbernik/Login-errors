2025-11-17 13:05:56,052 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:05:56,059 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:06:17,084 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:06:28,428 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:06:44,107 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:07:09,163 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:07:21,482 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:07:24,837 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:26,186 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:07:26,187 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 13:07:28,867 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 152
2025-11-17 13:07:28,868 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:07:28,868 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:07:30,408 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:07:31,608 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:55,679 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:07:55,682 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:55,701 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 13:07:55,702 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:55,704 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:55,739 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:55,790 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-17 13:07:55,817 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-17 13:07:55,831 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-17 13:07:55,842 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-17 13:07:55,856 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-17 13:07:55,868 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-17 13:07:55,878 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-17 13:07:55,888 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-17 13:07:55,931 - ispa_next.main - DEBUG - Found 15 out of 128 appointments to process (configured limit: 15).
2025-11-17 13:07:55,931 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 13:07:55,931 - ispa_next.main - DEBUG - All appointments: AN-KS 336, HU-VS 232, F-RR 8716, HU-MJ 28, HU-TK 1402, HU-PW 667, FB-B 985, HU-KJ 81, HU-XS 108, HU-AS 958, OF-JF 333, FB-SR 1700, MKK-RM 157, GN-BB 156, MKK-MG 366
2025-11-17 13:07:55,950 - ispa_next.main - DEBUG - 



2025-11-17 13:07:55,950 - ispa_next.main - DEBUG - starting with process 1 (AN-KS 336) of 15
2025-11-17 13:07:55,958 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:57,042 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:57,892 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:07:57,893 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 152
2025-11-17 13:07:59,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:59,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:29,298 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:08:32,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:38,727 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:08:38,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:38,799 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:39,012 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:08:39,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:39,108 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:42,904 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:08:42,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:42,991 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:46,110 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:08:46,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:08:47,219 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:08:49,224 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:08:49,345 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:08:49,439 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:08:49,502 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:08:53,674 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:08:54,694 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:08:54,700 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:08:54,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:55,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:55,259 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:08:55,322 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:08:56,544 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:08:57,803 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:08:58,110 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:08:59,806 - ispa_next.functions - DEBUG - Updated appointment (AB00028058) customer contact data.
2025-11-17 13:09:00,732 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:09:00,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:00,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:09:02,451 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:09:03,103 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:09:03,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:09:03,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:09:07,337 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:09:07,337 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:09:07,343 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:09:07,344 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:09:07,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:07,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:09:12,000 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:09:16,337 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:09:16,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:16,411 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:09:16,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:17,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:17,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:18,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:09:18,072 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:09:23,551 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:09:23,555 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:09:24,679 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:09:24,683 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:09:24,685 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:09:24,694 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:09:24,697 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:09:24,700 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:09:24,701 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:09:24,706 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:09:24,707 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:09:24,717 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:09:24,731 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:09:24,734 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:09:24,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:09:30,789 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:09:30,793 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:09:30,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:09:36,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:36,797 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:09:45,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:02,475 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:10:02,478 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:10:02,480 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:10:02,482 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:10:08,600 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:10:08,603 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:10:09,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:10:09,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:10:10,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:00,597 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:11:00,598 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:01,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:11:01,330 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:11:01,333 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:11:04,834 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:11:15,384 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:11:15,800 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:11:16,965 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:17,656 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:11:17,657 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:20,817 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 13:11:20,818 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:21,651 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:11:21,663 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 13:11:21,664 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:21,665 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:21,670 - ispa_next.main - DEBUG - 



2025-11-17 13:11:21,671 - ispa_next.main - DEBUG - starting with process 2 (HU-VS 232) of 15
2025-11-17 13:11:21,675 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:22,948 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:24,256 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:11:24,258 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 13:11:25,701 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:25,702 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:02,509 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:12:05,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:07,489 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:12:07,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:07,596 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:07,775 - ispa_next.functions - DEBUG - HU date already expired after 1875 days.
2025-11-17 13:12:11,164 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:12:11,167 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:12:11,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:11,248 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:18,412 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:12:18,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:19,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:21,472 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:12:21,595 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:12:21,726 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:12:21,795 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:12:23,952 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:12:24,959 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:12:24,965 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:12:24,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:25,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:25,459 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:12:25,502 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:12:25,604 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:12:26,737 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:12:26,982 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:12:28,847 - ispa_next.functions - DEBUG - Updated appointment (AB00028046) customer contact data.
2025-11-17 13:12:29,771 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:12:29,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:29,859 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:12:30,026 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:12:30,028 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:12:30,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:12:30,956 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:12:31,973 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:12:31,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:12:32,050 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:12:35,646 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:12:35,646 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:12:35,652 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:12:35,653 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:12:35,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:36,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:40,328 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:12:43,950 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:12:43,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:44,025 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:12:44,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:44,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:44,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:45,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:45,660 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:12:47,740 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:12:47,745 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:12:51,319 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:12:51,321 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:12:51,323 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:12:51,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:12:51,327 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:12:51,330 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:12:51,348 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:12:51,351 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:12:51,353 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:12:51,355 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:12:51,360 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:12:51,363 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:12:51,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:53,339 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:12:53,342 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:12:53,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:55,274 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:12:55,276 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:12:55,283 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:12:55,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:57,188 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:12:57,190 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:12:57,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:12:58,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:12:58,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:18,858 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:13:23,739 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:13:23,742 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:13:23,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:13:24,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:13:24,566 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:13:24,568 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:13:26,661 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:13:34,788 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:13:35,205 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:13:35,623 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:13:36,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:13:36,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:13:39,671 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 13:13:39,672 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:13:40,507 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:13:40,520 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 13:13:40,521 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:13:40,523 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:13:40,530 - ispa_next.main - DEBUG - 



2025-11-17 13:13:40,530 - ispa_next.main - DEBUG - starting with process 3 (F-RR 8716) of 15
2025-11-17 13:13:40,536 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:13:41,698 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:13:43,085 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:13:43,087 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 13:13:44,536 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:13:44,537 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:14:11,859 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:14:14,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:15,045 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:15,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:17,775 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:14:17,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:17,855 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:18,059 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-17 13:14:22,390 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:14:22,393 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:14:22,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:22,484 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:29,354 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:29,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:30,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:32,404 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:14:32,515 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:14:32,622 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:14:32,697 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:14:32,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:35,318 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:14:46,582 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:14:47,586 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:14:47,591 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:14:47,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:48,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:48,125 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:14:48,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:14:48,271 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:14:49,382 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:14:49,617 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:14:51,254 - ispa_next.functions - DEBUG - Updated appointment (AB00028034) customer contact data.
2025-11-17 13:14:52,234 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:14:52,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:52,421 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:52,565 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:14:52,567 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:14:52,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:14:53,329 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:14:54,274 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:14:54,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:14:54,394 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:14:58,396 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:58,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:58,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:15:00,910 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:15:01,040 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:15:01,114 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:15:01,225 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:15:01,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:03,843 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:15:15,376 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:16:15,378 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:16:26,976 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:17:11,979 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:17:23,224 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:17:26,646 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:17:27,653 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:17:27,653 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:17:27,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:27,777 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:17:31,963 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:17:31,970 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:17:31,970 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 13:17:31,971 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:17:34,441 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:17:34,443 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:17:35,645 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:17:35,648 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:17:35,651 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:17:35,654 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:17:35,656 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:17:35,658 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:17:35,659 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:17:35,660 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:17:35,661 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:17:35,663 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:17:35,666 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:17:35,669 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:17:35,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:38,343 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:17:38,346 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:17:38,348 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:41,006 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:17:41,009 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:17:41,011 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:17:41,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:43,588 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:17:43,590 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:17:44,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:17:44,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:17:45,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:10,044 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:18:14,277 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:18:18,615 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:18:18,618 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:18:18,618 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:18:19,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:18:19,164 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:18:19,166 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:18:20,599 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:18:27,235 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:18:27,630 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:18:28,368 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:18:29,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 684
2025-11-17 13:18:29,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:18:32,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 13:18:32,518 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:18:33,351 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:18:33,362 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:18:33,375 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:18:33,386 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 13:18:33,387 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:18:33,394 - ispa_next.main - DEBUG - 



2025-11-17 13:18:33,394 - ispa_next.main - DEBUG - starting with process 4 (HU-MJ 28) of 15
2025-11-17 13:18:33,399 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:18:34,629 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:18:36,095 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 684
2025-11-17 13:18:36,096 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 13:18:37,862 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:18:37,863 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:19:05,097 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:19:08,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:10,981 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:19:10,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:11,044 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:19:11,294 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:19:11,297 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:19:11,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:11,420 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:19:14,476 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:19:14,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:15,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:17,688 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:19:17,821 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:19:17,956 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:19:18,030 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:19:22,230 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:19:23,237 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:19:23,241 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:19:23,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:23,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:23,761 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:19:23,799 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:19:25,038 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:19:25,259 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:19:26,987 - ispa_next.functions - DEBUG - Updated appointment (AA00030021) customer contact data.
2025-11-17 13:19:27,928 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:19:27,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:28,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:19:28,243 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:19:28,246 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:19:29,007 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:19:29,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:19:29,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:19:33,393 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:19:33,394 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:19:33,400 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:19:33,401 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:19:33,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:33,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:38,144 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:19:38,150 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:19:38,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:38,219 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:19:38,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:39,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:39,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:39,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:39,982 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:19:42,432 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:19:42,436 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:19:43,455 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:19:43,459 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:43,462 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:19:43,471 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:43,474 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:19:43,476 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:19:43,480 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:19:43,483 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:19:43,502 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:19:43,504 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:19:43,508 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:19:43,510 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:19:43,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:46,102 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:19:46,104 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:19:46,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:48,750 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:19:48,754 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:19:48,758 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:19:48,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:51,440 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:19:51,442 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:19:52,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:19:52,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:19:53,165 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:18,630 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:23,317 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:28,410 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:28,413 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:20:28,414 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:29,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:29,180 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:20:29,183 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:20:31,743 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:20:39,941 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:20:40,317 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:20:40,693 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:41,872 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:20:41,873 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:44,406 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 13:20:44,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:20:45,556 - ispa_next.appointments.models - DEBUG - Appointment hao Zeng  WBA11GF0507S93786 ohne Termin.
2025-11-17 13:20:45,566 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:20:45,576 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:20:45,594 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:20:45,605 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 13:20:45,606 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:20:45,612 - ispa_next.main - DEBUG - 



2025-11-17 13:20:45,612 - ispa_next.main - DEBUG - starting with process 5 (HU-TK 1402) of 15
2025-11-17 13:20:45,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:46,941 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:48,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:20:48,005 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 13:20:49,366 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:49,368 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:21:15,987 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:21:19,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:22,270 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:21:22,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:22,373 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:22,578 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:21:25,999 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:21:26,003 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:21:26,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:26,068 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:32,812 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:21:32,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:33,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:35,889 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:21:35,998 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:21:36,126 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:21:36,206 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:21:40,385 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:21:41,391 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:21:41,395 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:21:41,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:41,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:41,949 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:21:41,994 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:21:43,225 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:21:43,437 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:21:45,188 - ispa_next.functions - DEBUG - Updated appointment (AB00028030) customer contact data.
2025-11-17 13:21:46,134 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:21:46,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:46,225 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:46,384 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:21:46,387 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:21:47,161 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:21:47,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:21:47,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:21:51,971 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:21:51,971 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:21:51,975 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:21:51,976 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:21:51,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:52,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:56,634 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:21:56,639 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:21:56,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:56,744 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:21:57,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:57,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:57,715 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:58,371 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:58,371 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:22:01,484 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:22:01,498 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:22:02,509 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:22:02,510 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:22:02,511 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:22:02,512 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:22:02,513 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:22:02,514 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:22:02,515 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:22:02,520 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:22:02,522 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:22:02,526 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:22:02,532 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:22:02,534 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:22:02,535 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:05,910 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:22:05,912 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:22:05,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:09,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:22:09,332 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:22:20,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:33,450 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:22:33,454 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:22:33,455 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:22:33,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:36,786 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:22:36,789 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:22:37,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:22:39,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:22:39,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:23:11,177 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:23:15,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:23:19,815 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:23:24,678 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:23:24,682 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:23:24,683 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:23:25,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:23:25,455 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:23:25,457 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:23:27,545 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:23:34,816 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:23:35,190 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 13:23:36,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:23:36,870 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:23:36,871 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:23:40,134 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 13:23:40,135 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:23:40,831 - ispa_next.appointments.models - DEBUG - Appointment hao Zeng  WBA11GF0507S93786 ohne Termin.
2025-11-17 13:23:40,842 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:23:40,853 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:23:40,866 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:23:40,891 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 13:23:40,892 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:23:40,898 - ispa_next.main - DEBUG - 



2025-11-17 13:23:40,898 - ispa_next.main - DEBUG - starting with process 6 (HU-PW 667) of 15
2025-11-17 13:23:40,903 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:23:42,145 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:23:43,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:23:43,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 13:23:45,178 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:23:45,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:24:24,010 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:24:27,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:29,213 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:24:29,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:29,289 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:24:29,635 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:24:29,640 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:24:29,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:29,754 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:24:32,746 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:24:32,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:33,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:24:35,803 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:24:35,993 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:24:36,399 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:24:36,483 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:24:40,664 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:24:41,685 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:24:41,689 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:24:41,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:42,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:42,186 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:24:42,284 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:24:43,599 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:24:43,829 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:24:45,636 - ispa_next.functions - DEBUG - Updated appointment (AA00030017) customer contact data.
2025-11-17 13:24:46,536 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:24:46,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:46,686 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:24:46,891 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:24:46,894 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:24:47,671 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:24:47,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:24:48,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:24:52,889 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:24:52,890 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:24:52,898 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:24:52,899 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:24:52,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:53,426 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:24:57,540 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:24:57,545 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:24:57,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:57,615 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:24:57,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:58,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:58,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:59,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:24:59,185 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:25:01,096 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:25:01,100 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:25:02,101 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:25:02,105 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:25:02,108 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:25:02,122 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:25:02,124 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:25:02,126 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:25:02,128 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:25:02,131 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:25:02,133 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:25:02,136 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:25:02,140 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:25:02,142 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:25:02,144 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:04,113 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:25:04,115 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:25:04,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:05,995 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:25:05,998 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:25:06,001 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:25:06,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:07,937 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:25:07,940 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:25:08,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:25:09,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:25:09,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:29,038 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:25:33,589 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:25:33,592 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:25:33,593 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:25:34,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:25:34,380 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:25:34,382 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:25:36,433 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:25:44,878 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:25:45,253 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 13:25:45,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:25:46,746 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:25:46,747 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:25:50,158 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 13:25:50,159 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:25:51,150 - ispa_next.appointments.models - DEBUG - Appointment hao Zeng  WBA11GF0507S93786 ohne Termin.
2025-11-17 13:25:51,161 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:25:51,172 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:25:51,183 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:25:51,194 - ispa_next.appointments.models - DEBUG - Appointment Dirk Greene  WMW31GC01STA92039 ohne Termin.
2025-11-17 13:25:51,195 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:25:51,199 - ispa_next.main - DEBUG - 



2025-11-17 13:25:51,199 - ispa_next.main - DEBUG - starting with process 7 (FB-B 985) of 15
2025-11-17 13:25:51,203 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:25:52,523 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:25:53,936 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:25:53,937 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 13:25:55,664 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:25:55,666 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:26:24,152 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:26:27,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:28,797 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:26:28,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:28,881 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:29,065 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:26:29,068 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:26:29,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:29,156 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:32,190 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:26:32,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:33,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:26:35,409 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:26:35,541 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:26:35,631 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:26:35,764 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:26:39,945 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:26:40,952 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:26:40,957 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:26:40,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:41,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:41,472 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:26:41,544 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:26:42,784 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:26:43,000 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:26:45,228 - ispa_next.functions - DEBUG - Updated appointment (AA00030016) customer contact data.
2025-11-17 13:26:46,165 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:26:46,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:46,232 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:46,394 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:26:46,397 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:26:47,212 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:26:47,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:26:48,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:26:51,733 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:26:51,733 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:26:51,737 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:26:51,738 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:26:51,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:52,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:26:56,476 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:26:56,481 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:26:56,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:56,571 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:27:05,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:05,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:05,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:06,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:06,656 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:27:07,986 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:27:07,988 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:27:08,876 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:27:08,883 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:08,885 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:27:08,886 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:08,903 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:27:08,905 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:27:08,908 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:27:08,909 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:27:08,910 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:27:08,912 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:27:08,915 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:27:08,917 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:27:08,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:10,149 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:27:10,152 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:27:10,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:11,404 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:27:11,407 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:27:11,410 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:27:11,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:12,617 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:27:12,620 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:27:13,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:14,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:27:14,168 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:27,802 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:27,805 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:27:27,806 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:28,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:28,599 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:27:28,601 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:27:30,686 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:27:38,305 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:27:38,701 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 13:27:39,085 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:27:40,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:27:40,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:27:43,232 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 13:27:43,233 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:27:43,946 - ispa_next.appointments.models - DEBUG - Appointment hao Zeng  WBA11GF0507S93786 ohne Termin.
2025-11-17 13:27:43,954 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:27:43,965 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:27:43,975 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:27:43,977 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:27:43,981 - ispa_next.main - DEBUG - 



2025-11-17 13:27:43,981 - ispa_next.main - DEBUG - starting with process 8 (HU-KJ 81) of 15
2025-11-17 13:27:43,986 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:44,926 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:27:46,198 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:27:46,200 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 13:27:47,838 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:27:47,840 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:15,430 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:28:18,946 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:20,838 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:28:20,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:20,946 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:28:21,090 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:28:24,687 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:28:24,690 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:28:24,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:24,783 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:28:27,897 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:28:27,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:28:29,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:28:31,148 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:28:31,286 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:28:31,384 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:28:31,493 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:28:35,630 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:28:36,636 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:28:36,640 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:28:36,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:37,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:37,149 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:28:37,184 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:28:38,814 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:28:39,009 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:28:40,685 - ispa_next.functions - DEBUG - Updated appointment (AA00030012) customer contact data.
2025-11-17 13:28:41,597 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:28:41,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:41,672 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:28:41,848 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:28:41,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:28:42,454 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:28:42,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:28:43,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:28:47,298 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:28:47,298 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:28:47,302 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:28:47,302 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:28:47,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:28:47,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:28:51,881 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:28:51,886 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:28:51,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:28:51,961 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:28:57,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:58,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:58,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:28:58,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:28:58,788 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:29:00,657 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:29:00,659 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:29:01,661 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:29:01,662 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:29:01,663 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:29:01,664 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:29:01,665 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:29:01,667 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:29:01,668 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:29:01,676 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:29:01,688 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:29:01,690 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:29:01,694 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:29:01,696 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:29:01,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:29:03,631 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:29:03,633 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:29:03,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:29:05,545 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:29:05,547 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:29:05,550 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:29:05,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:29:07,399 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:29:07,402 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:29:08,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:29:08,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:29:08,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:29:27,408 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:31,795 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:31,798 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:29:31,799 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:29:32,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:29:32,597 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:29:32,599 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:29:34,643 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:29:42,416 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:29:42,812 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 13:29:43,626 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:29:44,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:29:44,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:29:48,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 13:29:48,393 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:29:49,249 - ispa_next.appointments.models - DEBUG - Appointment hao Zeng  WBA11GF0507S93786 ohne Termin.
2025-11-17 13:29:49,260 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:29:49,269 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:29:49,298 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:29:49,300 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:29:49,306 - ispa_next.main - DEBUG - 



2025-11-17 13:29:49,306 - ispa_next.main - DEBUG - starting with process 9 (HU-XS 108) of 15
2025-11-17 13:29:49,310 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:29:50,495 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:29:51,803 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:29:51,804 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 13:29:53,456 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:29:53,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:30:20,846 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:30:24,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:30:26,040 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:30:26,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:26,138 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:26,470 - ispa_next.functions - DEBUG - HU date already expired after 323 days.
2025-11-17 13:30:30,119 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:30:30,123 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:30:30,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:30,194 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:37,581 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:30:37,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:30:38,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:30:40,548 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:30:40,667 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:30:40,762 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:30:40,874 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:30:45,068 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:30:46,088 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:30:46,092 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:30:46,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:46,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:46,617 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:30:46,668 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:30:46,782 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:30:47,948 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:30:48,161 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:30:49,935 - ispa_next.functions - DEBUG - Updated appointment (AA00030000) customer contact data.
2025-11-17 13:30:50,870 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:30:50,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:50,964 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:51,094 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:30:51,098 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:30:51,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:30:52,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:30:53,138 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:30:53,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:30:53,214 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:30:56,824 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:30:56,825 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:30:56,828 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:30:56,828 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:30:56,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:30:57,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:01,442 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:31:01,448 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:31:01,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:01,540 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:31:01,905 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:02,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:02,398 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:03,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:03,096 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:31:04,949 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:31:04,955 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:31:05,845 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:31:05,846 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:31:05,847 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:31:05,849 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:31:05,850 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:31:05,850 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:31:05,852 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:31:05,853 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:31:05,861 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:31:05,864 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:31:05,870 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:31:05,872 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:31:05,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:07,813 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:31:07,816 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:31:07,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:09,720 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:31:09,722 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:31:09,724 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:31:09,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:11,601 - ispa_next.functions - DEBUG - adding material to item=Package(name=lwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 13:31:20,688 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:31:20,690 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:31:21,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:31:21,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:31:22,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:41,863 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:31:46,946 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:31:46,950 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:31:46,951 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:31:47,647 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:31:47,725 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:31:47,727 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:31:49,631 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:31:57,906 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:31:58,280 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 13:31:58,944 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:31:59,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:31:59,525 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:32:03,042 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 13:32:03,043 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:32:03,878 - ispa_next.appointments.models - DEBUG - Appointment hao Zeng  WBA11GF0507S93786 ohne Termin.
2025-11-17 13:32:03,892 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:32:03,903 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:32:03,914 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:32:03,916 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:32:03,921 - ispa_next.main - DEBUG - 



2025-11-17 13:32:03,921 - ispa_next.main - DEBUG - starting with process 10 (HU-AS 958) of 15
2025-11-17 13:32:03,926 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:32:05,227 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:32:06,500 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:32:06,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 13:32:08,145 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:32:08,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:32:39,498 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:32:42,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:45,319 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:32:45,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:32:45,407 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:32:45,578 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:32:49,652 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:32:49,655 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:32:49,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:32:49,777 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:32:56,774 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:32:56,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:32:57,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:32:59,969 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:33:00,094 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:33:00,215 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:33:00,288 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:33:02,410 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:33:03,415 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:33:03,419 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:33:03,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:03,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:03,972 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:33:04,020 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:33:04,179 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:33:05,414 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:33:05,619 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:33:07,563 - ispa_next.functions - DEBUG - Updated appointment (AF00016210) customer contact data.
2025-11-17 13:33:08,522 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:33:08,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:08,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:33:08,767 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:33:08,769 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:33:08,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:33:09,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:33:10,957 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:33:10,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:33:11,054 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:33:15,083 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:33:15,083 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:33:15,087 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:33:15,089 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:33:15,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:15,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:19,815 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:33:23,239 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:33:23,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:23,369 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:23,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:24,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:24,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:25,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:25,029 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:33:27,497 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:33:27,500 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:33:29,606 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:33:29,612 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:29,614 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:33:29,615 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:29,616 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:33:29,617 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:33:29,618 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:33:29,619 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:33:29,621 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:33:29,622 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:33:29,625 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:33:29,628 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:33:29,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:32,216 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:33:32,218 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:33:32,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:34,856 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:33:34,858 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:33:34,860 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:33:34,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:37,448 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:33:37,450 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:33:38,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:33:38,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:33:39,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:04,539 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:34:08,953 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:34:14,190 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:34:14,193 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:34:14,194 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:34:14,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:34:14,943 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:34:14,946 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:34:16,769 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:34:25,106 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:34:25,497 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 13:34:26,374 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:34:27,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:34:27,193 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:34:30,654 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 13:34:30,655 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:34:31,533 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:34:31,543 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:34:31,554 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:34:31,555 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:34:31,556 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:34:31,561 - ispa_next.main - DEBUG - 



2025-11-17 13:34:31,561 - ispa_next.main - DEBUG - starting with process 11 (OF-JF 333) of 15
2025-11-17 13:34:31,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:34:32,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:34:33,878 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 685
2025-11-17 13:34:33,879 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 13:34:35,380 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:34:35,381 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:35:17,021 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:35:20,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:35:25,787 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:35:25,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:25,853 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:35:26,083 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 13:35:30,486 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:35:30,491 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:35:30,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:30,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:35:37,900 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:35:37,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:35:38,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:35:41,003 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:35:41,147 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:35:41,254 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:35:41,349 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:35:45,471 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:35:46,477 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:35:46,497 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:35:46,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:46,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:46,967 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:35:47,007 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:35:47,137 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:35:48,506 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:35:48,699 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:35:50,647 - ispa_next.functions - DEBUG - Updated appointment (AE00018282) customer contact data.
2025-11-17 13:35:51,596 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:35:51,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:51,660 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:35:51,854 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:35:51,856 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:35:51,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:35:52,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:35:54,193 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:35:54,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:35:54,259 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:35:57,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:35:57,853 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:35:57,857 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:35:57,858 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:35:57,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:35:58,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:36:02,440 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:36:06,040 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:36:06,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:06,181 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:36:06,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:07,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:07,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:07,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:36:07,775 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:36:12,661 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:36:12,663 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:36:13,556 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:36:13,556 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:13,557 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:36:13,558 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:13,559 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:36:13,560 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:36:13,561 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:36:13,562 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:36:13,563 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:36:13,564 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:36:13,567 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:36:13,569 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:36:13,570 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:18,988 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:36:18,990 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:36:18,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:24,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:24,394 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:36:36,837 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:36:36,839 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:36:36,842 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:36:36,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:42,317 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:36:42,319 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:36:42,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:43,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:36:43,607 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:30,005 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:35,274 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:39,711 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:44,004 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:48,835 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:53,347 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:53,350 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:37:53,350 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:37:54,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:37:54,146 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:37:54,148 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:37:56,163 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:38:04,334 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:38:04,714 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 13:38:05,992 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:38:06,790 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 686
2025-11-17 13:38:06,791 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:38:10,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 13:38:10,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:38:11,227 - ispa_next.appointments.models - DEBUG - Appointment Richi Singh F-RS 819 WBS41AZ000CK91081 ohne Termin.
2025-11-17 13:38:11,237 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:38:11,248 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:38:11,259 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:38:11,261 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:38:11,269 - ispa_next.main - DEBUG - 



2025-11-17 13:38:11,270 - ispa_next.main - DEBUG - starting with process 12 (FB-SR 1700) of 15
2025-11-17 13:38:11,277 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:38:12,591 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:38:13,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 686
2025-11-17 13:38:13,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 13:38:16,216 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:38:16,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:38:47,946 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:38:51,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:38:54,052 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:38:54,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:54,172 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:38:54,349 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:38:54,352 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:38:54,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:54,444 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:00,865 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:39:00,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:02,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:04,365 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:39:04,489 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:39:04,603 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:39:04,711 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:39:08,845 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:39:09,851 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:39:09,856 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:39:09,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:10,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:10,358 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:39:10,431 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:39:10,541 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:39:11,817 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:39:12,037 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:39:13,922 - ispa_next.functions - DEBUG - Updated appointment (AR00006517) customer contact data.
2025-11-17 13:39:14,872 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:39:14,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:14,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:15,090 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:39:15,093 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:39:15,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:39:16,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:39:17,363 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:39:17,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:39:17,457 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:39:21,598 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:39:21,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:39:21,598 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:39:21,601 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:39:21,602 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:39:21,602 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:22,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:26,218 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:39:26,228 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:39:26,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:26,345 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:39:26,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:27,163 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:27,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:27,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:27,893 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:39:30,355 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:39:30,357 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:39:31,269 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:39:31,275 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:39:31,278 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:39:31,279 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:39:31,280 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:39:31,280 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:39:31,283 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:39:31,284 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:39:31,285 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:39:31,293 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:39:31,309 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:39:31,311 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:39:31,312 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:33,927 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:39:33,929 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:39:33,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:36,540 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:39:36,542 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:39:36,544 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:39:36,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:39,144 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:39:39,147 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:39:39,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:39:40,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:39:40,961 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:40:06,196 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:40:10,522 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:40:15,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:40:15,858 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:40:15,859 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:40:16,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:40:16,710 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:40:16,712 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:40:18,425 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:40:27,036 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:40:27,432 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 13:40:28,346 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:40:29,176 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 686
2025-11-17 13:40:29,178 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:40:32,343 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 13:40:32,344 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:40:33,324 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:40:33,334 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:40:33,345 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:40:33,346 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:40:33,352 - ispa_next.main - DEBUG - Found new Appointment: F-RS 819
2025-11-17 13:40:33,354 - ispa_next.main - DEBUG - 



2025-11-17 13:40:33,354 - ispa_next.main - DEBUG - starting with process 13 (F-RS 819) of 16
2025-11-17 13:40:33,358 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:40:34,626 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:40:35,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 686
2025-11-17 13:40:35,893 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 13:40:37,468 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:40:37,469 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:41:09,803 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:41:13,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:17,829 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:41:17,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:17,954 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:41:18,156 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:41:18,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:18,294 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:41:32,916 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-17 13:41:32,922 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:41:32,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:33,014 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:41:36,175 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:41:36,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:38,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:41:40,065 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:41:40,197 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:41:40,303 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:41:40,373 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:41:44,593 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:41:45,600 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:41:45,604 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:41:45,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:46,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:46,132 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:41:46,169 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:41:47,402 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:41:47,611 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:41:50,637 - ispa_next.functions - DEBUG - Updated appointment (AB00028064) customer contact data.
2025-11-17 13:41:51,532 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:41:51,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:51,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:41:51,895 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:41:51,898 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:41:52,896 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:41:52,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:41:54,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:41:58,131 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:41:58,131 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:41:58,135 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:41:58,136 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:41:58,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:58,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:42:02,751 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:42:03,376 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:42:15,952 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:42:15,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:42:16,061 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:42:23,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:42:24,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:42:24,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:42:25,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:42:25,053 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:42:29,435 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:42:29,437 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:42:31,015 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:42:31,018 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:42:31,020 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:42:31,021 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:42:31,022 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:42:31,023 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:42:31,025 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:42:31,026 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:42:31,027 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:42:31,029 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:42:31,032 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:42:31,036 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:42:31,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:35,866 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:42:35,868 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:42:35,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:40,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:42:41,007 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:42:51,659 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:42:51,688 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:42:51,692 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:42:51,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:56,590 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:42:56,593 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:42:57,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:42:58,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:42:58,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:43:28,607 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:43:28,608 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:43:29,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:43:29,875 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:43:29,877 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:43:35,742 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:43:51,148 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 13:43:51,151 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:43:51,152 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:43:52,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:43:53,065 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:43:53,068 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:43:56,043 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschlieen button found but not enabled.
2025-11-17 13:43:56,078 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:44:00,979 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 13:44:00,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:44:01,845 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-17 13:44:01,847 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:44:06,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 13:44:06,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:44:08,026 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:44:08,036 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:44:08,049 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:44:08,056 - ispa_next.main - DEBUG - 



2025-11-17 13:44:08,056 - ispa_next.main - DEBUG - starting with process 14 (MKK-RM 157) of 16
2025-11-17 13:44:08,061 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:44:09,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:44:12,062 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 687
2025-11-17 13:44:12,065 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 13:44:14,424 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:44:14,426 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:44:58,051 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:45:02,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:45:04,379 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:45:04,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:04,498 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:45:04,776 - ispa_next.functions - DEBUG - HU date already expired after 84 days.
2025-11-17 13:45:10,155 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:45:10,160 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:45:10,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:10,275 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:45:19,638 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:45:19,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:45:21,334 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:45:23,339 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:45:23,487 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:45:23,642 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:45:23,810 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:45:23,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:45:25,785 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:45:38,019 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:45:39,025 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:45:39,029 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:45:39,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:39,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:39,592 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:45:39,672 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:45:41,058 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:45:42,389 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:45:42,665 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:45:44,918 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:45:44,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:45,176 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:45:45,468 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:45:45,471 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:45:46,736 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:45:46,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:45:48,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:45:52,729 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:45:52,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:45:53,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:45:55,251 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:45:55,428 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:45:55,597 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:45:55,715 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:45:55,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:45:57,735 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:46:10,174 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:47:10,177 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:47:22,763 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:47:58,765 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:48:10,460 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlsseldaten berschreiben und ffnen' in nested popup
2025-11-17 13:48:22,305 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:48:22,307 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:48:31,517 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name=' Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:48:35,279 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name=' Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:48:38,966 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:48:43,185 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zndkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:48:47,310 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:48:52,028 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motorl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:48:56,864 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern fr Frontklappe prfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:49:01,475 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:49:05,185 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:49:08,643 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:49:11,808 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:49:12,816 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:49:12,817 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:49:12,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:12,935 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:49:17,120 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:49:23,214 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:49:23,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:23,316 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:49:23,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:24,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:24,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:25,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:49:25,061 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:49:27,048 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:49:27,053 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:49:32,303 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:49:32,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:49:32,308 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:49:32,310 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:49:32,311 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:49:32,313 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:49:32,322 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:49:32,324 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:49:32,324 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:49:32,325 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:49:32,329 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:49:32,332 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:49:32,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:34,425 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:49:34,429 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:49:34,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:36,388 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:49:36,390 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:49:36,393 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:49:36,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:38,330 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:49:38,332 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:49:39,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:49:40,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:49:40,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:01,275 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:50:07,700 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:50:07,703 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:50:07,704 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:50:08,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:50:08,894 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:50:08,896 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:50:11,760 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:50:23,645 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:50:24,021 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 13:50:26,252 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:50:27,435 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 689
2025-11-17 13:50:27,437 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:50:32,340 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-17 13:50:32,341 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:50:33,596 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:50:33,606 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:50:33,618 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:50:33,624 - ispa_next.main - DEBUG - Found new Appointment: MKK-P 1954
2025-11-17 13:50:33,625 - ispa_next.main - DEBUG - 



2025-11-17 13:50:33,625 - ispa_next.main - DEBUG - starting with process 15 (MKK-P 1954) of 17
2025-11-17 13:50:33,631 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:50:35,420 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:50:37,374 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 689
2025-11-17 13:50:37,375 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 13:50:39,808 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:50:39,810 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:51:27,479 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:51:31,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:51:31,463 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:51:31,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:51:33,051 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:51:33,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:51:33,171 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:51:33,531 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:51:43,082 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:51:43,086 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:51:43,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:51:43,208 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:51:46,649 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:51:46,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:51:48,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:51:50,946 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:51:51,076 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:51:54,390 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:51:54,533 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:51:54,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:51:55,947 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:52:08,474 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:52:09,486 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:52:09,491 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:52:09,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:10,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:10,058 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:52:10,135 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:52:11,428 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:52:12,624 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:52:12,846 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:52:17,715 - ispa_next.functions - DEBUG - Updated appointment (AB00028065) customer contact data.
2025-11-17 13:52:18,700 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:52:18,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:18,986 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:19,226 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:52:19,229 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:52:20,535 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:52:20,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:52:21,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:52:26,301 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:52:26,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:27,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:29,460 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:52:29,654 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:52:30,459 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:52:30,705 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:52:30,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:52:32,699 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:52:44,000 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufgen (Empfohlen)' in nested popup
2025-11-17 13:52:52,099 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:52:52,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:52:54,175 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:52:58,400 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:52:59,409 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:52:59,409 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:52:59,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:59,595 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:53:03,777 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:53:03,784 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:53:03,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:53:03,927 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:53:09,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:10,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:10,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:53:11,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:53:11,152 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:53:13,121 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:53:13,124 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:53:14,767 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:53:14,769 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:53:14,770 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:53:14,772 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:53:14,773 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:53:14,775 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:53:14,776 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:53:14,777 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:53:14,779 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:53:14,780 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:53:14,790 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:53:14,794 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:53:14,795 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:16,724 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:53:16,726 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:53:16,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:18,711 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:53:18,714 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:53:18,717 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:53:18,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:20,723 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:53:20,726 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:53:21,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:53:22,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:53:23,201 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:42,814 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:53:48,930 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:53:48,933 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:53:48,934 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:53:49,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:53:49,980 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:53:49,982 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:53:52,880 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:54:05,156 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:54:05,558 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 13:54:07,793 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:54:09,029 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 690
2025-11-17 13:54:09,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:54:14,711 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-17 13:54:14,712 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:54:16,809 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:54:16,820 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:54:16,832 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:54:16,837 - ispa_next.main - DEBUG - Found new Appointment: MKK-WD 111
2025-11-17 13:54:16,838 - ispa_next.main - DEBUG - 



2025-11-17 13:54:16,838 - ispa_next.main - DEBUG - starting with process 16 (MKK-WD 111) of 18
2025-11-17 13:54:16,843 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:54:18,581 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:54:20,360 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 690
2025-11-17 13:54:20,362 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 13:54:22,747 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:54:22,749 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:55:03,902 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:55:08,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:11,153 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:55:11,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:11,243 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:55:11,734 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:55:11,737 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:55:11,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:11,861 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:55:24,807 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:55:24,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:55:26,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:55:28,567 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:55:28,841 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:55:32,157 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:55:32,259 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:55:36,493 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:55:37,500 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:55:37,505 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:55:37,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:38,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:38,041 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:55:38,114 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:55:38,281 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:55:39,567 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 13:55:40,801 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 13:55:41,181 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:55:46,085 - ispa_next.functions - DEBUG - Updated appointment (AB00028067) customer contact data.
2025-11-17 13:55:47,037 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:55:47,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:47,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:55:47,665 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:55:47,668 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:55:47,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:55:49,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:55:51,159 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:55:51,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:55:51,840 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:55:55,500 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:55:55,501 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:55:55,506 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:55:55,507 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:55:55,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:55:56,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:56:00,274 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:56:00,279 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:56:00,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:00,386 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:56:00,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:01,299 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:01,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:02,235 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:56:02,236 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:56:05,452 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:56:05,454 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:56:06,949 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:56:06,950 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:56:06,952 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:56:06,953 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:56:06,954 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:56:06,956 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:56:06,957 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:56:06,958 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:56:06,960 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:56:06,961 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:56:06,964 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:56:06,967 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:56:06,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:10,420 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:56:14,717 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:56:14,777 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:56:14,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:18,526 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:56:18,529 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:56:18,532 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:56:18,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:21,928 - ispa_next.functions - DEBUG - adding material to item=Package(name=lwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 13:56:34,765 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:56:34,768 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:56:35,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:56:36,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:56:36,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:58,825 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:56:58,826 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:56:59,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:57:00,044 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:57:00,047 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:57:05,139 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:57:18,221 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:57:18,612 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 13:57:20,830 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:57:22,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 690
2025-11-17 13:57:22,018 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:57:27,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-17 13:57:27,711 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:57:29,702 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 13:57:29,714 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 13:57:29,726 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:57:29,731 - ispa_next.main - DEBUG - 



2025-11-17 13:57:29,732 - ispa_next.main - DEBUG - starting with process 17 (GN-BB 156) of 18
2025-11-17 13:57:29,754 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:57:31,577 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:57:33,601 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 690
2025-11-17 13:57:33,603 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 13:57:36,212 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:57:36,214 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:58:15,011 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:58:19,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:19,478 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:58:19,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:58:21,723 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:58:21,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:21,848 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:58:22,177 - ispa_next.functions - DEBUG - HU date already expired after 5070 days.
2025-11-17 13:58:28,176 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:58:28,180 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:58:28,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:28,312 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:58:38,698 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:58:38,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:40,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:42,540 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:58:51,056 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 13:58:56,147 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 13:58:57,153 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:58:57,158 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:58:57,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:58,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:58,341 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:58:58,398 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:58:58,642 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:58:59,922 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 13:59:01,393 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:59:01,610 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:59:04,163 - ispa_next.functions - DEBUG - Updated appointment (AD00021162) customer contact data.
2025-11-17 13:59:05,135 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:59:05,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:05,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:59:05,715 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:59:05,717 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:59:05,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:59:07,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:59:08,730 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:59:08,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:59:08,821 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:59:12,950 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:59:12,950 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:59:12,951 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:59:12,954 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:59:12,955 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:59:12,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:13,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:59:17,711 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:59:17,718 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:59:17,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:17,817 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:59:18,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:18,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:18,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:19,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:59:19,695 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:59:21,677 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:59:21,682 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:59:23,157 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:59:23,160 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:59:23,163 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:59:23,165 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:59:23,166 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:59:23,167 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:59:23,169 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:59:23,170 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:59:23,171 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:59:23,172 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:59:23,176 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:59:23,179 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:59:23,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:25,155 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:59:25,158 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:59:25,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:27,189 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:59:27,192 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:59:27,196 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:59:27,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:29,243 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:59:29,247 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:59:30,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:59:31,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:59:31,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:53,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:00,484 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:00:00,486 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:00:00,487 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:01,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:00:01,411 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:00:01,413 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:00:03,827 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:00:22,936 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:00:23,328 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 14:00:25,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:27,158 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 691
2025-11-17 14:00:27,159 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:32,207 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 14:00:32,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:00:33,785 - ispa_next.appointments.models - DEBUG - Appointment Firma Allessa GmbH F-AC 383 E WBA61DP0709J32413 ohne Termin.
2025-11-17 14:00:33,801 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 14:00:33,813 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 14:00:33,827 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 14:00:33,835 - ispa_next.main - DEBUG - 



2025-11-17 14:00:33,835 - ispa_next.main - DEBUG - starting with process 18 (MKK-MG 366) of 18
2025-11-17 14:00:33,878 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:35,634 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:37,545 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 691
2025-11-17 14:00:37,546 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 14:00:41,455 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:41,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:01:25,403 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:01:30,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:01:35,711 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:01:35,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:35,809 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:36,146 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:01:36,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:36,239 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:46,930 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:01:46,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:48,324 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:57,180 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:57,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:01:59,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:01,294 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:02:11,327 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 14:02:19,306 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 14:02:20,313 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:02:20,319 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:02:20,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:20,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:20,899 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:02:20,955 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:02:21,145 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:02:22,514 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:02:22,799 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:02:26,487 - ispa_next.functions - DEBUG - Updated appointment (AD00021124) customer contact data.
2025-11-17 14:02:27,484 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:02:27,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:27,902 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:02:30,965 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:02:31,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:02:33,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:02:35,209 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:02:35,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:02:35,318 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:02:39,398 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:02:39,398 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:02:39,398 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:02:39,403 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:02:39,405 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:02:39,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:39,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:44,252 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:02:49,892 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:02:49,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:49,978 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:02:50,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:50,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:50,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:51,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:51,758 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:02:56,943 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:02:56,944 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:02:58,825 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:02:58,827 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:58,828 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:02:58,829 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:58,831 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:02:58,833 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:02:58,834 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:02:58,835 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:02:58,836 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:02:58,841 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:02:58,857 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:02:58,861 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:02:58,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:04,687 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:03:04,694 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:03:04,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:10,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:10,459 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:03:23,361 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:03:23,364 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:03:23,367 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:03:23,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:29,004 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:03:29,006 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:03:29,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:03:31,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:03:31,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:10,352 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:04:10,353 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:04:11,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:04:11,416 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:04:11,418 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:04:17,077 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:04:29,556 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:04:29,964 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 14:04:33,001 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:04:34,159 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 691
2025-11-17 14:04:34,161 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:04:38,734 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 14:04:38,735 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:04:39,862 - ispa_next.appointments.models - DEBUG - Appointment Norbert Kayser OF-NK 536E WBA21EF0805W38121 ohne Termin.
2025-11-17 14:04:39,871 - ispa_next.appointments.models - DEBUG - Appointment Nenad Mihailovic OF-MT 2907 WBA5R110X0FK27609 ohne Termin.
2025-11-17 14:04:39,882 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
