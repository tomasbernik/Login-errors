2025-11-17 13:09:07,145 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:09:07,165 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:09:16,054 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:09:26,772 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:09:42,361 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:10:49,428 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:11:00,896 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:11:04,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:05,532 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 894
2025-11-17 13:11:05,533 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 501
2025-11-17 13:11:08,403 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 409
2025-11-17 13:11:08,403 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:11:08,405 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:11:09,344 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:11:10,292 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:11,328 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment AIR LIQUIDE Deutschland GmbH D-S-0-099/24-00420 WBA11BZ0309V09489, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='D-S-0-099/24-00420', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-17 13:12:11,346 - ispa_next.appointments.models - DEBUG - Appointment Kapellmann und Partner Rechtsanwaelte mbB D-AE 2222 WBAHF51080WW33367 ohne Termin.
2025-11-17 13:12:11,361 - ispa_next.appointments.models - DEBUG - Appointment Maersk Deutschland HH-M 3071E WBA81CY060FN31767 ohne Termin.
2025-11-17 13:12:11,379 - ispa_next.appointments.models - DEBUG - Appointment Weinmann Ulrich D-UW 19 WBAUZ35030NE17326 ohne Termin.
2025-11-17 13:12:11,394 - ispa_next.appointments.models - DEBUG - Appointment Shikoku Kakoki Europe GmbH D-SK 1601 WBA21FZ000FU12151 ohne Termin.
2025-11-17 13:12:11,419 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Esser D-FL 495 WBAUZ35030N020597 ohne Termin.
2025-11-17 13:12:11,432 - ispa_next.appointments.models - DEBUG - Appointment Armin Händeler D-AA 93 WBAHF11000WW66520 ohne Termin.
2025-11-17 13:12:11,443 - ispa_next.appointments.models - DEBUG - Appointment Tolga Erol NE-TE 1490 WBA5R11070AE79396 ohne Termin.
2025-11-17 13:12:11,480 - ispa_next.main - DEBUG - Found 15 out of 50 appointments to process (configured limit: 15).
2025-11-17 13:12:11,480 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 13:12:11,480 - ispa_next.main - DEBUG - All appointments: NE-C 887, D RS 3066E, DO-KP 2911, D-EV 5432, DMJ1906, 2X55650, D-JM215, M-SP-1815, D-LP 109 E, D-XB 1407, HGYD2020, D CL 6594, KK H 5708, D-AC4411, D-WU300E
2025-11-17 13:12:11,484 - ispa_next.main - DEBUG - 



2025-11-17 13:12:11,484 - ispa_next.main - DEBUG - starting with process 1 (NE-C 887) of 15
2025-11-17 13:12:11,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:12,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:13,843 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 894
2025-11-17 13:12:13,843 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 409
2025-11-17 13:12:15,455 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:15,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:59,588 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:13:10,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:10,623 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:10,842 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:12,062 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:13:12,062 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:12,182 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:12,585 - ispa_next.functions - DEBUG - HU date soon to be invalid in 58 days.
2025-11-17 13:13:19,906 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:13:19,915 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:13:22,818 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:22,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:23,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:25,801 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:13:25,997 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:13:29,214 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:13:29,286 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:13:29,287 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:30,595 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:13:42,176 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:13:43,181 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:13:43,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:43,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:56,505 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:14:04,738 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:14:04,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:04,811 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:04,812 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:14:04,875 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:14:06,175 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:14:07,695 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:14:07,936 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:14:11,167 - ispa_next.functions - DEBUG - Updated appointment (AB00031924) customer contact data.
2025-11-17 13:14:12,082 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:14:12,084 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:14:13,005 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:14:13,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:14:13,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:14:17,404 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:17,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:17,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:19,950 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:14:20,091 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:14:20,204 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:14:20,278 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:14:20,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:21,525 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:14:32,921 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:14:40,478 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:14:40,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:44,673 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:14:47,367 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 13:14:49,296 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:14:53,746 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:14:54,755 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:14:54,759 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:14:54,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:54,835 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:14:55,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:55,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:55,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:56,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:56,475 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:14:57,904 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:14:57,909 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:15:00,054 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:15:00,055 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:15:00,057 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:15:00,061 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:15:00,064 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:15:00,067 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:15:00,072 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:15:00,073 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:15:00,075 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:15:00,076 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:15:00,078 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:15:00,079 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:15:00,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:15:01,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:15:10,453 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:15:10,455 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:15:10,457 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:15:10,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:12,321 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:15:12,323 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:15:12,327 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:14,194 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:15:14,195 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:15:14,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:15:14,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:15:14,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:23,305 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:15:23,307 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:25,204 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:15:38,457 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:15:39,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:15:39,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:15:39,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:58,443 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:16:03,595 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:16:03,597 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:16:03,598 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:16:04,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:16:04,432 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:16:04,434 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:16:06,654 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:16:18,252 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 13:16:18,254 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:16:18,254 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:16:20,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:16:20,491 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:16:20,492 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:16:22,876 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:16:30,632 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:16:31,025 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:16:31,109 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:16:32,591 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 895
2025-11-17 13:16:32,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:16:34,995 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 502
2025-11-17 13:16:34,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:16:35,727 - ispa_next.appointments.models - DEBUG - Appointment Raimund Wickerath NE-RW 762 WBAJF310X0WW08282 ohne Termin.
2025-11-17 13:16:35,730 - ispa_next.main - DEBUG - Found new Appointment: EU-XQ 7225
2025-11-17 13:16:35,731 - ispa_next.main - DEBUG - 



2025-11-17 13:16:35,731 - ispa_next.main - DEBUG - starting with process 2 (EU-XQ 7225) of 16
2025-11-17 13:16:35,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:16:36,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:16:37,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 895
2025-11-17 13:16:37,730 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 502
2025-11-17 13:16:39,073 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:16:39,074 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:17:05,802 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:17:16,078 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:18,640 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:17:18,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:18,739 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:17:18,943 - ispa_next.functions - DEBUG - HU date already expired after 3 days.
2025-11-17 13:17:26,772 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:17:26,775 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:17:29,654 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:17:29,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:30,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:32,732 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:17:32,850 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:36,077 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:17:36,150 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:17:40,310 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:17:41,345 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:17:41,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:41,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:55,589 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:18:03,383 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:18:03,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:18:03,459 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:18:03,460 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:18:03,503 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:18:03,666 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:18:05,181 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:18:05,413 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:18:08,887 - ispa_next.functions - DEBUG - Updated appointment (AB00031925) customer contact data.
2025-11-17 13:18:09,800 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:18:09,801 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:18:09,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:18:10,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:18:12,110 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:18:12,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:18:12,198 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:18:15,810 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:18:15,810 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:18:15,813 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:18:15,816 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:18:15,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:16,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:18:21,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:18:22,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:18:22,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:23,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:18:23,200 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:18:26,205 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:18:26,207 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:18:27,340 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:18:27,345 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:18:27,349 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:18:27,351 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:18:27,359 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:18:27,362 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:18:27,365 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:18:27,367 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:18:27,387 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:18:27,388 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:18:27,390 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:18:27,392 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:18:28,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:18:28,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:18:38,183 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:18:38,185 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:18:38,186 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:18:38,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:42,113 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:18:42,115 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:18:42,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:46,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:46,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:18:57,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:11,240 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:19:11,242 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:19:11,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:19:12,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:19:12,677 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:25,398 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:19:25,400 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:29,430 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:19:41,691 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:19:42,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:19:42,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:19:42,961 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:08,922 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:20:08,923 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:09,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:09,688 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:20:09,690 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:20:14,234 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:20:22,350 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:20:22,733 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:20:23,335 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:24,281 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 895
2025-11-17 13:20:24,282 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:26,728 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 502
2025-11-17 13:20:26,728 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:20:27,438 - ispa_next.appointments.models - DEBUG - Appointment Raimund Wickerath NE-RW 762 WBAJF310X0WW08282 ohne Termin.
2025-11-17 13:20:27,442 - ispa_next.main - DEBUG - 



2025-11-17 13:20:27,442 - ispa_next.main - DEBUG - starting with process 3 (D RS 3066E) of 16
2025-11-17 13:20:27,445 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:28,441 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:20:29,350 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 895
2025-11-17 13:20:29,351 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 502
2025-11-17 13:20:30,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:20:30,601 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:20:57,821 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:21:08,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:10,037 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:21:10,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:10,117 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:10,455 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:21:10,458 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:21:13,426 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:21:13,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:14,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:16,460 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:21:16,587 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:21:19,790 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:21:19,893 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:21:19,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:21,827 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:21:33,482 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:21:34,487 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:21:34,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:35,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:38,519 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:21:38,522 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:21:38,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:21:38,598 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:21:38,599 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:21:38,638 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:21:39,860 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:21:40,096 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:21:42,230 - ispa_next.functions - DEBUG - Updated appointment (AL00007716) customer contact data.
2025-11-17 13:21:43,174 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:21:43,175 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:21:43,791 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:21:43,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:21:44,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:21:48,059 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:21:48,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:21:48,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:21:50,576 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:21:50,679 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:21:50,790 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:21:50,858 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:21:50,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:52,810 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:22:04,272 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:23:04,275 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:23:15,449 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:23:22,627 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:23:22,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:23:25,282 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:23:29,495 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:23:30,502 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:23:30,504 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:23:30,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:23:30,620 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:23:36,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:36,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:36,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:23:37,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:23:37,516 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:23:40,139 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:23:40,142 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:23:41,456 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:23:41,457 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:23:41,459 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:23:41,460 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:23:41,461 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:23:41,463 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 13:23:41,464 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:23:41,466 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:23:41,467 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:23:41,469 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:23:41,470 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:23:42,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:23:43,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:23:52,738 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:23:52,739 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:23:54,736 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:23:55,264 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:23:56,174 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:23:56,730 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:23:57,262 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:23:58,172 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:23:58,787 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:23:59,315 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:24:00,692 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:24:01,263 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:24:01,797 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:24:02,764 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:24:03,913 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:24:04,872 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:24:05,344 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:24:05,346 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:24:05,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:07,850 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:24:07,853 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:24:07,855 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:10,415 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:24:10,417 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:24:10,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:24:10,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:24:10,985 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:24:10,986 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:13,582 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:24:24,152 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:24:24,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:24:25,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:24:25,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:49,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:24:52,704 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:24:57,374 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:24:57,376 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:24:57,376 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:24:57,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:24:58,007 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:24:58,008 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:24:59,618 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:25:06,797 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:25:07,170 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:25:07,638 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:25:08,713 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-17 13:25:08,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:25:11,576 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 502
2025-11-17 13:25:11,577 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:25:12,509 - ispa_next.main - DEBUG - 



2025-11-17 13:25:12,509 - ispa_next.main - DEBUG - starting with process 4 (DO-KP 2911) of 16
2025-11-17 13:25:12,512 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:25:13,908 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:25:15,339 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-17 13:25:15,340 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 502
2025-11-17 13:25:16,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:25:16,956 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:25:55,093 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:26:04,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:06,662 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:26:06,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:06,783 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:07,007 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:26:07,010 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:26:09,932 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:26:09,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:11,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:26:13,094 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:26:13,251 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:26:13,369 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:26:13,454 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:26:13,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:15,417 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:26:26,354 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:26:33,450 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:26:33,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:35,403 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:26:39,587 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:26:40,592 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:26:40,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:41,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:45,269 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:26:45,274 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:26:45,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:45,379 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:45,380 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:26:45,457 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:26:46,671 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:26:46,920 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:26:49,183 - ispa_next.functions - DEBUG - Updated appointment (AK00008658) customer contact data.
2025-11-17 13:26:50,076 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:26:50,078 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:26:51,017 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:26:51,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:26:51,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:26:56,487 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:26:56,488 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:26:56,501 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:26:56,505 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:26:56,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:56,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:05,987 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 13:27:12,449 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 13:27:12,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:13,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:13,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:13,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:13,900 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:27:15,820 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:27:15,822 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:27:17,182 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:27:17,185 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:17,189 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:27:17,190 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Timmermanns Service, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 13:27:17,192 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:17,194 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:27:17,195 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:27:17,196 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:27:17,198 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:27:17,199 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:27:17,201 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:27:17,203 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:27:17,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:27:18,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:28:08,720 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:28:08,721 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 13:28:14,128 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:28:14,134 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:28:14,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:18,117 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:28:18,118 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:28:18,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:22,149 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:28:22,151 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:28:22,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:28:22,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:28:22,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:37,163 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:28:37,165 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:41,101 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:28:54,028 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:28:54,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:28:55,189 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:28:55,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:29:33,522 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:38,310 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:43,192 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:48,279 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:53,729 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:53,731 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:29:53,732 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:29:54,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:29:54,568 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:29:54,569 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:29:56,724 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:30:05,191 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:30:05,572 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:30:06,070 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:30:07,269 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-17 13:30:07,271 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:30:09,870 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 499
2025-11-17 13:30:09,870 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:30:10,585 - ispa_next.main - DEBUG - 



2025-11-17 13:30:10,585 - ispa_next.main - DEBUG - starting with process 5 (D-EV 5432) of 16
2025-11-17 13:30:10,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:30:11,719 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:30:12,700 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 896
2025-11-17 13:30:12,701 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 499
2025-11-17 13:30:13,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:30:13,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:30:42,387 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:30:53,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:53,299 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:53,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:30:54,775 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:30:54,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:54,858 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:55,160 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:30:55,162 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:30:58,207 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:30:58,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:30:59,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:01,339 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:31:01,435 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:31:04,634 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:31:04,733 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:31:04,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:05,887 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:31:17,355 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:31:18,360 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:31:18,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:18,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:33,883 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:31:42,144 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:31:42,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:42,246 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:31:42,247 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:31:42,292 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:31:43,573 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:31:44,924 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:31:45,151 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:31:48,502 - ispa_next.functions - DEBUG - Updated appointment (AB00031909) customer contact data.
2025-11-17 13:31:49,427 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:31:49,429 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:31:50,588 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:31:50,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:31:51,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:31:55,878 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:31:55,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:56,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:58,546 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:31:58,653 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:31:58,799 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:31:58,885 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:31:58,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:00,190 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:32:11,455 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:33:11,457 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:33:22,752 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:33:29,799 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:33:29,799 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:31,055 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:33:37,298 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:33:45,715 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:33:46,744 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:33:46,746 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:33:46,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:46,844 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:47,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:47,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:47,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:48,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:48,503 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:33:49,871 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:33:49,873 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:33:52,161 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:33:52,162 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:52,164 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:33:52,165 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:33:52,173 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:52,176 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:33:52,177 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:33:52,178 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:33:52,179 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:33:52,180 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:33:52,182 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:33:52,184 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:33:52,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:33:53,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:34:02,801 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:34:02,804 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:34:02,806 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:34:02,807 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:04,735 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:34:04,736 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:34:04,743 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:06,596 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:34:06,598 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:34:06,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:34:07,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:34:07,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:15,970 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:34:15,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:17,857 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:34:28,637 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:34:29,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:34:29,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:34:29,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:48,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:34:53,507 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:34:53,509 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:34:53,510 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:34:54,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:34:54,259 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:34:54,260 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:34:56,255 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:35:04,938 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:35:05,330 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 13:35:05,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:35:06,987 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-17 13:35:06,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:35:09,590 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 495
2025-11-17 13:35:09,591 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:35:10,443 - ispa_next.main - DEBUG - Found new Appointment: D E-ME8088E
2025-11-17 13:35:10,445 - ispa_next.main - DEBUG - 



2025-11-17 13:35:10,445 - ispa_next.main - DEBUG - starting with process 6 (D E-ME8088E) of 17
2025-11-17 13:35:10,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:35:11,748 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:35:12,985 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-17 13:35:12,986 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 495
2025-11-17 13:35:14,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:35:14,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:35:44,885 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:35:55,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:35:57,468 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:35:57,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:57,579 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:35:57,809 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:35:57,811 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:36:00,823 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:36:00,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:01,908 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:36:03,912 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:36:04,039 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:36:04,166 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:36:04,236 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:36:04,237 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:06,195 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:36:17,030 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:36:24,074 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:36:24,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:25,995 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:36:30,174 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:36:31,179 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:36:31,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:31,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:35,643 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:36:35,646 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:36:35,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:35,755 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:36:35,756 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:36:35,792 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:36:37,049 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:36:38,258 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:36:38,469 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:36:39,785 - ispa_next.functions - DEBUG - Updated appointment (AL00007719) customer contact data.
2025-11-17 13:36:40,695 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:36:40,697 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:36:41,820 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:36:41,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:36:42,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:36:47,139 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:36:47,139 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:36:47,142 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:36:47,145 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:36:47,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:47,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:36:48,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:48,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:48,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:49,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:36:49,461 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:36:51,355 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:36:51,356 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:36:52,686 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:36:52,687 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:52,690 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:36:52,691 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:36:52,692 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:52,694 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:36:52,695 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:36:52,697 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:36:52,698 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:36:52,699 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:36:52,701 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:36:52,702 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:36:53,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:36:54,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:37:03,169 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:37:03,171 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:37:03,173 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:37:03,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:05,768 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:37:05,769 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:37:05,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:08,352 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:37:08,354 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:37:08,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:37:08,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:37:09,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:18,171 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:37:18,172 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:20,731 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:37:32,577 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:37:33,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:37:33,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:37:33,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:58,593 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:38:03,258 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:38:08,633 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:38:08,635 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:38:08,636 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:38:09,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:38:09,345 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:38:09,346 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:38:11,114 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:38:19,699 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:38:20,068 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 13:38:20,591 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:38:22,042 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-17 13:38:22,044 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:38:25,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 495
2025-11-17 13:38:25,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:38:25,968 - ispa_next.main - DEBUG - 



2025-11-17 13:38:25,968 - ispa_next.main - DEBUG - starting with process 7 (DMJ1906) of 17
2025-11-17 13:38:25,976 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:38:27,195 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:38:28,439 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 897
2025-11-17 13:38:28,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 495
2025-11-17 13:38:30,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:38:30,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:39:04,009 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:39:15,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:21,480 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:39:21,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:21,584 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:21,849 - ispa_next.functions - DEBUG - HU date already expired after 1802 days.
2025-11-17 13:39:30,024 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:39:30,027 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:39:32,801 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:39:32,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:33,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:35,848 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:39:35,974 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:39:36,072 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:39:36,185 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:39:36,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:42,405 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:39:54,097 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:39:55,102 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:39:55,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:55,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:59,606 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:39:59,610 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:39:59,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:59,685 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:59,686 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:39:59,761 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:40:00,945 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:40:01,204 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:40:03,542 - ispa_next.functions - DEBUG - Updated appointment (AI00009081) customer contact data.
2025-11-17 13:40:04,492 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:40:04,494 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:40:05,478 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:40:05,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:40:06,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:40:10,332 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:40:10,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:40:10,901 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:40:12,906 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:40:13,031 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:40:13,158 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:40:13,251 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:40:13,253 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:40:19,403 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:40:30,931 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:41:30,936 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:41:42,829 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:41:50,165 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:41:50,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:56,346 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:42:00,548 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:42:01,553 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:42:01,556 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:42:01,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:42:01,621 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:42:01,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:42:02,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:42:02,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:42:03,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:42:03,283 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:42:08,706 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:42:08,712 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:42:09,844 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:42:09,845 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:42:09,847 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:42:09,849 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:42:09,850 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:42:09,852 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:42:09,853 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:42:09,854 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:42:09,855 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:42:09,857 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:42:09,858 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:42:09,861 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:42:10,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:42:11,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:42:20,916 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:42:20,918 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:42:20,919 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:42:20,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:27,861 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:42:27,862 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:42:27,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:34,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:42:35,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:42:46,577 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:42:46,580 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:42:46,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:42:47,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:42:47,386 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:56,157 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:42:56,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:43:02,859 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:43:16,054 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:43:16,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:43:17,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:43:17,290 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:44:22,906 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:27,932 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:33,566 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:38,725 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:43,748 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:49,199 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:53,608 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:44:59,070 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:45:04,575 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:45:11,468 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:45:11,469 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:45:12,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:45:12,354 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:45:12,355 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:45:16,913 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:45:26,015 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:45:26,415 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 13:45:27,267 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:45:28,511 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 898
2025-11-17 13:45:28,514 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:45:31,623 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 493
2025-11-17 13:45:31,624 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:45:32,504 - ispa_next.appointments.models - DEBUG - Appointment Virginia Weier D-VW 3000 WBA21EU0809V41223 ohne Termin.
2025-11-17 13:45:32,510 - ispa_next.main - DEBUG - 



2025-11-17 13:45:32,510 - ispa_next.main - DEBUG - starting with process 8 (2X55650) of 17
2025-11-17 13:45:32,513 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:45:33,886 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:45:35,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 898
2025-11-17 13:45:35,210 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 493
2025-11-17 13:45:36,715 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:45:36,716 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:46:14,573 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:46:25,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:46:25,286 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:46:25,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:26,762 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:46:26,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:46:26,839 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:46:27,055 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:46:34,869 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:46:34,872 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:46:37,675 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:46:37,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:46:38,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:46:40,900 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:46:41,041 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:46:44,251 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:46:44,321 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:46:44,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:45,511 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:46:57,072 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:46:58,077 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:46:58,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:46:58,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:47:11,976 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:47:20,509 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:47:20,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:47:20,630 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:47:20,632 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:47:20,663 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:47:22,010 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:47:22,234 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:47:25,760 - ispa_next.functions - DEBUG - Updated appointment (AB00031844) customer contact data.
2025-11-17 13:47:26,700 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:47:26,701 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:47:27,576 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:47:27,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:47:28,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:47:31,950 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:47:31,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:47:32,441 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:47:34,445 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:47:34,561 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:47:34,677 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:47:34,815 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:47:34,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:47:36,042 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:47:47,515 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:48:47,518 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:48:58,888 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:49:14,900 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:49:26,337 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:49:34,827 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:49:35,834 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:49:35,837 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:49:35,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:35,973 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:49:41,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:42,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:42,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:42,837 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:49:42,838 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:49:44,137 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:49:44,147 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:49:45,255 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:49:45,256 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:49:45,258 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:49:45,259 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 13:49:45,261 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:49:45,264 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:49:45,269 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:49:45,272 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:49:45,275 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:49:45,276 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:49:45,278 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:49:45,280 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:49:45,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:49:46,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:49:55,905 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:49:55,907 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:49:55,908 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:49:55,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:57,874 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:49:57,876 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:49:57,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:59,710 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:49:59,712 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:49:59,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:50:00,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:50:00,223 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:50:00,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:02,140 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:50:14,008 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:50:14,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:50:14,964 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:50:15,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:33,769 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:50:38,725 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:50:38,727 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:50:38,729 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:50:39,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:50:39,529 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:50:39,530 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:50:41,972 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:50:50,002 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:50:50,374 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 13:50:50,811 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:50:52,250 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:50:52,252 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:50:55,135 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 493
2025-11-17 13:50:55,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:50:56,125 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 13:50:56,132 - ispa_next.main - DEBUG - Found new Appointment: D-VW 3000
2025-11-17 13:50:56,134 - ispa_next.main - DEBUG - 



2025-11-17 13:50:56,134 - ispa_next.main - DEBUG - starting with process 9 (D-VW 3000) of 18
2025-11-17 13:50:56,143 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:50:57,421 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:50:58,933 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:50:58,934 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 493
2025-11-17 13:51:00,510 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:00,511 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:51:38,239 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:51:48,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:51:51,393 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:51:51,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:51:51,474 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:51:51,814 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:51:51,817 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:51:54,658 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:51:54,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:51:55,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:51:57,850 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:51:57,973 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:51:58,084 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:51:58,167 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:52:02,353 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:52:03,357 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:52:03,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:03,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:16,836 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:52:25,151 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:52:25,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:25,252 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:25,254 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:52:25,289 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:52:26,625 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:52:26,905 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:52:30,307 - ispa_next.functions - DEBUG - Updated appointment (AB00031930) customer contact data.
2025-11-17 13:52:31,279 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:52:31,282 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:52:32,160 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:52:32,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:52:33,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:52:36,699 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:52:36,699 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:52:36,704 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:52:36,707 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:52:36,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:37,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:42,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:43,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:43,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:44,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:44,174 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:52:47,461 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:52:47,463 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:52:48,689 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:52:48,691 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:52:48,692 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:52:48,694 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:52:48,698 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:52:48,711 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:52:48,714 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:52:48,717 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:52:48,720 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:52:48,721 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:52:48,723 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:52:48,733 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:52:48,734 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:52:48,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:52:52,086 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:52:52,088 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:52:52,090 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:52:55,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:55,444 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:53:06,215 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:19,958 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:53:19,960 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:53:19,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:53:21,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:53:21,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:33,275 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:53:33,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:36,571 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:53:49,306 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:53:49,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:53:50,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:53:50,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:10,312 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:54:10,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:54:11,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:54:11,148 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:54:11,149 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:54:15,677 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:54:24,054 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:54:24,435 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 13:54:25,365 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:54:26,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:54:26,508 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:54:29,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-17 13:54:29,415 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:54:30,197 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 13:54:30,204 - ispa_next.main - DEBUG - 



2025-11-17 13:54:30,204 - ispa_next.main - DEBUG - starting with process 10 (D-JM215) of 18
2025-11-17 13:54:30,207 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:54:31,241 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:54:33,206 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:54:33,207 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-17 13:54:35,072 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:54:35,073 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:55:06,396 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:55:16,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:19,033 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:55:19,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:19,168 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:55:19,377 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:55:19,380 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:55:22,427 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:55:22,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:55:23,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:55:25,695 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:55:25,862 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:55:26,005 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:55:26,079 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:55:26,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:28,691 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:55:39,587 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:55:47,303 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:55:47,304 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:50,061 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:55:54,290 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:55:55,295 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:55:55,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:55,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:59,972 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:55:59,976 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:55:59,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:00,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:56:00,086 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:56:00,150 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:56:01,375 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:56:01,636 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:56:04,235 - ispa_next.functions - DEBUG - Updated appointment (AI00009078) customer contact data.
2025-11-17 13:56:05,229 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:56:05,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:56:06,180 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:56:06,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:56:07,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:56:10,885 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:56:10,885 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:56:10,888 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:56:10,890 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:56:10,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:11,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:56:21,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:21,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:21,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:22,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:56:22,264 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:56:24,769 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:56:24,771 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:56:25,673 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:56:25,675 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:56:25,677 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 13:56:25,679 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:56:25,680 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:56:25,681 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:56:25,683 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:56:25,684 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:56:25,686 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:56:25,687 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:56:25,689 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:56:25,692 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:56:25,694 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:56:25,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:28,428 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:56:28,429 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:56:28,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:31,011 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:56:31,012 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:56:31,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:56:31,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:56:32,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:42,057 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:56:42,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:44,726 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:56:57,010 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:56:57,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:56:58,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:56:58,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:57:23,751 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:57:30,691 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:57:36,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:57:42,785 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:57:42,785 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:57:43,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:57:43,633 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:57:43,635 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:57:48,024 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:57:57,341 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:57:57,746 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 13:57:58,254 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:58:00,241 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:58:00,243 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:58:03,536 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-17 13:58:03,537 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:58:04,545 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 13:58:04,580 - ispa_next.main - DEBUG - 



2025-11-17 13:58:04,580 - ispa_next.main - DEBUG - starting with process 11 (M-SP-1815) of 18
2025-11-17 13:58:04,947 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:58:06,216 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:58:07,369 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:58:07,370 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-17 13:58:08,899 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:58:08,901 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:58:31,495 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:58:31,604 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 13:58:31,610 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:58:32,150 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:58:32,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:58:35,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-17 13:58:35,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:58:36,056 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 13:58:36,061 - ispa_next.main - DEBUG - 



2025-11-17 13:58:36,061 - ispa_next.main - DEBUG - starting with process 12 (D-LP 109 E) of 18
2025-11-17 13:58:36,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:58:37,491 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:58:38,853 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 13:58:38,854 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-17 13:58:40,393 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:58:40,395 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:59:13,220 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:59:23,881 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:29,269 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:59:29,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:29,369 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:59:29,614 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:59:29,617 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:59:32,413 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:59:32,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:33,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:59:35,615 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:59:35,741 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:59:35,850 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:59:35,937 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:59:35,938 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:41,505 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:59:52,980 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:59:53,985 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:59:53,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:54,459 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:58,178 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:59:58,182 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:59:58,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:58,283 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:59:58,284 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:59:58,397 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:00:00,122 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:00:00,398 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:00:02,873 - ispa_next.functions - DEBUG - Updated appointment (AG00009250) customer contact data.
2025-11-17 14:00:03,832 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:00:03,834 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:00:04,680 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:00:04,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:00:05,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:00:09,040 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:00:09,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:00:09,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:00:11,585 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:00:11,741 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:00:11,880 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:00:11,991 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:00:11,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:00:17,793 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:00:29,438 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:01:29,440 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:01:41,587 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:02:13,589 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:02:24,670 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:02:31,944 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:02:31,946 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:02:37,500 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:02:41,692 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:02:42,729 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:02:42,733 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:02:42,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:42,816 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:02:48,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:48,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:48,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:49,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:49,643 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:02:54,469 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:02:54,471 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:02:55,724 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:02:55,725 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:55,731 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 14:02:55,737 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 14:02:55,740 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:55,744 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:02:55,747 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:02:55,752 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:02:55,754 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:02:55,763 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:02:55,775 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:02:55,778 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:02:56,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:02:57,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:03:07,837 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:03:07,840 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:03:07,842 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:03:07,843 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:13,899 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:03:16,875 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:03:16,879 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:03:16,889 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:23,221 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:03:23,222 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:03:23,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:03:23,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:03:24,350 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:39,163 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:03:39,167 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:45,447 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:03:58,295 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:03:58,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:03:59,335 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:03:59,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:59,461 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:04,533 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:10,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:14,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:19,753 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:25,386 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:31,045 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:37,011 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:37,014 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:05:37,015 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:05:37,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:05:37,846 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:05:37,847 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:05:39,675 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:05:49,587 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:05:49,960 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 14:05:50,687 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:52,144 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:05:52,145 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:54,985 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-17 14:05:54,986 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:05:55,794 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 14:05:55,801 - ispa_next.main - DEBUG - 



2025-11-17 14:05:55,801 - ispa_next.main - DEBUG - starting with process 13 (D-XB 1407) of 18
2025-11-17 14:05:55,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:05:56,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:58,046 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:05:58,048 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-17 14:05:59,578 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:59,580 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:06:54,357 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:07:05,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:14,684 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:07:14,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:14,774 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:07:15,093 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:07:15,097 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:07:18,014 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:07:18,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:07:19,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:07:21,510 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:07:21,626 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:07:21,812 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:07:21,886 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:07:21,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:31,106 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:07:42,488 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:07:50,032 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:07:50,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:59,255 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:08:01,382 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:08:02,388 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:08:02,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:02,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:07,482 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:08:07,485 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:08:07,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:07,585 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:08:07,588 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:08:07,649 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:08:07,754 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:08:09,001 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:08:09,291 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:08:12,059 - ispa_next.functions - DEBUG - Updated appointment (AG00009249) customer contact data.
2025-11-17 14:08:12,963 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:08:12,964 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:08:13,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:08:14,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:08:16,306 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:08:16,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:08:17,191 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:08:20,847 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:08:20,848 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:08:20,852 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:08:20,856 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:08:20,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:21,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:08:21,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:22,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:22,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:23,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:08:23,147 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:08:31,684 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:08:31,686 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:08:33,095 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:08:33,100 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:08:33,105 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 14:08:33,108 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 14:08:33,116 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:08:33,119 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:08:33,121 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:08:33,123 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:08:33,134 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:08:33,148 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:08:33,151 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:08:33,168 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:08:33,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:08:34,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:08:44,940 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:08:44,942 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:08:44,943 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:08:44,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:08:55,131 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:08:55,133 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:08:55,140 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:05,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:06,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:09:15,345 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:37,674 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:09:37,676 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:09:37,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:09:38,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:09:38,677 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:09:38,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:49,157 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:10:02,758 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:10:03,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:10:03,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:10:04,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:45,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:50,479 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:11:55,699 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:01,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:06,083 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:10,669 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:14,564 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:19,611 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:24,742 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:30,831 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:37,614 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:42,549 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:47,830 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:54,383 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:54,385 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:12:54,386 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:12:55,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:12:55,390 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:12:55,391 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:12:57,588 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:13:08,307 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:13:08,708 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 14:13:10,768 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:11,745 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:13:11,747 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:15,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-17 14:13:15,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:16,388 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 14:13:16,395 - ispa_next.main - DEBUG - 



2025-11-17 14:13:16,395 - ispa_next.main - DEBUG - starting with process 14 (HGYD2020) of 18
2025-11-17 14:13:16,399 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:17,728 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:18,745 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:13:18,746 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-17 14:13:20,427 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:20,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:44,893 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 14:13:44,908 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 14:13:44,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:45,495 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:13:45,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:48,689 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-17 14:13:48,689 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:49,794 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 14:13:49,799 - ispa_next.main - DEBUG - 



2025-11-17 14:13:49,799 - ispa_next.main - DEBUG - starting with process 15 (D CL 6594) of 18
2025-11-17 14:13:49,802 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:51,266 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:52,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:13:52,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-17 14:13:54,704 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:54,706 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:14:25,992 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:14:37,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:38,262 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:14:38,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:38,364 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:14:38,609 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:14:38,612 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:14:41,628 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:14:41,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:14:42,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:14:44,927 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:14:45,038 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:14:45,126 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:14:45,222 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:14:45,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:46,488 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:14:58,439 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:14:59,455 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:14:59,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:00,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:04,076 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:15:04,081 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:15:04,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:04,182 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:04,183 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:15:04,252 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:15:05,522 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:15:05,740 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:15:07,897 - ispa_next.functions - DEBUG - Updated appointment (AG00009245) customer contact data.
2025-11-17 14:15:08,917 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:15:08,918 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:15:09,627 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:15:09,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:15:10,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:15:14,251 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:15:14,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:14,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:16,759 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:15:16,867 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:15:16,985 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:15:17,045 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:15:17,046 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:18,314 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:15:30,155 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:16:30,157 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:16:41,671 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:17:26,672 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:17:38,804 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:17:46,927 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:17:47,934 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:17:47,936 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:17:47,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:48,006 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:18:01,434 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:18:11,081 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:18:11,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:12,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:12,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:12,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:12,800 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:18:14,060 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:18:14,063 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:18:15,009 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:18:15,010 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:18:15,012 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 14:18:15,013 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart), Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 14:18:15,014 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:18:15,015 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:18:15,016 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:18:15,017 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:18:15,019 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:18:15,020 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:18:15,022 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:18:15,023 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:18:15,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:18:16,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:18:46,738 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:18:46,785 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:18:53,163 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:18:53,165 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:18:53,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:55,949 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:18:55,951 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:18:55,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:58,637 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:18:58,641 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:18:58,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:18:59,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:18:59,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:06,777 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:19:06,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:09,555 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:19:22,173 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:19:22,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:19:23,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:19:23,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:51,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:19:55,674 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:20:01,693 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:20:01,696 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:20:01,696 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:02,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:20:02,606 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:20:02,607 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:20:04,907 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:20:14,823 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:20:15,263 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 14:20:16,271 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:18,014 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:20:18,016 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:20,873 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 491
2025-11-17 14:20:20,873 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:21,711 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 14:20:21,716 - ispa_next.main - DEBUG - 



2025-11-17 14:20:21,716 - ispa_next.main - DEBUG - starting with process 16 (KK H 5708) of 18
2025-11-17 14:20:21,720 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:22,747 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:23,851 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:20:23,852 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 491
2025-11-17 14:20:25,553 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:25,555 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:21:09,242 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:21:20,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:22,287 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:21:22,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:22,369 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:22,613 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-17 14:21:29,381 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:21:29,384 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:21:32,210 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:32,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:33,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:35,648 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:35,842 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:35,959 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:36,052 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:21:36,053 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:38,028 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:21:49,748 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:21:50,753 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:21:50,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:51,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:55,348 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:21:55,352 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:21:55,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:55,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:55,428 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:21:55,512 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:21:56,776 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:21:56,988 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:21:59,734 - ispa_next.functions - DEBUG - Updated appointment (AG00009242) customer contact data.
2025-11-17 14:22:00,640 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:22:00,643 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:22:01,749 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:22:01,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:02,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:22:06,556 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:22:06,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:07,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:09,044 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:22:09,204 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:22:09,280 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:22:09,369 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:22:09,370 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:11,306 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:22:22,253 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:22:29,631 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:22:29,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:22:31,630 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:22:35,849 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:22:36,856 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:22:36,859 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:22:36,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:36,962 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:22:47,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:47,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:47,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:48,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:48,390 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:22:50,311 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:22:50,315 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:22:51,511 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:22:51,513 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:22:51,515 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 14:22:51,519 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 14:22:51,520 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:22:51,523 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 14:22:51,527 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:22:51,539 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:22:51,541 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:22:51,543 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:22:51,545 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:22:52,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:22:53,282 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:23:03,243 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:23:03,244 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 14:23:05,608 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:23:06,148 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:23:07,126 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:23:07,739 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:23:08,262 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:23:10,054 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:23:10,622 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:23:11,164 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:23:12,128 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:23:13,588 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:23:14,567 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:23:15,071 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:23:15,112 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:23:15,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:17,028 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:23:17,029 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:23:17,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:19,024 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:23:19,025 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:23:19,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:23:19,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:23:20,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:30,751 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:23:30,754 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:32,746 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:23:45,409 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:23:45,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:23:46,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:23:46,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:06,897 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:24:11,985 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:24:11,987 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:24:11,987 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:12,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:24:12,633 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:24:12,634 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:24:14,120 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:24:22,000 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:24:22,395 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 14:24:23,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:24,533 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:24:24,534 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:27,477 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-17 14:24:27,478 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:24:28,201 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 14:24:28,207 - ispa_next.main - DEBUG - 



2025-11-17 14:24:28,207 - ispa_next.main - DEBUG - starting with process 17 (D-AC4411) of 18
2025-11-17 14:24:28,210 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:29,353 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:30,772 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:24:30,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-17 14:24:32,647 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:32,648 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:25:18,201 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:25:29,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:35,338 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:25:35,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:35,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:25:35,741 - ispa_next.functions - DEBUG - HU date already expired after 125 days.
2025-11-17 14:25:44,250 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:25:44,253 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:25:47,229 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:25:47,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:48,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:50,700 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:25:50,812 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:25:50,962 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:25:51,027 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:25:51,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:25:56,629 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:26:08,406 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:26:09,410 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:26:09,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:09,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:14,001 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:26:14,005 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:26:14,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:14,081 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:26:14,082 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:26:14,193 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:26:15,523 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:26:15,762 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:26:18,750 - ispa_next.functions - DEBUG - Updated appointment (AG00009235) customer contact data.
2025-11-17 14:26:19,679 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:26:19,681 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:26:20,848 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:26:20,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:26:22,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:26:26,987 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:26:26,987 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:26:26,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:27,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:26:29,534 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:26:29,646 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:26:29,757 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:26:29,836 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:26:29,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:35,463 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:26:47,087 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:27:47,101 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:27:58,399 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:28:05,957 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:28:05,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:11,608 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:28:15,843 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:28:16,849 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:28:16,851 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:28:16,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:16,974 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:28:25,757 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:28:40,637 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:28:40,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:42,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:42,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:43,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:43,290 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:28:48,300 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:28:48,302 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:28:49,696 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:28:49,698 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:49,701 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 14:28:49,705 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 14:28:49,707 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:28:49,729 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:28:49,731 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:28:49,736 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:28:49,738 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:28:49,739 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:28:49,759 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:28:49,762 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:29:11,023 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:29:11,235 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:29:17,588 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:29:17,590 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:29:17,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:23,750 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:29:23,752 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:29:23,755 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:29,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:29:30,038 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:29:42,149 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:59,068 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:29:59,070 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:29:59,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:30:00,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:30:00,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:14,360 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:30:14,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:20,582 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:30:34,230 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:30:34,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:30:35,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:30:35,773 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:37,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:42,471 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:49,659 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:31:55,436 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:01,199 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:07,547 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:12,625 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:19,036 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:32:26,510 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:32:26,511 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:27,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:32:27,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:32:27,439 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:32:31,648 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:32:42,500 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:32:42,888 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 14:32:44,596 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:45,456 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:32:45,457 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:32:48,416 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-17 14:32:48,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:32:49,188 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
2025-11-17 14:32:49,194 - ispa_next.main - DEBUG - 



2025-11-17 14:32:49,194 - ispa_next.main - DEBUG - starting with process 18 (D-WU300E) of 18
2025-11-17 14:32:49,197 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:32:50,307 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:32:51,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:32:51,657 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 492
2025-11-17 14:32:53,419 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:32:53,420 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:33:30,720 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:33:42,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:46,407 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:33:46,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:33:46,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:33:46,883 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:33:46,884 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:33:49,967 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:33:49,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:33:51,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:33:53,536 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:33:53,704 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:33:53,809 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:33:53,882 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:33:53,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:33:58,038 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:34:09,655 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:34:10,660 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:34:10,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:11,185 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:26,700 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:34:36,675 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:34:36,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:36,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:34:36,762 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:34:36,802 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:34:38,229 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:34:38,460 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:34:41,887 - ispa_next.functions - DEBUG - Updated appointment (AJ00008856) customer contact data.
2025-11-17 14:34:42,800 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:34:43,107 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:34:44,039 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:34:44,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:34:45,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:34:48,866 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:34:48,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:49,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:34:51,472 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:34:51,635 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:34:51,733 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:34:51,830 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:34:51,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:56,088 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:35:07,458 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:35:14,610 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:35:14,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:18,697 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:35:22,905 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:35:23,918 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:35:23,922 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:35:23,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:35:23,992 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:35:34,118 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:35:41,258 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-17 14:35:49,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:50,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:50,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:35:51,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:35:51,348 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:35:55,073 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:35:55,075 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:35:56,374 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:35:56,376 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:35:56,377 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 14:35:56,378 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 14:35:56,379 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:35:56,380 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:35:56,381 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:35:56,382 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:35:56,383 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:35:56,384 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:35:56,386 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:35:56,387 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:35:57,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:35:58,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:36:07,712 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:36:08,125 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:36:08,129 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:36:08,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:13,281 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:36:13,283 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:36:13,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:18,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:18,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:36:29,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:44,971 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:36:44,973 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:36:44,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:36:46,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:36:46,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:59,825 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:36:59,827 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:04,539 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:37:17,127 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:37:17,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:37:18,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:37:18,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:40,210 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:37:40,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:37:41,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:37:41,109 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:37:41,110 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:37:45,975 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:37:56,257 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:37:56,630 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 14:37:58,132 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:37:58,936 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 899
2025-11-17 14:37:58,938 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:38:02,176 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 492
2025-11-17 14:38:02,177 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:38:02,905 - ispa_next.appointments.models - DEBUG - Appointment Ricardo Filipe Pedroso Caseiro NE-GM 8283 WBAJP31010BT74974 ohne Termin.
