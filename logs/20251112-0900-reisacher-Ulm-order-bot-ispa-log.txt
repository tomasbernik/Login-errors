2025-11-12 09:00:32,096 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:00:32,102 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:00:53,898 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:01:05,416 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:01:21,119 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:01:46,217 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:01:58,733 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:02:02,486 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:02:03,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2020
2025-11-12 09:02:03,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:02:06,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 812
2025-11-12 09:02:06,132 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:02:06,133 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:02:06,982 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:02:07,956 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:04:01,911 - ispa_next.appointments.models - DEBUG - Appointment Gerhard Heierhoff NU-GH 5500 WBATX350X0NC21174 ohne Termin.
2025-11-12 09:04:01,924 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:04:01,948 - ispa_next.appointments.models - DEBUG - Appointment Marc-Oliver Simon UL-XS 94E WMW11DJ0702T73836 ohne Termin.
2025-11-12 09:04:01,956 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:04:01,976 - ispa_next.appointments.models - DEBUG - Appointment Luca Lissona NU-LL 2000 WBA5R11040FH06143 ohne Termin.
2025-11-12 09:04:01,997 - ispa_next.appointments.models - DEBUG - Appointment Carsten Werner NU-C 2705 WBAHF11050WW82664 ohne Termin.
2025-11-12 09:04:02,024 - ispa_next.appointments.models - DEBUG - Appointment Marcel Denis  WBAUX310X0A703707 ohne Termin.
2025-11-12 09:04:02,048 - ispa_next.appointments.models - DEBUG - Appointment Petrut-Marcelius Mindricel NU-KA 1990 WBAUG51020PV22612 ohne Termin.
2025-11-12 09:04:02,086 - ispa_next.appointments.models - DEBUG - Appointment Aline Walcher NU-XR 119 WBATY15050N035959 ohne Termin.
2025-11-12 09:04:02,112 - ispa_next.appointments.models - DEBUG - Appointment Wladislav Wiebe UL-SW 1204 WBAJT31030BV43579 ohne Termin.
2025-11-12 09:04:02,121 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:04:02,144 - ispa_next.appointments.models - DEBUG - Appointment Nadine Annabelle Peter UL-N 7218 WBATY55070N053421 ohne Termin.
2025-11-12 09:04:02,187 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Mihai Tritean NU-KL 2007 WBAVC31060VG12381 ohne Termin.
2025-11-12 09:04:02,210 - ispa_next.appointments.models - DEBUG - Appointment Günther Egner  WBAHF11090WW62966 ohne Termin.
2025-11-12 09:04:02,242 - ispa_next.appointments.models - DEBUG - Appointment Yannik Mario Missale BL-YM 99 WBA5V71060FH86625 ohne Termin.
2025-11-12 09:04:02,287 - ispa_next.appointments.models - DEBUG - Appointment Daniela Oßwald NU-DO 55 WBAUZ35030N001791 ohne Termin.
2025-11-12 09:04:02,312 - ispa_next.appointments.models - DEBUG - Appointment Dzafer Omerdic UL-DZ 74 WBAJP31070BT73165 ohne Termin.
2025-11-12 09:04:02,335 - ispa_next.appointments.models - DEBUG - Appointment Marcus Hermann BC-MP 307 WBAJP31050BT92541 ohne Termin.
2025-11-12 09:04:02,362 - ispa_next.appointments.models - DEBUG - Appointment   WBA5R11020FK27135 ohne Termin.
2025-11-12 09:04:02,389 - ispa_next.appointments.models - DEBUG - Appointment Ralf Pause NU-PX 88 WBAJM91050BH77340 ohne Termin.
2025-11-12 09:04:02,415 - ispa_next.appointments.models - DEBUG - Appointment Markus Henning UL-ML 35 WBA6L71060FJ55476 ohne Termin.
2025-11-12 09:04:02,446 - ispa_next.appointments.models - DEBUG - Appointment Hajro Gutic  WBAJP31030BT73745 ohne Termin.
2025-11-12 09:04:02,479 - ispa_next.appointments.models - DEBUG - Appointment Romina Reinhardt UL-JR 2202 WBAWY510900A40401 ohne Termin.
2025-11-12 09:04:02,507 - ispa_next.appointments.models - DEBUG - Appointment Emergenda NU-HK 202 WBA2D510805K80209 ohne Termin.
2025-11-12 09:04:02,537 - ispa_next.appointments.models - DEBUG - Appointment Philip Beck MA-LS 102 WBA31DX02LCD85300 ohne Termin.
2025-11-12 09:04:02,567 - ispa_next.appointments.models - DEBUG - Appointment Oula Alhajj BC-OH 2712 WBAVA71000KP97250 ohne Termin.
2025-11-12 09:04:02,592 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hucker NU-CM 105 WBATX35030NE04318 ohne Termin.
2025-11-12 09:04:02,617 - ispa_next.appointments.models - DEBUG - Appointment Gregor Golaski WR-802GF WBA6L71020FJ48038 ohne Termin.
2025-11-12 09:04:02,649 - ispa_next.appointments.models - DEBUG - Appointment PERI SE NU-PE 85 WBA5F31060FK22508 ohne Termin.
2025-11-12 09:04:02,682 - ispa_next.appointments.models - DEBUG - Appointment Zoran Kadric NU-Z 1963 WBAVA71070KR36693 ohne Termin.
2025-11-12 09:04:02,711 - ispa_next.appointments.models - DEBUG - Appointment Demir Burak NU-BD 6 WBA81GE0607U10713 ohne Termin.
2025-11-12 09:04:02,767 - ispa_next.appointments.models - DEBUG - Appointment Dr. Sachs Andreas NU-XV 777 WBA5R71010FJ22363 ohne Termin.
2025-11-12 09:04:02,804 - ispa_next.appointments.models - DEBUG - Appointment Dominic Kreuzpaintner NU-DK 50 WBA71GP0809058750 ohne Termin.
2025-11-12 09:04:02,840 - ispa_next.appointments.models - DEBUG - Appointment Herbert Ronald Eichholz NU-RE 1021 WBA6L51020FJ56533 ohne Termin.
2025-11-12 09:04:02,874 - ispa_next.appointments.models - DEBUG - Appointment Dumitru-Danut Grosu NU-RD 71 WBAJM91040BH80214 ohne Termin.
2025-11-12 09:04:02,900 - ispa_next.appointments.models - DEBUG - Appointment Hasan Dikmen UL-KD 7238 WBA1V710605A67475 ohne Termin.
2025-11-12 09:04:02,928 - ispa_next.appointments.models - DEBUG - Appointment Axel Hansmann NU-DH 525 WBAJN11030BK38677 ohne Termin.
2025-11-12 09:04:02,955 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 8400E WBY61EF0805419386 ohne Termin.
2025-11-12 09:04:02,991 - ispa_next.appointments.models - DEBUG - Appointment Bernd Schliefer ILL-KB 66 WBAJP31010BT73159 ohne Termin.
2025-11-12 09:04:03,030 - ispa_next.appointments.models - DEBUG - Appointment Max Hentschel NU-ME 2706 WBAJM91060BH38059 ohne Termin.
2025-11-12 09:04:03,075 - ispa_next.appointments.models - DEBUG - Appointment Valdrin Abazi  WBA11DY080FK03855 ohne Termin.
2025-11-12 09:04:03,104 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schmid UL-AS 2220 WBAJP31060BT84111 ohne Termin.
2025-11-12 09:04:03,130 - ispa_next.appointments.models - DEBUG - Appointment Azem Alispahic NU-SL 701 WBAJP31060BT75599 ohne Termin.
2025-11-12 09:04:03,154 - ispa_next.appointments.models - DEBUG - Appointment Verena Wolf NU-BV 777 WBAJT51090CE05828 ohne Termin.
2025-11-12 09:04:03,183 - ispa_next.appointments.models - DEBUG - Appointment Markus Wieland NU-MW 1988 WBA5R110X0FJ58307 ohne Termin.
2025-11-12 09:04:03,208 - ispa_next.appointments.models - DEBUG - Appointment Klara Maria Bühler UL-RK 1606 WBATX35070NC11458 ohne Termin.
2025-11-12 09:04:03,237 - ispa_next.appointments.models - DEBUG - Appointment Eren Dogan UL-ER 462 WBAJN11080BK38366 ohne Termin.
2025-11-12 09:04:03,268 - ispa_next.appointments.models - DEBUG - Appointment Peter Wagner NU-XL 48 WBATY55020N009035 ohne Termin.
2025-11-12 09:04:03,310 - ispa_next.appointments.models - DEBUG - Appointment Sasa Fuchs UL-E 2299 WBA11AS0X0CE79272 ohne Termin.
2025-11-12 09:04:03,340 - ispa_next.appointments.models - DEBUG - Appointment Veselin Dokic NU-VD 443 WBA5V51090FH54319 ohne Termin.
2025-11-12 09:04:03,372 - ispa_next.appointments.models - DEBUG - Appointment Sonnentag Transporte GmbH GP-S 4500 WBAHF31020WW32817 ohne Termin.
2025-11-12 09:04:03,410 - ispa_next.appointments.models - DEBUG - Appointment Helmut Häuptle UL-MH 444 WBAVJ910X09C23552 ohne Termin.
2025-11-12 09:04:03,438 - ispa_next.appointments.models - DEBUG - Appointment Michael Durst BC-JD 2017 WBA6L51060FJ59063 ohne Termin.
2025-11-12 09:04:03,469 - ispa_next.appointments.models - DEBUG - Appointment Ervin Mujagic  WBATX35020NC23615 ohne Termin.
2025-11-12 09:04:03,515 - ispa_next.appointments.models - DEBUG - Appointment Arici Selcuk UL-KY 442 WBAVU31030KY03266 ohne Termin.
2025-11-12 09:04:03,549 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-12 09:04:03,573 - ispa_next.appointments.models - DEBUG - Appointment Durna Zeynep Incedayi UL-PX 1 WMWXT710102C14755 ohne Termin.
2025-11-12 09:04:03,601 - ispa_next.appointments.models - DEBUG - Appointment Özlem Sandikci NU-EE 1903 WMWLR910602E68924 ohne Termin.
2025-11-12 09:04:03,616 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:04:03,651 - ispa_next.appointments.models - DEBUG - Appointment Bareiss Prüfgerätebau GmbH UL-CX 288 WBA61EE0705W35665 ohne Termin.
2025-11-12 09:04:03,693 - ispa_next.appointments.models - DEBUG - Appointment Thomas Fundel UL-TF 260 WBA5V71050FH67905 ohne Termin.
2025-11-12 09:04:03,734 - ispa_next.appointments.models - DEBUG - Appointment Leandra Kuschel UL-LQ 13 WBAVB31060VB69085 ohne Termin.
2025-11-12 09:04:03,765 - ispa_next.appointments.models - DEBUG - Appointment Guido Steinhauser BC-G 225 WBAWZ510400S27474 ohne Termin.
2025-11-12 09:04:03,791 - ispa_next.appointments.models - DEBUG - Appointment Daniela Feinäugle  WBA5F31050FJ57747 ohne Termin.
2025-11-12 09:04:03,819 - ispa_next.appointments.models - DEBUG - Appointment Izzet özcelik ILL-Z 57 WBADY31070E827083 ohne Termin.
2025-11-12 09:04:03,857 - ispa_next.appointments.models - DEBUG - Appointment Salih Karadeniz UL-SK 157 WBAJN71010BJ06939 ohne Termin.
2025-11-12 09:04:03,882 - ispa_next.appointments.models - DEBUG - Appointment Marco Troiano UL-MT 386 WBA1R510905L60132 ohne Termin.
2025-11-12 09:04:03,909 - ispa_next.appointments.models - DEBUG - Appointment Dieter Mack UL-DM 822 WBAHF11070WW89910 ohne Termin.
2025-11-12 09:04:03,936 - ispa_next.appointments.models - DEBUG - Appointment Autoforum-Muc NU-M 881 WBA11DX080CE08548 ohne Termin.
2025-11-12 09:04:03,962 - ispa_next.appointments.models - DEBUG - Appointment Hasib Mesic NU-HE 610 WBATX31060LC42685 ohne Termin.
2025-11-12 09:04:03,991 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Iman UL-EE 324 WBAUD71050P268270 ohne Termin.
2025-11-12 09:04:04,017 - ispa_next.appointments.models - DEBUG - Appointment Jessin Patrick Manai RT-JM 1401 WBA5F380608B42512 ohne Termin.
2025-11-12 09:04:04,053 - ispa_next.appointments.models - DEBUG - Appointment Sascha Hankele NU-H 1820 WBAKD91000E653198 ohne Termin.
2025-11-12 09:04:04,082 - ispa_next.appointments.models - DEBUG - Appointment BMW Car IT GmbH M-JC 1039E WBY31AW010FP54558 ohne Termin.
2025-11-12 09:04:04,110 - ispa_next.appointments.models - DEBUG - Appointment Janos Loboda UL-LJ 197 WBAVD91090AE65139 ohne Termin.
2025-11-12 09:04:04,137 - ispa_next.appointments.models - DEBUG - Appointment Hannelore Seidel NU-HS 132 WBAUM510X0VE93058 ohne Termin.
2025-11-12 09:04:04,167 - ispa_next.appointments.models - DEBUG - Appointment Emre Iman UL-EX 323 WBAAM31010AZ47872 ohne Termin.
2025-11-12 09:04:04,200 - ispa_next.appointments.models - DEBUG - Appointment Muharrem Aluc UL-MA 5800 WBA5L31010G484486 ohne Termin.
2025-11-12 09:04:04,265 - ispa_next.main - DEBUG - Found 15 out of 208 appointments to process (configured limit: 15).
2025-11-12 09:04:04,265 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-12 09:04:04,265 - ispa_next.main - DEBUG - Processing 7 already visited appointments (w/ RKR not callable).
2025-11-12 09:04:04,265 - ispa_next.main - DEBUG - All appointments: NU-U 711, GA447, NU J 3339, 3508, ul vk1010, UL-ST2016, ILL-GO-67, UL HN 9695, UL-WI 8888, UL-K 1058, NU-RU 2509, NU-EL 699E, ILL-MI 11, UL-Z 89, UL-MM 960
2025-11-12 09:04:04,268 - ispa_next.main - DEBUG - 



2025-11-12 09:04:04,268 - ispa_next.main - DEBUG - starting with process 1 (NU-U 711) of 15
2025-11-12 09:04:04,276 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:04:05,442 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:04:06,607 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2020
2025-11-12 09:04:06,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 812
2025-11-12 09:04:07,917 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:04:07,918 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:04:41,379 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:04:50,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:50,959 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:04:51,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:04:53,087 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:04:53,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:53,147 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:04:53,307 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:04:53,311 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:04:55,981 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:04:55,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:04:56,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:04:58,909 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:04:59,017 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:05:02,225 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:05:02,348 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:05:02,348 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:05:10,905 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:05:11,913 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:05:11,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:12,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:21,315 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:05:28,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:28,500 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:05:28,500 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:05:28,578 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 09:05:28,684 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 09:05:28,688 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:05:28,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:28,754 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:05:28,756 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:05:28,796 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:05:29,995 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:05:30,228 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:05:33,176 - ispa_next.functions - DEBUG - Updated appointment (AE00057143) customer contact data.
2025-11-12 09:05:34,089 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:05:34,093 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:05:34,653 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:05:34,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:05:35,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:05:39,782 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:05:39,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:05:40,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:05:42,327 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:05:42,415 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:05:42,502 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:05:42,574 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:05:42,576 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:05:53,794 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:05:57,754 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:05:57,754 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:06:01,966 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:06:02,972 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:06:02,973 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:06:02,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:06:03,097 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:06:07,183 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:06:07,189 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:06:07,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:06:07,278 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:06:16,113 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:06:24,367 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:06:24,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:06:25,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:06:25,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:06:25,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:06:25,784 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:06:28,328 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:06:28,330 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:06:29,434 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:06:29,436 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:06:29,438 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 09:06:29,438 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:06:29,441 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:06:29,447 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:06:29,454 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:06:29,460 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:06:29,462 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:06:29,464 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:06:29,466 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:06:29,468 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:06:29,472 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:06:52,099 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 09:06:52,203 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:06:52,206 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:06:52,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:06:53,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:06:53,480 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:06:53,508 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:06:55,806 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:06:55,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:06:56,981 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:06:56,982 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:06:59,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1230
2025-11-12 09:06:59,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:00,090 - ispa_next.appointments.models - DEBUG - Appointment Elfriede Gröger NU-EG 222 WBAYH310705S67986 ohne Termin.
2025-11-12 09:07:00,104 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:07:00,114 - ispa_next.main - DEBUG - Found new Appointment: UL-PY 28
2025-11-12 09:07:00,115 - ispa_next.main - DEBUG - Found new Appointment: UL-XS 21
2025-11-12 09:07:00,116 - ispa_next.main - DEBUG - 



2025-11-12 09:07:00,116 - ispa_next.main - DEBUG - starting with process 2 (UL-PY 28) of 17
2025-11-12 09:07:00,124 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:07:00,997 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:07:02,021 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:07:02,022 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1230
2025-11-12 09:07:03,651 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:07:03,652 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:28,844 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:07:38,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:07:38,907 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:07:39,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:07:40,968 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:07:40,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:07:41,036 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:07:41,311 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-12 09:07:48,786 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:07:48,790 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:07:51,581 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:07:51,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:07:52,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:07:54,631 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:07:54,751 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:07:57,935 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:07:58,006 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:07:58,006 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:08:06,370 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:08:07,375 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:08:07,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:07,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:20,707 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:08:27,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:27,640 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:08:27,642 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:08:27,872 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 09:08:27,985 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 09:08:27,989 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:08:28,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:28,110 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:08:28,110 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:08:28,151 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:08:29,368 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:08:29,602 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:08:32,782 - ispa_next.functions - DEBUG - Updated appointment (EM00002919) customer contact data.
2025-11-12 09:08:33,684 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:08:33,687 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:08:34,577 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:08:34,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:08:35,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:08:38,940 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:08:38,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:08:39,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:08:41,485 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:08:41,591 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:08:41,714 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:08:41,778 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:08:41,778 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:08:52,645 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:08:56,836 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:08:56,836 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:09:01,027 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:09:02,034 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:09:02,053 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:09:02,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:09:02,139 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:09:06,246 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:09:06,262 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:09:06,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:09:06,329 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:09:18,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:09:19,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:09:19,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:09:19,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:09:19,927 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:09:23,515 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:09:23,517 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:09:24,421 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:09:24,423 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:09:24,423 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:09:24,425 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:09:24,427 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:09:24,427 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:09:24,427 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:09:24,429 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:09:24,429 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:09:24,431 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:09:24,431 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:09:24,433 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:09:24,437 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:09:24,441 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:09:24,443 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:09:24,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:28,403 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:09:28,406 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:09:28,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:09:29,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:09:29,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:39,525 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:09:39,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:43,533 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:09:55,710 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:59,802 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-12 09:09:59,806 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:10:00,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:10:00,887 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:10:01,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:10:09,760 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:10:13,974 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:10:17,824 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:10:22,797 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:10:29,347 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:10:29,347 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:10:30,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:10:30,188 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:10:30,191 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:10:36,674 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:10:46,482 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:10:46,864 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:10:47,437 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:49,000 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:10:49,001 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:10:51,889 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1230
2025-11-12 09:10:51,890 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:10:52,691 - ispa_next.appointments.models - DEBUG - Appointment Elfriede Gröger NU-EG 222 WBAYH310705S67986 ohne Termin.
2025-11-12 09:10:52,707 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:10:52,715 - ispa_next.main - DEBUG - 



2025-11-12 09:10:52,715 - ispa_next.main - DEBUG - starting with process 3 (UL-XS 21) of 17
2025-11-12 09:10:52,720 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:10:53,624 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:55,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:10:55,017 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1230
2025-11-12 09:10:56,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:10:56,518 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:22,493 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:11:24,644 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:11:29,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:11:33,938 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:11:33,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:34,013 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:11:34,269 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:11:34,273 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:11:37,241 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:11:37,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:11:38,250 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:11:40,262 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:11:40,376 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:11:40,501 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:11:40,611 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:11:42,716 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:11:43,723 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:11:43,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:44,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:56,010 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:11:56,010 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:11:59,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:59,743 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:11:59,743 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:11:59,930 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:11:59,933 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:11:59,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:59,996 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:11:59,998 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:12:00,087 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:12:00,231 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:12:01,493 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:12:01,758 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:12:03,520 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:12:03,523 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:12:03,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:12:04,484 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:12:05,707 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:12:05,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:12:05,779 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:12:09,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:12:09,345 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:12:09,350 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:12:09,352 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:12:09,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:09,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:13,996 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:12:17,757 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:12:17,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:17,836 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:12:18,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:18,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:18,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:19,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:19,414 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:12:23,039 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:12:23,041 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:12:23,925 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:12:23,926 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:12:23,927 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:12:23,928 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:12:23,929 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:12:23,931 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:12:23,932 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:12:23,932 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:12:23,934 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:12:23,934 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:12:23,937 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:12:23,937 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:12:23,948 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:12:23,956 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:12:23,960 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:12:23,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:27,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:28,012 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:12:39,422 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:12:39,426 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:12:39,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:12:40,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:12:40,252 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:12:40,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:44,127 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:12:53,888 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:12:54,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:12:54,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:12:55,010 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:03,515 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:13:07,530 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:13:12,010 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:13:15,817 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:13:15,818 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:13:16,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:13:16,512 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:13:16,516 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:13:22,127 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:13:29,618 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:13:29,990 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:13:30,938 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:13:32,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:13:32,155 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:13:34,567 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:13:34,568 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:13:35,461 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:13:35,469 - ispa_next.main - DEBUG - Found new Appointment: NU-EG 222
2025-11-12 09:13:35,470 - ispa_next.main - DEBUG - 



2025-11-12 09:13:35,471 - ispa_next.main - DEBUG - starting with process 4 (NU-EG 222) of 18
2025-11-12 09:13:35,476 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:13:36,814 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:13:37,991 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:13:37,993 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:13:39,683 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:13:39,684 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:14:03,714 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:14:13,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:13,702 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:14:13,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:17,835 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:14:17,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:17,922 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:14:18,195 - ispa_next.functions - DEBUG - HU date already expired after 2 days.
2025-11-12 09:14:25,981 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:14:25,986 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:14:28,760 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:14:28,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:14:29,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:14:31,772 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:14:31,887 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:14:31,978 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:14:32,037 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:14:32,037 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:14:42,842 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:14:47,235 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:14:47,237 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:14:51,402 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:14:52,413 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:14:52,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:52,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:03,271 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:15:03,271 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:15:09,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:10,374 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:15:10,374 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:15:10,548 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 09:15:10,687 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 09:15:10,695 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:15:10,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:10,774 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:15:10,776 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:15:10,808 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:15:10,917 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:15:12,090 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:15:12,338 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:15:15,477 - ispa_next.functions - DEBUG - Updated appointment (EM00002921) customer contact data.
2025-11-12 09:15:16,416 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:15:16,418 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:15:16,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:15:17,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:15:18,804 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:15:18,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:15:19,103 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:15:22,718 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:15:22,718 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:15:22,722 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:15:22,724 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:15:22,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:23,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:15:27,367 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:15:28,137 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:15:42,857 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:15:42,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:42,987 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:15:46,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:47,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:47,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:47,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:15:47,995 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:15:52,276 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:15:52,278 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:15:53,616 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:15:53,617 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:15:53,619 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:15:53,620 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:15:53,622 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:15:53,626 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:15:53,635 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:15:53,637 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:15:53,647 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:15:53,651 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:15:53,654 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:15:53,678 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:15:53,690 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:15:53,692 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:15:53,696 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:15:53,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:15:58,487 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:15:58,491 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:15:58,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:15:59,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:15:59,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:16:11,810 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:16:11,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:16:16,640 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:16:33,113 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:16:33,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:16:34,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:16:34,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:16:44,913 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:16:50,344 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:16:55,686 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:17:03,836 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:17:03,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:17:04,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:17:04,856 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:17:04,859 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:17:11,339 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:17:24,426 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:17:24,837 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:17:25,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:17:33,331 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:17:33,334 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:17:40,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:17:40,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:17:41,427 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:17:41,436 - ispa_next.main - DEBUG - 



2025-11-12 09:17:41,436 - ispa_next.main - DEBUG - starting with process 5 (GA447) of 18
2025-11-12 09:17:41,441 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:17:43,297 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:17:45,135 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:17:45,137 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:17:48,147 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:17:48,149 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:25,808 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:18:25,827 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:18:25,836 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:26,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:18:26,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:33,280 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:18:33,281 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:34,473 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:18:34,481 - ispa_next.main - DEBUG - 



2025-11-12 09:18:34,481 - ispa_next.main - DEBUG - starting with process 6 (NU J 3339) of 18
2025-11-12 09:18:34,487 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:35,888 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:37,240 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:18:37,241 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:18:40,283 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:40,285 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:19:16,546 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:19:16,556 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:19:16,562 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:19:17,249 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:19:17,251 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:19:23,725 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:19:23,726 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:19:24,869 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:19:24,879 - ispa_next.main - DEBUG - 



2025-11-12 09:19:24,879 - ispa_next.main - DEBUG - starting with process 7 (3508) of 18
2025-11-12 09:19:24,884 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:19:26,741 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:19:28,718 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:19:28,719 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:19:31,932 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:19:31,933 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:07,264 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:20:07,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:20:07,284 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:08,202 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:20:08,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:14,401 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:20:14,402 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:15,612 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:20:15,620 - ispa_next.main - DEBUG - 



2025-11-12 09:20:15,620 - ispa_next.main - DEBUG - starting with process 8 (ul vk1010) of 18
2025-11-12 09:20:15,626 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:20:17,556 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:20:19,583 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:20:19,585 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:20:22,711 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:20:22,713 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:20:59,616 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:20:59,626 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:20:59,640 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:00,432 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:21:00,433 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:06,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:21:06,252 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:07,463 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:21:07,475 - ispa_next.main - DEBUG - 



2025-11-12 09:21:07,475 - ispa_next.main - DEBUG - starting with process 9 (UL-ST2016) of 18
2025-11-12 09:21:07,481 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:08,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:10,212 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:21:10,213 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:21:12,953 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:12,954 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:48,392 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:21:48,404 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:21:48,410 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:49,273 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:21:49,273 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:55,360 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:21:55,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:56,569 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:21:56,576 - ispa_next.main - DEBUG - 



2025-11-12 09:21:56,576 - ispa_next.main - DEBUG - starting with process 10 (ILL-GO-67) of 18
2025-11-12 09:21:56,581 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:57,900 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:59,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:21:59,347 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:22:02,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:02,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:35,617 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:22:35,633 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:22:35,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:36,617 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:22:36,621 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:42,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:22:42,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:44,132 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:22:44,140 - ispa_next.main - DEBUG - 



2025-11-12 09:22:44,140 - ispa_next.main - DEBUG - starting with process 11 (UL HN 9695) of 18
2025-11-12 09:22:44,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:22:45,866 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:22:48,119 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:22:48,121 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:22:51,507 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:22:51,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:23:28,201 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:23:28,215 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:23:28,220 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:23:29,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:23:29,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:23:34,898 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:23:34,899 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:23:35,903 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:23:35,910 - ispa_next.main - DEBUG - 



2025-11-12 09:23:35,910 - ispa_next.main - DEBUG - starting with process 12 (UL-WI 8888) of 18
2025-11-12 09:23:35,916 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:23:37,736 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:23:39,769 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:23:39,771 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:23:42,925 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:23:42,927 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:24:11,207 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:24:14,151 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:24:20,807 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:23,467 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:24:23,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:23,549 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:24:23,887 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:24:23,892 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:24:26,940 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:24:26,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:24:28,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:24:30,367 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:24:30,513 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:24:31,128 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:24:31,315 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:24:35,553 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:24:36,560 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:24:36,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:37,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:52,789 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:24:59,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:59,200 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:24:59,200 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:24:59,538 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:24:59,542 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:24:59,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:24:59,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:24:59,632 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:24:59,711 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:25:00,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:25:02,149 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:25:02,415 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:25:03,952 - ispa_next.functions - DEBUG - Updated appointment (GS00001180) customer contact data.
2025-11-12 09:25:04,864 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:25:04,874 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:25:06,249 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:25:06,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:25:07,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:25:11,217 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:25:11,217 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:25:11,223 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:25:11,228 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:25:11,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:11,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:15,958 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:25:15,964 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:25:15,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:16,091 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:25:21,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:22,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:22,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:23,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:23,010 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:25:25,558 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:25:25,560 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:25:26,916 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:25:26,918 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:25:26,919 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:25:26,920 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:25:26,922 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:25:26,923 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:25:26,924 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:25:26,926 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:25:26,927 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:25:26,927 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:25:26,929 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:25:26,931 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:25:26,943 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:25:26,947 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:25:26,953 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:25:26,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:29,633 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:25:29,642 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:25:29,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:25:30,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:25:31,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:42,484 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:25:42,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:45,078 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:25:58,691 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:25:59,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:25:59,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:26:00,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:08,870 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:26:13,807 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:26:20,338 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:26:20,341 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:26:20,342 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:21,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:26:21,497 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:26:21,499 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:26:24,357 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:26:35,334 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:26:35,701 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:26:36,549 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:44,403 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:26:44,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:51,532 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:26:51,533 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:52,803 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:26:52,813 - ispa_next.main - DEBUG - 



2025-11-12 09:26:52,813 - ispa_next.main - DEBUG - starting with process 13 (UL-K 1058) of 18
2025-11-12 09:26:52,819 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:54,697 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:56,502 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2023
2025-11-12 09:26:56,515 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:26:59,495 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:59,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:29,309 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:27:31,562 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:27:37,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:40,495 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:27:40,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:40,581 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:27:40,862 - ispa_next.functions - DEBUG - HU date already expired after 1003 days.
2025-11-12 09:27:46,546 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:27:46,550 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:27:49,358 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:27:49,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:50,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:27:52,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:27:52,699 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:27:52,848 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:27:52,958 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:27:57,205 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:27:58,212 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:27:58,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:58,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:14,970 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:28:19,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:19,822 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:28:19,822 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:28:20,010 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 09:28:20,180 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 09:28:20,184 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:28:20,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:20,316 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:28:20,318 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:28:20,386 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:28:20,542 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:28:21,791 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:28:23,109 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:28:23,480 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:28:25,184 - ispa_next.functions - DEBUG - Updated appointment (FO00001775) customer contact data.
2025-11-12 09:28:26,079 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:28:26,082 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:28:26,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:28:27,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:28:28,357 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:28:28,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:28:28,462 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:28:32,087 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:28:32,087 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:28:32,093 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:28:32,093 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:28:32,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:32,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:36,829 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:28:36,835 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:28:36,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:36,938 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:28:37,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:37,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:37,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:38,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:38,574 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:28:41,100 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:28:41,101 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:28:42,526 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:28:42,530 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:28:42,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:28:42,536 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:28:42,538 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:28:42,538 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:28:42,540 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:28:42,542 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:28:42,542 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:28:42,544 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:28:42,544 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:28:42,546 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:28:42,551 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:28:42,554 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:28:42,558 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:28:42,564 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:45,228 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:28:45,232 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:28:45,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:28:46,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:28:46,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:56,637 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:28:56,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:59,339 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:29:14,867 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:29:15,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:29:16,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:29:16,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:25,400 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:29:31,231 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:29:36,927 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:29:36,931 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:29:36,931 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:29:37,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:29:37,891 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:29:37,894 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:29:40,292 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:29:50,885 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:29:51,262 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:29:51,998 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:00,517 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2025
2025-11-12 09:30:00,519 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:07,297 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:30:07,298 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:08,466 - ispa_next.appointments.models - DEBUG - Appointment Isa Latifov  WBAJD51000BC81466 ohne Termin.
2025-11-12 09:30:08,480 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:30:08,489 - ispa_next.main - DEBUG - 



2025-11-12 09:30:08,489 - ispa_next.main - DEBUG - starting with process 14 (NU-RU 2509) of 18
2025-11-12 09:30:08,495 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:10,302 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:12,143 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2025
2025-11-12 09:30:12,144 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:30:15,292 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:15,294 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:45,071 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:30:47,788 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:30:54,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:56,500 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:30:56,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:56,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:30:56,931 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:30:56,935 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:31:00,041 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:31:00,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:01,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:03,220 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:31:03,349 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:31:03,521 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:31:03,614 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:31:07,828 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:31:08,836 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:31:08,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:09,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:24,615 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:31:30,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:30,330 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:31:30,331 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:31:30,547 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:31:30,551 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:31:30,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:30,673 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:31:30,673 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:31:30,725 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:31:30,922 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:31:32,271 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:31:32,490 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:31:34,257 - ispa_next.functions - DEBUG - Updated appointment (KG00000183) customer contact data.
2025-11-12 09:31:35,174 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:31:35,177 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:31:35,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:31:36,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:31:38,190 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:31:38,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:31:38,311 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:31:41,899 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:31:41,899 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:31:41,905 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:31:41,907 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:31:41,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:42,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:46,610 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:31:46,616 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:31:46,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:46,732 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:31:47,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:47,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:47,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:48,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:48,519 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:31:50,464 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:31:50,471 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:31:51,681 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:31:51,691 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:31:51,693 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:31:51,695 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:31:51,695 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:31:51,697 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:31:51,697 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:31:51,699 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:31:51,701 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:31:51,701 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:31:51,703 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:31:51,705 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:31:51,709 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:31:51,713 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:31:51,716 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:31:51,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:53,704 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:31:53,708 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:31:53,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:31:54,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:31:55,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:04,460 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:32:04,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:06,458 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:32:22,175 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:32:22,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:32:23,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:32:23,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:31,435 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:32:37,845 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:32:37,847 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:32:37,849 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:38,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:32:39,045 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:32:39,048 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:32:42,091 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:32:54,406 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:32:54,793 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:32:55,581 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:03,548 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2025
2025-11-12 09:33:03,550 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:10,313 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:33:10,313 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:11,545 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:33:11,551 - ispa_next.main - DEBUG - Found new Appointment: KEIN KENNZEICHEN
2025-11-12 09:33:11,552 - ispa_next.main - DEBUG - 



2025-11-12 09:33:11,552 - ispa_next.main - DEBUG - starting with process 15 (KEIN KENNZEICHEN) of 19
2025-11-12 09:33:11,557 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:33:13,340 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:33:15,287 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2025
2025-11-12 09:33:15,288 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:33:18,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:33:18,929 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:34:02,036 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:34:14,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:18,140 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:34:18,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:18,221 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:18,519 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:34:28,138 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:34:28,142 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:34:31,122 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:34:31,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:32,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:34,699 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:34:34,847 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:34:38,110 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:34:38,205 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:34:40,391 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:34:41,399 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:34:41,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:41,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:46,882 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 09:34:46,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:46,970 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:46,970 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:34:47,233 - ispa_next.functions - DEBUG - At least one field missing in contact details
2025-11-12 09:34:47,373 - ispa_next.common.mail - INFO - Successfully sent an email to 7 recipients
2025-11-12 09:34:47,379 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:34:47,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:47,486 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:47,487 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:34:47,545 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:34:48,856 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:34:49,092 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:34:52,829 - ispa_next.functions - DEBUG - Updated appointment (HA00000562) customer contact data.
2025-11-12 09:34:53,746 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:34:53,750 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:34:55,111 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:34:55,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:34:56,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:35:00,959 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:35:00,959 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:35:01,011 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:35:01,012 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:35:01,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:01,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:05,796 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:35:07,096 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:35:21,163 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:35:21,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:21,417 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:35:22,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:22,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:22,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:23,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:23,662 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:35:27,996 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:35:27,998 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:35:29,413 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:35:29,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:35:29,416 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:35:29,417 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:35:29,419 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:35:29,421 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=manual, target=advice_list), Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=manual, target=advice_list)}
2025-11-12 09:35:29,422 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:35:29,423 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:35:29,424 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:35:29,427 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:35:29,449 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 09:35:30,241 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:35:40,590 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:35:40,594 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:35:40,597 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:35:40,600 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:45,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:45,473 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:35:56,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:13,376 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:36:13,378 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:36:13,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:36:15,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:36:15,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:53,763 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:36:53,765 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:58,600 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:37:14,676 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:37:15,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:37:15,922 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:37:16,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:27,477 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:34,215 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:42,157 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:37:42,157 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:37:43,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:37:43,136 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:37:43,140 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:37:49,565 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:38:09,421 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 09:38:09,424 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:38:09,424 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:11,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:38:11,434 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:38:11,436 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:38:13,815 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 09:38:13,849 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:38:17,049 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 09:38:17,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:24,821 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2026
2025-11-12 09:38:24,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:31,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:38:31,490 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:32,763 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:38:32,770 - ispa_next.main - DEBUG - 



2025-11-12 09:38:32,770 - ispa_next.main - DEBUG - starting with process 16 (NU-EL 699E) of 19
2025-11-12 09:38:32,776 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:34,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:36,414 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2026
2025-11-12 09:38:36,415 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:38:39,628 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:39,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:11,322 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:39:14,284 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:39:21,341 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:23,276 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:39:23,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:23,356 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:23,636 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:39:23,638 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:39:26,614 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:39:26,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:27,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:39:29,972 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:39:30,136 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:39:30,299 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:39:30,396 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:39:34,669 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:39:35,675 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:39:35,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:36,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:52,179 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:39:52,179 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:39:58,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:58,269 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:58,269 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:39:58,537 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:39:58,541 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:39:58,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:58,612 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:58,612 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:39:58,705 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:40:00,040 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:40:01,337 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:40:01,603 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:40:03,652 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:40:03,681 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:40:05,023 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:40:05,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:40:06,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:40:10,811 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 09:40:10,811 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:10,811 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:40:10,817 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:40:10,817 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:40:10,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:11,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:15,574 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:40:15,579 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:40:15,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:15,701 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:40:21,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:21,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:21,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:22,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:22,607 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:40:24,495 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:40:24,497 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:40:25,566 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:40:25,568 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:40:25,570 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:40:25,572 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:40:25,574 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:40:25,576 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:40:25,578 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:40:25,580 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:40:25,580 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:40:25,583 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:40:25,588 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:40:25,591 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:40:25,596 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:40:25,599 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:40:25,601 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:40:25,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:27,486 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:40:27,489 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:40:27,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:40:28,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:40:28,843 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:39,628 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:40:39,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:41,580 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:40:56,821 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:40:57,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:40:58,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:40:58,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:06,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:13,393 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:13,395 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:41:13,397 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:41:14,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:41:14,545 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:41:14,548 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:41:17,358 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:41:30,150 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:41:30,548 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 09:41:31,415 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:41:39,403 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2028
2025-11-12 09:41:39,404 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:41:45,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:41:45,337 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:41:46,262 - ispa_next.appointments.models - DEBUG - Appointment Maja Kovacevic UL-DM 19 WMW71BB0702N75458 ohne Termin.
2025-11-12 09:41:46,280 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:41:46,285 - ispa_next.main - DEBUG - 



2025-11-12 09:41:46,286 - ispa_next.main - DEBUG - starting with process 17 (ILL-MI 11) of 19
2025-11-12 09:41:46,290 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:41:48,148 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:41:49,619 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2028
2025-11-12 09:41:49,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1229
2025-11-12 09:41:52,345 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:41:52,346 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:42:25,590 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:42:29,156 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:42:35,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:39,084 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:42:39,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:42:39,167 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:42:39,478 - ispa_next.functions - DEBUG - HU date already expired after 2428 days.
2025-11-12 09:42:46,073 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:42:46,076 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:42:49,106 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:42:49,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:42:50,545 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:42:52,550 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:42:52,670 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:42:52,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:42:52,870 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:42:57,073 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:42:58,080 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:42:58,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:42:58,541 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:13,933 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:43:13,934 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:43:20,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:20,738 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:20,738 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:43:20,994 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:43:20,996 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:43:21,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:21,124 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:21,125 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:43:21,185 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:43:21,384 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:43:22,769 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:43:22,991 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:43:25,662 - ispa_next.functions - DEBUG - Updated appointment (AE00056518) customer contact data.
2025-11-12 09:43:26,573 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:43:26,576 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:43:26,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:43:28,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:43:29,644 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:43:29,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:43:29,748 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:43:33,826 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:43:33,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:43:33,828 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:43:33,844 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:43:33,844 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:43:33,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:34,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:43:39,105 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:43:39,112 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:43:39,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:39,204 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:43:39,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:40,159 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:40,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:41,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:43:41,009 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:43:44,207 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:43:44,211 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:43:45,673 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:43:45,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:43:45,680 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:43:45,682 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:43:45,685 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:43:45,687 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:43:45,687 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:43:45,689 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:43:45,690 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:43:45,692 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:43:45,692 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:43:45,695 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:43:45,699 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:43:45,701 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:43:45,705 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:43:45,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:49,126 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:43:49,130 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:43:49,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:43:50,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:43:50,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:01,419 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:44:01,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:04,803 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:44:20,516 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:44:21,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:21,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:44:22,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:32,272 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:38,531 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:46,722 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:53,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:44:53,333 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:44:53,335 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:44:54,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:54,529 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:44:54,531 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:44:57,553 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:45:09,563 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:45:09,942 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 09:45:10,832 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:19,153 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2027
2025-11-12 09:45:19,155 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:25,717 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:45:25,718 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:27,007 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:45:27,014 - ispa_next.main - DEBUG - 



2025-11-12 09:45:27,014 - ispa_next.main - DEBUG - starting with process 18 (UL-Z 89) of 19
2025-11-12 09:45:27,020 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:28,934 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:30,909 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2027
2025-11-12 09:45:30,910 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1228
2025-11-12 09:45:34,105 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:34,107 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:08,034 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:46:10,904 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:46:18,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:18,184 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:18,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:21,092 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:46:21,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:21,166 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:46:21,527 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:46:21,534 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:46:24,684 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:46:24,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:46:26,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:46:28,377 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:46:28,534 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:46:28,687 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:46:28,782 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:46:28,784 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:46:38,597 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:46:39,604 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:46:39,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:40,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:46:56,030 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:46:56,030 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:47:02,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:02,423 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:02,423 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:47:02,755 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:47:02,757 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:47:02,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:02,873 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:02,873 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:47:02,916 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:47:03,080 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:47:04,578 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:47:04,890 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:47:06,765 - ispa_next.functions - DEBUG - Updated appointment (AH00030613) customer contact data.
2025-11-12 09:47:07,663 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:47:07,666 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:47:07,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:47:09,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:47:11,219 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:47:11,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:47:11,317 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:47:15,016 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:15,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:15,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:17,564 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:47:17,715 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:47:17,875 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:47:17,986 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:47:17,986 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:47:27,124 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:48:27,126 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:48:36,708 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:49:08,710 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:49:17,771 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:49:27,966 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:49:28,974 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:49:28,974 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:49:28,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:49:29,115 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:49:33,290 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:49:33,296 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:49:33,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:49:33,406 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:49:33,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:49:34,369 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:49:34,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:49:35,188 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:49:35,190 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:49:37,768 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:49:37,773 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:49:39,282 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:49:39,284 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:49:39,286 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:49:39,286 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:49:39,288 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:49:39,289 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:49:39,290 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:49:39,291 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:49:39,292 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:49:39,294 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:49:39,294 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:49:39,303 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:49:39,309 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:49:39,313 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:49:39,315 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:49:39,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:41,998 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:49:42,002 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:49:42,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:49:43,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:49:43,195 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:49:43,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:45,895 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:50:00,747 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:50:01,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:50:01,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:50:02,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:50:11,527 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:17,530 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:23,701 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:23,703 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:50:23,705 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:50:24,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:50:24,881 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:50:24,885 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:50:27,748 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:50:40,046 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:50:40,443 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 09:50:41,128 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:50:49,223 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2027
2025-11-12 09:50:49,224 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:50:56,796 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1227
2025-11-12 09:50:56,797 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:50:58,072 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
2025-11-12 09:50:58,079 - ispa_next.main - DEBUG - 



2025-11-12 09:50:58,079 - ispa_next.main - DEBUG - starting with process 19 (UL-MM 960) of 19
2025-11-12 09:50:58,085 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:50:59,993 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:51:01,872 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2027
2025-11-12 09:51:01,873 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1227
2025-11-12 09:51:05,889 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:51:05,890 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:51:40,878 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:51:44,564 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:51:51,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:51,152 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:51:51,386 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:51:54,158 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:51:54,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:51:54,264 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:51:54,635 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:51:54,640 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:51:57,731 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:51:57,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:51:59,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:52:01,470 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:52:01,609 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:52:01,765 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:52:01,919 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:52:01,921 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:52:11,837 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:52:12,842 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:52:12,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:52:13,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:52:29,628 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:52:29,628 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:52:40,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:52:40,158 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:52:40,160 - ispa_next.functions - DEBUG - check_contact_details
2025-11-12 09:52:40,434 - ispa_next.functions - DEBUG - All contact details found, exit.
2025-11-12 09:52:40,438 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:52:40,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:52:40,521 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:52:40,523 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:52:40,569 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:52:41,942 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:52:43,229 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:52:43,434 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:52:45,436 - ispa_next.functions - DEBUG - Updated appointment (AW00007506) customer contact data.
2025-11-12 09:52:46,371 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:52:46,375 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:52:48,371 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:52:48,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:52:49,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:52:53,170 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:52:53,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:52:53,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:52:55,683 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:52:55,817 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:52:55,952 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:52:56,091 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:52:56,091 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:53:05,351 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:54:05,355 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:54:15,083 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:54:41,085 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:54:50,097 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:55:00,109 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:55:01,118 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:55:01,118 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:55:01,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:55:01,272 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:55:05,475 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:55:05,481 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:55:05,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:55:05,602 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:55:09,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:55:09,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:55:09,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:55:10,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:55:10,457 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:55:12,990 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:55:12,992 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:55:14,332 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:55:14,334 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:55:14,336 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:55:14,338 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:55:14,338 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:55:14,340 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:55:14,342 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:55:14,342 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:55:14,344 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:55:14,344 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:55:14,346 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:55:14,348 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:55:14,352 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:55:14,356 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:55:14,359 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:55:14,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:17,078 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:55:17,082 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:55:17,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:55:18,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:55:18,312 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:55:18,314 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:20,974 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:55:35,917 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:55:36,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:55:37,035 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:55:37,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:55:46,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:52,714 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:59,316 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:55:59,320 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:55:59,320 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:56:00,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:56:00,463 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:56:00,465 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:56:03,409 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:56:16,122 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:56:16,512 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 09:56:17,387 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:56:25,695 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2029
2025-11-12 09:56:25,697 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:56:33,079 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1227
2025-11-12 09:56:33,080 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:56:34,359 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:56:34,376 - ispa_next.appointments.models - DEBUG - Appointment Robert Schmid MN-J 2108 WMW31DK0X02P94425 ohne Termin.
