2025-11-17 09:51:34,382 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:51:34,385 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:51:50,064 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:52:00,620 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:52:16,375 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:52:41,362 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:52:54,181 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:52:56,541 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:52:57,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 169
2025-11-17 09:52:57,389 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-17 09:52:59,855 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 09:52:59,856 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:52:59,857 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:53:00,826 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:53:02,104 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:53:14,189 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:53:14,243 - ispa_next.main - DEBUG - Found 15 out of 87 appointments to process (configured limit: 15).
2025-11-17 09:53:14,243 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 09:53:14,243 - ispa_next.main - DEBUG - All appointments: WI-HP 2387, ROF-PG 72, HEF-AB 332, ROF-NR 1, SM-J 9876 E, HEF-DK 975, WAK-UA 777, HEF-XD 11, HEF-XY 80, HEF-SM 9, HEF-TF 911, HR-SH 246, HEF-IB 999, KEIN KENNZEICHEN, WI-YS 134
2025-11-17 09:53:14,245 - ispa_next.main - DEBUG - 



2025-11-17 09:53:14,245 - ispa_next.main - DEBUG - starting with process 1 (WI-HP 2387) of 15
2025-11-17 09:53:14,249 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:53:15,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:53:16,143 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 169
2025-11-17 09:53:16,145 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 09:53:17,459 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:53:17,461 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:53:46,945 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:53:57,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:53:57,165 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:53:57,319 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:53:58,587 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:53:58,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:53:58,680 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:53:58,930 - ispa_next.functions - DEBUG - HU date soon to be invalid in 13 days.
2025-11-17 09:54:05,868 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:54:05,871 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:54:08,634 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:54:08,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:09,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:54:11,641 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:54:11,771 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:54:14,973 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:54:15,082 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:54:15,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:54:16,354 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:54:27,582 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:54:28,586 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:54:28,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:29,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:41,424 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 09:54:47,776 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:54:47,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:47,848 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:54:47,849 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:54:47,988 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:54:48,260 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:54:49,525 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:54:49,795 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:54:53,362 - ispa_next.functions - DEBUG - Updated appointment (AA00026215) customer contact data.
2025-11-17 09:54:54,267 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:54:54,269 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:54:54,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:54:55,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:54:56,580 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:54:56,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:54:56,662 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:55:00,245 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:55:00,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:55:00,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:55:02,744 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:55:02,867 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:55:02,960 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:55:03,036 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:55:03,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:55:04,945 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:55:16,080 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:56:16,083 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:56:27,397 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:56:47,400 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:56:58,441 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:57:05,172 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 09:57:06,178 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:57:06,180 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:57:06,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:06,257 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:57:10,369 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:57:10,374 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:57:10,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:10,455 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:57:10,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:11,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:11,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:12,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:57:12,062 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:57:13,930 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:57:13,968 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:57:14,949 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:57:14,951 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:57:14,952 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 09:57:14,953 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:57:14,954 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:57:14,955 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:57:14,956 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:57:14,957 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:57:14,958 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:57:14,960 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:57:14,961 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:57:15,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 09:57:16,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 09:57:27,169 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:57:27,171 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:57:27,174 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:57:27,175 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:57:29,786 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:57:29,788 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:57:29,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:57:32,359 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:57:32,361 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:57:32,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 09:57:32,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 09:57:32,865 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:57:32,867 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:57:43,678 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:57:44,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:57:44,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:57:44,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:58:10,128 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:13,233 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:17,640 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:58:17,643 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:58:17,644 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:58:18,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:58:18,361 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:58:18,363 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 09:58:18,392 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 09:58:21,182 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:58:21,186 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:58:21,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 09:58:21,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:58:24,450 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-17 09:58:24,451 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:58:25,288 - ispa_next.main - DEBUG - 



2025-11-17 09:58:25,288 - ispa_next.main - DEBUG - starting with process 2 (ROF-PG 72) of 15
2025-11-17 09:58:25,292 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:58:26,499 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:58:27,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 09:58:27,799 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-17 09:58:29,149 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:58:29,150 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:59:03,474 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:59:13,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:59:14,629 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:59:14,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:59:14,744 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:59:14,984 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:59:14,998 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:59:17,970 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:59:17,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:59:18,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:59:20,822 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:59:20,947 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:59:24,168 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:59:24,235 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:59:28,428 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:59:29,435 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:59:29,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:59:29,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:59:40,659 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 09:59:47,861 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:59:47,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:59:47,988 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:59:47,989 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:59:48,024 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:59:49,326 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:59:49,606 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:59:53,640 - ispa_next.functions - DEBUG - Updated appointment (AA00026211) customer contact data.
2025-11-17 09:59:54,545 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:59:54,547 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:59:55,102 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:59:55,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:59:55,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:59:59,463 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:59:59,463 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:59:59,466 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:59:59,466 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:59:59,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:59:59,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:00:04,089 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:00:04,092 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:00:04,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:00:04,178 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:00:08,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:00:08,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:00:08,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:00:09,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:00:09,810 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:00:11,419 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:00:11,421 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:00:12,502 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:00:12,506 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:00:12,509 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:00:12,511 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:00:12,512 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:00:12,514 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:00:12,515 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:00:12,517 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:00:12,518 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:00:12,520 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:00:12,522 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:00:13,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:00:13,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:00:25,131 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:00:25,133 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:00:25,136 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:00:25,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:27,090 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:00:27,093 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:00:27,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:28,973 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:00:28,975 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:00:28,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:00:29,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:00:29,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:00:35,918 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:00:35,920 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:00:47,062 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:00:47,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:00:48,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:00:48,327 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:01:06,812 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:01:11,526 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:01:11,528 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:01:11,529 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:01:12,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:01:12,220 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:01:12,221 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:01:12,250 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:01:15,122 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:01:15,125 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:01:15,631 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:01:15,632 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:01:18,614 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-17 10:01:18,615 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:01:19,366 - ispa_next.main - DEBUG - 



2025-11-17 10:01:19,366 - ispa_next.main - DEBUG - starting with process 3 (HEF-AB 332) of 15
2025-11-17 10:01:19,369 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:01:20,258 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:01:21,241 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:01:21,242 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-17 10:01:22,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:01:22,397 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:01:55,295 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:02:04,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:04,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:02:04,675 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:02:05,925 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:02:05,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:06,005 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:02:06,252 - ispa_next.functions - DEBUG - HU date already expired after 726 days.
2025-11-17 10:02:13,189 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:02:13,192 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:02:16,057 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:02:16,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:02:17,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:02:19,130 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:02:25,714 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:02:33,503 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:02:34,509 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:02:34,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:35,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:46,642 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:02:53,825 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:02:53,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:02:53,890 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:02:53,890 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:02:53,974 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:02:54,088 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:02:55,217 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:02:55,443 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:02:59,725 - ispa_next.functions - DEBUG - Updated appointment (AB00024164) customer contact data.
2025-11-17 10:03:00,638 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:03:00,640 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:03:00,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:03:01,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:03:02,730 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:03:02,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:03:02,803 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:03:07,269 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:03:07,269 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:03:07,276 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:03:07,277 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:03:07,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:07,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:11,897 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:03:11,901 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:03:11,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:11,975 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:03:12,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:12,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:03:12,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:03:13,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:03:13,618 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:03:16,179 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:03:16,192 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:03:17,260 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:03:17,261 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:03:17,262 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:03:17,263 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:03:17,265 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:03:17,265 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:03:17,266 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:03:17,268 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:03:17,269 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:03:17,270 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:03:17,271 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:03:17,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:03:18,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:03:29,229 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:03:29,231 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:03:29,233 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:03:29,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:03:32,555 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:03:32,557 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:03:32,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:03:35,755 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:03:35,758 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:03:35,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:03:36,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:03:36,295 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:03:36,297 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:03:47,423 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:03:47,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:03:48,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:03:48,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:20,694 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:24,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:29,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:33,587 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:04:33,589 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:04:33,590 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:34,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:04:34,281 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:04:34,283 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:04:34,312 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:04:37,474 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:04:37,477 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:38,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:04:38,192 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:04:41,236 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 98
2025-11-17 10:04:41,237 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:42,299 - ispa_next.main - DEBUG - 



2025-11-17 10:04:42,299 - ispa_next.main - DEBUG - starting with process 4 (ROF-NR 1) of 15
2025-11-17 10:04:42,304 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:04:43,709 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:04:45,021 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:04:45,022 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 98
2025-11-17 10:04:46,479 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:04:46,480 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:21,731 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:05:31,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:31,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:31,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:32,832 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:05:32,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:32,900 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:05:33,118 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:05:33,122 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:05:35,822 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:35,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:37,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:39,196 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:05:39,303 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:05:42,575 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:05:42,636 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:05:42,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:43,977 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:05:55,506 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:05:56,513 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:05:56,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:57,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:08,479 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:06:08,480 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:06:16,498 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:06:16,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:16,612 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:16,613 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:06:16,671 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:06:18,043 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:06:18,273 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:06:22,713 - ispa_next.functions - DEBUG - Updated appointment (AB00024157) customer contact data.
2025-11-17 10:06:23,636 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:06:23,638 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:06:24,274 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:06:24,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:06:24,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:06:28,553 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:06:28,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:29,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:31,072 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:06:31,264 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:06:31,363 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:06:31,426 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:06:31,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:32,636 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:06:44,066 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:06:51,010 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:06:51,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:52,299 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:06:56,521 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:06:57,537 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:06:57,538 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:06:57,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:57,610 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:07:01,771 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:07:01,777 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:07:01,777 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:07:01,778 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:07:03,134 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:07:03,136 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:07:04,105 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:07:04,109 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:04,111 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:07:04,112 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:04,114 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:07:04,121 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:07:04,130 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:07:04,134 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:07:04,136 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:07:04,139 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:07:04,143 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:07:04,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:07:05,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:07:16,666 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:07:16,669 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:07:16,671 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:07:16,672 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:18,626 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:07:18,628 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:07:18,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:20,500 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:07:20,502 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:07:20,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:07:20,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:07:21,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:30,363 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:07:30,365 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:07:42,031 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:07:42,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:43,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:07:43,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:03,247 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:07,869 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:08:07,871 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:08:07,872 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:08,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:08:08,415 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:08:08,417 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:08:08,442 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:08:11,093 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:08:11,097 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:12,320 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 169
2025-11-17 10:08:12,322 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:15,143 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-17 10:08:15,144 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:15,913 - ispa_next.main - DEBUG - 



2025-11-17 10:08:15,913 - ispa_next.main - DEBUG - starting with process 5 (SM-J 9876 E) of 15
2025-11-17 10:08:15,919 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:16,714 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:17,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 169
2025-11-17 10:08:17,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-17 10:08:19,219 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:19,220 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:09:01,160 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:09:11,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:15,893 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:09:15,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:15,986 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:16,261 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:09:16,264 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:09:19,231 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:09:19,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:20,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:22,424 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:09:22,558 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:09:22,647 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:09:22,762 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:09:22,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:27,653 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:09:38,612 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:09:45,738 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:09:45,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:50,556 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:09:54,772 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:09:55,778 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:09:55,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:56,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:09,762 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:10:17,332 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:10:17,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:17,414 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:17,415 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:10:17,464 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:10:18,758 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:10:19,037 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:10:22,451 - ispa_next.functions - DEBUG - Updated appointment (AA00026206) customer contact data.
2025-11-17 10:10:23,365 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:10:23,367 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:10:24,337 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:10:24,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:10:25,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:10:28,831 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:28,831 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:10:28,835 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:10:28,836 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:10:28,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:29,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:33,456 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:10:33,461 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:10:33,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:33,565 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:10:43,044 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 10:10:50,288 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 10:10:50,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:51,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:51,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:51,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:51,761 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:10:55,970 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:10:55,971 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:10:56,983 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:10:56,984 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:10:56,985 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart), Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:10:56,988 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:10:56,991 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:10:56,994 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:10:56,998 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:10:57,001 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:10:57,003 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:10:57,004 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:10:57,005 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:10:57,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:10:58,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:11:31,564 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-17 10:11:31,718 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:11:31,719 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:11:32,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:11:33,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:11:33,662 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:11:33,697 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:11:37,116 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:11:37,119 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:11:37,650 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 168
2025-11-17 10:11:37,651 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:11:40,866 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-17 10:11:40,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:11:41,757 - ispa_next.main - DEBUG - 



2025-11-17 10:11:41,757 - ispa_next.main - DEBUG - starting with process 6 (HEF-DK 975) of 15
2025-11-17 10:11:41,762 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:11:43,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:11:44,580 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 168
2025-11-17 10:11:44,581 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-17 10:11:46,563 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:11:46,565 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:12:13,899 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:12:23,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:24,771 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:12:24,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:24,842 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:12:25,077 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:12:25,079 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:12:27,800 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:12:27,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:12:28,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:12:30,923 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:12:31,020 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:12:34,223 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:12:34,314 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:12:34,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:35,543 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:12:47,029 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:12:48,034 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:12:48,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:12:48,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:00,178 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:13:08,034 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:13:08,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:08,129 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:13:08,130 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:13:08,170 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:13:08,273 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:13:09,547 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:13:09,872 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:13:12,995 - ispa_next.functions - DEBUG - Updated appointment (AA00026205) customer contact data.
2025-11-17 10:13:13,914 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:13:13,917 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:13:14,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:13:14,868 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:13:16,225 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:13:16,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:13:16,319 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:13:20,352 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:13:20,352 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:13:20,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:20,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:22,855 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:13:22,990 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:13:23,094 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:13:23,161 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:13:23,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:25,140 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:36,015 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:13:43,566 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:13:43,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:45,589 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:13:49,842 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:13:50,867 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:13:50,868 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:13:50,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:50,971 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:13:55,079 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:13:55,083 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:13:55,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:55,188 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:14:04,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:05,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:05,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:06,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:06,128 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:14:08,002 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:14:08,004 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:14:09,066 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:14:09,067 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:14:09,069 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:14:09,071 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:14:09,072 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:14:09,073 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:14:09,074 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:14:09,075 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:14:09,076 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:14:09,087 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:14:09,096 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:14:09,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:14:10,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:14:22,098 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:14:22,101 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:14:22,103 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:14:22,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:24,701 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:14:24,703 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:14:24,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:27,333 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:14:27,335 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:14:27,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:14:27,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:14:28,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:37,346 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:14:37,348 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:14:50,027 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:14:50,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:14:51,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:14:51,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:16,361 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:15:20,227 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:15:25,386 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:15:25,388 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:15:25,390 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:26,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:15:26,673 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:15:26,676 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:15:26,702 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:15:29,987 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:15:29,991 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:30,561 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 168
2025-11-17 10:15:30,562 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:34,223 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 97
2025-11-17 10:15:34,224 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:15:35,215 - ispa_next.main - DEBUG - 



2025-11-17 10:15:35,215 - ispa_next.main - DEBUG - starting with process 7 (WAK-UA 777) of 15
2025-11-17 10:15:35,220 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:15:36,177 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:15:37,439 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 168
2025-11-17 10:15:37,441 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 97
2025-11-17 10:15:39,091 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:15:39,092 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:16:10,929 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:16:20,097 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:24,173 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:16:24,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:24,258 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:16:24,597 - ispa_next.functions - DEBUG - HU date already expired after 4 days.
2025-11-17 10:16:31,847 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:16:31,850 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:16:34,580 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:16:34,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:35,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:37,567 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:16:37,669 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:16:37,794 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:16:37,858 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:16:37,860 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:41,905 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:53,298 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:16:54,312 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:16:54,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:54,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:07,134 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:17:15,443 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:17:15,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:17:15,545 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:17:15,546 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:17:15,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:17:15,703 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:17:17,086 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:17:17,403 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:17:19,154 - ispa_next.functions - DEBUG - Updated appointment (AG00006941) customer contact data.
2025-11-17 10:17:20,130 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:17:20,132 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:17:20,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:17:21,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:17:23,027 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:17:23,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:17:23,104 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:17:26,734 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:17:26,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:17:27,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:17:29,251 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:17:29,411 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:17:29,537 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:17:29,641 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:17:29,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:34,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:17:45,883 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:18:45,885 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:18:57,673 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:19:11,677 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:19:22,968 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 10:19:30,683 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 10:19:31,690 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:19:31,691 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:19:31,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:31,784 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:19:35,960 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:19:35,965 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:19:35,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:36,060 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:19:36,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:37,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:37,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:37,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:37,967 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:19:42,158 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:19:42,159 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:19:43,226 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:19:43,227 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:19:43,229 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:19:43,232 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:19:43,237 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:19:43,240 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:19:43,242 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:19:43,246 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:19:43,248 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:19:43,253 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:19:43,255 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:19:44,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:19:44,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:19:56,751 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:19:56,754 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:19:56,756 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:19:56,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:02,147 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:20:02,148 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:20:02,151 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:07,484 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:20:07,486 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:20:07,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:20:07,962 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:20:08,000 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:20:08,002 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:20:20,189 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:20:20,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:20:21,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:20:21,281 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:13,482 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:17,836 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:21,600 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:25,542 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:30,029 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:33,635 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:38,013 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:21:38,015 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:21:38,016 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:38,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:38,573 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:21:38,575 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:21:38,602 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:21:41,688 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:21:41,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:21:42,121 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 10:21:42,123 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:21:45,628 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 100
2025-11-17 10:21:45,628 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:21:46,346 - ispa_next.appointments.models - DEBUG - Appointment   WBA3D31000F304182 ohne Termin.
2025-11-17 10:21:46,355 - ispa_next.appointments.models - DEBUG - Appointment Stefan Höll  WBAJG11060ED61692 ohne Termin.
2025-11-17 10:21:46,365 - ispa_next.main - DEBUG - 



2025-11-17 10:21:46,365 - ispa_next.main - DEBUG - starting with process 8 (HEF-XD 11) of 15
2025-11-17 10:21:46,370 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:47,408 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:21:48,369 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 10:21:48,370 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 100
2025-11-17 10:21:50,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:21:50,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:30,332 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:22:40,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:22:42,275 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:22:42,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:22:42,385 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:22:42,610 - ispa_next.functions - DEBUG - HU date soon to be invalid in 36 days.
2025-11-17 10:22:49,169 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:22:49,172 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:22:51,852 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:22:51,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:22:53,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:22:55,163 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:23:00,344 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:23:06,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:23:07,547 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:23:07,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:08,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:19,731 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:23:19,731 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:23:26,574 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:23:26,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:26,665 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:23:26,666 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:23:26,704 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:23:26,862 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:23:28,205 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:23:28,498 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:23:30,386 - ispa_next.functions - DEBUG - Updated appointment (AG00006940) customer contact data.
2025-11-17 10:23:31,360 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:23:31,363 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:23:31,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:23:32,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:23:34,253 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:23:34,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:23:34,368 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:23:38,403 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:23:38,403 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:23:38,403 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:23:38,405 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:23:38,406 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:23:38,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:38,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:43,105 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:23:43,110 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:23:43,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:43,229 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:23:43,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:44,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:23:44,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:23:44,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:23:44,784 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:23:47,312 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:23:47,315 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:23:48,283 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:23:48,284 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:48,286 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:23:48,287 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:23:48,289 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:23:48,290 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:23:48,297 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:23:48,315 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:23:48,340 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:23:48,343 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:23:48,347 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:23:49,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:23:49,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:24:01,092 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:24:01,094 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:24:01,096 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:24:01,097 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:04,504 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:24:04,506 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:24:04,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:07,805 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:24:07,806 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:24:07,807 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:24:08,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:24:08,400 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:24:08,401 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:24:19,420 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:24:19,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:24:20,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:24:20,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:52,572 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:24:57,239 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:01,677 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:06,325 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:25:06,327 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:25:06,327 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:06,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:25:06,913 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:25:06,915 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:25:06,950 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:25:09,696 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:25:09,699 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:10,120 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:25:10,121 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:12,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 101
2025-11-17 10:25:12,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:13,963 - ispa_next.appointments.models - DEBUG - Appointment Marlies Dederer HEF-MD 547 WBA71BX0207T44740 ohne Termin.
2025-11-17 10:25:13,970 - ispa_next.appointments.models - DEBUG - Appointment   WBA3D31000F304182 ohne Termin.
2025-11-17 10:25:13,979 - ispa_next.main - DEBUG - Found new Appointment: KEIN KENNZEICHEN
2025-11-17 10:25:13,982 - ispa_next.main - DEBUG - 



2025-11-17 10:25:13,982 - ispa_next.main - DEBUG - starting with process 9 (KEIN KENNZEICHEN) of 16
2025-11-17 10:25:13,987 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:25:14,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:25:15,971 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:25:15,973 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 101
2025-11-17 10:25:17,496 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:25:17,498 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:25:57,892 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:26:08,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:14,402 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:26:14,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:14,489 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:26:14,687 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:26:14,690 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:26:17,456 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:26:17,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:18,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:26:20,627 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:26:20,739 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:26:20,864 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:26:20,947 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:26:23,071 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:26:24,079 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:26:24,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:24,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:37,345 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:26:44,747 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:26:44,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:26:44,832 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:26:44,833 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:26:44,875 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:26:44,967 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:26:46,131 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:26:46,393 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:26:50,847 - ispa_next.functions - DEBUG - Updated appointment (AA00026218) customer contact data.
2025-11-17 10:26:51,767 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:26:51,769 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:26:51,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:26:52,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:26:54,190 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:26:54,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:26:54,335 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:26:58,808 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:26:58,809 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:26:58,820 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:26:58,969 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:26:58,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:26:59,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:03,632 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:27:04,239 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:27:19,555 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:27:19,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:19,788 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:27:20,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:20,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:27:20,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:27:21,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:27:21,685 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:27:28,537 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:27:28,540 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:27:29,719 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:27:29,723 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:29,725 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:27:29,726 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:27:29,738 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:27:29,739 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:27:29,740 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:27:29,742 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:27:29,743 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:27:29,747 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:27:29,749 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:27:30,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:27:31,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:27:43,870 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:27:43,873 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:27:43,874 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:27:43,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:27:52,321 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:27:52,323 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:27:52,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:00,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:01,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:10,603 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:31,037 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:28:31,042 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:28:31,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:28:32,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:28:33,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:48,833 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:28:48,836 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:29:06,207 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:29:06,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:29:07,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:29:07,686 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:30,024 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:37,176 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:42,601 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:50,175 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:30:56,864 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:03,193 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:10,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:15,649 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:21,295 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:26,617 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:32,857 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:31:32,859 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:31:32,860 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:31:33,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:31:33,926 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:31:33,928 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:31:33,967 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:31:39,308 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:31:39,312 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:31:39,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:31:39,971 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:31:44,831 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 101
2025-11-17 10:31:44,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:31:46,149 - ispa_next.main - DEBUG - Found new Appointment: HEF-MD 547
2025-11-17 10:31:46,151 - ispa_next.main - DEBUG - 



2025-11-17 10:31:46,151 - ispa_next.main - DEBUG - starting with process 10 (HEF-MD 547) of 17
2025-11-17 10:31:46,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:31:47,741 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:31:49,391 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:31:49,393 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 101
2025-11-17 10:31:51,623 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:31:51,624 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:32:38,083 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:32:51,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:51,270 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:51,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:52,841 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:32:52,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:32:52,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:32:53,382 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:32:53,386 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:32:56,707 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:32:56,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:32:58,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:33:00,466 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:33:00,612 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:33:03,927 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:33:04,035 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:33:04,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:33:05,382 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:33:18,398 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:33:19,404 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:33:19,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:19,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:34,449 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:33:44,341 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:33:44,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:33:44,420 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:33:44,421 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:33:44,552 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:33:44,689 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:33:46,361 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:33:47,746 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:33:48,273 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:33:52,494 - ispa_next.functions - DEBUG - Updated appointment (AA00026220) customer contact data.
2025-11-17 10:33:53,412 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:33:53,415 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:33:54,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:33:55,698 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:33:58,173 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:33:58,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:33:58,645 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:34:02,350 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:34:02,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:02,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:34:04,869 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:34:05,030 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:34:05,235 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:34:05,357 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:34:05,358 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:07,942 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:34:19,409 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:34:27,942 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:34:27,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:30,026 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:34:34,258 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:34:35,269 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:34:35,270 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:34:35,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:34:35,460 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:34:39,661 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:34:39,668 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:34:39,668 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 10:34:39,669 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:34:41,735 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:34:41,737 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:34:42,942 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:34:42,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:34:42,946 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:34:42,948 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:34:42,951 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:34:42,954 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:34:42,957 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:34:42,958 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:34:42,960 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:34:42,961 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:34:42,964 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:34:43,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:34:44,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:34:56,805 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:34:56,808 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:34:56,811 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:34:56,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:34:59,541 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:34:59,544 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:34:59,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:02,286 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:35:02,288 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:35:02,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:35:03,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:35:03,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:15,154 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:35:15,157 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:35:31,683 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:35:32,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:35:33,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:35:33,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:01,527 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:07,385 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:13,437 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:36:13,439 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:36:13,440 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:36:14,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:36:14,576 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:36:14,579 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:36:14,608 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:36:19,752 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:36:19,756 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:36:20,543 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:36:20,544 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:36:25,970 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 101
2025-11-17 10:36:25,971 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:36:27,205 - ispa_next.main - DEBUG - 



2025-11-17 10:36:27,205 - ispa_next.main - DEBUG - starting with process 11 (HEF-XY 80) of 17
2025-11-17 10:36:27,209 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:36:28,802 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:36:31,183 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:36:31,185 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 101
2025-11-17 10:36:33,077 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:36:33,078 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:37:15,054 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:37:28,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:32,884 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:37:32,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:32,982 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:37:33,295 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:37:33,300 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:37:36,422 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:37:36,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:38,482 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:40,487 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:37:40,684 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:37:40,883 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:37:41,059 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:37:41,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:46,105 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:37:57,378 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:38:05,473 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:38:05,474 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:10,584 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:38:14,889 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:38:15,914 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:38:15,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:16,448 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:32,426 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:38:32,426 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:38:44,054 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:38:44,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:38:44,171 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:38:44,173 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:38:44,235 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:38:45,710 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:38:45,975 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:38:49,845 - ispa_next.functions - DEBUG - Updated appointment (AE00013897) customer contact data.
2025-11-17 10:38:50,757 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:38:50,777 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:38:53,027 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:38:53,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:38:54,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:38:57,908 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:38:57,909 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:38:57,913 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:38:57,915 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:38:57,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:38:58,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:02,722 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:39:03,992 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:39:18,008 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:39:18,009 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:18,111 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:39:22,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:22,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:39:22,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:23,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:39:23,867 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:39:28,397 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:39:28,399 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:39:29,822 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:39:29,824 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:39:29,825 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:39:29,827 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:39:29,828 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:39:29,830 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:39:29,831 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:39:29,832 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:39:29,833 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:39:29,835 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:39:29,837 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:39:30,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:39:31,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:39:43,999 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:39:44,001 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:39:44,002 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:39:44,030 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:49,456 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:39:49,458 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:39:49,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:55,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:39:55,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:40:06,317 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:40:06,319 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:40:06,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:40:07,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:40:08,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:40:20,493 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:40:20,495 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:40:38,610 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:40:39,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:40:39,881 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:40:40,108 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:34,813 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:41:43,458 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:41:49,694 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:41:56,991 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:04,047 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:10,294 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:17,420 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:42:17,423 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:42:17,424 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:18,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:42:18,442 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:42:18,444 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:42:18,470 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:42:23,484 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:42:23,488 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:24,141 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:42:24,143 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:42:29,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 101
2025-11-17 10:42:29,032 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:42:30,414 - ispa_next.main - DEBUG - 



2025-11-17 10:42:30,414 - ispa_next.main - DEBUG - starting with process 12 (HEF-SM 9) of 17
2025-11-17 10:42:30,419 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:42:32,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:42:34,465 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 10:42:34,467 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 101
2025-11-17 10:42:37,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:42:37,956 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:43:22,115 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:43:36,457 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:37,751 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:43:37,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:37,859 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:43:38,247 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:43:38,251 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:43:41,486 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:43:41,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:43,221 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:43:45,225 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:43:45,391 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:43:48,763 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:43:48,860 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:43:48,862 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:50,199 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:44:02,508 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:44:03,516 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:44:03,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:04,060 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:20,530 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:44:20,530 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:44:31,948 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:44:31,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:44:32,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:44:32,073 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:44:32,171 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:44:32,361 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:44:33,812 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:44:34,114 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:44:39,201 - ispa_next.functions - DEBUG - Updated appointment (AA00026192) customer contact data.
2025-11-17 10:44:40,180 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:44:40,191 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:44:40,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:44:42,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:44:44,743 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:44:44,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:44:44,842 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:44:48,844 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:44:48,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:44:49,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:44:51,358 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:44:51,524 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:44:51,664 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:44:51,801 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:44:51,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:53,825 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:45:05,848 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:46:05,851 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:46:17,154 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:46:25,183 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:46:25,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:27,261 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:46:31,568 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:46:32,578 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:46:32,580 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:46:32,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:32,720 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:46:36,905 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:46:36,913 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:46:36,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:37,017 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:46:41,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:41,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:41,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:46:42,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:46:42,777 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:46:44,781 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:46:44,787 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:46:46,065 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:46:46,068 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:46:46,072 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:46:46,073 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:46:46,075 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:46:46,076 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:46:46,077 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:46:46,078 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:46:46,080 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:46:46,081 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:46:46,083 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:46:46,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:46:47,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:47:01,333 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:47:01,336 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:47:01,339 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:47:01,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:04,082 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:47:04,084 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:47:04,087 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:06,866 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:47:06,869 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:47:06,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:47:07,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:47:08,069 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:23,276 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:47:23,278 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:47:39,131 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:47:39,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:47:40,482 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:47:40,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:48:08,542 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:15,053 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:22,207 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:48:22,210 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:48:22,212 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:23,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:48:23,436 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:48:23,438 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:48:23,475 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:48:29,767 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 10:48:29,771 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:30,611 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:48:30,613 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:35,768 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 101
2025-11-17 10:48:35,770 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:48:37,875 - ispa_next.main - DEBUG - 



2025-11-17 10:48:37,876 - ispa_next.main - DEBUG - starting with process 13 (HEF-TF 911) of 17
2025-11-17 10:48:37,881 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:48:39,924 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:48:42,078 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:48:42,080 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 101
2025-11-17 10:48:44,358 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:48:44,360 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:49:36,510 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:49:49,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:49,994 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:50,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:53,779 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:49:53,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:49:53,890 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:49:54,373 - ispa_next.functions - DEBUG - HU date already expired after 42 days.
2025-11-17 10:50:04,764 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:50:04,769 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:50:07,962 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:50:07,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:10,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:12,161 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:50:12,282 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:50:15,573 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:50:15,668 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:50:15,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:19,156 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:50:32,580 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:50:33,586 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:50:33,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:34,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:50,740 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:51:00,243 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:51:00,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:51:00,384 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:51:00,385 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:51:00,432 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:51:01,777 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:51:01,992 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:51:07,768 - ispa_next.functions - DEBUG - Updated appointment (AA00026182) customer contact data.
2025-11-17 10:51:08,750 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:51:08,752 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:51:10,417 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:51:10,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:51:11,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:51:15,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:51:15,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:51:16,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:51:18,022 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:51:18,241 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:51:18,460 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:51:18,584 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:51:18,586 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:22,131 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:51:35,003 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:52:35,004 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:52:46,391 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:52:54,501 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:52:54,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:52:58,139 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:53:02,401 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:53:03,410 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:53:03,411 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:53:03,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:03,558 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:07,745 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:53:07,749 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:53:07,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:07,884 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:53:16,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:17,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:17,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:18,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:18,203 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:53:21,461 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:53:21,465 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:53:23,232 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:53:23,233 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:23,236 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:53:23,237 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:53:23,239 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:53:23,240 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:53:23,242 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:53:23,244 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:53:23,245 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:53:23,246 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:53:23,255 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:53:24,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:53:25,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:53:38,234 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:53:38,238 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:53:38,239 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:53:38,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:42,446 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:53:42,448 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:53:42,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:46,541 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:53:46,543 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:53:46,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:53:47,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:53:47,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:56,164 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:53:56,166 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:54:10,803 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:54:11,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:54:12,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:54:12,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:48,238 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:54:54,432 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:55:02,061 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:55:09,006 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:55:09,009 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:55:09,010 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:55:10,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:55:10,227 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:55:10,229 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 10:55:10,257 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 10:55:15,578 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 10:55:15,582 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:55:16,336 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:55:16,339 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:55:22,207 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 101
2025-11-17 10:55:22,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:55:23,617 - ispa_next.main - DEBUG - 



2025-11-17 10:55:23,617 - ispa_next.main - DEBUG - starting with process 14 (HR-SH 246) of 17
2025-11-17 10:55:23,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:55:25,764 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:55:28,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 170
2025-11-17 10:55:28,006 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 101
2025-11-17 10:55:30,426 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:55:30,428 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:56:27,251 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:56:40,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:40,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:56:40,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:43,458 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:56:43,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:43,568 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:56:43,957 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:56:43,960 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:56:47,071 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:56:47,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:49,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:51,316 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:56:51,465 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:56:54,799 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:56:54,921 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:56:54,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:57,744 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:57:10,261 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:57:11,267 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:57:11,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:11,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:28,655 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:57:28,655 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 10:57:40,059 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:57:40,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:57:40,164 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:57:40,165 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:57:40,272 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:57:41,706 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:57:41,959 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:57:47,866 - ispa_next.functions - DEBUG - Updated appointment (AA00026165) customer contact data.
2025-11-17 10:57:48,811 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:57:48,834 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:57:50,441 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:57:50,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:57:51,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:57:55,494 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:57:55,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:56,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:57:58,086 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:57:58,270 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:57:58,438 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:57:58,548 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:57:58,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:01,309 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:58:12,872 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:58:20,978 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:58:20,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:23,734 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:58:27,994 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:58:29,002 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:58:29,003 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:58:29,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:29,147 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:58:33,336 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:58:33,340 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:58:33,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:33,455 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:58:39,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:40,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:58:40,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:58:41,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:58:41,308 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:58:43,924 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:58:43,926 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:58:45,706 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:58:45,708 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:58:45,710 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 10:58:45,722 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:58:45,727 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:58:45,729 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:58:45,730 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:58:45,733 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:58:45,736 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:58:45,738 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:58:45,742 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:58:46,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:58:47,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:59:01,271 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:59:01,273 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:59:01,291 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:59:01,292 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:04,777 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:59:04,779 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:59:04,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:08,268 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:59:08,270 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:59:08,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:59:09,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:59:09,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:59:21,946 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:59:21,949 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:59:40,533 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:59:41,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:59:41,989 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:59:42,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:00:24,880 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:00:31,187 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:00:39,771 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:00:46,955 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:00:46,958 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:00:46,959 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:00:48,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:00:48,333 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:00:48,335 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:00:48,364 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:00:53,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 11:00:53,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:00:54,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 11:00:54,452 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:00:59,407 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 102
2025-11-17 11:00:59,408 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:01:00,861 - ispa_next.appointments.models - DEBUG - Appointment Mirko Rehs HEF-SR 156 WBA71DY080FK93910 ohne Termin.
2025-11-17 11:01:00,878 - ispa_next.main - DEBUG - 



2025-11-17 11:01:00,878 - ispa_next.main - DEBUG - starting with process 15 (HEF-IB 999) of 17
2025-11-17 11:01:00,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:01:03,130 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:01:06,419 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 171
2025-11-17 11:01:06,421 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 102
2025-11-17 11:01:08,883 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:01:08,885 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:02:00,493 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:02:13,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:15,541 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:02:15,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:15,637 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:02:16,233 - ispa_next.functions - DEBUG - HU date soon to be invalid in 13 days.
2025-11-17 11:02:27,039 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:02:27,043 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:02:30,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:02:30,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:32,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:02:34,173 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:02:34,359 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:02:34,483 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:02:34,624 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:02:34,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:36,736 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:02:49,468 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:02:50,477 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:02:50,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:51,067 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:06,593 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:03:06,593 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:03:17,319 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:03:17,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:03:17,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:03:17,428 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:03:17,520 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:03:18,949 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:03:19,225 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:03:25,195 - ispa_next.functions - DEBUG - Updated appointment (AA00026150) customer contact data.
2025-11-17 11:03:26,185 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:03:26,201 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:03:27,451 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:03:27,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:03:29,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:03:33,489 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:03:33,490 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:03:33,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:03:34,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:03:36,078 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:03:36,252 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:03:36,542 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:03:36,673 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:03:36,676 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:38,824 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:03:50,671 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:03:58,868 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:03:58,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:01,063 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:04:05,366 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:04:06,376 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:04:06,377 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:04:06,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:06,538 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:04:10,741 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:04:10,747 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:04:10,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:10,851 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:04:15,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:15,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:04:15,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:04:16,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:04:16,750 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:04:18,757 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:04:18,760 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:04:20,168 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:04:20,170 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:20,171 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:04:20,173 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:04:20,174 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:04:20,175 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:04:20,176 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:04:20,180 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:04:20,183 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:04:20,188 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:04:20,195 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:04:20,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:04:22,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:04:35,791 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:04:35,794 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:04:35,796 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:04:35,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:38,620 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:04:38,623 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:04:38,629 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:41,482 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:04:41,484 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:04:41,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:04:42,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:04:43,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:53,681 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:04:53,684 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:05:09,411 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:05:09,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:10,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:05:10,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:05:39,576 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:45,286 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:52,839 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:05:52,842 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:05:52,843 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:53,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:05:54,023 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:05:54,025 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:05:54,059 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:06:00,051 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 11:06:00,059 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:06:00,978 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 11:06:00,980 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:06:06,414 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 102
2025-11-17 11:06:06,415 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:06:07,762 - ispa_next.appointments.models - DEBUG - Appointment Mirko Rehs HEF-SR 156 WBA71DY080FK93910 ohne Termin.
2025-11-17 11:06:07,778 - ispa_next.main - DEBUG - 



2025-11-17 11:06:07,778 - ispa_next.main - DEBUG - starting with process 16 (KEIN KENNZEICHEN) of 17
2025-11-17 11:06:07,783 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:06:09,405 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:06:11,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 172
2025-11-17 11:06:11,083 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 102
2025-11-17 11:06:13,225 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:06:13,226 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:07:01,926 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:07:16,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:16,300 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:16,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:17,853 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:07:17,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:17,975 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:07:18,510 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:07:18,515 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:07:21,707 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:07:21,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:24,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:26,033 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:07:26,214 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:07:29,591 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:07:40,847 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 11:07:41,854 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:07:41,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:42,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:00,859 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:08:12,228 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:08:12,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:08:12,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:08:12,403 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:08:12,469 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:08:12,705 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:08:15,010 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:08:15,259 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:08:20,672 - ispa_next.functions - DEBUG - Updated appointment (AA00026136) customer contact data.
2025-11-17 11:08:21,697 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:08:21,724 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:08:22,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:08:23,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:08:25,734 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:08:25,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:08:26,561 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:08:30,208 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:08:30,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:08:30,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:08:32,793 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:08:33,155 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:08:33,341 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:08:33,458 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:08:33,460 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:08:35,572 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:08:48,290 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:09:48,296 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:10:00,923 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:10:02,927 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:10:15,916 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:10:25,160 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:10:26,168 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:10:26,171 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:10:26,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:26,335 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:10:30,488 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:10:30,494 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:10:30,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:30,640 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:10:31,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:31,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:10:31,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:33,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:33,337 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:10:35,351 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:10:35,352 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:10:36,819 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:10:36,820 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:10:36,822 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:10:36,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:10:36,825 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:10:36,826 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:10:36,827 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:10:36,828 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:10:36,829 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:10:36,830 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:10:36,832 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:10:37,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:10:38,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:10:51,852 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:10:51,855 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:10:51,857 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:10:51,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:54,619 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:10:54,621 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:10:54,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:57,381 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:10:57,385 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:10:57,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:10:58,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:10:58,350 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:10:58,353 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:11:12,755 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:11:13,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:14,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:11:14,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:43,731 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:50,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:58,671 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:58,675 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:11:58,676 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:11:59,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:59,944 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:11:59,945 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:11:59,978 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:12:06,247 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 11:12:06,252 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:07,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 173
2025-11-17 11:12:07,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:13,841 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 11:12:13,842 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:15,246 - ispa_next.appointments.models - DEBUG - Appointment Jana Rothamel HEF-J 187 WMW21BR0X03M73243 ohne Termin.
2025-11-17 11:12:15,259 - ispa_next.main - DEBUG - 



2025-11-17 11:12:15,259 - ispa_next.main - DEBUG - starting with process 17 (WI-YS 134) of 17
2025-11-17 11:12:15,264 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:12:17,362 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:19,608 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 173
2025-11-17 11:12:19,611 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 11:12:22,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:22,192 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:13:07,241 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:13:23,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:30,588 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:13:30,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:30,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:31,215 - ispa_next.functions - DEBUG - HU date already expired after 26 days.
2025-11-17 11:13:42,166 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:13:42,170 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:13:45,230 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:13:45,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:13:47,217 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:13:49,223 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:13:49,421 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:13:49,569 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:13:49,727 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:13:49,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:57,293 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:14:09,768 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:14:10,773 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:14:10,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:11,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:27,956 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:14:39,620 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:14:39,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:39,768 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:14:39,769 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:14:39,844 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:14:40,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:14:42,673 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:14:42,931 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:14:47,371 - ispa_next.functions - DEBUG - Updated appointment (AA00026108) customer contact data.
2025-11-17 11:14:48,403 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:14:48,408 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:14:48,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:14:50,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:14:52,532 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:14:52,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:14:53,355 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:14:57,914 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:14:58,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:59,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:15:01,664 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:15:01,839 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:15:02,050 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:15:02,186 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:15:02,191 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:11,122 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:15:23,792 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:16:07,794 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:16:20,635 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:16:33,838 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:16:34,846 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:16:34,847 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:16:34,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:35,022 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:16:39,233 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:16:39,239 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:16:39,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:39,392 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:16:39,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:40,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:16:40,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:16:41,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:16:41,346 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:16:49,153 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:16:49,155 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:16:51,128 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:16:51,130 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:16:51,133 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:16:51,134 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:16:51,136 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:16:51,138 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:16:51,140 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:16:51,150 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:16:51,154 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:16:51,160 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:16:51,163 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:16:51,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:16:53,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:17:07,505 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:17:07,508 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:17:07,511 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:17:07,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:16,804 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:17:16,807 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:17:16,810 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:26,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:17:26,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:17:36,015 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:17:59,654 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:17:59,655 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:17:59,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:18:02,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:18:02,453 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:18:02,455 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:18:19,661 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:18:20,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:18:20,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:18:21,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:46,077 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:19:53,738 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:03,001 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:09,813 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:16,360 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:23,952 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:30,587 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:37,761 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:44,413 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:52,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:59,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:20:59,859 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:20:59,859 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:00,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:21:01,007 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:21:01,008 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:21:01,040 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:21:08,435 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 11:21:08,440 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:09,260 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 173
2025-11-17 11:21:09,262 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:14,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 11:21:14,413 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:21:15,878 - ispa_next.main - DEBUG - Found new Appointment: HEF-LK 676
2025-11-17 11:21:15,878 - ispa_next.main - DEBUG - Found new Appointment: HEF-J 187
2025-11-17 11:21:15,881 - ispa_next.main - DEBUG - 



2025-11-17 11:21:15,881 - ispa_next.main - DEBUG - starting with process 18 (HEF-LK 676) of 19
2025-11-17 11:21:15,887 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:21:18,130 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:21:20,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 173
2025-11-17 11:21:20,135 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 11:21:24,155 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:21:24,158 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:22:14,414 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:22:29,038 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:22:31,028 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:22:31,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:31,138 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:22:31,515 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:22:31,521 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:22:34,728 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:22:34,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:36,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:22:38,945 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:22:39,141 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:22:42,404 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:22:42,505 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:22:44,669 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:22:45,691 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:22:45,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:46,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:05,120 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:23:17,316 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:23:17,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:23:17,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:23:17,418 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:23:17,577 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:23:17,785 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:23:19,199 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:23:19,529 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:23:24,976 - ispa_next.functions - DEBUG - Updated appointment (AA00026227) customer contact data.
2025-11-17 11:23:25,941 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:23:25,948 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:23:27,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:23:29,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:23:30,851 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:23:30,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:23:31,833 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:23:36,512 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:23:36,513 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:23:36,712 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:23:36,838 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:23:37,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:37,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:23:42,136 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:23:43,417 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:23:59,434 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:23:59,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:23:59,559 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:24:03,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:04,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:24:04,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:24:05,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:24:05,408 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:24:08,722 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:24:08,724 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:24:10,438 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:24:10,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:10,442 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:24:10,443 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:24:10,445 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:24:10,447 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:24:10,448 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:24:10,450 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:24:10,458 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:24:10,461 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:24:10,467 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:24:11,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:24:12,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:24:26,501 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:24:26,505 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:24:26,507 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:24:26,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:30,623 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:24:35,820 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:24:35,895 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:24:35,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:40,619 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:24:40,622 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:24:40,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:24:41,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:24:42,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:24:59,125 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:24:59,128 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:25:18,185 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:25:18,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:19,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:25:20,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:25:42,385 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:25:42,386 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:25:43,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:25:43,605 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:25:43,607 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:25:43,644 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:25:50,174 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 11:25:50,179 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:25:51,004 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 174
2025-11-17 11:25:51,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:25:57,249 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 11:25:57,250 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:25:58,582 - ispa_next.main - DEBUG - 



2025-11-17 11:25:58,582 - ispa_next.main - DEBUG - starting with process 19 (HEF-J 187) of 19
2025-11-17 11:25:58,586 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:26:00,758 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:26:02,776 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 174
2025-11-17 11:26:02,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 103
2025-11-17 11:26:04,965 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:26:04,966 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:27:00,818 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:27:15,135 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:17,954 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:27:17,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:18,038 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:27:18,456 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:27:18,459 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:27:21,617 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:27:21,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:23,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:27:25,956 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:27:26,140 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:27:29,406 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:27:29,535 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:27:29,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:32,389 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:27:45,129 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:27:46,135 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:27:46,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:46,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:05,955 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:28:17,521 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:28:17,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:17,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:28:17,633 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 11:28:17,690 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 11:28:19,128 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 11:28:20,446 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 11:28:20,694 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 11:28:26,838 - ispa_next.functions - DEBUG - Updated appointment (AA00026226) customer contact data.
2025-11-17 11:28:27,826 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:28:27,829 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:28:29,161 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:28:29,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:28:30,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:28:34,293 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:28:34,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:28:34,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:28:36,802 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:28:36,995 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:28:37,198 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:28:37,323 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:28:37,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:40,101 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:28:52,424 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:29:52,427 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:30:05,015 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 11:30:12,640 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:30:12,643 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:15,512 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:30:19,793 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:30:20,801 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:30:20,802 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:30:20,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:20,948 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:30:25,166 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:30:26,454 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:30:39,022 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:30:39,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:39,167 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:30:43,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:44,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:44,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:45,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:30:45,045 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:30:47,753 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:30:47,755 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:30:49,497 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:30:49,499 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:30:49,501 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE KOSTENFREI, source=from_tab, target=cart)}
2025-11-17 11:30:49,503 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:30:49,504 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:30:49,506 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 11:30:49,508 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:30:49,515 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:30:49,518 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:30:49,524 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:30:49,527 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:30:50,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:30:51,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:31:05,310 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:31:05,313 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:31:05,316 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:31:05,317 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:08,728 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:31:08,730 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:31:08,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:12,202 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:31:12,205 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:31:12,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:31:13,373 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:31:13,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:22,121 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:31:22,124 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:31:40,750 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:31:41,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:31:42,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:31:42,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:16,590 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:22,726 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:30,522 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:37,973 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:37,976 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:32:37,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:32:39,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:32:39,211 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:32:39,213 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 11:32:39,251 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:32:45,372 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 11:32:45,377 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:32:46,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 174
2025-11-17 11:32:46,241 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:32:51,272 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 103
2025-11-17 11:32:51,273 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
