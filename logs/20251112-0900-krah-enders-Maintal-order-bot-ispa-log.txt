2025-11-12 09:00:35,034 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:00:35,041 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:00:46,884 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:00:58,581 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:01:13,946 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:03:11,704 - ispa_next.app_start.main - DEBUG - Operation already took 106.42 seconds (more than 80 seconds)
2025-11-12 09:03:13,783 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\d5b28ca8096624e0\\tess_aw4djik7_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\d5b28ca8096624e0\\tess_aw4djik7', 'txt']
2025-11-12 09:03:14,040 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:03:14,047 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:03:14,047 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:05:12,735 - ispa_next.app_start.main - DEBUG - Operation already took 106.39 seconds (more than 80 seconds)
2025-11-12 09:05:14,814 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\d5b28ca8096624e0\\tess_gjn9sxcq_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\d5b28ca8096624e0\\tess_gjn9sxcq', 'txt']
2025-11-12 09:05:15,063 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 09:05:15,071 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 09:05:21,510 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 09:05:30,152 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:05:40,465 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:05:55,915 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:06:28,162 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:06:39,227 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:06:41,705 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:06:42,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:06:42,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 09:06:45,154 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 163
2025-11-12 09:06:45,154 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:06:45,155 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:06:46,387 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:06:47,644 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:04,885 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:07:04,895 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:07:04,945 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-12 09:07:04,977 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-12 09:07:04,991 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-12 09:07:04,999 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-12 09:07:05,005 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-12 09:07:05,013 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-12 09:07:05,020 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-12 09:07:05,027 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-12 09:07:05,068 - ispa_next.main - DEBUG - Found 15 out of 141 appointments to process (configured limit: 15).
2025-11-12 09:07:05,069 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 09:07:05,069 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 09:07:05,069 - ispa_next.main - DEBUG - All appointments: F-BF 400, MKK-AM 806, OF Z 6061, BÜD XP 42, FCG1203, HEF-TT 369, M-FB 6992, FB-RM 411, HU-SU 2014, HU-AS 262, F-CA 525, HN FL 983, HU LJ 3118, HG-PL 4219, GN-A 713
2025-11-12 09:07:05,072 - ispa_next.main - DEBUG - 



2025-11-12 09:07:05,072 - ispa_next.main - DEBUG - starting with process 1 (F-BF 400) of 15
2025-11-12 09:07:05,077 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:07:05,818 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:07:06,617 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:07:06,619 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 163
2025-11-12 09:07:07,685 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:07:07,686 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:07:43,077 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:07:46,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:07:48,069 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:07:48,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:07:48,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:07:48,322 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:07:48,324 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:07:48,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:07:48,387 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:07:51,350 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:07:51,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:07:52,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:07:54,395 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:07:54,532 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:07:54,602 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:07:54,667 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:07:58,823 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:07:59,829 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:07:59,833 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:07:59,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:00,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:00,335 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:08:00,380 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:08:01,539 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:08:02,672 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:08:02,927 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:08:06,757 - ispa_next.functions - DEBUG - Updated appointment (AD00021115) customer contact data.
2025-11-12 09:08:07,695 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:08:07,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:07,806 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:08:08,011 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:08:08,012 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:08:08,863 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:08:08,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:08:09,664 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:08:13,762 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:08:13,762 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:08:13,762 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:08:13,766 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:08:13,766 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:08:13,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:08:14,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:08:18,510 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:08:19,333 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:08:30,805 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:08:30,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:08:30,937 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:08:31,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:31,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:08:31,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:08:32,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:08:32,712 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:08:34,589 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:08:34,591 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:08:35,940 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:08:35,942 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:08:35,943 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:08:35,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:08:35,946 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:08:35,948 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:08:35,949 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:08:35,951 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:08:35,952 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:08:35,953 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:08:35,962 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:08:35,966 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:08:35,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:08:37,931 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:08:42,179 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:08:42,183 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:08:42,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:08:44,253 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:08:44,256 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:08:44,259 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:08:44,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:08:46,176 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:08:46,178 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:08:47,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:08:48,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:08:48,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:09:08,048 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:16,034 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:16,038 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:09:16,038 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:09:16,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:09:16,965 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:09:16,967 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:09:19,715 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:09:32,071 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:09:32,442 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:09:34,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:09:35,030 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:09:35,030 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:09:38,589 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 09:09:38,594 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:09:39,541 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 09:09:39,547 - ispa_next.main - DEBUG - 



2025-11-12 09:09:39,547 - ispa_next.main - DEBUG - starting with process 2 (MKK-AM 806) of 15
2025-11-12 09:09:39,551 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:09:40,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:09:42,043 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:09:42,044 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 09:09:43,774 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:09:43,776 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:10:20,318 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:10:20,398 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:10:20,404 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:21,041 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:10:21,041 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:10:24,354 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 09:10:24,355 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:10:25,335 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 09:10:25,341 - ispa_next.main - DEBUG - 



2025-11-12 09:10:25,341 - ispa_next.main - DEBUG - starting with process 3 (OF Z 6061) of 15
2025-11-12 09:10:25,345 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:10:26,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:27,994 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:10:27,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 09:10:29,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:10:29,801 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:05,555 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:11:05,566 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:11:05,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:11:06,384 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:11:06,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:11:10,542 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 09:11:10,543 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:11,873 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 09:11:11,879 - ispa_next.main - DEBUG - 



2025-11-12 09:11:11,880 - ispa_next.main - DEBUG - starting with process 4 (BÜD XP 42) of 15
2025-11-12 09:11:11,884 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:11:13,732 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:11:15,642 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:11:15,643 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 09:11:17,786 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:11:17,788 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:55,496 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:11:55,507 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:11:55,511 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:11:56,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:11:56,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:11:59,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 09:11:59,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:12:00,966 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 09:12:00,972 - ispa_next.main - DEBUG - 



2025-11-12 09:12:00,973 - ispa_next.main - DEBUG - starting with process 5 (FCG1203) of 15
2025-11-12 09:12:00,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:12:02,760 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:12:04,640 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:12:04,641 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 09:12:06,570 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:12:06,572 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:12:41,892 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:12:41,904 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:12:41,908 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:12:42,612 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:12:42,612 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:12:46,594 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 203
2025-11-12 09:12:46,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:12:47,798 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Bilal HU-B 9096 WBAPG11000E582745 ohne Termin.
2025-11-12 09:12:47,804 - ispa_next.main - DEBUG - 



2025-11-12 09:12:47,804 - ispa_next.main - DEBUG - starting with process 6 (HEF-TT 369) of 15
2025-11-12 09:12:47,809 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:12:49,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:12:51,147 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 693
2025-11-12 09:12:51,148 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 203
2025-11-12 09:12:52,964 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:12:52,965 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:13:23,920 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:13:27,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:32,173 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:13:32,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:32,266 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:13:32,645 - ispa_next.functions - DEBUG - HU date already expired after 747 days.
2025-11-12 09:13:38,239 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:13:38,243 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:13:38,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:38,337 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:13:47,168 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:13:47,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:13:48,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:13:50,400 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:13:50,559 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:13:50,702 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:13:50,836 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:13:55,070 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:13:56,076 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:13:56,096 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:13:56,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:56,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:13:56,732 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:13:56,795 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:13:58,098 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:13:59,949 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:14:00,234 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:14:02,259 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:14:02,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:02,366 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:14:02,625 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:14:02,629 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:14:03,903 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:14:03,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:14:04,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:14:08,921 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:14:08,921 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:14:08,933 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:14:08,935 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:14:08,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:14:09,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:14:13,664 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:14:13,669 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:14:13,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:14:13,778 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:14:14,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:14,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:14:14,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:14:15,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:14:15,508 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:14:19,764 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:14:19,768 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:14:21,164 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:14:21,165 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:14:21,167 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:14:21,168 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:14:21,170 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:14:21,175 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:14:21,182 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:14:21,186 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:14:21,190 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:14:21,192 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:14:21,198 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:14:21,202 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:14:21,203 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:25,982 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:14:29,067 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:14:29,091 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:14:29,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:33,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:14:34,040 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:14:46,881 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:14:46,885 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:14:46,887 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:14:46,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:51,722 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:14:51,724 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:14:52,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:14:53,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:14:53,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:15:33,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:39,708 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:45,631 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:51,245 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:57,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:15:57,260 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:15:57,261 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:15:58,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:15:58,336 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:15:58,339 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:16:01,218 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:16:12,668 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:16:13,064 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:16:15,293 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:15,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:16:16,000 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:20,435 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:16:20,436 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:21,645 - ispa_next.main - DEBUG - 



2025-11-12 09:16:21,645 - ispa_next.main - DEBUG - starting with process 7 (M-FB 6992) of 15
2025-11-12 09:16:21,650 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:16:23,428 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:25,251 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:16:25,253 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:16:27,187 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:27,188 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:17:06,339 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:17:10,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:12,670 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:17:12,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:12,775 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:13,134 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:17:18,714 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:17:18,718 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:17:18,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:18,809 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:22,194 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:17:22,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:23,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:25,642 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:17:25,800 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:17:25,966 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:17:26,066 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:17:26,067 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:28,780 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:17:37,807 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:17:38,812 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:17:38,816 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:17:38,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:39,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:39,370 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:17:39,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:17:39,600 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:17:40,771 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:17:42,034 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:17:42,394 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:17:44,265 - ispa_next.functions - DEBUG - Updated appointment (AZ00002280) customer contact data.
2025-11-12 09:17:45,192 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:17:45,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:17:45,380 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:17:45,655 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:17:45,658 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:17:45,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:17:46,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:17:48,047 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:17:48,049 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:17:48,151 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:17:52,228 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:17:52,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:52,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:17:54,786 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:17:54,926 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:17:55,093 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:17:55,210 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:17:55,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:57,977 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:18:07,151 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:19:07,154 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:19:16,039 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:20:07,042 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:20:15,883 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:20:21,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:20:22,400 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:20:22,401 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:20:22,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:22,520 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:20:26,661 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:20:26,667 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:20:26,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:26,776 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:20:32,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:33,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:33,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:33,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:20:33,739 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:20:36,198 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:20:36,200 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:20:37,397 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:20:37,398 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:20:37,399 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:20:37,400 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:20:37,402 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:20:37,403 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:20:37,403 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:20:37,405 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:20:37,406 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:20:37,408 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:20:37,410 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:20:37,414 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:20:37,414 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:40,011 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:20:40,013 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:20:40,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:42,719 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:20:42,722 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:20:42,724 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:20:42,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:45,602 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:20:45,605 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:20:46,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:20:47,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:20:47,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:21:13,608 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:18,659 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:23,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:23,701 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:21:23,702 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:24,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:21:24,772 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:21:24,774 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:21:27,578 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:21:39,373 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:21:39,750 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:21:40,235 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:42,471 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:21:42,473 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:47,071 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:21:47,073 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:48,303 - ispa_next.main - DEBUG - 



2025-11-12 09:21:48,303 - ispa_next.main - DEBUG - starting with process 8 (FB-RM 411) of 15
2025-11-12 09:21:48,309 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:50,154 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:51,855 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:21:51,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:21:53,971 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:53,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:35,232 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:22:38,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:22:41,903 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:22:41,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:41,976 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:42,318 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:22:42,322 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:22:42,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:42,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:45,797 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:22:45,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:22:47,159 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:22:49,164 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:22:49,290 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:22:49,438 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:22:49,566 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:22:53,833 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:22:54,841 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:22:54,848 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:22:54,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:55,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:55,432 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:22:55,495 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:22:56,876 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:22:58,226 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:22:58,446 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:23:00,622 - ispa_next.functions - DEBUG - Updated appointment (AA00029960) customer contact data.
2025-11-12 09:23:01,540 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:23:01,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:01,728 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:23:04,187 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:23:05,111 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:23:05,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:23:06,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:23:09,699 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:09,699 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:23:09,704 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:23:09,705 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:23:09,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:10,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:14,410 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:23:14,414 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:23:14,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:14,531 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:23:23,332 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 09:23:36,873 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:23:37,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:37,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:37,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:38,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:38,752 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:23:41,863 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:23:41,873 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:23:43,226 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:23:43,226 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:43,232 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:23:43,236 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:43,239 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:23:43,242 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:23:43,244 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:23:43,246 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:23:43,247 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:23:43,249 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:23:43,252 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:23:43,256 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:23:43,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:46,673 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:23:46,695 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:23:46,710 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:50,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:50,364 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:24:01,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:15,651 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:24:15,654 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:24:15,657 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:24:15,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:19,247 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:24:19,251 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:24:20,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:24:21,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:24:21,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:54,745 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:25:02,377 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:25:08,328 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:25:15,009 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:25:15,011 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:25:15,012 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:15,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:25:15,828 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:25:15,830 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:25:18,003 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:25:27,022 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:25:27,403 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:25:29,664 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:30,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:25:30,410 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:34,844 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:25:34,845 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:35,940 - ispa_next.main - DEBUG - 



2025-11-12 09:25:35,941 - ispa_next.main - DEBUG - starting with process 9 (HU-SU 2014) of 15
2025-11-12 09:25:35,947 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:37,260 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:38,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:25:38,631 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:25:40,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:40,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:20,603 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:26:23,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:27,243 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:26:27,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:27,331 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:26:27,648 - ispa_next.functions - DEBUG - HU date already expired after 16 days.
2025-11-12 09:26:32,391 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:26:32,393 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:26:32,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:32,490 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:26:40,000 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:26:40,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:41,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:26:43,483 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:26:43,632 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:26:43,778 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:26:43,879 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:26:48,049 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:26:49,055 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:26:49,061 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:26:49,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:49,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:49,639 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:26:49,755 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:26:49,908 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:26:51,287 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:26:51,502 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:26:53,570 - ispa_next.functions - DEBUG - Updated appointment (AT00004939) customer contact data.
2025-11-12 09:26:54,499 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:26:54,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:54,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:26:54,957 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:26:54,961 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:26:55,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:26:56,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:26:57,540 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:26:57,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:26:57,630 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:27:01,321 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:27:01,322 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:27:01,325 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:27:01,327 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:27:01,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:01,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:27:06,003 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:27:11,457 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:27:11,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:11,564 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:27:15,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:15,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:15,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:16,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:27:16,364 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:27:19,415 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:27:19,419 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:27:22,066 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:27:22,066 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:27:22,090 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:27:22,096 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:27:22,098 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:27:22,100 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:27:22,108 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:27:22,116 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:27:22,120 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:27:22,122 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:27:22,128 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:27:22,130 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:27:22,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:25,514 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:27:25,517 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:27:25,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:28,868 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:27:28,870 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:27:28,874 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:27:28,876 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:32,123 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:27:32,125 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:27:32,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:27:34,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:27:34,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:28:07,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:28:12,421 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:28:17,618 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:28:22,659 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:28:22,661 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:28:22,662 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:23,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:28:23,452 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:28:23,454 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:28:26,033 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:28:37,271 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:28:37,651 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:28:39,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:40,558 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:28:40,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:45,282 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:28:45,283 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:46,462 - ispa_next.main - DEBUG - 



2025-11-12 09:28:46,462 - ispa_next.main - DEBUG - starting with process 10 (HU-AS 262) of 15
2025-11-12 09:28:46,469 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:48,286 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:49,929 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:28:49,930 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:28:51,755 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:51,758 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:29,454 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:29:33,054 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:34,990 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:29:34,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:35,082 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:35,421 - ispa_next.functions - DEBUG - HU date already expired after 261 days.
2025-11-12 09:29:40,935 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:29:40,939 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:29:40,939 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:41,022 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:49,405 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:29:49,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:50,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:52,795 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:30:01,440 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 09:30:07,052 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 09:30:08,058 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:30:08,063 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:30:08,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:08,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:08,587 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:30:08,661 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:30:08,837 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:30:10,182 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:30:10,411 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:30:12,415 - ispa_next.functions - DEBUG - Updated appointment (AG00016916) customer contact data.
2025-11-12 09:30:13,325 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:30:13,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:13,528 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:30:13,758 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:30:13,760 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:30:13,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:30:14,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:30:16,207 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:30:16,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:30:16,305 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:30:20,371 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:30:20,371 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:30:20,371 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:30:20,375 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:30:20,377 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:30:20,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:20,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:25,126 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:30:25,132 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:30:25,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:25,256 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:30:25,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:26,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:26,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:27,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:27,233 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:30:29,149 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:30:29,151 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:30:30,534 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:30:30,536 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:30,542 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:30:30,544 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:30,546 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:30:30,549 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:30:30,552 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:30:30,553 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:30:30,554 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:30:30,555 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:30:30,559 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:30:30,561 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:30:30,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:32,503 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:30:35,053 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:30:35,055 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:30:35,067 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:37,125 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:30:37,129 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:30:37,131 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:30:37,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:39,044 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:30:39,047 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:30:39,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:30:40,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:30:40,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:00,536 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:06,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:06,701 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:31:06,701 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:07,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:31:07,769 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:31:07,771 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:31:10,385 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:31:20,911 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:31:21,306 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:31:21,696 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:23,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:31:23,802 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:28,300 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 201
2025-11-12 09:31:28,301 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:29,483 - ispa_next.main - DEBUG - 



2025-11-12 09:31:29,484 - ispa_next.main - DEBUG - starting with process 11 (F-CA 525) of 15
2025-11-12 09:31:29,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:30,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:32,307 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 694
2025-11-12 09:31:32,308 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 201
2025-11-12 09:31:34,109 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:34,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:10,531 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:32:14,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:16,143 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:32:16,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:16,248 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:16,588 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 09:32:21,555 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:32:21,558 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:32:21,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:21,653 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:24,935 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:32:24,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:32:26,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:32:28,504 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:32:28,642 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:32:28,826 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:32:28,974 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:32:28,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:30,968 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:32:39,854 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:32:40,861 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:32:40,868 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:32:40,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:41,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:41,421 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:32:41,468 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:32:41,634 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:32:42,759 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:32:43,013 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:32:45,051 - ispa_next.functions - DEBUG - Updated appointment (AV00003233) customer contact data.
2025-11-12 09:32:45,973 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:32:45,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:46,180 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:46,391 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:32:46,395 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:32:46,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:32:47,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:32:48,804 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:32:48,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:32:48,900 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:32:52,537 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:32:52,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:32:53,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:32:55,145 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:32:55,296 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:32:55,431 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:32:55,556 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:32:55,560 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:57,527 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:33:06,114 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:34:06,117 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:34:15,350 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:35:11,354 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:35:20,191 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:35:25,437 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:35:26,457 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:35:26,458 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:35:26,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:26,563 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:35:30,783 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:35:30,789 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:35:30,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:30,910 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:35:36,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:37,138 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:37,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:37,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:37,986 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:35:39,929 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:35:39,931 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:35:41,369 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:35:41,371 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:35:41,373 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:35:41,373 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:35:41,375 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:35:41,377 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:35:41,381 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:35:41,385 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:35:41,389 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:35:41,391 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:35:41,395 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:35:41,398 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:35:41,398 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:43,389 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:35:43,393 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:35:43,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:45,376 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:35:45,388 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:35:45,392 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:35:45,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:47,397 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:35:47,400 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:35:48,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:35:49,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:35:49,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:08,738 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:36:15,040 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:36:15,042 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:36:15,044 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:36:15,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:36:16,130 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:36:16,132 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:36:18,892 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:36:29,786 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:36:30,210 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:36:32,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:33,059 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:36:33,060 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:37,706 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:36:37,707 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:36:38,867 - ispa_next.appointments.models - DEBUG - Appointment Nadine Kirchner OF-NM 1715 WBA31DZ000FK63071 ohne Termin.
2025-11-12 09:36:38,884 - ispa_next.main - DEBUG - 



2025-11-12 09:36:38,884 - ispa_next.main - DEBUG - starting with process 12 (HN FL 983) of 15
2025-11-12 09:36:38,889 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:36:40,738 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:42,495 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:36:42,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:36:44,629 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:44,630 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:37:22,489 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:37:22,502 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:37:22,507 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:37:23,114 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:37:23,115 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:37:26,828 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:37:26,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:37:28,010 - ispa_next.appointments.models - DEBUG - Appointment Nadine Kirchner OF-NM 1715 WBA31DZ000FK63071 ohne Termin.
2025-11-12 09:37:28,022 - ispa_next.main - DEBUG - 



2025-11-12 09:37:28,022 - ispa_next.main - DEBUG - starting with process 13 (HU LJ 3118) of 15
2025-11-12 09:37:28,026 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:37:29,428 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:37:30,924 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:37:30,925 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:37:32,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:37:32,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:10,899 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:38:10,911 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:38:10,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:11,736 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:38:11,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:16,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:38:16,261 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:17,711 - ispa_next.appointments.models - DEBUG - Appointment Nadine Kirchner OF-NM 1715 WBA31DZ000FK63071 ohne Termin.
2025-11-12 09:38:17,723 - ispa_next.main - DEBUG - 



2025-11-12 09:38:17,723 - ispa_next.main - DEBUG - starting with process 14 (HG-PL 4219) of 15
2025-11-12 09:38:17,729 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:19,495 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:21,521 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:38:21,523 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:38:23,663 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:23,665 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:55,374 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:38:59,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:03,654 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:39:03,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:03,737 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:04,001 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:39:04,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:04,109 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:09,937 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:39:09,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:10,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:13,891 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:39:13,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:15,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:39:17,276 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:39:17,398 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:39:17,573 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:39:17,682 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:39:21,933 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:39:22,940 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:39:22,945 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:39:22,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:23,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:23,497 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:39:23,547 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:39:24,869 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:39:26,126 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:39:26,383 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:39:28,758 - ispa_next.functions - DEBUG - Updated appointment (AA00029929) customer contact data.
2025-11-12 09:39:29,724 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:39:29,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:29,931 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:39:30,180 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:39:30,182 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:39:31,467 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:39:31,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:39:32,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:39:36,159 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:39:36,159 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:39:36,163 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:39:36,163 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:39:36,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:36,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:39:40,871 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:39:46,463 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:39:46,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:46,557 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:39:50,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:50,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:39:50,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:39:51,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:39:51,397 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:39:55,751 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:39:55,755 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:39:57,079 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:39:57,081 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:39:57,083 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:39:57,084 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:39:57,088 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:39:57,090 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:39:57,092 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:39:57,094 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:39:57,095 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:39:57,110 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:39:57,116 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:39:57,119 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:39:57,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:01,904 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:40:01,907 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:40:01,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:06,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:06,716 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:40:15,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:31,182 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:40:31,185 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:40:31,188 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:40:31,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:35,959 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:40:35,961 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:40:36,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:40:37,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:40:37,966 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:25,112 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:32,294 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:38,040 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:43,971 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:50,352 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:56,167 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:41:56,170 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:41:56,172 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:41:57,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:41:57,281 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:41:57,284 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:42:00,056 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:42:12,217 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:42:12,613 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:42:15,011 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:42:15,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:42:15,967 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:42:20,636 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:42:20,637 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:42:21,894 - ispa_next.main - DEBUG - 



2025-11-12 09:42:21,894 - ispa_next.main - DEBUG - starting with process 15 (GN-A 713) of 15
2025-11-12 09:42:21,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:42:23,731 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:42:25,487 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:42:25,488 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 202
2025-11-12 09:42:27,308 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:42:27,310 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:42:58,830 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:43:02,671 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:06,001 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:43:06,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:06,120 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:06,439 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:43:06,442 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:43:06,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:06,548 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:10,048 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:43:10,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:11,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:43:13,499 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:43:13,624 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:43:13,797 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:43:13,937 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:43:18,524 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:43:19,531 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:43:19,537 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:43:19,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:20,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:20,041 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:43:20,121 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:43:20,268 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:43:21,497 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:43:21,718 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:43:23,825 - ispa_next.functions - DEBUG - Updated appointment (AB00028015) customer contact data.
2025-11-12 09:43:24,749 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:43:24,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:24,963 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:43:25,193 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 09:43:25,195 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:43:25,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:43:26,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:43:28,358 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:43:28,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:43:28,437 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:43:32,094 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:43:32,094 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:43:32,099 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:43:32,100 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:43:32,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:32,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:43:36,836 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:43:41,584 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:43:41,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:41,671 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:43:47,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:47,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:43:47,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:48,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:43:48,737 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:43:51,779 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:43:51,782 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:43:53,080 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:43:53,082 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:43:53,084 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:43:53,084 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:43:53,086 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:43:53,088 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:43:53,090 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:43:53,093 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:43:53,105 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:43:53,107 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:43:53,110 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:43:53,114 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:43:53,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:56,396 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:43:56,398 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:43:56,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:59,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:43:59,794 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:44:09,324 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:22,945 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:44:22,948 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:44:22,951 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:44:22,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:26,315 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:44:26,317 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:44:26,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:27,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:44:28,042 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:01,627 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:09,754 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:15,961 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:22,372 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:45:22,376 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:45:22,376 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:23,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:45:23,462 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:45:23,464 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:45:26,101 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:45:37,634 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:45:38,018 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 09:45:40,382 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:41,440 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 695
2025-11-12 09:45:41,442 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:46,262 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 202
2025-11-12 09:45:46,262 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
