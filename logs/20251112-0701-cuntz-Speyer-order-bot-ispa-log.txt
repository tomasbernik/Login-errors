2025-11-12 07:08:26,777 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:08:26,786 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:08:37,133 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:08:49,797 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:09:05,613 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:09:30,224 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:09:50,762 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:09:54,739 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:09:56,263 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:09:56,265 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:09:59,508 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 108
2025-11-12 07:09:59,509 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:09:59,510 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:10:00,897 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:10:02,332 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:10:23,341 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:10:23,356 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:10:23,386 - ispa_next.appointments.models - DEBUG - Appointment Michaela Sophie Lapschanski RP-RL 3000 WBAJP31020BT75745 ohne Termin.
2025-11-12 07:10:23,399 - ispa_next.appointments.models - DEBUG - Appointment Gamze Fatma Altiparmak HD-XX 918 WMWXR91010TP82490 ohne Termin.
2025-11-12 07:10:23,422 - ispa_next.appointments.models - DEBUG - Appointment Damian Dexler SP-DD 71 WBA2M510X0VF33341 ohne Termin.
2025-11-12 07:10:23,439 - ispa_next.appointments.models - DEBUG - Appointment DS Automobile  WBAVJ51020LP62546 ohne Termin.
2025-11-12 07:10:23,460 - ispa_next.appointments.models - DEBUG - Appointment Erich Simus SP-B 26 WBAJM71050G959849 ohne Termin.
2025-11-12 07:10:23,470 - ispa_next.appointments.models - DEBUG - Appointment Besnik Derguti HD-ND 220 5UXCR6C51KLK82954 ohne Termin.
2025-11-12 07:10:23,492 - ispa_next.appointments.models - DEBUG - Appointment Christine Zimmermann KA-E 1152 WBAUZ35060N035577 ohne Termin.
2025-11-12 07:10:23,509 - ispa_next.appointments.models - DEBUG - Appointment Christine Eichenlaub  WMW11DJ0002V69245 ohne Termin.
2025-11-12 07:10:23,522 - ispa_next.appointments.models - DEBUG - Appointment Schick Vermietung GmbH SP-SV 140 WBA11GW010CS52823 ohne Termin.
2025-11-12 07:10:23,542 - ispa_next.appointments.models - DEBUG - Appointment Nico Hellmann GER-NH 28 WBA7K310807F44939 ohne Termin.
2025-11-12 07:10:23,556 - ispa_next.appointments.models - DEBUG - Appointment Präg Günter GmbH MA-PR 705 WBS11ET0709V00834 ohne Termin.
2025-11-12 07:10:23,565 - ispa_next.appointments.models - DEBUG - Appointment Oliver Menrath RP-OM 55 WBADW51020E364111 ohne Termin.
2025-11-12 07:10:23,573 - ispa_next.appointments.models - DEBUG - Appointment Felix Dominik Hipper DÜW-FE 92 WBSKG91030E854306 ohne Termin.
2025-11-12 07:10:23,581 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Lindner HD-IL 1052 WBAUR31050VL42406 ohne Termin.
2025-11-12 07:10:23,590 - ispa_next.appointments.models - DEBUG - Appointment Martin Zitron SP-ZM 71 WBAUN71070VM20560 ohne Termin.
2025-11-12 07:10:23,597 - ispa_next.appointments.models - DEBUG - Appointment Michael Groel SP-MG 59 WBAVM91000VT71883 ohne Termin.
2025-11-12 07:10:23,614 - ispa_next.main - DEBUG - Found 15 out of 39 appointments to process (configured limit: 15).
2025-11-12 07:10:23,615 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 07:10:23,616 - ispa_next.main - DEBUG - Processing 12 already visited appointments (w/ RKR not callable).
2025-11-12 07:10:23,616 - ispa_next.main - DEBUG - All appointments: KA-HG 4600, RP-PL 200, LU II 63, SP-KB 435, RP-RS 400, DÜW-SK 256, HD-VM 262, RP-PL 400, HD-NW 271E, LU-GT 232, SP-BK 80, KA-S 9140, GER-HD 777, HD-MS 2002, SP-XR 30 E
2025-11-12 07:10:23,618 - ispa_next.main - DEBUG - 



2025-11-12 07:10:23,618 - ispa_next.main - DEBUG - starting with process 1 (KA-HG 4600) of 15
2025-11-12 07:10:23,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:10:24,906 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:10:26,377 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:10:26,379 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 108
2025-11-12 07:10:28,197 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:10:28,198 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:10:57,832 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:11:08,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:11:10,964 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:11:10,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:11:11,047 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:11:11,268 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:11:19,436 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:11:19,438 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:11:22,233 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:11:22,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:11:22,548 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 07:11:23,499 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 07:11:23,564 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:11:23,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:11:24,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:11:25,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:11:25,133 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:11:25,175 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:11:28,042 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:11:28,045 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:29,372 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:11:29,374 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:32,881 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:11:32,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:11:34,069 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:11:34,079 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:11:34,083 - ispa_next.main - DEBUG - 



2025-11-12 07:11:34,083 - ispa_next.main - DEBUG - starting with process 2 (RP-PL 200) of 15
2025-11-12 07:11:34,086 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:11:35,496 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:11:36,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:11:36,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:11:38,659 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:11:38,661 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:04,263 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:12:15,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:18,429 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:12:18,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:12:18,655 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:12:19,011 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:12:19,015 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:12:22,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:12:22,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:22,655 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 07:12:23,286 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 07:12:23,344 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:12:23,345 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:12:24,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:12:25,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:12:25,066 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:12:25,090 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:12:27,863 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:12:27,866 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:12:29,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:12:29,350 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:12:33,283 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:12:33,284 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:12:34,309 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:12:34,334 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:12:34,342 - ispa_next.main - DEBUG - 



2025-11-12 07:12:34,342 - ispa_next.main - DEBUG - starting with process 3 (LU II 63) of 15
2025-11-12 07:12:34,375 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:12:35,720 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:12:37,095 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:12:37,097 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:12:38,952 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:12:38,953 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:12,949 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:13:12,963 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:13:12,968 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:13,586 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:13:13,588 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:13:16,816 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:13:16,817 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:17,713 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:13:17,731 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:13:17,737 - ispa_next.main - DEBUG - 



2025-11-12 07:13:17,737 - ispa_next.main - DEBUG - starting with process 4 (SP-KB 435) of 15
2025-11-12 07:13:17,742 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:13:20,300 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:23,765 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1238
2025-11-12 07:13:23,767 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:13:25,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:13:25,654 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:54,551 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:13:56,766 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:14:02,311 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:14:04,309 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:14:04,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:04,457 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:04,805 - ispa_next.functions - DEBUG - HU date already expired after 289 days.
2025-11-12 07:14:09,441 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:14:09,444 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:14:12,273 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:14:12,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:14:13,465 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:14:15,469 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:14:15,616 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:14:15,780 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:14:15,880 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:14:15,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:14:17,893 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:14:27,242 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:14:28,247 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:14:28,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:28,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:40,870 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:14:45,487 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:14:45,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:45,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:45,620 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:14:45,687 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:14:47,478 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:14:48,133 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:14:49,793 - ispa_next.functions - DEBUG - Updated appointment (AA00040720) customer contact data.
2025-11-12 07:14:50,748 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:14:50,751 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:14:51,767 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:14:51,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:14:52,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:14:56,317 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:14:56,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:14:56,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:14:58,870 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:14:59,080 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:14:59,263 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:14:59,401 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:14:59,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:15:01,433 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:15:10,194 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:16:10,197 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:16:18,678 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:16:54,680 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:17:03,132 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:17:12,584 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:17:13,590 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:17:13,591 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:17:13,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:17:13,671 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:17:17,885 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:17:17,890 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:17:17,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:17:18,043 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:17:18,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:17:19,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:17:19,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:17:19,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:17:19,975 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:17:21,977 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:17:21,980 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:17:22,998 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:17:23,001 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:17:23,004 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:17:23,005 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:17:23,006 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:17:23,007 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:17:23,010 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:17:23,011 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:17:23,012 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:17:23,013 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:17:23,016 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:17:23,017 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:17:23,020 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:17:23,024 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:17:23,027 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:17:23,028 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:17:25,160 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:17:25,163 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:17:25,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:17:27,285 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:17:27,287 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:17:27,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:17:28,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:17:28,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:17:37,165 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:17:37,168 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:17:50,420 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:17:50,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:17:51,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:17:51,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:18:10,595 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:18:15,865 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:18:15,868 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:18:15,869 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:18:16,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:18:16,970 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:18:16,972 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:18:19,406 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:18:33,426 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:18:33,878 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:18:34,638 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:18:36,211 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:18:36,213 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:18:39,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:18:39,668 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:18:40,665 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:18:40,680 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:18:40,684 - ispa_next.main - DEBUG - 



2025-11-12 07:18:40,685 - ispa_next.main - DEBUG - starting with process 5 (RP-RS 400) of 15
2025-11-12 07:18:40,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:18:42,063 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:18:43,517 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:18:43,519 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:18:45,462 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:18:45,463 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:17,423 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:19:19,865 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:19:25,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:27,599 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:19:27,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:27,763 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:19:28,013 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:19:28,017 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:19:30,978 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:19:30,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:32,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:19:34,162 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:19:34,317 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:19:34,474 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:19:34,611 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:19:34,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:19:36,653 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:19:45,330 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:19:46,336 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:19:46,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:46,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:00,639 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:20:05,623 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:20:05,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:05,702 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:20:05,703 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:20:05,866 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:20:07,341 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:20:07,787 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:20:09,799 - ispa_next.functions - DEBUG - Updated appointment (AD00027363) customer contact data.
2025-11-12 07:20:10,748 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:20:10,780 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:20:11,705 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:20:11,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:20:12,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:20:16,189 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:20:16,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:16,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:20:18,699 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:20:18,866 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:20:19,020 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:20:19,100 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:20:19,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:21,202 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:20:32,998 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:20:37,786 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:20:37,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:39,800 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:20:44,035 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:20:45,042 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:20:45,043 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:20:45,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:45,163 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:20:49,350 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:20:49,356 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:20:49,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:49,467 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:20:55,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:55,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:20:55,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:56,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:20:56,291 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:20:58,299 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:20:58,301 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:20:59,491 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:20:59,492 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:20:59,495 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:20:59,496 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:20:59,498 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:20:59,499 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:20:59,502 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:20:59,503 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:20:59,505 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:20:59,506 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:20:59,508 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:20:59,509 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:20:59,512 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:20:59,516 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:20:59,518 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:20:59,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:01,698 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:21:01,700 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:21:01,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:03,756 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:21:03,758 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:21:03,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:21:04,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:21:05,246 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:16,002 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:21:16,005 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:21:29,309 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:21:29,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:21:30,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:21:30,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:49,638 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:21:55,339 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:21:55,342 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:21:55,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:21:56,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:21:56,264 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:21:56,266 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:21:58,764 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:22:09,298 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:22:09,678 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:22:10,418 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:13,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:22:13,297 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:16,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:22:16,801 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:17,788 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:22:17,803 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:22:17,808 - ispa_next.main - DEBUG - 



2025-11-12 07:22:17,808 - ispa_next.main - DEBUG - starting with process 6 (DÜW-SK 256) of 15
2025-11-12 07:22:17,812 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:19,212 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:20,637 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:22:20,639 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:22:22,359 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:22,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:54,786 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:22:57,315 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:23:02,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:06,968 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:23:06,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:07,083 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:07,372 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:23:07,375 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:23:10,375 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:23:10,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:11,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:23:13,784 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:23:13,967 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:23:14,161 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:23:14,256 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:23:14,258 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:18,495 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:23:27,052 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:23:28,057 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:23:28,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:28,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:41,168 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:23:46,530 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:23:46,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:46,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:46,750 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:23:46,835 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:23:48,275 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:23:48,732 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:23:50,873 - ispa_next.functions - DEBUG - Updated appointment (AD00027404) customer contact data.
2025-11-12 07:23:51,813 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:23:51,850 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:23:52,910 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:23:52,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:23:53,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:23:57,540 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:23:57,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:58,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:00,075 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:24:00,611 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:24:01,035 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:24:01,351 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:24:01,353 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:06,644 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:24:15,170 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:25:15,173 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:25:23,687 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:25:55,690 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:26:04,454 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:26:13,734 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:26:14,756 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:26:14,757 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:26:14,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:14,844 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:19,007 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:26:19,011 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:26:19,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:19,092 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:26:19,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:20,151 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:26:20,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:26:20,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:26:20,887 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:26:25,119 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:26:25,125 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:26:26,567 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:26:26,594 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:26,597 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:26:26,621 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:26:26,627 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:26:26,628 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:26:26,661 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:26:26,662 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:26:26,664 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:26:26,678 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:26:26,681 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:26:26,683 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:26:26,686 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:26:26,689 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:26:26,692 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:26:26,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:30,859 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:26:30,862 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:26:30,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:35,002 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:26:35,004 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:26:35,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:26:35,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:26:36,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:49,035 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:26:49,038 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:27:02,805 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:27:03,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:27:03,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:27:04,155 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:27:43,864 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:48,903 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:27:54,166 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:00,190 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:05,976 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:28:05,978 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:28:05,979 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:28:06,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:28:06,933 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:28:06,935 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:28:09,270 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:28:19,696 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:28:20,105 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:28:20,958 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:23,025 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:28:23,026 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:26,792 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:28:26,793 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:28:27,781 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:28:27,800 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:28:27,806 - ispa_next.main - DEBUG - 



2025-11-12 07:28:27,806 - ispa_next.main - DEBUG - starting with process 7 (HD-VM 262) of 15
2025-11-12 07:28:27,809 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:28:29,178 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:28:30,793 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:28:30,795 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:28:32,632 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:28:32,633 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:29:03,243 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:29:05,606 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:29:13,693 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:17,353 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:29:17,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:17,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:29:18,040 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:29:18,044 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:29:20,854 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:29:20,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:29:22,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:29:24,202 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:29:24,348 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:29:24,513 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:29:24,644 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:29:28,953 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:29:29,959 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:29:29,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:30,568 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:42,721 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:29:42,722 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:29:47,663 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:29:47,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:29:47,801 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:29:47,802 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:29:47,900 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:29:49,246 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:29:49,629 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:29:51,876 - ispa_next.functions - DEBUG - Updated appointment (AC00031313) customer contact data.
2025-11-12 07:29:55,474 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:29:55,477 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:29:57,667 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:29:57,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:29:59,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:30:02,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:30:02,944 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:30:02,947 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:30:02,948 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:30:02,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:03,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:07,665 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:30:07,669 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:30:07,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:07,826 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:30:08,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:08,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:30:08,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:30:09,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:30:09,483 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:30:12,175 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:30:12,178 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:30:13,259 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:30:13,262 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:30:13,265 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:30:13,268 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:30:13,271 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:30:13,273 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:30:13,279 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:30:13,283 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:30:13,285 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:30:13,286 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:30:13,289 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:30:13,290 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:30:13,293 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:30:13,296 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:30:13,298 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:30:13,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:16,021 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:30:16,023 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:30:16,026 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:18,731 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:30:18,733 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:30:18,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:30:19,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:30:20,030 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:29,357 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:30:29,360 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:30:42,937 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:30:43,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:30:43,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:30:44,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:10,084 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:15,450 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:20,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:31:20,882 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:31:20,883 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:31:21,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:31:21,841 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:31:21,848 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:31:24,201 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:31:35,205 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:31:35,605 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:31:36,434 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:31:39,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:31:39,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:31:42,996 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:31:42,997 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:31:43,963 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:31:43,981 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:31:43,987 - ispa_next.main - DEBUG - 



2025-11-12 07:31:43,987 - ispa_next.main - DEBUG - starting with process 8 (RP-PL 400) of 15
2025-11-12 07:31:43,992 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:31:45,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:31:46,972 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:31:46,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:31:48,914 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:31:48,915 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:32:20,771 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:32:23,754 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:32:29,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:32,927 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:32:32,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:33,076 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:32:33,441 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:32:38,238 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:32:38,241 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:32:41,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:32:41,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:42,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:32:44,617 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:32:44,775 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:32:44,881 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:32:44,981 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:32:44,982 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:48,568 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:32:57,266 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:32:58,270 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:32:58,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:58,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:09,042 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:33:14,076 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:33:14,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:33:14,259 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:33:14,260 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:33:14,334 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:33:15,844 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:33:17,200 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:33:17,541 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:33:19,500 - ispa_next.functions - DEBUG - Updated appointment (AD00027502) customer contact data.
2025-11-12 07:33:20,547 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:33:20,550 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:33:21,967 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:33:21,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:33:22,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:33:26,974 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:33:26,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:27,485 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:33:29,490 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:33:29,669 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:33:29,860 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:33:30,003 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:33:30,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:33,496 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:33:44,566 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:33:49,015 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:33:49,016 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:52,451 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:33:56,702 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:33:57,709 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:33:57,711 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:33:57,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:33:57,809 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:34:01,979 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:34:01,983 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:34:01,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:02,065 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:34:07,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:08,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:08,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:09,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:09,035 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:34:12,386 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:34:12,389 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:34:13,623 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:34:13,624 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:34:13,627 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:34:13,628 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:34:13,630 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:34:13,631 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:34:13,634 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:34:13,635 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:34:13,637 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:34:13,637 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:34:13,640 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:34:13,641 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:34:13,644 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:34:13,647 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:34:13,650 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:34:13,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:17,242 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:34:17,245 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:34:17,248 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:20,584 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:34:20,587 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:34:20,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:34:21,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:34:22,112 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:34,163 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:34:34,166 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:34:48,208 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:34:48,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:34:49,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:34:49,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:22,569 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:28,072 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:33,049 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:39,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:35:39,061 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:35:39,062 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:35:39,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:35:40,036 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:35:40,038 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:35:42,617 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:35:56,093 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:35:56,479 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:35:57,409 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:35:59,237 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:35:59,239 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:36:02,927 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:36:02,927 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:04,063 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:36:04,073 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:36:04,077 - ispa_next.main - DEBUG - 



2025-11-12 07:36:04,077 - ispa_next.main - DEBUG - starting with process 9 (HD-NW 271E) of 15
2025-11-12 07:36:04,081 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:36:05,490 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:36:07,058 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:36:07,060 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:36:09,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:36:09,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:36:38,926 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:36:41,593 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:36:50,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:54,577 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:36:54,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:36:54,693 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:36:54,940 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:36:54,943 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:36:58,209 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:36:58,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:36:59,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:01,532 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:37:01,722 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:37:01,850 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:37:01,973 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:37:01,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:05,471 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:37:14,140 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:37:15,146 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:37:15,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:15,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:28,044 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:37:33,022 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:37:33,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:37:33,218 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:37:33,219 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:37:33,300 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:37:34,846 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:37:35,268 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:37:37,085 - ispa_next.functions - DEBUG - Updated appointment (AC00031287) customer contact data.
2025-11-12 07:37:38,022 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:37:38,078 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:37:39,101 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:37:39,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:37:40,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:37:44,254 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:37:44,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:37:44,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:37:46,801 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:37:46,975 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:37:47,117 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:37:47,270 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:37:47,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:51,770 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:38:01,275 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:39:01,278 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:39:09,744 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:39:39,748 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:39:48,576 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 07:39:58,147 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 07:39:59,155 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:39:59,156 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:39:59,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:39:59,290 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:40:03,420 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:40:03,424 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:40:03,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:03,577 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:40:09,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:09,687 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:09,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:10,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:40:10,519 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:40:13,759 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:40:13,761 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:40:15,060 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:40:15,061 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:40:15,064 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:40:15,065 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:40:15,066 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:40:15,068 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:40:15,071 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:40:15,072 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:40:15,074 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:40:15,077 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:40:15,078 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:40:15,080 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:40:15,084 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:40:15,086 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:40:15,087 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:18,635 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:40:18,637 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:40:18,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:22,097 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:40:22,098 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:40:22,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:40:23,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:40:23,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:33,365 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:40:33,367 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:40:47,284 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:40:47,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:40:48,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:40:48,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:21,490 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:26,692 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:31,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:38,021 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:38,023 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:41:38,024 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:41:38,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:41:38,971 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:41:38,973 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:41:41,388 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:41:52,222 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:41:52,679 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:41:53,525 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:41:55,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:41:55,308 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:41:58,980 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:41:58,980 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:42:00,045 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:42:00,055 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:42:00,060 - ispa_next.main - DEBUG - 



2025-11-12 07:42:00,060 - ispa_next.main - DEBUG - starting with process 10 (LU-GT 232) of 15
2025-11-12 07:42:00,063 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:42:01,630 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:42:03,193 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:42:03,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:42:05,225 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:42:05,227 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:42:42,443 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:42:45,105 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:42:50,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:53,515 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:42:53,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:42:53,659 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:42:53,898 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:42:53,902 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:42:56,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:42:56,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:42:58,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:43:00,151 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:43:00,368 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:43:00,478 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:43:00,628 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:43:04,826 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:43:05,831 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:43:05,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:06,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:18,439 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:43:23,492 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:43:23,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:23,636 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:43:23,637 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:43:23,781 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:43:24,031 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:43:25,475 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 07:43:26,878 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 07:43:27,462 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:43:29,357 - ispa_next.functions - DEBUG - Updated appointment (AC00031321) customer contact data.
2025-11-12 07:43:30,363 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:43:30,365 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:43:30,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:43:31,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:43:33,008 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:43:33,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:43:33,104 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:43:36,763 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:43:36,763 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:43:36,766 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:43:36,767 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:43:36,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:43:37,273 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:43:41,547 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:43:41,569 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:43:41,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:43:41,722 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:43:42,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:43,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:43,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:43:44,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:43:44,179 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:43:46,995 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:43:46,998 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:43:48,577 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:43:48,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:43:48,604 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:43:48,606 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:43:48,608 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:43:48,609 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:43:48,612 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:43:48,613 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:43:48,614 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:43:48,615 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:43:48,618 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:43:48,619 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:43:48,622 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:43:48,625 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:43:48,627 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:43:48,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:51,500 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:43:51,501 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:43:51,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:54,319 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:43:54,321 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:43:54,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:43:55,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:43:55,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:01,784 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:44:01,786 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:44:16,400 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:44:16,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:44:17,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:44:17,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:43,837 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:44:49,524 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:44:55,442 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:44:55,445 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:44:55,445 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:44:56,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:44:56,397 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:44:56,399 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:44:58,960 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:45:10,721 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:45:11,148 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:45:12,053 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:45:13,948 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:45:13,949 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:45:17,821 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:45:17,822 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:45:18,794 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:45:18,806 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:45:18,810 - ispa_next.main - DEBUG - 



2025-11-12 07:45:18,810 - ispa_next.main - DEBUG - starting with process 11 (SP-BK 80) of 15
2025-11-12 07:45:18,813 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:45:20,184 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:45:21,792 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1239
2025-11-12 07:45:21,793 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:45:23,802 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:45:23,803 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:45:56,185 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:45:58,639 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:46:04,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:46:08,049 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:46:08,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:08,130 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:46:08,485 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:46:13,633 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:46:13,636 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:46:16,485 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:46:16,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:46:17,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:46:19,898 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:46:20,041 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:46:20,212 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:46:20,286 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:46:24,551 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:46:25,562 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:46:25,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:26,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:39,114 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:46:44,793 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:46:44,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:44,948 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:46:44,949 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:46:45,023 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:46:46,444 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:46:46,814 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:46:49,471 - ispa_next.functions - DEBUG - Updated appointment (AC00031338) customer contact data.
2025-11-12 07:46:50,427 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:46:50,431 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:46:51,569 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:46:51,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:46:52,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:46:56,814 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:46:56,815 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:46:56,818 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:46:56,818 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:46:56,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:46:57,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:01,521 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:47:01,525 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:47:01,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:01,635 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:47:07,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:07,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:47:07,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:47:08,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:47:08,554 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:47:11,723 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:47:11,731 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:47:12,896 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:47:12,898 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:47:12,902 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:47:12,905 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:47:12,908 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:47:12,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:47:12,920 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:47:12,924 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:47:12,927 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:47:12,928 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:47:12,931 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:47:12,932 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:47:12,935 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:47:12,938 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:47:12,941 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:47:12,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:16,503 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:47:16,505 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:47:16,506 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:20,032 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:47:20,034 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:47:20,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:47:21,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:47:21,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:33,712 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:47:33,715 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:47:48,277 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:47:48,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:47:49,356 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:47:49,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:48:22,687 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:28,171 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:36,256 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:42,860 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:42,862 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:48:42,863 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:48:43,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:48:43,818 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:48:43,820 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:48:46,346 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:48:57,133 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:48:57,535 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:48:58,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:49:00,457 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1240
2025-11-12 07:49:00,458 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:49:04,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 257
2025-11-12 07:49:04,472 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:49:05,568 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:49:05,583 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:49:05,590 - ispa_next.main - DEBUG - 



2025-11-12 07:49:05,590 - ispa_next.main - DEBUG - starting with process 12 (KA-S 9140) of 15
2025-11-12 07:49:05,594 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:49:07,080 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:49:08,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1240
2025-11-12 07:49:08,657 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 257
2025-11-12 07:49:10,758 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:49:10,760 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:49:45,296 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:49:48,136 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:49:53,901 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:57,390 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:49:57,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:57,469 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:49:57,884 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:50:03,035 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:50:03,038 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:50:05,842 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:50:05,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:07,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:09,194 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:50:09,320 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:50:09,467 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:50:09,598 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:50:09,600 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:13,129 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:50:21,988 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:50:22,992 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:50:22,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:23,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:27,891 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 07:50:27,896 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:50:27,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:28,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:28,027 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:50:28,085 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:50:29,474 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:50:29,825 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:50:31,879 - ispa_next.functions - DEBUG - Updated appointment (AD00027444) customer contact data.
2025-11-12 07:50:32,895 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:50:32,897 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:50:33,877 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:50:33,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:50:35,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:50:39,107 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:50:39,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:39,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:41,669 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:50:41,881 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:50:42,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:50:42,293 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:50:42,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:45,957 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:50:54,578 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:51:54,581 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:52:05,840 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:52:10,687 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:52:10,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:14,227 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:52:18,490 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:52:19,495 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:52:19,496 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:52:19,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:52:19,637 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:52:23,776 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:52:23,780 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:52:23,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:52:23,917 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:52:24,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:52:24,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:52:24,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:52:25,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:52:25,649 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:52:28,786 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:52:28,788 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:52:29,814 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:52:29,816 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:52:29,818 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:52:29,821 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:52:29,824 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:52:29,826 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:52:29,830 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:52:29,831 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 07:52:29,833 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:52:29,834 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:52:29,837 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:52:29,837 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:52:29,841 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:52:29,844 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:52:29,846 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:52:29,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:33,513 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:52:33,515 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:52:33,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:37,022 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:52:37,025 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:52:37,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:52:38,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:52:38,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:49,326 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:52:49,329 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:53:04,094 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:53:04,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:53:05,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:53:05,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:53:38,471 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:53:44,852 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:53:50,293 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:53:56,808 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:53:56,810 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:53:56,811 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:53:57,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:53:57,773 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:53:57,775 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:54:00,365 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:54:11,533 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:54:11,912 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:54:12,910 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:54:14,832 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 07:54:14,833 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:54:18,950 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 255
2025-11-12 07:54:18,951 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:54:20,041 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 07:54:20,058 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 07:54:20,064 - ispa_next.main - DEBUG - 



2025-11-12 07:54:20,064 - ispa_next.main - DEBUG - starting with process 13 (GER-HD 777) of 15
2025-11-12 07:54:20,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:54:21,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:54:23,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 07:54:23,166 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 255
2025-11-12 07:54:25,215 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:54:25,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:54:59,772 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:55:07,468 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:55:13,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:20,095 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:55:20,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:55:20,231 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:55:20,537 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:55:25,672 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:55:25,675 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:55:28,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:55:28,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:55:29,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:55:31,867 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:55:32,061 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:55:32,203 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:55:32,307 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:55:32,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:38,900 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:55:47,831 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:55:48,836 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:55:48,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:55:49,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:02,254 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:56:07,730 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:56:07,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:56:07,858 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:56:07,859 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:56:07,895 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:56:08,129 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:56:09,943 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 07:56:11,240 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 07:56:11,860 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:56:14,236 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:56:14,238 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:56:15,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:56:16,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:56:17,677 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:56:17,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:56:17,763 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:56:21,818 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:56:21,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:56:22,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:56:24,443 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:56:24,595 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:56:24,704 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:56:24,863 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:56:24,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:56:31,455 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:56:40,231 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:57:40,235 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:57:51,437 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:57:56,023 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:57:56,025 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:58:02,429 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:58:06,677 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:58:07,762 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:58:07,764 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 07:58:07,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:58:08,230 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:58:12,460 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 07:58:12,465 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:58:12,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:58:12,547 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:58:13,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:58:13,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:58:13,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:58:14,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:58:14,446 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:58:21,004 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:58:21,008 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:58:23,175 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:58:23,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:58:23,180 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 07:58:23,181 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 07:58:23,182 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:58:23,183 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:58:23,185 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:58:23,187 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:58:23,188 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:58:23,191 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:58:23,192 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:58:23,194 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:58:23,198 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:58:23,201 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:58:23,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:58:29,523 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:58:29,525 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:58:29,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:58:35,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:58:36,013 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:58:49,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:59:06,473 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:59:06,475 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:59:06,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:59:07,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:59:08,130 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:59:21,871 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:59:21,872 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:59:36,809 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:59:37,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:59:38,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:59:38,217 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:00:39,583 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:00:47,039 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:00:53,974 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:01:00,192 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:01:07,094 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:01:12,860 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:01:19,265 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:01:25,441 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:01:25,443 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 08:01:25,444 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:01:26,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:01:26,445 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 08:01:26,446 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 08:01:28,982 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 08:01:41,601 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 08:01:41,978 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 08:01:44,451 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:01:45,530 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 08:01:45,532 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 08:01:49,512 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 255
2025-11-12 08:01:49,512 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:01:50,547 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 08:01:50,564 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 08:01:50,571 - ispa_next.main - DEBUG - 



2025-11-12 08:01:50,571 - ispa_next.main - DEBUG - starting with process 14 (HD-MS 2002) of 15
2025-11-12 08:01:50,576 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:01:52,052 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:01:53,694 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 08:01:53,696 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 255
2025-11-12 08:01:55,886 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 08:01:55,887 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:02:29,839 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 08:02:36,688 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 08:02:43,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:02:46,963 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 08:02:46,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:02:47,128 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:02:47,447 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 08:02:52,628 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 08:02:52,631 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 08:02:55,459 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:02:55,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:02:57,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:02:59,692 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 08:02:59,867 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 08:03:00,249 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 08:03:00,786 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 08:03:00,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:03:04,537 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 08:03:13,490 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 08:03:14,496 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 08:03:14,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:03:15,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:03:27,756 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 08:03:27,759 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 08:03:33,160 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 08:03:33,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:03:33,301 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:03:33,302 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 08:03:33,416 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 08:03:34,980 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 08:03:35,524 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 08:03:37,802 - ispa_next.functions - DEBUG - Updated appointment (AA00040729) customer contact data.
2025-11-12 08:03:38,795 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 08:03:38,918 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 08:03:39,890 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 08:03:39,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 08:03:41,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 08:03:44,865 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:03:44,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:03:45,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:03:47,403 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 08:03:47,534 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 08:03:47,726 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 08:03:47,830 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 08:03:47,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:03:51,418 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 08:04:02,796 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 08:04:08,907 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 08:04:08,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:04:12,476 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 08:04:16,713 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 08:04:17,721 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 08:04:17,722 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 08:04:17,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:04:17,855 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 08:04:21,992 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 08:04:27,071 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 08:04:27,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:04:27,229 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 08:04:32,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:04:33,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:04:33,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:04:34,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:04:34,335 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 08:04:37,781 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 08:04:37,784 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 08:04:39,357 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 08:04:39,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:04:39,361 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 08:04:39,362 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 08:04:39,363 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 08:04:39,365 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:04:39,368 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 08:04:39,369 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 08:04:39,370 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 08:04:39,373 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 08:04:39,374 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 08:04:39,376 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 08:04:39,380 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 08:04:39,382 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 08:04:39,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:04:43,041 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 08:04:43,043 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 08:04:43,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:04:46,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:04:46,647 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 08:04:56,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:05:10,368 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 08:05:10,370 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 08:05:10,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 08:05:11,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 08:05:11,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:05:23,142 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 08:05:23,144 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 08:05:37,693 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 08:05:38,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:05:39,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 08:05:39,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:06:13,599 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:06:20,477 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:06:28,206 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:06:34,301 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:06:34,303 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 08:06:34,304 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:06:35,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:06:35,322 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 08:06:35,334 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 08:06:38,050 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 08:06:49,550 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 08:06:49,994 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 08:06:51,725 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:06:53,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 08:06:53,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 08:06:58,078 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 255
2025-11-12 08:06:58,079 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:06:59,057 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 08:06:59,074 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
2025-11-12 08:06:59,081 - ispa_next.main - DEBUG - 



2025-11-12 08:06:59,082 - ispa_next.main - DEBUG - starting with process 15 (SP-XR 30 E) of 15
2025-11-12 08:06:59,098 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:07:00,624 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:07:02,280 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 08:07:02,281 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 255
2025-11-12 08:07:04,412 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 08:07:04,414 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:07:42,807 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 08:07:45,299 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 08:07:52,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:07:56,042 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 08:07:56,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:07:56,154 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:07:56,484 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 08:07:56,487 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 08:07:59,496 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:07:59,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:08:00,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:08:02,851 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 08:08:03,012 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 08:08:03,115 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 08:08:03,262 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 08:08:03,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:08:06,066 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 08:08:14,835 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 08:08:15,840 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 08:08:15,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:08:16,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:08:31,164 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 08:08:36,524 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 08:08:36,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:08:36,658 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:08:36,659 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 08:08:36,750 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 08:08:38,288 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 08:08:38,916 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 08:08:41,248 - ispa_next.functions - DEBUG - Updated appointment (AD00027514) customer contact data.
2025-11-12 08:08:42,187 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 08:08:42,203 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 08:08:43,350 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 08:08:43,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 08:08:44,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 08:08:48,368 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:08:48,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:08:48,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:08:50,888 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 08:08:51,076 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 08:08:51,210 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 08:08:51,398 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 08:08:51,400 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:08:54,216 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 08:09:02,835 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 08:10:02,840 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 08:10:12,236 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 08:10:43,239 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 08:10:51,827 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 08:11:01,817 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 08:11:02,824 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 08:11:02,825 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 08:11:02,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:11:02,896 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 08:11:07,059 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 08:11:07,063 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 08:11:07,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:11:07,254 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 08:11:07,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:11:08,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:11:08,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:11:09,075 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:11:09,076 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 08:11:11,824 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 08:11:11,825 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 08:11:13,964 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 08:11:13,976 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:11:13,979 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-12 08:11:13,980 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-12 08:11:13,981 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 08:11:13,982 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:11:13,986 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-12 08:11:13,987 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 08:11:13,989 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 08:11:13,992 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 08:11:13,993 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 08:11:13,996 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 08:11:13,999 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 08:11:14,001 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 08:11:14,002 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:11:17,012 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 08:11:17,015 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 08:11:17,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:11:19,725 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 08:11:19,728 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 08:11:19,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 08:11:20,941 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 08:11:21,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:11:31,330 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 08:11:31,332 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 08:11:45,521 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 08:11:46,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:11:46,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 08:11:47,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:12:13,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:12:19,370 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:12:25,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:12:25,650 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 08:12:25,650 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:12:26,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:12:26,641 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 08:12:26,643 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 08:12:29,186 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 08:12:42,714 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 08:12:43,603 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 08:12:44,800 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:12:46,533 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1193
2025-11-12 08:12:46,534 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 08:12:50,541 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 255
2025-11-12 08:12:50,542 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:12:51,736 - ispa_next.appointments.models - DEBUG - Appointment Graziano Passerie MA-DP 1715 WBATY55010N042737 ohne Termin.
2025-11-12 08:12:51,753 - ispa_next.appointments.models - DEBUG - Appointment Nikolai Wintergoller SP-M 1048 WBAJM71070B270604 ohne Termin.
