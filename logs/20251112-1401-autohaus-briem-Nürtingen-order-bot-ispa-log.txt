2025-11-12 14:01:24,166 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 14:01:24,166 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 14:01:35,027 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 14:01:45,619 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 14:02:01,463 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 14:02:26,678 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 14:02:41,769 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 14:02:45,245 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:02:46,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 661
2025-11-12 14:02:46,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 129
2025-11-12 14:02:49,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 62
2025-11-12 14:02:49,731 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 14:02:49,732 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 14:02:51,150 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 14:02:52,616 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:03:04,800 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Wolfer ES-T 1207 WBA11DY060FK04325 ohne Termin.
2025-11-12 14:03:04,826 - ispa_next.appointments.models - DEBUG - Appointment Frau Kirstin Hub ES-KH 756 WBAUD71010P274289 ohne Termin.
2025-11-12 14:03:04,841 - ispa_next.appointments.models - DEBUG - Appointment Herr Thorsten Jahn ES-BT 213E WBA71AB0005T71531 ohne Termin.
2025-11-12 14:03:04,850 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Schenk ES-B 9898 WMW21GX0902X65973 ohne Termin.
2025-11-12 14:03:04,873 - ispa_next.appointments.models - DEBUG - Appointment Herr Erwin Konz ES-KL 2810 WMW31GA0007R53152 ohne Termin.
2025-11-12 14:03:04,885 - ispa_next.appointments.models - DEBUG - Appointment Herr Süha Ahmet Islek GP-XX 2024 WBY61EF0605Y46291 ohne Termin.
2025-11-12 14:03:04,896 - ispa_next.appointments.models - DEBUG - Appointment Herr Tom Marginean ES-TM 303 WBA3E31000F143961 ohne Termin.
2025-11-12 14:03:04,903 - ispa_next.appointments.models - DEBUG - Appointment Firma Stadtwerke Nürtingen GmbH NT-SW 255 WBA2X910407F70257 ohne Termin.
2025-11-12 14:03:04,911 - ispa_next.appointments.models - DEBUG - Appointment Firma Curium Germany GmbH B-CM 1688 WBA11GR0709159541 ohne Termin.
2025-11-12 14:03:04,920 - ispa_next.appointments.models - DEBUG - Appointment Herr Karlheinz-Heinz Jetter NT-JE 1000 WBAHU310305E39817 ohne Termin.
2025-11-12 14:03:04,948 - ispa_next.appointments.models - DEBUG - Appointment Herr Jörg Ohst DIL-CB 22 WBS31BA0X0CM39721 ohne Termin.
2025-11-12 14:03:04,960 - ispa_next.appointments.models - DEBUG - Appointment Frau Ella Rezlaw ES-LV 2313 WBA8H91060K664108 ohne Termin.
2025-11-12 14:03:04,980 - ispa_next.appointments.models - DEBUG - Appointment Firma Quality Analysis GmbH NT-W 2105 WBA7L110607P01981 ohne Termin.
2025-11-12 14:03:04,993 - ispa_next.appointments.models - DEBUG - Appointment Frau Gabriele Oberrenner ES-GM 2510 WBA8H71050FH09958 ohne Termin.
2025-11-12 14:03:05,029 - ispa_next.main - DEBUG - Found 1 out of 43 appointments to process (configured limit: 15).
2025-11-12 14:03:05,030 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-12 14:03:05,030 - ispa_next.main - DEBUG - All appointments: NT-FE 292E
2025-11-12 14:03:05,032 - ispa_next.main - DEBUG - 



2025-11-12 14:03:05,032 - ispa_next.main - DEBUG - starting with process 1 (NT-FE 292E) of 1
2025-11-12 14:03:05,036 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:03:06,435 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:03:07,874 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 661
2025-11-12 14:03:07,876 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 62
2025-11-12 14:03:09,700 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:03:09,701 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:03:42,043 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:03:53,126 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:03:57,159 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:03:57,159 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:04:00,098 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:04:00,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:04:00,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:04:02,991 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:04:03,113 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:04:03,249 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:04:03,328 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:04:09,606 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 14:04:10,610 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:04:10,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:04:11,093 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:04:24,341 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 14:04:33,258 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:04:33,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:04:33,338 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:04:33,338 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:04:33,449 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:04:33,622 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:04:35,403 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:04:35,742 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:04:39,066 - ispa_next.functions - DEBUG - Updated appointment (AD00018357) customer contact data.
2025-11-12 14:04:39,993 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:04:39,995 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:04:40,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:04:41,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:04:42,715 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:04:42,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:04:42,914 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 14:04:46,560 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:04:46,560 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 14:04:46,560 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:04:46,572 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 14:04:46,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:04:47,066 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:04:51,341 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 14:04:52,115 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 14:05:04,592 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:05:04,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:05:04,705 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:05:05,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:05,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:05,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:05:06,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:05:06,918 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:05:11,420 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:05:11,420 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:05:12,893 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:05:12,893 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:05:12,904 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:05:12,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:05:12,909 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Gasdruckfedern für Frontklappe aus- und einb: placement requirements not met
2025-11-12 14:05:12,909 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 14:05:12,909 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:05:12,909 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:05:12,909 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:05:12,909 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:05:12,909 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 14:05:16,543 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:17,092 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:05:18,092 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:18,701 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:19,248 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:05:20,232 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:20,818 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:21,389 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:05:22,357 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:22,967 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:23,519 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:05:25,279 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:25,881 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:26,419 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:05:27,404 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:28,005 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:28,580 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:05:29,545 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:30,936 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:05:31,935 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:05:33,045 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:05:33,045 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:05:33,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:05:37,436 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:05:37,446 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:05:37,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:05:41,599 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:05:41,599 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:05:41,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:05:42,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:05:42,577 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:05:42,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:05:46,709 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:06:06,827 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:06:07,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:06:07,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:06:08,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:06:50,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:06:57,766 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:05,391 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:12,414 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:20,344 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:20,344 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:07:20,344 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:07:21,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:07:21,899 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:07:21,899 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:07:26,016 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:07:45,673 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:07:46,084 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 14:07:47,254 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:07:50,040 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 662
2025-11-12 14:07:50,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:07:56,006 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 130
2025-11-12 14:07:56,007 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:07:57,819 - ispa_next.appointments.models - DEBUG - Appointment Firma Eigenes Autohaus Briem  WBY11HH050CU14909 ohne Termin.
2025-11-12 14:07:57,828 - ispa_next.appointments.models - DEBUG - Appointment Herr Tobias Mack NT-TM 3107 WBACV610309B25912 ohne Termin.
2025-11-12 14:07:57,841 - ispa_next.appointments.models - DEBUG - Appointment Frau Martina Sieglinde Gerbig ES-OM 1414 WBY71AW040FS51818 ohne Termin.
2025-11-12 14:07:57,849 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Wolfer ES-T 1207 WBA11DY060FK04325 ohne Termin.
