2025-11-12 05:01:41,606 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 05:01:41,613 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 05:02:00,251 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:02:15,411 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:02:32,770 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:03:38,367 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 05:03:59,797 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 05:04:04,571 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:04:06,046 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:04:06,047 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:04:09,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 380
2025-11-12 05:04:09,130 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 05:04:09,130 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:04:10,656 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:04:12,101 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:05:29,667 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,669 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,684 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,694 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,716 - ispa_next.appointments.models - DEBUG - Appointment Siegfried Geißler  WBA51EG0505W23667 ohne Termin.
2025-11-12 05:05:29,730 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,732 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,751 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,759 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,776 - ispa_next.appointments.models - DEBUG - Appointment Frau Alexandra Wolf BA-AW 555 WBY8P210607K30883 ohne Termin.
2025-11-12 05:05:29,777 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,777 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,778 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,779 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,781 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,781 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,835 - ispa_next.appointments.models - DEBUG - Appointment Gasthof Dinkel LIF-JD 555 WBSJF010X0G965188 ohne Termin.
2025-11-12 05:05:29,857 - ispa_next.appointments.models - DEBUG - Appointment Firma Minges Kaffeerösterei GmbH BA-MK 540 WBA11GR0409Y69237 ohne Termin.
2025-11-12 05:05:29,863 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,864 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,903 - ispa_next.appointments.models - DEBUG - Appointment Herr Bastian Stern HÖS-S 1312 WBA4J51020BN80220 ohne Termin.
2025-11-12 05:05:29,910 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,910 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,929 - ispa_next.appointments.models - DEBUG - Appointment Herr Stephan Nätscher BA-MN 1019 WBA7K310307J40556 ohne Termin.
2025-11-12 05:05:29,945 - ispa_next.appointments.models - DEBUG - Appointment Firma Kraftanlagen Energies & M-KA 2446 WBA41EG0905Z23353 ohne Termin.
2025-11-12 05:05:29,953 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:29,988 - ispa_next.appointments.models - DEBUG - Appointment Frau Franziska Berg BA-JP 1720 WMWLN710202E75045 ohne Termin.
2025-11-12 05:05:30,001 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,027 - ispa_next.appointments.models - DEBUG - Appointment Herr Jürgen Manfred Suppe BA-SU 380 WBY61EF0305W96365 ohne Termin.
2025-11-12 05:05:30,054 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Kirsch BA-BK 746 WBA2E510205G50991 ohne Termin.
2025-11-12 05:05:30,057 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,072 - ispa_next.appointments.models - DEBUG - Appointment Firma Andreas Wagner Vertriebs GmbH HAS-W 3690 WBA15BZ070N298504 ohne Termin.
2025-11-12 05:05:30,076 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,110 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,147 - ispa_next.appointments.models - DEBUG - Appointment Firma Erlanger Treuhand GmbH ER-TR 70E WBA21GV020CU74535 ohne Termin.
2025-11-12 05:05:30,157 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,189 - ispa_next.appointments.models - DEBUG - Appointment Herr Joseph Köberlein BA-ZZ 900 WBABK71050ER63535 ohne Termin.
2025-11-12 05:05:30,219 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,258 - ispa_next.appointments.models - DEBUG - Appointment Frau Aslihan Karaman NÖ-AK 5252 WBAHT710305K01893 ohne Termin.
2025-11-12 05:05:30,285 - ispa_next.appointments.models - DEBUG - Appointment Generalstaatsanwaltschaft BA-N 1017E WBA51BX0607T37782 ohne Termin.
2025-11-12 05:05:30,305 - ispa_next.appointments.models - DEBUG - Appointment Herr Josef Reuß KG-TR 899 WBA8H91030A719314 ohne Termin.
2025-11-12 05:05:30,320 - ispa_next.appointments.models - DEBUG - Appointment Firma Elektro Weis GmbH & Co. KG BA-XX 621 WMW61DL0503P86044 ohne Termin.
2025-11-12 05:05:30,341 - ispa_next.appointments.models - DEBUG - Appointment Frau Birgitta Helmstetter BA-A 607 WBA7K310507K49097 ohne Termin.
2025-11-12 05:05:30,345 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,359 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Kießwetter BA-CL 16 WBA4A51060D408079 ohne Termin.
2025-11-12 05:05:30,399 - ispa_next.appointments.models - DEBUG - Appointment Firma bornheim GmbH & Co. KG BA-M 180 WBA11GF0107R40264 ohne Termin.
2025-11-12 05:05:30,427 - ispa_next.appointments.models - DEBUG - Appointment Herr Adam Jacek Kesminowicz BA-KA 91 WBAHT710505J98589 ohne Termin.
2025-11-12 05:05:30,452 - ispa_next.appointments.models - DEBUG - Appointment Frau Inge Kimbrough WUN-NY 111 WBA31AD0303L79467 ohne Termin.
2025-11-12 05:05:30,492 - ispa_next.appointments.models - DEBUG - Appointment Herr Peter Kupsch BA-PK 12 WBAHS910805H68893 ohne Termin.
2025-11-12 05:05:30,525 - ispa_next.appointments.models - DEBUG - Appointment Frau Jennifer Crayne ERH-JD 604 WMW51DK0102T47698 ohne Termin.
2025-11-12 05:05:30,526 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:05:30,542 - ispa_next.appointments.models - DEBUG - Appointment Herr Rainer Andreas Rebel BA-TR 2003 WBAPP11070E794980 ohne Termin.
2025-11-12 05:05:30,557 - ispa_next.appointments.models - DEBUG - Appointment Herr Mohammad Al Ahmad BA-SY 222 WBA8T31090BX94248 ohne Termin.
2025-11-12 05:05:30,571 - ispa_next.appointments.models - DEBUG - Appointment Herr Mario Kämpf ASL-MH 810 WBA11AB0005U74034 ohne Termin.
2025-11-12 05:05:30,593 - ispa_next.appointments.models - DEBUG - Appointment Frau Martina Zeißler EBS-MZ 181 WBA1S510605A79963 ohne Termin.
2025-11-12 05:05:30,624 - ispa_next.appointments.models - DEBUG - Appointment Frau Christine Roppelt BA-CR 4422 WBAJG110X03G84879 ohne Termin.
2025-11-12 05:05:30,655 - ispa_next.appointments.models - DEBUG - Appointment Frau Ulrike Starker BA-US 96 WBA8H71040K803544 ohne Termin.
2025-11-12 05:05:30,674 - ispa_next.appointments.models - DEBUG - Appointment Firma MG-Nährmittel Produktservice BA-M 8013 WBSAE01020CE87488 ohne Termin.
2025-11-12 05:05:30,688 - ispa_next.appointments.models - DEBUG - Appointment Herr Alexander Erdpohl BA-AE 779 WBA8H91000K868189 ohne Termin.
2025-11-12 05:05:30,745 - ispa_next.main - DEBUG - Found 15 out of 221 appointments to process (configured limit: 15).
2025-11-12 05:05:30,745 - ispa_next.main - DEBUG - Processing 0 fresh appointments.
2025-11-12 05:05:30,746 - ispa_next.main - DEBUG - Processing 15 already visited appointments (w/ RKR not callable).
2025-11-12 05:05:30,746 - ispa_next.main - DEBUG - All appointments: FO-MX 186, BA-CT 97, BA-PM 1007, BA-EK 33, BA-FS 2002, BA-PE 76, ER-S 2305E, BA-CR 4422, BA-L 938, BA-AR 4321, BA-A 1284, FÜ-H 2234, BA-F 2008E, BA-CL 16, BA-NZ 1609
2025-11-12 05:05:30,749 - ispa_next.main - DEBUG - 



2025-11-12 05:05:30,749 - ispa_next.main - DEBUG - starting with process 1 (FO-MX 186) of 15
2025-11-12 05:05:30,755 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:05:32,166 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:05:33,862 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:05:33,864 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 380
2025-11-12 05:05:35,857 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:05:35,858 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:06:15,473 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:06:17,758 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:06:23,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:06:25,454 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:06:25,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:06:25,554 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:06:25,787 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 05:06:30,721 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:06:30,729 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:06:30,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:06:30,868 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:06:39,090 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:06:39,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:06:40,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:06:42,403 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:06:42,548 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:06:42,665 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:06:42,747 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:06:42,749 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:06:45,066 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:06:54,050 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:06:55,057 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:06:55,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:06:55,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:07:11,111 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:07:16,260 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:07:16,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:07:16,386 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:07:16,388 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:07:16,434 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:07:18,113 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:07:18,531 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:07:21,916 - ispa_next.functions - DEBUG - Updated appointment (AC00040980) customer contact data.
2025-11-12 05:07:22,855 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:07:22,860 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:07:23,746 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:07:23,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:07:24,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:07:28,847 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:07:28,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:07:29,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:07:31,391 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:07:31,544 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:07:31,695 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:07:31,872 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:07:31,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:07:34,231 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:07:43,100 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:08:43,104 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:08:51,844 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:09:15,846 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:09:27,707 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:09:32,315 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:09:32,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:09:34,334 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:09:38,565 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:09:39,574 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:09:39,575 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:09:39,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:09:39,724 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:09:43,938 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:09:43,944 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:09:43,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:09:44,138 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:09:48,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:09:48,610 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:09:48,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:09:49,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:09:49,708 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:09:51,806 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:09:51,839 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:09:54,313 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:09:54,315 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:09:54,323 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:09:54,325 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:09:54,334 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:09:54,337 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:09:54,338 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:09:54,344 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:09:54,346 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:09:54,351 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:09:54,358 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:09:54,365 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:09:54,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:09:56,457 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:09:56,461 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:09:56,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:09:58,503 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:09:58,503 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:09:58,506 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:10:00,503 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:10:00,510 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:10:00,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:10:02,452 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:10:19,450 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:10:20,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:10:20,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:10:21,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:10:40,351 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:10:47,319 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:10:47,327 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:10:47,332 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:10:48,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:10:48,774 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:10:48,825 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:10:51,890 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:11:06,495 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:11:06,898 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 05:11:07,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:11:09,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:11:09,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:11:13,497 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:11:13,498 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:11:14,589 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:11:14,591 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:11:14,604 - ispa_next.main - DEBUG - 



2025-11-12 05:11:14,604 - ispa_next.main - DEBUG - starting with process 2 (BA-CT 97) of 15
2025-11-12 05:11:14,615 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:11:16,042 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:11:17,491 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:11:17,493 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:11:19,507 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:11:19,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:11:54,034 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:11:56,372 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:12:02,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:12:04,249 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:12:04,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:12:04,368 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:12:04,649 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:12:04,655 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:12:04,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:12:04,739 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:12:13,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:12:13,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:12:14,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:12:16,301 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:12:16,487 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:12:16,596 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:12:16,744 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:12:16,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:12:18,789 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:12:27,704 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:12:28,710 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:12:28,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:12:29,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:12:43,545 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:12:48,736 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:12:48,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:12:48,849 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:12:48,850 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:12:48,942 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:12:49,114 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:12:50,795 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:12:51,144 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:12:57,272 - ispa_next.functions - DEBUG - Updated appointment (AC00040950) customer contact data.
2025-11-12 05:12:58,222 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:12:58,229 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:12:58,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:12:59,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:13:00,740 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:13:00,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:13:00,863 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:13:04,497 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:13:04,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:13:05,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:13:07,009 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:13:07,158 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:13:07,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:13:07,678 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:13:07,680 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:13:09,725 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:13:18,556 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:14:18,559 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:14:27,373 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:14:54,377 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:15:05,294 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:15:10,752 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:15:10,754 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:15:15,847 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 05:15:18,609 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:15:21,064 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:15:22,072 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:15:22,073 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:15:22,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:15:22,191 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:15:26,380 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:15:31,070 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:15:31,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:15:31,172 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:15:31,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:32,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:15:32,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:15:33,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:15:33,134 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:15:35,698 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:15:35,701 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:15:38,649 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:15:38,651 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:15:38,683 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:15:38,685 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:15:38,691 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 05:15:38,692 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:15:38,698 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:15:38,699 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:15:38,707 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:15:38,709 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 05:15:41,416 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:41,959 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:15:42,876 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:43,458 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:44,010 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:15:44,932 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:45,506 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:46,053 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 05:15:47,719 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:49,933 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:50,878 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:51,499 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:52,435 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:53,049 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:54,024 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:54,613 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:55,577 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:56,164 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:57,109 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:57,722 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 05:15:58,717 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 05:15:59,567 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:15:59,591 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:15:59,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:01,609 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:16:01,615 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:16:01,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:04,073 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:16:04,073 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:16:04,076 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:06,100 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:16:06,107 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:16:06,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:08,111 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:16:24,976 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:16:25,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:16:26,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:16:26,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:16:46,329 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:16:51,743 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:16:51,748 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:16:51,749 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:16:52,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:16:52,702 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:16:52,708 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:16:55,329 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:17:05,916 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:17:06,299 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 05:17:06,983 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:17:09,521 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:17:09,522 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:17:13,096 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:17:13,097 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:17:14,200 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:17:14,202 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:17:14,215 - ispa_next.main - DEBUG - 



2025-11-12 05:17:14,216 - ispa_next.main - DEBUG - starting with process 3 (BA-PM 1007) of 15
2025-11-12 05:17:14,227 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:17:15,682 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:17:17,385 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:17:17,386 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:17:19,374 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:17:19,376 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:17:54,340 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:17:56,809 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:18:02,595 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:03,915 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:18:03,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:03,995 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:04,395 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:18:04,403 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:18:04,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:04,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:07,835 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:18:07,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:09,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:18:11,047 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:18:11,176 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:18:11,381 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:18:11,509 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:18:11,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:12,827 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:18:21,653 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:18:22,660 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:18:22,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:23,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:36,595 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:18:36,596 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:18:41,485 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:18:41,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:41,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:41,583 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:18:41,674 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:18:43,176 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:18:43,541 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:18:46,557 - ispa_next.functions - DEBUG - Updated appointment (AC00041241) customer contact data.
2025-11-12 05:18:47,581 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:18:47,849 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:18:48,945 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:18:48,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:18:49,886 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:18:53,499 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:18:53,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:54,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:18:56,119 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:18:56,311 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:18:56,498 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:18:56,604 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:18:56,606 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:58,018 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:19:09,693 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:19:14,432 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:19:14,434 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:15,756 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:19:19,974 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:19:20,988 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:19:20,993 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:19:20,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:19:21,083 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:19:25,261 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:19:25,268 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:19:25,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:19:25,377 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:19:30,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:19:31,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:19:31,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:19:32,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:19:32,679 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:19:34,073 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:19:34,076 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:19:36,362 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:19:36,363 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:19:36,368 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:19:36,369 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:19:36,375 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:19:36,377 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:19:36,378 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:19:36,384 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:19:36,385 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:19:36,391 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:19:36,398 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:19:36,411 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:19:36,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:37,860 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:19:37,866 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:19:37,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:39,184 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:19:39,184 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:19:39,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:40,485 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:19:40,492 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:19:40,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:19:41,769 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:19:58,388 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:19:59,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:19:59,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:19:59,997 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:20:14,347 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:20:14,351 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:20:14,352 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:20:15,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:20:15,281 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:20:15,287 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:20:17,917 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:20:28,400 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:20:28,899 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 05:20:29,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:20:32,847 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:20:32,849 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:20:36,358 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:20:36,358 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:20:37,411 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:20:37,413 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:20:37,427 - ispa_next.main - DEBUG - 



2025-11-12 05:20:37,427 - ispa_next.main - DEBUG - starting with process 4 (BA-EK 33) of 15
2025-11-12 05:20:37,437 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:20:38,902 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:20:40,516 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:20:40,518 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:20:42,299 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:20:42,300 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:21:15,659 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:21:18,338 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:21:24,156 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:26,200 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:21:26,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:26,327 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:21:26,609 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:21:26,621 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:21:26,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:26,780 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:21:30,058 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:21:30,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:21:31,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:21:33,397 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:21:33,569 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:21:33,700 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:21:33,827 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:21:33,829 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:36,011 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:21:45,271 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:21:46,277 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:21:46,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:21:46,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:22:00,966 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:22:00,967 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:22:06,761 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:22:06,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:22:06,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:22:06,911 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:22:06,984 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:22:08,521 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:22:08,894 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:22:12,477 - ispa_next.functions - DEBUG - Updated appointment (AC00041222) customer contact data.
2025-11-12 05:22:13,472 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:22:13,476 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:22:14,453 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:22:14,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:22:15,490 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:22:19,094 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:22:19,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:22:19,602 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:22:21,606 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:22:21,756 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:22:21,896 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:22:22,053 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:22:22,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:22:24,165 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:22:35,123 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:22:41,132 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:22:41,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:22:43,236 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:22:47,473 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:22:48,481 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:22:48,482 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:22:48,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:22:48,573 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:22:52,723 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:22:52,729 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:22:52,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:22:52,852 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:23:01,883 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 05:23:10,656 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 05:23:16,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:17,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:17,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:23:17,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:23:17,755 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:23:19,844 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:23:19,846 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:23:22,137 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:23:22,139 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:23:22,146 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:23:22,149 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:23:22,155 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:23:22,157 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:23:22,158 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:23:22,163 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:23:22,164 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:23:22,170 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:23:22,178 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:23:22,185 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:23:22,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:23:24,294 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:23:24,300 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:23:24,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:23:26,352 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:23:26,352 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:23:26,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:23:28,402 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:23:28,408 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:23:28,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:23:30,442 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:23:47,624 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:23:48,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:23:49,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:23:49,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:09,804 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:24:15,099 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:24:15,103 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:24:15,104 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:24:15,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:24:16,088 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:24:16,092 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:24:18,568 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:24:29,505 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:24:29,927 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 05:24:30,774 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:24:34,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:24:34,139 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:24:37,869 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:24:37,870 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:24:38,988 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:24:38,990 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:24:39,003 - ispa_next.main - DEBUG - 



2025-11-12 05:24:39,004 - ispa_next.main - DEBUG - starting with process 5 (BA-FS 2002) of 15
2025-11-12 05:24:39,012 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:24:40,470 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:24:42,059 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:24:42,060 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:24:43,880 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:24:43,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:25:18,511 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:25:21,096 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:25:27,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:25:29,330 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:25:29,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:25:29,451 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:25:29,769 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:25:29,776 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:25:29,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:25:29,921 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:25:38,504 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:25:38,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:25:40,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:25:42,289 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:25:42,475 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:25:42,592 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:25:42,788 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:25:42,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:25:44,951 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:25:53,967 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:25:54,974 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:25:54,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:25:55,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:09,821 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:26:15,652 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:26:15,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:15,783 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:26:15,784 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:26:15,964 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:26:18,135 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:26:18,535 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:26:22,204 - ispa_next.functions - DEBUG - Updated appointment (AC00040970) customer contact data.
2025-11-12 05:26:23,242 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:26:23,249 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:26:24,333 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:26:24,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:26:25,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:26:29,013 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:26:29,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:29,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:26:31,540 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:26:31,684 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:26:31,797 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:26:31,912 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:26:31,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:34,013 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:26:43,180 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:27:43,183 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:27:54,097 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:27:59,074 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:27:59,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:01,180 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:28:05,415 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:28:06,425 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:28:06,426 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:28:06,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:06,536 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:28:10,693 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:28:10,700 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:28:10,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:10,859 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:28:11,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:11,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:28:11,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:28:12,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:28:12,730 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:28:14,865 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:28:14,867 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:28:17,180 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:28:17,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:28:17,186 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:28:17,187 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:28:17,194 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:28:17,195 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:28:17,196 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:28:17,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:28:17,203 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:28:17,209 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:28:17,217 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:28:17,226 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:28:17,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:19,537 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:28:19,543 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:28:19,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:21,650 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:28:21,651 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:28:21,652 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:23,702 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:28:23,706 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:28:23,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:25,740 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:28:43,552 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:28:44,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:28:45,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:28:45,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:29:05,514 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:11,358 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:11,362 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:29:11,363 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:12,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:29:12,357 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:29:12,363 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:29:14,936 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:29:26,139 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:29:26,523 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 05:29:27,343 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:29,714 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:29:29,715 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:33,373 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:29:33,374 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:29:34,498 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:29:34,500 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:29:34,513 - ispa_next.main - DEBUG - 



2025-11-12 05:29:34,513 - ispa_next.main - DEBUG - starting with process 6 (BA-PE 76) of 15
2025-11-12 05:29:34,519 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:35,968 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:37,712 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:29:37,713 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:29:40,027 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:40,028 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:30:15,179 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:30:17,825 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:30:24,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:27,371 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:30:27,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:27,556 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:27,781 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:30:27,788 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:30:27,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:27,979 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:31,538 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:31,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:33,162 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:30:35,165 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:30:35,370 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:30:35,539 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:30:35,632 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:30:35,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:39,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:30:48,972 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:30:49,982 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:30:49,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:50,559 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:05,478 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:31:11,346 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:31:11,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:11,504 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:31:11,505 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:31:11,617 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:31:13,338 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:31:14,837 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:31:15,288 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:31:18,525 - ispa_next.functions - DEBUG - Updated appointment (AC00040790) customer contact data.
2025-11-12 05:31:19,575 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:31:19,582 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:31:20,873 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:31:20,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:31:21,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:31:25,472 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:31:25,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:25,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:31:27,989 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:31:28,167 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:31:28,301 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:31:28,386 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:31:28,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:31,966 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:31:43,071 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:31:47,589 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:31:47,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:51,487 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:31:55,822 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:31:56,836 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:31:56,837 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:31:56,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:56,991 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:32:01,180 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:32:01,189 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:32:01,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:01,377 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:32:13,248 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 05:32:26,260 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 05:32:26,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:27,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:32:27,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:32:28,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:32:28,202 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:32:31,445 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:32:31,457 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:32:33,927 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:32:33,928 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:32:33,933 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:32:33,934 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:32:33,940 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:32:33,941 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:32:33,943 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:32:33,948 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:32:33,950 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:32:33,956 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:32:33,963 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:32:33,970 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:32:33,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:37,479 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:32:37,485 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:32:37,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:40,784 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:32:40,785 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:32:40,787 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:44,282 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:32:44,288 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:32:44,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:47,692 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:33:06,153 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:33:06,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:33:07,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:33:07,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:40,869 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:33:46,139 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:33:51,368 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:33:57,966 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:33:57,970 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:33:57,971 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:33:58,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:33:58,964 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:33:58,968 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:34:01,720 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:34:13,236 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:34:13,652 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 05:34:14,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:17,463 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:34:17,464 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:34:21,475 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:34:21,476 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:34:22,596 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:34:22,597 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:34:22,610 - ispa_next.main - DEBUG - 



2025-11-12 05:34:22,610 - ispa_next.main - DEBUG - starting with process 7 (ER-S 2305E) of 15
2025-11-12 05:34:22,619 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:34:24,155 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:34:25,881 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:34:25,884 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:34:28,110 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:34:28,112 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:35:02,986 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:35:05,558 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:35:11,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:14,539 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:35:14,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:14,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:15,081 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:35:15,116 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:35:15,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:15,266 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:18,500 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:35:18,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:35:19,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:35:21,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:35:22,086 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:35:22,185 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:35:22,367 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:35:22,369 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:25,400 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:35:34,500 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:35:35,507 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:35:35,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:36,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:52,732 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:35:58,228 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:35:58,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:35:58,375 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:35:58,376 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:35:58,417 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:36:00,340 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:36:00,692 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:36:03,923 - ispa_next.functions - DEBUG - Updated appointment (AC00041046) customer contact data.
2025-11-12 05:36:04,875 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:36:04,927 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:36:05,972 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:36:05,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:36:07,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:36:11,287 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:36:11,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:36:11,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:36:13,800 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:36:14,002 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:36:14,208 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:36:14,373 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:36:14,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:36:17,152 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:36:28,244 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:36:33,022 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:36:33,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:36:35,761 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:36:39,982 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:36:40,995 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:36:40,999 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:36:41,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:36:41,132 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:36:45,322 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:36:45,328 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:36:45,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:36:45,452 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:36:54,519 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 05:37:00,641 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 05:37:00,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:37:01,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:37:01,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:37:02,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:37:02,240 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:37:04,887 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:37:04,890 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:37:07,585 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:37:07,586 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:37:07,591 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:37:07,592 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:37:07,598 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:37:07,599 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:37:07,606 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:37:07,607 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:37:07,614 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:37:07,622 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:37:07,629 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:37:07,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:10,752 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:37:10,760 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:37:10,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:14,749 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:37:14,749 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:37:14,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:18,126 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:37:18,130 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:37:18,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:37:21,044 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:37:38,589 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:37:39,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:37:40,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:37:40,386 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:38:08,577 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:14,397 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:20,950 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:38:20,955 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:38:20,956 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:38:21,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:38:21,958 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:38:21,964 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:38:24,748 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:38:36,525 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:38:37,008 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 05:38:37,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:38:40,307 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:38:40,308 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:38:44,207 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:38:44,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:38:45,416 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:38:45,418 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:38:45,431 - ispa_next.main - DEBUG - 



2025-11-12 05:38:45,431 - ispa_next.main - DEBUG - starting with process 8 (BA-CR 4422) of 15
2025-11-12 05:38:45,447 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:38:46,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:38:48,740 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:38:48,741 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:38:50,993 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:38:50,995 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:39:25,751 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:39:31,144 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:39:37,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:39:40,517 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:39:40,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:40,599 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:39:40,953 - ispa_next.functions - DEBUG - HU date already expired after 780 days.
2025-11-12 05:39:46,530 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:39:46,535 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:39:46,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:39:46,613 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:39:54,996 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:39:54,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:39:56,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:39:58,432 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:39:58,561 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:39:58,763 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:39:58,894 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:39:58,896 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:40:01,719 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:40:10,935 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:40:11,941 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:40:11,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:40:12,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:40:27,307 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:40:27,307 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 05:40:32,729 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:40:32,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:40:32,861 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:40:32,863 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:40:32,956 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:40:33,208 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:40:34,855 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:40:35,194 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:40:38,580 - ispa_next.functions - DEBUG - Updated appointment (AC00041239) customer contact data.
2025-11-12 05:40:39,584 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:40:39,591 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:40:39,724 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:40:40,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:40:42,235 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:40:42,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:40:42,384 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:40:46,039 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:40:46,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:40:47,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:40:49,765 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:40:49,931 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:40:50,084 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:40:50,177 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:40:50,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:40:53,045 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:41:02,061 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:42:02,064 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:42:13,636 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:42:18,260 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:42:18,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:21,462 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:42:25,702 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:42:26,711 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:42:26,712 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:42:26,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:42:26,842 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:42:31,017 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:42:31,026 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:42:31,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:42:31,125 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:42:35,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:42:35,659 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:42:35,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:42:36,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:42:36,397 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:42:39,123 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:42:39,124 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:42:41,551 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:42:41,553 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:42:41,560 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:42:41,562 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:42:41,570 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:42:41,571 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:42:41,572 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:42:41,578 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:42:41,579 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:42:41,585 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:42:41,593 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:42:41,603 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:42:41,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:44,611 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:42:44,617 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:42:44,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:47,466 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:42:47,466 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:42:47,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:50,225 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:42:50,231 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:42:50,236 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:42:53,015 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:43:09,989 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:43:10,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:43:11,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:43:11,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:43:38,906 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:43:44,918 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:43:50,680 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:43:50,684 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:43:50,685 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:43:51,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:43:51,705 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:43:51,712 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:43:54,310 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:44:06,115 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:44:06,538 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 05:44:07,210 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:44:10,703 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:44:10,704 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:44:14,589 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:44:14,590 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:44:15,573 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:44:15,574 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:44:15,596 - ispa_next.main - DEBUG - 



2025-11-12 05:44:15,596 - ispa_next.main - DEBUG - starting with process 9 (BA-L 938) of 15
2025-11-12 05:44:15,603 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:44:17,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:44:18,892 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:44:18,893 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:44:21,181 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:44:21,182 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:44:59,911 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:45:02,482 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:45:08,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:45:11,135 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:45:11,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:45:11,212 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:45:11,540 - ispa_next.functions - DEBUG - HU date already expired after 322 days.
2025-11-12 05:45:16,840 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:45:16,848 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:45:16,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:45:16,987 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:45:25,383 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:45:25,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:45:26,880 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:45:28,883 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:45:29,067 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:45:29,165 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:45:29,318 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:45:29,320 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:45:32,305 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:45:41,662 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:45:42,669 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:45:42,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:45:43,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:45:58,905 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:46:05,072 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:46:05,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:46:05,151 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:46:05,152 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:46:05,235 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:46:05,621 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:46:07,156 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:46:07,531 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:46:10,804 - ispa_next.functions - DEBUG - Updated appointment (AC00041260) customer contact data.
2025-11-12 05:46:11,879 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:46:11,884 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:46:12,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:46:13,855 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:46:15,097 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:46:15,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:46:15,199 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:46:19,341 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:46:19,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:46:20,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:46:22,074 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:46:22,259 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:46:22,426 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:46:22,554 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:46:22,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:46:25,369 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:46:34,472 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:47:34,475 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:47:44,282 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:48:00,284 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:48:12,323 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:48:17,172 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:48:17,173 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:48:21,071 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:48:25,296 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:48:26,304 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:48:26,305 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:48:26,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:48:26,457 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:48:30,612 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:48:30,621 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:48:30,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:48:30,721 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:48:31,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:48:31,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:48:31,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:48:32,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:48:32,577 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:48:35,371 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:48:35,374 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:48:37,715 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:48:37,716 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:48:37,723 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:48:37,723 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:48:37,730 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:48:37,731 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:48:37,732 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:48:37,738 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:48:37,739 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:48:37,745 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:48:37,752 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:48:37,759 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:48:37,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:48:40,781 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:48:40,787 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:48:40,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:48:43,532 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:48:43,532 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:48:43,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:48:46,299 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:48:46,305 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:48:46,307 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:48:49,063 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:49:07,175 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:49:07,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:49:08,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:49:09,229 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:49:35,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:49:41,005 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:49:47,104 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:49:47,108 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:49:47,109 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:49:48,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:49:48,129 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:49:48,133 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:49:50,830 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:50:03,107 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:50:03,650 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 05:50:04,393 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:50:07,279 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:50:07,280 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:50:11,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:50:11,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:50:12,192 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:50:12,193 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:50:12,202 - ispa_next.main - DEBUG - 



2025-11-12 05:50:12,202 - ispa_next.main - DEBUG - starting with process 10 (BA-AR 4321) of 15
2025-11-12 05:50:12,212 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:50:13,735 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:50:15,507 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:50:15,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:50:17,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:50:17,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:50:55,050 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:50:59,835 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:51:05,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:51:07,284 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:51:07,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:51:07,361 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:51:07,785 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:51:07,794 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:51:07,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:51:07,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:51:11,184 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:51:11,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:51:12,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:51:14,919 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:51:15,115 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:51:15,305 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:51:15,489 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:51:15,491 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:51:16,924 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:51:26,116 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:51:27,123 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:51:27,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:51:27,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:51:44,224 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:51:52,210 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:51:52,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:51:52,321 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:51:52,322 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:51:52,414 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:51:53,847 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:51:55,410 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:51:55,869 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:51:59,104 - ispa_next.functions - DEBUG - Updated appointment (AC00041090) customer contact data.
2025-11-12 05:52:00,203 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:52:00,235 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:52:01,248 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:52:01,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:52:02,576 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:52:06,262 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:52:06,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:52:06,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:52:08,779 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:52:08,916 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:52:09,108 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:52:09,220 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:52:09,222 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:52:10,684 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:52:19,719 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:53:19,722 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:53:30,893 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:53:36,609 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:53:36,611 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:37,947 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:53:42,172 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:53:43,180 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:53:43,181 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:53:43,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:53:43,343 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:53:47,484 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:53:47,491 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:53:47,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:53:47,587 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:53:51,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:52,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:53:52,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:53:52,909 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:53:52,913 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:53:54,353 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:53:54,355 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:53:56,935 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:53:56,937 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:53:56,945 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:53:56,946 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:53:56,953 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:53:56,954 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:53:56,955 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:53:56,961 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:53:56,962 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:53:56,968 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:53:56,975 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:53:56,982 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:53:56,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:58,361 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:53:58,368 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:53:58,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:53:59,791 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:53:59,791 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:53:59,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:54:01,427 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:54:01,433 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:54:01,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:54:02,877 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:54:22,128 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:54:22,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:54:23,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:54:24,114 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:54:37,156 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:54:37,161 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:54:37,162 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:54:38,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:54:38,161 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:54:38,165 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:54:40,886 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:54:52,135 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:54:52,600 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 05:54:53,458 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:54:56,080 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:54:56,082 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:55:00,269 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:55:00,270 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:55:01,341 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:55:01,342 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:55:01,350 - ispa_next.main - DEBUG - 



2025-11-12 05:55:01,350 - ispa_next.main - DEBUG - starting with process 11 (BA-A 1284) of 15
2025-11-12 05:55:01,357 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:55:02,935 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:55:04,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:55:04,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:55:07,060 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:55:07,061 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:55:43,735 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:55:46,212 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:55:52,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:55:54,278 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:55:54,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:55:54,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:55:54,809 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:55:54,816 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:55:54,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:55:54,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:56:03,767 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:56:03,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:56:05,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:56:07,214 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:56:07,380 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:56:07,552 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:56:07,690 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:56:07,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:56:09,032 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:56:18,725 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:56:19,731 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:56:19,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:56:20,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:56:38,034 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:56:44,193 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:56:44,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:56:44,339 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:56:44,340 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:56:44,418 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:56:45,929 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:56:47,376 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:56:47,745 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:56:51,182 - ispa_next.functions - DEBUG - Updated appointment (AE00025445) customer contact data.
2025-11-12 05:56:52,319 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:56:52,325 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:56:53,916 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:56:53,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:56:55,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:56:58,671 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:56:58,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:56:59,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:57:01,212 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:57:01,380 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:57:01,533 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:57:01,611 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:57:01,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:57:03,032 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:57:12,053 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:58:12,057 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:58:24,153 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 05:58:29,680 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 05:58:29,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:31,101 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:58:35,330 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 05:58:36,338 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:58:36,339 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:58:36,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:58:36,420 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:58:40,651 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:58:40,657 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:58:40,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:58:40,758 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:58:44,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:45,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:58:45,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:58:46,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:58:46,200 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:58:47,584 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:58:47,587 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:58:49,999 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:58:50,001 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:58:50,013 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:58:50,016 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:58:50,024 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:58:50,026 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:58:50,027 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:58:50,033 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:58:50,034 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:58:50,040 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:58:50,047 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:58:50,061 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:58:50,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:51,409 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:58:51,416 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:58:51,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:52,788 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:58:52,788 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 05:58:52,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:54,100 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:58:54,104 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:58:54,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:58:55,470 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:59:13,082 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:59:13,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:59:14,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:59:14,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:59:28,202 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:59:28,209 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:59:28,210 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:59:29,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:59:29,177 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:59:29,183 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:59:31,801 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:59:43,727 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:59:44,149 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 05:59:45,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:59:47,523 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:59:47,524 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:59:51,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 05:59:51,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:59:53,088 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:59:53,090 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:59:53,100 - ispa_next.main - DEBUG - 



2025-11-12 05:59:53,100 - ispa_next.main - DEBUG - starting with process 12 (FÜ-H 2234) of 15
2025-11-12 05:59:53,721 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:59:55,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:59:56,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 05:59:56,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 05:59:59,172 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:59:59,173 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:00:37,752 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:00:41,162 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:00:47,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:00:48,499 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:00:48,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:00:48,686 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:00:49,007 - ispa_next.functions - DEBUG - HU date soon to be invalid in 9 days.
2025-11-12 06:00:54,857 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:00:54,865 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:00:54,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:00:55,057 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:00:58,453 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:00:58,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:01:00,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:01:02,160 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:01:02,323 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:01:02,552 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:01:02,632 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:01:02,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:01:04,035 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:01:13,084 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:01:14,091 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:01:14,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:01:14,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:01:32,343 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:01:37,923 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:01:37,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:01:38,003 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:01:38,004 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:01:38,166 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:01:40,568 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:01:40,923 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:01:44,594 - ispa_next.functions - DEBUG - Updated appointment (AC00041005) customer contact data.
2025-11-12 06:01:45,580 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:01:45,599 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:01:46,750 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:01:46,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:01:48,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:01:51,672 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:01:51,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:01:52,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:01:54,389 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:01:54,594 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:01:54,722 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:01:54,799 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:01:54,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:01:56,263 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:02:07,611 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:02:12,771 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:02:12,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:14,122 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:02:18,331 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:02:19,339 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:02:19,340 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 06:02:19,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:02:19,466 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:02:23,652 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 06:02:23,661 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:02:23,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:02:23,767 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:02:29,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:02:29,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:02:29,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:02:30,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:02:30,749 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:02:32,371 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:02:32,373 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:02:35,794 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:02:35,796 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:02:35,850 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:02:35,852 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:02:35,857 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:02:35,858 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:02:35,890 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:02:35,898 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:02:35,899 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:02:35,907 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:02:35,916 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:02:35,924 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:02:35,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:37,819 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:02:37,830 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:02:37,833 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:39,397 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:02:39,397 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 06:02:39,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:40,762 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:02:40,766 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:02:40,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:02:42,166 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:03:00,726 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:03:01,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:03:02,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:03:02,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:03:17,072 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:03:17,076 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:03:17,077 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:03:17,960 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:03:18,087 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:03:18,093 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:03:20,771 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:03:32,369 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:03:32,755 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 06:03:34,715 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:03:37,496 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:03:37,498 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:03:41,671 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 06:03:41,671 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:03:42,766 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:03:42,767 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:03:42,775 - ispa_next.main - DEBUG - 



2025-11-12 06:03:42,775 - ispa_next.main - DEBUG - starting with process 13 (BA-F 2008E) of 15
2025-11-12 06:03:42,781 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:03:44,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:03:46,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:03:46,134 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 06:03:48,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:03:48,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:04:33,115 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:04:35,877 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:04:41,803 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:04:43,166 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:04:43,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:04:43,286 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:04:43,687 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:04:43,695 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:04:43,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:04:43,833 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:04:47,344 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:04:47,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:04:49,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:04:51,035 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:04:51,169 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:04:51,310 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:04:51,421 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:04:55,686 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 06:04:56,693 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:04:56,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:04:57,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:05:10,229 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 06:05:15,611 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:05:15,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:05:15,765 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:05:15,766 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:05:15,804 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:05:17,352 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:05:18,795 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:05:19,177 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:05:22,610 - ispa_next.functions - DEBUG - Updated appointment (AC00041326) customer contact data.
2025-11-12 06:05:23,713 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:05:23,719 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:05:24,722 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:05:24,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:05:25,961 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:05:29,580 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:05:29,580 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 06:05:29,585 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:05:29,586 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 06:05:29,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:05:30,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:05:34,434 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 06:05:34,442 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:05:34,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:05:34,561 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:05:35,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:05:35,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:05:35,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:05:36,405 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:05:36,411 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:05:38,518 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:05:38,581 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:05:40,930 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:05:40,932 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:05:40,940 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:05:40,942 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:05:40,951 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:05:40,953 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:05:40,954 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:05:40,960 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:05:40,961 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:05:40,967 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:05:40,974 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:05:40,980 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:05:40,981 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:42,322 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:05:42,326 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:05:42,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:43,730 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:05:43,731 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 06:05:43,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:45,073 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:05:45,077 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:05:45,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:05:46,407 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:06:04,360 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:06:05,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:06:05,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:06:06,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:06:20,472 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:06:20,477 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:06:20,478 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:06:21,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:06:21,519 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:06:21,525 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:06:24,344 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:06:35,606 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:06:35,979 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 06:06:36,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:06:39,796 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:06:39,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:06:44,045 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 06:06:44,046 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:06:45,140 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:06:45,141 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:06:45,149 - ispa_next.main - DEBUG - 



2025-11-12 06:06:45,149 - ispa_next.main - DEBUG - starting with process 14 (BA-CL 16) of 15
2025-11-12 06:06:45,155 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:06:46,813 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:06:48,625 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:06:48,626 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 06:06:51,103 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:06:51,104 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:07:31,630 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:07:34,366 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:07:40,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:07:41,800 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:07:41,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:07:42,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:07:42,381 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-12 06:07:47,946 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:07:47,953 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:07:47,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:07:48,147 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:07:58,384 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:07:58,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:07:59,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:08:01,977 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:08:02,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:08:02,321 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:08:02,393 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:08:02,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:08:03,741 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:08:13,054 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:08:14,060 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:08:14,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:08:14,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:08:29,661 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 06:08:37,733 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:08:37,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:08:37,922 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:08:37,923 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:08:37,994 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:08:39,358 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:08:39,713 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:08:44,346 - ispa_next.functions - DEBUG - Updated appointment (AC00041245) customer contact data.
2025-11-12 06:08:45,281 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:08:45,361 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:08:46,545 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:08:46,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:08:47,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:08:51,551 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:08:51,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:08:52,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:08:54,140 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:08:54,301 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:08:54,540 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:08:54,676 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:08:54,678 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:08:56,010 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:09:05,124 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:10:05,127 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:10:13,982 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:10:31,985 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:10:43,192 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:10:47,954 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:10:47,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:10:50,614 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:10:54,840 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:10:55,853 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:10:55,854 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 06:10:55,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:10:55,997 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:11:00,247 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 06:11:00,256 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:11:00,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:11:00,375 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:11:04,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:11:04,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:11:04,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:11:05,820 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:11:05,826 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:11:07,314 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:11:07,317 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:11:09,953 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:11:09,954 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:11:09,961 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:11:09,962 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:11:09,968 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:11:09,970 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:11:09,971 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:11:09,976 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:11:09,978 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:11:09,984 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:11:09,992 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:11:09,999 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:11:10,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:11:11,550 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 06:11:15,045 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:11:15,096 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:11:15,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:11:16,699 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:11:16,699 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 06:11:16,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:11:18,066 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:11:18,073 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:11:18,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:11:19,409 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:11:37,065 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:11:37,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:11:38,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:11:38,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:11:53,326 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:11:53,331 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:11:53,331 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:11:54,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:11:54,343 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:11:54,349 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:11:56,975 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:12:08,781 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:12:09,166 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 06:12:10,242 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:12:13,099 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:12:13,100 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:12:17,164 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 06:12:17,164 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:12:18,237 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:12:18,239 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:12:18,265 - ispa_next.main - DEBUG - 



2025-11-12 06:12:18,265 - ispa_next.main - DEBUG - starting with process 15 (BA-NZ 1609) of 15
2025-11-12 06:12:18,275 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:12:19,843 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:12:21,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:12:21,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 488
2025-11-12 06:12:25,028 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:12:25,030 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:13:02,833 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:13:07,684 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:13:14,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:13:16,948 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:13:16,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:17,060 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:13:17,580 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:13:17,599 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:13:17,600 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:17,769 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:13:26,893 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:13:26,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:13:28,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:13:30,522 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:13:30,742 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:13:30,839 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:13:31,043 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:13:31,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:13:33,240 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:13:42,405 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:13:43,416 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:13:43,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:43,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:13:57,140 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 06:14:02,951 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:14:02,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:14:03,062 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:14:03,063 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:14:03,164 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:14:04,766 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:14:06,304 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:14:06,691 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:14:10,413 - ispa_next.functions - DEBUG - Updated appointment (AC00041097) customer contact data.
2025-11-12 06:14:11,521 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:14:11,525 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:14:12,550 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:14:12,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:14:13,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:14:17,490 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:14:17,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:14:18,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:14:20,012 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:14:20,151 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:14:20,279 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:14:20,410 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:14:20,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:14:22,718 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:14:32,770 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:15:32,773 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:15:45,551 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:15:50,405 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:15:50,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:15:52,484 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:15:56,715 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:15:57,723 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:15:57,724 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 06:15:57,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:15:57,854 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:16:01,998 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 06:16:02,006 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:16:02,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:16:02,145 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:16:02,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:16:03,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:16:03,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:16:04,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:16:04,069 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:16:06,107 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:16:06,109 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:16:08,966 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:16:08,968 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:16:08,976 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:16:08,978 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:16:08,986 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:16:08,989 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:16:08,990 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:16:08,996 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:16:08,997 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:16:09,003 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:16:09,010 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:16:09,016 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:16:09,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:16:11,187 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:16:11,193 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:16:11,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:16:13,347 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:16:13,348 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 06:16:13,351 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:16:15,474 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:16:15,478 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:16:15,480 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:16:17,687 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:16:35,243 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:16:35,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:16:36,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:16:37,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:16:48,339 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:16:48,342 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:16:49,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:16:49,390 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:16:49,405 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:16:56,622 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 06:17:08,502 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:17:08,981 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 06:17:09,780 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:17:12,984 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1684
2025-11-12 06:17:12,985 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:17:17,885 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 488
2025-11-12 06:17:17,885 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:17:18,945 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:17:18,946 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
