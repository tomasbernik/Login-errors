2025-11-12 10:14:34,789 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:14:34,798 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:14:44,229 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:14:55,013 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:15:11,240 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:15:43,661 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:15:58,913 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:16:03,017 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:04,245 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:16:04,246 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:16:06,286 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 345
2025-11-12 10:16:06,287 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:16:06,287 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:16:07,167 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:16:07,990 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:59,098 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,121 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,153 - ispa_next.appointments.models - DEBUG - Appointment Bogdan-Laurentiu Turcu ED-BT 315 WBA5U91000FK31617 ohne Termin.
2025-11-12 10:16:59,167 - ispa_next.appointments.models - DEBUG - Appointment Ute Mätzig M-U 7573 WBA81GE0007T32557 ohne Termin.
2025-11-12 10:16:59,182 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Miotorenwerke Akti M-NK 3548 WBA15GR030N352507 ohne Termin.
2025-11-12 10:16:59,194 - ispa_next.appointments.models - DEBUG - Appointment Rainer Kollenda ED-XX 24 WBAMT11020C298608 ohne Termin.
2025-11-12 10:16:59,209 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 10:16:59,219 - ispa_next.appointments.models - DEBUG - Appointment Josef Hartl ED-H 502 WBA11FL090CR69680 ohne Termin.
2025-11-12 10:16:59,230 - ispa_next.appointments.models - DEBUG - Appointment Friedrich Fiedler ED-F 1818 WBA25DP090N149286 ohne Termin.
2025-11-12 10:16:59,244 - ispa_next.appointments.models - DEBUG - Appointment Fitim Kucani ED-FF 2723 WBAUE11050PZ54416 ohne Termin.
2025-11-12 10:16:59,245 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,255 - ispa_next.appointments.models - DEBUG - Appointment Sami Polat ED-N 4423 WBA21BY0907N23883 ohne Termin.
2025-11-12 10:16:59,262 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,277 - ispa_next.appointments.models - DEBUG - Appointment Daniel Raphael ED-RD 212 WBA6T510607D45067 ohne Termin.
2025-11-12 10:16:59,292 - ispa_next.appointments.models - DEBUG - Appointment Firma Bucher Hydraulics Erding GmbH ED-BH 186 WBA5V7105LFH57377 ohne Termin.
2025-11-12 10:16:59,305 - ispa_next.appointments.models - DEBUG - Appointment Katerina Werner M-W 7091 WBA11EV0809V62969 ohne Termin.
2025-11-12 10:16:59,311 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,325 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Friedl ED-SE 225 WBA61CA0X09V93186 ohne Termin.
2025-11-12 10:16:59,334 - ispa_next.appointments.models - DEBUG - Appointment Harald Kümmet ED-H 110 WMWSS91020WN99113 ohne Termin.
2025-11-12 10:16:59,341 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,360 - ispa_next.appointments.models - DEBUG - Appointment Josefine Hintermeier ED-AD 71 WMWZM31080T767604 ohne Termin.
2025-11-12 10:16:59,372 - ispa_next.appointments.models - DEBUG - Appointment Thomas Ralf Olaf Buer ED-B 880 5UXWX7C54EL983484 ohne Termin.
2025-11-12 10:16:59,379 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,393 - ispa_next.appointments.models - DEBUG - Appointment Alen Halidowicz ED-HA 910 WBA6E41080G692725 ohne Termin.
2025-11-12 10:16:59,412 - ispa_next.appointments.models - DEBUG - Appointment Martina Bauer ED-Z 1988 WBADS41020GU95176 ohne Termin.
2025-11-12 10:16:59,426 - ispa_next.appointments.models - DEBUG - Appointment Ludwig Schönhuber FS-M 2909 WBAHF31040WX45135 ohne Termin.
2025-11-12 10:16:59,427 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,438 - ispa_next.appointments.models - DEBUG - Appointment Alois Obermaier ED-AO 67 WBA35BG040N074618 ohne Termin.
2025-11-12 10:16:59,451 - ispa_next.appointments.models - DEBUG - Appointment Karl-Heinz Baris ED-JA 828 WBA8J91020A190670 ohne Termin.
2025-11-12 10:16:59,462 - ispa_next.appointments.models - DEBUG - Appointment Rainer Wieder FS-RW 606 WBAJP310X0CD36205 ohne Termin.
2025-11-12 10:16:59,464 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,477 - ispa_next.appointments.models - DEBUG - Appointment Firma Büro der Fachärzte ED-BF 811 WBAPY71050C023350 ohne Termin.
2025-11-12 10:16:59,505 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Wildried Rademann ED-JR 900 WBAJP31030BT83692 ohne Termin.
2025-11-12 10:16:59,516 - ispa_next.appointments.models - DEBUG - Appointment Markus Christian Geyer M-CG 3388 WBA3Z910X0D367242 ohne Termin.
2025-11-12 10:16:59,531 - ispa_next.appointments.models - DEBUG - Appointment Levente Gergely ED-GL 71 WBA4X31050AA80192 ohne Termin.
2025-11-12 10:16:59,544 - ispa_next.appointments.models - DEBUG - Appointment Markus Kerndlbacher ED-MK 135 WBAUC71000VE99305 ohne Termin.
2025-11-12 10:16:59,578 - ispa_next.appointments.models - DEBUG - Appointment Firma VR-Bank Erding eG ED-VR 530 WBA5D31040GV81033 ohne Termin.
2025-11-12 10:16:59,596 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Scheid ED-P 1307 WBATX35020NC37837 ohne Termin.
2025-11-12 10:16:59,607 - ispa_next.appointments.models - DEBUG - Appointment Jakob Angermaier ED-AJ 44 WBAHS910105F51976 ohne Termin.
2025-11-12 10:16:59,617 - ispa_next.appointments.models - DEBUG - Appointment Almperto Kyriazis ED-AK 1994 WBA1A11020J903022 ohne Termin.
2025-11-12 10:16:59,627 - ispa_next.appointments.models - DEBUG - Appointment Firma Cleaning Express Gebäudedienst ED-BS 887 WBA41BX0707N24573 ohne Termin.
2025-11-12 10:16:59,652 - ispa_next.appointments.models - DEBUG - Appointment Bianca-Viviana Huber FS-H 162 E WBY8P210507H82040 ohne Termin.
2025-11-12 10:16:59,666 - ispa_next.appointments.models - DEBUG - Appointment Katharina Eichinger ED-LE 236 WMW11BR0903N74463 ohne Termin.
2025-11-12 10:16:59,685 - ispa_next.appointments.models - DEBUG - Appointment Firma BayWa Aktiengesellschaft M-GH 7766 WBA15BZ000N166569 ohne Termin.
2025-11-12 10:16:59,699 - ispa_next.appointments.models - DEBUG - Appointment Firma Privatbr. ERDINGER Weißbräu ED-EW 332 WBA41EG0005X82947 ohne Termin.
2025-11-12 10:16:59,700 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:59,714 - ispa_next.appointments.models - DEBUG - Appointment Carmen Berndt ED-CP 1725 WBAYN110X05T94356 ohne Termin.
2025-11-12 10:16:59,730 - ispa_next.appointments.models - DEBUG - Appointment Luigi Fazio  WBAKS410500C30478 ohne Termin.
2025-11-12 10:16:59,743 - ispa_next.appointments.models - DEBUG - Appointment Zhensheng Guo ED-SG 8888 WBA5L31030G122160 ohne Termin.
2025-11-12 10:16:59,759 - ispa_next.appointments.models - DEBUG - Appointment Christine Ertel ED-C 1272 WMW31DH0802W00594 ohne Termin.
2025-11-12 10:16:59,781 - ispa_next.appointments.models - DEBUG - Appointment Daniel Franke LA-EB 308 WBA1V71070V616601 ohne Termin.
2025-11-12 10:16:59,796 - ispa_next.appointments.models - DEBUG - Appointment Paul Valerian Mona MM 23 MON WBA5E51090G100007 ohne Termin.
2025-11-12 10:16:59,807 - ispa_next.appointments.models - DEBUG - Appointment Eduard Gehl FS-EG 174 WBAJN31090B095696 ohne Termin.
2025-11-12 10:16:59,817 - ispa_next.appointments.models - DEBUG - Appointment Firma Lear Corporation GmbH GG-LC 292E WBA81CY000FS44344 ohne Termin.
2025-11-12 10:16:59,846 - ispa_next.main - DEBUG - Found 20 out of 148 appointments to process (configured limit: 20).
2025-11-12 10:16:59,847 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-12 10:16:59,847 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 10:16:59,847 - ispa_next.main - DEBUG - All appointments: ED-VJ 188 E, FS-MS 633, ED-C 2407, ED-RG133, ED-DY 9 E, OD-MX 9040, ED M 2304, ED-AN 96, ED RU 101, MNK3076, ED-MH-171, ED-A1024, ED-K2010, ED-AL59, M-ED-2001, EBE-AB 202, ED-CT 178, ED-O 1909, ED-RD 212, ED-WI 283
2025-11-12 10:16:59,850 - ispa_next.main - DEBUG - 



2025-11-12 10:16:59,850 - ispa_next.main - DEBUG - starting with process 1 (ED-VJ 188 E) of 20
2025-11-12 10:16:59,855 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:00,644 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:01,387 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:17:01,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 345
2025-11-12 10:17:02,496 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:02,497 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:32,040 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:17:32,118 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:17:32,124 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:32,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:17:32,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:34,429 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:17:34,430 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:35,131 - ispa_next.main - DEBUG - 



2025-11-12 10:17:35,131 - ispa_next.main - DEBUG - starting with process 2 (FS-MS 633) of 20
2025-11-12 10:17:35,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:17:36,028 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:17:37,159 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:17:37,160 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:17:38,289 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:17:38,290 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:06,414 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:18:06,428 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:18:06,434 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:18:06,941 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:18:06,942 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:18:09,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:18:09,260 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:10,074 - ispa_next.main - DEBUG - 



2025-11-12 10:18:10,074 - ispa_next.main - DEBUG - starting with process 3 (ED-C 2407) of 20
2025-11-12 10:18:10,079 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:18:11,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:18:12,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:18:12,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:18:13,830 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:18:13,832 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:18:34,421 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:18:44,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:45,544 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:18:45,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:45,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:18:45,789 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:18:51,904 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:18:51,908 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:18:54,703 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:54,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:55,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:57,769 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:19:02,903 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 10:19:09,131 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 10:19:10,137 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:19:10,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:10,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:24,098 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:19:31,467 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:19:31,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:31,597 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:19:31,598 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:19:31,632 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:19:31,736 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:19:32,860 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:19:34,124 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:19:34,414 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:19:37,342 - ispa_next.functions - DEBUG - Updated appointment (AA00022436) customer contact data.
2025-11-12 10:19:38,291 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:19:38,293 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:19:38,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:39,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:19:40,563 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:19:40,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:19:40,663 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:19:44,694 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:19:44,694 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:19:44,694 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:19:44,698 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:19:44,703 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:19:44,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:45,223 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:45,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:46,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:46,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:46,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:46,955 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:19:48,377 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:19:48,409 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:19:49,706 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:19:49,707 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:49,708 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:19:49,709 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:49,710 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:19:49,711 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:19:49,712 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:19:49,713 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:19:49,714 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:19:49,715 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:19:49,718 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:19:49,721 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:19:49,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:50,882 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:19:50,885 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:19:50,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:52,093 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:19:52,095 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:19:52,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:19:52,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:19:52,767 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:19:52,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:53,952 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:20:04,346 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:20:04,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:05,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:20:05,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:16,501 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:20:16,503 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:20:16,504 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:16,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:17,063 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:20:17,066 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:20:18,491 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:20:26,717 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:20:27,092 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:20:27,276 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:28,925 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:20:28,926 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:31,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:20:31,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:20:32,603 - ispa_next.main - DEBUG - 



2025-11-12 10:20:32,603 - ispa_next.main - DEBUG - starting with process 4 (ED-RG133) of 20
2025-11-12 10:20:32,607 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:33,763 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:34,626 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:20:34,627 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:20:35,743 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:20:35,744 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:04,897 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:21:04,908 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:21:04,913 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:05,326 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:21:05,326 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:07,273 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:21:07,273 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:07,907 - ispa_next.main - DEBUG - 



2025-11-12 10:21:07,907 - ispa_next.main - DEBUG - starting with process 5 (ED-DY 9 E) of 20
2025-11-12 10:21:07,913 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:08,768 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:09,585 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:21:09,589 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:21:10,746 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:10,747 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:40,929 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:21:40,939 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:21:40,944 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:41,375 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:21:41,376 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:43,854 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:21:43,854 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:44,729 - ispa_next.main - DEBUG - 



2025-11-12 10:21:44,730 - ispa_next.main - DEBUG - starting with process 6 (OD-MX 9040) of 20
2025-11-12 10:21:44,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:45,808 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:46,690 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:21:46,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:21:47,897 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:47,898 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:10,093 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:22:19,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:21,687 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:22:21,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:21,746 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:21,911 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:22:21,913 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:22:24,641 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:24,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:25,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:27,627 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:22:27,725 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:22:30,938 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:22:31,004 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:22:31,005 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:22:39,242 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:22:40,247 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:22:40,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:40,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:51,410 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:22:58,608 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:22:58,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:58,710 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:58,711 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:22:58,754 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:23:00,013 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:23:00,243 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:23:03,092 - ispa_next.functions - DEBUG - Updated appointment (AA00022405) customer contact data.
2025-11-12 10:23:03,999 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:23:04,002 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:23:04,801 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:23:04,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:23:05,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:23:09,464 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 10:23:09,464 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:09,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:10,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:12,012 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:23:12,104 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:23:12,223 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:23:12,287 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:23:12,288 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:23:23,825 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:23:27,947 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:23:27,947 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:23:32,096 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:23:33,104 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:23:33,110 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:23:33,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:33,232 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:23:38,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:39,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:39,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:40,151 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:40,152 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:23:42,062 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:23:42,064 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:23:43,160 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:23:43,161 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:23:43,163 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:23:43,164 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:23:43,171 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:23:43,178 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:23:43,181 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:23:43,183 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:23:43,185 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:23:43,187 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:23:43,192 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:23:43,196 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:23:43,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:45,086 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:23:45,090 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:23:45,091 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:46,949 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:23:46,951 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:23:46,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:23:47,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:23:47,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:56,217 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:23:56,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:58,105 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:24:08,819 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:24:09,314 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:09,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:24:09,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:27,683 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:31,586 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:31,588 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:24:31,589 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:32,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:32,120 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:24:32,122 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:24:33,543 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:24:40,914 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:24:41,308 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:24:41,602 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:43,135 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:24:43,136 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:45,640 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:24:45,641 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:24:46,329 - ispa_next.main - DEBUG - 



2025-11-12 10:24:46,329 - ispa_next.main - DEBUG - starting with process 7 (ED M 2304) of 20
2025-11-12 10:24:46,333 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:47,168 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:48,073 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:24:48,074 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:24:49,188 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:49,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:19,447 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:25:19,457 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:25:19,462 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:19,907 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:25:19,908 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:22,221 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:25:22,222 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:23,050 - ispa_next.main - DEBUG - 



2025-11-12 10:25:23,050 - ispa_next.main - DEBUG - starting with process 8 (ED-AN 96) of 20
2025-11-12 10:25:23,054 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:24,167 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:25,283 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:25:25,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:25:26,732 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:26,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:49,933 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:26:00,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:03,350 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:26:03,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:03,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:03,646 - ispa_next.functions - DEBUG - HU date already expired after 169 days.
2025-11-12 10:26:10,879 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:26:10,882 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:26:13,644 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:26:13,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:14,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:16,705 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:26:16,843 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:26:20,079 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:26:20,144 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:26:20,144 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:26:28,961 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:26:29,967 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:26:29,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:30,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:41,661 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:26:49,120 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:26:49,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:49,202 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:49,203 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:26:49,250 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:26:50,514 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:26:51,603 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:26:51,810 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:26:54,626 - ispa_next.functions - DEBUG - Updated appointment (AA00022344) customer contact data.
2025-11-12 10:26:55,529 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:26:55,553 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:26:56,382 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:26:56,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:26:57,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:27:00,850 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:27:00,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:01,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:27:03,342 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:27:03,513 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:27:03,648 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:27:03,712 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:27:03,713 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:27:12,028 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:28:12,031 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:28:23,064 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 10:28:27,301 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:28:27,302 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:28:29,441 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:28:30,448 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:28:30,452 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:28:30,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:30,533 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:28:30,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:31,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:31,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:28:32,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:28:32,247 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:28:35,244 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:28:35,245 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:28:36,081 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:28:36,082 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:28:36,083 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:28:36,084 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:28:36,085 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:28:36,086 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:28:36,087 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:28:36,088 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:28:36,089 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:28:36,090 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:28:36,093 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:28:36,095 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:28:36,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:39,433 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:28:42,122 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:28:42,125 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:28:42,126 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:45,416 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:28:45,419 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:28:45,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:28:46,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:28:46,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:56,851 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:28:56,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:00,157 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:29:10,285 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:29:10,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:29:11,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:29:11,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:28,607 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:29:28,608 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:29:29,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:29:29,293 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:29:29,296 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:29:32,061 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:29:38,432 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:29:38,806 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:29:39,169 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:29:40,931 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:29:40,932 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:29:43,837 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:29:43,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:44,787 - ispa_next.main - DEBUG - 



2025-11-12 10:29:44,787 - ispa_next.main - DEBUG - starting with process 9 (ED RU 101) of 20
2025-11-12 10:29:44,793 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:29:45,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:29:47,189 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:29:47,191 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:29:48,662 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:29:48,663 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:31,309 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:30:31,320 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:30:31,324 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:31,849 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:30:31,850 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:34,530 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:30:34,531 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:30:35,383 - ispa_next.main - DEBUG - 



2025-11-12 10:30:35,383 - ispa_next.main - DEBUG - starting with process 10 (MNK3076) of 20
2025-11-12 10:30:35,388 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:30:36,498 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:30:37,700 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:30:37,702 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:30:39,154 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:30:39,155 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:11,507 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:31:11,516 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:31:11,519 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:11,816 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:31:11,817 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:13,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:31:13,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:14,486 - ispa_next.main - DEBUG - 



2025-11-12 10:31:14,486 - ispa_next.main - DEBUG - starting with process 11 (ED-MH-171) of 20
2025-11-12 10:31:14,492 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:15,316 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:16,326 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:31:16,327 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:31:17,773 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:17,775 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:49,811 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:31:49,821 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:31:49,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:50,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:31:50,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:52,951 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:31:52,951 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:53,754 - ispa_next.main - DEBUG - 



2025-11-12 10:31:53,755 - ispa_next.main - DEBUG - starting with process 12 (ED-A1024) of 20
2025-11-12 10:31:53,759 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:54,833 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:56,170 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:31:56,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:31:57,525 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:57,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:28,177 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:32:28,194 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:32:28,198 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:28,492 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:32:28,494 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:32:30,838 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:32:30,838 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:32:31,672 - ispa_next.main - DEBUG - 



2025-11-12 10:32:31,672 - ispa_next.main - DEBUG - starting with process 13 (ED-K2010) of 20
2025-11-12 10:32:31,677 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:32:32,833 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:32:33,952 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:32:33,953 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:32:35,387 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:32:35,388 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:06,334 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:33:06,346 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:33:06,350 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:06,644 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:33:06,645 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:08,817 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:33:08,817 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:09,682 - ispa_next.main - DEBUG - 



2025-11-12 10:33:09,682 - ispa_next.main - DEBUG - starting with process 14 (ED-AL59) of 20
2025-11-12 10:33:09,686 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:33:10,756 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:11,676 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:33:11,677 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:33:12,934 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:12,935 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:40,965 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:33:40,975 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:33:40,980 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:41,393 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:33:41,395 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:44,082 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:33:44,083 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:44,899 - ispa_next.main - DEBUG - 



2025-11-12 10:33:44,899 - ispa_next.main - DEBUG - starting with process 15 (M-ED-2001) of 20
2025-11-12 10:33:44,903 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:33:45,996 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:47,037 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:33:47,038 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:33:48,227 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:48,228 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:34:19,887 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:34:19,907 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:34:19,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:20,247 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:34:20,248 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:22,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:34:22,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:34:22,786 - ispa_next.main - DEBUG - 



2025-11-12 10:34:22,786 - ispa_next.main - DEBUG - starting with process 16 (EBE-AB 202) of 20
2025-11-12 10:34:22,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:34:23,606 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:24,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:34:24,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-12 10:34:25,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:25,596 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:34:46,653 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:34:48,453 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:34:52,984 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:54,208 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:34:54,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:54,277 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:34:54,416 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:34:54,420 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:34:57,132 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:34:57,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:58,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:00,126 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:35:00,263 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:35:00,350 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:35:00,429 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:35:04,591 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:35:05,597 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:35:05,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:06,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:16,739 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:35:16,740 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:35:20,580 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:35:20,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:20,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:20,653 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:35:20,684 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:35:20,828 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:35:22,100 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:35:22,366 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:35:24,346 - ispa_next.functions - DEBUG - Updated appointment (AB00024097) customer contact data.
2025-11-12 10:35:25,256 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:35:25,259 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:35:25,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:35:26,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:35:27,093 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:35:27,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:35:27,167 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:35:31,293 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 10:35:31,293 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:35:31,293 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:35:31,298 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:35:31,303 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:35:31,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:31,822 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:32,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:32,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:32,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:33,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:33,527 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:35:34,878 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:35:34,880 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:35:36,409 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:35:36,414 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:35:36,417 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:35:36,419 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:35:36,421 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:35:36,422 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:35:36,423 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:35:36,424 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:35:36,425 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:35:36,427 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:35:36,430 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:35:36,433 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:35:36,434 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:37,639 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:35:37,641 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:35:37,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:38,876 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:35:38,878 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:35:38,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:35:39,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:35:40,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:47,872 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:35:47,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:49,124 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:35:59,786 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:36:00,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:36:00,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:36:00,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:36:12,076 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:36:12,082 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:36:12,082 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:36:12,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:36:12,715 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:36:12,717 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:36:14,455 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:36:20,907 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:36:21,302 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 10:36:21,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:23,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:36:23,590 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:26,358 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 10:36:26,358 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:36:27,358 - ispa_next.main - DEBUG - 



2025-11-12 10:36:27,359 - ispa_next.main - DEBUG - starting with process 17 (ED-CT 178) of 20
2025-11-12 10:36:27,365 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:36:28,506 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:29,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:36:29,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 10:36:31,184 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:31,186 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:36:50,429 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:36:52,453 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:36:57,469 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:36:59,328 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:36:59,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:59,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:59,609 - ispa_next.functions - DEBUG - HU date already expired after 591 days.
2025-11-12 10:37:03,569 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:37:03,573 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:37:06,326 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:37:06,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:37:07,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:37:09,274 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:37:09,411 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:37:09,494 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:37:09,635 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:37:13,809 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:37:14,815 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:37:14,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:15,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:25,709 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:37:28,870 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:37:28,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:28,969 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:37:28,970 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:37:29,022 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:37:29,110 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:37:30,186 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:37:31,368 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:37:31,632 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:37:33,190 - ispa_next.functions - DEBUG - Updated appointment (AB00024324) customer contact data.
2025-11-12 10:37:34,107 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:37:34,110 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:37:34,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:37:34,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:37:36,123 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:37:36,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:37:36,219 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:37:40,247 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:37:40,247 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:37:40,251 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:37:40,255 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:37:40,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:37:40,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:37:41,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:41,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:41,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:37:42,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:37:42,413 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:37:44,304 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:37:44,306 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:37:45,548 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:37:45,551 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:37:45,552 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:37:45,555 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:37:45,556 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:37:45,557 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:37:45,558 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:37:45,560 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:37:45,577 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:37:45,579 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:37:45,583 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:37:45,586 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:37:45,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:47,469 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:37:47,472 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:37:47,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:49,326 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:37:49,329 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:37:49,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:37:50,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:37:50,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:59,507 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:37:59,510 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:01,421 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:38:12,011 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:38:12,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:38:13,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:38:13,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:30,953 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:38:34,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:38:34,996 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:38:34,997 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:38:35,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:38:35,650 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:38:35,652 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:38:37,521 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:38:44,450 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:38:44,832 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 10:38:45,214 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:38:47,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:38:47,138 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:38:49,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 10:38:49,948 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:38:50,737 - ispa_next.main - DEBUG - 



2025-11-12 10:38:50,737 - ispa_next.main - DEBUG - starting with process 18 (ED-O 1909) of 20
2025-11-12 10:38:50,742 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:38:51,834 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:38:52,692 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:38:52,693 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 10:38:53,911 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:38:53,912 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:39:16,458 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:39:17,947 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:39:22,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:27,899 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:39:27,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:39:27,994 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:39:28,169 - ispa_next.functions - DEBUG - HU date already expired after 13 days.
2025-11-12 10:39:31,708 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:39:31,712 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:39:34,487 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:39:34,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:39:35,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:39:37,972 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:39:38,107 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:39:38,215 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:39:38,281 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:39:40,431 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:39:41,436 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:39:41,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:39:41,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:39:45,095 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 10:39:45,100 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:39:45,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:39:45,200 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:39:45,201 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:39:45,244 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:39:46,469 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:39:47,677 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:39:47,891 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:39:49,673 - ispa_next.functions - DEBUG - Updated appointment (AA00022415) customer contact data.
2025-11-12 10:39:50,590 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:39:50,663 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:39:51,753 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:39:51,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:39:52,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:39:56,250 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:39:56,250 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:39:56,254 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:39:56,258 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:39:56,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:39:56,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:40:06,293 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:40:13,426 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:40:13,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:14,331 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:40:14,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:40:15,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:40:15,133 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:40:19,915 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:40:19,917 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:40:21,013 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:40:21,015 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:40:21,016 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:40:21,017 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:40:21,019 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:40:21,021 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:40:21,022 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:40:21,023 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:40:21,024 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:40:21,026 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:40:21,029 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:40:21,032 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:40:21,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:40:26,421 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:40:26,423 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:40:26,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:40:31,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:40:31,858 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:40:41,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:40:55,816 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:40:55,819 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:40:55,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:40:56,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:40:56,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:09,557 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:41:09,558 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:14,885 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:41:25,067 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:41:25,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:41:26,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:41:26,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:43,229 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:41:43,230 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:41:43,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:41:43,923 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:41:43,925 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:41:47,031 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:41:55,015 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:41:55,393 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 10:41:56,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:41:57,302 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:41:57,304 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:42:00,314 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 10:42:00,314 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:42:01,152 - ispa_next.main - DEBUG - 



2025-11-12 10:42:01,152 - ispa_next.main - DEBUG - starting with process 19 (ED-RD 212) of 20
2025-11-12 10:42:01,169 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:42:02,348 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:42:03,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:42:03,589 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 10:42:04,980 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:42:04,982 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:42:28,701 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:42:30,830 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:42:35,934 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:38,541 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:42:38,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:38,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:42:38,884 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:42:38,888 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:42:41,807 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:42:41,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:43,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:45,022 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:42:45,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:42:45,270 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:42:45,335 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:42:49,524 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:42:50,533 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:42:50,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:51,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:02,154 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:43:05,952 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:43:05,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:06,039 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:43:06,039 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:43:06,071 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:43:06,175 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:43:07,277 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:43:07,474 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:43:09,658 - ispa_next.functions - DEBUG - Updated appointment (AB00024344) customer contact data.
2025-11-12 10:43:10,620 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:43:10,624 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:43:10,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:43:11,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:43:12,672 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:43:12,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:43:12,745 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:43:16,374 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:43:16,375 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:43:16,380 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:43:16,384 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:43:16,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:16,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:43:17,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:17,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:43:17,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:43:18,473 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:43:18,474 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:43:21,013 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:43:21,015 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:43:22,387 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:43:22,388 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:43:22,390 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:43:22,391 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:43:22,392 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:43:22,393 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:43:22,394 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:43:22,395 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:43:22,396 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:43:22,397 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:43:22,400 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:43:22,402 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:43:22,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:24,984 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:43:24,987 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:43:24,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:27,537 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:43:27,540 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:43:27,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:43:28,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:43:28,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:37,734 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:43:37,735 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:40,397 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:43:51,854 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:43:52,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:43:52,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:43:53,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:44:17,366 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:21,397 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:25,839 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:25,842 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:44:25,843 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:44:26,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:44:26,528 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:44:26,529 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:44:28,078 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:44:35,499 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:44:35,891 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 10:44:36,361 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:44:37,542 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:44:37,543 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:44:40,448 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 369
2025-11-12 10:44:40,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:44:41,221 - ispa_next.main - DEBUG - 



2025-11-12 10:44:41,222 - ispa_next.main - DEBUG - starting with process 20 (ED-WI 283) of 20
2025-11-12 10:44:41,226 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:44:42,462 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:44:43,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 537
2025-11-12 10:44:43,704 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 369
2025-11-12 10:44:45,287 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:44:45,288 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:45:07,233 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:45:09,857 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:45:17,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:45:20,087 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:45:20,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:20,188 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:20,330 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:45:20,333 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:45:23,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:45:23,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:45:24,376 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:45:26,382 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:45:26,476 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:45:26,601 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:45:26,704 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:45:30,865 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:45:31,872 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:45:31,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:32,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:45,823 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:45:49,501 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:45:49,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:45:49,585 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:45:49,586 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:45:49,629 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:45:49,742 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:45:50,904 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:45:51,113 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:45:52,807 - ispa_next.functions - DEBUG - Updated appointment (AB00024334) customer contact data.
2025-11-12 10:45:53,792 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:45:53,795 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:45:53,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:54,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:45:55,796 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:45:55,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:45:55,879 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:45:59,497 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:45:59,497 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:45:59,501 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:45:59,504 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:45:59,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:00,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:00,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:00,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:46:00,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:46:01,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:46:01,637 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:46:04,131 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:46:04,132 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:46:05,637 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:46:05,638 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:46:05,639 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:46:05,640 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:46:05,642 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:46:05,643 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:46:05,644 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:46:05,645 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:46:05,646 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:46:05,647 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:46:05,651 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:46:05,654 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:46:05,654 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:08,593 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:46:08,596 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:46:08,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:11,137 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:46:11,139 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:46:11,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:46:11,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:46:12,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:22,102 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:46:22,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:46:24,677 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:46:35,878 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:46:36,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:46:36,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:46:37,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:47:02,331 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:06,762 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:11,187 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:47:11,190 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:47:11,191 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:47:11,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:47:11,912 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:47:11,914 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:47:13,622 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:47:21,145 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:47:21,546 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 10:47:21,926 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:47:24,227 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 538
2025-11-12 10:47:24,229 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:47:27,728 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-12 10:47:27,729 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:47:28,603 - ispa_next.appointments.models - DEBUG - Appointment Firma Microsoft Deutschland GmbH M-MS 4382 WBY61EF0105287393 ohne Termin.
