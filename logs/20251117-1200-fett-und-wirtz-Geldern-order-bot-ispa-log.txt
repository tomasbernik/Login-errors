2025-11-17 12:00:47,295 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:00:47,331 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:01:02,345 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:01:14,038 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:01:29,635 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:01:54,348 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:02:15,690 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:02:18,139 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:02:19,283 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 323
2025-11-17 12:02:19,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 12:02:21,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 12:02:21,955 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:02:21,955 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:02:23,077 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:02:24,208 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:02:58,238 - ispa_next.appointments.models - DEBUG - Appointment Lothar Horst Bigge GEL-LB 228 WBA5R11020AK33448 ohne Termin.
2025-11-17 12:02:58,248 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hindrichs MO-FH 714 WBAJP31060BT92743 ohne Termin.
2025-11-17 12:02:58,256 - ispa_next.appointments.models - DEBUG - Appointment Rainer Nellessen GEL-C 308 WMW21BR0603P29202 ohne Termin.
2025-11-17 12:02:58,264 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 12:02:58,271 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 12:02:58,279 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 12:02:58,286 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 12:02:58,293 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 12:02:58,300 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 12:02:58,311 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 12:02:58,331 - ispa_next.appointments.models - DEBUG - Appointment Dieter Schiller KLE-CS 99 WBAJG110X03G82050 ohne Termin.
2025-11-17 12:02:58,338 - ispa_next.appointments.models - DEBUG - Appointment Heinz Theo Fürtjes GEL-F 198E WBY71AW020FR87494 ohne Termin.
2025-11-17 12:02:58,347 - ispa_next.appointments.models - DEBUG - Appointment Margarete Hildegard Karla Fischer GEL-F 323E WBY8P210407K09904 ohne Termin.
2025-11-17 12:02:58,354 - ispa_next.appointments.models - DEBUG - Appointment Schloots GEL-RS 30 WBA8H91070A722054 ohne Termin.
2025-11-17 12:02:58,361 - ispa_next.appointments.models - DEBUG - Appointment Anastasia Huwald KLE-A 1413 WBA1V710805N01313 ohne Termin.
2025-11-17 12:02:58,368 - ispa_next.appointments.models - DEBUG - Appointment Samir Mougawaz KLE-JS 813 WBA2D710105C40715 ohne Termin.
2025-11-17 12:02:58,383 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:02:58,408 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-17 12:02:58,418 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-17 12:02:58,432 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-17 12:02:58,440 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-17 12:02:58,441 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:02:58,444 - ispa_next.main - DEBUG - Found 2 out of 9 appointments to process (configured limit: 15).
2025-11-17 12:02:58,444 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-17 12:02:58,444 - ispa_next.main - DEBUG - All appointments: M-D-3722, KK-B 602
2025-11-17 12:02:58,446 - ispa_next.main - DEBUG - 



2025-11-17 12:02:58,446 - ispa_next.main - DEBUG - starting with process 1 (M-D-3722) of 2
2025-11-17 12:02:58,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:02:59,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:03:00,121 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 323
2025-11-17 12:03:00,122 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 12:03:01,306 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:03:01,307 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:03:32,076 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:03:40,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:45,545 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:03:45,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:45,636 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:03:45,805 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:03:45,807 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:03:45,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:45,885 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:03:48,997 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:03:48,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:49,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:03:51,837 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:03:51,956 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:03:52,076 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:03:52,159 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:03:52,160 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:04:03,280 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:04:04,283 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:04:04,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:04:04,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:04:18,557 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:04:25,036 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:04:25,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:04:25,133 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:04:25,134 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:04:25,183 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:04:26,322 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:04:27,327 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:04:27,565 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:04:29,448 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:04:29,448 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:04:30,228 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:04:30,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:04:30,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:04:34,576 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:04:34,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:04:35,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:04:37,061 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:04:37,198 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:04:37,280 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:04:37,376 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:04:37,377 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:04:48,794 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:04:56,356 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:04:56,356 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:04:58,486 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:04:59,523 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:04:59,526 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:04:59,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:04:59,600 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:05:05,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:05,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:05,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:06,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:06,369 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:05:10,531 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:05:10,533 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:05:11,598 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:05:11,599 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:05:11,603 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 12:05:11,604 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:05:11,607 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:05:11,615 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:05:11,620 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:05:11,624 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:05:11,626 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:05:11,630 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:05:11,633 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:05:12,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:05:13,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:05:20,068 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:05:20,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:05:20,070 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:05:20,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:25,461 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:05:25,462 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:05:25,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:30,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:31,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:40,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:55,653 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:05:55,654 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:05:55,655 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:05:55,671 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:01,138 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 12:06:09,538 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:06:22,347 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:06:23,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:06:23,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:06:24,030 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:32,915 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:06:38,971 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:06:38,972 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:06:39,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:06:39,800 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:06:39,801 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:06:43,562 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:06:48,534 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:06:51,568 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:06:51,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:06:51,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 324
2025-11-17 12:06:51,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:06:54,890 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 12:06:54,892 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:06:55,765 - ispa_next.appointments.models - DEBUG - Appointment Lothar Horst Bigge GEL-LB 228 WBA5R11020AK33448 ohne Termin.
2025-11-17 12:06:55,771 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hindrichs MO-FH 714 WBAJP31060BT92743 ohne Termin.
2025-11-17 12:06:55,776 - ispa_next.appointments.models - DEBUG - Appointment Rainer Nellessen GEL-C 308 WMW21BR0603P29202 ohne Termin.
2025-11-17 12:06:55,864 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 12:06:55,871 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 12:06:55,878 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 12:06:55,882 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 12:06:55,899 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 12:06:55,928 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 12:06:55,935 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
2025-11-17 12:06:55,937 - ispa_next.main - DEBUG - 



2025-11-17 12:06:55,937 - ispa_next.main - DEBUG - starting with process 2 (KK-B 602) of 2
2025-11-17 12:06:55,943 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:06:57,058 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:06:58,070 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 324
2025-11-17 12:06:58,071 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 213
2025-11-17 12:06:59,494 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:06:59,496 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:07:26,931 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:07:39,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:48,729 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:07:48,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:07:48,790 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:07:49,011 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:07:49,012 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:07:49,013 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:07:49,078 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:07:52,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:07:52,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:07:53,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:07:55,131 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:07:55,346 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:07:55,446 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:07:55,532 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:07:55,533 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:08:06,926 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:08:07,930 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:08:07,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:08,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:21,115 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:08:29,367 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:08:29,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:08:29,452 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:08:29,453 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:08:29,507 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:08:30,751 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:08:31,914 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:08:32,189 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:08:35,217 - ispa_next.functions - DEBUG - Updated appointment (AA00073898) customer contact data.
2025-11-17 12:08:36,130 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:08:36,133 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:08:37,206 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:08:37,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:08:37,862 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:08:41,448 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:08:41,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:08:41,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:08:43,956 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:08:44,084 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:08:44,189 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:08:44,270 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:08:44,270 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:08:55,138 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:09:02,389 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:09:02,389 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:09:06,603 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:09:07,621 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:09:07,624 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:09:07,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:07,706 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:09:13,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:13,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:13,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:14,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:14,561 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:09:22,161 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:09:22,163 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:09:23,159 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:09:23,160 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:09:23,164 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 12:09:23,164 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:09:23,168 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:09:23,170 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:09:23,172 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:09:23,178 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:09:23,179 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:09:23,182 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:09:23,183 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:09:23,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:09:24,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:09:31,280 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:09:31,281 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:09:31,282 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:09:31,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:40,757 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:09:40,759 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:09:40,761 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:50,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:50,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:10:02,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:21,179 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:10:21,180 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:10:21,181 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:10:21,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:30,670 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 12:10:38,568 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:10:51,725 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:10:52,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:10:52,997 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:10:53,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:03,919 - ispa_next.common.utils - DEBUG - Attempt 1/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 12:11:03,919 - ispa_next.common.utils - DEBUG - Attempt 1/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 1.0s
2025-11-17 12:11:06,402 - ispa_next.common.utils - DEBUG - Attempt 2/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 12:11:06,402 - ispa_next.common.utils - DEBUG - Attempt 2/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 2.0s
2025-11-17 12:11:09,797 - ispa_next.common.utils - DEBUG - Attempt 3/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 12:11:09,797 - ispa_next.common.utils - DEBUG - Attempt 3/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 4.0s
2025-11-17 12:11:15,345 - ispa_next.common.utils - DEBUG - Attempt 4/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 12:11:15,345 - ispa_next.common.utils - DEBUG - Attempt 4/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 8.0s
2025-11-17 12:11:24,694 - ispa_next.common.utils - DEBUG - Attempt 5/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 12:11:24,694 - ispa_next.common.utils - DEBUG - Attempt 5/6: Retrying action 'open_job_details_view' with condition 'job_details_view_exists' with delay: 16.0s
2025-11-17 12:11:41,877 - ispa_next.common.utils - DEBUG - Attempt 6/6: Condition 'job_details_view_exists' for retry_ui_action 'open_job_details_view' not satisfied
2025-11-17 12:11:43,157 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 126, in process_appointment
    f.check_cart_packages_for_parts_service_and_parts_availability(app, appointment, state)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\functions.py", line 390, in check_cart_packages_for_parts_service_and_parts_availability
    retry_ui_action(open_job_details_view, condition=job_details_view_exists, base_delay=1.0)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\utils.py", line 254, in retry_ui_action
    raise RetryUiActionError(f"UI action failed after {max_attempts} attempts: Condition never satisfied")
ispa_next.exceptions.RetryUiActionError: UI action failed after 6 attempts: Condition never satisfied

2025-11-17 12:11:43,907 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:11:43,907 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:11:44,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:11:44,688 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:11:44,689 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:11:44,721 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:11:48,118 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:11:48,120 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:11:48,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 324
2025-11-17 12:11:48,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:11:51,963 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 213
2025-11-17 12:11:51,964 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:11:52,758 - ispa_next.appointments.models - DEBUG - Appointment Lothar Horst Bigge GEL-LB 228 WBA5R11020AK33448 ohne Termin.
2025-11-17 12:11:52,763 - ispa_next.appointments.models - DEBUG - Appointment Matthias Hindrichs MO-FH 714 WBAJP31060BT92743 ohne Termin.
2025-11-17 12:11:52,770 - ispa_next.appointments.models - DEBUG - Appointment Rainer Nellessen GEL-C 308 WMW21BR0603P29202 ohne Termin.
2025-11-17 12:11:52,777 - ispa_next.appointments.models - DEBUG - Appointment Fett & Wirtz Automobile GmbH & Co KG  WBA31AA0405U99268 ohne Termin.
2025-11-17 12:11:52,783 - ispa_next.appointments.models - DEBUG - Appointment Lemken GmbH & Co. KG WES-LP 22 WBA11GR0209073487 ohne Termin.
2025-11-17 12:11:52,788 - ispa_next.appointments.models - DEBUG - Appointment Franz-Josef Keysers GEL-K 476 WBAHS910903D24093 ohne Termin.
2025-11-17 12:11:52,794 - ispa_next.appointments.models - DEBUG - Appointment Move-Autovermietung GmbH MO-VE 157 WBA7K310907M90550 ohne Termin.
2025-11-17 12:11:52,800 - ispa_next.appointments.models - DEBUG - Appointment Le-Laden KLE-MY 369 WBATB410409E68337 ohne Termin.
2025-11-17 12:11:52,807 - ispa_next.appointments.models - DEBUG - Appointment Benjamin Wienkamp KLE-W 1982 WBY71EG0905194432 ohne Termin.
2025-11-17 12:11:52,814 - ispa_next.appointments.models - DEBUG - Appointment Klaus-Peter Strechel KLE-PR 281 WBA3A11080J281468 ohne Termin.
