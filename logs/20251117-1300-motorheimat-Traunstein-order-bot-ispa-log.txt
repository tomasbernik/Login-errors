2025-11-17 13:14:36,321 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:14:36,370 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:14:46,637 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:14:56,974 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:15:12,753 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:17:12,004 - ispa_next.app_start.main - DEBUG - Operation already took 107.80 seconds (more than 80 seconds)
2025-11-17 13:17:14,115 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess__h0bcakg_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess__h0bcakg', 'txt']
2025-11-17 13:17:14,461 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:17:14,467 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:17:14,468 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:19:13,583 - ispa_next.app_start.main - DEBUG - Operation already took 106.73 seconds (more than 80 seconds)
2025-11-17 13:19:15,670 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess_7xxlz5ns_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess_7xxlz5ns', 'txt']
2025-11-17 13:19:15,930 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:19:15,944 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:19:23,909 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 13:19:33,066 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:19:43,418 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:19:59,249 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:21:57,749 - ispa_next.app_start.main - DEBUG - Operation already took 107.47 seconds (more than 80 seconds)
2025-11-17 13:21:59,826 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess_z1_m2hbu_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess_z1_m2hbu', 'txt']
2025-11-17 13:22:00,080 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:22:00,084 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:22:00,085 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:23:58,867 - ispa_next.app_start.main - DEBUG - Operation already took 106.55 seconds (more than 80 seconds)
2025-11-17 13:24:00,953 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess_etxpt__h_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c957d87244128b2e\\tess_etxpt__h', 'txt']
2025-11-17 13:24:01,179 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:24:01,184 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:24:08,781 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 13:24:18,052 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:24:28,504 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:24:44,158 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:25:07,865 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:25:19,805 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:25:22,456 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:25:23,692 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:25:23,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:25:26,020 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 75
2025-11-17 13:25:26,021 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:25:26,022 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:25:27,238 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:25:28,410 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:25:37,474 - ispa_next.appointments.models - DEBUG - Appointment Andreas Ponemunski Herr TS-A 1564 WBA71AG050CF97572 ohne Termin.
2025-11-17 13:25:37,485 - ispa_next.appointments.models - DEBUG - Appointment Heiko Lange Herr K-HL 1707 WBAUB51060VJ06122 ohne Termin.
2025-11-17 13:25:37,493 - ispa_next.appointments.models - DEBUG - Appointment Fabian Landler Herr TS-FL 440 WBA11AR0X0CM30916 ohne Termin.
2025-11-17 13:25:37,499 - ispa_next.appointments.models - DEBUG - Appointment Bianca Nadine Böhme Frau TS-BM 6120 WBA8G31070K880825 ohne Termin.
2025-11-17 13:25:37,504 - ispa_next.main - DEBUG - Found 6 out of 9 appointments to process (configured limit: 15).
2025-11-17 13:25:37,504 - ispa_next.main - DEBUG - Processing 6 fresh appointments.
2025-11-17 13:25:37,505 - ispa_next.main - DEBUG - All appointments: FR-W 1087, AÖ-YV 400, TS-FC 45, AR-20359, TS-GH 434, TS-KS 2005
2025-11-17 13:25:37,509 - ispa_next.main - DEBUG - 



2025-11-17 13:25:37,509 - ispa_next.main - DEBUG - starting with process 1 (FR-W 1087) of 6
2025-11-17 13:25:37,513 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:25:38,502 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:25:39,589 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:25:39,590 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 75
2025-11-17 13:25:40,810 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:25:40,811 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:26:11,649 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:26:21,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:23,110 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:26:23,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:23,198 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:23,367 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:26:23,370 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:26:23,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:23,443 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:26,614 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:26:26,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:27,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:26:29,467 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:26:29,572 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:26:32,801 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:26:32,870 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:26:37,026 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:26:38,032 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:26:38,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:38,541 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:44,691 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:26:44,693 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:26:44,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:26:44,794 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:26:44,795 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:26:44,838 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:26:46,051 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:26:47,277 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:26:47,557 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:26:51,496 - ispa_next.functions - DEBUG - Updated appointment (AJ00018632) customer contact data.
2025-11-17 13:26:52,425 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:26:52,426 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:26:53,202 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:26:53,203 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:26:53,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:26:57,466 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:26:57,466 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:26:57,469 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:26:57,469 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:26:57,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:57,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:02,084 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:27:02,088 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:27:02,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:02,150 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:27:07,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:08,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:08,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:08,979 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:08,980 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:27:10,826 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:27:10,828 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:27:11,769 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:27:11,770 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:11,772 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:27:11,773 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:27:11,774 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:27:11,775 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:11,777 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:27:11,781 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:27:11,786 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:27:11,791 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:27:11,795 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:27:11,797 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:27:11,799 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:27:11,800 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:27:11,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:13,714 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:27:13,737 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:27:13,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:15,651 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:27:15,651 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:27:15,654 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:17,557 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:27:17,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:27:18,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:27:18,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:31,261 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:27:31,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:33,160 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:27:44,170 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:27:44,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:45,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:27:45,358 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:04,236 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:28:08,065 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:28:08,066 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:28:08,067 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:28:08,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:28:08,556 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:28:08,557 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:28:10,000 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:28:18,220 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:28:18,618 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:28:18,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:28:19,721 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:28:19,724 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:28:22,389 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:28:22,390 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:23,317 - ispa_next.appointments.models - DEBUG - Appointment Arnold Fiala Herr TS-LU 2810 WMW11GD0002X59494 ohne Termin.
2025-11-17 13:28:23,328 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 13:28:23,332 - ispa_next.main - DEBUG - 



2025-11-17 13:28:23,332 - ispa_next.main - DEBUG - starting with process 2 (AÖ-YV 400) of 6
2025-11-17 13:28:23,336 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:28:24,412 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:28:25,674 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:28:25,675 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:28:26,904 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:28:26,905 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:52,065 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:29:01,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:01,489 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:29:01,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:29:02,881 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:29:02,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:02,955 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:29:03,152 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:29:03,154 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:29:03,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:03,261 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:29:06,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:29:06,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:29:07,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:29:09,387 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:29:09,480 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:29:12,758 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:29:12,827 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:29:12,827 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:29:23,922 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:29:24,926 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:29:24,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:25,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:38,373 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:29:45,566 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:29:45,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:45,645 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:29:45,645 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:29:45,680 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:29:47,047 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:29:47,266 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:29:51,394 - ispa_next.functions - DEBUG - Updated appointment (AJ00018625) customer contact data.
2025-11-17 13:29:52,328 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:29:52,329 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:29:52,841 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:29:52,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:29:53,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:29:57,058 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:29:57,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:29:57,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:29:59,564 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:29:59,656 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:29:59,734 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:29:59,804 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:29:59,804 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:30:11,121 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:31:11,128 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:31:22,416 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:31:29,553 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:31:29,554 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:31:33,707 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:31:34,713 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:31:34,713 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:31:34,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:34,784 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:31:38,926 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:31:39,655 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:31:50,655 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:31:50,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:50,786 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:31:56,490 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:57,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:57,074 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:57,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:57,923 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:32:00,426 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:32:00,428 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:32:01,762 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:32:01,763 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:32:01,765 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:32:01,767 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:32:01,768 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeuginnenraum raussaugen -kostenlos-, source=from_tab, target=cart)}
2025-11-17 13:32:01,769 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:32:01,771 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:32:01,772 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:32:01,773 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:32:01,775 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:32:01,783 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:32:01,786 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:32:01,794 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:32:02,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:32:03,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:32:07,576 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:32:07,577 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:32:07,578 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:32:07,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:10,194 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:32:10,195 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:32:10,197 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:12,769 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:32:12,769 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:32:12,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:15,339 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:32:15,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:32:15,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:32:16,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:26,167 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:32:26,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:28,810 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:32:43,049 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:45,872 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-17 13:32:45,875 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:32:46,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:32:47,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:32:47,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:11,155 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:33:11,156 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:33:11,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:33:12,087 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:33:12,088 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:33:15,631 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:33:25,810 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:33:26,208 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:33:26,763 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:33:28,354 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:33:28,355 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:33:32,415 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:33:32,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:33:33,642 - ispa_next.appointments.models - DEBUG - Appointment Arnold Fiala Herr TS-LU 2810 WMW11GD0002X59494 ohne Termin.
2025-11-17 13:33:33,650 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 13:33:33,654 - ispa_next.main - DEBUG - 



2025-11-17 13:33:33,654 - ispa_next.main - DEBUG - starting with process 3 (TS-FC 45) of 6
2025-11-17 13:33:33,657 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:33:35,296 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:33:36,868 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:33:36,869 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:33:38,705 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:33:38,706 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:34:19,885 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:34:31,002 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:32,222 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:34:32,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:34:32,298 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:34:32,517 - ispa_next.functions - DEBUG - HU date already expired after 2972 days.
2025-11-17 13:34:40,076 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:34:40,079 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:34:40,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:34:40,191 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:34:51,897 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:34:51,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:34:53,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:34:55,325 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:35:02,697 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 13:35:11,380 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 13:35:12,384 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:35:12,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:12,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:26,767 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:35:35,544 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:35:35,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:35,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:35:35,632 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:35:35,690 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:35:35,849 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:35:37,031 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 13:35:38,295 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 13:35:38,721 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:35:42,449 - ispa_next.functions - DEBUG - Updated appointment (BE00008636) customer contact data.
2025-11-17 13:35:43,378 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:35:43,380 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:35:43,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:35:44,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:35:46,137 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:35:46,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:35:46,236 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:35:50,275 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:35:50,275 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:35:50,275 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:35:50,277 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:35:50,278 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:35:50,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:35:50,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:35:54,892 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:35:54,896 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:35:54,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:35:55,004 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:35:55,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:55,919 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:35:55,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:35:56,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:35:56,797 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:35:58,355 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:35:58,357 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:36:00,159 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:36:00,160 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:00,162 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:36:00,163 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:36:00,164 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeuginnenraum raussaugen -kostenlos-, source=from_tab, target=cart)}
2025-11-17 13:36:00,166 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:00,168 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:36:00,169 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:36:00,170 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:36:00,172 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:36:00,173 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:36:00,175 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:36:00,176 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:36:00,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:36:01,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:36:05,949 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:36:05,951 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:36:05,952 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:36:05,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:07,193 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:36:07,194 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:36:07,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:08,452 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:36:08,452 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:36:08,454 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:09,701 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:36:09,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:36:10,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:36:10,299 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:36:10,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:11,558 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:36:24,755 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:36:25,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:25,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:36:25,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:38,989 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:36:38,991 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:36:38,992 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:36:39,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:39,911 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:36:39,912 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:36:41,907 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:36:51,245 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:36:51,638 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:36:52,143 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:36:53,617 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:36:53,618 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:36:57,621 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:36:57,622 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:36:58,701 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 13:36:58,705 - ispa_next.main - DEBUG - 



2025-11-17 13:36:58,705 - ispa_next.main - DEBUG - starting with process 4 (AR-20359) of 6
2025-11-17 13:36:58,708 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:37:00,341 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:37:02,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:37:02,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:37:03,746 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:37:03,750 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:37:39,843 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:37:51,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:55,168 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:37:55,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:37:55,242 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:37:55,669 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:38:04,181 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:38:04,184 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:38:04,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:04,269 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:38:07,690 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:38:07,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:38:09,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:38:11,243 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:38:11,386 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:38:11,582 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:38:11,679 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:38:15,922 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:38:16,928 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:38:16,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:17,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:33,657 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:38:42,688 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:38:42,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:42,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:38:42,799 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:38:42,865 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:38:44,168 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:38:44,433 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:38:48,649 - ispa_next.functions - DEBUG - Updated appointment (AJ00018612) customer contact data.
2025-11-17 13:38:49,548 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:38:49,549 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:38:50,918 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:38:50,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:38:51,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:38:55,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:38:55,853 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:38:55,856 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:38:55,857 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:38:55,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:38:56,449 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:00,578 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:39:01,745 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:39:11,525 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:39:11,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:11,624 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:39:26,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:26,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:26,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:27,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:27,841 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:39:30,913 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:39:30,916 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:39:32,551 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:39:32,553 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:39:32,559 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 13:39:32,562 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 13:39:32,564 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:39:32,565 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:39:32,567 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:39:32,568 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:39:32,569 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:39:32,571 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:39:32,572 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:39:32,574 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:39:32,577 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:39:32,578 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:39:32,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:35,892 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:39:35,893 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:39:35,895 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:39,172 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:39:39,172 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:39:39,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:42,466 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:39:42,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:39:43,487 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:39:43,571 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:39:43,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:46,905 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:40:00,431 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:40:00,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:40:01,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:40:01,715 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:40:19,405 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:40:19,406 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:40:20,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:40:20,422 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:40:20,423 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:40:24,037 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:40:34,294 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:40:34,665 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:40:35,803 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:40:36,679 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:40:36,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:40:40,716 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:40:40,717 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:40:42,031 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 13:40:42,035 - ispa_next.main - DEBUG - 



2025-11-17 13:40:42,035 - ispa_next.main - DEBUG - starting with process 5 (TS-GH 434) of 6
2025-11-17 13:40:42,038 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:40:43,743 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:40:45,446 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:40:45,448 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:40:47,290 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:40:47,292 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:41:21,009 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 13:41:21,093 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 13:41:21,100 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:41:21,807 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:41:21,808 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:41:25,680 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:41:25,681 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:41:26,875 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
2025-11-17 13:41:26,879 - ispa_next.main - DEBUG - 



2025-11-17 13:41:26,879 - ispa_next.main - DEBUG - starting with process 6 (TS-KS 2005) of 6
2025-11-17 13:41:26,882 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:41:28,601 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:41:30,387 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:41:30,388 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:41:32,188 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:41:32,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:42:06,591 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 13:42:06,602 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 13:42:06,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:42:07,220 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 274
2025-11-17 13:42:07,222 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:42:10,284 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:42:10,285 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:42:11,205 - ispa_next.appointments.models - DEBUG - Appointment Michael Popadynets Herr TS-UA 777 WBA6L31020FJ28414 ohne Termin.
