2025-11-12 06:40:55,503 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 06:40:55,519 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 06:41:11,972 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 06:41:23,149 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 06:41:38,602 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 06:42:19,414 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 06:42:31,412 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 06:42:33,893 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:42:34,969 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:42:34,969 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:42:37,198 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 184
2025-11-12 06:42:37,199 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 06:42:37,200 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 06:42:38,297 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 06:42:39,432 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:43:04,885 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:04,898 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:04,927 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:04,954 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-12 06:43:04,966 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-12 06:43:04,987 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-12 06:43:04,999 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-12 06:43:05,001 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:05,001 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:05,001 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:05,002 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:05,016 - ispa_next.main - DEBUG - Found 15 out of 39 appointments to process (configured limit: 15).
2025-11-12 06:43:05,016 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 06:43:05,017 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 06:43:05,017 - ispa_next.main - DEBUG - All appointments: MO-FP 2023, KLE F 404, KLE S 7711, M-D-3722, Kle-FM-44e, GEL H 156, KLE-UP-14, GEL P 706, HHPM407, GEL-DI 66E, BM-R 220E, GEL-AH 22E, GEL-F 6363, KLE-B 1268, KLE-W 5828
2025-11-12 06:43:05,019 - ispa_next.main - DEBUG - 



2025-11-12 06:43:05,019 - ispa_next.main - DEBUG - starting with process 1 (MO-FP 2023) of 15
2025-11-12 06:43:05,022 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:43:06,109 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:43:07,215 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:43:07,217 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 184
2025-11-12 06:43:08,558 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:43:08,559 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:43:53,274 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:43:53,375 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 06:43:53,378 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:43:53,861 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:43:53,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:43:56,276 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:43:56,277 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:43:57,026 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:43:57,031 - ispa_next.main - DEBUG - 



2025-11-12 06:43:57,031 - ispa_next.main - DEBUG - starting with process 2 (KLE F 404) of 15
2025-11-12 06:43:57,035 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:43:58,180 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:43:59,409 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:43:59,410 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:44:00,858 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:44:00,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:44:33,134 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:44:33,143 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 06:44:33,147 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:44:33,594 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:44:33,596 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:44:35,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:44:35,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:44:36,720 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:44:36,725 - ispa_next.main - DEBUG - 



2025-11-12 06:44:36,725 - ispa_next.main - DEBUG - starting with process 3 (KLE S 7711) of 15
2025-11-12 06:44:36,729 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:44:37,850 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:44:38,986 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:44:38,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:44:40,164 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:44:40,165 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:45:11,003 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:45:11,013 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 06:45:11,016 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:45:11,454 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:45:11,454 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:45:13,913 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:45:13,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:45:14,669 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:45:14,680 - ispa_next.main - DEBUG - 



2025-11-12 06:45:14,680 - ispa_next.main - DEBUG - starting with process 4 (M-D-3722) of 15
2025-11-12 06:45:14,682 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:45:15,796 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:45:16,927 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:45:16,928 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:45:18,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:45:18,340 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:45:49,959 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:45:49,969 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 06:45:49,973 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:45:50,455 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:45:50,455 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:45:52,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:45:52,752 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:45:53,494 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:45:53,500 - ispa_next.main - DEBUG - 



2025-11-12 06:45:53,500 - ispa_next.main - DEBUG - starting with process 5 (Kle-FM-44e) of 15
2025-11-12 06:45:53,504 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:45:54,660 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:45:55,718 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:45:55,719 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:45:57,098 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:45:57,099 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:46:29,481 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:46:29,489 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 06:46:29,491 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:46:29,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:46:29,967 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:46:32,549 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:46:32,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:46:33,358 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:46:33,362 - ispa_next.main - DEBUG - 



2025-11-12 06:46:33,362 - ispa_next.main - DEBUG - starting with process 6 (GEL H 156) of 15
2025-11-12 06:46:33,366 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:46:34,527 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:46:35,689 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:46:35,691 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:46:36,982 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:46:36,983 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:47:08,531 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:47:08,541 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 06:47:08,545 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:09,020 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:47:09,020 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:11,316 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:47:11,317 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:47:12,346 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:47:12,351 - ispa_next.main - DEBUG - 



2025-11-12 06:47:12,351 - ispa_next.main - DEBUG - starting with process 7 (KLE-UP-14) of 15
2025-11-12 06:47:12,356 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:47:13,410 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:14,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:47:14,552 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:47:15,858 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:15,859 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:47:47,725 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:47:47,734 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 06:47:47,737 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:48,201 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:47:48,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:50,618 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:47:50,618 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:47:51,484 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:47:51,488 - ispa_next.main - DEBUG - 



2025-11-12 06:47:51,488 - ispa_next.main - DEBUG - starting with process 8 (GEL P 706) of 15
2025-11-12 06:47:51,491 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:47:52,540 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:53,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:47:53,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:47:55,204 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:55,205 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:48:27,227 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:48:27,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 06:48:27,241 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:48:27,778 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:48:27,780 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:48:30,239 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:48:30,240 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:48:31,033 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:48:31,038 - ispa_next.main - DEBUG - 



2025-11-12 06:48:31,038 - ispa_next.main - DEBUG - starting with process 9 (HHPM407) of 15
2025-11-12 06:48:31,041 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:48:32,268 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:48:33,478 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:48:33,479 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:48:34,944 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:48:34,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:49:05,947 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:49:05,958 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 06:49:05,961 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:49:06,430 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:49:06,432 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:49:08,769 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:49:08,769 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:49:09,583 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:49:09,590 - ispa_next.main - DEBUG - 



2025-11-12 06:49:09,590 - ispa_next.main - DEBUG - starting with process 10 (GEL-DI 66E) of 15
2025-11-12 06:49:09,599 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:49:10,551 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:49:11,593 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:49:11,594 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:49:13,034 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:49:13,035 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:49:42,799 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:49:42,805 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 06:49:42,809 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:49:43,216 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:49:43,218 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:49:45,670 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:49:45,671 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:49:46,435 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:49:46,441 - ispa_next.main - DEBUG - 



2025-11-12 06:49:46,441 - ispa_next.main - DEBUG - starting with process 11 (BM-R 220E) of 15
2025-11-12 06:49:46,444 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:49:47,584 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:49:48,632 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:49:48,633 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:49:49,941 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:49:49,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:50:13,126 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:50:14,970 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:50:19,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:50:24,580 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:50:24,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:50:24,652 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:50:24,966 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 06:50:29,018 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:50:29,022 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:50:29,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:50:29,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:50:32,039 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:50:32,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:50:32,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:50:34,817 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:50:34,931 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:50:35,025 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:50:35,127 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:50:35,127 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:50:43,238 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:50:44,244 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:50:44,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:50:44,769 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:50:57,986 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 06:51:01,863 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:51:01,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:51:01,945 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:51:01,946 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:51:02,003 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:51:03,223 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:51:03,531 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:51:04,729 - ispa_next.functions - DEBUG - Updated appointment (BB00024105) customer contact data.
2025-11-12 06:51:05,627 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:51:05,629 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:51:06,129 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:51:06,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:51:06,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:51:10,358 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:51:10,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:51:10,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:51:12,869 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:51:13,014 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:51:13,149 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:51:13,213 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:51:13,214 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:51:24,560 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:51:28,877 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:51:28,877 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:51:33,042 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:51:34,056 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:51:34,059 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:51:34,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:51:34,166 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:51:43,206 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 06:51:47,457 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 06:51:47,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:51:47,920 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:51:47,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:51:48,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:51:48,586 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:51:53,280 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:51:53,282 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:51:54,208 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:51:54,210 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:51:54,216 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:51:54,216 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:51:54,220 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 06:51:54,222 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:51:54,226 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:51:54,226 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:51:54,230 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:51:54,234 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 06:51:56,583 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:51:57,138 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:51:58,116 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:51:58,724 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:51:59,241 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:52:00,164 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:00,720 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:52:01,248 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:52:02,150 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:02,720 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:52:03,237 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:52:04,150 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:04,710 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:52:05,227 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:52:06,138 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:06,721 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:52:07,244 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:52:08,147 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:08,724 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:52:09,242 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 06:52:10,582 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:11,624 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 06:52:12,555 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 06:52:13,000 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:52:13,002 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:52:13,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:52:17,718 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:52:17,720 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:52:17,722 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:52:22,210 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:52:22,212 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:52:22,214 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:52:22,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:52:26,809 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:52:40,195 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:52:40,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:52:41,439 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:52:41,596 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:52:50,163 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:52:53,647 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:52:53,647 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:52:54,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:52:54,346 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:52:54,347 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:52:57,858 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 06:53:07,068 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:53:07,438 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 06:53:07,877 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:53:08,501 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:53:08,501 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:53:11,238 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:53:11,238 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:53:12,042 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:53:12,046 - ispa_next.main - DEBUG - 



2025-11-12 06:53:12,046 - ispa_next.main - DEBUG - starting with process 12 (GEL-AH 22E) of 15
2025-11-12 06:53:12,050 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:53:13,167 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:53:14,472 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:53:14,474 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:53:15,821 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:53:15,823 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:53:38,412 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:53:40,416 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:53:45,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:53:47,852 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:53:47,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:53:47,930 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:53:48,137 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:53:48,138 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:53:48,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:53:48,213 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:53:51,455 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:53:51,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:53:52,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:53:54,342 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:53:54,481 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:53:54,588 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:53:54,651 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:53:54,651 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:54:02,919 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:54:03,924 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:54:03,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:54:04,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:54:16,188 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 06:54:16,188 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 06:54:20,102 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:54:20,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:54:20,181 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:54:20,182 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:54:20,237 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:54:21,510 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:54:21,729 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:54:22,937 - ispa_next.functions - DEBUG - Updated appointment (BB00024057) customer contact data.
2025-11-12 06:54:23,865 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:54:23,868 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:54:24,661 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:54:24,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:54:25,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:54:28,981 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:54:28,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:54:29,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:54:31,511 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:54:31,619 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:54:31,696 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:54:31,834 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:54:31,834 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:54:42,542 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:54:46,662 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:54:46,664 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:54:50,854 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:54:51,861 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:54:51,863 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:54:51,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:54:51,950 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:55:00,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:55:01,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:55:01,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:55:02,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:55:02,145 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:55:04,598 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:55:04,600 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:55:05,778 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:55:05,778 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:55:05,782 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:55:05,784 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:55:05,786 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:55:05,788 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:55:05,792 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:55:05,796 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:55:05,802 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:55:05,806 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:55:05,808 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:55:05,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:55:08,381 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:55:08,383 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:55:08,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:55:11,033 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:55:11,033 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:55:11,035 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:55:11,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:55:13,584 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:55:25,744 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:55:26,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:55:26,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:55:26,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:55:34,052 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:55:37,323 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:55:37,325 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:55:37,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:55:38,079 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:55:38,081 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:55:41,354 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 06:55:48,890 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:55:49,280 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 06:55:49,871 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:55:50,475 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:55:50,477 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:55:53,177 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:55:53,177 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:55:53,978 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:55:53,985 - ispa_next.main - DEBUG - 



2025-11-12 06:55:53,986 - ispa_next.main - DEBUG - starting with process 13 (GEL-F 6363) of 15
2025-11-12 06:55:53,994 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:55:54,991 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:55:56,094 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:55:56,096 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:55:57,321 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:55:57,322 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:56:21,184 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:56:23,002 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:56:28,052 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:56:33,363 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:56:33,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:56:33,429 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:56:33,584 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 06:56:37,401 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:56:37,403 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:56:37,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:56:37,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:56:40,465 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:56:40,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:56:41,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:56:43,410 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:56:43,508 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:56:43,600 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:56:43,670 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:56:47,914 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 06:56:48,920 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:56:48,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:56:49,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:01,426 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 06:57:05,674 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:57:05,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:05,772 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:57:05,773 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:57:05,863 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:57:07,070 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:57:08,241 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:57:08,438 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:57:09,839 - ispa_next.functions - DEBUG - Updated appointment (BB00025221) customer contact data.
2025-11-12 06:57:10,751 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:57:10,753 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:57:11,516 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:57:11,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:57:12,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:57:16,227 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:57:16,228 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 06:57:16,230 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:57:16,233 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:57:16,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:57:16,786 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:57:17,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:17,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:17,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:57:18,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:57:18,355 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:57:23,035 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:57:23,037 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:57:24,443 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:57:24,444 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:57:24,450 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:57:24,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:57:24,457 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:57:24,462 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:57:24,463 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:57:24,466 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:57:24,468 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:57:24,471 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:57:24,473 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:57:24,475 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:57:24,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:57:29,842 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:57:29,843 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:57:29,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:57:35,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:57:35,146 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:57:46,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:58:00,776 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:58:00,776 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:58:00,778 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:58:00,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:58:06,038 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 06:58:13,690 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:58:31,071 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:58:32,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:58:33,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:58:33,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:58:42,668 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:58:46,114 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:58:46,115 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:58:46,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:58:46,928 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:58:46,930 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:58:50,267 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 06:58:58,693 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:58:59,060 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 06:59:00,104 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:59:00,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:59:00,775 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:59:03,596 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:59:03,597 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:59:04,421 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:59:04,429 - ispa_next.main - DEBUG - 



2025-11-12 06:59:04,429 - ispa_next.main - DEBUG - starting with process 14 (KLE-B 1268) of 15
2025-11-12 06:59:04,433 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:59:05,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:59:06,596 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:59:06,598 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:59:08,090 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:59:08,092 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:59:49,087 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:59:49,097 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 06:59:49,101 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:59:49,572 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:59:49,572 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:59:52,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 06:59:52,141 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:59:52,971 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 06:59:52,984 - ispa_next.main - DEBUG - 



2025-11-12 06:59:52,985 - ispa_next.main - DEBUG - starting with process 15 (KLE-W 5828) of 15
2025-11-12 06:59:52,988 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:59:54,033 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:59:55,131 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 06:59:55,133 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 193
2025-11-12 06:59:56,464 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:59:56,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:00:21,616 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:00:23,567 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:00:28,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:00:32,119 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:00:32,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:00:32,190 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:00:32,392 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:00:32,394 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:00:32,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:00:32,532 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:00:35,594 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:00:35,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:00:36,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:00:38,712 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:00:38,813 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:00:38,901 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:00:38,960 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:00:38,960 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:00:47,249 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:00:48,254 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:00:48,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:00:48,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:01,157 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:01:04,827 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:01:04,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:04,927 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:01:04,928 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:01:04,970 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:01:05,047 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:01:06,225 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:01:06,457 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:01:08,509 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:01:08,510 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:01:08,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:01:09,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:01:10,199 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:01:10,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:01:10,262 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:01:13,916 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:01:13,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:01:14,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:01:16,467 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:01:16,616 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:01:16,716 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:01:16,785 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:01:16,785 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:01:24,936 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:02:24,940 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:02:35,807 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:02:40,000 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:02:40,000 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:02:44,194 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:02:45,199 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:02:45,201 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:02:45,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:02:45,283 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:02:50,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:02:50,661 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:02:50,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:02:51,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:02:51,366 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:02:54,413 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:02:54,419 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:02:55,570 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:02:55,573 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:02:55,579 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:02:55,581 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:02:55,583 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:02:55,585 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:02:55,587 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:02:55,589 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:02:55,591 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:02:55,595 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:02:55,597 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:02:55,599 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:02:55,599 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:02:58,831 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:02:58,833 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:02:58,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:02,103 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:03:02,105 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:03:02,105 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:03:02,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:05,364 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:03:18,348 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:03:18,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:03:19,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:03:19,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:26,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:03:30,446 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:03:30,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:03:31,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:03:31,191 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:03:31,192 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:03:34,709 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:03:42,187 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:03:42,566 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:03:43,027 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:03:43,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 422
2025-11-12 07:03:43,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:03:46,440 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 193
2025-11-12 07:03:46,441 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:03:47,266 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
