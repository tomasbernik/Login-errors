2025-11-17 14:25:10,727 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:25:10,735 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:25:20,305 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:25:32,215 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:25:47,789 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:27:46,386 - ispa_next.app_start.main - DEBUG - Operation already took 107.24 seconds (more than 80 seconds)
2025-11-17 14:27:48,443 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\16bfd9a68c680de0\\tess_d1myrjq2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\16bfd9a68c680de0\\tess_d1myrjq2', 'txt']
2025-11-17 14:27:48,692 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:27:48,698 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:27:48,699 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:29:48,081 - ispa_next.app_start.main - DEBUG - Operation already took 107.09 seconds (more than 80 seconds)
2025-11-17 14:29:50,160 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\16bfd9a68c680de0\\tess_99fr2p6l_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\16bfd9a68c680de0\\tess_99fr2p6l', 'txt']
2025-11-17 14:29:50,403 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:29:50,409 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:29:57,443 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 14:30:06,137 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:30:17,450 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:30:32,958 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:32:31,008 - ispa_next.app_start.main - DEBUG - Operation already took 106.90 seconds (more than 80 seconds)
2025-11-17 14:32:33,065 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\16bfd9a68c680de0\\tess_jusfs4ki_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\16bfd9a68c680de0\\tess_jusfs4ki', 'txt']
2025-11-17 14:32:33,301 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 14:32:33,305 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 14:32:33,305 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:33:22,930 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:33:34,573 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:33:38,746 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:33:39,733 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2124
2025-11-17 14:33:39,735 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 600
2025-11-17 14:33:42,208 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 437
2025-11-17 14:33:42,209 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:33:42,211 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:33:43,463 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:33:44,659 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:34:48,402 - ispa_next.appointments.models - DEBUG - Appointment Jens Kelsch BE 732811 WBAWY710100N40707 ohne Termin.
2025-11-17 14:34:48,417 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:34:48,422 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,423 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,424 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,424 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,458 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,511 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,529 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-17 14:34:48,532 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:34:48,558 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-17 14:34:48,580 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-17 14:34:48,596 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-17 14:34:48,621 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-17 14:34:48,639 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-17 14:34:48,654 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-17 14:34:48,674 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-17 14:34:48,689 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-17 14:34:48,698 - ispa_next.main - DEBUG - Found 1 out of 63 appointments to process (configured limit: 15).
2025-11-17 14:34:48,699 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 14:34:48,699 - ispa_next.main - DEBUG - All appointments: LÖ-CZ 1
2025-11-17 14:34:48,701 - ispa_next.main - DEBUG - 



2025-11-17 14:34:48,701 - ispa_next.main - DEBUG - starting with process 1 (LÖ-CZ 1) of 1
2025-11-17 14:34:48,705 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:34:49,873 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:34:51,037 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2124
2025-11-17 14:34:51,038 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 437
2025-11-17 14:34:52,452 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:34:52,454 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:35:31,881 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:35:41,514 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:44,760 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:35:44,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:35:44,834 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:35:45,059 - ispa_next.functions - DEBUG - HU date soon to be invalid in 38 days.
2025-11-17 14:35:51,280 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:35:51,283 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:35:53,992 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:35:53,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:35:54,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:35:56,877 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:35:56,983 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:36:00,198 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:36:08,022 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 14:36:09,027 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:36:09,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:09,599 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:21,350 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:36:21,350 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:36:28,543 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:36:28,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:28,664 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:36:28,665 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:36:28,702 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:36:29,953 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:36:30,176 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:36:33,535 - ispa_next.functions - DEBUG - Updated appointment (AC00065328) customer contact data.
2025-11-17 14:36:34,455 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:36:34,457 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:36:35,324 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:36:35,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:36:36,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:36:40,026 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:36:40,026 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:36:40,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:40,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:36:42,512 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:36:42,624 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:36:42,712 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:36:42,775 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:36:46,984 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:36:47,994 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:36:47,997 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:36:47,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:48,058 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:36:57,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:57,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:57,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:58,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:36:58,195 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:37:01,217 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:37:01,219 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:37:02,223 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:37:02,225 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:37:02,226 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 14:37:02,227 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:37:02,229 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:37:02,230 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:37:02,231 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:37:02,232 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:37:02,233 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:37:02,235 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:37:02,237 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:37:02,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:37:03,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:37:12,650 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:37:12,652 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:37:12,653 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:37:12,653 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:16,551 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:37:19,050 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:37:19,051 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:37:19,053 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:37:19,055 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:37:19,057 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:37:19,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:37:22,951 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:37:22,953 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:37:22,955 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:37:22,955 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:37:23,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:37:24,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:37:24,309 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:37:26,183 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:37:33,570 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:37:33,944 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:37:34,250 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:37:36,297 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2124
2025-11-17 14:37:36,298 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:37:39,127 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 14:37:39,128 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:37:39,920 - ispa_next.appointments.models - DEBUG - Appointment Jens Kelsch BE 732811 WBAWY710100N40707 ohne Termin.
2025-11-17 14:37:39,931 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
