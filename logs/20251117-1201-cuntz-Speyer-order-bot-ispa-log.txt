2025-11-17 12:08:33,390 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:08:33,397 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:08:45,994 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:08:59,008 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:09:14,855 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:09:42,540 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:10:04,140 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:10:08,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:10:10,255 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1155
2025-11-17 12:10:10,256 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 298
2025-11-17 12:10:13,738 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 12:10:13,739 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:10:13,740 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:10:15,233 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:10:16,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:10:55,981 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:10:56,049 - ispa_next.appointments.models - DEBUG - Appointment Jakob Haermony HD-JJ 3101 WBAWY710400N41088 ohne Termin.
2025-11-17 12:10:56,067 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Kley DÜW-KJ 113 WBA1A11060J903458 ohne Termin.
2025-11-17 12:10:56,084 - ispa_next.appointments.models - DEBUG - Appointment Rizvan Bataiv RP-FA 115 WBAUF11060PT69308 ohne Termin.
2025-11-17 12:10:56,102 - ispa_next.appointments.models - DEBUG - Appointment Jamel Oliver Atig MA-MJ 889 WBA31BL000WW88206 ohne Termin.
2025-11-17 12:10:56,168 - ispa_next.appointments.models - DEBUG - Appointment Michaela Sophie Lapschanski RP-RL 3000 WBAJP31020BT75745 ohne Termin.
2025-11-17 12:10:56,181 - ispa_next.appointments.models - DEBUG - Appointment Gamze Fatma Altiparmak HD-XX 918 WMWXR91010TP82490 ohne Termin.
2025-11-17 12:10:56,212 - ispa_next.appointments.models - DEBUG - Appointment Erich Simus SP-B 26 WBAJM71050G959849 ohne Termin.
2025-11-17 12:10:56,230 - ispa_next.appointments.models - DEBUG - Appointment Christine Zimmermann KA-E 1152 WBAUZ35060N035577 ohne Termin.
2025-11-17 12:10:56,241 - ispa_next.appointments.models - DEBUG - Appointment Christine Eichenlaub  WMW11DJ0002V69245 ohne Termin.
2025-11-17 12:10:56,250 - ispa_next.appointments.models - DEBUG - Appointment Schick Vermietung GmbH SP-SV 140 WBA11GW010CS52823 ohne Termin.
2025-11-17 12:10:56,259 - ispa_next.appointments.models - DEBUG - Appointment Nico Hellmann GER-NH 28 WBA7K310807F44939 ohne Termin.
2025-11-17 12:10:56,267 - ispa_next.appointments.models - DEBUG - Appointment Präg Günter GmbH MA-PR 705 WBS11ET0709V00834 ohne Termin.
2025-11-17 12:10:56,276 - ispa_next.appointments.models - DEBUG - Appointment Oliver Menrath RP-OM 55 WBADW51020E364111 ohne Termin.
2025-11-17 12:10:56,284 - ispa_next.appointments.models - DEBUG - Appointment Felix Dominik Hipper DÜW-FE 92 WBSKG91030E854306 ohne Termin.
2025-11-17 12:10:56,293 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Lindner HD-IL 1052 WBAUR31050VL42406 ohne Termin.
2025-11-17 12:10:56,304 - ispa_next.appointments.models - DEBUG - Appointment Melanie Bredereck HD-MB 552 WMWXR31040TP49433 ohne Termin.
2025-11-17 12:10:56,317 - ispa_next.appointments.models - DEBUG - Appointment Martin Zitron SP-ZM 71 WBAUN71070VM20560 ohne Termin.
2025-11-17 12:10:56,333 - ispa_next.main - DEBUG - Found 5 out of 31 appointments to process (configured limit: 15).
2025-11-17 12:10:56,333 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 12:10:56,333 - ispa_next.main - DEBUG - All appointments: DÜW-CK 45, SP-HB 44, LU-XB 70, KA-HG 4600, RP-PL 200
2025-11-17 12:10:56,343 - ispa_next.main - DEBUG - 



2025-11-17 12:10:56,343 - ispa_next.main - DEBUG - starting with process 1 (DÜW-CK 45) of 5
2025-11-17 12:10:56,348 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:10:57,784 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:10:59,143 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1155
2025-11-17 12:10:59,145 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 12:11:01,053 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:11:01,055 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:11:39,803 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:11:51,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:51,631 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:11:51,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:53,173 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:11:53,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:53,254 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:11:53,547 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:11:53,550 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:11:56,402 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:11:56,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:57,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:11:59,792 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:11:59,920 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:12:03,231 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:12:03,372 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:12:03,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:04,775 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:12:16,387 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:12:17,392 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:12:17,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:17,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:22,032 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:12:22,035 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:12:22,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:12:22,157 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:12:22,158 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:12:22,252 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:12:23,616 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:12:24,007 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:12:28,044 - ispa_next.functions - DEBUG - Updated appointment (AD00027555) customer contact data.
2025-11-17 12:12:29,005 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:12:29,007 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:12:30,103 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:12:30,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:12:30,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:12:34,552 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:12:34,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:12:35,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:12:37,057 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:12:37,205 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:12:37,307 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:12:37,834 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:12:37,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:39,386 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:12:50,953 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:13:50,957 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:14:02,627 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:14:10,059 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:14:10,060 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:14:11,459 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:14:15,683 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:14:16,691 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:14:16,692 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:14:16,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:14:16,812 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:14:20,968 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:14:20,972 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:14:20,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:14:21,049 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:14:21,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:14:22,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:14:22,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:14:22,856 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:14:22,858 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:14:24,362 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:14:24,366 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:14:25,523 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:14:25,525 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:14:25,527 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 12:14:25,529 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 12:14:25,530 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-17 12:14:25,531 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:14:25,534 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 12:14:25,535 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:14:25,536 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:14:25,537 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:14:25,540 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:14:25,541 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:14:25,545 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:14:25,547 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:14:26,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:14:27,160 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:14:33,540 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:14:33,542 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:14:33,543 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:14:33,544 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:14:35,499 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:14:35,501 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:14:35,505 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:14:37,550 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:14:37,552 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:14:37,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:14:38,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:14:38,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:14:49,204 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:14:49,206 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:15:02,922 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:15:03,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:15:04,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:15:04,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:23,606 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:15:28,902 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:15:28,905 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:15:28,905 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:15:29,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:15:29,949 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:15:29,951 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:15:32,140 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:15:45,024 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:15:45,417 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:15:46,433 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:15:48,812 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1156
2025-11-17 12:15:48,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:15:52,367 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 299
2025-11-17 12:15:52,368 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:15:53,386 - ispa_next.appointments.models - DEBUG - Appointment Claudiu-Julian Bancila RP-C 3002 WBA5J71060GZ77948 ohne Termin.
2025-11-17 12:15:53,393 - ispa_next.main - DEBUG - Found new Appointment: RP-BI 128
2025-11-17 12:15:53,394 - ispa_next.main - DEBUG - 



2025-11-17 12:15:53,394 - ispa_next.main - DEBUG - starting with process 2 (RP-BI 128) of 6
2025-11-17 12:15:53,398 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:15:54,772 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:15:56,357 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1156
2025-11-17 12:15:56,359 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 299
2025-11-17 12:15:58,235 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:15:58,236 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:16:37,686 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:16:49,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:16:49,883 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:16:50,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:52,220 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:16:52,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:16:52,346 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:16:52,666 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:16:52,670 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:16:55,670 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:16:55,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:16:56,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:16:58,990 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:16:59,189 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:17:02,422 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:17:02,512 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:17:02,526 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:04,778 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:17:16,604 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:17:17,608 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:17:17,609 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:18,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:30,455 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:17:39,872 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:17:39,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:40,017 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:17:40,019 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:17:40,084 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:17:41,551 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:17:41,978 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:17:45,793 - ispa_next.functions - DEBUG - Updated appointment (AD00027557) customer contact data.
2025-11-17 12:17:46,700 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:17:46,702 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:17:47,836 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:17:47,837 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:17:48,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:17:52,272 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:17:52,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:17:52,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:17:54,864 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:17:55,035 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:17:55,181 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:17:55,276 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:17:55,277 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:57,472 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:18:08,399 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:18:16,062 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:18:16,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:18,197 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:18:22,400 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:18:23,407 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:18:23,408 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:18:23,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:23,565 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:18:27,685 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:18:27,690 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:18:27,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:27,832 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:18:36,890 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 12:18:49,488 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:18:49,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:50,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:50,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:51,176 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:18:51,179 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:18:53,362 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:18:53,364 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:18:54,383 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:18:54,386 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:18:54,391 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 12:18:54,395 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 12:18:54,396 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-17 12:18:54,398 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:18:54,401 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 12:18:54,402 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:18:54,403 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:18:54,404 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:18:54,407 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:18:54,409 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:18:54,412 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:18:54,414 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:18:55,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:18:56,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:19:23,771 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:19:23,990 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 12:19:30,960 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:19:30,962 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:19:30,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:34,298 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:19:34,300 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:19:34,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:37,741 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:19:37,743 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:19:37,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:19:38,535 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:19:38,952 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:01,771 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:20:01,773 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:20:16,736 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:20:17,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:20:17,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:20:18,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:50,981 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:20:57,284 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:02,572 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:08,851 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:08,853 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:21:08,854 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:09,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:21:09,838 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:21:09,840 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:21:12,399 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:21:23,394 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:21:23,763 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:21:24,821 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:26,372 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1156
2025-11-17 12:21:26,373 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:29,954 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 299
2025-11-17 12:21:29,955 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:21:30,935 - ispa_next.appointments.models - DEBUG - Appointment Claudiu-Julian Bancila RP-C 3002 WBA5J71060GZ77948 ohne Termin.
2025-11-17 12:21:30,943 - ispa_next.main - DEBUG - 



2025-11-17 12:21:30,943 - ispa_next.main - DEBUG - starting with process 3 (SP-HB 44) of 6
2025-11-17 12:21:30,947 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:32,345 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:33,950 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1156
2025-11-17 12:21:33,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 299
2025-11-17 12:21:35,962 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:35,963 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:22:21,148 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:22:32,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:32,853 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:33,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:35,144 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:22:35,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:35,245 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:35,613 - ispa_next.functions - DEBUG - HU date already expired after 1731 days.
2025-11-17 12:22:44,584 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:22:44,588 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:22:47,388 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:22:47,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:48,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:22:50,767 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:22:50,901 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:22:51,049 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:22:51,146 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:22:51,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:53,230 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:23:05,100 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:23:06,109 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:23:06,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:06,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:18,686 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:23:18,693 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:23:28,202 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:23:28,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:28,305 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:23:28,331 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:23:28,485 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:23:28,682 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:23:30,292 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:23:30,669 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:23:36,688 - ispa_next.functions - DEBUG - Updated appointment (AD00027554) customer contact data.
2025-11-17 12:23:37,617 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:23:37,619 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:23:37,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:23:38,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:23:40,334 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:23:40,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:23:40,524 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:23:44,150 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:23:44,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:44,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:23:46,661 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:23:46,851 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:23:46,993 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:23:47,082 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:23:47,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:49,185 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:24:00,716 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:25:00,721 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:25:12,140 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:25:22,143 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:25:33,986 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:25:43,758 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:25:44,764 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:25:44,765 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:25:44,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:44,883 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:25:49,029 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:25:49,032 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:25:49,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:49,157 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:25:49,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:50,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:50,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:50,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:25:50,891 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:25:52,967 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:25:52,988 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:25:54,549 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:25:54,550 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:25:54,553 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 12:25:54,554 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 12:25:54,556 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-17 12:25:54,557 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:25:54,561 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:25:54,562 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=BMW Sicher in den Winter.Relax. We care., source=from_tab, target=advice_list)}
2025-11-17 12:25:54,563 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:25:54,565 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:25:54,566 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:25:54,570 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:25:54,571 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:25:55,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:25:56,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:26:02,999 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:26:03,000 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 12:26:03,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:26:03,868 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 12:26:11,488 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:26:11,490 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:26:11,491 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:26:11,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:14,234 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:26:14,235 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:26:14,237 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:16,885 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:26:16,887 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:26:16,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:26:17,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:26:17,571 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:26:17,573 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:26:31,270 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:26:31,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:26:32,250 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:26:32,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:52,630 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:26:52,630 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:26:53,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:26:53,598 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:26:53,600 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:27:00,972 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:27:12,010 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:27:12,405 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 12:27:13,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:27:15,558 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:27:15,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:27:18,993 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 299
2025-11-17 12:27:18,994 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:27:20,376 - ispa_next.appointments.models - DEBUG - Appointment BDG GmbH RT-B 1044 WBA11DZ060FM57563 ohne Termin.
2025-11-17 12:27:20,386 - ispa_next.appointments.models - DEBUG - Appointment Claudiu-Julian Bancila RP-C 3002 WBA5J71060GZ77948 ohne Termin.
2025-11-17 12:27:20,391 - ispa_next.main - DEBUG - 



2025-11-17 12:27:20,391 - ispa_next.main - DEBUG - starting with process 4 (LU-XB 70) of 6
2025-11-17 12:27:20,394 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:27:21,783 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:27:23,480 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:27:23,481 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 299
2025-11-17 12:27:25,327 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:27:25,332 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:02,457 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:28:14,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:28:14,394 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:28:14,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:16,614 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:28:16,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:28:16,722 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:28:17,023 - ispa_next.functions - DEBUG - HU date soon to be invalid in 24 days.
2025-11-17 12:28:25,760 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:28:25,764 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:28:28,603 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:28:28,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:28:29,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:28:31,935 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:28:42,264 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 12:28:51,637 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 12:28:52,642 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:28:52,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:28:53,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:05,473 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:29:05,473 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:29:15,239 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:29:15,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:15,396 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:15,397 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:29:15,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:29:15,625 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:29:17,265 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:29:17,648 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:29:21,298 - ispa_next.functions - DEBUG - Updated appointment (AD00027550) customer contact data.
2025-11-17 12:29:22,240 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:29:22,244 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:29:22,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:29:23,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:29:25,461 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:29:25,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:29:25,742 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:29:29,547 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:29:29,548 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:29:29,556 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:29:29,556 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:29:29,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:30,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:34,249 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:29:34,253 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:29:34,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:34,403 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:29:34,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:35,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:35,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:36,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:36,153 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:29:38,189 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:29:38,192 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:29:39,707 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:29:39,710 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:29:39,713 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 12:29:39,715 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 12:29:39,717 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Außenwäsche, source=from_tab, target=cart)}
2025-11-17 12:29:39,718 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:29:39,747 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 12:29:39,749 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:29:39,750 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:29:39,751 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:29:39,754 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:29:39,755 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:29:39,757 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:29:39,759 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:29:40,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:29:41,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:29:47,849 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:29:47,851 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:29:47,852 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:29:47,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:50,641 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:29:50,642 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:29:50,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:53,424 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:29:53,425 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:29:53,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:29:53,910 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:29:53,991 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:29:53,993 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:30:07,844 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:30:08,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:30:08,865 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:30:09,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:36,006 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:30:41,188 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:30:47,160 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:30:47,162 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:30:47,163 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:30:48,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:30:48,193 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:30:48,195 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:30:50,692 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:31:01,894 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:31:02,346 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 12:31:03,277 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:31:05,030 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:31:05,031 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:31:08,909 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 299
2025-11-17 12:31:08,910 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:31:09,989 - ispa_next.appointments.models - DEBUG - Appointment BDG GmbH RT-B 1044 WBA11DZ060FM57563 ohne Termin.
2025-11-17 12:31:10,001 - ispa_next.appointments.models - DEBUG - Appointment Claudiu-Julian Bancila RP-C 3002 WBA5J71060GZ77948 ohne Termin.
2025-11-17 12:31:10,005 - ispa_next.main - DEBUG - 



2025-11-17 12:31:10,005 - ispa_next.main - DEBUG - starting with process 5 (KA-HG 4600) of 6
2025-11-17 12:31:10,008 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:31:11,477 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:31:13,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:31:13,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 299
2025-11-17 12:31:15,049 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:31:15,050 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:31:46,243 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:31:58,433 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:00,412 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:32:00,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:00,493 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:32:00,859 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:32:09,379 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:32:09,382 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:32:12,236 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:32:12,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:32:12,469 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 12:32:15,029 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 12:32:15,047 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:32:15,048 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:15,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:32:16,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:32:16,663 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:32:16,729 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:32:19,809 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 12:32:19,812 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:21,234 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:32:21,236 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:25,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 299
2025-11-17 12:32:25,187 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:32:26,350 - ispa_next.appointments.models - DEBUG - Appointment BDG GmbH RT-B 1044 WBA11DZ060FM57563 ohne Termin.
2025-11-17 12:32:26,365 - ispa_next.appointments.models - DEBUG - Appointment Claudiu-Julian Bancila RP-C 3002 WBA5J71060GZ77948 ohne Termin.
2025-11-17 12:32:26,370 - ispa_next.main - DEBUG - 



2025-11-17 12:32:26,370 - ispa_next.main - DEBUG - starting with process 6 (RP-PL 200) of 6
2025-11-17 12:32:26,374 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:27,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:32:29,450 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:32:29,451 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 299
2025-11-17 12:32:31,967 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:32:31,968 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:33:05,668 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:33:17,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:19,825 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:33:19,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:19,965 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:33:20,260 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:33:20,263 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:33:23,105 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:33:23,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:33:23,421 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 12:33:23,883 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 12:33:23,900 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:33:23,901 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:33:24,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:33:25,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:33:25,665 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:33:25,726 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:33:29,513 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:33:29,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:33:30,256 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1157
2025-11-17 12:33:30,258 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:33:37,449 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 299
2025-11-17 12:33:37,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:33:38,515 - ispa_next.appointments.models - DEBUG - Appointment Hans Josef Sauerhöfer DÜW-JH 20 E WMW21GC0XSTA94433 ohne Termin.
2025-11-17 12:33:38,534 - ispa_next.appointments.models - DEBUG - Appointment Claudiu-Julian Bancila RP-C 3002 WBA5J71060GZ77948 ohne Termin.
