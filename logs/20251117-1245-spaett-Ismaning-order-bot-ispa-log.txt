2025-11-17 12:52:39,613 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:52:39,619 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:52:47,068 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:52:58,008 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:53:13,599 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:53:37,697 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:53:48,892 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:53:51,709 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:53:52,425 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:53:52,426 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:53:54,279 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 398
2025-11-17 12:53:54,280 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:53:54,280 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:53:55,061 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:53:55,840 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:54:51,351 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,356 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,357 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,413 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,429 - ispa_next.appointments.models - DEBUG - Appointment Bayram Sahin M-S 2289 WBA6X510405S02325 ohne Termin.
2025-11-17 12:54:51,438 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,457 - ispa_next.appointments.models - DEBUG - Appointment Thomas Löb M-L 5621 WBA8H71010A040968 ohne Termin.
2025-11-17 12:54:51,470 - ispa_next.appointments.models - DEBUG - Appointment Antonio Cavar ED-AC 1986 WBA6L31020FJ84465 ohne Termin.
2025-11-17 12:54:51,474 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,487 - ispa_next.appointments.models - DEBUG - Appointment Rebecca Hurst FS-RA 602 WMW31DH0902V63832 ohne Termin.
2025-11-17 12:54:51,492 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,493 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,494 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,505 - ispa_next.appointments.models - DEBUG - Appointment Alexander Schulz M-S 7319 WBA61EE0605Y49885 ohne Termin.
2025-11-17 12:54:51,519 - ispa_next.appointments.models - DEBUG - Appointment Firma NEO - Professional Solutions GmbH M-N 917 WBS31AZ000CM52265 ohne Termin.
2025-11-17 12:54:51,532 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,544 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,545 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,561 - ispa_next.appointments.models - DEBUG - Appointment Faton Halilaj M-DF 1991 WBA6L51030FJ39031 ohne Termin.
2025-11-17 12:54:51,583 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,600 - ispa_next.appointments.models - DEBUG - Appointment Martin Lamprecht  WBA7K310807P56396 ohne Termin.
2025-11-17 12:54:51,605 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,621 - ispa_next.appointments.models - DEBUG - Appointment Josef Deimel M-LW 90 WBATX35040NC13555 ohne Termin.
2025-11-17 12:54:51,633 - ispa_next.appointments.models - DEBUG - Appointment Firma Panavia Aircraft GmbH FS-PA 85E WBA65GP040N362472 ohne Termin.
2025-11-17 12:54:51,652 - ispa_next.appointments.models - DEBUG - Appointment Meisterbetrieb Thomas Patitz  WBA21GW060CU43030 ohne Termin.
2025-11-17 12:54:51,664 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Hanika M-WH 6500 WBA4K31030BG88527 ohne Termin.
2025-11-17 12:54:51,679 - ispa_next.appointments.models - DEBUG - Appointment Nina Bernreuther M-NN 369 WMWLV310502L56279 ohne Termin.
2025-11-17 12:54:51,680 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,698 - ispa_next.appointments.models - DEBUG - Appointment Ladislav Kilisek M-JO 1742 WBA2A310207A62139 ohne Termin.
2025-11-17 12:54:51,709 - ispa_next.appointments.models - DEBUG - Appointment Ihor Karnakov M-KA 5871E WBA6N31070FM27147 ohne Termin.
2025-11-17 12:54:51,727 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke AG M-NP 3316 WMW21GA0407S97954 ohne Termin.
2025-11-17 12:54:51,742 - ispa_next.appointments.models - DEBUG - Appointment Ibrahim Yazar M-YA 29 WBA6V710005P54227 ohne Termin.
2025-11-17 12:54:51,757 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-17 12:54:51,770 - ispa_next.appointments.models - DEBUG - Appointment Mehmet Erkek M-E 2228 WBACV01050LK56174 ohne Termin.
2025-11-17 12:54:51,791 - ispa_next.appointments.models - DEBUG - Appointment Joachim Schubert M-JS 2161 WBA51AB0105U16063 ohne Termin.
2025-11-17 12:54:51,808 - ispa_next.appointments.models - DEBUG - Appointment Imer Jakupi M-LJ 1824 WBA11DY090FK02746 ohne Termin.
2025-11-17 12:54:51,821 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Wydra M-W 5397 WBAJC91010B280060 ohne Termin.
2025-11-17 12:54:51,833 - ispa_next.appointments.models - DEBUG - Appointment   WBABS51040EW00681 ohne Termin.
2025-11-17 12:54:51,844 - ispa_next.appointments.models - DEBUG - Appointment Erwin Jaksch M-EJ 69 WBABG11010ER37920 ohne Termin.
2025-11-17 12:54:51,857 - ispa_next.appointments.models - DEBUG - Appointment Eduard Grimm M-EG 3011 WBS1H91060V916418 ohne Termin.
2025-11-17 12:54:51,869 - ispa_next.appointments.models - DEBUG - Appointment Tarik Sahin M-X 3330 WBAJK51000BJ13877 ohne Termin.
2025-11-17 12:54:51,882 - ispa_next.appointments.models - DEBUG - Appointment Firma ACTRON AG ED-AG 444 WBA5R11080FN22370 ohne Termin.
2025-11-17 12:54:51,893 - ispa_next.appointments.models - DEBUG - Appointment Anja Goetzke M-AG 565 WBAJU810409L17973 ohne Termin.
2025-11-17 12:54:51,912 - ispa_next.appointments.models - DEBUG - Appointment Marco Hübl  WBA21EN0009X29619 ohne Termin.
2025-11-17 12:54:51,924 - ispa_next.appointments.models - DEBUG - Appointment Narayanaswamy Anand M-SN 554 WMWLV710302L69958 ohne Termin.
2025-11-17 12:54:51,936 - ispa_next.appointments.models - DEBUG - Appointment Soria-Vanessa Neumann FS-N 347 WBA2H71010VA14727 ohne Termin.
2025-11-17 12:54:51,936 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:54:51,951 - ispa_next.appointments.models - DEBUG - Appointment Firma ProSiebenSat.1 Media SE M-P 7308 E WBA21EF0405Z47312 ohne Termin.
2025-11-17 12:54:52,006 - ispa_next.main - DEBUG - Found 20 out of 187 appointments to process (configured limit: 20).
2025-11-17 12:54:52,007 - ispa_next.main - DEBUG - Processing 20 fresh appointments.
2025-11-17 12:54:52,007 - ispa_next.main - DEBUG - All appointments: M-K 1636, M-XM 6099E , PF-DN 2121, M-NC 1407, EBE-B 5739, M-S 9974 E, KEIN KENNZEICHEN, M-J 7575, FS-LD 65, M-AX 5373, LA-M 989, M-M 7462 E, M-BF 5550, M-TL 8788, M-BF 5550, WI-RV 268 E, M-AZ 2406, M-E 9102, M-L 7780 E, M-L 6868
2025-11-17 12:54:52,010 - ispa_next.main - DEBUG - 



2025-11-17 12:54:52,010 - ispa_next.main - DEBUG - starting with process 1 (M-K 1636) of 20
2025-11-17 12:54:52,015 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:54:52,994 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:54:54,086 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:54:54,088 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 398
2025-11-17 12:54:55,435 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:54:55,437 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:07,883 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:55:07,974 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:55:07,979 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:08,508 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:55:08,509 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:10,573 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:55:10,574 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:11,320 - ispa_next.main - DEBUG - 



2025-11-17 12:55:11,320 - ispa_next.main - DEBUG - starting with process 2 (M-XM 6099E ) of 20
2025-11-17 12:55:11,325 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:55:12,443 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:13,668 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:55:13,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:55:14,918 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:14,919 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:26,711 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:55:26,719 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:55:26,723 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:27,110 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:55:27,111 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:29,023 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:55:29,024 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:29,683 - ispa_next.main - DEBUG - 



2025-11-17 12:55:29,683 - ispa_next.main - DEBUG - starting with process 3 (PF-DN 2121) of 20
2025-11-17 12:55:29,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:55:30,479 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:31,286 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:55:31,287 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:55:32,365 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:32,370 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:42,985 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:55:42,993 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 12:55:42,998 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:43,540 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:55:43,542 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:45,838 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:55:45,839 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:55:46,577 - ispa_next.main - DEBUG - 



2025-11-17 12:55:46,578 - ispa_next.main - DEBUG - starting with process 4 (M-NC 1407) of 20
2025-11-17 12:55:46,583 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:55:47,514 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:48,471 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:55:48,472 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:55:49,634 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:55:49,635 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:00,877 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:56:00,886 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 12:56:00,891 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:56:01,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:56:01,335 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:56:03,801 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:56:03,802 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:04,655 - ispa_next.main - DEBUG - 



2025-11-17 12:56:04,656 - ispa_next.main - DEBUG - starting with process 5 (EBE-B 5739) of 20
2025-11-17 12:56:04,660 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:56:05,933 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:56:07,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:56:07,017 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:56:08,335 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:56:08,338 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:31,665 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:56:41,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:43,221 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:56:43,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:56:43,282 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:56:43,462 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:56:43,465 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:56:46,182 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:56:46,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:56:46,355 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 12:56:46,644 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 12:56:46,661 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:56:46,662 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:56:47,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:56:47,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:56:47,745 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:56:47,785 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:56:49,845 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 12:56:49,849 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:56:50,658 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:56:50,660 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:56:53,296 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:56:53,296 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:54,168 - ispa_next.main - DEBUG - 



2025-11-17 12:56:54,168 - ispa_next.main - DEBUG - starting with process 6 (M-S 9974 E) of 20
2025-11-17 12:56:54,183 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:56:55,093 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:56:55,865 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:56:55,866 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:56:56,866 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:56:56,867 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:57:19,693 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:57:29,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:57:31,040 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:57:31,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:31,115 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:57:31,383 - ispa_next.functions - DEBUG - HU date soon to be invalid in 77 days.
2025-11-17 12:57:38,013 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:57:38,017 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:57:40,845 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:57:40,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:57:41,012 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 12:57:41,306 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 12:57:41,325 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:57:41,325 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:57:41,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:57:42,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:57:42,609 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 12:57:42,638 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:57:44,702 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:57:44,706 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:57:45,630 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:57:45,631 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:57:48,275 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:57:48,276 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:57:49,074 - ispa_next.main - DEBUG - 



2025-11-17 12:57:49,074 - ispa_next.main - DEBUG - starting with process 7 (KEIN KENNZEICHEN) of 20
2025-11-17 12:57:49,080 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:57:50,249 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:57:51,356 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:57:51,357 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:57:52,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:57:52,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:03,249 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 12:58:03,258 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 12:58:03,263 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:58:03,794 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:58:03,796 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:58:06,247 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 12:58:06,248 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:07,084 - ispa_next.main - DEBUG - 



2025-11-17 12:58:07,084 - ispa_next.main - DEBUG - starting with process 8 (M-J 7575) of 20
2025-11-17 12:58:07,089 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:58:08,240 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:58:09,493 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 12:58:09,494 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 12:58:10,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:58:10,834 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:58:36,880 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:58:46,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:58:48,022 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:58:48,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:48,101 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:58:48,442 - ispa_next.functions - DEBUG - HU date soon to be invalid in 40 days.
2025-11-17 12:58:54,545 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:58:54,550 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:58:57,413 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:58:57,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:58,357 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:59:00,363 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:59:00,462 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:59:03,712 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:59:03,781 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:59:03,781 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:59:15,244 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:59:16,250 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:59:16,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:59:16,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:59:27,772 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:59:27,772 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:59:34,080 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:59:34,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:59:34,140 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:59:34,141 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:59:34,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:59:35,377 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:59:35,648 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:59:38,533 - ispa_next.functions - DEBUG - Updated appointment (AB00017609) customer contact data.
2025-11-17 12:59:39,452 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:59:39,455 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:59:40,148 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:59:40,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:59:40,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:59:44,889 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:59:44,890 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:59:44,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:59:45,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:59:47,414 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:59:47,513 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:59:47,638 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:59:47,709 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:59:47,710 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:59:59,166 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:00:59,170 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:01:10,587 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:01:37,590 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:01:48,979 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:01:56,291 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:01:56,291 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:02:00,508 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:02:01,523 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:02:01,528 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:02:01,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:02:01,621 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:02:02,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:02:02,523 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:02:02,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:02:03,115 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:02:03,116 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:02:05,007 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:02:05,009 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:02:05,944 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:02:05,945 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:02:05,947 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:02:05,957 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:02:05,961 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:02:05,963 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:02:05,965 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:02:05,968 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:02:05,970 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:02:05,971 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:02:05,976 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:02:05,980 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:02:05,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:07,855 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:02:07,859 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:02:07,864 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:09,850 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:02:09,854 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:02:09,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:02:10,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:02:11,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:20,425 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:02:20,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:22,380 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:02:33,267 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:02:33,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:02:34,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:02:34,467 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:53,137 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:02:57,729 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:02:57,733 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:02:57,734 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:02:58,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:02:58,265 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:02:58,268 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:02:59,517 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:03:09,371 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:03:09,749 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 13:03:10,244 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:03:11,370 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:03:11,372 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:03:14,470 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 13:03:14,471 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:15,252 - ispa_next.main - DEBUG - 



2025-11-17 13:03:15,252 - ispa_next.main - DEBUG - starting with process 9 (FS-LD 65) of 20
2025-11-17 13:03:15,258 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:03:16,656 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:03:18,020 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:03:18,021 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 13:03:19,461 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:03:19,462 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:53,610 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:04:03,456 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:04:05,407 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:04:05,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:05,504 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:04:05,757 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:04:05,761 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:04:08,711 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:04:08,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:09,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:04:11,680 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:04:11,796 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:04:15,011 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:04:21,723 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 13:04:22,727 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:04:22,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:23,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:37,450 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:04:45,450 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:04:45,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:45,524 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:04:45,525 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:04:45,614 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:04:46,942 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:04:48,071 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:04:48,303 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:04:49,991 - ispa_next.functions - DEBUG - Updated appointment (AB00017607) customer contact data.
2025-11-17 13:04:50,894 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:04:50,897 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:04:51,493 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:04:51,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:04:52,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:04:56,215 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:04:56,215 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:04:56,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:56,723 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:04:58,726 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:04:58,848 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:04:58,968 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:04:59,061 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:04:59,061 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:05:11,268 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:06:11,271 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:06:22,047 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:06:29,268 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:06:29,268 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:06:33,473 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:06:34,481 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:06:34,486 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:06:34,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:34,616 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:06:35,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:35,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:35,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:36,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:06:36,319 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:06:38,204 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:06:38,205 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:06:39,167 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:06:39,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:06:39,180 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:06:39,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:06:39,183 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:06:39,184 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:06:39,185 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:06:39,187 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:06:39,188 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:06:39,189 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:06:39,193 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:06:39,197 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:06:39,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:41,072 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:06:41,075 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:06:41,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:43,021 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:06:43,024 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:06:43,025 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:06:43,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:06:44,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:55,098 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:06:55,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:57,058 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:07:07,029 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:07:07,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:07:08,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:07:08,240 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:07:26,408 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:07:31,012 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:07:31,015 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:07:31,016 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:31,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:07:31,728 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:07:31,730 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:07:33,688 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:07:42,178 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:07:42,561 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 13:07:42,970 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:44,023 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:07:44,024 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:46,425 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 13:07:46,426 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:47,204 - ispa_next.main - DEBUG - 



2025-11-17 13:07:47,204 - ispa_next.main - DEBUG - starting with process 10 (M-AX 5373) of 20
2025-11-17 13:07:47,209 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:48,110 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:48,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:07:48,967 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 13:07:50,204 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:50,205 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:20,405 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:08:30,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:30,314 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:30,497 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:08:32,461 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:08:32,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:32,561 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:08:32,743 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:08:32,748 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:08:35,440 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:08:35,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:08:36,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:08:38,534 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:08:38,674 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:08:41,904 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:08:48,970 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 13:08:49,979 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:08:49,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:08:50,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:03,185 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:09:09,741 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:09:09,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:09:09,835 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:09:09,836 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:09:09,870 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:09:11,101 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:09:11,416 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:09:14,599 - ispa_next.functions - DEBUG - Updated appointment (AG00009786) customer contact data.
2025-11-17 13:09:15,562 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:09:15,569 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:09:16,477 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:09:16,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:09:17,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:09:21,254 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:09:21,254 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:09:21,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:09:21,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:09:23,824 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:09:23,921 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:09:24,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:09:24,115 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:09:24,117 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:09:35,659 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:10:35,661 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:10:46,447 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:10:53,526 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:10:53,526 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:10:57,722 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:10:58,763 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:10:58,768 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:10:58,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:10:58,835 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:10:59,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:10:59,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:10:59,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:11:00,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:11:00,608 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:11:02,444 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:11:02,450 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:11:03,349 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:11:03,363 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:11:03,365 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:11:03,367 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:11:03,368 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:11:03,369 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:11:03,370 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:11:03,371 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:11:03,372 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:11:03,373 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:11:03,377 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:11:03,380 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:11:03,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:05,257 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:11:05,259 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:11:05,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:07,133 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:11:07,155 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:11:07,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:11:07,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:11:07,983 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:17,079 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:11:17,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:18,981 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:11:29,881 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:11:30,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:11:30,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:11:31,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:48,773 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:11:53,889 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:11:53,893 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:11:53,894 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:54,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:11:54,647 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:11:54,650 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:11:56,574 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:12:04,644 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:12:05,041 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 13:12:05,504 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:06,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:12:06,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:09,711 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 13:12:09,712 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:10,516 - ispa_next.main - DEBUG - 



2025-11-17 13:12:10,516 - ispa_next.main - DEBUG - starting with process 11 (LA-M 989) of 20
2025-11-17 13:12:10,524 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:11,724 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:12,894 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:12:12,895 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 13:12:14,415 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:14,417 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:50,734 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:13:01,144 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:03,055 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:13:03,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:03,183 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:03,405 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:13:03,409 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:13:06,272 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:06,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:07,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:09,234 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:13:09,367 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:13:12,602 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:13:12,673 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:13:12,674 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:13:24,135 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:13:25,149 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:13:25,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:25,684 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:38,305 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:13:46,018 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:13:46,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:46,116 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:46,116 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:13:46,163 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:13:47,465 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:13:48,641 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:13:48,866 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:13:51,809 - ispa_next.functions - DEBUG - Updated appointment (AB00017590) customer contact data.
2025-11-17 13:13:52,763 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:13:52,767 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:13:53,815 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:13:53,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:13:54,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:13:58,548 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:13:58,548 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:58,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:59,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:01,054 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:14:01,184 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:14:01,300 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:14:01,443 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:14:01,444 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:14:12,284 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:14:19,302 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:14:19,302 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:14:23,469 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:14:24,477 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:14:24,480 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:14:24,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:24,594 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:14:24,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:25,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:25,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:26,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:26,267 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:14:28,175 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:14:28,177 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:14:28,943 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:14:28,945 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:14:28,948 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:14:28,955 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:14:28,960 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:14:28,962 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:14:28,964 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:14:28,965 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:14:28,968 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:14:28,971 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:14:28,975 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:14:28,978 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:14:28,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:30,861 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:14:30,864 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:14:30,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:32,799 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:14:32,803 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:14:32,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:14:33,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:14:33,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:44,447 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:14:44,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:14:46,394 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:14:57,565 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:14:58,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:14:58,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:14:58,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:15:17,182 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:15:21,592 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:15:21,595 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:15:21,596 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:22,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:15:22,311 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:15:22,314 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:15:24,223 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:15:32,268 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:15:32,649 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 13:15:33,098 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:34,337 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:15:34,338 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:37,317 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 13:15:37,318 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:15:38,201 - ispa_next.main - DEBUG - 



2025-11-17 13:15:38,201 - ispa_next.main - DEBUG - starting with process 12 (M-M 7462 E) of 20
2025-11-17 13:15:38,213 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:39,048 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:39,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:15:39,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 13:15:41,061 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:41,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:16:09,353 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:16:18,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:22,616 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:16:22,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:22,722 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:16:22,869 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:16:22,874 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:16:25,829 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:16:25,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:26,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:28,925 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:16:29,037 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:16:29,122 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:16:29,224 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:16:29,224 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:16:40,547 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:16:41,557 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:16:41,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:42,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:50,608 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:16:58,874 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:16:58,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:58,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:16:58,943 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:16:59,002 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:17:00,276 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:17:00,505 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:17:03,503 - ispa_next.functions - DEBUG - Updated appointment (AB00017589) customer contact data.
2025-11-17 13:17:04,423 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:17:04,426 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:17:05,009 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:17:05,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:17:06,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:17:10,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:17:10,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:11,247 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:13,250 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:17:13,360 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:13,485 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:17:13,565 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:17:13,565 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:17:24,590 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:17:31,597 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:17:31,598 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:17:33,718 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:17:34,765 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:17:34,771 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:17:34,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:34,847 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:17:35,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:35,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:35,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:36,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:36,568 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:17:43,709 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:17:43,711 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:17:44,742 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:17:44,744 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:17:44,746 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:17:44,747 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:17:44,748 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:17:44,752 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:17:44,756 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:17:44,768 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:17:44,770 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:17:44,775 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:17:44,779 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:17:44,782 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:17:44,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:53,048 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:17:55,637 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:17:55,680 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:17:55,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:03,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:03,816 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:18:13,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:31,444 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:18:31,447 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:18:31,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:18:32,197 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:18:32,399 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:45,591 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:18:45,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:53,803 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:19:05,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:13,826 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 13:19:13,831 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:19:14,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:19:14,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:19:14,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:34,895 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:39,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:43,334 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:47,809 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:52,444 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:57,279 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:21:03,193 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:21:09,767 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:21:09,770 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:21:10,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:21:10,651 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:21:10,654 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:21:14,676 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:21:24,586 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:21:24,961 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 13:21:26,302 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:27,052 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:21:27,053 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:30,314 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 13:21:30,315 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:21:31,095 - ispa_next.main - DEBUG - 



2025-11-17 13:21:31,095 - ispa_next.main - DEBUG - starting with process 13 (M-BF 5550) of 20
2025-11-17 13:21:31,099 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:21:32,355 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:33,557 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 807
2025-11-17 13:21:33,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 13:21:34,909 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:34,910 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:22:11,482 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:22:21,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:21,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:22:21,669 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:26,399 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:22:26,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:26,464 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:22:26,716 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:22:26,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:26,837 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:22:41,329 - ispa_next.common.mail - INFO - Successfully sent an email to 6 recipients
2025-11-17 13:22:41,334 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:22:44,219 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:22:44,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:22:45,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:22:47,866 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:22:47,969 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:22:51,191 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:22:51,269 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:22:51,269 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:23:02,981 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:23:03,986 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:23:03,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:04,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:16,778 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:23:16,778 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:23:24,718 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:23:24,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:24,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:23:24,799 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:23:24,842 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:23:24,971 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:23:26,281 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:23:26,526 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:23:31,155 - ispa_next.functions - DEBUG - Updated appointment (AA00022912) customer contact data.
2025-11-17 13:23:32,091 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:23:32,095 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:23:32,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:23:33,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:23:34,563 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:23:34,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:23:34,628 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:23:38,221 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:23:38,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:23:38,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:23:40,770 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:23:40,945 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:23:41,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:23:41,115 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:23:41,115 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:23:52,715 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:24:52,717 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:25:04,086 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:25:12,090 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:25:23,577 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:25:32,026 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:25:33,035 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:25:33,040 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:25:33,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:33,124 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:25:33,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:34,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:34,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:34,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:25:34,873 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:25:39,140 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:25:39,143 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:25:40,564 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:25:40,581 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:25:40,583 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:25:40,584 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:25:40,586 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:25:40,588 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:25:40,590 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:25:40,605 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:25:40,610 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:25:40,612 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:25:40,616 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:25:40,619 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:25:40,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:45,406 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:25:45,409 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:25:45,413 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:50,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:50,105 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:25:58,636 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:13,964 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:26:13,968 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:26:13,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:26:14,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:26:14,735 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:26:14,739 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:19,407 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:26:30,939 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:26:31,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:26:31,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:26:32,070 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:18,155 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:22,705 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:28,823 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:27:28,824 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:29,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:29,577 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:27:29,580 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:27:33,076 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:27:41,745 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:27:42,143 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 13:27:43,443 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:27:44,263 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 808
2025-11-17 13:27:44,264 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:27:47,399 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 13:27:47,400 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:27:48,346 - ispa_next.main - DEBUG - Found new Appointment: FS-HP 730
2025-11-17 13:27:48,348 - ispa_next.main - DEBUG - 



2025-11-17 13:27:48,348 - ispa_next.main - DEBUG - starting with process 14 (FS-HP 730) of 21
2025-11-17 13:27:48,353 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:49,486 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:27:50,687 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 808
2025-11-17 13:27:50,687 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 13:27:52,122 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:27:52,123 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:30,896 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:28:41,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:41,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:28:41,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:43,312 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:28:43,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:43,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:28:43,593 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:28:43,606 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:28:46,477 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:28:46,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:28:47,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:28:49,645 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:28:49,791 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:28:53,020 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:28:53,094 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:28:53,095 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:29:04,662 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:29:05,668 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:29:05,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:06,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:17,794 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:29:25,490 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:29:25,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:29:25,602 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:29:25,603 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:29:25,649 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:29:25,741 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:29:26,850 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 13:29:28,051 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 13:29:28,372 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:29:31,930 - ispa_next.functions - DEBUG - Updated appointment (AA00023760) customer contact data.
2025-11-17 13:29:32,871 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:29:32,874 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:29:33,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:29:34,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:29:35,645 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:29:35,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:29:35,709 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:29:39,312 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:29:39,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:29:39,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:29:41,829 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:29:41,948 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:29:42,043 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:29:42,134 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:29:42,135 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:29:53,427 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:30:53,429 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:31:05,162 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:31:31,165 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:31:42,655 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:31:50,401 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:31:51,409 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:31:51,412 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:31:51,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:51,504 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:31:51,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:52,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:52,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:53,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:53,271 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:31:55,204 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:31:55,206 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:31:56,643 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:31:56,645 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:31:56,646 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:31:56,647 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:31:56,649 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:31:56,650 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:31:56,651 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:31:56,658 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:31:56,661 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:31:56,664 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:31:56,669 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:31:56,672 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:31:56,673 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:58,642 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:31:58,645 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:31:58,647 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:00,679 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:32:00,682 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:32:00,683 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:32:01,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:32:01,421 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:32:01,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:03,302 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:32:14,064 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:32:14,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:32:15,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:32:15,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:33,282 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:32:37,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:32:37,968 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:32:37,969 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:32:38,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:32:38,650 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:32:38,653 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:32:40,264 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:32:53,519 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 13:32:53,523 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:32:53,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:32:56,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:32:56,230 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:32:56,233 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:32:57,785 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 13:32:57,811 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:32:59,981 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 13:32:59,986 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:33:01,167 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 808
2025-11-17 13:33:01,169 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:33:04,203 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 13:33:04,204 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:33:05,074 - ispa_next.main - DEBUG - 



2025-11-17 13:33:05,074 - ispa_next.main - DEBUG - starting with process 15 (M-TL 8788) of 21
2025-11-17 13:33:05,083 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:33:06,241 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:33:07,536 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 808
2025-11-17 13:33:07,537 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 13:33:08,913 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:33:08,913 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:33:37,124 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:33:47,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:47,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:33:47,719 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:49,701 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:33:49,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:49,819 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:33:50,012 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:33:50,016 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:33:52,924 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:33:52,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:54,151 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:56,159 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:33:56,257 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:33:59,549 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:33:59,639 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:33:59,639 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:34:11,139 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:34:12,156 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:34:12,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:34:12,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:34:24,045 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:34:31,648 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:34:31,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:34:31,723 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:34:31,724 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:34:31,788 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:34:33,079 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:34:33,302 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:34:38,056 - ispa_next.functions - DEBUG - Updated appointment (AA00022911) customer contact data.
2025-11-17 13:34:38,974 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:34:38,977 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:34:39,701 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:34:39,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:34:40,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:34:44,154 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:34:44,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:34:44,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:34:46,661 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:34:46,784 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:34:46,917 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:34:47,039 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:34:47,040 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:34:58,597 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:35:58,600 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:36:09,432 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:36:16,616 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:36:16,616 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:36:20,801 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:36:21,808 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:36:21,813 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:36:21,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:21,888 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:36:22,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:22,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:36:22,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:36:23,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:36:23,514 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:36:25,504 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:36:25,506 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:36:26,548 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:36:26,551 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:26,553 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Rädereinlagerung, source=from_tab, target=cart)}
2025-11-17 13:36:26,555 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:36:26,570 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:36:26,572 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:36:26,573 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:36:26,575 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=Räder einlagern, source=cart, target=trash)}
2025-11-17 13:36:26,576 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:36:26,577 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:36:26,579 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:36:27,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:36:27,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:36:33,357 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:36:33,358 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:36:35,422 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:36:35,984 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:36:37,891 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:36:38,443 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:36:38,990 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:36:39,930 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:36:40,520 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:36:41,044 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:36:41,961 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:36:42,807 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:36:42,811 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:36:42,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:45,206 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:36:45,209 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:36:45,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:47,121 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:36:47,124 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:36:47,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:36:47,895 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:36:48,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:57,203 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:36:57,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:59,195 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:37:10,491 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:37:11,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:37:11,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:37:11,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:37:30,179 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:34,989 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:37:34,992 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:37:34,993 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:37:35,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:37:35,725 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:37:35,728 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:37:37,492 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:37:45,547 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:37:45,950 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 13:37:46,646 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:37:47,948 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 808
2025-11-17 13:37:47,948 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:37:50,910 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 407
2025-11-17 13:37:50,911 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:37:51,733 - ispa_next.main - DEBUG - 



2025-11-17 13:37:51,733 - ispa_next.main - DEBUG - starting with process 16 (M-BF 5550) of 21
2025-11-17 13:37:51,738 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:37:52,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:37:53,804 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 808
2025-11-17 13:37:53,805 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 407
2025-11-17 13:37:55,113 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:37:55,115 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:38:27,405 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:38:36,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:38:38,726 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:38:38,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:38:38,832 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:38:39,006 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:38:39,010 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:38:41,826 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:38:41,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:38:43,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:38:45,009 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:38:45,114 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:38:48,382 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:38:48,479 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:38:48,479 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:39:00,053 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:39:01,059 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:39:01,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:01,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:13,212 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:39:13,213 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:39:20,183 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:39:20,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:20,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:20,285 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:39:20,336 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:39:20,489 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:39:21,741 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:39:21,947 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:39:25,586 - ispa_next.functions - DEBUG - Updated appointment (AB00017579) customer contact data.
2025-11-17 13:39:26,544 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:39:26,547 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:39:26,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:39:27,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:39:28,997 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:39:28,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:39:29,081 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:39:32,650 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:39:32,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:39:33,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:39:35,159 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:39:35,279 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:39:35,423 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:39:35,493 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:39:35,493 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:39:46,862 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:40:46,865 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:40:58,265 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:41:28,268 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:41:40,105 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:41:48,280 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:41:49,287 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:41:49,290 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:41:49,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:49,426 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:41:49,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:50,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:50,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:51,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:41:51,302 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:41:53,270 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:41:53,272 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:41:54,632 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:41:54,633 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:41:54,634 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:41:54,635 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:41:54,637 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:41:54,638 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:41:54,639 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:41:54,640 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:41:54,641 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:41:54,642 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:41:54,646 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:41:54,649 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:41:54,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:56,619 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:41:56,621 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:41:56,624 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:58,575 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:41:58,577 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:41:58,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:41:59,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:41:59,391 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:41:59,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:01,257 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:42:11,364 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:42:11,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:42:12,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:42:12,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:30,721 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:42:35,535 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:42:35,538 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:42:35,538 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:42:36,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:42:36,219 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:42:36,221 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:42:37,693 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:42:45,301 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:42:45,698 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 13:42:46,101 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:42:47,584 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:42:47,585 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:42:50,851 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 13:42:50,852 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:42:51,719 - ispa_next.appointments.models - DEBUG - Appointment Ulrike Simon FS-PP 494 E WBY61EF0005071924 ohne Termin.
2025-11-17 13:42:51,740 - ispa_next.main - DEBUG - 



2025-11-17 13:42:51,740 - ispa_next.main - DEBUG - starting with process 17 (WI-RV 268 E) of 21
2025-11-17 13:42:51,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:42:52,903 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:42:54,195 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:42:54,197 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 13:42:55,772 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:42:55,773 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:43:26,881 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:43:37,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:43:43,083 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:43:43,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:43:43,157 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:43:43,398 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:43:43,402 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:43:46,258 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:43:46,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:43:47,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:43:49,466 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:43:49,637 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:43:49,724 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:43:49,824 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:43:49,824 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:44:01,519 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:44:02,538 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:44:02,538 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:03,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:17,589 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:44:25,262 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:44:25,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:44:25,350 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:44:25,351 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:44:25,383 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:44:26,551 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:44:27,519 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 13:44:28,668 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 13:44:29,031 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:44:32,502 - ispa_next.functions - DEBUG - Updated appointment (AB00017559) customer contact data.
2025-11-17 13:44:33,388 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:44:33,391 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:44:34,287 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:44:34,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:44:35,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:44:38,897 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:44:38,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:44:39,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:44:41,414 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:44:41,519 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:44:41,611 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:44:41,700 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:44:41,700 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:44:52,720 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:44:59,982 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:44:59,983 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:45:04,234 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:45:05,241 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:45:05,245 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:45:05,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:45:05,361 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:45:15,381 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 13:45:25,635 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 13:45:25,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:26,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:45:26,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:45:27,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:45:27,367 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:45:32,239 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:45:32,241 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:45:33,406 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:45:33,408 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:45:33,410 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 13:45:33,411 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:45:33,413 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 13:45:33,414 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:45:33,415 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:45:33,416 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:45:33,418 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:45:33,420 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:45:55,460 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:45:55,461 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:45:58,137 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:45:58,663 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:45:59,590 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:00,186 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:00,726 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:01,693 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:02,247 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:02,784 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:03,696 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:04,280 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:04,817 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:05,813 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:06,380 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:07,063 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:07,970 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:08,561 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:09,099 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:10,029 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:10,588 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:11,111 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:12,643 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:13,214 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:13,906 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:46:14,838 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:16,145 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:46:17,084 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:46:17,744 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 13:46:23,372 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:46:23,376 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:46:23,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:28,982 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:46:32,051 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:46:32,055 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:46:32,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:37,992 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:46:37,995 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:46:37,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:46:38,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:46:39,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:51,758 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:46:51,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:57,199 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:47:09,379 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:47:09,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:47:10,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:47:10,539 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:48:03,261 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:48:07,941 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:48:12,828 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:48:19,209 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:48:19,210 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:48:19,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:48:20,044 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:48:20,047 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:48:23,628 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:48:32,796 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:48:33,164 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 13:48:33,790 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:48:35,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:48:35,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:48:38,030 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 13:48:38,031 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:48:38,929 - ispa_next.appointments.models - DEBUG - Appointment Ulrike Simon FS-PP 494 E WBY61EF0005071924 ohne Termin.
2025-11-17 13:48:38,954 - ispa_next.main - DEBUG - 



2025-11-17 13:48:38,954 - ispa_next.main - DEBUG - starting with process 18 (M-AZ 2406) of 21
2025-11-17 13:48:38,972 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:48:40,161 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:48:41,283 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:48:41,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 13:48:42,876 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:48:42,878 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:49:15,160 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:49:25,535 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:27,518 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:49:27,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:27,602 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:49:27,852 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:49:27,856 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:49:30,686 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:49:30,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:49:31,998 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:49:34,003 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:49:40,488 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 13:49:47,577 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 13:49:48,583 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:49:48,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:49:49,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:01,851 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:50:09,704 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:50:09,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:09,794 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:50:09,795 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:50:09,827 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:50:09,959 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:50:11,172 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:50:11,388 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:50:15,111 - ispa_next.functions - DEBUG - Updated appointment (AB00017558) customer contact data.
2025-11-17 13:50:16,087 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:50:16,090 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:50:16,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:50:17,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:50:18,491 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:50:18,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:50:18,562 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:50:22,175 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:50:22,175 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:50:22,179 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:50:22,183 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:50:22,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:50:22,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:50:23,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:23,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:50:23,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:50:24,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:50:24,309 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:50:26,220 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:50:26,225 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:50:27,621 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:50:27,623 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:50:27,624 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:50:27,625 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:50:27,627 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:50:27,628 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:50:27,628 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:50:27,630 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:50:27,631 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:50:27,632 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:50:27,636 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:50:27,639 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:50:27,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:29,614 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:50:29,617 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:50:29,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:31,618 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:50:31,621 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:50:31,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:50:32,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:50:32,610 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:50:32,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:50:34,570 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:50:45,780 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:50:46,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:50:46,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:50:47,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:51:06,018 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:51:10,275 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:51:10,279 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:51:10,280 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:51:10,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:51:10,887 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:51:10,890 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:51:12,806 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:51:20,973 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:51:21,349 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 13:51:21,883 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:51:23,379 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:51:23,380 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:26,503 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 13:51:26,504 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:51:27,287 - ispa_next.main - DEBUG - Found new Appointment: FS-PP 494 E
2025-11-17 13:51:27,291 - ispa_next.main - DEBUG - 



2025-11-17 13:51:27,291 - ispa_next.main - DEBUG - starting with process 19 (FS-PP 494 E) of 22
2025-11-17 13:51:27,295 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:51:28,508 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:51:29,748 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:51:29,750 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 13:51:31,475 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:31,477 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:52:01,691 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:52:12,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:12,593 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:12,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:52:14,703 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:52:14,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:14,808 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:15,104 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:52:15,108 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:52:18,042 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:52:18,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:52:19,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:52:21,402 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:52:21,507 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:52:24,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:52:24,872 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:52:24,872 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:52:36,561 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:52:37,567 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:52:37,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:38,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:51,189 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:52:58,329 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:52:58,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:52:58,423 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:52:58,424 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:52:58,460 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:52:59,670 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:52:59,877 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:53:05,081 - ispa_next.functions - DEBUG - Updated appointment (AA00023761) customer contact data.
2025-11-17 13:53:05,977 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:53:05,980 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:53:06,964 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:53:06,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:53:07,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:53:11,859 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 13:53:11,860 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:53:11,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:53:12,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:53:14,351 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:53:14,464 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:53:14,571 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:53:14,648 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:53:14,649 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:53:26,813 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:53:34,016 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:53:34,016 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:53:38,167 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:53:39,174 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:53:39,179 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:53:39,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:53:39,273 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:53:44,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:45,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:45,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:53:46,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:53:46,157 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:53:48,682 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:53:48,683 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:53:49,734 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:53:49,744 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:53:49,746 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:53:49,748 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:53:49,749 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 13:53:49,751 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:53:49,753 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:53:49,753 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:53:49,754 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:53:49,756 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:53:51,830 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:53:52,375 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:53:53,292 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:53:53,866 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:53:54,402 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:53:55,335 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:53:55,890 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:53:56,415 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:53:58,143 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:53:59,603 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:54:00,579 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 13:54:01,024 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:54:01,072 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:54:01,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:03,050 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:54:03,052 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:54:03,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:04,978 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:54:04,981 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:54:04,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:54:06,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:54:06,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:21,375 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:54:21,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:23,278 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:54:34,360 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:54:34,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:54:35,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:54:35,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:53,793 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:54:59,104 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:54:59,107 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:54:59,107 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:54:59,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:54:59,839 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:54:59,842 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:55:01,746 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:55:10,044 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:55:10,441 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 13:55:10,881 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:55:12,312 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:55:12,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:55:15,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 13:55:15,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:55:16,413 - ispa_next.main - DEBUG - 



2025-11-17 13:55:16,413 - ispa_next.main - DEBUG - starting with process 20 (M-E 9102) of 22
2025-11-17 13:55:16,419 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:55:17,664 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:55:18,813 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 13:55:18,814 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 13:55:20,464 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:55:20,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:55:52,923 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:56:03,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:05,053 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:56:05,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:05,186 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:56:05,377 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:56:05,381 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:56:08,212 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:56:08,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:09,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:56:11,979 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:56:12,151 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:56:15,389 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:56:24,260 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 13:56:25,265 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:56:25,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:25,818 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:37,240 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:56:37,240 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 13:56:44,658 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:56:44,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:56:44,763 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:56:44,764 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:56:44,804 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:56:46,542 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:56:47,669 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:56:47,897 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:56:51,370 - ispa_next.functions - DEBUG - Updated appointment (AB00017550) customer contact data.
2025-11-17 13:56:52,288 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:56:52,291 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:56:53,194 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:56:53,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:56:54,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:56:58,248 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 13:56:58,249 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:56:58,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:56:59,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:57:01,382 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:57:01,481 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:57:01,640 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:57:01,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:57:01,758 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:57:13,521 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:58:13,528 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:58:25,248 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:58:32,558 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:58:32,558 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:58:36,760 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:58:37,768 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:58:37,773 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:58:37,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:37,842 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:58:47,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:48,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:48,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:58:49,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:58:49,156 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:58:51,076 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:58:51,090 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:58:52,144 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:58:52,146 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:58:52,148 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:58:52,151 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:58:52,152 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:58:52,153 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:58:52,154 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:58:52,155 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:58:52,156 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:58:52,157 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:58:52,161 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:58:52,163 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:58:52,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:58:54,027 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:58:54,030 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:58:54,032 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:58:55,995 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:58:55,998 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:58:55,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:58:57,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:58:57,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:08,104 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:59:08,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:10,157 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:59:21,479 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:59:22,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:59:22,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:59:22,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:41,845 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:59:47,260 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:59:47,264 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:59:47,265 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:59:47,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:59:47,997 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:59:48,000 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:59:49,862 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:59:59,022 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:59:59,416 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 14:00:00,050 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:01,616 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 14:00:01,618 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:04,395 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:00:04,396 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:00:05,103 - ispa_next.main - DEBUG - 



2025-11-17 14:00:05,103 - ispa_next.main - DEBUG - starting with process 21 (M-L 7780 E) of 22
2025-11-17 14:00:05,107 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:06,423 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:12,820 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 14:00:12,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:00:15,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:15,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:00:49,896 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:01:00,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:01:02,286 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:01:02,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:02,399 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:02,578 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:01:02,583 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:01:05,457 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:05,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:01:06,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:01:08,909 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:01:09,064 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:01:12,290 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:01:12,393 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:01:12,393 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:01:25,030 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:01:26,037 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:01:26,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:26,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:38,518 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:01:47,375 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:01:47,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:47,465 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:47,466 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:01:47,513 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:01:48,784 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:01:49,056 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:01:53,241 - ispa_next.functions - DEBUG - Updated appointment (AB00017543) customer contact data.
2025-11-17 14:01:54,257 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:01:54,261 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:01:54,920 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:01:54,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:01:55,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:01:59,853 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:01:59,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:59,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:00,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:02,346 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:02:02,472 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:02:02,544 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:02:02,639 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:02:02,640 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:02:13,853 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:02:21,129 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:02:21,129 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:02:25,357 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:02:26,365 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:02:26,370 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:02:26,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:26,434 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:02:36,589 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:02:43,438 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:02:43,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:44,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:44,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:45,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:45,001 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:02:46,877 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:02:46,879 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:02:48,093 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:02:48,095 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:48,096 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 14:02:48,097 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:48,099 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:02:48,100 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:02:48,101 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:02:48,102 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:02:48,104 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:02:48,109 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:02:48,112 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:03:09,919 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:03:10,237 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:03:16,930 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:03:16,933 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:03:16,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:19,787 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:03:19,791 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:03:19,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:22,466 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:03:22,469 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:03:22,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:03:23,781 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:03:24,086 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:36,373 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:03:36,375 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:39,171 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:03:50,052 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:03:50,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:03:51,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:03:51,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:17,092 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:04:22,294 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:04:28,827 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:04:28,830 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:04:28,831 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:04:29,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:04:29,636 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:04:29,639 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:04:31,566 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:04:40,794 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:04:41,186 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-17 14:04:41,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:04:43,281 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 14:04:43,282 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:04:46,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:04:46,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:04:47,927 - ispa_next.main - DEBUG - 



2025-11-17 14:04:47,927 - ispa_next.main - DEBUG - starting with process 22 (M-L 6868) of 22
2025-11-17 14:04:47,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:04:49,153 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:04:50,103 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 14:04:50,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 408
2025-11-17 14:04:51,812 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:04:51,813 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:05:22,950 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:05:33,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:35,870 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:05:35,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:35,979 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:05:36,181 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:05:36,187 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:05:39,165 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:05:39,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:05:40,547 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:05:42,549 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:05:42,642 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:05:45,853 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:05:45,948 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:05:45,948 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:05:57,762 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:05:58,769 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:05:58,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:59,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:09,880 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:06:18,575 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:06:18,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:18,665 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:18,666 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:06:18,775 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:06:20,130 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:06:21,481 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:06:21,743 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:06:25,566 - ispa_next.functions - DEBUG - Updated appointment (AB00017538) customer contact data.
2025-11-17 14:06:26,473 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:06:26,477 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:06:28,635 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:06:28,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:06:29,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:06:33,801 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:06:33,802 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:06:33,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:06:34,297 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:06:36,304 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:06:36,423 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:06:36,532 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:06:36,661 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:06:36,661 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:06:48,273 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:07:48,274 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:08:00,403 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:08:07,594 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:08:07,594 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:08:11,821 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:08:12,829 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:08:12,833 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:08:12,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:12,896 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:08:22,393 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 14:08:27,405 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:08:27,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:28,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:28,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:29,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:08:29,150 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:08:31,095 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:08:31,096 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:08:32,288 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:08:32,289 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:08:32,296 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-17 14:08:32,299 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:08:32,309 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:08:32,311 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:08:32,313 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:08:32,317 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:08:32,320 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:08:32,326 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:08:32,335 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:08:54,353 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:08:54,467 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:09:01,326 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:09:01,329 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:09:01,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:04,193 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:09:04,197 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:09:04,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:06,901 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:09:06,904 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:09:06,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 14:09:08,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 14:09:08,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:19,990 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:09:19,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:22,695 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:09:35,756 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:09:36,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:09:37,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:09:37,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:03,061 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:10:08,442 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:10:15,005 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:10:21,499 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:10:21,500 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:10:22,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:10:22,284 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:10:22,286 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:10:26,178 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:10:33,899 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:10:34,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-17 14:10:34,954 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:10:36,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 809
2025-11-17 14:10:36,525 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:10:39,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 408
2025-11-17 14:10:39,746 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
