2025-11-17 07:00:37,226 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 07:00:37,233 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 07:00:49,033 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:01:00,721 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:01:16,341 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:03:14,961 - ispa_next.app_start.main - DEBUG - Operation already took 107.25 seconds (more than 80 seconds)
2025-11-17 07:03:17,031 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_7du9vxfc_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_7du9vxfc', 'txt']
2025-11-17 07:03:17,355 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:03:17,360 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:03:17,361 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:05:16,761 - ispa_next.app_start.main - DEBUG - Operation already took 107.07 seconds (more than 80 seconds)
2025-11-17 07:05:18,810 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_0y_thnxa_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_0y_thnxa', 'txt']
2025-11-17 07:05:19,073 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:05:19,079 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:05:27,097 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 07:05:34,418 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:05:45,515 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:06:01,013 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:07:58,551 - ispa_next.app_start.main - DEBUG - Operation already took 106.46 seconds (more than 80 seconds)
2025-11-17 07:08:00,621 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_81ng1knx_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_81ng1knx', 'txt']
2025-11-17 07:08:00,855 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:08:00,859 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:08:00,860 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:09:59,894 - ispa_next.app_start.main - DEBUG - Operation already took 106.71 seconds (more than 80 seconds)
2025-11-17 07:10:01,963 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_1i78avni_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_1i78avni', 'txt']
2025-11-17 07:10:02,197 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:10:02,202 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:10:10,523 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 07:10:18,113 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:10:29,265 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:10:44,697 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:12:42,211 - ispa_next.app_start.main - DEBUG - Operation already took 106.43 seconds (more than 80 seconds)
2025-11-17 07:12:44,276 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_bc97nz_b_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_bc97nz_b', 'txt']
2025-11-17 07:12:44,505 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:12:44,510 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:12:44,511 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:14:43,018 - ispa_next.app_start.main - DEBUG - Operation already took 106.22 seconds (more than 80 seconds)
2025-11-17 07:14:45,088 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_7mw97jh9_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_7mw97jh9', 'txt']
2025-11-17 07:14:45,327 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:14:45,332 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:14:53,661 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 07:15:00,329 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:15:11,878 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:15:27,448 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:17:24,848 - ispa_next.app_start.main - DEBUG - Operation already took 106.34 seconds (more than 80 seconds)
2025-11-17 07:17:26,930 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_ufcp2ofw_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_ufcp2ofw', 'txt']
2025-11-17 07:17:27,162 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:17:27,168 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:17:27,169 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:19:25,930 - ispa_next.app_start.main - DEBUG - Operation already took 106.44 seconds (more than 80 seconds)
2025-11-17 07:19:27,991 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_e72ezuz4_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\c0d8eff5588aac7e\\tess_e72ezuz4', 'txt']
2025-11-17 07:19:28,233 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 07:19:28,238 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 07:19:36,229 - ispa_next.main - DEBUG - ISPA Next attempt (5 / 5)
2025-11-17 07:19:44,619 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 07:19:55,525 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 07:20:10,989 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 07:20:34,725 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 07:20:46,130 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 07:20:48,877 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:20:50,054 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:20:50,056 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:20:52,429 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-17 07:20:52,431 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 07:20:52,433 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 07:20:53,571 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 07:20:54,753 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:21:16,860 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:21:16,861 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:21:16,863 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:21:16,871 - ispa_next.appointments.models - DEBUG - Appointment Severin Stefanov Todorov HU-YS 2023 WBAVC31080VA19489 ohne Termin.
2025-11-17 07:21:16,901 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:21:16,945 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-17 07:21:16,971 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-17 07:21:16,983 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-17 07:21:16,994 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-17 07:21:17,002 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-17 07:21:17,019 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-17 07:21:17,053 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-17 07:21:17,061 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-17 07:21:17,100 - ispa_next.main - DEBUG - Found 15 out of 135 appointments to process (configured limit: 15).
2025-11-17 07:21:17,100 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 07:21:17,100 - ispa_next.main - DEBUG - All appointments: HU MJ 28, HU AC78E, HU KT 1402, HG-NN 50, HU-PW 667, FB-B 985, HU-KJ 81, FB-KU 786, HU-XS 108, MKK-KX 211, HU-AS 958, MKK-DN 180, OF-JF 333, FB-SR 1700, MKK-RM 157
2025-11-17 07:21:17,103 - ispa_next.main - DEBUG - 



2025-11-17 07:21:17,103 - ispa_next.main - DEBUG - starting with process 1 (HU MJ 28) of 15
2025-11-17 07:21:17,110 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:21:18,316 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:21:19,458 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:21:19,459 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-17 07:21:20,796 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:21:20,797 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:21:54,231 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:21:54,316 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 07:21:54,321 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:21:54,845 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:21:54,846 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:21:57,398 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 07:21:57,399 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:21:58,238 - ispa_next.main - DEBUG - 



2025-11-17 07:21:58,238 - ispa_next.main - DEBUG - starting with process 2 (HU AC78E) of 15
2025-11-17 07:21:58,246 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:21:59,198 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:00,066 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:22:00,067 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:22:01,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:22:01,243 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:22:31,799 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:22:31,809 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 07:22:31,814 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:32,197 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:22:32,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:22:34,159 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 07:22:34,159 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:22:34,773 - ispa_next.main - DEBUG - 



2025-11-17 07:22:34,773 - ispa_next.main - DEBUG - starting with process 3 (HU KT 1402) of 15
2025-11-17 07:22:34,779 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:22:35,699 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:22:36,537 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:22:36,538 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:22:37,695 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:22:37,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:23:09,273 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 07:23:09,284 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 07:23:09,289 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:23:09,765 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:23:09,766 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:23:12,248 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 07:23:12,249 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:23:13,202 - ispa_next.main - DEBUG - 



2025-11-17 07:23:13,202 - ispa_next.main - DEBUG - starting with process 4 (HG-NN 50) of 15
2025-11-17 07:23:13,206 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:23:14,383 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:23:15,600 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:23:15,601 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:23:17,092 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:23:17,094 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:23:39,573 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:23:42,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:23:42,703 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:23:42,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:23:46,094 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:23:46,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:23:46,157 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:23:46,368 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:23:46,372 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:23:46,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:23:46,473 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:23:52,978 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:23:52,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:23:53,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:23:55,935 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:24:01,428 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 07:24:05,155 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 07:24:06,161 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:24:06,165 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:24:06,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:24:06,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:24:06,686 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:24:06,724 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:24:06,822 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:24:07,954 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:24:08,179 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:24:09,718 - ispa_next.functions - DEBUG - Updated appointment (AA00030019) customer contact data.
2025-11-17 07:24:10,622 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:24:10,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:24:10,777 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:24:11,044 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:24:11,047 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:24:11,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:24:11,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:24:12,879 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:24:12,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:24:12,958 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 07:24:16,939 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:24:16,939 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:24:16,943 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:24:16,944 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:24:16,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:24:17,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:24:21,562 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:24:21,568 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:24:21,568 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 07:24:21,569 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:24:24,555 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:24:24,557 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:24:25,581 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:24:25,582 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:24:25,583 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:24:25,584 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:24:25,585 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:24:25,586 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:24:25,587 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:24:25,588 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:24:25,588 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:24:25,590 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:24:25,593 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:24:25,595 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:24:25,596 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:24:28,791 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:24:28,793 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:24:28,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:24:32,110 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:24:32,113 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:24:32,115 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:24:32,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:24:35,361 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:24:35,363 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:24:36,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:24:36,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:24:37,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:25:08,521 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:25:13,927 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:25:17,387 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:25:21,149 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:25:21,152 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:25:21,152 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:25:21,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:25:21,674 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:25:21,676 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:25:23,253 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:25:32,326 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:25:32,720 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 07:25:32,960 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:25:33,954 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:25:33,956 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:25:36,777 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 07:25:36,777 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:25:37,551 - ispa_next.main - DEBUG - 



2025-11-17 07:25:37,551 - ispa_next.main - DEBUG - starting with process 5 (HU-PW 667) of 15
2025-11-17 07:25:37,561 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:25:38,677 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:25:39,727 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:25:39,728 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:25:41,161 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:25:41,162 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:26:09,244 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:26:12,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:26:14,157 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:26:14,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:14,269 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:26:14,471 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:26:14,476 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:26:14,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:14,582 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:26:17,843 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:26:17,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:26:18,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:26:20,667 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:26:20,791 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:26:20,934 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:26:20,999 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:26:25,155 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:26:26,160 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:26:26,164 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:26:26,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:26,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:26,695 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:26:26,740 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:26:27,964 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:26:28,200 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:26:29,712 - ispa_next.functions - DEBUG - Updated appointment (AA00030017) customer contact data.
2025-11-17 07:26:30,620 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:26:30,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:30,700 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:26:30,839 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:26:30,841 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:26:31,685 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:26:31,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:26:32,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:26:36,323 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:26:36,323 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:26:36,327 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:26:36,328 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:26:36,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:26:36,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:26:40,936 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:26:40,941 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:26:40,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:26:41,021 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:26:46,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:47,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:26:47,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:26:47,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:26:47,885 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:26:49,724 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:26:49,726 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:26:50,647 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:26:50,649 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:26:50,651 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:26:50,653 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:26:50,656 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:26:50,658 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:26:50,660 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:26:50,673 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:26:50,674 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:26:50,679 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:26:50,683 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:26:50,685 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:26:50,686 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:26:52,562 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:26:52,564 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:26:52,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:26:54,438 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:26:54,442 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:26:54,446 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:26:54,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:26:56,343 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:26:56,345 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:26:57,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:26:57,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:26:57,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:27:16,902 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:27:21,141 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:27:21,144 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:27:21,145 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:27:21,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:27:21,862 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:27:21,864 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:27:23,751 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:27:31,176 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:27:31,555 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 07:27:31,810 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:27:32,416 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:27:32,417 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:27:35,070 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 07:27:35,070 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:27:35,969 - ispa_next.main - DEBUG - 



2025-11-17 07:27:35,970 - ispa_next.main - DEBUG - starting with process 6 (FB-B 985) of 15
2025-11-17 07:27:35,974 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:27:37,132 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:27:38,182 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:27:38,183 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:27:39,631 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:27:39,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:28:07,786 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:28:10,959 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:12,200 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:28:12,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:12,290 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:28:12,468 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:28:12,472 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:28:12,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:12,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:28:15,766 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:28:15,767 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:16,680 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:28:18,684 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:28:18,799 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:28:18,904 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:28:18,976 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:28:23,122 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:28:24,127 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:28:24,132 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:28:24,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:24,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:24,621 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:28:24,676 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:28:25,868 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:28:26,088 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:28:27,668 - ispa_next.functions - DEBUG - Updated appointment (AA00030016) customer contact data.
2025-11-17 07:28:28,589 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:28:28,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:28,689 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:28:28,836 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:28:28,839 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:28:29,535 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:28:29,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:28:30,196 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:28:33,754 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:28:33,754 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:28:33,757 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:28:33,758 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:28:33,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:34,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:28:38,372 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:28:38,376 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:28:38,377 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:38,468 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:28:47,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:47,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:28:47,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:28:48,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:28:48,429 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:28:49,677 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:28:49,679 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:28:50,689 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:28:50,690 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:28:50,695 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:28:50,697 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:28:50,700 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:28:50,702 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:28:50,703 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:28:50,705 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:28:50,706 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:28:50,707 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:28:50,710 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:28:50,713 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:28:50,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:51,919 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:28:51,922 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:28:51,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:53,157 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:28:53,170 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:28:53,173 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:28:53,175 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:28:54,379 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:28:54,381 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:28:55,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:28:55,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:28:55,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:29:08,326 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:29:08,328 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:29:08,329 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:29:08,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:29:08,845 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:29:08,847 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:29:10,475 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:29:18,025 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:29:18,431 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 07:29:18,945 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:29:19,544 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:29:19,545 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:29:22,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 216
2025-11-17 07:29:22,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:29:23,400 - ispa_next.main - DEBUG - 



2025-11-17 07:29:23,400 - ispa_next.main - DEBUG - starting with process 7 (HU-KJ 81) of 15
2025-11-17 07:29:23,405 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:29:24,454 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:29:25,354 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:29:25,355 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 216
2025-11-17 07:29:26,840 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:29:26,841 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:29:48,867 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:29:52,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:29:53,986 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:29:53,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:29:54,087 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:29:54,276 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 07:29:57,933 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:29:57,937 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:29:57,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:29:58,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:30:00,982 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:30:00,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:30:01,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:30:03,889 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:30:03,995 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:30:04,093 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:30:04,162 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:30:08,340 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:30:09,346 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:30:09,350 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:30:09,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:30:09,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:30:09,885 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:30:09,935 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:30:11,150 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:30:11,355 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:30:13,022 - ispa_next.functions - DEBUG - Updated appointment (AA00030012) customer contact data.
2025-11-17 07:30:13,931 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:30:13,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:30:14,009 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:30:14,229 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:30:14,231 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:30:14,943 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:30:14,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:30:15,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:30:19,576 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:30:19,576 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:30:19,584 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:30:19,585 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:30:19,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:30:20,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:30:24,215 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:30:24,219 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:30:24,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:30:24,288 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:30:29,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:30:30,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:30:30,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:30:31,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:30:31,125 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:30:33,019 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:30:33,020 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:30:33,983 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:30:33,985 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:30:33,986 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:30:33,987 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:30:33,988 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:30:33,989 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:30:33,990 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:30:33,991 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:30:33,992 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:30:33,994 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:30:33,997 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:30:33,999 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:30:34,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:30:35,893 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:30:35,895 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:30:35,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:30:37,781 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:30:37,783 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:30:37,785 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:30:37,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:30:39,695 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:30:39,697 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:30:40,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:30:41,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:30:41,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:30:59,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:31:03,651 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:31:03,653 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:31:03,654 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:31:04,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:31:04,298 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:31:04,300 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:31:06,061 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:31:13,484 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:31:13,865 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 07:31:14,172 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:31:15,090 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:31:15,092 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:31:18,174 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 215
2025-11-17 07:31:18,175 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:31:19,005 - ispa_next.main - DEBUG - 



2025-11-17 07:31:19,005 - ispa_next.main - DEBUG - starting with process 8 (FB-KU 786) of 15
2025-11-17 07:31:19,009 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:31:20,127 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:31:21,241 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:31:21,242 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 215
2025-11-17 07:31:22,770 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:31:22,772 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:31:46,240 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:31:49,413 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:31:54,016 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:31:54,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:31:54,079 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:31:54,231 - ispa_next.functions - DEBUG - HU date already expired after 30 days.
2025-11-17 07:31:58,417 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:31:58,420 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:31:58,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:31:58,522 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:32:05,150 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:32:05,152 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:32:06,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:32:08,018 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:32:08,130 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:32:08,241 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:32:08,325 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:32:10,465 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:32:11,471 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:32:11,476 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:32:11,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:11,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:11,976 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:32:12,063 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:32:12,177 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:32:13,343 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:32:13,546 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:32:15,173 - ispa_next.functions - DEBUG - Updated appointment (AA00030005) customer contact data.
2025-11-17 07:32:16,089 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:32:16,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:16,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:32:16,476 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:32:16,478 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:32:16,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:32:17,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:32:18,331 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:32:18,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:32:18,404 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 07:32:22,430 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:32:22,430 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:32:22,435 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:32:22,436 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:32:22,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:32:22,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:32:27,027 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 07:32:30,364 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:32:30,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:32:30,467 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:32:30,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:31,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:32:31,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:32:32,102 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:32:32,103 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:32:36,269 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:32:36,270 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:32:37,612 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:32:37,613 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:32:37,615 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:32:37,616 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:32:37,618 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:32:37,619 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:32:37,621 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:32:37,623 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:32:37,623 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:32:37,625 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:32:37,628 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:32:37,630 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:32:37,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:32:42,293 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:32:42,295 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:32:42,297 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:32:46,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:32:46,970 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:32:58,361 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:32:58,364 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:32:58,366 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:32:58,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:33:03,000 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:33:03,022 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:33:03,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:33:04,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:33:04,475 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:33:49,954 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:33:54,585 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:33:59,645 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:34:03,941 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:34:08,092 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:34:12,500 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:34:12,502 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:34:12,503 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:34:13,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:34:13,315 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:34:13,317 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:34:15,147 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:34:23,267 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:34:23,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 07:34:24,432 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:34:25,118 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:34:25,119 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:34:28,155 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 212
2025-11-17 07:34:28,157 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:34:29,005 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:34:29,018 - ispa_next.appointments.models - DEBUG - Appointment Ivo Dzojic GN-OL 111 WBA1J11090V369963 ohne Termin.
2025-11-17 07:34:29,023 - ispa_next.main - DEBUG - 



2025-11-17 07:34:29,023 - ispa_next.main - DEBUG - starting with process 9 (HU-XS 108) of 15
2025-11-17 07:34:29,027 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:34:30,203 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:34:31,422 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:34:31,424 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 212
2025-11-17 07:34:32,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:34:32,862 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:35:01,220 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:35:04,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:06,370 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:35:06,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:06,464 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:35:06,606 - ispa_next.functions - DEBUG - HU date already expired after 323 days.
2025-11-17 07:35:10,467 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:35:10,470 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:35:10,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:10,573 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:35:16,955 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:35:16,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:35:17,837 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:35:19,840 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:35:19,945 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:35:20,020 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:35:20,136 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:35:24,307 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:35:25,313 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:35:25,317 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:35:25,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:25,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:25,774 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:35:25,831 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:35:25,921 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:35:27,029 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:35:27,246 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:35:28,843 - ispa_next.functions - DEBUG - Updated appointment (AA00030000) customer contact data.
2025-11-17 07:35:29,747 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:35:29,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:29,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:35:29,945 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:35:29,947 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:35:30,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:35:30,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:35:31,923 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:35:31,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:35:31,994 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 07:35:35,626 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:35:35,626 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:35:35,630 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:35:35,631 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:35:35,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:35:36,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:35:40,181 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:35:40,187 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:35:40,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:35:40,283 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:35:40,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:41,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:35:41,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:35:41,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:35:41,826 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:35:43,654 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:35:43,656 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:35:44,516 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:35:44,517 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:35:44,518 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:35:44,519 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:35:44,520 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:35:44,521 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:35:44,521 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:35:44,522 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:35:44,523 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:35:44,524 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:35:44,527 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:35:44,529 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:35:44,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:46,370 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:35:46,372 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:35:46,375 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:48,215 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:35:48,217 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:35:48,221 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:35:48,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:35:50,169 - ispa_next.functions - DEBUG - adding material to item=Package(name=lwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 07:35:59,041 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:35:59,043 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:35:59,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:36:00,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:36:00,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:36:19,290 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:36:23,639 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:36:23,642 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:36:23,643 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:36:24,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:36:24,338 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:36:24,340 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:36:25,938 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:36:33,571 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:36:33,957 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 07:36:34,412 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:36:35,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:36:35,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:36:38,179 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 07:36:38,180 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:36:39,039 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:36:39,049 - ispa_next.appointments.models - DEBUG - Appointment Ivo Dzojic GN-OL 111 WBA1J11090V369963 ohne Termin.
2025-11-17 07:36:39,049 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:36:39,055 - ispa_next.main - DEBUG - 



2025-11-17 07:36:39,055 - ispa_next.main - DEBUG - starting with process 10 (MKK-KX 211) of 15
2025-11-17 07:36:39,059 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:36:40,137 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:36:41,028 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:36:41,029 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 07:36:42,361 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 0
2025-11-17 07:36:42,363 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:36:42,657 - ispa_next.appointment_loop.main - DEBUG - Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 40, in process_appointment
    open_appointment(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 142, in open_appointment
    raise AppointmentNotFound("Appointment not available, continue with the next one.")
ispa_next.exceptions.AppointmentNotFound: Appointment not available, continue with the next one.

2025-11-17 07:36:42,657 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 07:36:42,660 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:36:43,313 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:36:43,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 0
2025-11-17 07:36:45,874 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 07:36:45,874 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:36:46,718 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:36:46,728 - ispa_next.appointments.models - DEBUG - Appointment Ivo Dzojic GN-OL 111 WBA1J11090V369963 ohne Termin.
2025-11-17 07:36:46,728 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:36:46,737 - ispa_next.main - DEBUG - 



2025-11-17 07:36:46,737 - ispa_next.main - DEBUG - starting with process 11 (HU-AS 958) of 15
2025-11-17 07:36:46,741 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:36:47,856 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:36:49,132 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:36:49,133 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 07:36:50,696 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:36:50,697 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:37:13,772 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:37:17,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:37:19,823 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:37:19,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:19,899 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:37:20,172 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 07:37:24,160 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:37:24,163 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:37:24,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:24,251 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:37:31,148 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:37:31,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:37:32,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:37:34,162 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:37:34,282 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:37:34,388 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:37:34,458 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:37:36,586 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:37:37,592 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:37:37,597 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:37:37,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:38,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:38,092 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:37:38,124 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:37:38,275 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:37:39,501 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:37:39,710 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:37:41,756 - ispa_next.functions - DEBUG - Updated appointment (AF00016210) customer contact data.
2025-11-17 07:37:42,690 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:37:42,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:42,772 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:37:42,912 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:37:42,915 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:37:43,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:37:43,824 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:37:44,873 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:37:44,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:37:44,949 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 07:37:48,935 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:37:48,935 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:37:48,939 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:37:48,940 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:37:48,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:37:49,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:37:53,524 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 07:37:57,113 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:37:57,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:37:57,185 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:37:57,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:58,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:37:58,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:37:58,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:37:58,792 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:38:01,267 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:38:01,269 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:38:03,382 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:38:03,383 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:38:03,385 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:38:03,386 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:38:03,387 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:38:03,388 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:38:03,389 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:38:03,391 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:38:03,392 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:38:03,393 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:38:03,395 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:38:03,397 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:38:03,398 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:38:05,964 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:38:05,966 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:38:05,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:38:08,625 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:38:08,627 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:38:08,630 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:38:08,639 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:38:11,189 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:38:11,192 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:38:11,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:38:12,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:38:12,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:38:37,903 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:38:41,804 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:38:46,426 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:38:46,428 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:38:46,429 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:38:47,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:38:47,147 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:38:47,149 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:38:48,894 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:38:56,383 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:38:56,768 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 07:38:57,383 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:38:58,096 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:38:58,097 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:39:01,334 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 07:39:01,335 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:39:02,110 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:39:02,119 - ispa_next.appointments.models - DEBUG - Appointment Ivo Dzojic GN-OL 111 WBA1J11090V369963 ohne Termin.
2025-11-17 07:39:02,120 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:39:02,126 - ispa_next.main - DEBUG - 



2025-11-17 07:39:02,126 - ispa_next.main - DEBUG - starting with process 12 (MKK-DN 180) of 15
2025-11-17 07:39:02,130 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:39:03,242 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:39:04,337 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:39:04,339 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 07:39:05,897 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:39:05,899 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:39:29,156 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:39:32,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:39:33,574 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:39:33,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:39:33,663 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:39:33,864 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:39:33,868 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:39:33,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:39:33,958 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:39:40,774 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:39:40,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:39:41,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:39:43,747 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:39:43,857 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:39:43,977 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:39:44,050 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:39:48,179 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:39:49,185 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:39:49,188 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:39:49,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:39:49,694 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:39:49,694 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:39:49,768 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:39:50,988 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:39:51,204 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:39:52,854 - ispa_next.functions - DEBUG - Updated appointment (AE00018300) customer contact data.
2025-11-17 07:39:53,771 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:39:53,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:39:53,860 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:39:54,014 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:39:54,016 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:39:54,729 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:39:54,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:39:55,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:39:59,123 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:39:59,124 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:39:59,127 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:39:59,128 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:39:59,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:39:59,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:40:03,773 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:40:03,777 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:40:03,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:40:03,865 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:40:04,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:40:04,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:40:04,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:40:05,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:40:05,423 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:40:06,701 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:40:06,703 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:40:07,664 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:40:07,666 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:40:07,668 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:40:07,669 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:40:07,670 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:40:07,671 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:40:07,672 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:40:07,673 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:40:07,674 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:40:07,676 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:40:07,679 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:40:07,681 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:40:07,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:40:08,873 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:40:08,875 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:40:08,880 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:40:10,052 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:40:10,054 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:40:10,057 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:40:10,059 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:40:11,301 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:40:11,303 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:40:11,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:40:12,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:40:12,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:40:24,383 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:40:24,386 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:40:24,387 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:40:25,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:40:25,187 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:40:25,189 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:40:26,939 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:40:34,707 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:40:35,081 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 07:40:35,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:40:36,684 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:40:36,685 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:40:39,903 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 211
2025-11-17 07:40:39,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:40:40,760 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:40:40,770 - ispa_next.appointments.models - DEBUG - Appointment Ivo Dzojic GN-OL 111 WBA1J11090V369963 ohne Termin.
2025-11-17 07:40:40,770 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:40:40,776 - ispa_next.main - DEBUG - 



2025-11-17 07:40:40,776 - ispa_next.main - DEBUG - starting with process 13 (OF-JF 333) of 15
2025-11-17 07:40:40,781 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:40:42,056 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:40:43,248 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:40:43,250 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 211
2025-11-17 07:40:44,659 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:40:44,660 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:41:08,565 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:41:11,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:41:17,043 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:41:17,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:17,133 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:41:17,368 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 07:41:21,657 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:41:21,659 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:41:21,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:21,729 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:41:28,684 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:41:28,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:41:30,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:41:32,016 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:41:32,119 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:41:32,205 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:41:32,276 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:41:36,428 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:41:37,434 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:41:37,452 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:41:37,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:37,969 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:37,969 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:41:38,019 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:41:38,137 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:41:39,433 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:41:39,631 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:41:41,344 - ispa_next.functions - DEBUG - Updated appointment (AE00018282) customer contact data.
2025-11-17 07:41:42,540 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:41:42,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:42,664 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:41:42,813 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:41:42,816 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:41:42,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:41:43,869 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:41:44,933 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:41:44,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:41:45,019 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 07:41:48,593 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:41:48,593 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:41:48,596 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:41:48,597 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:41:48,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:41:49,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:41:53,178 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 07:41:56,483 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:41:56,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:41:56,558 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:41:56,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:57,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:41:57,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:41:58,135 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:41:58,136 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:42:02,951 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:42:02,953 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:42:03,932 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:42:03,933 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:42:03,936 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:42:03,941 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:42:03,943 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:42:03,944 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:42:03,945 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:42:03,947 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:42:03,948 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:42:03,949 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:42:03,953 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:42:03,955 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:42:03,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:42:09,296 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:42:09,298 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:42:09,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:42:14,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:42:14,557 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:42:26,281 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:42:26,284 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:42:26,286 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:42:26,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:42:31,606 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:42:31,608 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:42:32,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:42:32,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:42:33,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:43:18,928 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:43:23,750 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:43:28,296 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:43:32,312 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:43:37,052 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:43:41,606 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:43:41,609 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:43:41,610 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:43:42,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:43:42,363 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:43:42,366 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:43:44,400 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:43:52,516 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:43:52,935 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 07:43:53,923 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:43:54,574 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:43:54,575 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:43:57,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 07:43:57,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:43:58,623 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:43:58,632 - ispa_next.appointments.models - DEBUG - Appointment Ivo Dzojic GN-OL 111 WBA1J11090V369963 ohne Termin.
2025-11-17 07:43:58,633 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:43:58,638 - ispa_next.main - DEBUG - 



2025-11-17 07:43:58,638 - ispa_next.main - DEBUG - starting with process 14 (FB-SR 1700) of 15
2025-11-17 07:43:58,642 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:43:59,784 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:44:00,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:44:00,905 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 07:44:02,325 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:44:02,327 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:44:26,784 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:44:29,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:44:32,493 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:44:32,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:44:32,553 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:44:32,725 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:44:32,728 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:44:32,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:44:32,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:44:39,942 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:44:39,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:44:41,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:44:43,079 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:44:43,173 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:44:43,261 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:44:43,364 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:44:47,520 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 07:44:48,527 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:44:48,532 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:44:48,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:44:49,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:44:49,016 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:44:49,084 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:44:49,184 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:44:50,493 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:44:50,738 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:44:52,418 - ispa_next.functions - DEBUG - Updated appointment (AR00006517) customer contact data.
2025-11-17 07:44:53,361 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:44:53,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:44:53,476 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:44:53,607 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:44:53,610 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:44:53,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:44:54,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:44:55,605 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:44:55,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:44:55,711 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 07:44:59,701 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 07:44:59,702 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:44:59,702 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 07:44:59,705 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:44:59,706 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:44:59,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:45:00,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:45:04,396 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 07:45:04,401 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:45:04,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:45:04,493 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:45:04,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:45:05,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:45:05,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:45:06,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:45:06,325 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:45:08,745 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:45:08,749 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:45:09,839 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:45:09,848 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:45:09,853 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:45:09,855 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:45:09,856 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:45:09,857 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:45:09,858 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:45:09,859 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:45:09,860 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:45:09,861 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:45:09,865 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:45:09,867 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:45:09,868 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:45:12,496 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:45:12,499 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:45:12,504 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:45:15,089 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:45:15,092 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:45:15,093 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:45:15,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:45:17,639 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:45:17,641 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:45:18,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:45:19,038 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:45:19,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:45:43,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:45:47,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:45:52,762 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:45:52,765 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:45:52,766 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:45:53,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:45:53,539 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:45:53,541 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:45:54,957 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:46:02,889 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:46:03,264 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 07:46:04,071 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:46:04,669 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:46:04,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:46:07,679 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 07:46:07,679 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:46:08,496 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:46:08,497 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:46:08,847 - ispa_next.appointments.models - DEBUG - Appointment Mohammed Khyser Syed FB-KU 786 WBA4V110205R71380 ohne Termin.
2025-11-17 07:46:08,853 - ispa_next.main - DEBUG - 



2025-11-17 07:46:08,853 - ispa_next.main - DEBUG - starting with process 15 (MKK-RM 157) of 15
2025-11-17 07:46:08,873 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:46:10,083 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:46:11,214 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:46:11,215 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 07:46:12,700 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 07:46:12,701 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:46:50,185 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 07:46:53,375 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:46:55,287 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 07:46:55,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:46:55,362 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:46:55,569 - ispa_next.functions - DEBUG - HU date already expired after 84 days.
2025-11-17 07:46:59,408 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 07:46:59,411 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 07:46:59,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:46:59,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:47:06,219 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:47:06,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:47:07,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:47:09,299 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:47:09,396 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:47:09,492 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:47:09,566 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 07:47:09,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:47:11,523 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 07:47:22,866 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 07:47:23,871 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 07:47:23,876 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 07:47:23,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:47:24,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:47:24,363 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 07:47:24,395 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 07:47:25,579 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 07:47:26,751 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 07:47:27,283 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 07:47:29,095 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 07:47:29,096 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:47:29,160 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 07:47:29,357 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 07:47:29,359 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 07:47:30,094 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 07:47:30,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 07:47:30,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 07:47:34,994 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 07:47:35,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:47:35,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:47:37,545 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 07:47:37,665 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 07:47:37,740 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 07:47:37,836 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 07:47:37,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:47:39,787 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 07:47:51,642 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 07:48:51,650 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 07:49:02,811 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 07:49:50,818 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 07:50:02,236 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlsseldaten berschreiben und ffnen' in nested popup
2025-11-17 07:50:09,823 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 07:50:09,824 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:50:18,945 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name=' Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:21,240 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name=' Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:23,881 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:26,426 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zndkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:29,113 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:32,184 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motorl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:34,706 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern fr Frontklappe prfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:37,676 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:40,300 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 07:50:42,363 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 07:50:44,799 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 07:50:45,806 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 07:50:45,814 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 07:50:45,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:50:45,898 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:50:50,017 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 07:50:53,594 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 07:50:53,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:50:53,729 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 07:50:54,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 07:50:54,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 07:50:54,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 07:50:55,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 07:50:55,683 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 07:50:57,563 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 07:50:57,566 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 07:51:02,019 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 07:51:02,020 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:51:02,021 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 07:51:02,050 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 07:51:02,065 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 07:51:02,074 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 07:51:02,075 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 07:51:02,077 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 07:51:02,079 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 07:51:02,081 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 07:51:02,084 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 07:51:02,087 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 07:51:02,087 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:51:04,036 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 07:51:04,038 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 07:51:04,040 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:51:05,885 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 07:51:05,888 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 07:51:05,891 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 07:51:05,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:51:07,710 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 07:51:07,712 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 07:51:08,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:51:09,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 07:51:09,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 07:51:28,053 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:51:32,579 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 07:51:32,581 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 07:51:32,582 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 07:51:33,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 07:51:33,298 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 07:51:33,300 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 07:51:35,128 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 07:51:43,167 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 07:51:43,543 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 07:51:44,327 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 07:51:45,038 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 659
2025-11-17 07:51:45,040 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 07:51:48,149 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-17 07:51:48,150 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 07:51:48,951 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 07:51:48,951 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 07:51:48,960 - ispa_next.appointments.models - DEBUG - Appointment Mohammed Khyser Syed FB-KU 786 WBA4V110205R71380 ohne Termin.
