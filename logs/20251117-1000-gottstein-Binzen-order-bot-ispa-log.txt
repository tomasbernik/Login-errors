2025-11-17 10:00:36,239 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:00:36,246 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:00:44,691 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:00:57,403 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:12,765 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:01:52,774 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:02:04,962 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:02:09,163 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:10,249 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2094
2025-11-17 10:02:10,250 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 600
2025-11-17 10:02:12,953 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 435
2025-11-17 10:02:12,954 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:02:12,955 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:14,249 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:15,485 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:20,273 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:03:20,276 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,276 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,277 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,277 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,288 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,327 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,390 - ispa_next.appointments.models - DEBUG - Appointment Elektro Rütten GmbH LÖ-ER 3003 WBS61AY0X0FS27171 ohne Termin.
2025-11-17 10:03:20,413 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,427 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-17 10:03:20,431 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 10:03:20,454 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-17 10:03:20,476 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-17 10:03:20,489 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-17 10:03:20,505 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-17 10:03:20,521 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-17 10:03:20,538 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-17 10:03:20,553 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-17 10:03:20,573 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-17 10:03:20,603 - ispa_next.main - DEBUG - Found 4 out of 125 appointments to process (configured limit: 15).
2025-11-17 10:03:20,604 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-17 10:03:20,604 - ispa_next.main - DEBUG - All appointments: LÖ-M 50180, LÖ-IK 9781, LÖ-M6H, BL 17685
2025-11-17 10:03:20,606 - ispa_next.main - DEBUG - 



2025-11-17 10:03:20,606 - ispa_next.main - DEBUG - starting with process 1 (LÖ-M 50180) of 4
2025-11-17 10:03:20,610 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:03:21,416 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:22,236 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2094
2025-11-17 10:03:22,237 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 435
2025-11-17 10:03:23,329 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:23,330 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:58,717 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:04:07,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:07,305 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:07,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:09,339 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:04:09,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:09,427 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:09,632 - ispa_next.functions - DEBUG - HU date already expired after 2014 days.
2025-11-17 10:04:17,013 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:04:17,016 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:04:19,804 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:04:19,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:20,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:22,699 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:04:28,213 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:04:35,324 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:04:36,332 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:04:36,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:36,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:50,513 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:04:58,193 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:04:58,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:58,293 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:58,294 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:04:58,336 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:04:58,448 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:04:59,631 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 10:05:00,831 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 10:05:01,169 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:05:03,378 - ispa_next.functions - DEBUG - Updated appointment (AB00091604) customer contact data.
2025-11-17 10:05:04,300 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:05:04,303 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:05:04,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:05:05,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:05:06,520 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:05:06,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:05:06,615 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:05:10,783 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:05:10,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:10,783 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:05:10,786 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:05:10,790 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:05:10,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:11,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:11,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:12,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:05:12,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:12,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:12,876 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:05:15,369 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:05:15,372 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:05:16,353 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:05:16,354 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:05:16,358 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:05:16,360 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:05:16,362 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:05:16,364 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:05:16,365 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:05:16,367 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:05:16,369 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:05:16,370 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:05:16,373 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:05:16,376 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:05:16,377 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:18,957 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:05:18,960 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:05:18,962 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:05:18,966 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:05:18,968 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:05:18,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:21,532 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:05:21,538 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:05:21,542 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:05:21,543 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:05:22,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:05:23,098 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:05:23,100 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:05:24,783 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:05:34,177 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:05:34,548 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:05:34,831 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:36,821 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:05:36,822 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:39,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 601
2025-11-17 10:05:39,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:05:39,977 - ispa_next.appointments.models - DEBUG - Appointment Burim Bunjaku EE-484-AZ WBALS010300T84357 ohne Termin.
2025-11-17 10:05:39,988 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:05:39,999 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 10:05:40,005 - ispa_next.main - DEBUG - Found new Appointment: BL 196851
2025-11-17 10:05:40,005 - ispa_next.main - DEBUG - Found new Appointment: LÖ-AK 435
2025-11-17 10:05:40,007 - ispa_next.main - DEBUG - 



2025-11-17 10:05:40,007 - ispa_next.main - DEBUG - starting with process 2 (BL 196851) of 6
2025-11-17 10:05:40,011 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:05:40,863 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:05:42,089 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:05:42,091 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 601
2025-11-17 10:05:43,632 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:05:43,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:06:20,447 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:06:29,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:29,823 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:29,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:34,589 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:06:34,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:34,676 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:06:34,920 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:06:41,048 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:06:41,051 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:06:43,686 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:06:43,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:44,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:46,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:06:52,438 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:06:59,894 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:07:00,900 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:07:00,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:01,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:13,871 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:07:20,943 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:07:20,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:21,053 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:07:21,055 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:07:21,089 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:07:21,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:07:22,437 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:07:22,697 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:07:26,162 - ispa_next.functions - DEBUG - Updated appointment (AC00065279) customer contact data.
2025-11-17 10:07:27,093 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:07:27,095 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:07:27,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:07:28,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:07:29,432 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:07:29,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:07:29,512 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:07:33,717 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:07:33,718 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:07:33,718 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:07:33,721 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:07:33,725 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:07:33,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:34,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:34,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:35,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:07:35,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:07:35,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:07:35,768 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:07:40,547 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:07:40,549 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:07:41,615 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:07:41,616 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:41,617 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:07:41,618 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:07:41,626 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:07:41,629 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:07:41,631 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:07:41,636 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:07:41,638 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:07:41,639 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:07:41,642 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:07:41,645 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:07:41,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:46,998 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:07:47,000 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:07:47,002 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:07:47,005 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:07:47,007 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:07:47,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:52,277 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:07:52,279 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:07:52,281 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:07:52,282 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:53,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:53,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:07:53,785 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:07:55,632 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:08:02,326 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:08:02,734 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:08:03,020 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:05,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:08:05,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:08,276 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 600
2025-11-17 10:08:08,277 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:09,117 - ispa_next.appointments.models - DEBUG - Appointment Burim Bunjaku EE-484-AZ WBALS010300T84357 ohne Termin.
2025-11-17 10:08:09,126 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:08:09,151 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 10:08:09,156 - ispa_next.main - DEBUG - 



2025-11-17 10:08:09,156 - ispa_next.main - DEBUG - starting with process 3 (LÖ-AK 435) of 6
2025-11-17 10:08:09,163 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:08:10,094 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:08:11,478 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:08:11,479 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 600
2025-11-17 10:08:12,995 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:12,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:40,670 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:08:42,333 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-17 10:08:46,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:50,046 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:08:50,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:50,127 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:50,329 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:08:50,334 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:08:53,353 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:53,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:54,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:56,384 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:56,471 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:08:56,576 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:08:56,651 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:09:00,842 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:09:01,849 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:09:01,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:02,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:14,134 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:09:17,542 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:09:17,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:17,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:09:17,603 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:09:17,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:09:17,749 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:09:18,867 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:09:19,147 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:09:20,546 - ispa_next.functions - DEBUG - Updated appointment (AC00065275) customer contact data.
2025-11-17 10:09:21,454 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:09:21,456 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:09:21,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:09:22,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:09:23,084 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:09:23,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:09:23,192 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:09:26,808 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:09:26,808 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:09:26,812 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:09:26,815 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:09:26,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:27,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:27,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:28,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:28,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:28,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:28,875 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:09:31,879 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:09:31,883 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:09:32,899 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:09:32,900 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:09:32,905 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 10:09:32,907 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:09:32,912 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:09:32,918 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:09:32,922 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:09:32,924 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:09:32,927 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:09:32,929 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:09:32,952 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:09:32,954 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:09:32,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:36,225 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:09:36,228 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:09:36,230 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:09:36,233 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:09:36,238 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:09:36,239 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:39,462 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 10:09:48,496 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:09:48,498 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:09:48,500 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:09:48,500 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:09:49,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:09:49,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:09:49,854 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:09:51,643 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:09:58,324 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:09:58,702 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:09:59,208 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:01,665 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:10:01,666 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:04,118 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 10:10:04,118 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:04,853 - ispa_next.appointments.models - DEBUG - Appointment Burim Bunjaku EE-484-AZ WBALS010300T84357 ohne Termin.
2025-11-17 10:10:04,863 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:10:04,874 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 10:10:04,881 - ispa_next.main - DEBUG - 



2025-11-17 10:10:04,881 - ispa_next.main - DEBUG - starting with process 4 (LÖ-IK 9781) of 6
2025-11-17 10:10:04,885 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:10:06,010 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:10:06,976 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:10:06,977 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 599
2025-11-17 10:10:08,100 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:10:08,101 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:10:36,538 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:10:46,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:10:49,550 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:10:49,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:49,616 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:10:49,816 - ispa_next.functions - DEBUG - HU date already expired after 3877 days.
2025-11-17 10:10:56,518 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:10:56,524 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:10:59,345 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:10:59,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:00,285 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:02,291 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:11:07,747 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:11:15,338 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:11:16,349 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:11:16,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:16,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:31,225 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:11:39,099 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:11:39,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:39,196 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:11:39,197 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:11:39,267 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:11:39,395 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:11:40,836 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:11:41,086 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:11:43,442 - ispa_next.functions - DEBUG - Updated appointment (AC00065062) customer contact data.
2025-11-17 10:11:44,361 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:11:44,365 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:11:44,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:11:45,461 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:11:46,986 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:11:46,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:11:47,085 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:11:51,271 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:11:51,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:11:51,271 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:11:51,276 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:11:51,281 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:11:51,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:51,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:52,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:52,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:11:52,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:11:53,445 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:11:53,445 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:11:57,056 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:11:57,058 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:11:57,996 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:11:57,998 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:11:58,001 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 10:11:58,004 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:11:58,007 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:11:58,010 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:11:58,011 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:11:58,013 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:11:58,014 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:11:58,015 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:11:58,017 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:11:58,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:11:59,359 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:12:08,442 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:12:08,444 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:12:08,446 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:12:08,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:13,025 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:12:13,027 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:12:13,029 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:12:13,032 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:12:13,034 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:12:13,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:17,617 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:12:17,619 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:12:17,621 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:12:17,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:12:18,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:12:19,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:12:19,105 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:12:21,034 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:12:29,555 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:12:29,950 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:12:30,407 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:12:32,633 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:12:32,634 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:12:35,607 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 598
2025-11-17 10:12:35,608 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:12:36,544 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:12:36,556 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 10:12:36,561 - ispa_next.main - DEBUG - Found new Appointment: EE-484-AZ
2025-11-17 10:12:36,562 - ispa_next.main - DEBUG - 



2025-11-17 10:12:36,562 - ispa_next.main - DEBUG - starting with process 5 (EE-484-AZ) of 7
2025-11-17 10:12:36,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:12:37,877 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:12:39,131 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:12:39,132 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 598
2025-11-17 10:12:40,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:12:40,699 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:13:09,678 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:13:19,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:22,791 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:13:22,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:22,866 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:13:23,173 - ispa_next.functions - DEBUG - HU date already expired after 2348 days.
2025-11-17 10:13:29,844 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:13:29,847 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:13:32,559 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:13:32,561 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:13:33,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:13:35,820 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:13:35,953 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:13:39,144 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:13:39,246 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:13:39,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:13:42,681 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:13:53,824 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:13:54,829 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:13:54,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:13:55,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:08,623 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:14:15,813 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:14:15,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:15,882 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:15,883 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:14:15,956 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:14:17,265 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:14:18,658 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:14:18,946 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:14:21,350 - ispa_next.functions - DEBUG - Updated appointment (AC00065290) customer contact data.
2025-11-17 10:14:22,264 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:14:22,267 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:14:22,993 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:14:22,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:14:23,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:14:28,003 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:14:28,003 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:14:28,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:28,557 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:30,561 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:14:30,650 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:14:30,757 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:14:30,833 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:14:30,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:34,128 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:14:45,624 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:15:45,628 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:57,122 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:16:10,130 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:16:21,470 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 10:16:28,624 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:16:28,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:32,030 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:16:36,236 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:16:37,242 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:16:37,246 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:16:37,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:37,369 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:37,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:38,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:38,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:38,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:38,987 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:16:42,012 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:16:42,014 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:16:43,075 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:16:43,076 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:43,077 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 10:16:43,078 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:43,079 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:16:43,081 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:16:43,081 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:16:43,083 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:16:43,084 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:16:43,089 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:16:43,093 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:16:43,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:16:44,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:16:53,927 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:16:53,930 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:16:53,933 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:16:53,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:57,795 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:16:57,797 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:16:57,799 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:16:57,801 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:16:57,802 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:16:57,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:01,680 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:17:01,682 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:17:01,684 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:17:01,684 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:02,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:02,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:17:02,841 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:17:04,270 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:17:11,023 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:17:11,430 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:17:11,794 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:17:15,212 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:17:15,213 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:17:17,769 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 596
2025-11-17 10:17:17,770 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:17:18,439 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:17:18,448 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 10:17:18,453 - ispa_next.main - DEBUG - 



2025-11-17 10:17:18,453 - ispa_next.main - DEBUG - starting with process 6 (LÖ-M6H) of 7
2025-11-17 10:17:18,458 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:19,423 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:17:20,348 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:17:20,349 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 596
2025-11-17 10:17:21,652 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:17:21,653 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:17:51,441 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:18:01,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:01,627 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:01,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:18:03,734 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:18:03,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:03,833 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:04,076 - ispa_next.functions - DEBUG - HU date already expired after 13769 days.
2025-11-17 10:18:11,466 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:18:11,469 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:18:14,233 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:18:14,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:18:14,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:18:16,964 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:18:22,194 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:18:28,693 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:18:29,698 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:18:29,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:30,183 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:42,960 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 10:18:49,961 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:18:49,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:18:50,036 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:18:50,037 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:18:50,080 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:18:50,274 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:18:51,770 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:18:51,979 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:18:54,372 - ispa_next.functions - DEBUG - Updated appointment (AE00033795) customer contact data.
2025-11-17 10:18:55,327 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:18:55,329 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:18:55,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:18:56,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:18:57,762 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:18:57,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:18:57,846 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:19:01,970 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:19:01,970 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:01,970 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:19:01,975 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:19:01,980 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:19:01,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:02,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:02,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:03,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:03,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:04,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:04,049 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:19:06,513 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:19:06,517 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:19:07,094 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:19:07,096 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:19:07,098 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 10:19:07,099 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:19:07,101 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:19:07,102 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:19:07,103 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:19:07,104 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:19:07,105 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:19:07,107 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:19:07,108 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:19:07,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:19:08,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:19:17,567 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:19:17,571 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:19:17,573 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:19:17,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:20,789 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:19:20,791 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:19:20,794 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:19:20,796 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:19:20,799 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:19:20,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:24,025 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:19:24,027 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:19:24,030 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:19:24,031 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:24,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:19:25,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:19:25,500 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:19:27,305 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:19:35,915 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:19:36,290 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:19:36,698 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:39,386 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:19:39,387 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:42,575 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 595
2025-11-17 10:19:42,575 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:43,442 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:19:43,455 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
2025-11-17 10:19:43,463 - ispa_next.main - DEBUG - 



2025-11-17 10:19:43,463 - ispa_next.main - DEBUG - starting with process 7 (BL 17685) of 7
2025-11-17 10:19:43,467 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:19:44,730 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:19:46,161 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:19:46,162 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 595
2025-11-17 10:19:47,422 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:19:47,423 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:20:21,641 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:20:31,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:31,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:31,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:20:33,523 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:20:33,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:33,623 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:20:33,942 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 10:20:40,563 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:20:40,567 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:20:43,436 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:43,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:44,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:46,207 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:20:51,402 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 10:20:57,716 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 10:20:58,722 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:20:58,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:59,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:08,556 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 10:21:16,356 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:21:16,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:16,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:21:16,439 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 10:21:16,529 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 10:21:16,632 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 10:21:17,956 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 10:21:18,177 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 10:21:20,940 - ispa_next.functions - DEBUG - Updated appointment (AA00111146) customer contact data.
2025-11-17 10:21:21,862 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:21:21,866 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:21:21,997 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:21:22,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:21:24,168 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:21:24,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:21:24,237 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:21:28,395 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:21:28,396 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:21:28,396 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:21:28,399 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:21:28,404 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:21:28,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:28,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:29,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:29,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:21:29,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:21:30,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:21:30,408 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:21:32,834 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:21:32,839 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:21:33,523 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:21:33,531 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:33,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 10:21:33,535 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:21:33,537 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:21:33,538 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:21:33,539 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:21:33,540 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:21:33,541 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:21:33,543 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:21:33,544 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:21:34,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 10:21:34,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 10:21:44,318 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:21:44,339 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:21:44,342 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:21:44,343 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:47,585 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:21:47,587 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:21:47,589 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:21:47,592 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:21:47,595 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:21:47,597 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:50,811 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:21:50,813 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:21:50,816 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:21:50,816 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:21:51,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:51,994 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:21:51,996 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:21:53,977 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:22:01,807 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:22:02,204 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:22:02,582 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:05,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2095
2025-11-17 10:22:05,035 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:07,907 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 594
2025-11-17 10:22:07,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:08,756 - ispa_next.appointments.models - DEBUG - Appointment Michael Lambert Feser LÖ-WE 7110 WBA7B01050BN83609 ohne Termin.
2025-11-17 10:22:08,770 - ispa_next.appointments.models - DEBUG - Appointment Paul Drouvot FY-340-FN WMWXP310102P48364 ohne Termin.
