2025-11-17 15:21:36,776 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:21:36,782 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:21:46,869 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:21:57,565 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:22:13,218 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:22:37,169 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:22:48,518 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:22:51,620 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:22:52,529 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 610
2025-11-17 15:22:52,529 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 105
2025-11-17 15:22:54,437 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 67
2025-11-17 15:22:54,438 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:22:54,439 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:22:55,239 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:22:56,107 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:23:05,718 - ispa_next.appointments.models - DEBUG - Appointment Serhii Saksonov AC-BQ 35 WBA3K11080F855468 ohne Termin.
2025-11-17 15:23:05,748 - ispa_next.appointments.models - DEBUG - Appointment Oliver-Thomas Brauwers RÜD-BB 989 WBA2V11000LE79050 ohne Termin.
2025-11-17 15:23:05,756 - ispa_next.appointments.models - DEBUG - Appointment Firma Aleksander Wozniczka SWA-K 848 WMWWJ510703G36271 ohne Termin.
2025-11-17 15:23:05,765 - ispa_next.appointments.models - DEBUG - Appointment Wilfried Muth SWA-WM 317 WBATY15040N035953 ohne Termin.
2025-11-17 15:23:05,772 - ispa_next.appointments.models - DEBUG - Appointment Jens Gebken RÜD-EU 190 WBA5V310X0FH69089 ohne Termin.
2025-11-17 15:23:05,781 - ispa_next.appointments.models - DEBUG - Appointment Marco Autor SWA-EA 611 WBATY15030N028721 ohne Termin.
2025-11-17 15:23:05,789 - ispa_next.appointments.models - DEBUG - Appointment Antje Rohrmus WI-AR 967 WBAHF11000WW48373 ohne Termin.
2025-11-17 15:23:05,798 - ispa_next.appointments.models - DEBUG - Appointment Christian Holderbaum RÜD-CH 149 WBA2D310205C64160 ohne Termin.
2025-11-17 15:23:05,802 - ispa_next.main - DEBUG - Found 1 out of 20 appointments to process (configured limit: 15).
2025-11-17 15:23:05,802 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 15:23:05,802 - ispa_next.main - DEBUG - All appointments: GG-MB 4401
2025-11-17 15:23:05,804 - ispa_next.main - DEBUG - 



2025-11-17 15:23:05,804 - ispa_next.main - DEBUG - starting with process 1 (GG-MB 4401) of 1
2025-11-17 15:23:05,822 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:23:07,104 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:23:08,195 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 610
2025-11-17 15:23:08,197 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 67
2025-11-17 15:23:09,442 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:23:09,443 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:23:45,565 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:23:54,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:54,572 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:54,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:56,642 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:23:56,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:56,753 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:56,904 - ispa_next.functions - DEBUG - HU date already expired after 12 days.
2025-11-17 15:24:02,941 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:24:02,943 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:24:02,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:03,025 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:13,401 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:13,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:14,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:16,400 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:24:16,512 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:24:16,605 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:24:16,688 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:24:16,688 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:24:28,371 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:24:35,338 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:24:35,338 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:24:39,546 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:24:40,551 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:24:40,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:41,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:51,752 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:24:59,031 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:24:59,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:59,109 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:59,109 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:24:59,190 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:25:00,441 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:25:00,715 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:25:04,703 - ispa_next.functions - DEBUG - Updated appointment (AB00018919) customer contact data.
2025-11-17 15:25:05,629 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:25:05,636 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:25:06,380 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:25:06,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:25:07,050 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:25:10,670 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:25:10,671 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:25:10,673 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:25:10,674 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:25:10,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:11,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:25:15,263 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:25:15,265 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:25:15,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:15,352 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:25:19,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:25:20,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:25:20,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:20,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:25:20,752 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:25:22,573 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:25:22,576 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:25:23,480 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:25:23,484 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:23,490 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Fahrzeug Innenraum saugen, source=from_tab, target=cart)}
2025-11-17 15:25:23,497 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:23,501 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:25:23,503 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-17 15:25:23,507 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:25:23,509 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:25:23,513 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:25:23,536 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:25:23,540 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:25:23,542 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:25:24,219 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:25:24,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:25:38,313 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:25:38,315 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:25:38,316 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:25:38,316 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:40,906 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:25:40,908 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:25:40,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:43,457 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:25:43,458 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:25:43,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:25:43,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:25:44,140 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:53,091 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:25:53,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:55,633 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:26:06,132 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:26:06,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:07,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:26:07,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:25,925 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:30,141 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:30,143 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:30,144 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:30,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:30,916 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:30,917 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:32,612 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:26:41,381 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:26:41,751 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:26:42,746 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:43,150 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 611
2025-11-17 15:26:43,151 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:45,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 106
2025-11-17 15:26:45,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:46,167 - ispa_next.appointments.models - DEBUG - Appointment Werner Ernst RÜD-UE 116 WBAUH51050E473107 ohne Termin.
2025-11-17 15:26:46,175 - ispa_next.appointments.models - DEBUG - Appointment Serhii Saksonov AC-BQ 35 WBA3K11080F855468 ohne Termin.
