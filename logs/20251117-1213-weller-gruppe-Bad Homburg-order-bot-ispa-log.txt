2025-11-17 12:13:59,610 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:13:59,617 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:14:37,362 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:14:48,876 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:15:06,120 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:15:40,672 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:16:00,900 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:16:05,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:16:07,257 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 928
2025-11-17 12:16:07,259 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 87
2025-11-17 12:16:11,083 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 62
2025-11-17 12:16:11,084 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:16:11,084 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:16:12,606 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:16:14,093 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:16:26,696 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,699 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,709 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,710 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,720 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,751 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,751 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,756 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,757 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,763 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,763 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:16:26,776 - ispa_next.main - DEBUG - Found 8 out of 48 appointments to process (configured limit: 15).
2025-11-17 12:16:26,776 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-17 12:16:26,776 - ispa_next.main - DEBUG - All appointments: HG-RM 1964, F-HP 435, FB-SI 9999, HG-RV 69, HG-JX-30, HG- BF 47E, HG GG 404, F-AS 3777
2025-11-17 12:16:26,779 - ispa_next.main - DEBUG - 



2025-11-17 12:16:26,779 - ispa_next.main - DEBUG - starting with process 1 (HG-RM 1964) of 8
2025-11-17 12:16:26,783 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:16:28,280 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:16:29,957 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 928
2025-11-17 12:16:29,958 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 62
2025-11-17 12:16:32,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:16:32,252 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:17:17,152 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:17:30,740 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:32,783 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:17:32,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:32,920 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:17:33,172 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:17:33,175 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:17:36,147 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:17:36,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:17:37,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:17:39,542 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:17:39,731 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:17:39,933 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:17:40,091 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:17:40,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:42,378 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:17:54,340 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:17:55,344 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:17:55,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:17:55,873 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:09,686 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:18:20,838 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:18:20,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:21,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:18:21,015 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:18:21,123 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:18:21,375 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:18:23,244 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:18:23,712 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:18:28,282 - ispa_next.functions - DEBUG - Updated appointment (AB00036898) customer contact data.
2025-11-17 12:18:29,210 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:18:29,221 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:18:29,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:18:30,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:18:32,337 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:18:32,338 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:18:32,666 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:18:36,426 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:18:36,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:18:37,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:18:39,017 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:18:39,170 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:18:39,339 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:18:39,426 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:18:39,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:41,634 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:18:53,797 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:19:53,801 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:20:05,646 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-17 12:20:13,914 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:20:13,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:15,979 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:20:20,249 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:20:21,257 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:20:21,262 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:20:21,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:20:21,447 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:20:25,660 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:20:25,666 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:20:25,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:20:25,786 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:20:29,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:20:30,066 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:20:30,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:20:30,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:20:30,903 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:20:33,007 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:20:33,013 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:20:34,602 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:20:34,603 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:20:34,605 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:20:34,606 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:20:34,608 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 12:20:34,610 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:20:34,612 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:20:34,613 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:20:34,615 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:20:34,617 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 12:20:37,035 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:20:37,585 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:20:38,608 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:20:39,192 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:20:39,744 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:20:41,269 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:20:42,975 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:20:43,926 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:20:44,522 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:20:45,505 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:20:46,128 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:20:46,139 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:20:46,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:47,436 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:20:47,439 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:20:47,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:48,908 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:20:48,911 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:20:48,913 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:20:48,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:50,316 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:21:08,419 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:21:09,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:21:10,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:21:10,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:21:18,793 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:27,387 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:21:27,387 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:28,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:21:28,694 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:21:28,698 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:21:38,650 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:21:53,788 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:21:54,194 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:21:55,168 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:57,146 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 929
2025-11-17 12:21:57,147 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:22:01,641 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 12:22:01,642 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:22:02,925 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:22:02,934 - ispa_next.appointments.models - DEBUG - Appointment Markentechnikservice GmbH CO&K GER-MT 79 WBA21GW090CV54865 ohne Termin.
2025-11-17 12:22:02,949 - ispa_next.appointments.models - DEBUG - Appointment Pure Tax & Law Partnerschaftsgesellschaft mbB F-BR 1710E WBA41EU0909Y38493 ohne Termin.
2025-11-17 12:22:02,956 - ispa_next.main - DEBUG - 



2025-11-17 12:22:02,956 - ispa_next.main - DEBUG - starting with process 2 (F-HP 435) of 8
2025-11-17 12:22:02,959 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:22:04,450 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:22:06,331 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 929
2025-11-17 12:22:06,332 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 12:22:08,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:22:08,541 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:22:55,970 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:23:08,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:11,145 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:23:11,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:11,285 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:23:11,595 - ispa_next.functions - DEBUG - HU date already expired after 842 days.
2025-11-17 12:23:21,677 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:23:21,681 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:23:24,638 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:23:24,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:23:26,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:23:28,143 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:23:28,339 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:23:28,637 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:23:28,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:23:28,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:31,731 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:23:44,303 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:23:45,309 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:23:45,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:45,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:23:59,303 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:23:59,303 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:24:09,602 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:24:09,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:24:09,721 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:24:09,723 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:24:09,819 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:24:11,303 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:24:14,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:24:14,714 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:24:19,192 - ispa_next.functions - DEBUG - Updated appointment (AI00014825) customer contact data.
2025-11-17 12:24:20,187 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:24:20,203 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:24:21,473 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:24:21,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:24:22,429 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:24:26,143 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:24:26,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:24:26,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:24:28,689 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:24:28,836 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:24:29,010 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:24:29,168 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:24:29,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:24:32,096 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:24:44,303 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:25:44,305 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:25:56,092 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:26:06,940 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:26:07,951 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:26:07,953 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:26:07,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:08,073 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:26:12,254 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:26:12,261 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:26:12,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:12,414 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:26:12,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:13,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:26:13,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:14,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:26:14,307 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:26:16,931 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:26:16,934 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:26:18,309 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:26:18,312 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:26:18,315 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:26:18,319 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:26:18,323 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:26:18,327 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:26:18,331 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:26:18,337 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:26:18,338 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:26:18,340 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:26:18,344 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:26:18,346 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:26:18,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:21,411 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:26:21,414 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:26:21,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:24,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:26:24,424 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:26:37,508 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:26:37,512 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:26:37,514 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:26:37,516 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:26:40,218 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 12:26:50,817 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:27:09,691 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:27:10,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:27:11,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:27:12,061 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:20,828 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:27:29,619 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:27:29,619 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:27:30,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:27:30,666 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:27:30,680 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:27:40,484 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:27:53,119 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:27:53,505 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:27:54,886 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:27:56,982 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 12:27:56,987 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:28:01,560 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 12:28:01,564 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:02,726 - ispa_next.appointments.models - DEBUG - Appointment Techem Energy Service GmbH MTK-T 131E WBY61EF0X05W37510 ohne Termin.
2025-11-17 12:28:02,735 - ispa_next.appointments.models - DEBUG - Appointment RAMA V GmbH F-RV 66 WMWXR110X02M12873 ohne Termin.
2025-11-17 12:28:02,743 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 12:28:02,751 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:28:02,761 - ispa_next.appointments.models - DEBUG - Appointment Markentechnikservice GmbH CO&K GER-MT 79 WBA21GW090CV54865 ohne Termin.
2025-11-17 12:28:02,767 - ispa_next.main - DEBUG - Found new Appointment: F-GG 807E
2025-11-17 12:28:02,769 - ispa_next.main - DEBUG - 



2025-11-17 12:28:02,769 - ispa_next.main - DEBUG - starting with process 3 (F-GG 807E) of 9
2025-11-17 12:28:02,772 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:28:04,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:28:06,262 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 933
2025-11-17 12:28:06,264 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 12:28:08,634 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:28:08,635 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:53,143 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:29:06,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:06,164 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:06,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:07,774 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:29:07,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:07,909 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:08,336 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:29:18,771 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:29:18,776 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:29:21,790 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:29:21,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:23,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:29:25,394 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:29:25,569 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:29:25,687 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:29:25,832 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:29:25,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:27,307 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:29:38,551 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:29:46,885 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:29:46,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:48,308 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:29:52,606 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:29:53,612 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:29:53,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:54,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:12,915 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:30:23,764 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:30:23,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:23,849 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:30:23,850 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:30:24,133 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:30:25,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:30:27,041 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 12:30:28,574 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:30:28,963 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:30:34,109 - ispa_next.functions - DEBUG - Updated appointment (AB00036901) customer contact data.
2025-11-17 12:30:35,096 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:30:35,101 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:30:36,590 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:30:36,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:30:37,745 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:30:42,486 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:30:42,486 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:30:42,520 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:30:42,542 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:30:42,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:43,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:47,558 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:30:47,562 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:30:47,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:47,666 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:30:56,636 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 12:31:04,864 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:31:04,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:31:05,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:31:05,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:31:06,681 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:31:06,683 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:31:08,213 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:31:08,216 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:31:11,784 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:31:11,785 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:31:11,788 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 12:31:11,789 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:31:11,792 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:31:11,794 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:31:11,795 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:31:11,798 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:31:11,799 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:31:11,802 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:31:11,803 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:31:58,515 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:31:58,994 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 12:32:08,694 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:32:08,698 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:32:08,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:11,490 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:32:11,492 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:32:11,496 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:14,321 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:32:14,325 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:32:14,327 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:32:14,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:17,258 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:32:37,219 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:32:37,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:32:38,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:32:39,127 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:48,503 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:32:58,000 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:32:58,000 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:32:59,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:32:59,397 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:32:59,399 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:33:08,826 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:33:22,374 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:33:22,802 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 12:33:23,726 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:33:25,590 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:33:25,591 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:33:30,136 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 12:33:30,136 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:33:31,389 - ispa_next.appointments.models - DEBUG - Appointment Bilel Souguir HG-SB 805 WBAJP31020BT75020 ohne Termin.
2025-11-17 12:33:31,397 - ispa_next.appointments.models - DEBUG - Appointment Techem Energy Service GmbH MTK-T 131E WBY61EF0X05W37510 ohne Termin.
2025-11-17 12:33:31,407 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 12:33:31,415 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:33:31,425 - ispa_next.appointments.models - DEBUG - Appointment Markentechnikservice GmbH CO&K GER-MT 79 WBA21GW090CV54865 ohne Termin.
2025-11-17 12:33:31,435 - ispa_next.main - DEBUG - Found new Appointment: F-RV 66
2025-11-17 12:33:31,437 - ispa_next.main - DEBUG - 



2025-11-17 12:33:31,437 - ispa_next.main - DEBUG - starting with process 4 (F-RV 66) of 10
2025-11-17 12:33:31,442 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:33:32,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:33:34,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:33:34,803 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 12:33:37,765 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:33:37,766 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:34:19,034 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:34:33,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:34:35,909 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:34:35,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:36,125 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:34:36,624 - ispa_next.functions - DEBUG - HU date already expired after 962 days.
2025-11-17 12:34:46,747 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:34:46,751 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:34:49,766 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:34:49,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:34:51,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:34:53,208 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:34:53,384 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:34:53,516 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:34:53,643 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:34:57,933 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:34:58,937 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:34:58,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:34:59,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:04,644 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:35:04,649 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:35:04,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:04,806 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:35:04,808 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:35:04,891 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:35:05,656 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:35:07,522 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:35:08,138 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:35:10,207 - ispa_next.functions - DEBUG - Updated appointment (AB00036904) customer contact data.
2025-11-17 12:35:11,135 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:35:11,145 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:35:11,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:35:12,523 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:35:14,595 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:35:14,596 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:35:14,729 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:35:18,489 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:35:18,489 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:35:18,494 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:35:18,495 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:35:18,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:19,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:35:23,212 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:35:23,216 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:35:23,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:23,406 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:35:23,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:24,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:24,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:25,367 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:35:25,368 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:35:28,144 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:35:28,148 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:35:29,862 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:35:29,887 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:35:29,889 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:35:29,913 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:35:29,915 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:35:29,916 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:35:29,918 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:35:29,919 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:35:29,920 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:35:29,922 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:35:29,926 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:35:29,931 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:35:29,931 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:33,243 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:35:33,245 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:35:33,264 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:36,217 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:35:36,221 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:35:36,223 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:35:36,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:39,084 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:35:59,126 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:35:59,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:36:00,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:36:01,030 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:36:11,354 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:36:19,989 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:36:19,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:36:21,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:36:21,257 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:36:21,260 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:36:31,230 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:36:42,319 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 12:36:42,322 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:36:42,323 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:36:43,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:36:43,703 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:36:43,705 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:36:46,765 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 12:36:46,796 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:36:50,916 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 12:36:50,921 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:36:54,788 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:36:54,789 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:36:58,939 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 12:36:58,940 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:37:00,175 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 12:37:00,184 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:37:00,193 - ispa_next.appointments.models - DEBUG - Appointment Markentechnikservice GmbH CO&K GER-MT 79 WBA21GW090CV54865 ohne Termin.
2025-11-17 12:37:00,200 - ispa_next.main - DEBUG - Found new Appointment: HG-SB 805
2025-11-17 12:37:00,201 - ispa_next.main - DEBUG - 



2025-11-17 12:37:00,201 - ispa_next.main - DEBUG - starting with process 5 (HG-SB 805) of 11
2025-11-17 12:37:00,206 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:37:01,757 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:37:03,547 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:37:03,549 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 12:37:06,035 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:37:06,037 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:37:48,490 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:38:01,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:38:02,944 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:38:02,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:03,123 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:38:03,525 - ispa_next.functions - DEBUG - HU date already expired after 445 days.
2025-11-17 12:38:13,677 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:38:13,681 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:38:16,650 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:38:16,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:38:18,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:38:20,566 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:38:20,730 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:38:24,119 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:38:24,236 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:38:24,243 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:38:25,823 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:38:38,581 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:38:39,585 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:38:39,586 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:40,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:44,935 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:38:44,940 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:38:44,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:38:45,051 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:38:45,053 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:38:45,238 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:38:46,792 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:38:47,277 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:38:50,450 - ispa_next.functions - DEBUG - Updated appointment (AB00036907) customer contact data.
2025-11-17 12:38:51,395 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:38:51,399 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:38:52,633 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:38:52,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:38:53,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:38:57,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:38:57,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:38:58,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:39:00,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:39:00,629 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:39:00,827 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:39:01,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:39:01,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:02,538 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:39:14,681 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:40:14,685 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:40:25,944 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:40:34,735 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:40:34,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:40:38,568 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremse vorn' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:40:42,980 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:40:47,469 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:40:48,490 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:40:48,491 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:40:48,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:40:48,648 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:40:52,867 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:40:54,121 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:41:18,360 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:41:18,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:41:18,603 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:41:19,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:19,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:41:19,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:41:20,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:41:20,983 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:41:22,708 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:41:22,711 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:41:25,896 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:41:25,918 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:41:25,953 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:41:25,955 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:41:25,957 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:41:25,959 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:41:25,961 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:41:25,963 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:41:25,966 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:41:25,969 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:41:26,027 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:41:26,030 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:41:26,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:41:27,681 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:41:27,684 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:41:27,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:41:29,326 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:41:29,331 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:41:29,335 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:41:29,339 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:41:30,815 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:42:03,740 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:42:05,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:42:06,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:42:06,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:19,018 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:42:33,820 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:42:33,821 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:42:35,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:42:35,813 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:42:35,815 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:42:48,532 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:43:15,999 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 12:43:16,002 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:43:16,003 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:43:17,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:43:18,122 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:43:18,124 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:43:32,118 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:44:12,577 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 12:44:12,579 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:44:12,580 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:44:14,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:44:14,514 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:44:14,517 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:44:19,993 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 12:44:20,056 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 12:44:26,953 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 12:44:26,957 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:44:28,648 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:44:28,651 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:44:36,936 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 91
2025-11-17 12:44:36,937 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:44:39,298 - ispa_next.appointments.models - DEBUG - Appointment Dirk Brandes HG-BR 235E WBY11CF050CN83706 ohne Termin.
2025-11-17 12:44:39,314 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 12:44:39,323 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:44:39,331 - ispa_next.main - DEBUG - Found new Appointment: F-C 2370
2025-11-17 12:44:39,332 - ispa_next.main - DEBUG - 



2025-11-17 12:44:39,332 - ispa_next.main - DEBUG - starting with process 6 (F-C 2370) of 12
2025-11-17 12:44:39,336 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:44:42,302 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:44:45,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:44:45,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 12:44:49,759 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:44:49,761 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:45:58,161 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:46:18,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:46:20,569 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:46:20,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:20,792 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:46:21,438 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:46:21,444 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:46:25,117 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:46:25,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:46:28,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:46:30,123 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:46:30,427 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:46:33,807 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:46:34,029 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:46:34,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:46:36,491 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:46:53,253 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:46:54,267 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:46:54,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:55,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:47:01,837 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 12:47:01,841 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:47:01,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:47:02,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:47:02,014 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:47:02,163 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:47:04,163 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:47:06,005 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:47:06,395 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:47:10,727 - ispa_next.functions - DEBUG - Updated appointment (AB00036909) customer contact data.
2025-11-17 12:47:11,916 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:47:12,022 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:47:14,513 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:47:14,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:47:16,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:47:19,794 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:47:19,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:47:20,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:47:22,417 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:47:22,667 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:47:22,967 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:47:23,172 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:47:23,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:25,624 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:47:39,472 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:48:39,475 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:48:51,773 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 12:49:00,965 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:49:00,967 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:03,249 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:49:07,583 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:49:08,588 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:49:08,589 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:49:08,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:08,810 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:49:13,129 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:49:13,134 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:49:13,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:13,357 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:49:13,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:14,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:14,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:15,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:49:15,950 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:49:18,143 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:49:18,149 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:49:20,715 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:49:20,719 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:49:20,721 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:49:20,723 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:49:20,725 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:49:20,726 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:49:20,728 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:49:20,730 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:49:20,736 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:49:20,738 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:49:20,742 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:49:20,744 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:49:20,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:23,212 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:49:23,218 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:49:23,222 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:25,489 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:49:25,494 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:49:25,497 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:49:25,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:27,719 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:50:00,300 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:50:01,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:50:03,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:50:03,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:16,350 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:50:32,010 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:50:32,011 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:50:33,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:50:34,112 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:50:34,114 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:50:47,290 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:51:11,065 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:51:11,468 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:51:12,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:51:16,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:51:16,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:24,152 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 91
2025-11-17 12:51:24,153 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:51:26,304 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 12:51:26,315 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:51:26,322 - ispa_next.main - DEBUG - Found new Appointment: HG-BR 235E
2025-11-17 12:51:26,323 - ispa_next.main - DEBUG - 



2025-11-17 12:51:26,323 - ispa_next.main - DEBUG - starting with process 7 (HG-BR 235E) of 13
2025-11-17 12:51:26,327 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:51:29,312 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:51:32,716 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 934
2025-11-17 12:51:32,718 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 12:51:37,097 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:37,099 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:52:49,496 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:53:11,527 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:16,741 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:53:16,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:16,937 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:53:17,620 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:53:33,526 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:53:33,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:33,681 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:53:46,580 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:53:50,515 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:53:50,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:53,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:53:55,411 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:53:55,641 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:53:55,976 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:53:56,202 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:54:00,651 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:54:01,658 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:54:01,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:54:02,233 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:54:22,651 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:54:40,382 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:54:40,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:54:40,592 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:54:40,593 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:54:40,693 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:54:42,410 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:54:44,404 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:54:44,848 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:54:51,272 - ispa_next.functions - DEBUG - Updated appointment (AB00036910) customer contact data.
2025-11-17 12:54:52,420 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:54:52,478 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:54:55,120 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:54:55,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:54:57,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:55:00,730 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:55:00,730 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:55:00,734 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:55:00,735 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:55:00,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:55:01,390 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:55:05,647 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:55:07,682 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:55:26,660 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:55:26,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:55:26,837 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:55:32,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:55:33,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:55:33,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:55:34,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:55:34,718 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:55:39,571 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:55:39,573 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:55:41,910 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:55:41,912 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:55:41,914 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:55:41,915 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:55:41,948 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:55:41,950 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:55:41,952 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:55:41,954 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:55:41,956 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:55:41,961 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:55:41,964 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:55:41,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:47,451 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:55:47,454 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:55:47,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:52,746 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:55:52,750 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:55:52,753 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:55:52,756 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:58,007 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:56:29,033 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:56:29,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:56:31,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:56:31,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:47,655 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:57:01,851 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:57:01,852 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:57:04,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:57:04,543 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:57:04,549 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:57:17,757 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:57:42,567 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:57:42,998 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 12:57:44,257 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:57:48,482 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 937
2025-11-17 12:57:48,484 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:57:56,514 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-17 12:57:56,519 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:57:58,746 - ispa_next.appointments.models - DEBUG - Appointment BeKS GmbH HG-T 1912E WBY71EG0705408656 ohne Termin.
2025-11-17 12:57:58,756 - ispa_next.appointments.models - DEBUG - Appointment Roger Howard Fry F-RY 66 WBA81FY090FN83542 ohne Termin.
2025-11-17 12:57:58,765 - ispa_next.appointments.models - DEBUG - Appointment Leon Damm HOG-LD 711 WBA6L31070FK16617 ohne Termin.
2025-11-17 12:57:58,777 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 12:57:58,786 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 12:57:58,790 - ispa_next.main - DEBUG - 



2025-11-17 12:57:58,791 - ispa_next.main - DEBUG - starting with process 8 (FB-SI 9999) of 13
2025-11-17 12:57:58,795 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:58:01,916 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:58:05,428 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 937
2025-11-17 12:58:05,430 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-17 12:58:09,789 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:58:09,791 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:59:21,528 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:59:42,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:46,134 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:59:46,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:59:46,329 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:59:46,815 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:00:02,374 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:00:02,377 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:00:05,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:00:05,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:00:08,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:00:10,009 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:00:10,443 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:00:10,705 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:00:10,901 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:00:13,256 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:00:14,264 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:00:14,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:14,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:24,357 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:00:24,363 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:00:24,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:24,571 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:00:24,572 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:00:24,666 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:00:26,329 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:00:26,743 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:00:30,778 - ispa_next.functions - DEBUG - Updated appointment (AB00036887) customer contact data.
2025-11-17 13:00:32,045 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:00:32,049 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:00:34,382 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:00:34,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:00:36,578 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:00:40,886 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:00:40,886 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:00:40,889 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:00:40,890 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:00:40,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:00:41,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:00:45,737 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:00:55,355 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:00:55,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:00:55,560 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:00:56,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:56,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:00:56,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:00:57,885 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:00:57,886 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:01:01,524 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:01:01,528 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:01:03,768 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:01:03,769 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:01:03,771 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:01:03,773 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:01:03,775 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:01:03,777 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:01:03,779 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:01:03,781 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:01:03,835 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:01:03,843 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:01:03,849 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:01:03,852 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:01:03,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:07,893 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:01:14,105 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:01:14,192 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:01:14,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:18,338 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:01:18,341 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:01:18,348 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:01:18,359 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:22,267 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:01:54,470 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:01:55,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:01:57,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:01:57,543 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:02:12,225 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:02:27,197 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:02:27,198 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:02:29,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:02:29,806 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:02:29,809 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:02:44,380 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:03:09,411 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:03:09,814 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 13:03:11,711 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:03:15,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 938
2025-11-17 13:03:15,171 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:03:23,231 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 92
2025-11-17 13:03:23,232 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:25,330 - ispa_next.appointments.models - DEBUG - Appointment Leon Damm HOG-LD 711 WBA6L31070FK16617 ohne Termin.
2025-11-17 13:03:25,342 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:03:25,351 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:03:25,355 - ispa_next.main - DEBUG - Found new Appointment: F-RY 66
2025-11-17 13:03:25,357 - ispa_next.main - DEBUG - 



2025-11-17 13:03:25,357 - ispa_next.main - DEBUG - starting with process 9 (F-RY 66) of 14
2025-11-17 13:03:25,361 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:03:28,363 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:03:31,792 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 938
2025-11-17 13:03:31,795 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 92
2025-11-17 13:03:37,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:03:37,106 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:04:49,366 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:05:09,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:13,228 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:05:13,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:13,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:05:13,957 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:05:29,514 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:05:29,518 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:05:33,219 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:05:33,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:05:35,797 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:05:37,799 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:05:38,036 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:05:38,338 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:05:38,639 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:05:41,524 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:05:42,528 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:05:42,530 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:43,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:52,040 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:05:52,045 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:05:52,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:05:52,196 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:05:52,197 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:05:52,342 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:05:53,969 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:05:54,363 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:06:00,149 - ispa_next.functions - DEBUG - Updated appointment (AB00036912) customer contact data.
2025-11-17 13:06:01,369 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:06:01,469 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:06:04,006 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:06:04,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:06:05,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:06:09,902 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:06:09,902 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:06:09,906 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:06:09,907 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:06:09,909 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:10,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:06:14,834 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:06:16,812 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:06:34,652 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:06:34,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:34,847 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:06:35,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:36,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:06:36,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:06:37,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:06:37,533 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:06:41,121 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:06:41,125 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:06:44,779 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:06:44,782 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:06:44,784 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:06:44,786 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:06:44,824 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:06:44,826 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:06:44,828 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:06:44,829 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:06:44,831 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:06:44,833 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:06:44,845 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:06:44,940 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:06:44,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:48,851 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:06:48,854 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:06:48,870 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:52,571 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:06:52,574 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:06:52,576 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:06:52,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:56,438 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:07:28,812 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:07:29,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:07:31,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:07:31,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:07:47,986 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:08:03,067 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:08:03,068 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:08:04,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:08:05,127 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:08:05,128 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:08:19,873 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:08:48,870 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 13:08:48,873 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:08:48,874 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:08:50,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:08:51,129 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:08:51,131 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:08:56,572 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 13:08:56,613 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:09:04,966 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 13:09:04,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:06,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 938
2025-11-17 13:09:06,886 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:14,510 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:09:14,511 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:16,883 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:09:16,894 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:09:16,905 - ispa_next.main - DEBUG - 



2025-11-17 13:09:16,905 - ispa_next.main - DEBUG - starting with process 10 (HG-RV 69) of 14
2025-11-17 13:09:16,910 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:20,012 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:23,477 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 938
2025-11-17 13:09:23,479 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:09:27,741 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:27,743 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:42,543 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:11:07,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:11:12,182 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:11:12,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:12,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:11:13,044 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:11:13,048 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:11:16,659 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:11:16,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:11:19,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:11:21,093 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:11:21,346 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:11:21,624 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:11:21,817 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:11:26,205 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:11:27,212 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:11:27,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:27,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:38,857 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:11:38,864 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:11:38,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:11:39,096 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:11:39,097 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:11:39,166 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:11:39,845 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:11:41,894 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:11:42,391 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:11:47,378 - ispa_next.functions - DEBUG - Updated appointment (AA00046563) customer contact data.
2025-11-17 13:11:48,520 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:11:48,590 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:11:48,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:11:51,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:11:54,968 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:11:54,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:11:55,115 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:11:59,322 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:11:59,322 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:11:59,326 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:11:59,327 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:11:59,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:11:59,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:04,170 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:12:06,536 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:12:24,653 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:12:24,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:24,851 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:12:25,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:26,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:12:26,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:12:27,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:12:27,397 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:12:31,833 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:12:31,836 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:12:34,701 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:12:34,728 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:12:34,730 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:12:34,732 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:12:34,735 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:12:34,740 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:12:34,742 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:12:34,744 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:12:34,747 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:12:34,749 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:12:34,757 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:12:34,760 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:12:34,765 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:41,031 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:12:47,897 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:12:47,901 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:12:48,079 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:53,102 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:12:53,105 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:12:53,108 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:12:53,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:12:57,663 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:13:31,309 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:13:32,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:13:34,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:13:34,754 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:50,757 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:14:06,445 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:14:06,446 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:14:08,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:14:08,629 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:14:08,631 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:14:23,764 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:14:49,350 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:14:49,849 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 13:14:51,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:14:55,623 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 939
2025-11-17 13:14:55,625 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:03,608 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 91
2025-11-17 13:15:03,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:15:05,838 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:15:05,855 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:15:05,870 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:15:05,882 - ispa_next.main - DEBUG - 



2025-11-17 13:15:05,883 - ispa_next.main - DEBUG - starting with process 11 (HG-JX-30) of 14
2025-11-17 13:15:05,888 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:15:08,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:15:12,228 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 939
2025-11-17 13:15:12,230 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 91
2025-11-17 13:15:16,429 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:15:16,431 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:16:35,210 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:16:57,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:02,617 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:17:02,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:02,828 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:17:03,345 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:17:20,271 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:17:20,275 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:17:23,794 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:17:23,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:17:26,478 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:17:28,482 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:17:28,801 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:17:29,077 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:17:29,268 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:17:33,624 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:17:34,634 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:17:34,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:35,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:17:56,712 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:18:15,530 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:18:15,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:18:15,670 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:18:15,672 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:18:15,940 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:18:17,626 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:18:18,092 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:18:21,385 - ispa_next.functions - DEBUG - Updated appointment (AE00016651) customer contact data.
2025-11-17 13:18:22,987 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:18:23,260 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:18:26,706 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:18:26,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:18:28,863 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:18:32,538 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:18:32,538 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:18:32,542 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:18:32,543 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:18:32,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:33,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:18:37,606 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:18:40,107 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:18:59,362 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:18:59,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:18:59,535 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:19:00,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:01,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:01,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:02,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:02,366 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:19:07,403 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:19:07,408 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:19:09,997 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:19:09,998 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:10,000 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:19:10,002 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:19:10,004 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:19:10,040 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:19:10,042 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:19:10,044 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:19:10,046 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:19:10,048 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:19:10,053 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:19:10,056 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:19:10,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:15,635 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:19:29,774 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:19:29,853 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:19:29,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:35,618 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:19:35,621 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:19:35,624 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:19:35,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:19:41,205 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:20:17,365 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:20:18,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:20,213 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:20:20,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:37,495 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:53,967 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:20:53,968 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:20:56,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:20:56,278 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:20:56,280 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:21:10,227 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:21:40,791 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:21:41,209 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 13:21:42,682 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:47,638 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 940
2025-11-17 13:21:47,640 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:55,694 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 90
2025-11-17 13:21:55,695 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:21:57,769 - ispa_next.appointments.models - DEBUG - Appointment Diehl Aerospace GmbH FN-DA 350 WBA11AJ010CN17468 ohne Termin.
2025-11-17 13:21:57,778 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:21:57,792 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:21:57,801 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:21:57,806 - ispa_next.main - DEBUG - 



2025-11-17 13:21:57,806 - ispa_next.main - DEBUG - starting with process 12 (HG- BF 47E) of 14
2025-11-17 13:21:57,810 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:22:01,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:22:04,677 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 940
2025-11-17 13:22:04,679 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 90
2025-11-17 13:22:09,114 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:22:09,116 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:23:18,134 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:23:40,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:23:46,080 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:23:46,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:46,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:23:46,926 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:24:03,454 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:24:03,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:03,679 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:24:13,605 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:24:17,617 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:24:17,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:24:19,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:24:21,980 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:24:22,248 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:24:22,534 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:24:22,726 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:24:22,732 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:24:28,434 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:24:43,091 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:24:44,096 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:24:44,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:24:44,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:06,245 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:25:25,341 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:25:25,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:25,521 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:25:25,522 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:25:25,624 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:25:27,484 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:25:27,904 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:25:33,133 - ispa_next.functions - DEBUG - Updated appointment (AN00014675) customer contact data.
2025-11-17 13:25:34,455 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:25:34,503 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:25:37,998 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:25:37,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:25:39,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:25:43,474 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:25:43,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:44,083 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:25:46,088 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:25:46,321 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:25:46,640 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:25:46,854 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:25:46,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:52,565 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:26:06,812 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:26:18,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:26:33,967 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:26:53,174 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:26:54,180 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:26:54,181 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:26:54,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:26:54,354 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:26:58,584 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:27:00,839 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:27:21,580 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:27:21,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:21,779 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:27:22,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:23,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:27:23,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:27:24,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:27:24,403 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:27:29,574 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:27:29,597 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:27:32,218 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:27:32,219 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:32,221 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:27:32,223 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:27:32,225 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:27:32,227 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:27:32,228 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:27:32,230 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:27:32,231 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:27:32,233 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:27:32,237 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:27:32,240 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:27:32,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:37,939 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:27:44,291 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:27:44,360 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:27:44,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:50,322 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:27:50,325 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:27:50,328 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:27:50,331 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:55,902 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:28:29,279 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:28:30,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:28:32,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:28:32,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:49,373 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:29:08,565 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:29:08,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:29:10,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:29:10,790 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:29:10,793 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:29:25,510 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:29:51,111 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:29:51,551 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 13:29:52,776 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:29:57,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 941
2025-11-17 13:29:57,220 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:30:05,446 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 89
2025-11-17 13:30:05,447 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:30:07,934 - ispa_next.appointments.models - DEBUG - Appointment Desiree Ritter HG-D 212 WBA5V51060AJ55890 ohne Termin.
2025-11-17 13:30:07,966 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:30:07,996 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:30:08,012 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:30:08,020 - ispa_next.main - DEBUG - Found new Appointment: FN-DA 350
2025-11-17 13:30:08,023 - ispa_next.main - DEBUG - 



2025-11-17 13:30:08,023 - ispa_next.main - DEBUG - starting with process 13 (FN-DA 350) of 15
2025-11-17 13:30:08,028 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:30:11,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:30:14,907 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 941
2025-11-17 13:30:14,909 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 89
2025-11-17 13:30:19,089 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:30:19,092 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:31:36,920 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:32:00,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:32:06,446 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:32:06,447 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:32:06,663 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:32:07,176 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:32:26,560 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:32:26,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:32:26,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:32:57,912 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 13:32:57,923 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:33:01,556 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:33:01,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:04,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:06,810 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:33:07,124 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:33:07,348 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:33:07,623 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:33:11,945 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:33:12,951 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:33:12,952 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:13,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:25,497 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:33:25,502 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:33:25,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:25,646 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:33:25,647 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:33:25,786 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:33:27,622 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:33:28,169 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:33:35,771 - ispa_next.functions - DEBUG - Updated appointment (AB00036916) customer contact data.
2025-11-17 13:33:37,191 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:33:37,236 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:33:39,878 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:33:39,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:33:42,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:33:45,848 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:33:45,849 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:33:45,854 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:33:45,855 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:33:45,856 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:46,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:50,828 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:33:50,834 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:33:50,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:51,007 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:57,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:58,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:58,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:59,705 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:59,706 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:34:05,506 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:34:05,509 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:34:08,205 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:34:08,208 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:34:08,211 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:34:08,214 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:34:08,218 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:34:08,219 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:34:08,221 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:34:08,223 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:34:08,224 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:34:08,225 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:34:08,230 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:34:08,232 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:34:08,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:14,664 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:34:14,666 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:34:14,691 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:34:20,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:34:21,144 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:34:36,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:35:01,573 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:35:01,575 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:35:01,577 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:35:01,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:35:08,066 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 13:35:29,352 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:36:15,693 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:36:17,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:20,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:36:21,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:36:39,073 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:36:55,950 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:36:55,951 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:36:58,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:36:58,331 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:36:58,334 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:37:12,717 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:37:39,306 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:37:39,767 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 13:37:43,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:37:46,744 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 941
2025-11-17 13:37:46,746 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:37:54,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 13:37:54,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:37:57,275 - ispa_next.appointments.models - DEBUG - Appointment Srinivas Gunnam HG-GU 9999 WBAJK51050BJ13504 ohne Termin.
2025-11-17 13:37:57,291 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:37:57,304 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:37:57,313 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:37:57,318 - ispa_next.main - DEBUG - Found new Appointment: HG-D 212
2025-11-17 13:37:57,320 - ispa_next.main - DEBUG - 



2025-11-17 13:37:57,320 - ispa_next.main - DEBUG - starting with process 14 (HG-D 212) of 16
2025-11-17 13:37:57,324 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:38:00,537 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:38:04,116 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 941
2025-11-17 13:38:04,118 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 13:38:09,307 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:38:09,309 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:39:21,746 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:39:43,610 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:39:45,967 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:39:45,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:39:46,146 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:39:46,595 - ispa_next.functions - DEBUG - HU date already expired after 644 days.
2025-11-17 13:40:02,200 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:40:02,204 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:40:05,626 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:40:05,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:40:09,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:40:11,099 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:40:11,324 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:40:14,729 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:40:14,990 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:40:14,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:40:17,507 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:40:31,803 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:40:32,807 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:40:32,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:40:34,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:40:43,709 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:40:43,715 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:40:43,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:40:43,875 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:40:43,876 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:40:44,105 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:40:44,356 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:40:46,377 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:40:46,730 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:40:52,133 - ispa_next.functions - DEBUG - Updated appointment (AB00036918) customer contact data.
2025-11-17 13:40:53,220 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:40:53,335 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:40:53,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:40:56,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:40:59,571 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:40:59,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:40:59,863 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:41:04,284 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:41:04,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:05,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:41:07,146 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:41:07,507 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:41:07,788 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:41:08,063 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:41:08,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:10,517 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:41:23,018 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:41:33,210 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:41:33,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:41:35,548 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:41:39,944 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:41:40,953 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:41:40,954 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:41:40,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:41,182 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:41:45,449 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:41:45,455 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:41:45,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:45,623 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:41:50,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:51,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:41:51,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:41:52,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:41:52,639 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:41:54,894 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:41:54,899 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:41:58,305 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:41:58,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:41:58,314 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:41:58,315 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:41:58,317 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:41:58,319 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:41:58,320 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:41:58,321 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:41:58,323 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:41:58,325 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:41:58,329 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:41:58,332 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:41:58,333 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:00,817 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:42:00,821 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:42:00,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:03,247 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:42:03,250 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:42:03,253 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:42:03,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:42:05,601 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:42:42,308 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:42:43,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:42:45,517 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:42:46,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:43:00,909 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:43:19,045 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:43:19,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:43:21,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:43:21,235 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:43:21,237 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:43:35,888 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:44:04,144 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 13:44:04,145 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:44:04,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:44:06,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:44:06,280 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:44:06,282 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:44:11,787 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 13:44:11,843 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:44:20,330 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 13:44:20,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:44:22,015 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 942
2025-11-17 13:44:22,017 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:44:30,737 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 13:44:30,738 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:44:33,143 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:44:33,165 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:44:33,176 - ispa_next.appointments.models - DEBUG - Appointment Zhibin Wang HG-CC 931 WBA11DX050CE19118 ohne Termin.
2025-11-17 13:44:33,181 - ispa_next.main - DEBUG - Found new Appointment: HG-GU 9999
2025-11-17 13:44:33,183 - ispa_next.main - DEBUG - 



2025-11-17 13:44:33,183 - ispa_next.main - DEBUG - starting with process 15 (HG-GU 9999) of 17
2025-11-17 13:44:33,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:44:36,569 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:44:40,196 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 942
2025-11-17 13:44:40,198 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 13:44:44,593 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:44:44,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:45:57,832 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:46:19,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:46:23,075 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:46:23,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:46:23,310 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:46:24,000 - ispa_next.functions - DEBUG - HU date already expired after 751 days.
2025-11-17 13:46:39,853 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:46:39,856 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:46:43,320 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:46:43,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:46:46,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:46:48,275 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:46:48,503 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:46:48,827 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:46:49,076 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:46:53,452 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:46:54,458 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:46:54,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:46:55,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:47:17,070 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:47:34,763 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:47:34,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:47:34,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:47:34,957 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:47:35,051 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:47:36,994 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:47:37,422 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:47:45,507 - ispa_next.functions - DEBUG - Updated appointment (AB00036919) customer contact data.
2025-11-17 13:47:46,716 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:47:46,743 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:47:49,119 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:47:49,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:47:51,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:47:54,969 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:47:54,970 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:47:54,973 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:47:54,974 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:47:54,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:47:55,853 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:48:00,210 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:48:03,162 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:48:27,225 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:48:27,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:48:27,459 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:48:28,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:48:29,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:48:29,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:48:30,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:48:30,491 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:48:33,411 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:48:33,415 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:48:36,337 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:48:36,342 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:48:36,347 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:48:36,349 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:48:36,352 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:48:36,355 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:48:36,357 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:48:36,358 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:48:36,361 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:48:36,364 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:48:36,374 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:48:36,382 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:48:36,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:48:39,797 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:48:39,800 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:48:39,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:48:43,019 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:48:43,026 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:48:43,032 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:48:43,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:48:46,201 - ispa_next.functions - DEBUG - adding material to item=Package(name=Service Bremsflüssigkeit, source=cart, target=unkown)
2025-11-17 13:48:58,783 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:49:34,740 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:49:35,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:49:37,757 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:49:38,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:49:53,159 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:50:09,285 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:50:09,286 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:50:11,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:50:11,505 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:50:11,508 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:50:25,622 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:50:51,441 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:50:51,914 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 13:50:53,516 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:50:58,691 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-17 13:50:58,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:08,993 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 13:51:08,994 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:51:12,152 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 13:51:12,168 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:51:12,189 - ispa_next.appointments.models - DEBUG - Appointment Henning Erich Wendel SWA-HP 906 WBA11DX0X0CE32253 ohne Termin.
2025-11-17 13:51:12,196 - ispa_next.main - DEBUG - 



2025-11-17 13:51:12,196 - ispa_next.main - DEBUG - starting with process 16 (HG GG 404) of 17
2025-11-17 13:51:12,200 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:51:15,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:51:19,524 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 943
2025-11-17 13:51:19,526 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 13:51:24,387 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:51:24,392 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:52:42,332 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:53:05,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:53:09,293 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:53:09,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:09,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:53:10,129 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:53:28,698 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:53:28,703 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:53:32,255 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:53:32,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:53:35,481 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:53:37,484 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:53:37,690 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:53:37,965 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:53:38,126 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:53:42,519 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:53:43,526 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:53:43,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:44,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:53,704 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:53:53,713 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:53:53,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:53:54,021 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:53:54,022 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:53:54,321 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:53:58,232 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:53:59,776 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:54:00,493 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:54:06,138 - ispa_next.functions - DEBUG - Updated appointment (AE00016643) customer contact data.
2025-11-17 13:54:07,445 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:54:07,462 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:54:10,102 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:54:10,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:54:12,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:54:16,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:54:16,563 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:54:16,568 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:54:16,569 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:54:16,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:54:17,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:54:21,819 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:54:24,176 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:54:44,474 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:54:44,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:54:44,652 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:54:59,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:00,501 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:00,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:55:01,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:55:01,786 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:55:05,615 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:55:05,618 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:55:09,131 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:55:09,157 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:55:09,176 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:55:09,178 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:55:09,181 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:55:09,182 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:55:09,185 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:55:09,203 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:55:09,205 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:55:09,207 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:55:09,212 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:55:09,216 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:55:09,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:13,357 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:55:20,792 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:55:20,795 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:55:20,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:25,629 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:55:25,632 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:55:25,635 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:55:25,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:29,617 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:56:04,468 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:56:05,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:56:07,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:56:08,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:56:24,028 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:56:40,591 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:56:40,592 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:56:42,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:56:42,805 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:56:42,808 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:56:57,138 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:57:23,952 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:57:24,400 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 13:57:26,070 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:57:30,751 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 945
2025-11-17 13:57:30,756 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:57:39,802 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 88
2025-11-17 13:57:39,803 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:57:42,167 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 13:57:42,179 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 13:57:42,194 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 13:57:42,207 - ispa_next.main - DEBUG - 



2025-11-17 13:57:42,207 - ispa_next.main - DEBUG - starting with process 17 (F-AS 3777) of 17
2025-11-17 13:57:42,212 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:57:45,602 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:57:49,391 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 945
2025-11-17 13:57:49,395 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 88
2025-11-17 13:57:54,304 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:57:54,306 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:59:10,729 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:59:34,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:38,244 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:59:38,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:38,425 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:59:38,982 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:59:57,665 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:59:57,670 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:00:01,209 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:00:01,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:00:04,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:00:06,954 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:00:07,872 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:00:08,277 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:00:08,541 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:00:08,545 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:00:12,912 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:00:27,954 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:00:28,959 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:00:28,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:00:29,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:00:54,950 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:01:15,212 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:01:15,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:15,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:15,393 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:01:15,494 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:01:17,680 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:01:18,418 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:01:22,086 - ispa_next.functions - DEBUG - Updated appointment (AD00020630) customer contact data.
2025-11-17 14:01:23,416 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:01:23,488 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:01:26,082 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:01:26,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:01:28,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:01:32,684 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:01:32,684 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:32,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:01:33,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:01:35,746 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:01:36,010 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:01:36,364 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:01:36,668 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:01:36,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:01:40,716 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:01:53,506 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:02:03,376 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:02:03,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:02:07,396 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:02:11,791 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:02:12,798 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:02:12,799 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:02:12,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:12,979 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:02:17,304 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 14:02:20,055 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 14:02:40,161 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:02:40,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:40,453 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:02:53,767 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-17 14:03:08,474 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 14:03:08,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:10,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:10,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:12,498 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:03:12,500 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:03:16,342 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:03:16,352 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:03:19,480 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:03:19,486 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:03:19,490 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 14:03:19,495 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:03:19,502 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:03:19,503 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:03:19,505 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:03:19,507 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:03:19,509 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:03:19,512 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:03:19,515 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:04:22,716 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:04:23,256 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 14:04:42,290 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:04:42,324 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:04:42,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:48,127 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:04:48,134 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:04:48,139 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:53,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:54,060 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:05:07,700 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:05:07,703 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:05:07,705 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:05:07,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:13,442 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 14:05:32,740 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:06:13,741 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:06:15,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:06:17,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:06:17,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:36,071 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:06:55,602 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:06:55,603 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:06:57,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:06:57,932 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:06:57,934 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:07:12,958 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:07:40,570 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:07:41,005 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 14:07:45,738 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:07:49,045 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:07:49,047 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:00,339 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 87
2025-11-17 14:08:00,340 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:08:03,779 - ispa_next.appointments.models - DEBUG - Appointment Kanzlei Montgelas. Jochum Rechtsanwälte PartG mbB F-PR 2111 WBA21GE0007R09304 ohne Termin.
2025-11-17 14:08:03,791 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:08:03,801 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:08:03,816 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
2025-11-17 14:08:03,832 - ispa_next.main - DEBUG - Found new Appointment: F-UN 723
2025-11-17 14:08:03,835 - ispa_next.main - DEBUG - 



2025-11-17 14:08:03,835 - ispa_next.main - DEBUG - starting with process 18 (F-UN 723) of 18
2025-11-17 14:08:03,876 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:08:07,107 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:08:10,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:08:10,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 87
2025-11-17 14:08:15,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:08:15,541 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:09:27,101 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:09:49,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:50,893 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:09:50,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:51,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:09:51,471 - ispa_next.functions - DEBUG - HU date already expired after 605 days.
2025-11-17 14:10:09,897 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:10:09,901 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:10:13,370 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:10:13,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:16,546 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:18,550 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:10:18,833 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:10:22,247 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:10:22,621 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:10:26,971 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:10:27,986 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:10:27,989 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:29,007 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:38,342 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 14:10:38,347 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:10:38,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:38,587 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:38,589 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:10:38,674 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:10:38,982 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:10:40,957 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:10:41,623 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:10:47,382 - ispa_next.functions - DEBUG - Updated appointment (AL00015126) customer contact data.
2025-11-17 14:10:48,648 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:10:48,732 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:10:49,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:10:51,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:10:56,100 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:10:56,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:10:56,667 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:11:00,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:11:00,340 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:11:00,344 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:11:00,345 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 14:11:00,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:01,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:05,698 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 14:11:05,702 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:11:05,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:05,930 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:11:17,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:18,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:18,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:20,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:20,744 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:11:22,494 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:11:22,496 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:11:26,241 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:11:26,244 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:11:26,247 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:11:26,249 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:11:26,253 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:11:26,254 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:11:26,268 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:11:26,270 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:11:26,272 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:11:26,274 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:11:26,281 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:11:26,284 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:11:26,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:27,953 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:11:27,957 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:11:27,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:29,815 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:11:29,818 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:11:29,821 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:11:29,824 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:31,425 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:12:04,217 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:12:05,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:12:07,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:12:07,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:22,639 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:12:38,133 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:12:38,134 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:12:40,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:12:40,400 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:12:40,403 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:12:58,601 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:13:24,826 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:13:25,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 14:13:26,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:32,304 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 947
2025-11-17 14:13:32,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:40,968 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 87
2025-11-17 14:13:40,969 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:43,521 - ispa_next.appointments.models - DEBUG - Appointment Mukhtar Mahmud Mussa HG-NM 2407 WBA31DW050WW79265 ohne Termin.
2025-11-17 14:13:43,534 - ispa_next.appointments.models - DEBUG - Appointment Andrzej Lyson F-LY 1070 WBA81GE0307T90016 ohne Termin.
2025-11-17 14:13:43,544 - ispa_next.appointments.models - DEBUG - Appointment Joachim Stamm HG-JE 1965 WBA11DX010CD69852 ohne Termin.
