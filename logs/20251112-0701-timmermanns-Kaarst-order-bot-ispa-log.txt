2025-11-12 07:15:28,284 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 07:15:28,291 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 07:15:41,271 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 07:15:53,561 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 07:16:09,409 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:18:09,344 - ispa_next.app_start.main - DEBUG - Operation already took 108.33 seconds (more than 80 seconds)
2025-11-12 07:18:11,473 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fd6ee7cc1134d9dd\\tess__0tb42_r_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\fd6ee7cc1134d9dd\\tess__0tb42_r', 'txt']
2025-11-12 07:18:11,488 - ispa_next.app_start.main - DEBUG - Exception occurred: tesseract is not installed or it's not in your PATH. See README file for more information.
2025-11-12 07:18:11,489 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 07:18:38,454 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 07:18:54,199 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 07:18:57,285 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:18:58,724 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:18:58,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:19:01,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 135
2025-11-12 07:19:01,751 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 07:19:01,752 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:19:03,180 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 07:19:04,595 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:19:29,942 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:19:30,004 - ispa_next.appointments.models - DEBUG - Appointment Manuel Hermann Jaeger-Lenne GV-MJ 1989 WBAJG11030ED57177 ohne Termin.
2025-11-12 07:19:30,028 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-12 07:19:30,042 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-12 07:19:30,078 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-12 07:19:30,091 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-12 07:19:30,115 - ispa_next.appointments.models - DEBUG - Appointment   WBY61EF0105W96493 ohne Termin.
2025-11-12 07:19:30,129 - ispa_next.appointments.models - DEBUG - Appointment Krajnc ME-VV 1979 WBA11EV0209W56488 ohne Termin.
2025-11-12 07:19:30,169 - ispa_next.main - DEBUG - Found 15 out of 27 appointments to process (configured limit: 15).
2025-11-12 07:19:30,170 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 07:19:30,171 - ispa_next.main - DEBUG - Processing 12 already visited appointments (w/ RKR not callable).
2025-11-12 07:19:30,171 - ispa_next.main - DEBUG - All appointments: F-S685E, NE-X 1660, NE-RK 63, NE-MS 2311, NE-EG 1989, NE-GB 2917, D-NE 397, NE-EY 9, NE-RI 1352, NE-IM 149, KR-HK 6000, NE-IK 4000, F-CG 723, NE-BN 2510, D-CM 3200E
2025-11-12 07:19:30,174 - ispa_next.main - DEBUG - 



2025-11-12 07:19:30,174 - ispa_next.main - DEBUG - starting with process 1 (F-S685E) of 15
2025-11-12 07:19:30,178 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:19:31,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:19:33,199 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:19:33,200 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 135
2025-11-12 07:19:34,856 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:19:34,858 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:13,167 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 07:20:13,318 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 07:20:13,323 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:13,939 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:20:13,941 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:20:17,201 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 07:20:17,201 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:18,264 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:20:18,272 - ispa_next.main - DEBUG - 



2025-11-12 07:20:18,272 - ispa_next.main - DEBUG - starting with process 2 (NE-X 1660) of 15
2025-11-12 07:20:18,277 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:20:19,699 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:20:21,223 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:20:21,225 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:20:22,884 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:20:22,886 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:20:56,710 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:21:07,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:07,970 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:21:08,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:15,778 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:21:15,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:21:15,947 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:21:16,307 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-12 07:21:24,533 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:21:24,535 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:21:27,369 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:21:27,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:21:28,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:21:30,754 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:21:30,908 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:21:31,030 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:21:31,151 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:21:31,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:38,966 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:21:50,714 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 07:21:56,494 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:21:56,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:06,482 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 07:22:10,134 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 07:22:12,117 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:22:14,737 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:22:15,743 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:22:15,743 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:16,271 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:33,334 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:22:42,775 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:22:42,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:42,940 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:22:42,941 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:22:43,023 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:22:43,174 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:22:45,296 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:22:45,706 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:22:49,791 - ispa_next.functions - DEBUG - Updated appointment (AC00010688) customer contact data.
2025-11-12 07:22:50,724 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:22:50,727 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:22:50,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:22:51,813 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:22:53,045 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:22:53,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:22:53,209 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:22:56,860 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:22:56,860 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:22:56,863 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:22:56,866 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:22:56,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:57,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:57,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:58,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:58,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:59,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:59,273 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:23:00,964 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 07:23:01,375 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 141, in get_cart_content
    name=cart_package_name,
         ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 07:23:01,399 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:23:01,400 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:02,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:23:03,149 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:23:03,151 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:23:03,186 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:23:06,947 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 07:23:06,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:07,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:23:07,706 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:11,915 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 07:23:11,916 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:13,010 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:23:13,019 - ispa_next.main - DEBUG - 



2025-11-12 07:23:13,021 - ispa_next.main - DEBUG - starting with process 3 (NE-RK 63) of 15
2025-11-12 07:23:13,025 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:23:14,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:23:16,219 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:23:16,222 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:23:18,039 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:23:18,041 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:23:43,876 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:23:54,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:23:56,789 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:23:56,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:56,939 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:57,169 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:23:57,172 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:24:00,146 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:24:00,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:00,439 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 07:24:00,862 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 07:24:00,880 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:24:00,881 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:01,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:24:02,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:24:02,464 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 07:24:02,537 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 07:24:05,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 07:24:05,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:06,169 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:24:06,170 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:10,290 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 07:24:10,291 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:11,383 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:24:11,398 - ispa_next.main - DEBUG - 



2025-11-12 07:24:11,398 - ispa_next.main - DEBUG - starting with process 4 (NE-MS 2311) of 15
2025-11-12 07:24:11,407 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:12,954 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:24:14,746 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:24:14,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:24:16,400 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:24:16,402 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:24:48,723 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:24:50,936 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:24:56,379 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:58,334 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:24:58,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:58,458 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:24:58,831 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:24:58,838 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:25:01,707 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:25:01,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:03,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:05,104 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:25:05,290 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:25:05,488 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:25:05,597 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:25:09,875 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:25:10,880 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:25:10,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:11,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:25,790 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:25:25,790 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:25:30,661 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:25:30,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:30,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:25:30,805 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:25:30,900 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:25:32,519 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:25:34,213 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:25:34,553 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:25:36,504 - ispa_next.functions - DEBUG - Updated appointment (AB00014473) customer contact data.
2025-11-12 07:25:37,432 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:25:37,436 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:25:38,463 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:25:38,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:25:39,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:25:43,507 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 07:25:43,508 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:25:43,508 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:25:43,511 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:25:43,514 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:25:43,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:44,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:47,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:48,183 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:25:48,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:25:48,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:25:48,975 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:25:51,093 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:25:51,095 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:25:52,733 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:25:52,735 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:25:52,738 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:25:52,739 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:25:52,740 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:25:52,742 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:25:52,743 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:25:52,745 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:25:52,747 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:25:52,748 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:25:52,751 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:25:52,754 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:25:52,756 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:25:52,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:54,896 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:25:54,898 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:25:54,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:25:56,998 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:25:57,000 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:25:57,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:25:57,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:25:58,306 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:07,552 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:26:07,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:09,543 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:26:22,298 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:26:22,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:26:23,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:26:23,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:26:43,085 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:48,614 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:26:48,617 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:26:48,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:26:49,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:26:49,437 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:26:49,440 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:26:51,750 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:27:03,480 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:27:03,928 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 07:27:05,038 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:05,787 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:27:05,788 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:09,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 07:27:09,808 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:10,912 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:27:10,919 - ispa_next.main - DEBUG - 



2025-11-12 07:27:10,919 - ispa_next.main - DEBUG - starting with process 5 (NE-EG 1989) of 15
2025-11-12 07:27:10,923 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:27:12,353 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:27:14,110 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:27:14,112 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:27:15,803 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:27:15,805 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:27:53,784 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:27:55,990 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:28:01,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:28:04,188 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:28:04,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:04,356 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:04,617 - ispa_next.functions - DEBUG - HU date already expired after 808 days.
2025-11-12 07:28:09,553 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:28:09,555 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:28:12,398 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:12,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:13,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:15,763 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:28:15,912 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:28:16,023 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:28:16,133 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:28:18,361 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:28:19,366 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:28:19,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:19,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:37,367 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:28:45,159 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:28:45,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:45,278 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:28:45,279 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:28:45,362 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:28:45,555 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:28:47,331 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:28:47,688 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:28:50,182 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:28:50,184 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:28:50,310 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:28:51,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:28:52,541 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:28:52,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:28:52,616 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:28:56,325 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:28:56,325 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:28:56,328 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:28:56,331 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:28:56,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:56,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:57,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:58,138 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:28:58,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:28:59,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:28:59,078 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:29:01,704 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:29:01,706 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:29:03,466 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:29:03,468 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:29:03,473 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:29:03,474 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:29:03,476 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:29:03,479 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:29:03,480 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:29:03,482 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:29:03,484 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:29:03,485 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:29:03,488 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:29:03,491 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:29:03,493 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:29:03,494 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:06,339 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:29:06,341 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:29:06,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:09,116 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:29:09,118 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:29:09,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:29:10,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:29:10,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:20,168 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:29:20,170 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:29:22,937 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:29:36,239 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:29:36,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:29:37,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:29:37,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:30:04,871 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:30:10,310 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:30:15,418 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:30:15,421 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:30:15,422 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:30:16,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:30:16,345 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:30:16,346 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:30:18,722 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:30:28,449 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:30:28,846 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 07:30:30,030 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:30,701 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:30:30,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:34,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 07:30:34,903 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:30:35,999 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:30:36,005 - ispa_next.main - DEBUG - 



2025-11-12 07:30:36,005 - ispa_next.main - DEBUG - starting with process 6 (NE-GB 2917) of 15
2025-11-12 07:30:36,008 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:30:37,507 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:30:39,262 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:30:39,263 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:30:41,526 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:30:41,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:31:12,908 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:31:15,153 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:31:20,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:31:23,454 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:31:23,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:23,584 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:31:23,925 - ispa_next.functions - DEBUG - HU date already expired after 435 days.
2025-11-12 07:31:28,958 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:31:28,960 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:31:31,885 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:31:31,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:31:33,045 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:31:35,050 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:31:35,192 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:31:35,347 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:31:35,499 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:31:39,735 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:31:40,740 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:31:40,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:41,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:31:58,452 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:32:03,769 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:32:03,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:03,932 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:32:03,933 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:32:04,013 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:32:04,208 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:32:05,968 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:32:06,330 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:32:08,618 - ispa_next.functions - DEBUG - Updated appointment (AC00010673) customer contact data.
2025-11-12 07:32:09,540 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:32:09,543 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:32:09,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:32:10,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:32:11,896 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:32:11,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:32:12,016 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:32:16,072 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:32:16,072 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:32:16,075 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:32:16,080 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:32:16,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:16,611 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:32:16,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:17,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:32:17,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:32:18,600 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:32:18,601 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:32:21,297 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:32:21,300 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:32:22,881 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:32:22,882 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:32:22,885 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:32:22,886 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:32:22,887 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:32:22,890 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:32:22,891 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:32:22,892 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:32:22,894 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:32:22,895 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:32:22,898 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:32:22,901 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:32:22,903 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:32:22,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:25,595 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:32:25,596 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:32:25,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:28,329 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:32:28,331 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:32:28,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:32:29,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:32:29,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:36,205 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:32:36,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:32:39,002 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:32:51,619 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:32:52,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:32:52,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:32:52,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:33:20,480 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:33:26,123 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:33:31,374 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:33:31,377 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:33:31,378 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:33:32,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:33:32,285 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:33:32,287 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:33:34,642 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:33:45,313 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:33:45,705 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 07:33:46,865 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:33:47,771 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:33:47,773 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:33:52,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-12 07:33:52,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:33:53,542 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:33:53,549 - ispa_next.main - DEBUG - 



2025-11-12 07:33:53,549 - ispa_next.main - DEBUG - starting with process 7 (D-NE 397) of 15
2025-11-12 07:33:53,553 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:33:55,115 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:33:56,712 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:33:56,713 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-12 07:33:59,148 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:33:59,149 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:34:33,207 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:34:35,715 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:34:41,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:34:47,551 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:34:47,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:34:47,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:34:48,201 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:34:48,204 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:34:51,139 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:34:51,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:34:52,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:34:54,387 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:34:54,571 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:34:54,774 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:34:54,913 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:34:59,170 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:35:00,175 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:35:00,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:00,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:16,245 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:35:21,501 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:35:21,502 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:21,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:35:21,633 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:35:21,740 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:35:21,926 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:35:23,626 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:35:24,009 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:35:25,924 - ispa_next.functions - DEBUG - Updated appointment (AA00024911) customer contact data.
2025-11-12 07:35:26,958 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:35:26,959 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:35:27,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:35:28,541 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:35:29,878 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:35:29,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:35:29,979 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:35:33,636 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:35:33,636 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:35:33,640 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:35:33,645 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:35:33,646 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:34,163 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:35:34,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:35,303 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:35:35,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:36,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:35:36,092 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:35:41,618 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:35:41,621 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:35:42,759 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:35:42,768 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:35:42,771 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:35:42,773 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:35:42,774 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:35:42,778 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:35:42,780 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:35:42,781 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:35:42,785 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:35:42,786 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:35:42,790 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:35:42,822 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:35:42,824 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:35:42,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:49,141 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:35:49,143 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:35:49,146 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:35:55,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:35:55,525 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:36:10,268 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:36:10,270 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:36:10,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:36:11,255 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:36:11,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:24,975 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:36:24,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:36:31,189 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:36:44,981 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:36:45,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:36:46,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:36:46,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:37:46,256 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:52,576 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:37:57,951 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:03,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:11,058 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:16,511 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:22,099 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:27,924 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:38:32,493 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:38:32,494 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:33,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:38:33,440 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:38:33,442 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:38:38,325 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:38:48,619 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:38:49,097 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 07:38:50,740 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:38:51,607 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:38:51,609 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:38:56,472 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 07:38:56,473 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:38:57,667 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:38:57,678 - ispa_next.main - DEBUG - 



2025-11-12 07:38:57,678 - ispa_next.main - DEBUG - starting with process 8 (NE-EY 9) of 15
2025-11-12 07:38:57,682 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:38:59,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:39:00,884 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:39:00,885 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 07:39:03,124 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:39:03,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:39:35,362 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:39:37,987 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:39:43,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:39:45,587 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:39:45,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:45,776 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:39:46,091 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:39:46,094 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:39:49,106 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:39:49,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:39:50,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:39:52,524 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:39:52,748 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:39:52,916 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:39:53,041 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:39:57,269 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:39:58,274 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:39:58,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:39:59,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:16,093 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:40:21,516 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:40:21,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:21,595 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:40:21,596 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:40:21,697 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:40:23,216 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:40:23,596 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:40:25,518 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:40:25,521 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:40:26,594 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:40:26,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:40:27,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:40:31,383 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:40:31,383 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:40:31,386 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:40:31,389 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:40:31,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:32,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:40:32,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:32,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:40:32,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:40:34,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:40:34,433 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:40:36,458 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:40:36,461 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:40:37,795 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:40:37,798 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:40:37,802 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:40:37,804 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:40:37,807 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:40:37,820 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:40:37,823 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:40:37,826 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:40:37,829 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:40:37,830 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:40:37,832 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:40:37,835 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:40:37,837 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:40:37,838 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:39,973 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:40:39,974 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:40:39,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:41,992 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:40:41,994 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:40:41,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:40:43,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:40:43,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:52,663 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:40:52,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:40:54,737 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:41:08,205 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:41:08,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:41:09,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:41:09,551 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:41:28,446 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:34,148 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:41:34,150 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:41:34,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:41:34,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:41:35,021 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:41:35,023 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:41:37,163 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:41:47,102 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:41:47,533 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 07:41:48,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:41:49,775 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:41:49,776 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:41:54,084 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 07:41:54,084 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:41:55,180 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:41:55,186 - ispa_next.main - DEBUG - 



2025-11-12 07:41:55,186 - ispa_next.main - DEBUG - starting with process 9 (NE-RI 1352) of 15
2025-11-12 07:41:55,189 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:41:56,757 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:41:58,387 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:41:58,388 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 07:42:00,359 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:42:00,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:42:34,840 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:42:37,122 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:42:43,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:42:45,081 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:42:45,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:42:45,160 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:42:45,487 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:42:45,490 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:42:48,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:42:48,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:42:49,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:42:51,870 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:42:52,031 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:42:52,246 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:42:52,351 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:42:56,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:42:57,614 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:42:57,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:42:58,131 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:15,708 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:43:21,190 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:43:21,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:21,315 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:43:21,316 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:43:21,426 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:43:22,936 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:43:23,310 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:43:25,816 - ispa_next.functions - DEBUG - Updated appointment (AC00010676) customer contact data.
2025-11-12 07:43:26,792 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:43:26,794 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:43:27,722 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:43:27,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:43:28,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:43:32,875 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 07:43:32,876 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:43:32,876 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:43:32,878 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:43:32,881 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:43:32,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:43:33,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:43:37,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:37,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:43:37,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:43:38,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:43:38,846 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:43:40,953 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:43:40,956 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:43:42,965 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:43:42,966 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:43:42,969 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:43:42,970 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:43:42,971 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:43:42,974 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:43:42,976 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:43:42,977 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:43:42,979 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:43:42,980 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:43:42,983 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:43:42,986 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:43:42,988 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:43:42,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:45,148 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:43:45,150 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:43:45,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:47,341 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:43:47,342 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:43:47,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:43:48,475 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:43:48,778 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:43:58,033 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:43:58,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:00,145 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:44:13,302 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:44:13,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:44:14,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:44:14,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:44:33,689 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:44:39,647 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:44:39,650 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:44:39,651 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:44:40,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:44:40,496 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:44:40,498 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:44:42,912 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:44:53,127 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:44:53,565 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:44:55,265 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:44:56,279 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:44:56,280 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:45:00,254 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 07:45:00,255 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:45:01,934 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:45:01,940 - ispa_next.main - DEBUG - 



2025-11-12 07:45:01,940 - ispa_next.main - DEBUG - starting with process 10 (NE-IM 149) of 15
2025-11-12 07:45:01,943 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:45:03,480 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:45:05,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:45:05,166 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 07:45:07,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:45:07,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:45:41,173 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:45:43,700 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:45:49,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:45:52,204 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:45:52,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:45:52,343 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:45:52,594 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 07:45:57,747 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:45:57,750 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:46:00,660 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:46:00,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:46:02,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:46:04,092 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:46:04,218 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:46:04,324 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:46:04,475 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:46:06,607 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:46:07,612 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:46:07,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:08,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:25,148 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:46:30,966 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:46:30,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:31,103 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:46:31,104 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:46:31,203 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:46:31,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:46:33,275 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:46:33,631 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:46:35,608 - ispa_next.functions - DEBUG - Updated appointment (AA00024982) customer contact data.
2025-11-12 07:46:36,595 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:46:36,597 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:46:36,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:46:37,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:46:39,427 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:46:39,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:46:39,591 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:46:43,689 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:46:43,690 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:46:43,693 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:46:43,697 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:46:43,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:46:44,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:46:44,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:45,283 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:46:45,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:46:46,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:46:46,189 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:46:48,892 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:46:48,895 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:46:51,619 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:46:51,624 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:46:51,627 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:46:51,630 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:46:51,631 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:46:51,634 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:46:51,635 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:46:51,636 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:46:51,638 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:46:51,640 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:46:51,642 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:46:51,645 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:46:51,647 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:46:51,648 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:46:54,590 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:46:54,591 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:46:54,593 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:46:57,253 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:46:57,255 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:46:57,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:46:58,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:46:58,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:13,163 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:47:13,165 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:16,063 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:47:29,860 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:47:30,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:47:30,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:47:31,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:47:57,536 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:03,008 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:08,651 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:48:08,655 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:48:08,655 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:48:09,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:48:09,520 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:48:09,521 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:48:11,939 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:48:21,919 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:48:22,350 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:48:23,578 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:48:24,574 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:48:24,575 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:48:29,312 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 07:48:29,312 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:48:30,439 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:48:30,449 - ispa_next.main - DEBUG - 



2025-11-12 07:48:30,449 - ispa_next.main - DEBUG - starting with process 11 (KR-HK 6000) of 15
2025-11-12 07:48:30,457 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:48:31,991 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:48:33,720 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:48:33,721 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 07:48:35,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:48:35,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:49:10,266 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:49:12,531 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:49:18,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:49:22,747 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:49:22,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:22,864 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:49:23,233 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:49:23,236 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:49:26,108 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:49:26,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:49:27,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:49:29,686 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:49:29,833 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:49:29,937 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:49:30,102 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:49:34,350 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:49:35,355 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:49:35,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:35,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:49:54,287 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:50:00,121 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:50:00,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:00,235 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:50:00,236 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:50:00,409 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:50:00,567 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:50:02,280 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:50:02,597 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:50:04,858 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:50:04,862 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:50:05,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:50:06,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:50:08,166 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:50:08,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:50:08,297 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:50:11,909 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:50:11,909 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:50:11,912 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:50:11,915 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:50:11,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:12,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:21,178 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 07:50:32,481 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:50:32,941 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:34,452 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:50:34,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:50:35,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:50:35,219 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:50:39,095 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:50:39,097 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:50:41,433 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:50:41,435 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:50:41,439 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:50:41,469 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:50:41,489 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:50:41,494 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:50:41,495 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:50:41,496 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:50:41,500 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:50:41,501 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:50:41,505 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:50:41,526 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:50:41,532 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:50:41,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:46,093 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:50:46,095 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:50:46,097 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:50:50,289 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:50:50,292 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:50:50,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:50:51,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:50:51,313 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:06,074 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:51:06,076 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:51:10,265 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:51:23,516 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:51:23,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:51:24,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:51:24,874 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:52:05,136 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:10,889 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:16,696 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:22,526 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:29,339 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:52:29,341 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:52:29,342 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:52:30,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:52:30,321 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:52:30,323 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:52:32,697 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:52:42,812 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:52:43,226 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:52:44,465 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:52:45,651 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:52:45,653 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:52:50,468 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 07:52:50,468 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:52:51,525 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:52:51,531 - ispa_next.main - DEBUG - 



2025-11-12 07:52:51,531 - ispa_next.main - DEBUG - starting with process 12 (NE-IK 4000) of 15
2025-11-12 07:52:51,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:52:53,133 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:52:54,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:52:54,868 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 07:52:56,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:52:56,989 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:53:32,545 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:53:34,978 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:53:40,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:53:44,154 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:53:44,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:44,292 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:53:44,653 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:53:44,657 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:53:47,519 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:53:47,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:53:49,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:53:51,074 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:53:51,214 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:53:51,373 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:53:51,484 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:53:55,692 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:53:56,697 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:53:56,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:53:57,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:14,181 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:54:20,579 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:54:20,581 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:20,756 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:54:20,757 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:54:20,845 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:54:20,998 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:54:22,522 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:54:22,879 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:54:25,060 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:54:25,062 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:54:26,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:54:27,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:54:28,534 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:54:28,535 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:54:28,611 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:54:32,314 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:54:32,314 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:54:32,317 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:54:32,320 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:54:32,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:32,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:54:36,723 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:54:47,526 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:54:47,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:48,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:54:48,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:54:49,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:54:49,553 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:54:52,850 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:54:52,858 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:54:54,007 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:54:54,009 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:54,014 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:54:54,016 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:54:54,019 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:54:54,029 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:54:54,032 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:54:54,036 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:54:54,042 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:54:54,043 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:54:54,046 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:54:54,049 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:54:54,051 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:54:54,052 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:54:57,567 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:54:57,569 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:54:57,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:01,086 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:55:01,088 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:55:01,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:55:02,195 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:55:02,470 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:11,897 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:55:11,899 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:55:15,373 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:55:28,789 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:55:29,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:55:29,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:55:30,125 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:56:03,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:56:09,180 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:56:14,428 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:56:20,519 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:56:20,521 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:56:20,521 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:56:21,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:56:21,388 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:56:21,390 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:56:24,048 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:56:34,341 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:56:34,709 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:56:35,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:56:36,990 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:56:36,992 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:56:42,131 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 07:56:42,132 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:56:43,226 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 07:56:43,237 - ispa_next.main - DEBUG - 



2025-11-12 07:56:43,237 - ispa_next.main - DEBUG - starting with process 13 (F-CG 723) of 15
2025-11-12 07:56:43,242 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:56:44,738 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:56:46,476 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 07:56:46,486 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 07:56:48,459 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:56:48,461 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:57:23,123 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:57:25,588 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:57:31,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:57:33,748 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:57:33,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:57:33,884 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:57:34,281 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:57:34,284 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:57:37,350 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:57:37,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:57:38,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:57:40,904 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:57:41,085 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:57:41,186 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:57:41,337 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:57:45,565 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 07:57:46,570 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:57:46,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:57:47,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:58:05,153 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:58:11,162 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:58:11,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:58:11,361 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:58:11,362 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:58:11,459 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:58:13,061 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:58:13,454 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:58:15,588 - ispa_next.functions - DEBUG - Updated appointment (AB00014549) customer contact data.
2025-11-12 07:58:16,516 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:58:16,620 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:58:17,614 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:58:17,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:58:18,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:58:22,500 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:58:22,500 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 07:58:22,503 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:58:22,506 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:58:22,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:58:23,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:58:32,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:58:32,956 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:58:32,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:58:33,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:58:33,830 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:58:35,886 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:58:35,889 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:58:37,459 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:58:37,460 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:58:37,463 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 07:58:37,464 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:58:37,465 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:58:37,468 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:58:37,469 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:58:37,471 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:58:37,473 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:58:37,474 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:58:37,476 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:58:37,480 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:58:37,482 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:58:37,483 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:58:39,558 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:58:39,559 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:58:39,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:58:41,723 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:58:41,725 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:58:41,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:58:43,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:58:43,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:58:58,877 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:58:58,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:59:00,890 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:59:14,440 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:59:14,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:59:15,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:59:15,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:59:35,664 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:59:41,689 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:59:41,692 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:59:41,692 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:59:42,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:59:42,622 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:59:42,625 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:59:44,761 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:59:54,607 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:59:54,986 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:59:56,326 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:59:57,326 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 07:59:57,328 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 08:00:01,454 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 08:00:01,455 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:00:02,655 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 08:00:02,664 - ispa_next.main - DEBUG - 



2025-11-12 08:00:02,664 - ispa_next.main - DEBUG - starting with process 14 (NE-BN 2510) of 15
2025-11-12 08:00:02,668 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:00:04,273 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:00:06,819 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 08:00:06,821 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 08:00:08,995 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 08:00:08,996 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:00:42,399 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 08:00:44,884 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 08:00:50,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:00:53,295 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 08:00:53,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:00:53,487 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:00:53,803 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 08:00:53,806 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 08:00:56,717 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:00:56,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:00:58,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:01:00,466 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 08:01:00,601 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 08:01:00,766 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 08:01:00,983 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 08:01:05,223 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 08:01:06,230 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 08:01:06,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:01:06,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:01:24,028 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 08:01:29,952 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 08:01:29,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:01:30,149 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:01:30,150 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 08:01:30,268 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 08:01:30,408 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 08:01:32,196 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 08:01:32,547 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 08:01:34,778 - ispa_next.functions - DEBUG - Updated appointment (AA00024791) customer contact data.
2025-11-12 08:01:35,705 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 08:01:35,818 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 08:01:35,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 08:01:37,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 08:01:39,014 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 08:01:39,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 08:01:39,182 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 08:01:42,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:01:42,825 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 08:01:42,829 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 08:01:42,833 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 08:01:42,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:01:43,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:01:43,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:01:44,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:01:44,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:01:45,252 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:01:45,254 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 08:01:47,881 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 08:01:47,884 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 08:01:49,195 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 08:01:49,197 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:01:49,201 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 08:01:49,203 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 08:01:49,214 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:01:49,218 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 08:01:49,222 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 08:01:49,223 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 08:01:49,226 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 08:01:49,227 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 08:01:49,230 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 08:01:49,233 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 08:01:49,235 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 08:01:49,236 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:01:52,089 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 08:01:52,090 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 08:01:52,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:01:54,871 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 08:01:54,873 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 08:01:54,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 08:01:56,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 08:01:56,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:02:06,495 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 08:02:06,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:02:09,273 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 08:02:22,488 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 08:02:23,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:02:23,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 08:02:23,851 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:02:49,793 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:02:55,520 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:03:01,113 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:03:01,115 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 08:03:01,116 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:03:01,898 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:03:01,983 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 08:03:01,985 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 08:03:04,349 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 08:03:14,612 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 08:03:15,017 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 08:03:16,382 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:03:17,426 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 08:03:17,427 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 08:03:22,390 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 08:03:22,391 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:03:23,599 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 08:03:23,608 - ispa_next.main - DEBUG - 



2025-11-12 08:03:23,608 - ispa_next.main - DEBUG - starting with process 15 (D-CM 3200E) of 15
2025-11-12 08:03:23,613 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:03:25,235 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:03:27,840 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 08:03:27,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 136
2025-11-12 08:03:29,869 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 08:03:29,871 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:04:05,253 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 08:04:09,274 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 08:04:15,541 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:04:19,584 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 08:04:19,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:04:19,774 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:04:20,044 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 08:04:25,723 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 08:04:25,725 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 08:04:28,556 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:04:28,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:04:30,130 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:04:32,133 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 08:04:32,273 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 08:04:32,404 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 08:04:32,502 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 08:04:36,718 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 08:04:37,722 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 08:04:37,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:04:38,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:04:56,563 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 08:05:02,965 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 08:05:02,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:05:03,105 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 08:05:03,106 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 08:05:03,172 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 08:05:03,314 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 08:05:04,939 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 08:05:05,270 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 08:05:07,565 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 08:05:07,569 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 08:05:07,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 08:05:09,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 08:05:10,265 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 08:05:10,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 08:05:10,363 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 08:05:13,997 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 08:05:13,997 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 08:05:14,000 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 08:05:14,003 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 08:05:14,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:05:14,567 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:05:23,362 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 08:05:38,856 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 08:05:39,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 08:05:41,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 08:05:41,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 08:05:42,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 08:05:42,630 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 08:05:45,928 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 08:05:45,930 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 08:05:49,088 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 08:05:49,116 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:05:49,120 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 08:05:49,128 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 08:05:49,129 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 08:05:49,132 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 08:05:49,133 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 08:05:49,136 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 08:05:49,137 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 08:05:49,140 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 08:05:49,144 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 08:05:49,146 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 08:05:49,147 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:05:52,760 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 08:05:52,762 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 08:05:52,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:05:56,276 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 08:05:56,279 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 08:05:56,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 08:05:57,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 08:05:58,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:06:08,791 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 08:06:08,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:06:12,355 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 08:06:26,396 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 08:06:26,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:06:27,619 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 08:06:27,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 08:07:01,743 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:07:07,606 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:07:12,928 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:07:19,707 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 08:07:19,710 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 08:07:19,710 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 08:07:21,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 08:07:21,306 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 08:07:21,308 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 08:07:23,743 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 08:07:34,131 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 08:07:34,520 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 08:07:36,049 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 08:07:37,122 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 391
2025-11-12 08:07:37,124 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 08:07:42,521 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 136
2025-11-12 08:07:42,521 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 08:07:43,601 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
