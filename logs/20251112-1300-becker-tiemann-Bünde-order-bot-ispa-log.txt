2025-11-12 13:00:36,369 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:00:36,375 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:00:44,417 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:00:56,151 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:01:11,696 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:03:09,778 - ispa_next.app_start.main - DEBUG - Operation already took 106.73 seconds (more than 80 seconds)
2025-11-12 13:03:11,847 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_8w78k78i_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_8w78k78i', 'txt']
2025-11-12 13:03:12,090 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:03:12,094 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:03:12,095 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:05:11,388 - ispa_next.app_start.main - DEBUG - Operation already took 106.87 seconds (more than 80 seconds)
2025-11-12 13:05:13,470 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_0ej41w60_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_0ej41w60', 'txt']
2025-11-12 13:05:13,696 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:05:13,701 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:05:21,125 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 13:05:28,412 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:05:38,812 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:05:54,355 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:07:52,387 - ispa_next.app_start.main - DEBUG - Operation already took 106.98 seconds (more than 80 seconds)
2025-11-12 13:07:54,469 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_a561fy_k_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_a561fy_k', 'txt']
2025-11-12 13:07:54,701 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:07:54,706 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:07:54,707 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:09:53,826 - ispa_next.app_start.main - DEBUG - Operation already took 106.70 seconds (more than 80 seconds)
2025-11-12 13:09:55,914 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_oeu3h7ki_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\65f67da6209d66a8\\tess_oeu3h7ki', 'txt']
2025-11-12 13:09:56,163 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 13:09:56,168 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 13:10:03,811 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 13:10:11,501 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:10:22,281 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:10:37,821 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:11:01,793 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:11:12,787 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:11:15,978 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:17,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:11:17,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:11:19,480 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 13:11:19,481 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:11:19,481 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:11:20,670 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:11:21,882 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:43,054 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 13:11:43,071 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 13:11:43,080 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 13:11:43,088 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 13:11:43,103 - ispa_next.main - DEBUG - Found 15 out of 37 appointments to process (configured limit: 15).
2025-11-12 13:11:43,104 - ispa_next.main - DEBUG - Processing 9 fresh appointments.
2025-11-12 13:11:43,104 - ispa_next.main - DEBUG - Processing 6 already visited appointments (w/ RKR not callable).
2025-11-12 13:11:43,105 - ispa_next.main - DEBUG - All appointments: HF-GH 1010, HF-X 1020, BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE, HF-C 213, HF-C 213, HF-H 2227E, HF-AV 404, HF-GE 123, OS-BO 693
2025-11-12 13:11:43,112 - ispa_next.main - DEBUG - 



2025-11-12 13:11:43,112 - ispa_next.main - DEBUG - starting with process 1 (HF-GH 1010) of 15
2025-11-12 13:11:43,115 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:11:44,244 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:11:45,236 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:11:45,237 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 13:11:46,424 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:11:46,426 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:12:14,601 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:12:23,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:23,838 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:23,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:12:25,161 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:12:25,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:25,244 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:25,409 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:12:25,411 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:12:25,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:25,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:28,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:28,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:29,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:31,414 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:31,522 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:34,770 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:34,855 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:12:34,856 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:12:43,177 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:12:44,181 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:12:44,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:44,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:58,398 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:13:05,061 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:13:05,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:05,163 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:13:05,164 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:13:05,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:13:06,542 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:13:07,674 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:13:07,878 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:13:11,077 - ispa_next.functions - DEBUG - Updated appointment (AA00044543) customer contact data.
2025-11-12 13:13:11,979 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:13:11,984 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:13:12,628 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:13:12,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:13:13,272 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:13:17,313 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:13:17,313 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:13:17,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:17,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:19,811 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:13:19,912 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:13:20,036 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:13:20,102 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:13:20,103 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:13:28,463 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:14:28,466 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:14:39,860 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:14:44,179 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:14:44,180 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:14:48,357 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:14:49,370 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:14:49,373 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:14:49,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:49,435 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:14:53,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:53,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:14:53,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:54,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:14:54,413 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:14:55,702 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:14:55,704 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:14:56,787 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:14:56,789 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:14:56,791 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:14:56,793 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:14:56,794 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:14:56,795 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:14:56,797 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:14:56,798 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:14:56,801 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:14:56,808 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:14:56,811 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:14:56,817 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:14:56,820 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:14:56,821 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:14:56,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:58,059 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:14:58,060 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:14:58,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:59,264 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:14:59,265 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:14:59,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:14:59,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:15:00,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:13,906 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:15:13,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:15,125 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:15:15,127 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:15:15,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:16,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:15:16,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:15:21,388 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:15:21,390 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:15:21,390 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:21,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:21,925 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:15:21,926 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:15:23,471 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:15:33,913 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:15:34,288 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:15:34,612 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:35,551 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:15:35,553 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:38,380 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:15:38,381 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:15:39,282 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:15:39,290 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:15:39,298 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:15:39,304 - ispa_next.main - DEBUG - 



2025-11-12 13:15:39,304 - ispa_next.main - DEBUG - starting with process 2 (HF-X 1020) of 15
2025-11-12 13:15:39,307 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:15:40,387 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:15:41,520 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:15:41,521 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:15:42,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:15:42,879 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:16:11,390 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:16:20,636 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:28,736 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:16:28,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:28,812 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:28,984 - ispa_next.functions - DEBUG - HU date already expired after 78 days.
2025-11-12 13:16:36,243 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:16:36,246 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:16:36,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:16:36,363 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:16:46,890 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:16:46,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:16:47,950 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:16:49,952 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:16:50,080 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:16:53,332 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:16:53,437 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:16:53,437 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:17:01,756 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:17:02,784 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:17:02,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:03,370 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:17,589 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:17:24,996 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:17:24,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:17:25,075 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:17:25,076 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:17:25,105 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:17:26,424 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:17:27,517 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 13:17:28,727 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 13:17:29,113 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:17:31,739 - ispa_next.functions - DEBUG - Updated appointment (AA00044542) customer contact data.
2025-11-12 13:17:32,663 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:17:32,665 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:17:33,500 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:17:33,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:17:34,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:17:38,409 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:17:38,409 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:17:38,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:17:38,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:17:40,964 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:17:41,086 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:17:41,191 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:17:41,267 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:17:41,268 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:17:49,448 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:18:49,450 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:18:57,721 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:19:11,725 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:19:22,539 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 13:19:27,090 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:19:27,090 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:19:29,231 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:19:30,249 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:19:30,253 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:19:30,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:30,369 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:19:30,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:31,411 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:31,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:32,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:32,149 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:19:40,332 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:19:40,334 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:19:41,408 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:19:41,409 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:41,411 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Beide Bremsscheiben vorn aus- und einbauen/ersetze, source=from_aw_package, target=cart), Package(name=Beide Bremsscheiben hinten aus- und einbauen/erset, source=from_aw_package, target=cart)}
2025-11-12 13:19:41,412 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:19:41,413 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:19:41,414 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:19:41,416 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:19:41,418 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:19:41,422 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:19:41,439 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:19:41,444 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:19:56,033 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 366, in _add_to_container_from_aw
    raise RuntimeError("Button 'Warenkorb' and 'Beratungsliste' are disabled")
RuntimeError: Button 'Warenkorb' and 'Beratungsliste' are disabled

2025-11-12 13:19:56,119 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:19:56,119 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:19:57,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:19:57,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:19:57,858 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:19:57,892 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:20:00,866 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:20:00,869 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:01,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:20:01,410 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:04,377 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:20:04,378 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:05,218 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:20:05,225 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:20:05,232 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:20:05,236 - ispa_next.main - DEBUG - 



2025-11-12 13:20:05,236 - ispa_next.main - DEBUG - starting with process 3 (BÜNDE) of 15
2025-11-12 13:20:05,240 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:20:06,424 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:07,758 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:20:07,760 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:20:09,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:09,192 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:39,008 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:20:39,020 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:20:39,023 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:39,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:20:39,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:41,465 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:20:41,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:20:42,129 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:20:42,136 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:20:42,143 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:20:42,149 - ispa_next.main - DEBUG - 



2025-11-12 13:20:42,149 - ispa_next.main - DEBUG - starting with process 4 (HF-LB-222) of 15
2025-11-12 13:20:42,153 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:20:42,957 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:20:43,828 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:20:43,829 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:20:45,298 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:20:45,299 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:18,434 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:21:18,444 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:21:18,447 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:18,923 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:21:18,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:21,205 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:21:21,206 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:21,873 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:21:21,879 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:21:21,887 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:21:21,891 - ispa_next.main - DEBUG - 



2025-11-12 13:21:21,891 - ispa_next.main - DEBUG - starting with process 5 (HF L 1612) of 15
2025-11-12 13:21:21,894 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:21:22,929 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:23,999 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:21:24,001 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:21:25,369 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:25,370 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:56,108 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:21:56,117 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:21:56,119 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:56,410 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:21:56,411 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:58,833 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:21:58,834 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:59,696 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:21:59,703 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:21:59,710 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:21:59,715 - ispa_next.main - DEBUG - 



2025-11-12 13:21:59,715 - ispa_next.main - DEBUG - starting with process 6 (OS-CW177) of 15
2025-11-12 13:21:59,717 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:00,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:01,915 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:22:01,916 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:22:03,280 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:03,282 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:33,917 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:22:33,931 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:22:33,934 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:34,294 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:22:34,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:36,189 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:22:36,189 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:36,792 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:22:36,799 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:22:36,805 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:22:36,809 - ispa_next.main - DEBUG - 



2025-11-12 13:22:36,809 - ispa_next.main - DEBUG - starting with process 7 (HF-BT 540) of 15
2025-11-12 13:22:36,813 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:37,698 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:38,518 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:22:38,519 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:22:39,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:39,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:03,095 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:23:13,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:16,990 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:23:16,991 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:17,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:23:17,296 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:23:17,298 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:23:17,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:17,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:23:20,650 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:23:20,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:23:21,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:23:23,842 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:23:23,951 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:23:27,193 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:23:35,220 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 13:23:36,225 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:23:36,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:36,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:48,408 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:23:48,408 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:23:55,310 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:23:55,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:55,402 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:23:55,403 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:23:55,447 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:23:56,662 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:23:56,871 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:24:00,104 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 13:24:01,014 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:24:01,015 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:24:01,757 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:24:01,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:24:02,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:24:06,079 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:24:06,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:24:06,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:24:08,584 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:24:09,081 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:24:09,184 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:24:09,247 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:24:09,248 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:24:17,253 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 13:25:17,255 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:25:28,129 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 13:25:32,198 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:25:32,199 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:25:36,416 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:25:37,423 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:25:37,426 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:25:37,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:37,510 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:25:46,832 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:25:51,486 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:25:51,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:51,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:51,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:52,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:52,736 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:25:56,292 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:25:56,294 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:25:57,393 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:25:57,395 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:25:57,398 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:25:57,400 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:25:57,401 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 13:25:57,402 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:25:57,404 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:25:57,405 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:25:57,406 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:25:57,408 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:25:57,409 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:25:57,411 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:25:57,412 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:26:19,983 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 13:26:20,005 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:26:20,006 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:20,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:26:21,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:26:21,388 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:26:21,407 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:26:23,891 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:26:23,894 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:24,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:26:24,241 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:27,321 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:26:27,322 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:28,112 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:26:28,120 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:26:28,128 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:26:28,132 - ispa_next.main - DEBUG - 



2025-11-12 13:26:28,132 - ispa_next.main - DEBUG - starting with process 8 (MI-JC 96 E) of 15
2025-11-12 13:26:28,135 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:29,269 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:30,513 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:26:30,514 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:26:32,163 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:32,165 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:09,464 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:27:09,473 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:27:09,475 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:09,839 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:27:09,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:11,839 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:27:11,840 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:12,478 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:27:12,485 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:27:12,491 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:27:12,494 - ispa_next.main - DEBUG - 



2025-11-12 13:27:12,494 - ispa_next.main - DEBUG - starting with process 9 (BÜNDE) of 15
2025-11-12 13:27:12,498 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:13,378 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:14,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:27:14,289 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:27:15,449 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:15,451 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:45,385 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:27:45,396 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:27:45,399 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:45,857 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:27:45,858 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:48,212 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:27:48,213 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:49,147 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:27:49,153 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:27:49,160 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:27:49,164 - ispa_next.main - DEBUG - 



2025-11-12 13:27:49,164 - ispa_next.main - DEBUG - starting with process 10 (HF-C 213) of 15
2025-11-12 13:27:49,168 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:27:50,318 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:27:51,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:27:51,389 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:27:52,751 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:27:52,753 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:28:14,176 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:28:16,183 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:28:21,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:23,173 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:28:23,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:23,257 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:23,504 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:28:23,507 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:28:23,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:23,621 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:30,473 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:30,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:31,455 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:33,460 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:28:33,559 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:28:33,641 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:28:33,699 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:28:37,881 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:28:38,885 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:28:38,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:39,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:48,588 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:28:52,162 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:28:52,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:52,227 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:28:52,228 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:28:52,267 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:28:52,381 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:28:53,510 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:28:53,733 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:28:54,927 - ispa_next.functions - DEBUG - Updated appointment (AI00015550) customer contact data.
2025-11-12 13:28:55,846 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:28:55,847 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:28:55,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:28:56,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:28:57,481 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:28:57,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:28:57,594 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:29:01,170 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:29:01,170 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:29:01,173 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:29:01,174 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:29:01,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:01,660 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:02,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:02,568 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:29:02,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:29:03,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:29:03,211 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:29:05,128 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:29:05,130 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:29:06,092 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:29:06,093 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:29:06,095 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:29:06,096 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:29:06,097 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:29:06,098 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:29:06,099 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:29:06,101 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:29:06,102 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:29:06,103 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:29:06,104 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:29:06,106 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:29:06,118 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:29:06,120 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:29:06,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:08,070 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:29:08,072 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:29:08,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:09,983 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:29:09,985 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:29:09,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:29:10,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:29:11,047 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:20,185 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:29:20,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:22,056 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:29:22,058 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:29:22,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:29:23,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:29:23,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:31,177 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:29:35,332 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:29:35,334 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:29:35,334 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:36,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:29:36,181 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:29:36,182 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:29:37,881 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:29:44,933 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:29:45,313 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:29:45,663 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:47,343 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:29:47,345 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:50,039 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:29:50,040 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:50,813 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:29:50,824 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:29:50,832 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:29:50,836 - ispa_next.main - DEBUG - 



2025-11-12 13:29:50,836 - ispa_next.main - DEBUG - starting with process 11 (HF-C 213) of 15
2025-11-12 13:29:50,839 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:52,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:53,252 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:29:53,254 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:29:54,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:54,654 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:30:18,286 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:30:20,094 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:30:25,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:26,916 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:30:26,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:27,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:27,244 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:30:27,246 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:30:27,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:27,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:33,739 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:30:33,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:34,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:36,629 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:30:36,720 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:30:36,820 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:30:36,879 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:30:41,099 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:30:42,122 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:30:42,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:42,585 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:51,715 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:30:55,747 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:30:55,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:55,820 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:55,821 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:30:55,859 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:30:55,982 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:30:57,197 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:30:57,428 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:30:59,110 - ispa_next.functions - DEBUG - Updated appointment (AF00021378) customer contact data.
2025-11-12 13:31:00,012 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:31:00,014 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:31:00,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:31:00,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:31:01,632 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:31:01,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:31:01,698 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:31:05,262 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:31:05,262 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:31:05,266 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:31:05,268 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:31:05,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:05,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:06,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:06,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:06,685 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:07,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:07,432 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:31:09,287 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:31:09,289 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:31:10,292 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:31:10,294 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:10,297 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:31:10,299 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:31:10,305 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:31:10,308 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:31:10,311 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:31:10,312 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:31:10,313 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:31:10,315 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:31:10,315 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:31:10,317 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:31:10,319 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:31:10,320 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:31:10,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:12,228 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:31:12,230 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:31:12,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:14,075 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:31:14,076 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:31:14,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:31:14,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:31:14,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:24,084 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:31:24,085 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:26,023 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:31:26,025 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:31:26,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:27,134 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:31:27,259 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:32,786 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:36,771 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:31:36,772 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:31:36,773 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:31:37,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:31:37,251 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:31:37,252 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:31:38,665 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:31:44,891 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:31:45,281 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:31:45,655 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:31:46,570 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:31:46,571 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:31:49,561 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:31:49,562 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:31:50,216 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:31:50,223 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:31:50,229 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:31:50,233 - ispa_next.main - DEBUG - 



2025-11-12 13:31:50,233 - ispa_next.main - DEBUG - starting with process 12 (HF-H 2227E) of 15
2025-11-12 13:31:50,236 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:31:51,083 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:31:51,974 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:31:51,975 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:31:53,421 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:31:53,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:32:24,232 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:32:26,289 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:32:31,408 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:37,385 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:32:37,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:37,458 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:32:37,637 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:32:37,639 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:32:37,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:37,758 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:32:40,799 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:32:40,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:41,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:32:43,710 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:32:43,810 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:32:43,903 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:32:43,978 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:32:48,162 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:32:49,166 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:32:49,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:49,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:03,130 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:33:06,404 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:33:06,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:06,469 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:33:06,471 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:33:06,503 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:33:07,689 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:33:08,789 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:33:09,001 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:33:10,426 - ispa_next.functions - DEBUG - Updated appointment (AA00044450) customer contact data.
2025-11-12 13:33:11,345 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:33:11,347 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:33:12,596 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:33:12,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:33:13,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:33:16,949 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:33:16,949 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:33:16,960 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:33:16,963 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:33:16,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:17,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:20,998 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 13:33:30,061 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:33:30,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:30,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:33:30,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:33:31,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:33:31,459 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:33:36,728 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:33:36,730 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:33:38,030 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:33:38,031 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:33:38,033 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:33:38,035 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:33:38,036 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:33:38,037 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:33:38,039 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:33:38,040 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:33:38,048 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:33:38,051 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:33:38,056 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:33:38,059 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:33:38,061 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:33:38,062 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:44,130 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:33:44,131 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:33:44,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:50,057 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:33:50,059 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:33:50,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:33:50,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:33:50,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:04,090 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:34:04,092 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:10,053 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:34:10,054 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:34:10,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:34:11,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:34:11,269 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:20,973 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:25,453 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:29,307 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:33,724 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:34:37,046 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:34:37,048 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:37,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:34:37,802 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:34:37,803 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:34:40,825 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:34:48,760 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:34:49,154 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:34:49,596 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:50,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:34:50,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:53,385 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:34:53,386 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:54,183 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:34:54,191 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:34:54,198 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:34:54,202 - ispa_next.main - DEBUG - 



2025-11-12 13:34:54,202 - ispa_next.main - DEBUG - starting with process 13 (HF-AV 404) of 15
2025-11-12 13:34:54,205 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:34:55,214 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:34:56,155 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:34:56,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:34:57,285 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:34:57,286 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:21,457 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:35:23,310 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:35:28,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:32,424 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:35:32,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:32,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:32,722 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 13:35:36,045 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:35:36,048 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:35:36,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:36,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:35:43,065 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:35:43,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:44,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:46,090 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:35:46,225 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:35:46,315 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:35:46,444 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:35:50,629 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:35:51,633 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:35:51,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:52,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:01,574 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:36:05,473 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:36:05,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:05,566 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:05,567 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:36:05,599 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:36:06,750 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:36:07,975 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:36:08,194 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:36:09,512 - ispa_next.functions - DEBUG - Updated appointment (AB00040183) customer contact data.
2025-11-12 13:36:10,437 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:36:10,438 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:36:11,205 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:36:11,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:36:12,067 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:36:15,666 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:15,666 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:36:15,668 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:36:15,671 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:36:15,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:16,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:19,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:20,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:20,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:20,779 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:20,780 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:36:24,373 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:36:24,374 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:36:25,347 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:36:25,349 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:36:25,351 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:36:25,353 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:36:25,368 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:36:25,369 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:36:25,371 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:36:25,371 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:36:25,372 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:36:25,374 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:36:25,375 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:36:25,376 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:36:25,378 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:36:25,380 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:36:25,380 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:29,385 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:36:29,387 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:36:29,392 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:33,342 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:36:33,344 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:36:33,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:36:34,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:36:34,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:43,095 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:36:43,097 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:47,305 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:36:47,307 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:36:47,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:36:48,398 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:36:48,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:56,506 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:01,658 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:05,275 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:10,787 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:16,332 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:37:16,334 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:37:16,335 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:16,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:37:16,875 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:37:16,876 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:37:18,253 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:37:26,151 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:37:26,528 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 13:37:26,981 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:27,947 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:37:27,948 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:31,153 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:37:31,154 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:32,009 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:37:32,017 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:37:32,024 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:37:32,028 - ispa_next.main - DEBUG - 



2025-11-12 13:37:32,028 - ispa_next.main - DEBUG - starting with process 14 (HF-GE 123) of 15
2025-11-12 13:37:32,031 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:37:33,193 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:37:34,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 624
2025-11-12 13:37:34,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 342
2025-11-12 13:37:35,892 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:37:35,894 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:38:00,727 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:38:02,621 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:38:07,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:11,874 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:38:11,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:11,946 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:12,102 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:38:12,104 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:38:12,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:12,178 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:15,234 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:15,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:16,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:18,497 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:38:18,608 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:38:18,719 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:38:18,810 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:38:23,003 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:38:24,007 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:38:24,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:24,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:35,262 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:38:35,263 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:38:39,095 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:38:39,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:39,179 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:39,180 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:38:39,222 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:38:40,448 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:38:41,662 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:38:41,851 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:38:43,144 - ispa_next.functions - DEBUG - Updated appointment (AF00021355) customer contact data.
2025-11-12 13:38:44,030 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:38:44,031 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:38:44,581 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:38:44,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:45,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:38:49,288 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:49,289 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:38:49,292 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:38:49,295 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:38:49,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:49,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:55,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:55,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:55,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:56,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:56,512 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:39:00,681 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:39:00,683 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:39:02,401 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:39:02,403 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:02,404 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:39:02,405 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:39:02,406 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:39:02,407 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:02,409 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:39:02,410 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:39:02,411 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:39:02,414 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:39:02,424 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:39:02,428 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:39:02,432 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:39:02,434 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:39:02,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:07,153 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:39:07,155 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:39:07,162 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:11,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:39:11,815 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:39:21,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:35,710 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:39:35,711 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:39:35,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:39:36,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:39:36,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:50,032 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:39:50,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:54,792 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:39:54,793 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:39:55,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:55,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:39:56,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:04,880 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:40:09,267 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:40:11,964 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:40:11,965 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:40:12,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:40:12,503 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:40:12,504 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:40:15,062 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:40:22,398 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:40:22,777 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:40:23,946 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:40:24,651 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 625
2025-11-12 13:40:24,653 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:40:27,437 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 343
2025-11-12 13:40:27,438 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:40:28,197 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:40:28,206 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:40:28,211 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
2025-11-12 13:40:28,215 - ispa_next.main - DEBUG - 



2025-11-12 13:40:28,215 - ispa_next.main - DEBUG - starting with process 15 (OS-BO 693) of 15
2025-11-12 13:40:28,218 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:40:29,271 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:40:30,444 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 625
2025-11-12 13:40:30,445 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 343
2025-11-12 13:40:31,974 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:40:31,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:41:00,278 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:41:02,268 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:41:07,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:15,982 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:41:15,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:16,063 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:16,288 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:41:16,290 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:41:16,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:16,401 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:19,685 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:19,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:20,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:22,858 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:41:22,987 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:41:23,091 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:41:23,166 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:41:25,312 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:41:26,317 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:41:26,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:26,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:40,862 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:41:45,328 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:41:45,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:45,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:45,423 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:41:45,467 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:41:45,584 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:41:46,753 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:41:46,977 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:41:48,694 - ispa_next.functions - DEBUG - Updated appointment (AB00040597) customer contact data.
2025-11-12 13:41:49,705 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:41:49,707 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:41:49,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:50,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:41:51,797 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:41:51,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:51,881 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:41:55,476 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:55,476 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:41:55,478 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:41:55,481 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:41:55,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:55,965 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:59,475 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:42:11,276 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:42:11,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:12,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:12,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:12,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:42:12,970 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:42:20,839 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:42:20,840 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:42:22,404 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:42:22,406 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:42:22,409 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 13:42:22,410 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 13:42:22,412 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:42:22,417 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:42:22,420 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:42:22,423 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:42:22,425 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:42:22,427 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:42:22,428 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:42:22,430 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:42:22,432 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:42:22,434 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:42:22,434 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:31,182 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:42:31,184 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:42:31,186 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:39,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:40,045 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:42:49,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:07,769 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:43:07,771 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:43:07,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:43:08,595 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:43:08,787 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:28,585 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:43:28,586 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:37,321 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:43:37,322 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:43:37,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:43:38,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:43:38,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:43:51,133 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:43:56,061 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:00,394 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:44:00,395 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:44:01,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:44:01,110 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:44:01,111 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:44:04,095 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:44:12,103 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:44:12,493 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 13:44:13,620 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:44:14,315 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 625
2025-11-12 13:44:14,317 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:44:17,095 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 342
2025-11-12 13:44:17,096 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:44:17,878 - ispa_next.appointments.models - DEBUG - Appointment Wiele Karin HF-WI 103E WBY8P610X07G92051 ohne Termin.
2025-11-12 13:44:17,886 - ispa_next.appointments.models - DEBUG - Appointment Bode GmbH & Co. KG HF-JB 770 WBSKW810300W23738 ohne Termin.
2025-11-12 13:44:17,894 - ispa_next.appointments.models - DEBUG - Appointment Klaus Fritz Ernst Lindemeier MI-KL 109 WBA7K310607K42045 ohne Termin.
