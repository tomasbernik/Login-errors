2025-11-12 11:07:36,839 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:07:36,846 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:07:45,482 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:07:56,820 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:08:12,428 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:08:36,375 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:08:55,307 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:08:58,070 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:08:59,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:08:59,106 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:09:01,706 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 94
2025-11-12 11:09:01,707 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:09:01,708 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:09:02,837 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:09:03,905 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:17,312 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:09:17,323 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:09:17,363 - ispa_next.appointments.models - DEBUG - Appointment Janecke Möbeltechnik GmbH LIP-L 179 E WBY21HH050CU09424 ohne Termin.
2025-11-12 11:09:17,370 - ispa_next.main - DEBUG - Found 9 out of 21 appointments to process (configured limit: 15).
2025-11-12 11:09:17,371 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-12 11:09:17,371 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 11:09:17,371 - ispa_next.main - DEBUG - All appointments: BS-UC 17, LIP-L 0921, HX PA 5010, LIP-L 738 E, Lip-qz 95 e, LIP FJ 389, LIP-CP 300, LIP-JB 17E, LIP-FB 273
2025-11-12 11:09:17,373 - ispa_next.main - DEBUG - 



2025-11-12 11:09:17,373 - ispa_next.main - DEBUG - starting with process 1 (BS-UC 17) of 9
2025-11-12 11:09:17,377 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:09:18,191 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:09:19,212 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:09:19,213 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 94
2025-11-12 11:09:20,688 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:09:20,689 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:09:45,870 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:09:55,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:55,200 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:55,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:09:56,611 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:09:56,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:56,680 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:09:56,837 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:09:56,840 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:09:56,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:09:56,975 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:07,234 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:07,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:08,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:10,393 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:10:10,518 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:10:13,795 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:10:13,863 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:10:13,864 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:10:22,158 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:10:23,164 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:10:23,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:23,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:35,194 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:10:42,784 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:10:42,786 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:10:42,856 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:10:42,857 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:10:42,923 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:10:44,206 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:10:44,426 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:10:47,242 - ispa_next.functions - DEBUG - Updated appointment (AA00044522) customer contact data.
2025-11-12 11:10:48,155 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:10:48,156 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:10:48,734 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:10:48,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:10:49,396 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:10:53,398 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 11:10:53,398 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:10:53,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:10:53,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:10:55,985 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:10:56,090 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:10:56,207 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:10:56,303 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:10:56,303 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:11:04,785 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:12:04,788 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:12:16,108 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:12:20,344 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:12:20,345 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:12:24,568 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:12:25,573 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:12:25,576 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:12:25,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:25,651 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:12:26,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:26,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:12:26,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:12:27,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:12:27,271 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:12:28,580 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:12:28,582 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:12:29,547 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:12:29,548 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:29,550 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:12:29,551 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:12:29,552 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:12:29,553 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:12:29,555 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:12:29,557 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:12:29,558 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:12:29,567 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:12:29,573 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:12:29,581 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:12:29,585 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:12:29,588 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:12:29,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:30,828 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:12:30,829 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:12:30,831 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:32,074 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:12:32,075 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:12:32,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:12:32,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:12:32,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:37,781 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:12:37,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:39,041 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:12:39,043 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:12:39,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:12:40,084 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:12:40,294 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:12:45,947 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:12:45,949 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:12:45,950 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:46,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:12:46,754 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:12:46,755 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:12:48,444 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:12:56,608 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 11:12:56,610 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:12:56,611 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:12:57,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:12:57,305 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:12:57,306 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:12:58,987 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 11:12:59,011 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:13:00,902 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:13:00,904 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:02,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:13:02,826 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:05,075 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:13:05,076 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:05,735 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:13:05,742 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:13:05,747 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:13:05,758 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:13:05,762 - ispa_next.main - DEBUG - 



2025-11-12 11:13:05,762 - ispa_next.main - DEBUG - starting with process 2 (LIP-L 0921) of 9
2025-11-12 11:13:05,765 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:06,683 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:07,457 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:13:07,459 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:13:08,483 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:08,484 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:44,548 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:13:44,622 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:13:44,625 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:45,011 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:13:45,012 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:46,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:13:46,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:13:47,468 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:13:47,474 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:13:47,480 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:13:47,485 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:13:47,488 - ispa_next.main - DEBUG - 



2025-11-12 11:13:47,488 - ispa_next.main - DEBUG - starting with process 3 (HX PA 5010) of 9
2025-11-12 11:13:47,490 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:13:48,307 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:13:49,245 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:13:49,247 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:13:50,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:13:50,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:22,747 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:14:22,756 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:14:22,760 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:23,265 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:14:23,279 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:25,832 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:14:25,833 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:14:26,671 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:14:26,678 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:14:26,684 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:14:26,690 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:14:26,695 - ispa_next.main - DEBUG - 



2025-11-12 11:14:26,695 - ispa_next.main - DEBUG - starting with process 4 (LIP-L 738 E) of 9
2025-11-12 11:14:26,699 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:14:27,963 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:14:29,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:14:29,135 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:14:30,456 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:14:30,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:00,818 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:15:00,827 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:15:00,829 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:01,204 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:15:01,205 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:03,166 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:15:03,167 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:03,882 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:15:03,889 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:15:03,898 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:15:03,904 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:15:03,914 - ispa_next.main - DEBUG - 



2025-11-12 11:15:03,914 - ispa_next.main - DEBUG - starting with process 5 (Lip-qz 95 e) of 9
2025-11-12 11:15:03,918 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:04,793 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:06,040 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:15:06,042 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:15:07,912 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:07,919 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:38,261 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:15:38,271 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:15:38,275 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:38,722 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:15:38,723 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:40,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:15:40,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:15:41,712 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:15:41,723 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:15:41,731 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:15:41,738 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:15:41,743 - ispa_next.main - DEBUG - 



2025-11-12 11:15:41,743 - ispa_next.main - DEBUG - starting with process 6 (LIP FJ 389) of 9
2025-11-12 11:15:41,746 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:15:42,867 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:44,137 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:15:44,138 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:15:45,429 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:15:45,431 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:18,047 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:16:18,054 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 11:16:18,057 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:18,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:16:18,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:20,377 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:16:20,378 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:21,089 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:16:21,095 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:16:21,102 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:16:21,143 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:16:21,147 - ispa_next.main - DEBUG - 



2025-11-12 11:16:21,147 - ispa_next.main - DEBUG - starting with process 7 (LIP-CP 300) of 9
2025-11-12 11:16:21,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:22,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:23,635 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 500
2025-11-12 11:16:23,636 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:16:25,066 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:25,067 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:49,011 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:16:50,736 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:16:55,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:57,374 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:16:57,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:57,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:57,615 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:16:57,617 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:16:57,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:57,682 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:00,598 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:00,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:01,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:03,606 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:17:03,725 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:17:03,852 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:17:03,949 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:17:08,127 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:17:09,133 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:17:09,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:09,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:22,162 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:17:25,798 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:17:25,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:25,863 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:25,863 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:17:25,899 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:17:27,108 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:17:27,339 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:17:28,601 - ispa_next.functions - DEBUG - Updated appointment (AB00040557) customer contact data.
2025-11-12 11:17:29,515 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:17:29,516 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:17:30,213 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:17:30,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:17:30,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:17:34,557 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:34,558 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:17:34,561 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:17:34,563 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:17:34,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:35,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:40,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:41,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:41,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:41,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:41,932 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:17:43,779 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:17:43,782 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:17:44,600 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:17:44,601 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:44,603 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:17:44,603 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:17:44,604 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:17:44,605 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:44,607 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:17:44,608 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:17:44,609 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:17:44,610 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:17:44,611 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:17:44,613 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:17:44,615 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:17:44,616 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:17:44,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:46,487 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:17:46,488 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:17:46,489 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:48,330 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:17:48,332 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:17:48,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:17:49,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:17:49,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:17:59,949 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:17:59,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:01,877 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:01,882 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:02,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:02,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:03,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:08,072 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:13,776 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:13,778 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:13,778 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:14,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:14,413 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:14,414 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:16,215 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:18:23,098 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:18:23,482 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 11:18:23,832 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:24,706 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:18:24,708 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:27,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 171
2025-11-12 11:18:27,801 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:28,694 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:18:28,704 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:18:28,712 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:18:28,720 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:18:28,724 - ispa_next.main - DEBUG - Found new Appointment: LIP-JC 288
2025-11-12 11:18:28,726 - ispa_next.main - DEBUG - 



2025-11-12 11:18:28,726 - ispa_next.main - DEBUG - starting with process 8 (LIP-JC 288) of 10
2025-11-12 11:18:28,730 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:29,584 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:18:30,320 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:18:30,321 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-12 11:18:31,349 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:18:31,350 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:18:51,792 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:00,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:00,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:00,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:01,891 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:01,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:01,978 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:02,163 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:02,166 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:02,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:02,242 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:12,554 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:12,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:13,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:19:15,772 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:19:15,917 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:19:19,140 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:19:26,695 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 11:19:27,703 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:19:27,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:28,229 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:40,021 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:19:40,022 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 11:19:46,982 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:19:46,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:47,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:47,051 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:19:47,131 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:19:47,224 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:19:48,428 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:19:48,643 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:19:51,931 - ispa_next.functions - DEBUG - Updated appointment (AA00044524) customer contact data.
2025-11-12 11:19:52,858 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:19:52,860 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:19:52,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:53,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:19:55,326 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:19:55,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:19:55,410 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 11:19:58,994 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:19:58,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:19:59,504 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:01,520 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:20:01,635 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:20:01,750 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:20:01,841 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:20:01,842 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:20:10,138 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:21:10,139 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:21:18,470 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:21:52,474 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:22:03,188 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 11:22:07,330 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 11:22:07,330 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:22:11,736 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 11:22:12,743 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:22:12,747 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:22:12,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:12,812 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:13,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:13,721 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:22:13,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:14,384 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:22:14,384 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:22:16,260 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:22:16,262 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:22:17,437 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:22:17,439 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:17,441 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:22:17,443 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:22:17,444 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:22:17,445 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:22:17,447 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:22:17,448 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:22:17,449 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:22:17,451 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:22:17,452 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:22:17,454 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:22:17,456 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:22:17,458 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:22:17,458 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:19,336 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:22:19,338 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:22:19,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:21,257 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:22:21,258 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:22:21,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:22:22,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:22:22,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:31,610 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:22:31,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:33,529 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:22:33,531 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:22:34,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:34,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:22:34,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:22:40,383 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:44,086 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:22:44,087 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:22:44,087 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:44,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:22:44,588 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:22:44,589 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:22:46,007 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:22:52,695 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:22:53,104 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 11:22:53,390 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:54,131 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:22:54,132 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:22:56,619 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 171
2025-11-12 11:22:56,620 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:22:57,279 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:22:57,289 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:22:57,296 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:22:57,301 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:22:57,309 - ispa_next.main - DEBUG - 



2025-11-12 11:22:57,309 - ispa_next.main - DEBUG - starting with process 9 (LIP-JB 17E) of 10
2025-11-12 11:22:57,319 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:22:58,179 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:22:58,976 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:22:58,977 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 171
2025-11-12 11:23:00,174 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:00,175 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:29,531 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:23:31,030 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:23:35,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:39,351 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:23:39,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:39,424 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:39,638 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:23:39,641 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:23:39,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:39,756 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:23:42,754 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:23:42,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:23:43,748 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:23:45,753 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:23:45,864 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:23:45,968 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:23:46,036 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:23:50,204 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:23:51,210 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:23:51,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:23:51,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:02,975 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:24:06,947 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:24:06,949 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:07,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:24:07,034 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:24:07,076 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:24:08,325 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:24:09,521 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:24:09,737 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:24:11,006 - ispa_next.functions - DEBUG - Updated appointment (AB00040543) customer contact data.
2025-11-12 11:24:11,918 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:24:11,920 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:24:12,721 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:24:12,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:24:13,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:24:17,054 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:24:17,054 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:24:17,056 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:24:17,059 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:24:17,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:17,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:23,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:23,638 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:24:23,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:24:24,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:24:24,342 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:24:27,976 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:24:27,979 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:24:28,990 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:24:28,991 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:28,995 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:24:28,997 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:24:29,000 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:24:29,002 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:24:29,004 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:24:29,006 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:24:29,007 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:24:29,009 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:24:29,010 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:24:29,012 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:24:29,014 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:24:29,016 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:24:29,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:33,000 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 11:24:34,849 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:24:34,850 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:24:34,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:38,780 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:24:38,781 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:24:38,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:24:39,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:24:39,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:50,844 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:24:50,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:24:54,815 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:24:54,816 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:24:55,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:24:55,873 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:24:56,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:03,817 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:07,208 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:11,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:16,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:20,622 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:25:20,624 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:25:20,625 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:21,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:25:21,348 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:25:21,349 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:25:23,102 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:25:30,861 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:25:31,260 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 11:25:31,637 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:32,619 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:25:32,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:35,626 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 170
2025-11-12 11:25:35,627 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:36,454 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:25:36,461 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:25:36,469 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:25:36,478 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
2025-11-12 11:25:36,484 - ispa_next.main - DEBUG - 



2025-11-12 11:25:36,484 - ispa_next.main - DEBUG - starting with process 10 (LIP-FB 273) of 10
2025-11-12 11:25:36,488 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:37,792 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:39,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:25:39,020 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 170
2025-11-12 11:25:40,425 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:40,427 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:26:09,800 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:26:11,969 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:26:17,116 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:20,364 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:26:20,365 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:20,435 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:20,780 - ispa_next.functions - DEBUG - HU date already expired after 3 days.
2025-11-12 11:26:24,767 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:26:24,770 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:26:24,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:24,860 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:28,169 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:26:28,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:29,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:31,394 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:26:31,531 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:26:31,639 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:26:31,719 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:26:35,921 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:26:36,925 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:26:36,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:37,443 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:49,962 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:26:53,146 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:26:53,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:53,220 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:53,221 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:26:53,255 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:26:54,447 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:26:54,696 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:26:55,983 - ispa_next.functions - DEBUG - Updated appointment (AF00021399) customer contact data.
2025-11-12 11:26:57,049 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:26:57,050 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:26:57,581 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:26:57,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:26:58,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:27:01,771 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:27:01,771 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:27:01,773 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:27:01,775 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:27:01,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:02,259 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:11,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:11,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:27:11,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:27:12,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:27:12,546 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:27:15,618 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:27:15,621 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:27:16,936 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:27:16,937 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:27:16,939 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 11:27:16,940 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 11:27:16,942 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:27:16,943 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:27:16,945 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:27:16,946 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:27:16,947 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:27:16,948 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:27:16,950 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:27:16,952 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:27:16,955 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:27:16,956 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:27:16,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:20,233 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:27:20,235 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:27:20,236 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:23,460 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:27:23,461 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:27:23,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:27:24,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:27:24,569 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:38,855 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:27:38,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:42,154 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:27:42,156 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:27:42,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:43,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:43,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:50,407 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:53,463 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:57,616 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:02,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:28:02,700 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:28:02,701 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:28:03,318 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:28:03,403 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:28:03,404 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:28:05,327 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:28:12,505 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:28:12,883 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 11:28:13,260 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:28:14,033 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 501
2025-11-12 11:28:14,034 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:28:16,447 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 169
2025-11-12 11:28:16,448 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:28:17,119 - ispa_next.appointments.models - DEBUG - Appointment Michael Tylla HOL-MT 1 WBS31BA010CM52504 ohne Termin.
2025-11-12 11:28:17,125 - ispa_next.appointments.models - DEBUG - Appointment Gebr. Brasseler GmbH & Co. KG LIP-YN 78 E WBA61DP0709J81353 ohne Termin.
2025-11-12 11:28:17,130 - ispa_next.appointments.models - DEBUG - Appointment Viktor Bachmann LIP-FE 222 WBATX350X0NC16492 ohne Termin.
2025-11-12 11:28:17,136 - ispa_next.appointments.models - DEBUG - Appointment Ferhat Birincioglu LIP-EF 128 WBAVJ11010LF59174 ohne Termin.
