2025-11-12 10:07:33,048 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:07:33,054 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:07:40,729 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:07:51,147 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:08:06,707 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:10:04,249 - ispa_next.app_start.main - DEBUG - Operation already took 106.20 seconds (more than 80 seconds)
2025-11-12 10:10:06,330 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\d3879237cc1c4730\\tess_1ozsj3r3_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\d3879237cc1c4730\\tess_1ozsj3r3', 'txt']
2025-11-12 10:10:06,577 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 10:10:06,583 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 10:10:06,585 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:10:31,687 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:10:42,964 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:10:45,626 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:46,536 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1425
2025-11-12 10:10:46,537 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 10
2025-11-12 10:10:48,462 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 10
2025-11-12 10:10:48,463 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:10:48,463 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:10:49,208 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:10:49,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:50,713 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,714 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,714 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,714 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,714 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,715 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,715 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:50,718 - ispa_next.main - DEBUG - Found 3 out of 3 appointments to process (configured limit: 15).
2025-11-12 10:10:50,718 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 10:10:50,718 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 10:10:50,718 - ispa_next.main - DEBUG - All appointments: 0, F-X 9991E, RÜD-WP 71E
2025-11-12 10:10:50,722 - ispa_next.main - DEBUG - 



2025-11-12 10:10:50,723 - ispa_next.main - DEBUG - starting with process 1 (0) of 3
2025-11-12 10:10:50,726 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:51,645 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:52,359 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1425
2025-11-12 10:10:52,360 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 10
2025-11-12 10:10:53,536 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:53,537 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:27,131 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:11:27,211 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:11:27,214 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:27,609 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1425
2025-11-12 10:11:27,611 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:29,174 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 10
2025-11-12 10:11:29,175 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:29,785 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,785 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,786 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,786 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,786 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,786 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,786 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:11:29,789 - ispa_next.main - DEBUG - 



2025-11-12 10:11:29,789 - ispa_next.main - DEBUG - starting with process 2 (F-X 9991E) of 3
2025-11-12 10:11:29,811 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:30,625 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:31,462 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1425
2025-11-12 10:11:31,463 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 10
2025-11-12 10:11:32,908 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:32,909 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:56,239 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:12:06,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:09,032 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:12:09,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:09,095 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:09,275 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:12:09,277 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:12:11,991 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:11,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:13,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:15,024 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:15,112 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:15,203 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:15,261 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:12:19,437 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:12:20,441 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:12:20,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:21,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:32,338 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:12:38,845 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:12:38,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:38,912 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:38,912 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:12:38,948 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:12:40,209 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:12:40,529 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:12:46,161 - ispa_next.functions - DEBUG - Updated appointment (AK00021337) customer contact data.
2025-11-12 10:12:47,085 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:12:47,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:47,179 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:49,211 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:12:50,086 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:12:50,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:12:50,766 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:12:54,346 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:54,346 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:12:54,349 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:12:54,349 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:12:54,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:54,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:58,935 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:12:58,938 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:12:58,938 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:59,045 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:13:08,492 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 10:13:14,928 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:13:14,931 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:15,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:15,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:16,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:16,376 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:13:18,827 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:13:18,829 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:13:19,878 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:13:19,880 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:19,885 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:13:19,888 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:13:19,889 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:19,892 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:13:19,893 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=advice_list), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=advice_list)}
2025-11-12 10:13:19,895 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:13:19,896 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:13:19,897 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:13:19,899 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:13:19,901 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:13:20,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:13:21,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:13:33,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:13:34,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:13:47,181 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:13:47,183 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 10:14:29,720 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:14:29,720 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 10:14:35,611 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:14:35,612 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:14:35,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:39,657 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:14:39,658 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:14:39,662 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:43,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:14:44,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:14:55,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:09,505 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:15:09,507 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:15:09,508 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:15:09,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:13,499 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:15:27,628 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:15:28,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:15:29,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:15:29,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:57,452 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:15:57,454 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:15:58,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:15:58,700 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:15:58,702 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:16:03,691 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:16:14,359 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:16:14,739 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:16:16,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:17,162 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1426
2025-11-12 10:16:17,164 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:19,436 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 11
2025-11-12 10:16:19,437 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:20,280 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:20,281 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:20,281 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:20,282 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:20,282 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:20,282 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:16:20,284 - ispa_next.main - DEBUG - Found new Appointment: WI-PC 173
2025-11-12 10:16:20,286 - ispa_next.main - DEBUG - 



2025-11-12 10:16:20,286 - ispa_next.main - DEBUG - starting with process 3 (WI-PC 173) of 4
2025-11-12 10:16:20,289 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:21,264 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:22,117 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1426
2025-11-12 10:16:22,118 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 11
2025-11-12 10:16:23,313 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:23,313 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:44,441 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:16:55,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:56,075 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:56,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:57,470 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:16:57,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:57,547 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:57,749 - ispa_next.functions - DEBUG - HU date soon to be invalid in 47 days.
2025-11-12 10:17:05,036 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:17:05,038 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:17:07,862 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:07,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:08,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:10,864 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:17:10,986 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:17:14,228 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:17:14,294 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:17:14,295 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:15,509 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:17:23,918 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:17:24,920 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:17:24,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:25,431 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:38,904 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:17:45,491 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:17:45,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:45,558 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:45,560 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:17:45,621 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:17:45,714 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:17:46,903 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:17:47,210 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:17:52,908 - ispa_next.functions - DEBUG - Updated appointment (AK00021344) customer contact data.
2025-11-12 10:17:53,803 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:17:53,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:53,902 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:54,083 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:17:54,085 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:17:54,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:17:55,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:17:56,522 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:17:56,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:17:56,615 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:18:00,219 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:00,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:00,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:02,817 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:18:02,924 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:18:03,061 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:18:03,156 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:18:03,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:04,461 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:18:12,813 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:19:12,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:19:24,199 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:19:28,453 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:19:28,453 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:29,746 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:19:34,055 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:19:35,060 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:19:35,060 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:19:35,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:35,149 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:19:39,278 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:19:39,281 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:19:39,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:39,386 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:19:43,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:44,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:44,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:44,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:44,853 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:19:46,148 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:19:46,150 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:19:47,475 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:19:47,477 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:47,477 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:19:47,479 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:19:47,481 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:47,483 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:19:47,485 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:19:47,485 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:19:47,486 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:19:47,488 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:19:47,490 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:19:47,492 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:19:48,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:19:48,838 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:20:00,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:20:01,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:20:14,484 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:20:14,486 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:20:14,486 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:20:14,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:17,055 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:20:19,726 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:20:19,742 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:20:19,801 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:22,467 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:20:22,468 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:20:22,469 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:20:22,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:25,038 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:20:37,674 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:20:38,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:39,020 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:20:39,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:03,600 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:07,778 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:12,615 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:12,617 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:21:12,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:13,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:21:13,506 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:21:13,507 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:21:15,669 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:21:22,948 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 10:21:22,948 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:21:22,950 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:23,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:21:23,481 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:21:23,483 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:21:25,696 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 10:21:25,714 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:21:27,969 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:21:27,971 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:29,671 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1427
2025-11-12 10:21:29,673 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:31,830 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 12
2025-11-12 10:21:31,831 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:32,756 - ispa_next.appointments.models - DEBUG - Appointment Andreas Rütz MZ-TE 27 WBA71AA0X05V32839 ohne Termin.
2025-11-12 10:21:32,759 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:32,760 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:32,760 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:32,761 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:32,761 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:21:32,766 - ispa_next.main - DEBUG - 



2025-11-12 10:21:32,766 - ispa_next.main - DEBUG - starting with process 4 (RÜD-WP 71E) of 4
2025-11-12 10:21:32,769 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:33,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:34,621 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1427
2025-11-12 10:21:34,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 12
2025-11-12 10:21:36,223 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:36,224 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:57,705 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:22:08,230 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:08,303 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:08,537 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:10,523 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:22:10,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:10,607 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:10,776 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:22:10,778 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:22:13,774 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:13,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:14,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:16,709 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:22:16,829 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:22:20,049 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:22:20,114 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:22:20,115 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:22,112 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:22:30,443 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:22:31,447 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:22:31,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:31,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:43,341 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:22:50,298 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:22:50,302 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:50,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:50,396 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:22:50,493 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:22:51,707 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:22:52,933 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:22:53,165 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:22:58,807 - ispa_next.functions - DEBUG - Updated appointment (AK00021341) customer contact data.
2025-11-12 10:22:59,738 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:22:59,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:59,823 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:02,109 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:23:03,055 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:23:03,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:23:03,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:23:07,309 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:07,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:07,783 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:09,790 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:23:09,930 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:23:10,024 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:23:10,121 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:23:10,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:12,064 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:23:20,391 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:24:20,404 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:24:28,502 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:24:58,504 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:25:06,871 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 10:25:14,260 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 10:25:15,264 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:25:15,264 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:25:15,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:15,352 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:25:19,489 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:25:19,491 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:25:19,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:19,604 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:25:29,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:29,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:29,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:30,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:30,309 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:25:32,230 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:25:32,232 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:25:33,247 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:25:33,251 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:25:33,255 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:25:33,257 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:25:33,257 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:25:33,259 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:25:33,261 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:25:33,262 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:25:33,264 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:25:33,265 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:25:33,267 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:25:33,268 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:25:33,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:25:34,613 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:25:46,702 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:25:47,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:26:00,584 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:26:00,586 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:26:00,586 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:26:00,588 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:03,888 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:26:09,180 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:26:09,182 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:26:09,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:12,763 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:26:12,765 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:26:12,767 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:26:12,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:16,047 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:26:29,729 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:26:30,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:26:30,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:26:31,129 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:04,736 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:08,450 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:12,659 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:17,334 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:17,336 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:27:17,339 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:18,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:27:18,181 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:27:18,181 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:27:20,190 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:27:28,408 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:27:28,795 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:27:30,233 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:30,880 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1429
2025-11-12 10:27:30,882 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:33,434 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 14
2025-11-12 10:27:33,435 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:27:34,098 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 10:27:34,101 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:27:34,101 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:27:34,101 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:27:34,104 - ispa_next.main - DEBUG - Found new Appointment: WI-AF169
2025-11-12 10:27:34,104 - ispa_next.main - DEBUG - Found new Appointment: MZ-TE 27
2025-11-12 10:27:34,106 - ispa_next.main - DEBUG - 



2025-11-12 10:27:34,106 - ispa_next.main - DEBUG - starting with process 5 (WI-AF169) of 6
2025-11-12 10:27:34,110 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:34,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:27:35,713 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1429
2025-11-12 10:27:35,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 14
2025-11-12 10:27:37,008 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:27:37,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:07,953 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:28:07,969 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:28:07,972 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:08,512 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1429
2025-11-12 10:28:08,514 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:10,798 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 14
2025-11-12 10:28:10,799 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:11,677 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 10:28:11,681 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:28:11,681 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:28:11,682 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:28:11,685 - ispa_next.main - DEBUG - 



2025-11-12 10:28:11,685 - ispa_next.main - DEBUG - starting with process 6 (MZ-TE 27) of 6
2025-11-12 10:28:11,688 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:12,697 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:13,467 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1429
2025-11-12 10:28:13,469 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 14
2025-11-12 10:28:14,989 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:14,990 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:39,511 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:28:50,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:51,881 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:28:51,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:28:51,959 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:28:52,326 - ispa_next.functions - DEBUG - HU date already expired after 14 days.
2025-11-12 10:28:59,824 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:28:59,826 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:29:02,662 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:02,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:03,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:05,728 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:29:05,866 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:29:05,952 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:29:06,024 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:29:10,212 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:29:11,217 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:29:11,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:11,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:23,674 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:29:31,278 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:29:31,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:31,400 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:31,400 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:29:31,430 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:29:32,733 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:29:32,956 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:29:38,614 - ispa_next.functions - DEBUG - Updated appointment (AK00021346) customer contact data.
2025-11-12 10:29:39,515 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:29:39,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:39,697 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:39,966 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 10:29:39,970 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:29:40,857 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:29:40,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:29:41,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:29:45,181 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:45,181 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:29:45,183 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:29:45,184 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:29:45,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:45,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:49,812 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:29:49,818 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:29:49,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:49,901 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:29:59,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:59,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:59,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:00,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:00,591 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:30:01,852 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:30:01,853 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:30:02,663 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:30:02,665 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:02,667 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 10:30:02,667 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGAUßENWÄSCHE BASIS, source=from_tab, target=cart), Package(name=Kostenloser Scheibencheck, source=from_tab, target=cart)}
2025-11-12 10:30:02,670 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:02,671 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:30:02,673 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:30:02,673 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:30:02,675 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:30:02,677 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:30:02,679 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:30:02,680 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:30:03,362 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:30:04,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:30:16,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:30:16,810 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:30:29,372 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:30:29,382 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:30:29,384 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:30:29,384 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:31,952 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:30:31,952 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:30:31,954 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:34,445 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:30:34,446 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:30:34,447 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:30:34,449 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:37,011 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:30:49,952 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:30:50,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:30:51,189 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:30:51,317 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:16,315 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:20,982 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:25,735 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:25,737 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:31:25,738 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:26,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:26,492 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:31:26,493 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:31:28,667 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:31:37,707 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:31:38,105 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:31:39,544 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:40,313 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1429
2025-11-12 10:31:40,315 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:42,464 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 14
2025-11-12 10:31:42,465 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:43,182 - ispa_next.appointments.models - DEBUG - Appointment Murat Cinardere MZ-SC 681 WBAJC31060WA79912 ohne Termin.
2025-11-12 10:31:43,185 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:31:43,185 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:31:43,185 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
