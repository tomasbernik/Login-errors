2025-11-12 09:28:35,279 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:28:35,286 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:28:44,694 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:28:55,221 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:29:10,929 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:29:43,138 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:29:54,941 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:29:57,704 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:29:58,662 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:29:58,664 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 09:30:00,318 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 9
2025-11-12 09:30:00,319 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:30:00,319 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:30:01,064 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:30:01,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:02,433 - ispa_next.appointments.models - DEBUG - Appointment DieterJoseph Knoll M-K 3825 WBAFR71050C542925 ohne Termin.
2025-11-12 09:30:02,441 - ispa_next.appointments.models - DEBUG - Appointment Peter Burkhard Pankraz M-P 2175 WBAJG510503F97706 ohne Termin.
2025-11-12 09:30:02,446 - ispa_next.appointments.models - DEBUG - Appointment Johanna Fink M-M 5797 WMWMR91010T636951 ohne Termin.
2025-11-12 09:30:02,450 - ispa_next.main - DEBUG - Found 3 out of 6 appointments to process (configured limit: 15).
2025-11-12 09:30:02,450 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 09:30:02,450 - ispa_next.main - DEBUG - Processing 0 already visited appointments (w/ RKR not callable).
2025-11-12 09:30:02,451 - ispa_next.main - DEBUG - All appointments: M-W 3719, M-Z 5644, M-R 8095E
2025-11-12 09:30:02,452 - ispa_next.main - DEBUG - 



2025-11-12 09:30:02,453 - ispa_next.main - DEBUG - starting with process 1 (M-W 3719) of 3
2025-11-12 09:30:02,457 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:30:03,191 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:30:03,929 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:30:03,931 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 9
2025-11-12 09:30:05,151 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:30:05,152 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:30:31,406 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:30:40,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:42,007 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:30:42,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:42,104 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:30:42,290 - ispa_next.functions - DEBUG - HU date already expired after 623 days.
2025-11-12 09:30:49,172 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:30:49,174 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:30:49,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:49,237 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:30:58,807 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:30:58,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:59,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:01,630 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:31:01,757 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:31:04,962 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:31:05,052 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:31:09,207 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:31:10,212 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:31:10,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:10,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:21,861 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:31:28,706 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:31:28,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:28,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:31:28,787 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:31:28,830 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:31:28,931 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:31:29,991 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:31:30,281 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:31:34,060 - ispa_next.functions - DEBUG - Updated appointment (AJ00018127) customer contact data.
2025-11-12 09:31:34,982 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:31:34,984 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:31:35,105 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:31:35,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:31:36,952 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:31:36,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:31:37,036 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:31:40,619 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:31:40,619 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:31:40,621 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:31:40,622 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:31:40,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:41,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:45,206 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:31:45,210 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:31:45,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:45,302 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:31:45,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:46,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:31:46,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:31:46,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:31:46,853 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:31:48,117 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:31:48,119 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:31:49,477 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:31:49,479 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:31:49,481 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:31:49,482 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:31:49,483 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:31:49,484 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:31:49,485 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:31:49,485 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:31:49,485 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:31:49,488 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:31:49,488 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:31:49,490 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:31:49,496 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:31:49,498 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:31:49,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:50,717 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:31:50,719 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:31:50,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:51,918 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:31:51,920 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:31:51,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:53,139 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:31:53,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:31:54,002 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:31:54,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:02,694 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:32:02,696 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:03,914 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:32:15,001 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:32:15,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:32:15,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:32:16,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:32:28,073 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:32:28,075 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:32:28,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:28,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:32:28,752 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:32:28,752 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:32:30,307 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:32:38,684 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:32:39,075 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:32:39,348 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:40,255 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:32:40,258 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:42,254 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 09:32:42,255 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:42,825 - ispa_next.appointments.models - DEBUG - Appointment Robert Westermeier M-I 468 WBA5L31040G490749 ohne Termin.
2025-11-12 09:32:42,830 - ispa_next.appointments.models - DEBUG - Appointment DieterJoseph Knoll M-K 3825 WBAFR71050C542925 ohne Termin.
2025-11-12 09:32:42,839 - ispa_next.appointments.models - DEBUG - Appointment Peter Burkhard Pankraz M-P 2175 WBAJG510503F97706 ohne Termin.
2025-11-12 09:32:42,844 - ispa_next.main - DEBUG - 



2025-11-12 09:32:42,844 - ispa_next.main - DEBUG - starting with process 2 (M-Z 5644) of 3
2025-11-12 09:32:42,846 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:43,560 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:44,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:32:44,300 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 09:32:45,360 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:45,361 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:04,374 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:33:12,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:15,244 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:33:15,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:15,338 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:15,519 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:33:15,521 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:33:15,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:15,595 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:24,894 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:33:24,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:33:25,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:33:27,793 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:33:27,910 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:33:28,033 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:33:28,105 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:33:30,206 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:33:31,209 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:33:31,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:31,697 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:42,486 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:33:49,604 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:33:49,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:49,708 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:49,709 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:33:49,754 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:33:49,901 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:33:51,023 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:33:52,170 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:33:52,480 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:33:55,807 - ispa_next.functions - DEBUG - Updated appointment (AJ00018126) customer contact data.
2025-11-12 09:33:56,702 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:33:56,704 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:33:56,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:33:57,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:33:58,887 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:33:58,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:33:58,971 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:34:02,555 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:34:02,555 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:34:02,558 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:34:02,559 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:34:02,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:03,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:07,141 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:34:07,635 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:34:18,470 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:34:18,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:18,590 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:34:18,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:19,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:19,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:20,318 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:20,318 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:34:22,783 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:34:22,785 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:34:24,312 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:34:24,314 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:34:24,316 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:34:24,318 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:34:24,318 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:34:24,320 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:34:24,322 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:34:24,322 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:34:24,324 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:34:24,324 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:34:24,326 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:34:24,328 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:34:24,328 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:34:24,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:26,940 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:34:26,942 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:34:26,944 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:29,522 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:34:29,522 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:34:29,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:32,143 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:32,242 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:34:37,800 - ispa_next.functions - DEBUG - added beide Bremsscheiben hinten to advice_list
2025-11-12 09:34:41,695 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:34:41,695 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:34:43,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:34:43,189 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:34:43,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:34:45,819 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:34:58,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:34:59,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:34:59,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:34:59,865 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:24,760 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:35:31,112 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:35:38,337 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:35:38,339 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:35:38,341 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:35:39,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:35:39,108 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:35:39,109 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:35:41,013 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:35:51,064 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:35:51,448 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:35:52,605 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:35:53,442 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:35:53,445 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:35:56,619 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 09:35:56,620 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:35:57,757 - ispa_next.appointments.models - DEBUG - Appointment Robert Westermeier M-I 468 WBA5L31040G490749 ohne Termin.
2025-11-12 09:35:57,763 - ispa_next.appointments.models - DEBUG - Appointment DieterJoseph Knoll M-K 3825 WBAFR71050C542925 ohne Termin.
2025-11-12 09:35:57,772 - ispa_next.appointments.models - DEBUG - Appointment Peter Burkhard Pankraz M-P 2175 WBAJG510503F97706 ohne Termin.
2025-11-12 09:35:57,777 - ispa_next.main - DEBUG - 



2025-11-12 09:35:57,777 - ispa_next.main - DEBUG - starting with process 3 (M-R 8095E) of 3
2025-11-12 09:35:57,780 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:35:59,195 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:00,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:36:00,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 16
2025-11-12 09:36:02,443 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:02,444 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:36:36,420 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:36:48,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:48,848 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:36:49,063 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:50,285 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:36:50,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:50,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:36:50,616 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:36:50,619 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:36:50,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:50,735 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:36:54,003 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:36:54,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:55,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:57,407 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:36:57,615 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:37:00,919 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:37:01,009 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:37:01,009 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:37:09,889 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:37:10,894 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:37:10,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:11,492 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:24,350 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:37:24,350 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:37:33,273 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:37:33,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:33,365 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:33,365 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:37:33,428 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:37:34,795 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:37:36,005 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:37:36,282 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:37:40,618 - ispa_next.functions - DEBUG - Updated appointment (AJ00018113) customer contact data.
2025-11-12 09:37:41,543 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:37:41,545 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:37:42,669 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:37:42,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:37:43,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:37:47,210 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:37:47,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:47,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:37:49,722 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:37:49,854 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:37:49,978 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:37:50,110 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:37:50,111 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:38:02,086 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:38:06,788 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:38:06,788 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:38:10,953 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:38:11,959 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:38:11,960 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:38:11,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:12,108 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:38:16,233 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:38:16,237 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:38:16,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:16,330 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:38:25,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:25,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:25,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:26,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:26,598 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:38:27,928 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:38:27,933 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:38:29,177 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:38:29,178 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:29,180 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:38:29,182 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:38:29,183 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:38:29,187 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:29,189 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:38:29,191 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:38:29,193 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:38:29,193 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:38:29,195 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:38:29,197 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:38:29,198 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:38:29,198 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:38:29,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:30,418 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:38:30,420 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:38:30,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:31,677 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:38:31,677 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:38:31,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:32,916 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:38:32,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:38:33,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:38:34,088 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:47,216 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:38:47,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:48,500 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:39:02,722 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:39:03,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:03,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:39:04,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:17,338 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:17,340 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:39:17,340 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:18,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:18,331 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:39:18,332 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:39:20,505 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:39:30,387 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:39:30,760 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:39:31,150 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:32,624 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 864
2025-11-12 09:39:32,624 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:35,492 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 16
2025-11-12 09:39:35,493 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:36,401 - ispa_next.appointments.models - DEBUG - Appointment Robert Westermeier M-I 468 WBA5L31040G490749 ohne Termin.
2025-11-12 09:39:36,406 - ispa_next.appointments.models - DEBUG - Appointment DieterJoseph Knoll M-K 3825 WBAFR71050C542925 ohne Termin.
2025-11-12 09:39:36,413 - ispa_next.appointments.models - DEBUG - Appointment Peter Burkhard Pankraz M-P 2175 WBAJG510503F97706 ohne Termin.
