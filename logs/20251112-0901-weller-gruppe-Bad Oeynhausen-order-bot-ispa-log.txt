2025-11-12 09:08:24,953 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:08:24,960 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:08:37,743 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:08:48,895 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:09:04,858 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:09:39,600 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:10:00,306 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:10:03,639 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:05,472 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:10:05,473 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 09:10:08,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 70
2025-11-12 09:10:08,947 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:10:08,948 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:10:10,628 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:10:12,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:10:24,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:10:24,630 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:10:24,660 - ispa_next.main - DEBUG - Found 7 out of 9 appointments to process (configured limit: 15).
2025-11-12 09:10:24,661 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 09:10:24,662 - ispa_next.main - DEBUG - Processing 3 already visited appointments (w/ RKR not callable).
2025-11-12 09:10:24,662 - ispa_next.main - DEBUG - All appointments: MI-EI 1212, MI-EI 121E, HF-KT 524, mi mp 200, GT-WK 7070, OS-MW 37, MI-JH356
2025-11-12 09:10:24,665 - ispa_next.main - DEBUG - 



2025-11-12 09:10:24,666 - ispa_next.main - DEBUG - starting with process 1 (MI-EI 1212) of 7
2025-11-12 09:10:24,671 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:10:26,214 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:10:27,782 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:10:27,783 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 70
2025-11-12 09:10:29,694 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:10:29,696 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:11:10,988 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:11:22,124 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:22,235 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:11:22,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:11:25,279 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:11:25,279 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:25,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:11:25,691 - ispa_next.functions - DEBUG - HU date already expired after 112 days.
2025-11-12 09:11:34,299 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:11:34,302 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:11:37,197 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:11:37,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:11:38,626 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:11:40,629 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:11:48,150 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-12 09:11:57,153 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-12 09:11:58,157 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:11:58,158 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:58,672 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:08,967 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:12:18,098 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:12:18,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:18,184 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:12:18,185 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:12:18,335 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:12:18,535 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:12:20,114 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:12:20,544 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:12:22,840 - ispa_next.functions - DEBUG - Updated appointment (AA00050550) customer contact data.
2025-11-12 09:12:23,754 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:12:23,755 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:12:23,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:12:24,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:12:26,516 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:12:26,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:12:26,758 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:12:31,156 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:12:31,156 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:12:31,156 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:12:31,160 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:12:31,161 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:12:31,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:31,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:35,798 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:12:35,802 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:12:35,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:35,925 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:12:36,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:36,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:36,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:37,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:37,593 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:12:40,854 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:12:40,862 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:12:41,957 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:12:41,960 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:12:41,963 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-12 09:12:41,966 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:12:41,971 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:12:41,974 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:12:41,976 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:12:41,978 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:12:41,980 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:12:41,982 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:12:41,984 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:12:42,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 09:12:43,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 09:12:50,160 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:12:50,162 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:12:50,163 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:12:50,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:54,329 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:12:54,331 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:12:54,334 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:58,368 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:12:58,368 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:12:58,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:02,339 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:13:02,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:13:02,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:13:02,950 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:13:02,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:07,078 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:13:20,160 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:13:20,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:13:21,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:13:21,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:01,069 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:06,151 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:11,215 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:16,331 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:22,052 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:22,054 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:14:22,055 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:14:22,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:14:22,981 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:14:22,982 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:14:25,574 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:14:38,620 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:14:39,002 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:14:40,580 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:14:41,486 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:14:41,487 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:14:45,528 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 09:14:45,529 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:14:46,732 - ispa_next.main - DEBUG - 



2025-11-12 09:14:46,732 - ispa_next.main - DEBUG - starting with process 2 (MI-EI 121E) of 7
2025-11-12 09:14:46,736 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:14:48,341 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:14:50,129 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:14:50,131 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 09:14:52,119 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:14:52,120 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:15:29,753 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:15:41,290 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:15:43,931 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:15:43,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:44,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:15:44,318 - ispa_next.functions - DEBUG - HU date already expired after 265 days.
2025-11-12 09:15:52,708 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:15:52,711 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:15:55,585 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:15:55,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:56,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:15:58,812 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:15:58,964 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:16:02,206 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:16:11,537 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 09:16:12,542 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:16:12,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:13,051 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:23,361 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:16:32,520 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:16:32,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:32,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:16:32,601 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:16:32,695 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:16:34,178 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:16:34,592 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:16:36,766 - ispa_next.functions - DEBUG - Updated appointment (AA00050549) customer contact data.
2025-11-12 09:16:37,687 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:16:37,689 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:16:38,674 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:16:38,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:16:39,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:16:43,354 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:16:43,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:16:43,889 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:16:45,892 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:16:46,023 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:16:46,181 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:16:46,315 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:16:50,544 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:16:51,549 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:16:51,550 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:16:51,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:16:51,681 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:16:55,830 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:16:55,834 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:16:55,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:16:55,944 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:16:56,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:56,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:56,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:16:57,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:16:57,778 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:17:00,508 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:17:00,509 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:17:01,905 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:17:01,906 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:17:01,909 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-12 09:17:01,910 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:17:01,913 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:17:01,914 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:17:01,916 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:17:01,918 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:17:01,920 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:17:01,922 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:17:02,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 09:17:03,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 09:17:09,413 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:17:09,415 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:17:09,416 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:17:09,417 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:12,855 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:17:12,856 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:17:12,859 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:16,283 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:17:16,283 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:17:16,287 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:19,822 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:17:19,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:17:20,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:17:20,961 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:17:20,963 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:17:24,594 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:17:38,592 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:17:39,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:17:39,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:17:39,850 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:12,509 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:18:17,528 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:18:22,605 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:18:28,409 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:18:28,411 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:18:28,412 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:29,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:18:29,376 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:18:29,377 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:18:31,911 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:18:42,325 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:18:42,741 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:18:44,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:44,972 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:18:44,974 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:49,022 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 09:18:49,023 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:50,098 - ispa_next.main - DEBUG - 



2025-11-12 09:18:50,098 - ispa_next.main - DEBUG - starting with process 3 (HF-KT 524) of 7
2025-11-12 09:18:50,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:51,765 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:53,560 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:18:53,562 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 09:18:55,369 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:55,371 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:19:28,234 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:19:44,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:52,881 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:19:52,882 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:52,977 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:19:53,380 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:19:53,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:53,543 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:20:01,949 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:20:04,909 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:20:04,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:20:06,232 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:20:08,238 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:20:08,369 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:20:08,514 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:20:08,594 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:20:08,596 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:17,109 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:20:25,871 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:20:26,875 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:20:26,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:27,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:38,381 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:20:48,325 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:20:48,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:20:48,408 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:20:48,409 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:20:48,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:20:49,877 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:20:51,477 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:20:51,856 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:20:53,995 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-12 09:20:54,990 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:20:54,992 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:20:56,310 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:20:56,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:20:57,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:21:00,979 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:21:00,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:21:01,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:21:03,529 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:21:03,711 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:21:03,937 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:21:04,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:21:04,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:21:12,592 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:21:21,513 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:22:21,516 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:22:33,337 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 09:22:39,497 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:22:39,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:22:48,112 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:22:52,326 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:22:53,330 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:22:53,331 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:22:53,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:22:53,413 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:22:57,677 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:22:58,680 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:23:14,389 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:23:14,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:14,584 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:23:14,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:15,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:15,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:16,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:16,777 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:23:24,522 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:23:24,526 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:23:26,636 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:23:26,638 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:26,641 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-12 09:23:26,643 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:26,645 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 09:23:26,646 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:23:26,649 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:23:26,650 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:23:26,652 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:23:26,655 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:23:27,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 09:23:28,564 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 09:23:36,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:23:37,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:23:55,454 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:23:55,455 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 09:24:00,541 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:01,108 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:01,692 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:03,298 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:03,856 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:04,408 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:06,006 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:06,554 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:07,109 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:08,727 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:09,284 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:09,862 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:11,490 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:12,047 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:12,600 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:14,231 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:14,781 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:15,328 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:16,890 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:17,484 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:18,055 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:19,698 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:20,259 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:20,811 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:23,390 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:23,943 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:24,509 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:26,150 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:26,727 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:27,297 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:28,906 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:29,464 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:30,016 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:31,613 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:32,163 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:32,720 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:34,295 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 09:24:34,876 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 09:24:35,471 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 09:24:36,023 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-12 09:24:36,573 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-12 09:24:37,122 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-12 09:24:37,680 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-12 09:24:37,680 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-12 09:24:39,605 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-12 09:24:40,322 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:24:40,323 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:24:42,457 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:24:43,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:24:43,600 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:24:43,670 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:24:50,924 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:24:50,927 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:24:52,431 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:24:52,433 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:24:59,552 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 09:24:59,553 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:01,451 - ispa_next.main - DEBUG - 



2025-11-12 09:25:01,451 - ispa_next.main - DEBUG - starting with process 4 (mi mp 200) of 7
2025-11-12 09:25:01,456 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:25:04,377 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:25:08,000 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:25:08,002 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 09:25:12,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:25:12,034 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:10,768 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:26:10,780 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:26:10,786 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:12,155 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:26:12,158 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:18,826 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 09:26:18,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:26:20,919 - ispa_next.main - DEBUG - 



2025-11-12 09:26:20,919 - ispa_next.main - DEBUG - starting with process 5 (GT-WK 7070) of 7
2025-11-12 09:26:20,923 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:26:23,914 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:26:27,340 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 304
2025-11-12 09:26:27,342 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 09:26:30,807 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:26:30,809 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:27:25,911 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:27:30,386 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:27:38,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:43,046 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:27:43,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:27:43,179 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:27:43,721 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:27:52,648 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:27:52,651 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:27:55,981 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:27:55,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:27:58,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:00,258 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:28:00,443 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:28:00,686 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:28:00,833 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:28:05,205 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:28:06,212 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:28:06,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:06,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:23,357 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:28:33,051 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:28:33,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:28:33,240 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:28:33,241 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:28:33,376 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:28:34,942 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:28:35,297 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:28:38,100 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:28:38,104 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:28:40,241 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:28:40,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:28:41,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:28:45,450 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:28:45,450 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:28:45,454 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:28:45,455 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:28:45,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:45,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:28:50,238 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:28:50,242 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:28:50,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:28:50,472 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:28:59,405 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:29:15,144 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:29:15,665 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:16,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:16,394 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:17,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:17,651 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:29:21,513 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:29:21,515 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:29:23,817 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:29:23,822 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:29:23,826 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:29:23,829 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:29:23,832 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:29:23,834 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:29:23,835 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:29:23,838 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:29:23,840 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:29:23,843 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:29:23,846 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:29:23,848 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:29:23,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:28,266 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:29:28,268 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:29:28,271 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:32,505 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:29:32,505 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:29:32,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:36,796 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:29:36,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:29:38,507 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:29:39,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:00,165 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:30:00,168 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:04,759 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:30:28,923 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:30:29,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:30:30,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:30:30,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:14,162 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:22,790 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:31,144 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:39,983 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:49,899 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:49,902 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:31:49,903 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:51,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:31:51,696 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:31:51,698 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:31:59,193 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:32:18,715 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:32:19,166 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:32:21,314 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:23,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:32:23,036 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:30,303 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 09:32:30,304 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:32,131 - ispa_next.appointments.models - DEBUG - Appointment End Armaturen GmbH & Co. KG MI-EA 5000 WBA21EJ050CP49373 ohne Termin.
2025-11-12 09:32:32,139 - ispa_next.main - DEBUG - 



2025-11-12 09:32:32,139 - ispa_next.main - DEBUG - starting with process 6 (OS-MW 37) of 7
2025-11-12 09:32:32,143 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:32:35,058 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:32:38,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:32:38,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 09:32:41,717 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:41,718 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:33:38,139 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:33:42,596 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:33:51,289 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:56,347 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:33:56,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:56,502 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:57,057 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:33:57,059 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:34:00,694 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:34:00,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:05,338 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:07,340 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:34:07,529 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:34:07,779 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:34:07,982 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:34:12,329 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:34:13,334 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:34:13,334 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:13,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:30,628 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:34:40,315 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:34:40,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:34:40,453 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:34:40,455 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:34:40,529 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:34:40,799 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:34:42,691 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:34:43,106 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:34:46,222 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:34:46,225 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:34:46,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:34:48,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:34:50,302 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:34:50,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:34:50,457 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:34:54,137 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:34:54,137 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:34:54,140 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:34:54,140 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:34:54,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:54,717 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:34:58,953 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:34:58,957 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:34:58,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:34:59,179 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:35:08,042 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 09:35:23,666 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:35:24,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:25,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:35:25,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:35:26,132 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:35:26,133 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:35:30,861 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:35:30,884 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:35:33,377 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:35:33,379 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:35:33,382 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:35:33,383 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:35:33,386 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:35:33,388 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:35:33,389 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:35:33,392 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:35:33,393 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:35:33,396 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:35:33,399 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:35:33,401 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:35:33,402 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:38,746 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:35:38,748 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:35:38,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:43,806 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:35:43,806 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:35:43,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:48,894 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:35:48,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:35:50,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:35:50,618 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:35:59,690 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:35:59,692 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:36:04,732 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:36:28,033 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:36:28,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:36:29,365 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:36:29,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:20,286 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:29,387 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:38,212 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:37:50,671 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:38:00,318 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:38:09,838 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:38:09,841 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:38:09,842 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:11,493 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:38:11,624 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:38:11,627 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:38:16,140 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:38:35,821 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:38:36,239 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:38:38,537 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:40,233 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:38:40,235 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:38:47,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 09:38:47,588 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:38:49,530 - ispa_next.main - DEBUG - Found new Appointment: MI-EA 5000
2025-11-12 09:38:49,531 - ispa_next.main - DEBUG - 



2025-11-12 09:38:49,532 - ispa_next.main - DEBUG - starting with process 7 (MI-EA 5000) of 8
2025-11-12 09:38:49,535 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:38:54,566 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:38:59,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:38:59,262 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 09:39:02,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:02,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:47,303 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:40:05,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:11,352 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:40:11,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:11,502 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:11,977 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:40:11,987 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:40:15,526 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:15,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:18,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:20,092 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:40:20,298 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:40:23,700 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:40:23,897 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:40:26,139 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:40:27,144 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:40:27,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:27,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:46,313 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:41:01,511 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:41:01,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:01,729 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:41:01,730 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:41:01,844 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:41:03,444 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:41:04,924 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:41:05,284 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:41:08,232 - ispa_next.functions - DEBUG - Updated appointment (AA00050554) customer contact data.
2025-11-12 09:41:09,376 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:41:09,422 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:41:11,870 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:41:11,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:41:13,299 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:41:16,949 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:41:16,949 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:41:16,952 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:41:16,953 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:41:16,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:17,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:21,764 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:41:23,747 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:41:40,307 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:41:40,308 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:41,250 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:41:52,213 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:52,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:52,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:53,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:53,943 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:41:59,290 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:41:59,292 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:42:04,548 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:42:04,549 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:42:04,552 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart)}
2025-11-12 09:42:04,553 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:42:04,556 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:42:04,558 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:42:04,559 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:42:04,562 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:42:04,564 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:42:04,566 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:42:04,569 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 09:42:05,546 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 09:42:06,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 09:42:14,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 09:42:16,218 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 09:42:33,890 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 09:42:33,892 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:42:33,893 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:42:33,894 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:41,136 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:42:41,138 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:42:41,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:48,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:42:48,890 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:42:59,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:22,226 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:43:22,227 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:43:22,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:29,817 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:43:29,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:43:31,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:43:31,423 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:43:31,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:43:38,726 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-12 09:43:53,481 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:44:15,847 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:44:16,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:17,082 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:44:17,477 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:51,791 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:44:51,792 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:44:53,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:44:53,724 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:44:53,726 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:45:02,473 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:45:24,082 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:45:24,545 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:45:28,505 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:30,076 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:45:30,078 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:37,762 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 09:45:37,763 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:45:39,711 - ispa_next.main - DEBUG - 



2025-11-12 09:45:39,711 - ispa_next.main - DEBUG - starting with process 8 (MI-JH356) of 8
2025-11-12 09:45:39,715 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:45:42,653 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:45:46,250 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:45:46,252 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 09:45:49,953 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:45:49,956 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:46,713 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:46:51,402 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:47:00,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:06,503 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:47:06,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:06,683 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:07,173 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:47:16,587 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:47:16,589 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:47:20,025 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:20,027 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:22,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:47:24,533 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:47:24,727 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:47:24,974 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:47:25,130 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:47:29,512 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:47:30,518 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:47:30,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:31,080 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:48,778 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:47:58,278 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:47:58,280 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:58,418 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:58,430 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:47:58,508 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:48:00,079 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:48:00,448 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:48:04,229 - ispa_next.functions - DEBUG - Updated appointment (AA00050351) customer contact data.
2025-11-12 09:48:05,488 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:48:05,534 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:48:07,498 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:48:07,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:48:09,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:48:12,731 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:48:12,731 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:48:12,734 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:48:12,735 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:48:12,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:13,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:48:17,579 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:48:17,583 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:48:17,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:17,760 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:48:26,822 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 09:48:42,814 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 09:48:43,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:44,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:44,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:45,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:48:45,292 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:48:50,562 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:48:50,565 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:48:52,895 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:48:52,896 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:48:52,900 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:48:52,901 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:48:52,906 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:48:52,907 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:48:52,909 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:48:52,913 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:48:52,915 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:48:52,918 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:48:52,962 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:48:52,964 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:48:52,965 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:48:58,847 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:48:58,848 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:48:58,852 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:04,558 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:49:04,558 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:49:04,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:10,418 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:49:10,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:49:12,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:49:12,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:27,481 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:49:27,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:33,368 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:49:57,924 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:49:58,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:49:59,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:49:59,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:50:48,656 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:50:48,657 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:50:50,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:50:50,620 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:50:50,621 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:50:59,168 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 09:51:19,945 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:51:20,439 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:51:22,762 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:51:24,627 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 09:51:24,629 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:51:32,527 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 09:51:32,528 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
