2025-11-12 13:19:45,913 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 13:19:45,919 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 13:19:57,268 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 13:20:11,456 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 13:20:27,219 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 13:20:51,692 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 13:21:07,884 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 13:21:11,060 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:12,668 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:21:12,670 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-12 13:21:15,881 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 142
2025-11-12 13:21:15,882 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 13:21:15,882 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:21:17,364 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 13:21:18,803 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:21:46,335 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:21:46,394 - ispa_next.appointments.models - DEBUG - Appointment Manuel Hermann Jaeger-Lenne GV-MJ 1989 WBAJG11030ED57177 ohne Termin.
2025-11-12 13:21:46,412 - ispa_next.appointments.models - DEBUG - Appointment Armaturen Vertrieb Alms GmbH ME-AA 340E WBY71AW020FT62013 ohne Termin.
2025-11-12 13:21:46,430 - ispa_next.appointments.models - DEBUG - Appointment   WBA11FZ090FR60998 ohne Termin.
2025-11-12 13:21:46,449 - ispa_next.appointments.models - DEBUG - Appointment Bianca Prins VIE-PE 881 WBA11AW010FL84234 ohne Termin.
2025-11-12 13:21:46,478 - ispa_next.appointments.models - DEBUG - Appointment Oliver Berndsen NE-JO 288E WBY31FK070CR63503 ohne Termin.
2025-11-12 13:21:46,494 - ispa_next.appointments.models - DEBUG - Appointment   WBY61EF0105W96493 ohne Termin.
2025-11-12 13:21:46,503 - ispa_next.appointments.models - DEBUG - Appointment Krajnc ME-VV 1979 WBA11EV0209W56488 ohne Termin.
2025-11-12 13:21:46,519 - ispa_next.main - DEBUG - Found 15 out of 31 appointments to process (configured limit: 15).
2025-11-12 13:21:46,520 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 13:21:46,521 - ispa_next.main - DEBUG - Processing 12 already visited appointments (w/ RKR not callable).
2025-11-12 13:21:46,521 - ispa_next.main - DEBUG - All appointments: F-S685E, NE-X 1660, NE-RK 63, NE-MS 2311, NE-EG 1989, NE-GB 2917, D-NE 397, NE-EY 9, NU-P 2200, NE-RI 1352, NE-IM 149, KR-HK 6000, NE-IK 4000, VIE-RJ 766, F-CG 723
2025-11-12 13:21:46,523 - ispa_next.main - DEBUG - 



2025-11-12 13:21:46,523 - ispa_next.main - DEBUG - starting with process 1 (F-S685E) of 15
2025-11-12 13:21:46,527 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:21:47,944 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:21:49,582 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:21:49,583 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 142
2025-11-12 13:21:51,543 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:21:51,545 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:32,801 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 13:22:32,948 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 13:22:32,952 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:33,746 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:22:33,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:37,073 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-12 13:22:37,074 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:22:38,166 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:22:38,172 - ispa_next.main - DEBUG - 



2025-11-12 13:22:38,172 - ispa_next.main - DEBUG - starting with process 2 (NE-X 1660) of 15
2025-11-12 13:22:38,175 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:22:39,642 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:22:41,181 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:22:41,182 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-12 13:22:42,725 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:22:42,726 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:17,261 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:23:28,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:28,622 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:23:28,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:36,386 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:23:36,387 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:23:36,475 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:23:36,819 - ispa_next.functions - DEBUG - HU date soon to be invalid in 4 days.
2025-11-12 13:23:45,324 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:23:45,327 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:23:48,168 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:23:48,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:23:49,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:23:51,734 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:23:51,884 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:23:51,994 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:23:52,125 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:23:52,126 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:23:59,945 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:24:11,859 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:24:17,216 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:24:17,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:24:27,190 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 13:24:30,968 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 13:24:32,942 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:24:35,544 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:24:36,549 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:24:36,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:24:37,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:24:53,968 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:25:03,221 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:25:03,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:03,374 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:03,375 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:25:03,465 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:25:03,659 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:25:05,594 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:25:06,001 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:25:09,564 - ispa_next.functions - DEBUG - Updated appointment (AC00010688) customer contact data.
2025-11-12 13:25:10,537 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:25:10,540 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:25:10,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:25:11,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:25:13,109 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:25:13,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:25:13,187 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:25:16,858 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:25:16,859 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:25:16,863 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:25:16,867 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:25:16,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:17,361 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:17,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:18,425 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:18,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:19,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:19,420 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:25:21,133 - ispa_next.package_manager.helper - DEBUG - couldn't retrieve pakage name in cart
2025-11-12 13:25:21,531 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 262, in run
    self._update_cart_content()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 36, in _update_cart_content
    self.containers[Container.CART] = self.ui_helper.get_cart_content(self.base_element)
                                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 141, in get_cart_content
    name=cart_package_name,
         ^^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'cart_package_name' where it is not associated with a value

2025-11-12 13:25:21,554 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:25:21,555 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:25:22,514 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:25:23,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:25:23,217 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:25:23,245 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:25:27,027 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 13:25:27,031 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:27,789 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:25:27,791 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:31,566 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 146
2025-11-12 13:25:31,567 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:25:32,817 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:25:32,826 - ispa_next.main - DEBUG - 



2025-11-12 13:25:32,826 - ispa_next.main - DEBUG - starting with process 3 (NE-RK 63) of 15
2025-11-12 13:25:32,830 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:25:34,511 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:25:36,103 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 387
2025-11-12 13:25:36,104 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 146
2025-11-12 13:25:37,779 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:25:37,780 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:02,402 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:26:13,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:26:15,498 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:26:15,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:15,587 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:15,811 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:26:15,814 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:26:18,794 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:26:18,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:19,034 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 13:26:19,446 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\azureuser\AppData\Local\robocorp\holotree\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 13:26:19,475 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:26:19,475 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:20,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:26:21,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:26:21,010 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 13:26:21,063 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:26:24,180 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 13:26:24,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:24,765 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:26:24,766 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:28,822 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-12 13:26:28,823 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:26:30,020 - ispa_next.appointments.models - DEBUG - Appointment Sebastian Mitulla NE-TU 40 WBA51AJ0X0CF30403 ohne Termin.
2025-11-12 13:26:30,046 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:26:30,054 - ispa_next.main - DEBUG - 



2025-11-12 13:26:30,054 - ispa_next.main - DEBUG - starting with process 4 (NE-MS 2311) of 15
2025-11-12 13:26:30,058 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:26:31,576 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:26:33,430 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:26:33,431 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-12 13:26:35,108 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:26:35,110 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:27:05,608 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:27:08,320 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:27:14,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:15,963 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:27:15,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:16,133 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:27:16,405 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:27:16,408 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:27:19,328 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:27:19,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:27:20,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:27:22,608 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:27:22,774 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:27:22,887 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:27:23,081 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:27:27,317 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:27:28,322 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:27:28,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:28,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:43,238 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:27:43,238 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:27:47,900 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:27:47,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:27:48,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:27:48,012 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:27:48,095 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:27:49,687 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:27:51,300 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:27:51,677 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:27:53,403 - ispa_next.functions - DEBUG - Updated appointment (AB00014473) customer contact data.
2025-11-12 13:27:54,334 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:27:54,337 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:27:55,348 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:27:55,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:27:56,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:28:00,497 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:28:00,497 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:28:00,497 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:28:00,501 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:28:00,505 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:28:00,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:01,022 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:04,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:05,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:28:05,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:28:05,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:28:05,937 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:28:07,884 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:28:07,912 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:28:09,505 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:28:09,506 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:28:09,509 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:28:09,510 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:28:09,511 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:28:09,514 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:28:09,515 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:28:09,516 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:28:09,519 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:28:09,520 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:28:09,522 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:28:09,526 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:28:09,527 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:28:09,528 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:11,550 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:28:11,552 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:28:11,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:14,069 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:28:14,071 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:28:14,072 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:28:15,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:28:15,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:24,716 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:28:24,718 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:26,832 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:28:39,852 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:28:40,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:28:40,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:28:41,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:29:00,499 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:29:06,184 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:29:06,187 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:29:06,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:06,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:29:07,066 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:29:07,068 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:29:09,395 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:29:21,338 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:29:21,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 13:29:22,914 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:23,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:29:23,732 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:27,734 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-12 13:29:27,735 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:28,801 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:29:28,806 - ispa_next.main - DEBUG - Found new Appointment: NE-TU 40
2025-11-12 13:29:28,807 - ispa_next.main - DEBUG - 



2025-11-12 13:29:28,807 - ispa_next.main - DEBUG - starting with process 5 (NE-TU 40) of 16
2025-11-12 13:29:28,811 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:30,330 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:31,991 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:29:31,993 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-12 13:29:33,560 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:33,561 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:30:03,260 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:30:16,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:16,817 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:17,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:19,277 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:30:19,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:19,375 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:19,652 - ispa_next.functions - DEBUG - HU date soon to be invalid in 6 days.
2025-11-12 13:30:27,510 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:30:27,513 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:30:30,387 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:30:30,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:30:31,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:30:33,938 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:30:34,113 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:30:37,376 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:30:37,501 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:30:37,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:39,626 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:30:48,320 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:30:49,325 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:30:49,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:49,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:06,841 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:31:15,750 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:31:15,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:15,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:31:15,926 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:31:15,969 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:31:17,561 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:31:17,927 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:31:21,808 - ispa_next.functions - DEBUG - Updated appointment (AA00025038) customer contact data.
2025-11-12 13:31:22,786 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:31:22,788 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:31:24,120 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:31:24,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:31:25,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:31:28,663 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:31:28,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:29,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:31,172 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:31:31,314 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:31:31,431 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:31:31,552 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:31:31,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:33,657 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:31:44,566 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:31:49,938 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:31:49,940 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:31:51,971 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:31:56,232 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:31:57,241 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:31:57,249 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:31:57,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:57,337 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:31:57,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:58,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:58,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:59,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:59,107 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:32:01,101 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:32:01,103 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:32:02,377 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:32:02,378 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:02,381 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:32:02,382 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:32:02,383 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:02,386 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:32:02,387 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:32:02,388 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:32:02,391 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:32:02,392 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:32:02,395 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:32:02,398 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:32:02,400 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:32:02,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:04,479 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:32:04,481 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:32:04,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:06,510 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:32:06,512 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:32:06,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:32:07,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:32:07,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:15,033 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:32:15,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:17,020 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:32:29,278 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:32:29,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:32:30,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:32:30,532 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:49,060 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:32:54,983 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:33:01,789 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:33:01,789 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:02,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:33:02,685 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:33:02,687 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:33:07,503 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:33:17,889 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:33:18,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 13:33:19,348 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:20,002 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:33:20,004 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:24,125 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-12 13:33:24,126 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:33:25,193 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:33:25,201 - ispa_next.main - DEBUG - 



2025-11-12 13:33:25,201 - ispa_next.main - DEBUG - starting with process 6 (NE-EG 1989) of 16
2025-11-12 13:33:25,205 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:26,745 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:33:28,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:33:28,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-12 13:33:30,524 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:33:30,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:34:09,219 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:34:11,471 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:34:17,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:34:19,802 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:34:19,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:19,998 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:34:20,308 - ispa_next.functions - DEBUG - HU date already expired after 808 days.
2025-11-12 13:34:25,167 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:34:25,170 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:34:27,982 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:34:27,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:34:29,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:34:31,333 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:34:31,518 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:34:31,640 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:34:31,745 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:34:33,915 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:34:34,922 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:34:34,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:35,490 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:53,114 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:34:58,318 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:34:58,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:34:58,398 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:34:58,399 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:34:58,501 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:34:58,796 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:35:00,322 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:35:00,720 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:35:02,738 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:35:02,740 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:35:02,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:35:03,976 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:35:05,179 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:35:05,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:35:05,334 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:35:08,943 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:35:08,943 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:35:08,946 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:35:08,949 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:35:08,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:09,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:10,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:10,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:35:10,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:35:11,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:35:11,838 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:35:14,514 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:35:14,517 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:35:16,623 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:35:16,626 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:35:16,629 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:35:16,631 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:35:16,632 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:35:16,638 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:35:16,640 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:35:16,641 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:35:16,644 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:35:16,645 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:35:16,648 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:35:16,652 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:35:16,654 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:35:16,655 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:19,575 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:35:19,577 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:35:19,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:22,332 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:35:22,335 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:35:22,335 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:35:23,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:35:23,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:32,895 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:35:32,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:35:35,664 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:35:48,950 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:35:49,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:35:50,010 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:35:50,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:17,736 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:23,142 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:28,802 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:36:28,805 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:36:28,806 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:36:29,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:36:29,736 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:36:29,737 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:36:31,957 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:36:42,249 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:36:42,683 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 13:36:43,880 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:36:44,807 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:36:44,809 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:36:49,104 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-12 13:36:49,105 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:36:50,171 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:36:50,179 - ispa_next.main - DEBUG - 



2025-11-12 13:36:50,179 - ispa_next.main - DEBUG - starting with process 7 (NE-GB 2917) of 16
2025-11-12 13:36:50,222 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:36:51,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:36:53,537 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:36:53,539 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-12 13:36:55,129 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:36:55,130 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:37:26,583 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:37:29,179 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:37:34,919 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:37,750 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:37:37,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:37,831 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:37:38,160 - ispa_next.functions - DEBUG - HU date already expired after 435 days.
2025-11-12 13:37:43,540 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:37:43,542 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:37:46,358 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:37:46,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:37:47,686 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:37:49,690 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:37:49,825 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:37:49,969 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:37:50,266 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:37:54,510 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:37:55,515 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:37:55,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:56,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:13,237 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:38:18,412 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:38:18,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:18,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:38:18,570 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:38:18,737 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:38:18,994 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:38:20,615 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:38:21,001 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:38:22,969 - ispa_next.functions - DEBUG - Updated appointment (AC00010673) customer contact data.
2025-11-12 13:38:23,971 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:38:23,973 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:38:24,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:25,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:38:26,360 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:38:26,361 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:26,483 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:38:30,560 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:30,560 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:38:30,563 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:38:30,566 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:38:30,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:31,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:31,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:32,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:32,107 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:32,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:32,969 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:38:35,689 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:38:35,691 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:38:37,061 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:38:37,062 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:38:37,065 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:38:37,067 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:38:37,068 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:38:37,071 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:38:37,072 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:38:37,073 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:38:37,075 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:38:37,076 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:38:37,079 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:38:37,091 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:38:37,095 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:38:37,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:40,009 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:38:40,011 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:38:40,014 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:42,911 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:38:42,913 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:38:42,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:38:43,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:38:43,981 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:50,400 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:38:50,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:53,179 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:39:06,276 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:39:06,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:07,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:39:07,522 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:35,100 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:39:40,539 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:39:46,296 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:39:46,298 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:39:46,299 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:39:47,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:39:47,191 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:39:47,193 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:39:49,586 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:39:59,330 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:39:59,729 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 13:40:00,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:40:01,729 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:40:01,730 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:40:06,501 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-12 13:40:06,502 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:40:07,539 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:40:07,545 - ispa_next.main - DEBUG - 



2025-11-12 13:40:07,545 - ispa_next.main - DEBUG - starting with process 8 (D-NE 397) of 16
2025-11-12 13:40:07,548 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:40:09,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:40:10,693 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 388
2025-11-12 13:40:10,695 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-12 13:40:12,730 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:40:12,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:40:57,738 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:41:00,146 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:41:05,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:41:11,994 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:41:11,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:12,152 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:12,436 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:41:12,439 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:41:15,374 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:15,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:16,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:18,654 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:41:18,799 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:41:18,908 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:41:19,049 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:41:23,303 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:41:24,308 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:41:24,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:24,806 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:39,760 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:41:44,985 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:41:44,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:45,144 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:41:45,145 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:41:45,221 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:41:45,388 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:41:47,086 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:41:47,442 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:41:50,014 - ispa_next.functions - DEBUG - Updated appointment (AA00024911) customer contact data.
2025-11-12 13:41:50,937 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:41:50,963 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:41:51,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:52,266 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:41:53,522 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:41:53,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:41:53,639 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:41:57,284 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:41:57,284 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:41:57,287 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:41:57,290 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:41:57,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:57,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:58,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:58,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:41:58,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:41:59,571 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:41:59,573 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:42:05,471 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:42:05,500 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:42:06,601 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:42:06,603 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:42:06,606 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:42:06,608 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:42:06,609 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:42:06,613 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:42:06,615 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:42:06,616 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:42:06,620 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:42:06,622 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:42:06,625 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:42:06,629 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:42:06,631 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:42:06,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:13,140 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:42:13,142 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:42:13,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:19,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:19,504 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:42:35,141 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:42:35,143 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:42:35,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:42:36,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:42:36,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:49,908 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:42:49,911 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:56,188 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:43:10,464 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:43:10,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:43:11,551 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:43:11,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:12,213 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:18,790 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:24,391 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:30,463 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:37,471 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:43,809 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:48,929 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:44:55,717 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:45:00,222 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:45:00,223 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:45:01,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:45:01,152 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:45:01,154 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:45:06,894 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:45:17,227 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:45:17,615 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 13:45:19,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:45:20,704 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:45:20,705 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:45:25,369 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 13:45:25,370 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:45:26,586 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:45:26,591 - ispa_next.main - DEBUG - 



2025-11-12 13:45:26,591 - ispa_next.main - DEBUG - starting with process 9 (NE-EY 9) of 16
2025-11-12 13:45:26,595 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:45:28,163 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:45:29,949 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:45:29,951 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 13:45:31,874 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:45:31,875 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:46:12,544 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:46:14,880 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:46:20,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:46:22,504 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:46:22,505 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:22,584 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:46:22,940 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:46:22,943 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:46:25,947 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:46:25,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:46:27,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:46:29,565 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:46:29,770 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:46:29,911 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:46:29,991 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:46:34,288 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:46:35,292 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:46:35,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:35,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:53,194 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:46:58,783 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:46:58,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:46:58,928 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:46:58,929 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:46:59,054 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:47:00,554 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:47:00,921 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:47:03,060 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:47:03,083 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:47:04,145 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:47:04,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:47:05,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:47:08,875 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:47:08,875 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:47:08,879 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:47:08,884 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:47:08,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:47:09,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:47:09,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:47:10,569 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:47:10,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:47:11,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:47:11,355 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:47:13,343 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:47:13,345 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:47:15,255 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:47:15,257 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:47:15,259 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:47:15,260 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:47:15,262 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:47:15,264 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:47:15,265 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:47:15,266 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:47:15,269 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:47:15,270 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:47:15,273 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:47:15,276 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:47:15,279 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:47:15,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:17,351 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:47:17,353 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:47:17,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:19,441 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:47:19,444 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:47:19,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:47:20,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:47:21,031 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:30,303 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:47:30,305 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:32,338 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:47:45,863 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:47:46,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:47:46,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:47:47,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:48:06,261 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:48:12,399 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:48:12,402 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:48:12,403 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:48:13,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:48:13,331 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:48:13,334 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:48:15,575 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:48:26,254 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:48:26,679 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:48:28,005 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:29,064 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:48:29,065 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:33,306 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 13:48:33,307 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:48:34,364 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:48:34,369 - ispa_next.main - DEBUG - 



2025-11-12 13:48:34,369 - ispa_next.main - DEBUG - starting with process 10 (NU-P 2200) of 16
2025-11-12 13:48:34,373 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:48:35,953 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:48:37,683 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:48:37,684 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 13:48:39,490 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:48:39,492 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:49:22,759 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:49:25,284 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:49:31,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:31,811 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:49:32,000 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:35,739 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:49:35,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:35,883 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:49:36,201 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:49:36,204 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:49:39,133 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:49:39,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:40,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:42,943 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:49:43,091 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:49:43,318 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:49:43,395 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:49:49,691 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:49:59,785 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:50:00,790 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:50:00,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:01,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:19,073 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:50:24,888 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:50:24,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:25,022 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:50:25,023 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:50:25,148 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:50:26,751 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:50:27,130 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:50:29,144 - ispa_next.functions - DEBUG - Updated appointment (AA00025035) customer contact data.
2025-11-12 13:50:30,142 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:50:30,232 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:50:31,165 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:50:31,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:50:32,362 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:50:36,530 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:50:36,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:50:37,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:50:39,041 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:50:39,206 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:50:39,386 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:50:39,516 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:50:45,885 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 13:50:51,024 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 13:50:52,043 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:50:52,047 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:50:52,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:50:52,167 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:50:52,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:53,236 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:50:53,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:50:54,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:50:54,014 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:50:57,281 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:50:57,283 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:50:58,550 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:50:58,552 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:50:58,556 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:50:58,559 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:50:58,561 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:50:58,564 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:50:58,566 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:50:58,567 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:50:58,569 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:50:58,570 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:50:58,573 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:50:58,576 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:50:58,578 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:50:58,579 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:02,147 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:51:02,149 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:51:02,151 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:05,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:51:05,790 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:51:16,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:29,953 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:51:29,955 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:51:29,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:51:30,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:51:31,017 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:51:31,019 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:51:34,503 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:51:47,300 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:51:47,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:51:48,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:51:48,523 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:52:12,499 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:52:12,500 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:52:13,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:52:13,383 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:52:13,385 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:52:18,209 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:52:29,185 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:52:29,628 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:52:31,482 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:52:32,306 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:52:32,307 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:52:37,296 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 13:52:37,297 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:52:38,379 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:52:38,384 - ispa_next.main - DEBUG - 



2025-11-12 13:52:38,384 - ispa_next.main - DEBUG - starting with process 11 (NE-RI 1352) of 16
2025-11-12 13:52:38,387 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:52:39,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:52:41,778 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:52:41,779 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 13:52:43,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:52:43,646 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:53:19,081 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:53:22,076 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:53:27,761 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:53:29,769 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:53:29,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:53:29,938 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:53:30,326 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:53:30,328 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:53:33,348 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:53:33,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:53:34,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:53:36,934 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:53:37,081 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:53:37,284 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:53:37,415 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:53:41,666 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:53:42,672 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:53:42,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:53:43,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:01,793 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:54:06,750 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:54:06,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:06,834 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:54:06,835 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:54:06,926 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:54:08,552 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:54:08,913 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:54:11,610 - ispa_next.functions - DEBUG - Updated appointment (AC00010676) customer contact data.
2025-11-12 13:54:12,527 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:54:12,642 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:54:13,553 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:54:13,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:54:14,761 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:54:18,882 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:54:18,882 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:54:18,882 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:54:18,885 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:54:18,890 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:54:18,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:54:19,473 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:54:23,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:24,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:24,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:54:24,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:54:24,881 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:54:26,902 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:54:26,905 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:54:28,938 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:54:28,940 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:54:28,942 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:54:28,943 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:54:28,944 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:54:28,947 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:54:28,948 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:54:28,949 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:54:28,952 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:54:28,953 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:54:28,955 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:54:28,959 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:54:28,962 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:54:28,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:31,127 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:54:31,129 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:54:31,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:33,435 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:54:33,437 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:54:33,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:54:34,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:54:34,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:44,079 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:54:44,081 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:46,105 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:54:59,698 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:55:00,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:55:00,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:55:01,076 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:55:20,253 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:26,262 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:26,266 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:55:26,266 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:55:27,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:55:27,149 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:55:27,150 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:55:29,524 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:55:39,734 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:55:40,142 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:55:41,478 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:55:42,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:55:42,482 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:55:46,705 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 13:55:46,706 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:55:47,921 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:55:47,926 - ispa_next.main - DEBUG - 



2025-11-12 13:55:47,926 - ispa_next.main - DEBUG - starting with process 12 (NE-IM 149) of 16
2025-11-12 13:55:47,929 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:55:49,539 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:55:51,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:55:51,905 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 13:55:54,035 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:55:54,037 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:56:29,723 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:56:32,138 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:56:37,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:56:40,587 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:56:40,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:56:40,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:56:41,106 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:56:46,254 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:56:46,258 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:56:49,181 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:56:49,182 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:56:50,782 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:56:52,785 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:56:52,945 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:56:53,095 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:56:53,229 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:56:55,410 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:56:56,416 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:56:56,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:56:56,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:13,937 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:57:19,175 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:57:19,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:19,272 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:57:19,273 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:57:19,386 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:57:19,557 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:57:21,405 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:57:21,754 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:57:24,690 - ispa_next.functions - DEBUG - Updated appointment (AA00024982) customer contact data.
2025-11-12 13:57:25,616 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:57:25,619 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:57:25,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:57:27,127 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:57:28,290 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:57:28,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:57:28,395 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:57:32,498 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:57:32,499 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:57:32,502 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:57:32,506 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:57:32,507 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:57:33,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:57:33,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:34,096 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:57:34,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:57:34,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:57:34,959 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:57:37,530 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:57:37,532 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:57:40,200 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:57:40,203 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:57:40,211 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 13:57:40,214 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:57:40,217 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:57:40,220 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:57:40,221 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:57:40,223 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:57:40,225 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:57:40,226 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:57:40,243 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:57:40,251 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:57:40,253 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:57:40,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:57:43,171 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:57:43,173 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:57:43,175 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:57:45,944 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:57:45,947 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:57:45,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 13:57:47,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 13:57:47,456 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:58:02,238 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:58:02,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:58:05,120 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:58:19,008 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:58:19,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:58:20,214 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:58:20,375 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:58:47,032 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:58:52,790 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:58:58,288 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:58:58,292 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:58:58,293 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:58:59,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:58:59,177 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:58:59,179 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:59:01,535 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:59:12,613 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:59:13,048 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:59:14,364 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:59:15,382 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:59:15,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:59:20,400 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 13:59:20,401 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:59:21,580 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 13:59:21,585 - ispa_next.main - DEBUG - 



2025-11-12 13:59:21,585 - ispa_next.main - DEBUG - starting with process 13 (KR-HK 6000) of 16
2025-11-12 13:59:21,588 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:59:23,214 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:59:24,995 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 13:59:24,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 13:59:27,193 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:59:27,194 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:00:04,264 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:00:06,776 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 14:00:13,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:00:17,414 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:00:17,415 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:00:17,586 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:00:17,990 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:00:17,992 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:00:20,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:00:20,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:00:22,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:00:24,453 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:00:24,614 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:00:24,784 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:00:24,910 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:00:29,124 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 14:00:30,129 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:00:30,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:00:30,678 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:00:49,707 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:00:55,850 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:00:55,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:00:55,952 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:00:55,953 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:00:56,060 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:00:56,200 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:00:57,929 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:00:58,223 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:01:00,504 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:01:00,636 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:01:00,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:01:02,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:01:03,205 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:01:03,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:01:03,320 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 14:01:07,057 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:01:07,057 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 14:01:07,060 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:01:07,063 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:01:07,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:01:08,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:01:17,128 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 14:01:28,754 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 14:01:29,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:01:30,086 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:01:30,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:01:31,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:01:31,081 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:01:34,898 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:01:34,900 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:01:37,236 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:01:37,238 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:01:37,242 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 14:01:37,243 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:01:37,245 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:01:37,249 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:01:37,250 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:01:37,251 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:01:37,254 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:01:37,255 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:01:37,259 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:01:37,262 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:01:37,264 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:01:37,265 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:41,656 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:01:41,658 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:01:41,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:45,894 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:01:45,896 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:01:45,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:01:46,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:01:47,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:02:01,849 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:02:01,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:02:06,060 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:02:19,731 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:02:20,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:02:20,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:02:21,104 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:03:01,654 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:03:07,494 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:03:12,987 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:03:19,684 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:03:26,143 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:03:26,145 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:03:26,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:03:26,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:03:27,093 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:03:27,095 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:03:29,507 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:03:40,236 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:03:40,641 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 14:03:42,074 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:03:43,115 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 14:03:43,116 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:03:48,257 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 14:03:48,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:03:49,492 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 14:03:49,496 - ispa_next.main - DEBUG - 



2025-11-12 14:03:49,497 - ispa_next.main - DEBUG - starting with process 14 (NE-IK 4000) of 16
2025-11-12 14:03:49,500 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:03:51,056 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:03:52,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 14:03:52,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 14:03:54,697 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:03:54,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:04:30,267 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:04:32,742 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 14:04:39,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:04:42,739 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:04:42,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:04:42,818 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:04:43,181 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:04:43,185 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:04:46,373 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:04:46,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:04:47,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:04:49,948 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:04:50,173 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:04:50,350 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:04:50,431 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:04:54,684 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 14:04:55,689 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:04:55,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:04:56,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:14,899 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:05:21,457 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:05:21,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:21,593 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:05:21,594 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:05:21,674 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:05:21,809 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:05:23,519 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:05:23,820 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:05:26,252 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:05:26,254 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:05:26,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:05:27,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:05:28,776 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:05:28,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:05:28,956 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 14:05:32,622 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:05:32,622 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 14:05:32,626 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:05:32,631 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:05:32,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:05:33,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:05:37,068 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 14:05:48,496 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 14:05:48,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:49,736 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:49,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:05:50,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:05:50,628 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:05:53,867 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:05:53,870 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:05:54,934 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:05:54,936 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:05:54,941 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 14:05:54,944 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:05:54,947 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:05:54,953 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:05:54,957 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:05:54,959 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:05:54,962 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:05:54,963 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:05:54,966 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:05:54,969 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:05:54,971 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:05:54,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:05:58,562 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:05:58,565 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:05:58,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:06:02,083 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:06:02,085 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:06:02,086 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:06:03,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:06:03,710 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:06:12,988 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:06:12,990 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:06:16,463 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:06:30,431 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:06:30,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:06:31,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:06:31,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:07:05,689 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:11,643 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:17,042 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:23,348 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:07:23,351 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:07:23,351 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:07:24,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:07:24,260 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:07:24,262 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:07:27,718 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:07:38,261 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:07:38,654 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 14:07:39,985 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:07:41,156 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 14:07:41,157 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:07:46,517 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 148
2025-11-12 14:07:46,518 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:07:47,608 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 14:07:47,616 - ispa_next.main - DEBUG - 



2025-11-12 14:07:47,616 - ispa_next.main - DEBUG - starting with process 15 (VIE-RJ 766) of 16
2025-11-12 14:07:47,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:07:49,157 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:07:51,085 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 389
2025-11-12 14:07:51,086 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 148
2025-11-12 14:07:52,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:07:52,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:08:42,340 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:08:44,810 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 14:08:51,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:08:51,673 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:08:51,888 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:08:55,402 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:08:55,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:08:55,548 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:08:56,003 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:08:56,006 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:08:59,146 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:08:59,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:09:00,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:09:02,857 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:09:02,986 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:09:03,178 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:09:03,299 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:09:03,301 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:09:07,054 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:09:15,923 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 14:09:16,928 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:09:16,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:09:17,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:09:33,981 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 14:09:39,716 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:09:39,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:09:39,941 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:09:39,942 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:09:40,038 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:09:40,220 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:09:41,957 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:09:42,316 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:09:44,695 - ispa_next.functions - DEBUG - Updated appointment (AA00025031) customer contact data.
2025-11-12 14:09:45,730 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:09:45,732 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:09:45,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:09:47,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:09:48,983 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:09:48,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:09:49,152 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 14:09:52,852 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:09:52,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:09:53,402 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:09:55,407 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:09:55,567 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:09:55,685 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:09:55,787 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:09:55,789 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:09:59,378 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:10:08,118 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:11:08,120 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:11:18,180 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:11:43,182 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:11:51,864 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 14:12:00,860 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 14:12:01,866 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:12:01,871 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:12:01,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:12:02,000 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:12:02,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:12:03,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:12:03,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:12:03,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:12:03,852 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:12:07,084 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:12:07,086 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:12:08,318 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:12:08,321 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:12:08,325 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 14:12:08,327 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:12:08,328 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:12:08,332 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:12:08,333 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:12:08,334 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:12:08,337 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:12:08,338 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:12:08,340 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:12:08,344 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:12:08,346 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:12:08,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:12:11,963 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:12:11,965 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:12:11,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:12:15,500 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:12:15,503 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:12:15,504 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:12:16,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:12:16,634 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:12:16,636 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:12:20,126 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:12:32,974 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:12:33,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:12:34,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:12:34,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:13:07,878 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:13:13,746 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:13:19,158 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:13:24,952 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:13:24,955 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:13:24,956 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:13:25,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:13:25,867 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:13:25,870 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:13:28,188 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:13:38,715 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:13:39,145 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 14:13:40,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:13:41,529 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 14:13:41,531 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:13:47,044 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 149
2025-11-12 14:13:47,045 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:13:48,194 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Timmermanns GmbH LB61521 WBSBT91010LB61521 ohne Termin.
2025-11-12 14:13:48,232 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
2025-11-12 14:13:48,237 - ispa_next.main - DEBUG - 



2025-11-12 14:13:48,237 - ispa_next.main - DEBUG - starting with process 16 (F-CG 723) of 16
2025-11-12 14:13:48,241 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:13:49,825 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:13:51,701 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 14:13:51,702 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 149
2025-11-12 14:13:53,875 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:13:53,876 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:14:34,306 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:14:37,292 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 14:14:44,733 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:14:46,769 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:14:46,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:46,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:14:47,321 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:14:47,325 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:14:50,537 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:14:50,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:14:52,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:14:54,577 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:14:54,727 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:14:54,895 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:14:55,043 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:14:59,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 14:15:00,370 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:15:00,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:15:01,322 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:15:22,032 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:15:28,755 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:15:28,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:15:28,892 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:15:28,893 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:15:28,992 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:15:30,730 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:15:31,383 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:15:33,781 - ispa_next.functions - DEBUG - Updated appointment (AB00014549) customer contact data.
2025-11-12 14:15:34,734 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:15:34,762 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:15:35,958 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:15:35,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:15:37,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:15:41,050 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:15:41,050 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 14:15:41,053 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:15:41,056 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:15:41,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:15:41,592 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:15:50,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:15:51,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:15:51,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:15:51,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:15:51,933 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:15:53,950 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:15:53,952 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:15:55,676 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:15:55,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:15:55,681 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-12 14:15:55,682 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:15:55,683 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:15:55,686 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:15:55,687 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 14:15:55,688 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:15:55,691 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:15:55,692 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:15:55,694 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:15:55,698 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:15:55,700 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:15:55,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:57,792 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:15:57,793 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:15:57,796 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:59,944 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:15:59,946 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:15:59,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 14:16:01,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 14:16:01,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:16:17,392 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:16:17,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:16:19,581 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:16:33,376 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:16:33,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:16:34,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:16:34,922 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:16:54,988 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:17:01,574 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:17:01,576 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:17:01,577 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:17:02,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:17:02,495 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:17:02,498 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:17:04,919 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:17:16,511 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:17:16,962 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 14:17:18,378 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:17:19,644 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 390
2025-11-12 14:17:19,645 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:17:25,133 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 149
2025-11-12 14:17:25,134 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:17:26,377 - ispa_next.appointments.models - DEBUG - Appointment Astoria Automobile GmbH S-EA 1709 WBA1A11040J149413 ohne Termin.
