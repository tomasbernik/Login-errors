2025-11-12 12:02:37,820 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:02:37,841 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:02:51,349 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:03:07,620 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:03:23,458 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:05:24,484 - ispa_next.app_start.main - DEBUG - Operation already took 109.57 seconds (more than 80 seconds)
2025-11-12 12:05:26,590 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_qtfsfxc1_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_qtfsfxc1', 'txt']
2025-11-12 12:05:27,167 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:05:27,171 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:05:27,172 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:07:28,956 - ispa_next.app_start.main - DEBUG - Operation already took 109.31 seconds (more than 80 seconds)
2025-11-12 12:07:31,027 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_fsdzx9ir_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_fsdzx9ir', 'txt']
2025-11-12 12:07:31,359 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:07:31,364 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:07:35,482 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 12:07:49,816 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:08:00,437 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:08:16,333 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:10:16,286 - ispa_next.app_start.main - DEBUG - Operation already took 108.84 seconds (more than 80 seconds)
2025-11-12 12:10:18,403 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_ym4khws3_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_ym4khws3', 'txt']
2025-11-12 12:10:18,730 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:10:18,735 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:10:18,736 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:12:19,911 - ispa_next.app_start.main - DEBUG - Operation already took 108.82 seconds (more than 80 seconds)
2025-11-12 12:12:22,000 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_wrjdtiul_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_wrjdtiul', 'txt']
2025-11-12 12:12:22,313 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:12:22,318 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:12:26,497 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 12:12:36,633 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:12:49,108 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:13:04,940 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:15:05,153 - ispa_next.app_start.main - DEBUG - Operation already took 109.12 seconds (more than 80 seconds)
2025-11-12 12:15:07,249 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_s6jgpctc_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\f1b9208f7c43988a\\tess_s6jgpctc', 'txt']
2025-11-12 12:15:07,574 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:15:07,578 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:15:07,580 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:15:41,955 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:15:59,558 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:16:04,300 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:16:05,974 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 12:16:05,976 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:16:11,988 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 365
2025-11-12 12:16:11,989 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:16:11,989 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:16:13,818 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:16:15,307 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:17:27,705 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:17:27,725 - ispa_next.appointments.models - DEBUG - Appointment Herr Marco Franke EBN-M 1966 WBAJM71060G961383 ohne Termin.
2025-11-12 12:17:27,734 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,735 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,743 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,748 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,764 - ispa_next.appointments.models - DEBUG - Appointment Siegfried Geißler  WBA51EG0505W23667 ohne Termin.
2025-11-12 12:17:27,776 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,777 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,804 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,818 - ispa_next.appointments.models - DEBUG - Appointment Frau Alexandra Wolf BA-AW 555 WBY8P210607K30883 ohne Termin.
2025-11-12 12:17:27,819 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,819 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,819 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,820 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,821 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,822 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,859 - ispa_next.appointments.models - DEBUG - Appointment Gasthof Dinkel LIF-JD 555 WBSJF010X0G965188 ohne Termin.
2025-11-12 12:17:27,889 - ispa_next.appointments.models - DEBUG - Appointment Firma Minges Kaffeerösterei GmbH BA-MK 540 WBA11GR0409Y69237 ohne Termin.
2025-11-12 12:17:27,896 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,896 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,952 - ispa_next.appointments.models - DEBUG - Appointment Herr Bastian Stern HÖS-S 1312 WBA4J51020BN80220 ohne Termin.
2025-11-12 12:17:27,961 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,961 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:27,986 - ispa_next.appointments.models - DEBUG - Appointment Herr Stephan Nätscher BA-MN 1019 WBA7K310307J40556 ohne Termin.
2025-11-12 12:17:28,011 - ispa_next.appointments.models - DEBUG - Appointment Firma Kraftanlagen Energies & M-KA 2446 WBA41EG0905Z23353 ohne Termin.
2025-11-12 12:17:28,116 - ispa_next.appointments.models - DEBUG - Appointment Frau Franziska Berg BA-JP 1720 WMWLN710202E75045 ohne Termin.
2025-11-12 12:17:28,128 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:28,144 - ispa_next.appointments.models - DEBUG - Appointment Herr Jürgen Manfred Suppe BA-SU 380 WBY61EF0305W96365 ohne Termin.
2025-11-12 12:17:28,157 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Kirsch BA-BK 746 WBA2E510205G50991 ohne Termin.
2025-11-12 12:17:28,158 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:28,173 - ispa_next.appointments.models - DEBUG - Appointment Firma Andreas Wagner Vertriebs GmbH HAS-W 3690 WBA15BZ070N298504 ohne Termin.
2025-11-12 12:17:28,210 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:28,259 - ispa_next.appointments.models - DEBUG - Appointment Firma Erlanger Treuhand GmbH ER-TR 70E WBA21GV020CU74535 ohne Termin.
2025-11-12 12:17:28,274 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:28,325 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:28,347 - ispa_next.appointments.models - DEBUG - Appointment Frau Aslihan Karaman NÖ-AK 5252 WBAHT710305K01893 ohne Termin.
2025-11-12 12:17:28,364 - ispa_next.appointments.models - DEBUG - Appointment Generalstaatsanwaltschaft BA-N 1017E WBA51BX0607T37782 ohne Termin.
2025-11-12 12:17:28,384 - ispa_next.appointments.models - DEBUG - Appointment Herr Josef Reuß KG-TR 899 WBA8H91030A719314 ohne Termin.
2025-11-12 12:17:28,400 - ispa_next.appointments.models - DEBUG - Appointment Firma Elektro Weis GmbH & Co. KG BA-XX 621 WMW61DL0503P86044 ohne Termin.
2025-11-12 12:17:28,421 - ispa_next.appointments.models - DEBUG - Appointment Frau Birgitta Helmstetter BA-A 607 WBA7K310507K49097 ohne Termin.
2025-11-12 12:17:28,449 - ispa_next.appointments.models - DEBUG - Appointment Herr Wolfgang Kießwetter BA-CL 16 WBA4A51060D408079 ohne Termin.
2025-11-12 12:17:28,485 - ispa_next.appointments.models - DEBUG - Appointment Firma bornheim GmbH & Co. KG BA-M 180 WBA11GF0107R40264 ohne Termin.
2025-11-12 12:17:28,501 - ispa_next.appointments.models - DEBUG - Appointment Herr Adam Jacek Kesminowicz BA-KA 91 WBAHT710505J98589 ohne Termin.
2025-11-12 12:17:28,516 - ispa_next.appointments.models - DEBUG - Appointment Frau Inge Kimbrough WUN-NY 111 WBA31AD0303L79467 ohne Termin.
2025-11-12 12:17:28,532 - ispa_next.appointments.models - DEBUG - Appointment Herr Peter Kupsch BA-PK 12 WBAHS910805H68893 ohne Termin.
2025-11-12 12:17:28,546 - ispa_next.appointments.models - DEBUG - Appointment Frau Jennifer Crayne ERH-JD 604 WMW51DK0102T47698 ohne Termin.
2025-11-12 12:17:28,547 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:17:28,561 - ispa_next.appointments.models - DEBUG - Appointment Herr Rainer Andreas Rebel BA-TR 2003 WBAPP11070E794980 ohne Termin.
2025-11-12 12:17:28,575 - ispa_next.appointments.models - DEBUG - Appointment Herr Mohammad Al Ahmad BA-SY 222 WBA8T31090BX94248 ohne Termin.
2025-11-12 12:17:28,589 - ispa_next.appointments.models - DEBUG - Appointment Herr Mario Kämpf ASL-MH 810 WBA11AB0005U74034 ohne Termin.
2025-11-12 12:17:28,603 - ispa_next.appointments.models - DEBUG - Appointment Frau Martina Zeißler EBS-MZ 181 WBA1S510605A79963 ohne Termin.
2025-11-12 12:17:28,620 - ispa_next.appointments.models - DEBUG - Appointment Firma MG-Nährmittel Produktservice BA-M 8013 WBSAE01020CE87488 ohne Termin.
2025-11-12 12:17:28,634 - ispa_next.appointments.models - DEBUG - Appointment Herr Alexander Erdpohl BA-AE 779 WBA8H91000K868189 ohne Termin.
2025-11-12 12:17:28,732 - ispa_next.main - DEBUG - Found 15 out of 215 appointments to process (configured limit: 15).
2025-11-12 12:17:28,733 - ispa_next.main - DEBUG - Processing 10 fresh appointments.
2025-11-12 12:17:28,733 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 12:17:28,733 - ispa_next.main - DEBUG - All appointments: BA-F 910, BA-JD 9953, FO-MO 9, FO-HF 333, ERH-CR 818, BA-KM 312E, BA-DR 91, BA-PG 21, BA-XD 240, BA-KN 44, FO-MX 186, BA-CT 97, BA-PM 1007, BA-EK 33, BA-FS 2002
2025-11-12 12:17:28,736 - ispa_next.main - DEBUG - 



2025-11-12 12:17:28,736 - ispa_next.main - DEBUG - starting with process 1 (BA-F 910) of 15
2025-11-12 12:17:28,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:17:30,168 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:17:32,747 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 12:17:32,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 365
2025-11-12 12:17:36,181 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:17:36,183 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:11,307 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:18:22,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:18:24,265 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:18:24,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:18:24,407 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:18:24,640 - ispa_next.functions - DEBUG - HU date already expired after 2277 days.
2025-11-12 12:18:33,478 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:18:33,486 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:18:33,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:18:33,597 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:18:45,865 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:18:45,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:18:47,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:18:49,012 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:18:49,191 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:18:52,513 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:18:52,600 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:18:56,801 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:18:57,809 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:18:57,810 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:18:58,408 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:12,725 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:19:21,614 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:19:21,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:21,777 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:21,778 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:19:21,824 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:19:22,003 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:19:23,893 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:19:24,336 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:19:29,671 - ispa_next.functions - DEBUG - Updated appointment (AC00041366) customer contact data.
2025-11-12 12:19:30,617 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:19:30,624 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:19:30,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:19:31,837 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:19:33,589 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:19:33,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:19:33,733 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:19:38,403 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:38,403 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:19:38,412 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:19:38,413 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:19:38,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:39,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:43,313 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:19:43,319 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:19:43,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:43,450 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:19:43,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:44,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:44,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:45,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:45,386 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:19:48,108 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:19:48,110 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:19:49,345 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:19:49,348 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:19:49,354 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:19:49,355 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:19:49,367 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:19:49,370 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:19:49,370 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:19:49,376 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:19:49,377 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:19:49,383 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:19:49,386 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:19:50,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:19:51,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:20:07,085 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:20:07,093 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:20:07,099 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:20:07,100 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:09,752 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:20:09,760 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:20:09,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:12,392 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:20:12,393 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:20:12,395 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:15,157 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:20:15,163 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:20:15,168 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:17,823 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:20:40,033 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:20:40,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:20:41,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:20:41,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:08,894 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:13,884 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:19,570 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:19,575 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:21:19,575 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:20,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:20,562 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:21:20,568 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:21:23,186 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:21:36,548 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:21:36,956 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:21:38,023 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:40,033 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 12:21:40,035 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:43,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:21:43,511 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:21:44,599 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:21:44,613 - ispa_next.main - DEBUG - Found new Appointment: BA-A 68E
2025-11-12 12:21:44,615 - ispa_next.main - DEBUG - 



2025-11-12 12:21:44,615 - ispa_next.main - DEBUG - starting with process 2 (BA-A 68E) of 16
2025-11-12 12:21:44,624 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:46,119 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:47,809 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1636
2025-11-12 12:21:47,810 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:21:49,764 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:49,765 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:28,814 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:22:31,321 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:22:37,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:39,974 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:22:39,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:40,111 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:40,397 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:22:40,404 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:22:40,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:40,597 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:43,984 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:22:43,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:45,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:47,459 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:22:47,640 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:22:47,867 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:22:47,970 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:22:52,275 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:22:53,286 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:22:53,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:53,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:08,612 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:23:13,887 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:23:13,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:13,997 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:13,998 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:23:14,081 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:23:15,804 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:23:16,186 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:23:19,571 - ispa_next.functions - DEBUG - Updated appointment (AC00041365) customer contact data.
2025-11-12 12:23:20,562 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:23:20,570 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:23:21,618 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:23:21,619 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:22,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:23:26,142 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:26,142 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:23:26,147 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:23:26,148 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:23:26,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:26,710 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:30,869 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:23:30,878 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:23:30,879 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:31,027 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:23:40,104 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 12:23:46,174 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 12:23:46,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:46,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:46,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:47,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:47,733 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:23:50,333 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:23:50,336 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:23:52,758 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:23:52,759 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:23:52,764 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:23:52,765 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:23:52,772 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:23:52,773 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:23:52,774 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:23:52,781 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:23:52,782 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:23:52,788 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:23:52,800 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:23:52,809 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:23:52,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:55,654 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:23:55,660 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:23:55,664 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:58,437 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:23:58,437 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:23:58,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:01,245 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:24:01,251 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:24:01,254 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:04,089 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:24:20,975 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:24:21,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:24:22,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:24:22,765 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:48,965 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:24:53,995 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:00,116 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:00,124 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:25:00,125 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:00,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:25:01,106 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:25:01,112 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:25:03,689 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:25:15,180 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:25:15,591 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:25:16,414 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:18,640 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1638
2025-11-12 12:25:18,642 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:22,766 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:25:22,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:25:23,918 - ispa_next.appointments.models - DEBUG - Appointment Frau Bettina aus dem Spring ER-KE 39 WBAYH310805X81507 ohne Termin.
2025-11-12 12:25:23,940 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:25:23,964 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:25:23,971 - ispa_next.main - DEBUG - 



2025-11-12 12:25:23,972 - ispa_next.main - DEBUG - starting with process 3 (BA-JD 9953) of 16
2025-11-12 12:25:23,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:25,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:25:27,382 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1638
2025-11-12 12:25:27,384 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:25:29,368 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:25:29,370 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:09,098 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:26:21,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:22,453 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:26:22,454 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:22,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:26:22,945 - ispa_next.functions - DEBUG - HU date soon to be invalid in 6 days.
2025-11-12 12:26:31,689 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:26:31,697 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:26:31,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:26:31,794 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:26:44,185 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:26:44,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:26:46,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:26:48,059 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:26:48,219 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:26:48,351 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:26:48,430 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:26:48,432 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:26:49,913 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:27:01,769 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:27:07,160 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:27:07,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:08,466 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:27:12,743 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:27:13,749 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:27:13,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:14,317 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:29,628 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:27:29,629 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:27:38,296 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:27:38,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:38,408 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:27:38,409 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:27:38,505 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:27:40,057 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:27:41,637 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:27:41,990 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:27:46,323 - ispa_next.functions - DEBUG - Updated appointment (AA00043453) customer contact data.
2025-11-12 12:27:47,294 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:27:47,307 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:27:48,338 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:27:48,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:27:49,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:27:53,743 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:27:53,744 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:53,744 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:27:53,749 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:27:53,749 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:27:53,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:54,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:58,501 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:27:58,508 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:27:58,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:58,628 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:27:59,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:59,719 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:59,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:00,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:00,497 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:28:01,950 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:28:01,952 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:28:03,021 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:28:03,023 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:28:03,028 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:28:03,030 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:28:03,036 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:28:03,037 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:28:03,039 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:28:03,045 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:28:03,046 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:28:03,057 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:28:03,059 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:28:03,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:28:04,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:28:21,045 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:28:21,069 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:28:21,076 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:28:21,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:22,463 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:28:22,470 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:28:22,488 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:23,778 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:28:23,778 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:28:23,781 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:25,089 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:28:25,095 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:28:25,113 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:26,387 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:28:45,657 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:28:46,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:28:47,358 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:28:47,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:01,308 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:29:01,312 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:29:01,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:29:02,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:29:02,366 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:29:02,372 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:29:05,006 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:29:18,832 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:29:19,264 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:29:20,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:22,715 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:29:22,717 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:26,533 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 479
2025-11-12 12:29:26,534 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:29:27,679 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:29:27,697 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:29:27,703 - ispa_next.main - DEBUG - Found new Appointment: ER-KE 39
2025-11-12 12:29:27,704 - ispa_next.main - DEBUG - 



2025-11-12 12:29:27,704 - ispa_next.main - DEBUG - starting with process 4 (ER-KE 39) of 17
2025-11-12 12:29:27,712 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:29:29,187 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:29:30,845 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:29:30,847 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 479
2025-11-12 12:29:33,130 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:29:33,131 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:30:11,079 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:30:22,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:23,003 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:30:23,193 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:24,717 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:30:24,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:24,794 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:30:25,120 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:30:25,129 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:30:25,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:25,339 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:30:28,701 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:30:28,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:30:30,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:30:32,246 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:30:32,428 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:30:35,712 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:30:35,831 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:30:35,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:30:37,241 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:30:46,375 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:30:47,381 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:30:47,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:30:47,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:31:04,147 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:31:13,979 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:31:13,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:31:14,173 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:31:14,174 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:31:14,213 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:31:15,636 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:31:17,663 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 12:31:19,106 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 12:31:19,624 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:31:24,455 - ispa_next.functions - DEBUG - Updated appointment (AC00041368) customer contact data.
2025-11-12 12:31:25,389 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:31:25,434 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:31:26,633 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:31:26,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:31:27,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:31:31,272 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:31:31,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:31:31,816 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:31:33,818 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:31:33,989 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:31:34,220 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:31:34,335 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:31:34,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:31:35,686 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:31:44,583 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:32:44,585 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:32:56,175 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:33:00,795 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:33:00,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:02,669 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:33:06,917 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:33:07,924 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:33:07,925 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:33:07,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:08,011 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:33:12,181 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:33:12,188 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:33:12,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:12,313 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:33:21,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:22,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:22,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:23,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:23,063 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:33:24,434 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:33:24,437 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:33:25,601 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:33:25,604 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:33:25,611 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:33:25,612 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:33:25,619 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:33:25,621 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:33:25,622 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:33:25,628 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:33:25,629 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:33:25,635 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:33:25,637 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:33:26,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:33:27,269 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:33:43,466 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:33:43,480 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:33:43,484 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:33:43,485 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:44,872 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:33:44,879 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:33:44,897 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:46,199 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:33:46,199 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:33:46,201 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:47,574 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:33:47,578 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:33:47,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:48,904 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:34:08,135 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:34:08,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:34:09,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:34:10,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:34:23,078 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:34:23,085 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:34:23,086 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:23,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:34:24,090 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:34:24,096 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:34:27,339 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:34:38,620 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:34:39,009 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:34:40,165 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:42,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:34:42,389 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:46,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:34:46,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:34:47,486 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:34:47,524 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:34:47,554 - ispa_next.main - DEBUG - 



2025-11-12 12:34:47,554 - ispa_next.main - DEBUG - starting with process 5 (FO-MO 9) of 17
2025-11-12 12:34:47,563 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:34:49,098 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:34:50,917 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:34:50,918 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:34:53,013 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:34:53,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:35:26,821 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:35:39,261 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:40,547 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:35:40,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:40,648 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:40,957 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:35:40,967 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:35:40,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:41,149 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:35:44,500 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:35:44,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:46,150 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:35:48,153 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:35:48,305 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:35:48,451 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:35:48,583 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:35:48,585 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:50,102 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:36:01,053 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:36:05,903 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:36:05,904 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:07,229 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:36:11,438 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:36:12,449 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:36:12,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:13,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:28,292 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:36:28,292 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:36:38,282 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:36:38,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:36:38,436 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:36:38,437 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:36:38,536 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:36:40,002 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:36:40,387 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:36:44,865 - ispa_next.functions - DEBUG - Updated appointment (AA00043452) customer contact data.
2025-11-12 12:36:45,893 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:36:45,901 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:36:47,206 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:36:47,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:36:48,235 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:36:51,877 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:36:51,877 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:36:51,883 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:36:51,884 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:36:51,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:52,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:56,636 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:36:56,647 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:36:56,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:56,928 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:37:02,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:03,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:37:03,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:37:04,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:37:04,392 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:37:05,821 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:37:05,823 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:37:07,302 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:37:07,304 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:37:07,310 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:37:07,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:37:07,318 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:37:07,319 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:37:07,320 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:37:07,326 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:37:07,327 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:37:07,334 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:37:07,337 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:37:08,184 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:37:09,006 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:37:25,560 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:37:25,566 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:37:25,572 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:37:25,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:26,873 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:37:26,879 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:37:26,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:28,236 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:37:28,236 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:37:28,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:29,600 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:37:29,607 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:37:29,610 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:30,912 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:37:50,152 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:37:50,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:51,897 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:37:52,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:38:06,009 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:38:06,014 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:38:06,014 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:06,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:38:07,043 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:38:07,048 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:38:09,781 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:38:21,399 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:38:21,794 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:38:23,057 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:25,333 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:38:25,334 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:29,677 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:38:29,678 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:31,224 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:38:31,241 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:38:31,254 - ispa_next.main - DEBUG - 



2025-11-12 12:38:31,255 - ispa_next.main - DEBUG - starting with process 6 (FO-HF 333) of 17
2025-11-12 12:38:31,263 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:32,828 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:34,641 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:38:34,642 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:38:36,957 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:36,959 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:11,413 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:39:23,798 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:27,899 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:39:27,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:27,977 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:39:28,326 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:39:28,335 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:39:28,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:28,610 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:39:32,120 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:39:32,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:33,605 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:39:35,608 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:39:35,852 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:39:36,458 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:39:36,619 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:39:40,877 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:39:41,885 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:39:41,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:42,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:57,629 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:39:57,630 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:40:06,810 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:40:06,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:40:06,967 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:40:06,968 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:40:07,010 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:40:08,836 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:40:10,273 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:40:10,643 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:40:15,070 - ispa_next.functions - DEBUG - Updated appointment (AA00043450) customer contact data.
2025-11-12 12:40:15,999 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:40:16,007 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:40:17,137 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:40:17,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:40:18,623 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:40:22,283 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:40:22,284 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:40:22,292 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:40:22,292 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:40:22,293 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:40:22,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:40:26,998 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:40:28,042 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:40:48,739 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:40:48,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:40:48,910 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:40:53,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:40:53,871 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:40:53,873 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:40:54,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:40:54,946 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:40:58,940 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:40:58,943 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:41:01,086 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:41:01,092 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:01,099 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:41:01,102 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:01,109 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:41:01,110 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:41:01,111 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:41:01,118 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:41:01,119 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:41:01,125 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:41:01,127 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:41:02,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:41:03,483 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:41:25,050 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:41:25,077 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:41:25,081 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:41:25,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:29,320 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:41:29,326 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:41:29,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:41:33,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:34,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:45,401 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:05,117 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:42:05,117 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:42:05,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:09,348 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:42:09,355 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:42:09,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:13,718 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:42:45,139 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:42:46,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:42:47,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:42:47,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:43:31,530 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:43:41,896 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:43:55,298 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:43:55,299 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:57,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:43:57,243 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:43:57,249 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:44:07,158 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:44:29,180 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:44:29,617 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:44:36,322 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:38,081 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:44:38,083 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:46,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:44:46,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:47,946 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:44:47,963 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:44:47,972 - ispa_next.main - DEBUG - 



2025-11-12 12:44:47,972 - ispa_next.main - DEBUG - starting with process 7 (ERH-CR 818) of 17
2025-11-12 12:44:47,978 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:44:50,807 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:44:54,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:44:54,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:44:58,421 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:44:58,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:45:38,563 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:45:57,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:59,616 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:45:59,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:59,815 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:46:00,424 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:46:00,436 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:46:00,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:00,598 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:46:19,768 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:46:19,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:46:22,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:46:24,082 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:46:24,310 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:46:24,563 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:46:24,769 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:46:24,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:26,948 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:46:38,616 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:46:44,705 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:46:44,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:48,152 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:46:52,443 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:46:53,454 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:46:53,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:46:54,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:16,746 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:47:16,747 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:47:31,213 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:47:31,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:31,384 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:47:31,385 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:47:31,547 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:47:31,816 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:47:34,160 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:47:34,531 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:47:39,668 - ispa_next.functions - DEBUG - Updated appointment (AA00043449) customer contact data.
2025-11-12 12:47:41,281 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:47:41,291 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:47:41,754 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:47:44,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:47:47,479 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:47:47,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:47:47,615 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:47:51,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:47:51,340 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:47:51,345 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:47:51,346 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:47:51,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:47:51,960 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:47:56,189 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:47:56,195 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:47:56,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:47:56,355 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:47:56,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:57,364 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:57,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:47:58,618 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:47:58,623 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:48:01,366 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:48:01,368 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:48:03,108 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:48:03,111 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:48:03,123 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:48:03,126 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:48:03,136 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:48:03,138 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:48:03,140 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:48:03,146 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:48:03,148 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:48:03,153 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:48:03,156 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:48:04,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:48:05,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:48:24,070 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:48:24,078 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:48:24,082 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:48:24,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:26,921 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:48:26,927 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:48:26,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:29,662 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:48:29,663 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:48:29,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:32,556 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:48:32,562 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:48:32,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:48:35,458 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:49:11,910 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:49:13,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:49:14,628 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:49:15,048 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:46,399 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:56,212 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:50:09,148 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:50:09,149 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:50:10,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:50:11,065 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:50:11,071 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:50:21,516 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:50:42,371 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:50:42,869 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:50:44,669 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:50:52,665 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:50:52,667 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:51:01,381 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:51:01,383 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:51:03,133 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:51:03,154 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:51:03,163 - ispa_next.main - DEBUG - 



2025-11-12 12:51:03,163 - ispa_next.main - DEBUG - starting with process 8 (BA-KM 312E) of 17
2025-11-12 12:51:03,169 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:51:06,086 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:51:09,337 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:51:09,339 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:51:13,340 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:51:13,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:52:06,779 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:52:26,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:31,518 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:52:31,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:31,656 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:52:32,534 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:52:32,543 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:52:32,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:32,696 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:52:36,672 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:52:36,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:38,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:52:40,885 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:52:41,077 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:52:41,337 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:52:41,590 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:52:45,852 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:52:46,863 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:52:46,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:47,419 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:08,677 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:53:24,232 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:53:24,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:24,437 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:53:24,438 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:53:24,572 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:53:26,333 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:53:26,689 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:53:31,972 - ispa_next.functions - DEBUG - Updated appointment (AA00043447) customer contact data.
2025-11-12 12:53:33,221 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:53:33,230 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:53:37,906 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:53:37,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:53:39,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:53:43,374 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:53:43,374 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:53:43,379 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:53:43,380 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:53:43,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:53:44,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:53:48,334 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:53:48,341 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:53:48,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:53:48,510 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:53:54,175 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:54,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:54,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:53:56,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:53:56,209 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:54:00,952 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:54:00,955 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:54:03,186 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:54:03,188 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:54:03,194 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:54:03,195 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:54:03,202 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:54:03,204 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=BMW Sicher in den Winter, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 12:54:03,205 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:54:03,211 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:54:03,213 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:54:03,220 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:54:03,222 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 12:54:04,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:54:05,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:54:27,391 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:54:27,424 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:54:27,428 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:54:27,428 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:32,521 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:54:32,527 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:54:32,530 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:37,574 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:54:37,575 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 12:54:37,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:42,588 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:54:42,592 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:54:42,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:54:47,663 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:55:22,203 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:55:23,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:55:24,864 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:55:25,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:56:15,542 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:56:25,047 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:56:33,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:56:43,945 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:56:53,517 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:57:07,564 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:57:07,565 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:57:09,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:57:09,560 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:57:09,565 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:57:19,200 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:57:41,939 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:57:42,477 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:57:44,627 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:57:51,494 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:57:51,496 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:57:59,235 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 12:57:59,236 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:58:01,116 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 12:58:01,133 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 12:58:01,141 - ispa_next.main - DEBUG - 



2025-11-12 12:58:01,141 - ispa_next.main - DEBUG - starting with process 9 (BA-DR 91) of 17
2025-11-12 12:58:01,147 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:58:03,984 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:58:07,238 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 12:58:07,240 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 12:58:11,410 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:58:11,412 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:59:05,680 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:59:24,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:26,110 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:59:26,111 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:26,243 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:26,770 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:59:26,781 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:59:26,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:26,949 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:45,467 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:59:45,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:59:47,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:59:49,985 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:59:50,182 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:59:50,540 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:59:51,325 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:59:51,327 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:52,764 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:00:04,445 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:00:10,925 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:00:10,927 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:12,425 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:00:16,755 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:00:17,763 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:00:17,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:18,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:41,206 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:00:41,206 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:00:56,530 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:00:56,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:56,743 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:00:56,744 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:00:56,827 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:00:57,081 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:00:58,930 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:00:59,286 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:01:04,549 - ispa_next.functions - DEBUG - Updated appointment (AA00043441) customer contact data.
2025-11-12 13:01:05,655 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:01:05,705 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:01:06,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:01:07,926 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:01:11,220 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:01:11,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:01:11,472 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:01:15,670 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:01:15,671 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:01:15,671 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:01:15,679 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:01:15,680 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:01:15,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:01:16,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:01:20,599 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:01:20,606 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:01:20,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:01:20,783 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:01:21,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:01:21,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:01:21,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:01:22,900 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:01:22,907 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:01:25,149 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:01:25,151 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:01:27,252 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:01:27,254 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:01:27,260 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:01:27,261 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:01:27,268 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:01:27,270 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 13:01:27,271 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:01:27,278 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:01:27,279 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:01:27,288 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:01:27,290 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 13:01:28,249 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:01:29,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:01:49,523 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:01:49,528 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:01:49,532 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:01:49,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:51,934 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:01:51,938 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:01:51,941 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:54,109 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:01:54,109 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:01:54,112 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:56,216 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:01:56,222 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:01:56,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:58,370 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:02:31,827 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:02:33,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:02:34,456 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:02:34,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:02:59,532 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:03:09,515 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:03:09,519 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:03:09,520 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:03:11,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:03:11,476 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:03:11,483 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:03:16,258 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:03:40,065 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:03:40,520 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 13:03:42,457 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:03:50,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 13:03:50,460 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:03:59,222 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 13:03:59,223 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:04:01,010 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:04:01,028 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 13:04:01,038 - ispa_next.main - DEBUG - 



2025-11-12 13:04:01,039 - ispa_next.main - DEBUG - starting with process 10 (BA-PG 21) of 17
2025-11-12 13:04:01,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:04:03,931 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:04:07,460 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1639
2025-11-12 13:04:07,462 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 13:04:11,509 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:04:11,511 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:05:14,776 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:05:33,543 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:05:34,859 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:05:34,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:35,031 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:05:35,606 - ispa_next.functions - DEBUG - HU date already expired after 630 days.
2025-11-12 13:05:49,977 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:05:49,982 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:05:49,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:05:50,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:05:54,270 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:05:54,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:05:57,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:05:59,016 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:05:59,233 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:06:02,632 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:06:03,633 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:06:03,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:06:05,148 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:06:15,987 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:06:16,995 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:06:16,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:17,630 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:39,966 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:06:39,966 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:06:55,257 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:06:55,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:06:55,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:06:55,423 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:06:55,581 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:06:57,281 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:06:57,626 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:07:03,857 - ispa_next.functions - DEBUG - Updated appointment (AA00043436) customer contact data.
2025-11-12 13:07:04,979 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:07:04,987 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:07:07,199 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:07:07,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:07:08,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:07:12,915 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:07:12,916 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:07:12,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:13,512 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:07:15,517 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:07:15,773 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:07:16,015 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:07:16,398 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:07:16,400 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:07:17,768 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:07:29,379 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:07:35,777 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:07:35,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:07:37,238 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:07:41,539 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:07:42,547 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:07:42,548 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:07:42,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:42,713 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:07:46,946 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:07:46,953 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:07:46,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:47,112 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:07:51,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:52,125 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:07:52,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:07:53,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:07:53,382 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:07:54,998 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:07:55,000 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:07:57,050 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:07:57,052 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:07:57,062 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:07:57,070 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:07:57,078 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:07:57,082 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 13:07:57,083 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:07:57,089 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:07:57,091 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:07:57,097 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:07:57,099 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 13:07:58,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:07:59,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:08:21,360 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:08:21,366 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:08:21,373 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:08:21,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:22,765 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:08:22,771 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:08:22,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:24,107 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:08:24,107 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:08:24,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:25,542 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:08:25,548 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:08:25,551 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:08:26,927 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:09:00,316 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:09:01,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:09:03,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:09:03,520 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:09:21,267 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:09:21,275 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:09:21,276 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:09:23,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:09:23,195 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:09:23,201 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:09:28,079 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:09:48,790 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:09:49,208 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 13:09:50,959 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:09:58,459 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1640
2025-11-12 13:09:58,462 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:10:06,370 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 13:10:06,371 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:10:08,203 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:10:08,221 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 13:10:08,229 - ispa_next.main - DEBUG - 



2025-11-12 13:10:08,229 - ispa_next.main - DEBUG - starting with process 11 (BA-XD 240) of 17
2025-11-12 13:10:08,235 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:10:11,125 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:10:14,605 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1640
2025-11-12 13:10:14,607 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 13:10:18,928 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:10:18,930 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:11:13,586 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:11:33,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:11:37,221 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:11:37,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:37,421 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:11:38,202 - ispa_next.functions - DEBUG - HU date already expired after 354 days.
2025-11-12 13:11:53,278 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:11:53,284 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:11:53,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:11:53,444 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:12:12,678 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:12:12,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:12:14,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:12:16,974 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:12:17,261 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:12:17,464 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:12:17,672 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:12:21,980 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:12:22,987 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:12:22,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:23,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:12:46,849 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:12:46,850 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:13:05,769 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:13:05,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:05,922 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:13:05,923 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:13:06,046 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:13:08,405 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:13:10,226 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:13:10,589 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:13:17,386 - ispa_next.functions - DEBUG - Updated appointment (AA00043433) customer contact data.
2025-11-12 13:13:18,528 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:13:18,544 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:13:20,796 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:13:20,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:13:22,477 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:13:26,101 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:13:26,102 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:13:26,111 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:13:26,112 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:13:26,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:26,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:30,981 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:13:32,959 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 13:13:49,943 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:13:49,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:50,104 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:13:50,568 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:52,508 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:13:52,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:13:53,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:13:53,701 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:13:57,160 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:13:57,162 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:13:59,389 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:13:59,391 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:59,398 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:13:59,399 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:13:59,407 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:13:59,409 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 13:13:59,411 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:13:59,418 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:13:59,451 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:13:59,483 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:13:59,485 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 13:14:00,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:14:01,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:14:21,508 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:14:21,513 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:14:21,517 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:14:21,518 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:25,017 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 13:14:31,178 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:14:31,223 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:14:31,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:35,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:14:35,640 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:14:49,175 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:14:49,175 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:14:49,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:52,931 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:14:52,938 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:14:52,941 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:14:56,590 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:15:27,538 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:15:28,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:15:29,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:15:30,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:16:07,648 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:16:17,949 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:16:31,165 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:16:31,166 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:16:32,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:16:33,123 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:16:33,130 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:16:43,645 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 13:17:05,558 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:17:05,951 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 13:17:13,221 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:15,185 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1641
2025-11-12 13:17:15,187 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:23,244 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 477
2025-11-12 13:17:23,245 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:17:25,142 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:17:25,159 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 13:17:25,168 - ispa_next.main - DEBUG - 



2025-11-12 13:17:25,168 - ispa_next.main - DEBUG - starting with process 12 (BA-KN 44) of 17
2025-11-12 13:17:25,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:17:28,065 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:17:31,448 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1641
2025-11-12 13:17:31,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 477
2025-11-12 13:17:35,630 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:17:35,631 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:18:33,267 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:18:53,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:18:54,459 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:18:54,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:54,647 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:55,183 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:18:55,191 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:18:55,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:18:55,377 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:18:59,786 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:18:59,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:19:02,355 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:19:04,359 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:19:04,577 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:19:04,852 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:19:05,020 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:19:09,419 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:19:10,427 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:19:10,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:11,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:31,909 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 13:19:47,980 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:19:47,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:19:48,156 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:19:48,157 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:19:48,309 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:19:49,971 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:19:50,337 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:19:55,920 - ispa_next.functions - DEBUG - Updated appointment (AA00043423) customer contact data.
2025-11-12 13:19:58,246 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:19:58,253 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:20:00,553 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:20:00,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:20:02,199 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:20:06,396 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:20:06,396 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:20:06,396 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:20:06,401 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:20:06,402 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:20:06,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:07,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:20:11,234 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:20:11,241 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:20:11,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:11,431 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:20:21,005 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 13:20:30,953 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 13:20:31,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:32,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:20:32,106 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:20:33,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:20:33,836 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:20:35,414 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:20:35,417 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:20:37,290 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:20:37,292 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:20:37,303 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-12 13:20:37,306 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:20:37,313 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:20:37,315 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 13:20:37,316 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:20:37,322 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:20:37,323 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:20:37,331 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:20:37,333 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 13:21:01,961 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:21:02,208 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 13:21:03,735 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:21:05,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:21:25,116 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:21:25,117 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-12 13:21:39,396 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:21:39,404 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:21:39,405 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:41,627 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:21:41,634 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:21:41,636 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:43,801 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:21:43,801 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:21:43,804 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:45,953 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:21:45,959 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:21:45,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:21:48,111 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:22:21,485 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:22:22,781 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:22:24,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:22:24,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:22:49,227 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:22:59,811 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:22:59,816 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:22:59,817 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:23:01,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:23:01,919 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:23:01,926 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:23:06,661 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:23:28,978 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:23:29,404 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 13:23:31,955 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:23:38,097 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1644
2025-11-12 13:23:38,099 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:23:46,549 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 478
2025-11-12 13:23:46,550 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:23:48,392 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:23:48,412 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:23:48,429 - ispa_next.appointments.models - DEBUG - Appointment Herr Thomas Josef Meier BA-TM 1064 WBAUZ35000ND21184 ohne Termin.
2025-11-12 13:23:48,436 - ispa_next.main - DEBUG - 



2025-11-12 13:23:48,436 - ispa_next.main - DEBUG - starting with process 13 (FO-MX 186) of 17
2025-11-12 13:23:48,442 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:23:51,347 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:23:54,833 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1644
2025-11-12 13:23:54,835 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 478
2025-11-12 13:23:59,006 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:23:59,007 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:24:58,845 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:25:03,750 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:25:13,445 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:25:15,542 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:25:15,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:15,684 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:16,254 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 13:25:25,806 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:25:25,814 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:25:25,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:26,006 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:25:40,161 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:25:40,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:25:42,601 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:25:44,604 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:25:44,820 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:25:45,111 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:25:45,369 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:25:49,644 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:25:50,651 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:25:50,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:25:51,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:16,635 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:26:27,349 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:26:27,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:27,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:26:27,484 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:26:27,572 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:26:29,222 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:26:29,637 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:26:33,844 - ispa_next.functions - DEBUG - Updated appointment (AC00040980) customer contact data.
2025-11-12 13:26:35,041 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:26:35,050 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:26:37,980 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:26:37,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:26:39,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:26:43,989 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:26:43,990 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:26:43,998 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:26:43,999 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:26:44,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:44,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:48,954 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:26:48,960 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:26:48,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:49,068 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:26:53,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:53,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:26:53,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:26:54,930 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:26:54,934 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:26:57,034 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:26:57,038 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:27:00,409 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:27:00,410 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:27:00,415 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:27:00,416 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:27:00,423 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:27:00,425 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:27:00,426 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:27:00,433 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:27:00,434 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:27:00,440 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:27:00,448 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:27:00,455 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:27:00,456 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:02,694 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:27:02,703 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:27:02,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:04,866 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:27:04,866 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:27:04,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:07,037 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:27:07,041 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:27:07,044 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:27:09,230 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:27:41,759 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:27:43,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:27:44,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:27:45,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:28:08,152 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:28:18,462 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:28:18,469 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:28:18,470 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:28:20,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:28:20,430 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:28:20,436 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:28:25,153 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:28:48,716 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:28:49,225 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 13:28:50,415 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:28:58,241 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:28:58,243 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:06,534 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 13:29:06,535 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:29:08,406 - ispa_next.appointments.models - DEBUG - Appointment Herr Oliver Müller BA-MR 540 WBA71BM080CN56098 ohne Termin.
2025-11-12 13:29:08,406 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:29:08,427 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:29:08,436 - ispa_next.main - DEBUG - 



2025-11-12 13:29:08,436 - ispa_next.main - DEBUG - starting with process 14 (BA-CT 97) of 17
2025-11-12 13:29:08,442 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:29:11,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:29:15,020 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:29:15,023 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 13:29:19,246 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:29:19,248 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:30:22,833 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:30:27,634 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:30:44,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:30:46,339 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:30:46,340 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:46,536 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:30:47,255 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:30:47,261 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:30:47,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:30:47,447 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:31:01,245 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:31:01,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:31:03,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:31:05,633 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:31:05,860 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:31:06,143 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:31:06,370 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:31:08,613 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:31:09,619 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:31:09,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:10,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:33,179 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:31:42,942 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:31:42,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:31:43,074 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:31:43,076 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:31:43,263 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:31:43,497 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:31:45,420 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:31:45,830 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:31:50,109 - ispa_next.functions - DEBUG - Updated appointment (AC00040950) customer contact data.
2025-11-12 13:31:51,382 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:31:51,389 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:31:51,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:31:53,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:31:55,934 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:31:55,935 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:31:56,080 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:31:59,796 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:31:59,796 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:31:59,801 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:31:59,802 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:31:59,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:00,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:32:04,688 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 13:32:12,443 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:32:12,444 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:12,826 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:32:13,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:13,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:32:13,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:32:15,054 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:32:15,058 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:32:17,257 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:32:17,259 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:32:21,961 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:32:21,963 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:21,970 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:32:21,972 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:32:21,979 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:32:21,981 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:32:21,988 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:32:21,990 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:32:21,996 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:32:22,004 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:32:22,010 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:32:22,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:24,438 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:32:24,444 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:32:24,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:26,571 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:32:26,571 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:32:26,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:28,768 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:32:28,774 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:32:28,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:32:30,978 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:33:01,281 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:33:02,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:33:03,784 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:33:04,215 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:33:28,612 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:33:38,030 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:33:38,034 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:33:38,035 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:33:39,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:33:39,932 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:33:39,939 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:33:44,579 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:34:57,916 - ispa_next.appointment_ending - DEBUG - return from complete process to close_process save=False after error_dialog appeared.
2025-11-12 13:34:58,436 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 13:35:09,719 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:35:09,730 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:11,249 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:35:11,251 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:19,631 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 13:35:19,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:35:21,565 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:35:21,585 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:35:21,593 - ispa_next.main - DEBUG - Found new Appointment: BA-MR 540
2025-11-12 13:35:21,595 - ispa_next.main - DEBUG - 



2025-11-12 13:35:21,595 - ispa_next.main - DEBUG - starting with process 15 (BA-MR 540) of 18
2025-11-12 13:35:21,601 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:35:24,597 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:35:28,147 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:35:28,149 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 13:35:33,382 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:35:33,384 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:36:27,564 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:36:47,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:47,355 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:47,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:36:49,284 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:36:49,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:49,446 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:50,249 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:36:50,257 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:36:50,258 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:36:50,416 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:36:54,602 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:36:54,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:36:57,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:36:59,777 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:36:59,984 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:37:03,412 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:37:03,581 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:37:03,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:37:05,033 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:37:15,952 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 13:37:16,958 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:37:16,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:17,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:40,907 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:37:40,908 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:37:56,622 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:37:56,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:37:56,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:37:56,795 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:37:57,003 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:37:58,659 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:37:59,004 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:38:06,039 - ispa_next.functions - DEBUG - Updated appointment (AK00008962) customer contact data.
2025-11-12 13:38:07,244 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:38:07,252 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:38:10,387 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:38:10,388 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:38:12,062 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:38:15,736 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:38:15,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:16,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:18,314 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:38:18,571 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:38:18,849 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:38:19,007 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:38:19,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:20,563 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:38:32,287 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:38:40,588 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:38:40,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:38:42,012 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:38:46,342 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:38:47,350 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:38:47,351 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:38:47,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:47,494 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:38:51,752 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:38:51,759 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:38:51,759 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:51,897 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:38:57,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:58,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:38:58,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:38:59,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:38:59,784 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:39:01,387 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:39:01,389 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:39:03,392 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:39:03,394 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:03,400 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:39:03,401 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:39:03,408 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:39:03,410 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 13:39:03,411 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:39:03,417 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:39:03,419 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:39:03,426 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:39:03,429 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 13:39:04,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 13:39:05,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 13:39:27,607 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 13:39:27,612 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:39:27,617 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:39:27,618 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:29,082 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:39:29,091 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:39:29,094 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:31,150 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:39:31,150 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:39:31,153 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:32,829 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:39:32,846 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:39:33,011 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:39:34,527 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:40:08,223 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:40:09,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:40:11,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:40:11,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:40:28,177 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:40:28,181 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:40:28,182 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:40:29,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:40:30,145 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:40:30,151 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:40:35,023 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:40:56,148 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:40:56,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 13:40:59,050 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:41:06,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:41:06,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:41:14,826 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 13:41:14,827 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:41:16,770 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:41:16,790 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:41:16,799 - ispa_next.main - DEBUG - 



2025-11-12 13:41:16,800 - ispa_next.main - DEBUG - starting with process 16 (BA-PM 1007) of 18
2025-11-12 13:41:16,806 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:41:19,780 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:41:23,436 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:41:23,438 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 13:41:27,856 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:41:27,858 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:42:28,177 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:42:34,006 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:42:43,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:42:44,471 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:42:44,472 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:44,636 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:42:45,091 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:42:45,098 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:42:45,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:42:45,271 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:42:49,425 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:42:49,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:42:51,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:42:53,934 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:42:54,191 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:42:54,402 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:42:54,605 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:42:58,951 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:42:59,958 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:42:59,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:00,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:25,079 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:43:25,079 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:43:35,918 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:43:35,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:43:36,069 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:43:36,071 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:43:36,233 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:43:37,853 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:43:38,269 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:43:42,564 - ispa_next.functions - DEBUG - Updated appointment (AC00041241) customer contact data.
2025-11-12 13:43:43,771 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:43:43,834 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:43:46,033 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:43:46,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:43:47,928 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:43:51,582 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:43:51,582 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:43:51,589 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:43:51,590 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:43:51,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:53,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:43:57,533 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:43:57,540 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:43:57,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:43:57,678 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:44:03,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:04,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:44:04,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:44:05,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:44:05,396 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:44:06,948 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:44:06,951 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:44:10,116 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:44:10,119 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:44:10,124 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:44:10,126 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:44:10,132 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:44:10,134 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:44:10,135 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:44:10,141 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:44:10,143 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:44:10,149 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:44:10,157 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:44:10,163 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:44:10,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:11,690 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:44:11,697 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:44:11,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:13,149 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:44:13,149 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:44:13,151 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:14,623 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:44:14,629 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:44:14,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:44:16,014 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:44:48,537 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:44:49,621 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:44:51,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:44:51,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:45:10,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:45:10,434 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:45:10,435 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:45:12,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:45:12,458 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:45:12,465 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:45:17,251 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:45:41,825 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:45:42,296 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 13:45:43,632 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:45:52,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:45:52,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:46:02,117 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 13:46:02,119 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:46:04,074 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:46:04,098 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:46:04,115 - ispa_next.main - DEBUG - 



2025-11-12 13:46:04,116 - ispa_next.main - DEBUG - starting with process 17 (BA-EK 33) of 18
2025-11-12 13:46:04,125 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:46:07,163 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:46:10,558 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:46:10,560 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 13:46:15,041 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:46:15,043 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:47:14,046 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:47:19,085 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:47:29,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:47:31,254 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:47:31,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:47:31,555 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:47:32,073 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:47:32,079 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:47:32,080 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:47:32,298 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:47:36,300 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:47:36,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:47:38,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:47:40,942 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:47:41,135 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:47:41,362 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:47:41,579 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:47:45,904 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:47:46,916 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:47:46,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:47:47,534 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:10,180 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:48:10,181 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 13:48:21,291 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:48:21,294 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:48:21,421 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:48:21,423 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:48:21,538 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:48:23,254 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:48:23,659 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:48:28,080 - ispa_next.functions - DEBUG - Updated appointment (AC00041222) customer contact data.
2025-11-12 13:48:29,326 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:48:29,336 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:48:32,524 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:48:32,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:48:34,543 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:48:38,178 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:48:38,178 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:48:38,183 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:48:38,184 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:48:38,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:48:38,754 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:48:42,965 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:48:42,972 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:48:42,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:48:43,128 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:48:52,410 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 13:49:06,609 - ispa_next.wipers - DEBUG - wipers have been already replaced.
2025-11-12 13:49:17,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:18,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:49:18,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:49:19,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:49:19,565 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:49:21,696 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:49:21,699 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:49:25,052 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:49:25,053 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:25,060 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:49:25,061 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:49:25,067 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:49:25,069 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:49:25,070 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:49:25,076 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:49:25,077 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:49:25,084 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:49:25,092 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:49:25,102 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:49:25,103 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:27,574 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:49:27,581 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:49:27,584 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:29,656 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:49:29,656 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:49:29,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:31,830 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:49:31,834 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:49:31,837 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:49:33,977 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:50:03,881 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:50:04,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:50:06,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:50:06,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:50:31,646 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:41,197 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:50:41,202 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:50:41,203 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:50:42,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:50:43,128 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:50:43,135 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:50:47,878 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:51:09,024 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:51:09,489 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 13:51:10,847 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:51:21,342 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:51:21,344 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:51:30,825 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 480
2025-11-12 13:51:30,826 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:51:32,778 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:51:32,806 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:51:32,815 - ispa_next.main - DEBUG - 



2025-11-12 13:51:32,815 - ispa_next.main - DEBUG - starting with process 18 (BA-FS 2002) of 18
2025-11-12 13:51:32,821 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:51:35,819 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:51:39,303 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:51:39,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 480
2025-11-12 13:51:43,570 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:51:43,572 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:52:45,553 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:52:50,538 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 13:53:00,681 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:53:02,833 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:53:02,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:53:03,009 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:53:03,668 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:53:03,676 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:53:03,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:53:03,859 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:53:17,827 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:53:17,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:53:20,497 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:53:22,504 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:53:22,794 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:53:22,981 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:53:23,185 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:53:27,538 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:53:28,546 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:53:28,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:53:29,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:53:53,373 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:54:04,590 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:54:04,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:04,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:54:04,750 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:54:04,890 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:54:06,592 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:54:06,962 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:54:11,390 - ispa_next.functions - DEBUG - Updated appointment (AC00040970) customer contact data.
2025-11-12 13:54:12,632 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:54:12,645 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:54:15,952 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:54:15,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:54:18,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:54:21,723 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:54:21,723 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:54:21,730 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:54:21,731 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:54:21,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:54:22,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:54:26,546 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:54:26,554 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:54:26,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:54:26,742 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:54:27,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:27,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:54:27,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:54:29,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:54:29,018 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:54:31,208 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:54:31,211 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:54:34,714 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:54:34,744 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:54:34,753 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:54:34,754 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:54:34,762 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:54:34,763 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:54:34,765 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:54:34,773 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:54:34,816 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:54:34,824 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:54:34,848 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:54:34,856 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:54:34,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:37,157 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:54:37,163 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:54:37,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:39,273 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:54:39,273 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 13:54:39,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:41,457 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:54:41,462 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:54:41,465 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:54:43,842 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:55:15,387 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:55:16,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:55:18,136 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:55:18,560 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:55:43,394 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:53,245 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:55:53,252 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:55:54,086 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:55:56,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:55:56,207 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:55:56,211 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:56:00,955 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:56:24,742 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:56:25,357 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 13:56:26,677 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:56:34,857 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:56:34,859 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:56:43,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 481
2025-11-12 13:56:43,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:56:45,617 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 13:56:45,637 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 13:56:45,644 - ispa_next.main - DEBUG - Found new Appointment: BA-S 4455
2025-11-12 13:56:45,645 - ispa_next.main - DEBUG - 



2025-11-12 13:56:45,645 - ispa_next.main - DEBUG - starting with process 19 (BA-S 4455) of 19
2025-11-12 13:56:45,653 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:56:48,704 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:56:52,206 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1646
2025-11-12 13:56:52,208 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 481
2025-11-12 13:56:56,860 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 13:56:56,862 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:57:44,925 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 13:58:05,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:58:07,950 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 13:58:07,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:58:08,088 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:58:08,832 - ispa_next.functions - DEBUG - HU date already expired after 196 days.
2025-11-12 13:58:24,272 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:58:24,280 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:58:24,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:58:24,467 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:58:44,086 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:58:44,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:58:46,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:58:48,559 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:58:50,746 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:58:54,263 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:58:54,431 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:58:58,813 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 13:58:59,821 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:58:59,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:59:00,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:59:25,251 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 13:59:41,393 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:59:41,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:59:41,579 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:59:41,580 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:59:41,700 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:59:41,924 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:59:43,547 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:59:43,934 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:59:51,937 - ispa_next.functions - DEBUG - Updated appointment (AC00041370) customer contact data.
2025-11-12 13:59:53,020 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:59:53,033 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:59:53,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:59:55,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:59:58,434 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:59:58,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:59:59,029 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 14:00:03,329 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:00:03,329 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 14:00:03,339 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:00:03,340 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 14:00:03,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:00:03,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:00:08,287 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 14:00:10,346 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 14:00:27,643 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:00:27,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:00:27,867 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:00:28,424 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:00:29,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:00:29,123 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:00:30,333 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:00:30,337 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:00:33,717 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:00:33,721 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:00:36,059 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:00:36,081 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:00:36,092 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:00:36,094 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:00:36,100 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:00:36,101 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 14:00:36,103 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:00:36,114 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:00:36,115 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:00:36,122 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:00:36,124 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 14:00:37,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 14:00:38,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 14:01:01,923 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 14:01:01,932 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:01:01,954 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:01:01,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:06,495 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:01:06,502 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:01:06,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:10,180 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:01:10,180 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 14:01:10,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:13,848 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:01:13,855 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:01:13,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:01:17,650 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:01:54,713 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:01:56,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:01:57,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:01:58,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:02:35,831 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:02:46,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:03:00,142 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:03:00,143 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:03:02,031 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:03:02,218 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:03:02,225 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:03:14,305 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 14:03:37,461 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:03:37,863 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-12 14:03:40,784 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:03:47,157 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1647
2025-11-12 14:03:47,159 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:03:56,418 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 482
2025-11-12 14:03:56,419 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:03:58,261 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:03:58,281 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
2025-11-12 14:03:58,293 - ispa_next.main - DEBUG - Found new Appointment: BA-MO 800E
2025-11-12 14:03:58,295 - ispa_next.main - DEBUG - 



2025-11-12 14:03:58,295 - ispa_next.main - DEBUG - starting with process 20 (BA-MO 800E) of 20
2025-11-12 14:03:58,305 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:04:01,378 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:04:05,056 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1647
2025-11-12 14:04:05,058 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 482
2025-11-12 14:04:09,855 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:04:09,857 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:04:51,746 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:05:10,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:11,015 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:05:11,608 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:05:13,679 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:05:13,680 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:13,865 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:05:14,393 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:05:14,398 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:05:14,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:14,623 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:05:19,040 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:05:19,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:05:21,607 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:05:23,610 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:05:24,377 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:05:27,804 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:05:27,991 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:05:27,993 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:05:30,366 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:05:41,086 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 14:05:42,097 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:05:42,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:05:42,774 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:06:10,043 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 14:06:10,043 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 14:06:25,615 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:06:25,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:06:25,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:06:25,760 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:06:25,844 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:06:27,729 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:06:28,369 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:06:37,084 - ispa_next.functions - DEBUG - Updated appointment (AC00041371) customer contact data.
2025-11-12 14:06:38,322 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:06:38,337 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:06:40,636 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:06:40,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:06:42,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:06:46,249 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:06:46,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:06:46,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:06:48,895 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:06:49,118 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:06:49,419 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:06:49,628 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:06:49,630 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:06:51,888 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:07:03,289 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:07:52,293 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:08:05,058 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 14:08:11,218 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 14:08:11,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:08:13,457 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 14:08:17,815 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 14:08:18,823 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:08:18,824 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 14:08:18,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:08:19,067 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:08:23,361 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 14:08:23,368 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:08:23,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:08:23,499 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:08:23,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:08:24,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:08:24,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:08:26,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:08:26,041 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:08:28,188 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:08:28,191 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:08:29,841 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:08:29,843 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:08:29,849 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:08:29,850 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:08:29,857 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 14:08:29,860 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:08:29,866 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:08:29,868 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:08:29,875 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:08:29,877 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 14:08:33,555 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:08:34,138 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:08:35,137 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:08:35,804 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 14:08:36,384 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 14:08:37,350 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 14:08:39,261 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 14:08:40,236 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 14:08:41,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 14:09:05,380 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 14:09:05,385 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:09:05,389 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:09:05,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:09:07,501 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:09:07,507 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:09:07,513 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:09:09,681 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:09:09,681 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 14:09:09,684 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:09:11,865 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:09:11,871 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:09:11,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:09:14,167 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:09:49,666 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:09:50,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:09:52,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:09:53,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:10:17,673 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:10:29,153 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:10:29,161 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:10:29,162 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:10:30,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:10:31,154 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:10:31,161 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:10:35,968 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:10:58,898 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 14:10:58,904 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:10:58,906 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:11:08,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:11:08,245 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:11:08,249 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:11:13,196 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 14:11:13,239 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 14:11:24,328 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-12 14:11:24,336 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:11:25,873 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1649
2025-11-12 14:11:25,875 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:11:34,845 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 484
2025-11-12 14:11:34,846 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:11:36,846 - ispa_next.appointments.models - DEBUG - Appointment Frau Melanie Franke BA-F 910 WMWXM510003B81372 ohne Termin.
2025-11-12 14:11:36,849 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:11:36,858 - ispa_next.main - DEBUG - Found new Appointment: BA-ES 40
2025-11-12 14:11:36,859 - ispa_next.main - DEBUG - 



2025-11-12 14:11:36,859 - ispa_next.main - DEBUG - starting with process 21 (BA-ES 40) of 21
2025-11-12 14:11:36,865 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:11:39,992 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:11:43,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1649
2025-11-12 14:11:43,657 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 484
2025-11-12 14:11:50,692 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 14:11:50,693 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:12:48,287 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 14:13:11,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:12,015 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:13:12,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:13:14,481 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 14:13:14,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:14,654 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:13:15,449 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 14:13:30,746 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 14:13:30,755 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 14:13:30,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:13:30,924 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:13:35,075 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:13:35,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:13:38,190 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:13:40,193 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:13:40,466 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:13:43,843 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 14:14:03,972 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-12 14:14:04,980 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 14:14:04,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:05,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:32,805 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 14:14:49,288 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 14:14:49,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:14:49,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 14:14:49,484 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 14:14:49,598 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 14:14:51,337 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 14:14:52,965 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 14:14:54,312 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 14:15:01,935 - ispa_next.functions - DEBUG - Updated appointment (AC00041373) customer contact data.
2025-11-12 14:15:03,171 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 14:15:03,232 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 14:15:05,685 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 14:15:05,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 14:15:07,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 14:15:11,822 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 14:15:11,823 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 14:15:11,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:15:12,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:15:14,585 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 14:15:14,775 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 14:15:15,019 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 14:15:15,187 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 14:15:15,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:15:17,607 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:15:28,862 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 14:15:48,866 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 14:15:59,640 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 14:16:17,130 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 14:16:18,140 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 14:16:18,141 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 14:16:18,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:16:18,249 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:16:22,557 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 14:16:22,564 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 14:16:22,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:16:22,703 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 14:16:28,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 14:16:29,414 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 14:16:29,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 14:16:30,668 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 14:16:30,672 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 14:16:32,980 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 14:16:32,983 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 14:16:35,397 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 14:16:35,400 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:16:35,407 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 14:16:35,409 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 14:16:35,415 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 14:16:35,416 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Klimaservice, source=from_tab, target=advice_list), Package(name=Sperber Battery Health Ca, source=from_tab, target=advice_list), Package(name=Flüssigkeiten ergänzen, source=from_tab, target=advice_list)}
2025-11-12 14:16:35,418 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 14:16:35,424 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 14:16:35,425 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 14:16:35,431 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 14:16:35,434 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-12 14:16:36,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 14:16:38,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 14:17:00,851 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 14:17:00,856 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 14:17:00,860 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 14:17:00,861 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:17:03,086 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 14:17:03,097 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 14:17:03,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:17:05,290 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 14:17:05,290 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 14:17:05,293 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:17:07,464 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 14:17:07,469 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 14:17:07,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:17:09,653 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 14:17:45,747 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 14:17:47,064 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:17:48,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 14:17:49,297 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 14:18:14,880 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:18:25,337 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 14:18:25,345 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 14:18:25,346 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 14:18:27,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 14:18:27,463 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 14:18:27,467 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 14:18:32,654 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 14:18:58,440 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 14:18:58,922 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-12 14:19:01,524 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 14:19:08,594 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1648
2025-11-12 14:19:08,596 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 14:19:17,390 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 483
2025-11-12 14:19:17,391 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 14:19:19,419 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 14:19:19,467 - ispa_next.appointments.models - DEBUG - Appointment Firma SCHOCK Druck + BA-AS 90 WBA5D71030D060815 ohne Termin.
