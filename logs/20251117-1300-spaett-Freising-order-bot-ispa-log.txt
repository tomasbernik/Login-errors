2025-11-17 13:00:40,235 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:00:40,242 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:00:53,292 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:01:04,488 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:01:20,070 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:01:44,614 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:01:56,752 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:02:00,095 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:02:01,209 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:02:01,214 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:02:03,694 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 316
2025-11-17 13:02:03,695 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:02:03,696 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:02:04,916 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:02:05,737 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:02:55,012 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:55,048 - ispa_next.appointments.models - DEBUG - Appointment Michael Helmlinger  WBY11CF020CR13544 ohne Termin.
2025-11-17 13:02:55,064 - ispa_next.appointments.models - DEBUG - Appointment Firma Bayerische Motoren Werke M-LG 3604 WBA81GE0607T51422 ohne Termin.
2025-11-17 13:02:55,075 - ispa_next.appointments.models - DEBUG - Appointment Robert Müller FS-M 2891 WBA31AK0207H93595 ohne Termin.
2025-11-17 13:02:55,078 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:55,090 - ispa_next.appointments.models - DEBUG - Appointment Firma REWE Markt GmbH FS-RE 166 WBA11DX000CD76582 ohne Termin.
2025-11-17 13:02:55,117 - ispa_next.appointments.models - DEBUG - Appointment Christina Müller EI-CA 8501 WBA1V710207A22215 ohne Termin.
2025-11-17 13:02:55,134 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:55,135 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:55,148 - ispa_next.appointments.models - DEBUG - Appointment Julian Marvin Lamberti FS-JL 96 WBAJC510X0G860905 ohne Termin.
2025-11-17 13:02:55,161 - ispa_next.appointments.models - DEBUG - Appointment Luca Weicker M-LW 208 WBA5R11080FH35709 ohne Termin.
2025-11-17 13:02:55,172 - ispa_next.appointments.models - DEBUG - Appointment Michael Rudorfer FS-EV 777 WBA2D710405G19272 ohne Termin.
2025-11-17 13:02:55,186 - ispa_next.appointments.models - DEBUG - Appointment Andreas Lechner FS-LL 300 WBA5R11060AK29564 ohne Termin.
2025-11-17 13:02:55,203 - ispa_next.appointments.models - DEBUG - Appointment Florian Eichinger FS-LS 932 WBAJT91090BR75371 ohne Termin.
2025-11-17 13:02:55,217 - ispa_next.appointments.models - DEBUG - Appointment Michael Rudorfer FS-EV 777 WBA2D710405G19272 ohne Termin.
2025-11-17 13:02:55,253 - ispa_next.appointments.models - DEBUG - Appointment Firma TSA Solution GmbH FS-SK 410 WBA11CM0508D75834 ohne Termin.
2025-11-17 13:02:55,270 - ispa_next.appointments.models - DEBUG - Appointment Firma Dr. Schwab Ges. f. Technologie M-S 7134 WBAGV41060CL15774 ohne Termin.
2025-11-17 13:02:55,309 - ispa_next.appointments.models - DEBUG - Appointment Labinot Deda FS-LD 789 WBA3K51030K307246 ohne Termin.
2025-11-17 13:02:55,342 - ispa_next.appointments.models - DEBUG - Appointment Kevin Perleberg FS-CK 149 WBAUS91000A187519 ohne Termin.
2025-11-17 13:02:55,346 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:02:55,362 - ispa_next.appointments.models - DEBUG - Appointment Murat Böcekci FS-MU 79 WBANU31010BX99380 ohne Termin.
2025-11-17 13:02:55,382 - ispa_next.appointments.models - DEBUG - Appointment Mustafa Durak FS-DD 62 WBA4F11020G316587 ohne Termin.
2025-11-17 13:02:55,407 - ispa_next.appointments.models - DEBUG - Appointment Schuberthan Schuberthan DGF-Y 8570 WBA35GP000N338205 ohne Termin.
2025-11-17 13:02:55,429 - ispa_next.appointments.models - DEBUG - Appointment Christine Huber FS-CH 282 WBA8J11090A714964 ohne Termin.
2025-11-17 13:02:55,471 - ispa_next.main - DEBUG - Found 20 out of 139 appointments to process (configured limit: 20).
2025-11-17 13:02:55,471 - ispa_next.main - DEBUG - Processing 20 fresh appointments.
2025-11-17 13:02:55,472 - ispa_next.main - DEBUG - All appointments: M-P 8217, FS-KD 59 E, FS-MT 886, FS-JM 484, FS-LA 175, FS-SX 21, FS-NK 258, R-N 9943E, FS-P 2159, T-P 129, FS-CG 799, FS-SF234, FS-Y 330, FS-BD 344, FS-LJ688, ED-MH 198, PAF-EV 511, FS-KS 880, FS-GJ 153, DO-AD 224
2025-11-17 13:02:55,475 - ispa_next.main - DEBUG - 



2025-11-17 13:02:55,475 - ispa_next.main - DEBUG - starting with process 1 (M-P 8217) of 20
2025-11-17 13:02:55,481 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:02:56,622 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:02:57,804 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:02:57,805 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 316
2025-11-17 13:02:59,155 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:02:59,156 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:03:30,040 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:03:40,376 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:45,741 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:03:45,742 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:45,814 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:03:45,969 - ispa_next.functions - DEBUG - HU date already expired after 6 days.
2025-11-17 13:03:52,209 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:03:52,212 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:03:54,994 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:03:54,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:55,814 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:03:57,817 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:03:57,941 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:03:58,044 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:03:58,193 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:04:02,393 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:04:03,398 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:04:03,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:03,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:15,587 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:04:22,991 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:04:22,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:23,080 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:04:23,081 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:04:23,174 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:04:24,420 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:04:25,708 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:04:25,943 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:04:27,638 - ispa_next.functions - DEBUG - Updated appointment (AC00013061) customer contact data.
2025-11-17 13:04:28,553 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:04:28,559 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:04:29,362 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:04:29,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:04:30,059 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:04:33,679 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:04:33,679 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:04:33,682 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:04:33,686 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:04:33,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:34,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:04:34,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:35,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:04:35,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:35,830 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:04:35,832 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:04:40,656 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:04:40,659 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:04:41,585 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:04:41,591 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:04:41,595 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:04:41,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:04:41,600 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:04:41,601 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:04:41,602 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:04:41,603 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:04:41,606 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:04:41,608 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:04:41,612 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:04:41,614 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:04:41,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:04:46,986 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:04:46,990 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:04:46,996 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:04:52,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:04:52,489 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:05:01,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:16,531 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:05:16,533 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:05:16,534 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:05:17,183 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:05:17,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:29,921 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:05:29,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:05:35,211 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:05:47,547 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:05:48,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:05:48,573 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:05:48,708 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:06:40,132 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:43,304 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:47,373 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:51,657 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:06:58,231 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:06:58,231 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:06:58,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:06:58,788 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:06:58,790 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:07:01,980 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:07:11,269 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:07:11,664 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:07:12,262 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:13,366 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:07:13,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:15,537 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:07:15,538 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:16,314 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:16,323 - ispa_next.main - DEBUG - 



2025-11-17 13:07:16,323 - ispa_next.main - DEBUG - starting with process 2 (FS-KD 59 E) of 20
2025-11-17 13:07:16,331 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:17,492 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:18,820 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:07:18,821 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:07:20,257 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:20,259 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:32,553 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:07:32,650 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:07:32,655 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:33,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:07:33,240 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:35,793 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:07:35,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:36,612 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:36,619 - ispa_next.main - DEBUG - 



2025-11-17 13:07:36,619 - ispa_next.main - DEBUG - starting with process 3 (FS-MT 886) of 20
2025-11-17 13:07:36,627 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:37,805 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:39,162 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:07:39,164 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:07:40,586 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:40,587 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:52,787 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:07:52,795 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:07:52,799 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:53,101 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:07:53,102 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:55,180 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:07:55,181 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:07:55,860 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:07:55,866 - ispa_next.main - DEBUG - 



2025-11-17 13:07:55,866 - ispa_next.main - DEBUG - starting with process 4 (FS-JM 484) of 20
2025-11-17 13:07:55,878 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:07:56,697 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:07:57,688 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:07:57,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:07:58,819 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:07:58,820 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:10,049 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:08:10,057 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:08:10,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:08:10,554 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:08:10,555 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:08:12,975 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:08:12,976 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:13,828 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:08:13,832 - ispa_next.main - DEBUG - 



2025-11-17 13:08:13,833 - ispa_next.main - DEBUG - starting with process 5 (FS-LA 175) of 20
2025-11-17 13:08:13,837 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:08:15,037 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:08:16,173 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:08:16,175 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:08:17,647 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:08:17,648 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:28,313 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:08:28,321 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 13:08:28,325 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:08:28,661 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:08:28,663 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:08:30,698 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:08:30,698 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:31,271 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:08:31,278 - ispa_next.main - DEBUG - 



2025-11-17 13:08:31,278 - ispa_next.main - DEBUG - starting with process 6 (FS-SX 21) of 20
2025-11-17 13:08:31,283 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:08:32,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:08:33,151 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:08:33,152 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:08:34,382 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:08:34,384 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:47,158 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:08:47,167 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 13:08:47,171 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:08:47,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:08:47,827 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:08:50,471 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:08:50,472 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:08:51,423 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:08:51,429 - ispa_next.main - DEBUG - 



2025-11-17 13:08:51,429 - ispa_next.main - DEBUG - starting with process 7 (FS-NK 258) of 20
2025-11-17 13:08:51,435 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:08:52,597 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:08:53,721 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:08:53,722 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:08:54,851 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:08:54,852 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:06,636 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:09:06,647 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 13:09:06,651 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:07,087 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:09:07,088 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:09,249 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:09:09,250 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:09,893 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:09:09,899 - ispa_next.main - DEBUG - 



2025-11-17 13:09:09,899 - ispa_next.main - DEBUG - starting with process 8 (R-N 9943E) of 20
2025-11-17 13:09:09,904 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:10,806 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:11,686 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:09:11,687 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:09:12,941 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:12,942 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:25,075 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:09:25,086 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 13:09:25,091 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:25,622 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:09:25,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:28,365 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:09:28,366 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:29,169 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:09:29,175 - ispa_next.main - DEBUG - 



2025-11-17 13:09:29,175 - ispa_next.main - DEBUG - starting with process 9 (FS-P 2159) of 20
2025-11-17 13:09:29,181 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:30,897 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:32,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:09:32,219 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:09:33,766 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:33,767 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:47,124 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:09:47,133 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 13:09:47,137 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:47,695 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:09:47,697 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:50,442 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:09:50,443 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:09:51,324 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:09:51,329 - ispa_next.main - DEBUG - 



2025-11-17 13:09:51,329 - ispa_next.main - DEBUG - starting with process 10 (T-P 129) of 20
2025-11-17 13:09:51,334 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:09:52,562 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:09:53,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:09:53,840 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:09:55,286 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:09:55,287 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:06,998 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:10:07,007 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 13:10:07,012 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:07,536 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:10:07,538 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:09,765 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:10:09,766 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:10,407 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:10:10,412 - ispa_next.main - DEBUG - 



2025-11-17 13:10:10,412 - ispa_next.main - DEBUG - starting with process 11 (FS-CG 799) of 20
2025-11-17 13:10:10,416 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:10:11,342 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:12,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:10:12,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:10:13,410 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:13,411 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:24,678 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:10:24,687 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 13:10:24,694 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:25,200 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:10:25,201 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:27,484 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:10:27,485 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:28,337 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:10:28,344 - ispa_next.main - DEBUG - 



2025-11-17 13:10:28,344 - ispa_next.main - DEBUG - starting with process 12 (FS-SF234) of 20
2025-11-17 13:10:28,354 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:10:29,630 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:30,916 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:10:30,917 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:10:32,322 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:32,323 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:44,778 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:10:44,786 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 13:10:44,790 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:45,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:10:45,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:47,095 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:10:47,096 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:10:47,701 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:10:47,706 - ispa_next.main - DEBUG - 



2025-11-17 13:10:47,706 - ispa_next.main - DEBUG - starting with process 13 (FS-Y 330) of 20
2025-11-17 13:10:47,711 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:10:48,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:10:49,978 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:10:49,979 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:10:51,405 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:10:51,407 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:03,604 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:11:03,612 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 13:11:03,617 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:04,184 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:04,185 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:06,848 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:11:06,848 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:07,597 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:07,602 - ispa_next.main - DEBUG - 



2025-11-17 13:11:07,602 - ispa_next.main - DEBUG - starting with process 14 (FS-BD 344) of 20
2025-11-17 13:11:07,606 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:08,487 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:10,071 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:10,073 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:11:11,720 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:11,721 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:23,810 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:11:23,822 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 13:11:23,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:24,229 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:24,230 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:26,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:11:26,973 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:27,700 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:27,715 - ispa_next.main - DEBUG - 



2025-11-17 13:11:27,716 - ispa_next.main - DEBUG - starting with process 15 (FS-LJ688) of 20
2025-11-17 13:11:27,721 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:28,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:29,948 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:29,949 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:11:31,515 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:31,516 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:42,965 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:11:42,973 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 13:11:42,977 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:43,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:43,301 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:45,353 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:11:45,354 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:45,936 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:11:45,941 - ispa_next.main - DEBUG - 



2025-11-17 13:11:45,941 - ispa_next.main - DEBUG - starting with process 16 (ED-MH 198) of 20
2025-11-17 13:11:45,957 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:11:46,815 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:47,780 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:47,781 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:11:49,000 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:11:49,001 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:11:59,461 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:11:59,469 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 13:11:59,472 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:59,827 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:11:59,828 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:01,974 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:12:01,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:02,656 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:12:02,663 - ispa_next.main - DEBUG - 



2025-11-17 13:12:02,663 - ispa_next.main - DEBUG - starting with process 17 (PAF-EV 511) of 20
2025-11-17 13:12:02,669 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:03,562 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:04,482 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:12:04,483 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:12:05,677 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:05,678 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:16,679 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:12:16,687 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 13:12:16,691 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:16,982 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:12:16,983 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:19,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:12:19,397 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:20,189 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:12:20,194 - ispa_next.main - DEBUG - 



2025-11-17 13:12:20,194 - ispa_next.main - DEBUG - starting with process 18 (FS-KS 880) of 20
2025-11-17 13:12:20,199 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:21,412 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:22,688 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:12:22,689 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:12:24,134 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:24,135 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:37,245 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 13:12:37,254 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 13:12:37,259 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:37,822 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:12:37,824 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:40,888 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 370
2025-11-17 13:12:40,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:41,703 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:12:41,708 - ispa_next.main - DEBUG - 



2025-11-17 13:12:41,708 - ispa_next.main - DEBUG - starting with process 19 (FS-GJ 153) of 20
2025-11-17 13:12:41,713 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:42,893 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:44,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 13:12:44,135 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 370
2025-11-17 13:12:45,496 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:45,497 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:13:12,614 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:13:22,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:22,814 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:22,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:25,543 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:13:25,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:25,608 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:25,836 - ispa_next.functions - DEBUG - HU date already expired after 8 days.
2025-11-17 13:13:32,753 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:13:32,756 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:13:35,468 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:35,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:36,568 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:38,571 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:13:38,717 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:13:38,799 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:13:38,915 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:13:38,915 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:13:50,186 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:13:51,191 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:13:51,191 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:51,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:04,737 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:14:12,515 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:14:12,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:12,605 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:12,606 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:14:12,674 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:14:13,944 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:14:14,238 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:14:18,262 - ispa_next.functions - DEBUG - Updated appointment (AC00012832) customer contact data.
2025-11-17 13:14:19,175 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:14:19,177 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:14:19,983 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:14:19,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:14:20,798 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:14:25,296 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:25,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:25,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:27,773 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:14:28,001 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:14:28,258 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:14:28,339 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:14:28,339 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:14:39,744 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:15:39,746 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:15:51,288 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:16:13,296 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:16:24,661 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:16:32,711 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 13:16:33,719 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:16:33,725 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:16:33,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:33,822 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:16:34,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:34,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:16:34,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:35,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:35,523 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:16:38,552 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:16:38,555 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:16:39,549 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:16:39,552 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:16:39,555 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:16:39,557 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:16:39,560 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:16:39,561 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:16:39,562 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:16:39,564 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:16:39,565 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:16:39,566 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:16:39,570 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:16:39,573 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:16:39,573 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:42,833 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:16:42,836 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:16:42,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:46,219 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:16:46,222 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:16:46,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:16:46,923 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:16:46,959 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:16:46,962 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:50,220 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:17:01,712 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:17:02,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:17:02,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:17:02,844 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:33,889 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:17:38,265 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:17:43,078 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:17:47,910 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:17:47,913 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:17:47,914 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:17:48,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:17:48,719 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:17:48,721 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:17:50,464 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:17:58,261 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:17:58,629 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 13:17:58,911 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:18:00,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 13:18:00,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:18:03,776 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 371
2025-11-17 13:18:03,777 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:18:04,572 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:18:04,578 - ispa_next.main - DEBUG - 



2025-11-17 13:18:04,578 - ispa_next.main - DEBUG - starting with process 20 (DO-AD 224) of 20
2025-11-17 13:18:04,584 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:18:05,748 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:18:06,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 13:18:06,783 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 371
2025-11-17 13:18:08,312 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:18:08,314 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:18:39,764 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:18:50,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:56,827 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:18:56,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:18:56,946 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:18:57,197 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:18:57,199 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:18:57,265 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:19:03,835 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:19:06,747 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:19:06,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:07,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:09,782 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:19:09,919 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:19:10,008 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:19:10,124 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:19:10,125 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:19:21,378 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:19:22,384 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:19:22,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:22,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:34,244 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 13:19:41,868 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:19:41,870 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:19:41,949 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:19:41,950 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:19:41,990 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:19:43,317 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:19:44,607 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:19:44,833 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:19:48,850 - ispa_next.functions - DEBUG - Updated appointment (AC00012822) customer contact data.
2025-11-17 13:19:49,755 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:19:49,758 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:19:50,612 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:19:50,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:19:51,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:19:55,555 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:19:55,555 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:19:55,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:19:56,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:19:58,091 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:19:58,207 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:19:58,345 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:19:58,420 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:19:58,420 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:20:09,872 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:20:16,996 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:20:16,996 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:20:19,150 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:20:20,157 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:20:20,163 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:20:20,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:20:20,225 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:20:20,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:20:21,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:20:21,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:20:21,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:20:21,756 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:20:27,571 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:20:27,573 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:20:28,553 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:20:28,555 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:20:28,557 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:20:28,558 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:20:28,559 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:20:28,561 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:20:28,562 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:20:28,563 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:20:28,564 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:20:28,566 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:20:28,569 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:20:28,571 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:20:28,572 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:35,257 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:20:35,260 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:20:35,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:41,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:20:41,993 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:20:51,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:07,922 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:21:07,925 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:21:07,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:21:08,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:21:08,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:22,842 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:21:22,844 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:21:29,557 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:21:41,997 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:21:42,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:21:43,184 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:21:43,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:48,879 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:22:54,027 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:23:00,085 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:23:00,094 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:23:00,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:23:00,934 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:23:00,936 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:23:04,035 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 13:23:11,559 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:23:11,938 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 13:23:12,773 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:23:13,933 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 13:23:13,934 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:23:16,938 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 371
2025-11-17 13:23:16,939 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:23:17,990 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
