2025-11-12 09:00:33,504 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 09:00:33,528 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 09:00:44,963 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 09:00:58,896 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 09:01:14,365 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 09:01:38,431 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 09:01:49,747 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 09:01:53,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:01:54,111 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1003
2025-11-12 09:01:54,112 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 474
2025-11-12 09:01:56,437 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 420
2025-11-12 09:01:56,438 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 09:01:56,439 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:01:57,606 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 09:01:58,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:03:04,742 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:04,758 - ispa_next.appointments.models - DEBUG - Appointment Ratko Kos-Igel Herr M-E 5984 WBAJN31060B378248 ohne Termin.
2025-11-12 09:03:04,777 - ispa_next.appointments.models - DEBUG - Appointment Franz-Michael von Morenhoffen Herr M-VM 1945 WMW11GD0602W56385 ohne Termin.
2025-11-12 09:03:04,798 - ispa_next.appointments.models - DEBUG - Appointment Andreas Pletschacher Herr M-S 7268 WMW11GA0607N78892 ohne Termin.
2025-11-12 09:03:04,806 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:04,826 - ispa_next.appointments.models - DEBUG - Appointment ZEBE-Zeichenbüro Ebersberg Frau EBE-ZB 999 WMWJZ31040TP30810 ohne Termin.
2025-11-12 09:03:04,845 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 09:03:04,867 - ispa_next.appointments.models - DEBUG - Appointment Erich Pudelko Herr EBE-EP 11 WBA21EA0307N15581 ohne Termin.
2025-11-12 09:03:04,918 - ispa_next.appointments.models - DEBUG - Appointment Markus Deppe Herr M-MD 6407 WMWLV310802U83186 ohne Termin.
2025-11-12 09:03:04,941 - ispa_next.appointments.models - DEBUG - Appointment Petra Wichert Frau M-PW 2302 WBAUH31030E525919 ohne Termin.
2025-11-12 09:03:04,956 - ispa_next.appointments.models - DEBUG - Appointment Peter Wolfgang Trepte Herr STA-GW 131 WBA2A51000V427342 ohne Termin.
2025-11-12 09:03:04,969 - ispa_next.appointments.models - DEBUG - Appointment Firma Open Text Software GmbH M-M 1684E WBA21GV030CW39508 ohne Termin.
2025-11-12 09:03:04,987 - ispa_next.appointments.models - DEBUG - Appointment Herbert Kuhn Herr M-KT 4350 WBAEJ11080AF78090 ohne Termin.
2025-11-12 09:03:05,001 - ispa_next.appointments.models - DEBUG - Appointment Firma curare - Verein zur Förderung EBE-C 204 WBA21EA0307L92610 ohne Termin.
2025-11-12 09:03:05,014 - ispa_next.appointments.models - DEBUG - Appointment Hans-Dieter Krill Herr M-DK 2695 WBA3U11040J871366 ohne Termin.
2025-11-12 09:03:05,027 - ispa_next.appointments.models - DEBUG - Appointment Aldin Hecimovic Herr EBE-AD 216 WBA2E510305G50482 ohne Termin.
2025-11-12 09:03:05,040 - ispa_next.appointments.models - DEBUG - Appointment Firma Global Concerts GmbH M-SZ 1171 WBA21EF0605018576 ohne Termin.
2025-11-12 09:03:05,053 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Fertich Frau EBE-FJ 111 WBAXB31040DW54269 ohne Termin.
2025-11-12 09:03:05,067 - ispa_next.appointments.models - DEBUG - Appointment Daniela Felbrich Frau ED-JS 396 WBY8P210207F54741 ohne Termin.
2025-11-12 09:03:05,079 - ispa_next.appointments.models - DEBUG - Appointment Patrick Gaßler Herr TS-GP 2299 WBA4C31090G785518 ohne Termin.
2025-11-12 09:03:05,091 - ispa_next.appointments.models - DEBUG - Appointment Firma MT Treuhand München M-MN 48 WBSUJ010209G32986 ohne Termin.
2025-11-12 09:03:05,105 - ispa_next.main - DEBUG - Found 12 out of 59 appointments to process (configured limit: 15).
2025-11-12 09:03:05,105 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 09:03:05,106 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 09:03:05,106 - ispa_next.main - DEBUG - All appointments: EBE-LS 18, EBE-LD 265, M-X 8740, EBE-XC 42, WS BJ 2015, EBE-FM 57, M-ZE 1903, WS-M 505, EBE-AS 109, M-MV 6001, EBE-XV 60, EBE-AU 51
2025-11-12 09:03:05,109 - ispa_next.main - DEBUG - 



2025-11-12 09:03:05,110 - ispa_next.main - DEBUG - starting with process 1 (EBE-LS 18) of 12
2025-11-12 09:03:05,113 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:03:06,210 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:03:07,120 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1003
2025-11-12 09:03:07,121 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 420
2025-11-12 09:03:08,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:03:08,257 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:03:44,621 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:03:54,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:03:54,585 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:03:54,726 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:04:01,330 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:04:01,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:01,408 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:04:01,710 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:04:01,712 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:04:01,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:01,836 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:04:05,019 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:04:05,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:04:06,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:04:08,091 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:04:08,206 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:04:08,299 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:04:08,387 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:04:08,387 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:04:19,790 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:04:24,113 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:04:24,113 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:04:28,280 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:04:29,288 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:04:29,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:29,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:43,384 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:04:51,475 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:04:51,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:04:51,553 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:04:51,553 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:04:51,591 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:04:52,848 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:04:54,066 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:04:54,293 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:04:58,301 - ispa_next.functions - DEBUG - Updated appointment (AJ00018122) customer contact data.
2025-11-12 09:04:59,215 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:04:59,219 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:05:00,188 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:05:00,188 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:05:00,938 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:05:04,537 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:05:04,537 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:05:04,549 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:05:04,549 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:05:04,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:05:05,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:05:09,216 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:05:10,072 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:05:21,323 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:05:21,325 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:05:21,428 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:05:27,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:27,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:05:27,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:05:28,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:05:28,438 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:05:35,259 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:05:35,263 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:05:36,719 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:05:36,724 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:05:36,730 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:05:36,742 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:05:36,744 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:05:36,745 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:05:36,748 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:05:36,749 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:05:36,751 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:05:36,753 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:05:36,758 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:05:36,760 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:05:36,764 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:05:36,765 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:05:36,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:05:44,194 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:05:47,549 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:05:47,551 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:05:47,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:05:54,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:05:55,163 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:06:04,455 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:06:22,379 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:06:22,381 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:06:22,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:06:29,717 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:06:29,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:06:30,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:06:30,636 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:06:44,420 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:06:44,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:06:51,787 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:07:05,061 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:07:12,487 - ispa_next.common.mail - INFO - Successfully sent an email to 4 recipients
2025-11-12 09:07:12,489 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:07:13,030 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:07:13,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:07:13,852 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:08:26,643 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:08:33,646 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:08:39,575 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:08:45,757 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:08:51,655 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:08:56,652 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:02,278 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:07,496 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:13,359 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:18,884 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:09:18,886 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:09:18,888 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:09:20,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:09:20,146 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:09:20,148 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:09:22,782 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:09:36,173 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:09:36,554 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 09:09:37,641 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:09:40,997 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1005
2025-11-12 09:09:40,999 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:09:45,612 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 473
2025-11-12 09:09:45,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:09:46,743 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:09:46,747 - ispa_next.main - DEBUG - 



2025-11-12 09:09:46,747 - ispa_next.main - DEBUG - starting with process 2 (EBE-LD 265) of 12
2025-11-12 09:09:46,752 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:09:48,503 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:09:50,340 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1005
2025-11-12 09:09:50,341 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 473
2025-11-12 09:09:52,520 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:09:52,521 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:10:23,227 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:10:35,538 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:10:38,783 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:10:38,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:10:38,872 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:10:39,273 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:10:48,141 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:10:48,147 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:10:48,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:10:48,250 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:10:51,735 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:10:51,736 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:10:52,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:10:55,004 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:10:55,157 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:10:55,299 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:10:55,399 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:10:59,620 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:11:00,627 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:11:00,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:01,163 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:16,040 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:11:25,590 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:11:25,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:11:25,703 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:11:25,703 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:11:25,811 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:11:27,153 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:11:27,397 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:11:30,588 - ispa_next.functions - DEBUG - Updated appointment (BV00000918) customer contact data.
2025-11-12 09:11:31,528 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:11:31,555 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:11:32,805 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:11:32,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:11:33,658 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:11:38,239 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:11:38,239 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:11:38,242 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:11:38,242 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:11:38,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:11:38,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:11:42,965 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:11:43,776 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 09:11:53,666 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:11:53,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:11:53,743 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:12:02,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:03,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:12:03,389 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:04,307 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:12:04,309 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:12:07,938 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:12:07,941 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:12:09,401 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:12:09,402 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:12:09,404 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:12:09,405 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:12:09,406 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:12:09,409 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:12:09,413 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:12:09,417 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:12:09,421 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:12:09,425 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:12:09,428 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:12:09,430 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:12:09,434 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:12:09,436 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:12:09,436 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:13,568 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:12:13,570 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:12:13,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:17,579 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:12:17,683 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:12:27,461 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:42,209 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:12:42,209 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:12:42,228 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:12:46,356 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:12:46,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:12:47,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:12:47,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:03,464 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:13:03,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:13:07,420 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:13:20,382 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:13:20,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:13:21,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:13:21,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:14:00,970 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:07,627 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:12,347 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:17,006 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:22,041 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:14:22,043 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:14:22,043 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:14:22,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:14:22,819 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:14:22,821 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:14:24,658 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:14:34,258 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:14:34,646 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 09:14:35,674 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:14:39,202 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:14:39,203 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:14:43,170 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:14:43,171 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:14:44,125 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:14:44,127 - ispa_next.main - DEBUG - 



2025-11-12 09:14:44,127 - ispa_next.main - DEBUG - starting with process 3 (M-X 8740) of 12
2025-11-12 09:14:44,135 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:14:45,381 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:14:46,672 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:14:46,673 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:14:48,421 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:14:48,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:15:13,930 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:15:26,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:15:27,976 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:15:27,978 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:28,052 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:15:28,294 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:15:28,296 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:15:28,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:15:28,388 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:15:45,112 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:15:45,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:15:45,441 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 09:15:46,225 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 09:15:46,245 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:15:46,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:15:47,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:15:48,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:15:48,051 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:15:48,077 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:15:50,668 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 09:15:50,671 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:15:54,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:15:54,652 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:15:58,581 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:15:58,582 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:15:59,450 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:15:59,453 - ispa_next.main - DEBUG - 



2025-11-12 09:15:59,453 - ispa_next.main - DEBUG - starting with process 4 (EBE-XC 42) of 12
2025-11-12 09:15:59,456 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:16:01,008 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:16:02,795 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:16:02,797 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:16:04,798 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:16:04,799 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:16:27,528 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:16:39,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:16:40,339 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:16:40,339 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:40,420 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:16:40,809 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:16:40,816 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:16:40,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:16:40,959 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:16:59,696 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:16:59,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:17:00,022 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 09:17:00,328 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 09:17:00,342 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:17:00,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:17:01,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:17:01,868 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:17:01,870 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:17:01,906 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:17:04,267 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 09:17:04,270 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:17:07,624 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:17:07,626 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:17:12,264 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:17:12,265 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:17:13,309 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:17:13,314 - ispa_next.main - DEBUG - 



2025-11-12 09:17:13,314 - ispa_next.main - DEBUG - starting with process 5 (WS BJ 2015) of 12
2025-11-12 09:17:13,318 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:17:14,930 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:17:16,679 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:17:16,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:17:18,689 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:17:18,690 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:17:53,716 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 09:17:53,727 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 09:17:53,730 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:17:54,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:17:54,483 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:17:58,987 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:17:58,988 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:00,217 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:18:00,221 - ispa_next.main - DEBUG - 



2025-11-12 09:18:00,221 - ispa_next.main - DEBUG - starting with process 6 (EBE-FM 57) of 12
2025-11-12 09:18:00,225 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:18:01,982 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:18:03,886 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:18:03,889 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:18:05,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:18:05,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:18:36,471 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:18:39,097 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:18:45,069 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:18:47,709 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:18:47,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:47,802 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:18:48,134 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 09:18:53,419 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:18:53,423 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:18:53,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:18:53,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:18:57,055 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:18:57,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:18:58,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:00,414 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:19:00,592 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:19:00,732 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:19:00,860 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:19:05,053 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:19:06,058 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:19:06,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:06,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:20,248 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:19:20,248 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:19:25,585 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:19:25,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:25,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:19:25,716 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:19:25,791 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:19:27,183 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:19:28,431 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:19:28,710 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:19:30,684 - ispa_next.functions - DEBUG - Updated appointment (AB00084453) customer contact data.
2025-11-12 09:19:31,611 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:19:31,613 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:19:32,724 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:19:32,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:19:33,679 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:19:37,769 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:19:37,769 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:19:37,773 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:19:37,773 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:19:37,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:38,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:42,458 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:19:42,462 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:19:42,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:42,570 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:19:48,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:48,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:19:48,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:19:49,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:19:49,848 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:19:52,488 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:19:52,490 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:19:54,246 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:19:54,250 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:19:54,254 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:19:54,256 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:19:54,258 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:19:54,258 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:19:54,262 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:19:54,262 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:19:54,264 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:19:54,264 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:19:54,268 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:19:54,270 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:19:54,273 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:19:54,274 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:19:54,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:56,922 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:19:56,923 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:19:56,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:19:59,499 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:19:59,499 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:19:59,507 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:02,164 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:20:02,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:20:03,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:20:03,459 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:14,753 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:20:14,755 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:17,332 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:20:31,551 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:20:32,108 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:20:32,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:20:32,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:20:57,885 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:02,451 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:07,669 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:21:07,670 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:21:07,672 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:08,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:21:08,589 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:21:08,591 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:21:11,058 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:21:21,255 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:21:21,638 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 09:21:22,133 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:26,441 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:21:26,443 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:30,970 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:21:30,971 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:21:32,139 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:21:32,142 - ispa_next.main - DEBUG - 



2025-11-12 09:21:32,142 - ispa_next.main - DEBUG - starting with process 7 (M-ZE 1903) of 12
2025-11-12 09:21:32,146 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:21:33,770 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:21:35,490 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:21:35,493 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:21:37,680 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:21:37,681 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:22:06,745 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:22:09,398 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:22:14,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:22:16,760 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:22:16,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:16,862 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:17,237 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:22:17,239 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:22:17,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:17,333 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:20,834 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:22:20,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:22:22,458 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:22:24,464 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:22:24,606 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:22:24,769 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:22:24,880 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:22:29,130 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:22:30,145 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:22:30,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:30,636 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:44,447 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:22:44,447 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:22:49,254 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:22:49,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:22:49,364 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:22:49,364 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:22:49,426 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:22:50,826 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:22:51,047 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:22:53,562 - ispa_next.functions - DEBUG - Updated appointment (AE00032707) customer contact data.
2025-11-12 09:22:54,453 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:22:54,454 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:22:55,336 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:22:55,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:22:56,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:23:00,351 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 09:23:00,351 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:23:00,351 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:23:00,355 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:23:00,357 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:23:00,357 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:00,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:05,143 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:23:05,150 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:23:05,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:05,258 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:23:14,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:14,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:23:14,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:23:15,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:23:15,849 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:23:17,818 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:23:17,820 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:23:19,301 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:23:19,301 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:19,304 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:23:19,313 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:23:19,315 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:23:19,317 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:23:19,318 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:23:19,318 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:23:19,320 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:23:19,322 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:23:19,322 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:23:19,324 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:23:19,328 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:23:19,330 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:23:19,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:21,298 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:23:21,298 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:23:21,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:23,214 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:23:23,214 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:23:23,218 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:25,156 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:23:25,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:23:26,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:23:26,571 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:37,172 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:23:37,174 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:23:39,130 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:23:52,332 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:23:52,855 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:23:53,453 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:23:53,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:24:12,829 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:24:18,462 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:24:18,463 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:24:18,463 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:24:19,267 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:24:19,374 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:24:19,374 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:24:21,271 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:24:29,363 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:24:29,730 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 09:24:30,339 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:24:34,036 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:24:34,038 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:24:38,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:24:38,758 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:24:39,957 - ispa_next.appointments.models - DEBUG - Appointment Simone Rochl Frau M-FW 627 WBAKS410200W58263 ohne Termin.
2025-11-12 09:24:39,960 - ispa_next.main - DEBUG - 



2025-11-12 09:24:39,960 - ispa_next.main - DEBUG - starting with process 8 (WS-M 505) of 12
2025-11-12 09:24:39,963 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:24:41,735 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:24:43,233 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1006
2025-11-12 09:24:43,235 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:24:45,169 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:24:45,171 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:25:16,121 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:25:18,490 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:25:24,668 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:25:27,916 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:25:27,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:28,038 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:25:28,387 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:25:28,389 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:25:28,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:28,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:25:37,347 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:25:37,350 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:25:38,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:25:40,885 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:25:41,049 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:25:41,168 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:25:41,278 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:25:45,547 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:25:46,552 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:25:46,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:25:47,018 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:02,697 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 09:26:07,376 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:26:07,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:07,472 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:26:07,474 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:26:07,575 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:26:09,235 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:26:10,457 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:26:10,665 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:26:12,692 - ispa_next.functions - DEBUG - Updated appointment (AJ00017350) customer contact data.
2025-11-12 09:26:13,606 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:26:13,608 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:26:14,744 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:26:14,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:26:16,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:26:20,189 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:26:20,189 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:26:20,193 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:26:20,195 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:26:20,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:20,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:26:24,890 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 09:26:29,652 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:26:29,652 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:29,783 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:26:30,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:30,697 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:26:30,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:26:31,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:26:31,631 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:26:34,681 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:26:34,687 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:26:35,949 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:26:35,951 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:26:35,952 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:26:35,953 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:26:35,954 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:26:35,955 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:26:35,957 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:26:35,959 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:26:35,961 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:26:35,964 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:26:35,968 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:26:35,970 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:26:35,976 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:26:35,978 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:26:35,978 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:39,307 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:26:42,494 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:26:42,535 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:26:42,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:45,992 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:26:45,992 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:26:45,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:26:49,377 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:26:49,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:26:50,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:26:50,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:01,241 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:27:01,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:04,629 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:27:16,956 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:27:17,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:27:18,088 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:27:18,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:27:50,105 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:27:54,944 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:27:59,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:28:04,909 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:28:04,911 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:28:04,911 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:05,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:28:05,863 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:28:05,865 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:28:08,233 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:28:18,722 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:28:19,113 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 09:28:19,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:23,509 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1007
2025-11-12 09:28:23,510 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:28,160 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:28:28,161 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:28:29,288 - ispa_next.main - DEBUG - Found new Appointment: EBE-CP 214
2025-11-12 09:28:29,291 - ispa_next.main - DEBUG - 



2025-11-12 09:28:29,291 - ispa_next.main - DEBUG - starting with process 9 (EBE-CP 214) of 13
2025-11-12 09:28:29,295 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:28:30,797 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:28:32,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1007
2025-11-12 09:28:32,453 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:28:34,582 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:28:34,583 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:29:10,188 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:29:21,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:21,956 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:22,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:29:23,403 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:29:23,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:23,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:23,875 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:29:23,878 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:29:23,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:29:23,989 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:29:36,420 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:29:36,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:29:37,942 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:29:39,948 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:29:40,070 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:29:40,244 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:29:40,410 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:29:40,410 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:29:51,425 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 09:29:56,105 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 09:29:56,105 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:30:00,325 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 09:30:01,330 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:30:01,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:01,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:15,201 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:30:15,201 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:30:24,627 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:30:24,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:24,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:30:24,759 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:30:24,831 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:30:26,177 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:30:27,517 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:30:27,721 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:30:32,042 - ispa_next.functions - DEBUG - Updated appointment (AO00010648) customer contact data.
2025-11-12 09:30:33,020 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:30:33,022 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:30:34,618 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:30:34,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:30:35,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:30:39,395 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:30:39,395 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:30:39,399 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:30:39,401 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:30:39,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:39,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:44,168 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:30:44,173 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:30:44,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:44,262 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:30:44,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:45,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:30:45,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:30:46,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:30:46,142 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:30:47,487 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:30:47,490 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:30:48,801 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:30:48,805 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:48,809 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:30:48,811 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:30:48,813 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:30:48,814 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:30:48,816 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:30:48,817 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:30:48,818 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:30:48,819 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:30:48,820 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:30:48,822 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:30:48,824 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:30:48,826 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:30:48,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:50,097 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:30:50,101 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:30:50,105 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:51,319 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:30:51,319 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:30:51,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:30:52,553 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:30:52,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:30:53,655 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:30:53,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:01,703 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:31:01,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:02,914 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:31:17,591 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:31:18,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:31:18,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:31:18,905 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:31:31,875 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:31:31,877 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:31:31,879 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:32,750 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:31:32,852 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:31:32,854 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:31:35,266 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:31:45,387 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:31:45,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 09:31:46,212 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:50,192 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1007
2025-11-12 09:31:50,194 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:31:54,910 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 471
2025-11-12 09:31:54,911 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:31:56,066 - ispa_next.main - DEBUG - 



2025-11-12 09:31:56,066 - ispa_next.main - DEBUG - starting with process 10 (EBE-AS 109) of 13
2025-11-12 09:31:56,070 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:31:57,401 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:31:59,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1007
2025-11-12 09:31:59,135 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 471
2025-11-12 09:32:01,140 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:32:01,141 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:32:44,825 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:32:47,695 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:32:53,668 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:32:53,751 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:32:53,960 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:33:04,228 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:33:04,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:04,341 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:04,604 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-12 09:33:10,236 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:33:10,238 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:33:10,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:10,357 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:19,640 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:33:19,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:33:21,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:33:23,324 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:33:23,462 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:33:23,656 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:33:23,815 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:33:23,816 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:33:32,791 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 09:33:33,796 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:33:33,797 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:34,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:40,590 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 09:33:40,594 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:33:40,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:33:40,731 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:33:40,731 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:33:40,813 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:33:40,962 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:33:42,360 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 09:33:43,601 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 09:33:43,984 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:33:46,092 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:33:46,096 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:33:46,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:33:47,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:33:49,346 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:33:49,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:33:49,456 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:33:53,112 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:33:53,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:33:53,627 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:33:55,631 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:33:55,788 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:33:55,963 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:33:56,068 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 09:33:56,068 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:34:05,118 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:35:05,121 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:35:14,518 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 09:35:45,520 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 09:35:54,523 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 09:36:03,170 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 09:36:04,176 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:36:04,176 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:36:04,178 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:04,262 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:36:08,447 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:36:08,451 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:36:08,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:08,536 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:36:08,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:09,452 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:36:09,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:36:10,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:36:10,212 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:36:19,233 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:36:19,235 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:36:21,371 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 263, in run
    self._update_advice_list_content()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 40, in _update_advice_list_content
    self.containers[Container.ADVICE_LIST] = self.ui_helper.get_advice_list_content(self.base_element)
                                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 168, in get_advice_list_content
    cart_package_name = item.get_first_child().get_value()
                        ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 346, in get_first_child
    found = m.get_first_child(
            ^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 639, in get_first_child
    _raise_not_found_error()
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 630, in _raise_not_found_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'GetFirstChildElement' didn't return an Element pointer.


2025-11-12 09:36:21,393 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:36:21,396 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:36:22,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:36:23,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:36:23,347 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 09:36:23,378 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 09:36:29,391 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 09:36:29,394 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:30,093 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1008
2025-11-12 09:36:30,095 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:34,940 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 471
2025-11-12 09:36:34,941 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:36:35,982 - ispa_next.main - DEBUG - 



2025-11-12 09:36:35,982 - ispa_next.main - DEBUG - starting with process 11 (M-MV 6001) of 13
2025-11-12 09:36:35,987 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:36:37,256 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:36:38,567 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1008
2025-11-12 09:36:38,568 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 471
2025-11-12 09:36:40,660 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:36:40,662 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:37:08,960 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:37:11,190 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:37:17,066 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:37:19,004 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:37:19,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:19,116 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:19,447 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:37:19,449 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:37:19,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:19,568 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:23,037 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:37:23,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:24,622 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:37:26,627 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:37:26,777 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:37:26,967 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:37:27,059 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:37:31,324 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:37:32,330 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:37:32,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:32,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:43,895 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:37:48,077 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:37:48,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:37:48,172 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:37:48,172 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:37:48,258 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:37:49,539 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:37:49,752 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:37:51,903 - ispa_next.functions - DEBUG - Updated appointment (AB00085497) customer contact data.
2025-11-12 09:37:52,829 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:37:52,833 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:37:53,969 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:37:53,969 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:37:55,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:37:58,611 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:37:58,611 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:37:58,615 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:37:58,615 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:37:58,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:37:59,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:03,263 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:38:03,266 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:38:03,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:03,370 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:38:09,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:09,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:38:09,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:38:10,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:38:10,263 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:38:12,192 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:38:12,192 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:38:14,294 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:38:14,295 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:14,307 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:38:14,310 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:38:14,311 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:38:14,312 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:38:14,314 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:38:14,316 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:38:14,316 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:38:14,318 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:38:14,318 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:38:14,320 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:38:14,324 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:38:14,326 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:38:14,326 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:16,318 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:38:16,320 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:38:16,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:18,264 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:38:18,264 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:38:18,266 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:20,159 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:38:20,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:38:21,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:38:21,621 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:36,795 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:38:36,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:38:38,735 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:38:52,594 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:38:53,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:38:53,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:38:53,967 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:39:12,938 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:17,837 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:39:17,840 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:39:17,841 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:18,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:39:18,798 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:39:18,800 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:39:21,221 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:39:30,376 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:39:30,757 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 09:39:31,537 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:34,990 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1009
2025-11-12 09:39:34,992 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:38,960 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:39:38,961 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:39:39,881 - ispa_next.appointments.models - DEBUG - Appointment Thomas Felbermair Herr EBE-MF 76E WMW11DJ0102U00433 ohne Termin.
2025-11-12 09:39:39,887 - ispa_next.main - DEBUG - 



2025-11-12 09:39:39,887 - ispa_next.main - DEBUG - starting with process 12 (EBE-XV 60) of 13
2025-11-12 09:39:39,890 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:39:41,210 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:39:42,552 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1009
2025-11-12 09:39:42,554 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:39:44,391 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:39:44,392 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:40:14,365 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:40:16,981 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:40:22,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:40:26,760 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:40:26,762 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:26,853 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:27,231 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:40:27,234 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:40:27,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:27,344 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:40:36,554 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:40:36,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:40:38,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:40:40,052 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:40:40,192 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:40:40,342 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:40:40,422 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:40:44,635 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:40:45,639 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:40:45,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:40:46,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:00,073 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:41:00,073 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:41:06,252 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:41:06,255 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:06,375 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:41:06,376 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:41:06,433 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:41:06,594 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:41:07,921 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:41:08,130 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:41:10,261 - ispa_next.functions - DEBUG - Updated appointment (AF00027213) customer contact data.
2025-11-12 09:41:11,200 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:41:11,201 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:41:11,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:41:12,851 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:41:13,979 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:41:13,979 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:41:14,063 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 09:41:17,767 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:41:17,768 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:41:17,772 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:41:17,772 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:41:17,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:18,287 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:22,448 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:41:22,452 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:41:22,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:22,546 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:41:22,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:23,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:41:23,442 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:41:24,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:41:24,253 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:41:28,015 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:41:28,016 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:41:29,793 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:41:29,793 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:29,795 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:41:29,797 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:41:29,804 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:41:29,807 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:41:29,810 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 09:41:29,812 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:41:29,814 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:41:29,816 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:41:29,816 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:41:29,818 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:41:29,822 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:41:29,823 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:41:29,823 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:33,934 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:41:33,935 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:41:33,938 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:38,046 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:41:38,046 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:41:38,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:42,051 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:41:42,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:41:43,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:41:43,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:54,564 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:41:54,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:41:58,572 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:42:12,939 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:42:13,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:42:14,078 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:42:14,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:42:53,995 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:42:58,481 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:04,020 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:09,159 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:15,744 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:43:15,746 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:43:15,748 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:43:16,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:43:16,686 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:43:16,688 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:43:19,075 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:43:27,997 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:43:28,410 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 09:43:29,181 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:43:32,861 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1009
2025-11-12 09:43:32,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:43:37,580 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:43:37,581 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:43:38,749 - ispa_next.main - DEBUG - Found new Appointment: EBE-MF 76E
2025-11-12 09:43:38,750 - ispa_next.main - DEBUG - 



2025-11-12 09:43:38,751 - ispa_next.main - DEBUG - starting with process 13 (EBE-MF 76E) of 14
2025-11-12 09:43:38,755 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:43:40,288 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:43:41,912 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1009
2025-11-12 09:43:41,914 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:43:44,069 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:43:44,071 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:44:20,364 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:44:32,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:44:33,927 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:44:33,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:34,029 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:44:34,349 - ispa_next.functions - DEBUG - HU date soon to be invalid in 66 days.
2025-11-12 09:44:42,791 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:44:42,793 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:44:42,795 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:42,921 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:44:46,447 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:44:46,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:44:47,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:44:49,786 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:44:49,917 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:44:50,054 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:44:50,172 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:44:54,351 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:44:55,357 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:44:55,359 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:44:55,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:07,831 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 09:45:16,676 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:45:16,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:16,791 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:45:16,792 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:45:16,859 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:45:18,130 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 09:45:19,450 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:45:19,673 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:45:24,812 - ispa_next.functions - DEBUG - Updated appointment (AJ00018143) customer contact data.
2025-11-12 09:45:25,759 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:45:25,772 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:45:26,952 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:45:26,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:45:28,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:45:31,735 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:45:31,735 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:45:31,737 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:45:31,739 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:45:31,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:45:32,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:45:36,479 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:45:36,483 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:45:36,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:45:36,560 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:45:45,331 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:45,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:45:45,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:45:46,687 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:45:46,687 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:45:47,976 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:45:47,978 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:45:49,488 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:45:49,489 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:45:49,491 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:45:49,493 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:45:49,495 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:45:49,497 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:45:49,505 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:45:49,505 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:45:49,509 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:45:49,509 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:45:49,511 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:45:49,513 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:45:49,515 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:45:49,517 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:50,695 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:45:50,695 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:45:50,697 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:51,919 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:45:51,919 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:45:51,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:45:53,160 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:45:53,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:45:54,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:45:54,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:00,711 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:46:00,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:01,985 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:46:15,887 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:46:16,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:46:16,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:46:17,199 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:46:30,691 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:46:30,692 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:46:30,694 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:46:31,547 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:46:31,634 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:46:31,635 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:46:34,020 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:46:44,635 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:46:45,015 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 09:46:45,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:46:49,300 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1009
2025-11-12 09:46:49,302 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:46:54,041 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 472
2025-11-12 09:46:54,042 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:46:55,249 - ispa_next.main - DEBUG - 



2025-11-12 09:46:55,250 - ispa_next.main - DEBUG - starting with process 14 (EBE-AU 51) of 14
2025-11-12 09:46:55,254 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:46:57,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:46:58,719 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1009
2025-11-12 09:46:58,720 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 472
2025-11-12 09:47:01,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 09:47:01,589 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 09:47:39,514 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 09:47:42,241 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 09:47:48,594 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:47:53,290 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 09:47:53,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:53,358 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:53,617 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 09:47:53,619 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 09:47:53,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:47:53,716 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:47:57,202 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:47:57,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:47:58,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:48:00,554 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 09:48:00,708 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 09:48:00,808 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 09:48:00,930 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 09:48:05,134 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 09:48:06,138 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 09:48:06,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:06,632 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:20,464 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 09:48:20,464 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 09:48:25,988 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 09:48:25,990 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:26,075 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 09:48:26,076 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 09:48:26,152 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 09:48:27,443 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 09:48:27,637 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 09:48:29,797 - ispa_next.functions - DEBUG - Updated appointment (AZ00004184) customer contact data.
2025-11-12 09:48:30,691 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 09:48:30,693 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 09:48:31,650 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 09:48:31,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 09:48:32,593 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 09:48:36,202 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 09:48:36,202 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 09:48:36,205 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 09:48:36,206 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 09:48:36,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:36,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:48:40,822 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 09:48:40,826 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 09:48:40,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:40,946 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 09:48:49,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:50,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 09:48:50,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 09:48:51,248 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 09:48:51,248 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 09:48:55,790 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 09:48:55,793 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 09:48:57,364 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 09:48:57,366 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:48:57,368 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 09:48:57,368 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 09:48:57,370 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 09:48:57,370 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 09:48:57,372 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 09:48:57,372 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 09:48:57,375 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 09:48:57,375 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 09:48:57,377 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 09:48:57,379 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 09:48:57,381 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 09:48:57,381 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:02,116 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 09:49:05,014 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 09:49:05,023 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 09:49:05,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:10,091 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 09:49:10,091 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 09:49:10,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:14,916 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 09:49:14,918 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 09:49:16,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 09:49:16,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:28,307 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 09:49:28,310 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:49:33,059 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 09:49:47,785 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 09:49:48,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:49:48,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 09:49:49,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 09:50:35,800 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:40,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:46,822 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:52,460 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:50:57,636 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:51:04,340 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 09:51:04,342 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 09:51:04,342 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 09:51:05,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 09:51:05,348 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 09:51:05,349 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 09:51:07,747 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 09:51:18,501 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 09:51:18,877 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 09:51:19,477 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 09:51:23,356 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1010
2025-11-12 09:51:23,358 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 09:51:28,138 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 473
2025-11-12 09:51:28,139 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
