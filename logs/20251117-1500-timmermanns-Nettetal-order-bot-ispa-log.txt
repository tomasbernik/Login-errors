2025-11-17 15:21:35,563 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:21:35,571 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:21:43,726 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:21:55,131 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:22:10,794 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:22:34,450 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:22:47,944 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:22:51,046 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:22:52,294 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:22:52,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 414
2025-11-17 15:22:54,949 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-17 15:22:54,949 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:22:54,950 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:22:56,239 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:22:57,454 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:23:16,287 - ispa_next.appointments.models - DEBUG - Couldn't parse Appointment Jaffar Karimi KK.KK.210 WBA7M910905R43994, 1 validation error for Appointment
Kennzeichen
  Value error, 'Kennzeichen' includes unallowed special characters. [type=value_error, input_value='KK.KK.210', input_type=str]
    For further information visit https://errors.pydantic.dev/2.11/v/value_error
2025-11-17 15:23:16,298 - ispa_next.appointments.models - DEBUG - Appointment Jens Melis VIE-EJ 109 WBA5J71080GZ77644 ohne Termin.
2025-11-17 15:23:16,306 - ispa_next.appointments.models - DEBUG - Appointment Frank Felscher VIE-F 815 WBA6L31010FJ48668 ohne Termin.
2025-11-17 15:23:16,313 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:23:16,314 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:23:16,322 - ispa_next.appointments.models - DEBUG - Appointment Mario Krehan KK-M 441E WBY11CF090CR04338 ohne Termin.
2025-11-17 15:23:16,331 - ispa_next.appointments.models - DEBUG - Appointment Herbert Trienekens & Partner VIE-T 1515 WBA15BZ040N231326 ohne Termin.
2025-11-17 15:23:16,334 - ispa_next.main - DEBUG - Found 5 out of 7 appointments to process (configured limit: 15).
2025-11-17 15:23:16,334 - ispa_next.main - DEBUG - Processing 5 fresh appointments.
2025-11-17 15:23:16,335 - ispa_next.main - DEBUG - All appointments: BN-TD 5505, BN-TD 5505, DU-JS 987, VIE-DE 35E, 3P09137
2025-11-17 15:23:16,337 - ispa_next.main - DEBUG - 



2025-11-17 15:23:16,337 - ispa_next.main - DEBUG - starting with process 1 (BN-TD 5505) of 5
2025-11-17 15:23:16,340 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:23:17,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:23:18,120 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:23:18,122 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-17 15:23:19,251 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:23:19,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:23:50,764 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:24:00,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:02,673 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:24:02,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:02,747 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:02,960 - ispa_next.functions - DEBUG - HU date already expired after 5 days.
2025-11-17 15:24:10,273 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:24:10,276 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:24:13,089 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:13,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:14,137 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:16,143 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:24:16,268 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:24:16,377 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:24:16,512 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:24:20,729 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:24:21,747 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:24:21,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:22,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:33,511 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:24:40,997 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:24:41,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:41,091 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:41,091 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:24:41,173 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:24:42,503 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:24:42,729 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:24:44,833 - ispa_next.functions - DEBUG - Updated appointment (AA00025303) customer contact data.
2025-11-17 15:24:45,754 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:24:45,756 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:24:46,634 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:24:46,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:47,355 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:24:51,433 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 15:24:51,433 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:51,433 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:24:51,436 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:24:51,439 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:24:51,440 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:51,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:57,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:58,025 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:58,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:58,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:58,844 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:25:00,686 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:25:00,688 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:25:01,732 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:25:01,737 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:01,740 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:25:01,744 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 15:25:01,745 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:25:01,747 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:25:01,748 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:25:01,749 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:25:01,751 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:25:01,752 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:25:01,753 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:25:01,755 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:25:02,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 15:25:03,207 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 15:25:12,586 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:25:12,589 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:25:12,590 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:25:12,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:15,156 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:25:15,157 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:25:15,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:17,684 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:25:17,685 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:25:17,686 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:25:17,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:20,285 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:25:32,081 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:25:32,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:25:33,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:25:33,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:58,221 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:03,127 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:07,923 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:07,924 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:07,925 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:08,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:08,708 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:08,710 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:10,579 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:26:20,767 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:26:21,156 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:26:21,499 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:22,490 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:26:22,491 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:25,374 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 414
2025-11-17 15:26:25,375 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:26,212 - ispa_next.appointments.models - DEBUG - Appointment Herbert Gockel VIE-HG 428 WBA4A71050D412023 ohne Termin.
2025-11-17 15:26:26,226 - ispa_next.main - DEBUG - 



2025-11-17 15:26:26,226 - ispa_next.main - DEBUG - starting with process 2 (BN-TD 5505) of 5
2025-11-17 15:26:26,230 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:27,413 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:28,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:26:28,752 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 414
2025-11-17 15:26:30,115 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:30,117 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:07,248 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:27:17,010 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:19,576 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:27:19,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:19,653 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:19,924 - ispa_next.functions - DEBUG - HU date soon to be invalid in 13 days.
2025-11-17 15:27:26,677 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:27:26,680 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:27:29,496 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:27:29,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:27:30,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:27:32,364 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:27:32,467 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:27:32,536 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:27:32,616 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:27:36,823 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:27:37,827 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:27:37,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:38,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:50,423 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:27:57,562 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:27:57,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:57,653 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:57,654 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:27:57,695 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:27:58,908 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:27:59,121 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:28:01,435 - ispa_next.functions - DEBUG - Updated appointment (AA00025302) customer contact data.
2025-11-17 15:28:02,345 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:28:02,346 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:28:03,001 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:28:03,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:28:03,747 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:28:07,387 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:28:07,388 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:28:07,408 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:28:07,410 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:28:07,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:28:07,870 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:28:13,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:13,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:13,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:28:14,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:28:14,495 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:28:16,901 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:28:16,903 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:28:17,784 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:28:17,787 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:28:17,788 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:28:17,789 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 15:28:17,811 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:28:17,814 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:28:17,817 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:28:17,818 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:28:17,820 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:28:17,829 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:28:17,833 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:28:17,836 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:28:18,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 15:28:19,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 15:28:28,685 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:28:28,687 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:28:28,687 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:28:28,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:31,978 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:28:31,980 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:28:31,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:35,230 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:28:35,231 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:28:35,232 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:28:35,234 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:38,479 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:28:51,457 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:28:52,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:28:52,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:28:52,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:12,347 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:29:12,347 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:29:13,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:29:13,105 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:29:13,106 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:29:16,478 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:29:24,136 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:29:24,532 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:29:25,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:29:26,133 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:29:26,134 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:28,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 414
2025-11-17 15:29:28,758 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:29:29,582 - ispa_next.appointments.models - DEBUG - Appointment Herbert Gockel VIE-HG 428 WBA4A71050D412023 ohne Termin.
2025-11-17 15:29:29,587 - ispa_next.main - DEBUG - 



2025-11-17 15:29:29,587 - ispa_next.main - DEBUG - starting with process 3 (DU-JS 987) of 5
2025-11-17 15:29:29,593 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:29:30,808 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:29:32,148 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:29:32,150 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 414
2025-11-17 15:29:33,538 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:29:33,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:30:09,918 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:30:19,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:19,938 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:30:20,099 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:21,324 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:30:21,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:21,403 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:30:21,676 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:30:21,679 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:30:24,487 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:30:24,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:30:25,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:30:27,345 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:30:33,344 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 15:30:40,703 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 15:30:41,707 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:30:41,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:42,222 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:51,856 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 15:30:59,637 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:30:59,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:30:59,723 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:30:59,725 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:30:59,793 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:30:59,919 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:31:01,353 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:31:01,603 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:31:04,802 - ispa_next.functions - DEBUG - Updated appointment (AA00025301) customer contact data.
2025-11-17 15:31:05,736 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:31:05,738 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:31:05,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:31:06,549 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:31:08,125 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:31:08,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:31:08,233 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:31:11,823 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:31:11,823 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:31:11,826 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:31:11,829 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:31:11,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:12,337 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:31:12,761 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:13,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:13,292 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:13,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:31:13,973 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:31:15,884 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:31:15,886 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:31:17,137 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:31:17,140 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:31:17,143 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:31:17,146 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 15:31:17,149 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:31:17,151 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:31:17,152 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:31:17,154 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:31:17,155 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:31:17,157 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:31:17,159 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:31:17,161 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:31:17,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 15:31:18,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 15:31:28,209 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:31:28,211 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:31:28,212 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:31:28,213 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:30,770 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:31:30,771 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:31:30,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:33,283 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:31:33,284 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:31:33,285 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:31:33,287 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:35,854 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:31:49,121 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:31:49,718 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:31:50,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:31:50,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:15,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:32:19,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:32:24,560 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:32:24,561 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:32:24,562 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:32:25,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:32:25,302 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:32:25,303 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:32:27,099 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:32:33,931 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:32:34,309 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:32:34,649 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:32:35,678 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:32:35,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:32:38,430 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 413
2025-11-17 15:32:38,430 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:32:39,284 - ispa_next.appointments.models - DEBUG - Appointment Herbert Gockel VIE-HG 428 WBA4A71050D412023 ohne Termin.
2025-11-17 15:32:39,289 - ispa_next.main - DEBUG - 



2025-11-17 15:32:39,289 - ispa_next.main - DEBUG - starting with process 4 (VIE-DE 35E) of 5
2025-11-17 15:32:39,292 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:32:40,521 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:32:41,675 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:32:41,677 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 413
2025-11-17 15:32:43,236 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:32:43,237 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:33:17,568 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:33:26,263 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:33:26,346 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:33:26,474 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:27,685 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:33:27,686 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:33:27,759 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:33:27,973 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:33:27,975 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:33:30,688 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:33:30,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:33:31,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:33:33,522 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:33:33,668 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:33:36,894 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:33:37,039 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:33:37,041 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:38,263 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:33:49,550 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:33:50,554 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:33:50,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:33:51,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:34:03,009 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:34:03,009 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:34:10,612 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:34:10,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:34:10,721 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:34:10,722 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:34:10,756 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:34:12,029 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:34:12,258 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:34:14,300 - ispa_next.functions - DEBUG - Updated appointment (AA00025300) customer contact data.
2025-11-17 15:34:15,216 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:34:15,217 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:34:16,191 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:34:16,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:34:16,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:34:20,508 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:34:20,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:34:21,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:34:23,018 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:34:23,111 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:34:23,238 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:34:23,298 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:34:23,299 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:34:24,523 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:34:35,899 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:34:43,175 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:34:43,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:34:45,176 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:34:49,413 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:34:50,419 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:34:50,422 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:34:50,423 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 15:34:50,423 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:34:52,283 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:34:52,285 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:34:53,162 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:34:53,164 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:34:53,169 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:34:53,172 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 15:34:53,175 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:34:53,177 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 15:34:53,184 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:34:53,187 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:34:53,188 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:34:53,190 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:34:53,204 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:34:53,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 15:34:54,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 15:35:03,811 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:35:03,813 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:35:06,063 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:35:06,633 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:35:07,617 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:35:08,216 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:35:08,737 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:35:10,110 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:35:10,682 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:35:11,239 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:35:12,217 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:35:13,340 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:35:14,268 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:35:14,857 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:35:14,861 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:35:14,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:16,770 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:35:16,771 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:35:16,774 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:18,678 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:35:18,679 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:35:18,680 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:35:18,682 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:20,619 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:35:33,006 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:35:33,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:35:34,165 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:35:34,374 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:46,267 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:35:46,268 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:35:46,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:35:46,903 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:35:46,904 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:35:49,944 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:35:58,525 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:35:58,914 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:35:59,352 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:36:00,388 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:36:00,393 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:36:03,063 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 413
2025-11-17 15:36:03,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:36:03,809 - ispa_next.appointments.models - DEBUG - Appointment Herbert Gockel VIE-HG 428 WBA4A71050D412023 ohne Termin.
2025-11-17 15:36:03,812 - ispa_next.main - DEBUG - 



2025-11-17 15:36:03,812 - ispa_next.main - DEBUG - starting with process 5 (3P09137) of 5
2025-11-17 15:36:03,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:36:04,699 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:36:05,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:36:05,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 413
2025-11-17 15:36:06,974 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:36:06,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:36:35,670 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:36:45,033 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:46,972 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:36:46,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:47,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:36:47,436 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:36:47,438 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:36:50,273 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:36:50,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:51,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:53,318 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:36:53,451 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:36:53,561 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:36:53,641 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:36:57,854 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:36:58,858 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:36:58,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:59,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:11,417 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:37:11,417 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:37:19,219 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:37:19,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:19,297 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:37:19,298 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:37:19,330 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:37:20,620 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:37:20,841 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:37:24,207 - ispa_next.functions - DEBUG - Updated appointment (AA00025299) customer contact data.
2025-11-17 15:37:25,121 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:37:25,160 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:37:26,145 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:37:26,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:37:26,879 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:37:30,474 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:37:30,474 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:37:30,476 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:37:30,479 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:37:30,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:37:30,958 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:37:31,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:31,906 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:37:31,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:37:32,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:37:32,704 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:37:34,657 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:37:34,659 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:37:35,679 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:37:35,680 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:37:35,682 - ispa_next.package_manager.main - DEBUG - Cannot place Ölwechsel im Doppelkupplungsgetriebe inkl. Altölen: placement requirements not met
2025-11-17 15:37:35,684 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Timmermanns Service, source=from_tab, target=cart)}
2025-11-17 15:37:35,685 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:37:35,687 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:37:35,688 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:37:35,689 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:37:35,690 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:37:35,699 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:37:35,703 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:37:35,706 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:37:36,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 15:37:37,092 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 15:37:46,460 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:37:46,462 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:37:46,463 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:37:46,463 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:49,158 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:37:52,211 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:37:52,373 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:37:52,388 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:55,169 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:37:55,170 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:37:55,175 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:37:55,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:57,726 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:38:10,409 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:38:10,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:38:11,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:38:11,690 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:36,658 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:38:42,462 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:38:46,835 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:38:53,028 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:38:53,029 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:38:53,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:38:53,722 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:38:53,723 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:38:57,154 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:39:05,480 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:39:05,876 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:39:06,345 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:39:07,840 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 756
2025-11-17 15:39:07,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:11,090 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 412
2025-11-17 15:39:11,091 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:39:11,962 - ispa_next.appointments.models - DEBUG - Appointment Herbert Gockel VIE-HG 428 WBA4A71050D412023 ohne Termin.
