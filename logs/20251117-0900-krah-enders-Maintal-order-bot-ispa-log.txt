2025-11-17 09:00:37,081 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 09:00:37,090 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 09:00:49,534 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 09:00:59,923 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 09:01:15,345 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:03:13,087 - ispa_next.app_start.main - DEBUG - Operation already took 106.45 seconds (more than 80 seconds)
2025-11-17 09:03:15,158 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\33d539b2bb3134a4\\tess_yl3j1kn9_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\33d539b2bb3134a4\\tess_yl3j1kn9', 'txt']
2025-11-17 09:03:15,437 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 09:03:15,442 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 09:03:15,443 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 09:04:12,785 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 09:04:23,765 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 09:04:26,283 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:04:27,514 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 09:04:27,515 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 204
2025-11-17 09:04:29,502 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 147
2025-11-17 09:04:29,502 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 09:04:29,503 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:04:30,292 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 09:04:31,049 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:04:48,590 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 09:04:48,590 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:48,592 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:48,619 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 09:04:48,662 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-17 09:04:48,687 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-17 09:04:48,697 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-17 09:04:48,708 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-17 09:04:48,716 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-17 09:04:48,725 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-17 09:04:48,735 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-17 09:04:48,744 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-17 09:04:48,778 - ispa_next.main - DEBUG - Found 15 out of 124 appointments to process (configured limit: 15).
2025-11-17 09:04:48,778 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 09:04:48,778 - ispa_next.main - DEBUG - All appointments: F-RR 8716, F-CS 2192, HU-MJ 28, HU AC78E, HU-TK 1402, HU-PW 667, FB-B 985, HU-KJ 81, HU-XS 108, HU-AS 958, OF-JF 333, FB-SR 1700, MKK-RM 157, GN-BB 156, MKK-MG 366
2025-11-17 09:04:48,781 - ispa_next.main - DEBUG - 



2025-11-17 09:04:48,781 - ispa_next.main - DEBUG - starting with process 1 (F-RR 8716) of 15
2025-11-17 09:04:48,788 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:04:49,962 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:04:51,040 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 667
2025-11-17 09:04:51,041 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 147
2025-11-17 09:04:52,377 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:04:52,378 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:05:15,791 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:05:19,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:19,106 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:05:19,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:20,466 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:05:20,467 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:20,551 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:05:20,728 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-17 09:05:27,506 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:05:27,509 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:05:27,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:27,576 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:05:37,729 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:05:37,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:05:38,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:05:40,706 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:05:40,811 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:05:44,070 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:05:44,150 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:05:44,151 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:05:45,408 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:05:56,642 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:05:57,647 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:05:57,652 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:05:57,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:58,157 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:05:58,161 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:05:58,228 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:05:58,312 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:05:59,364 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:05:59,581 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:06:03,308 - ispa_next.functions - DEBUG - Updated appointment (AB00028034) customer contact data.
2025-11-17 09:06:04,198 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:06:04,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:06:04,308 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:06:04,477 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:06:04,480 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:06:04,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:06:05,377 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:06:06,759 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:06:06,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:06:06,846 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:06:11,326 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:06:11,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:06:11,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:06:13,852 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:06:13,955 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:06:14,047 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:06:14,142 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:06:14,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:06:16,770 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:06:28,409 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:07:28,411 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:07:39,612 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:08:16,614 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:08:27,889 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:08:35,844 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 09:08:36,852 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:08:36,853 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:08:36,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:08:36,921 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:08:41,074 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:08:41,079 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:08:41,079 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 09:08:41,079 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:08:43,518 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:08:43,522 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:08:44,704 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:08:44,707 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:08:44,709 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:08:44,710 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:08:44,713 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:08:44,714 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:08:44,717 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:08:44,719 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:08:44,720 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:08:44,722 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:08:44,725 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:08:44,728 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:08:44,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:08:47,295 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:08:47,297 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:08:47,311 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:08:49,846 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:08:49,848 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:08:49,851 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:08:49,853 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:08:52,441 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:08:52,443 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:08:53,082 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:08:53,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:08:53,981 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:09:18,854 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:09:22,781 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:09:26,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:09:26,943 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:09:26,944 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:09:27,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:09:27,490 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:09:27,493 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:09:29,142 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:09:39,186 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:09:39,567 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 09:09:39,827 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:09:40,843 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 668
2025-11-17 09:09:40,845 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:09:43,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 09:09:43,513 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:09:44,089 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:09:44,098 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:09:44,107 - ispa_next.main - DEBUG - Found new Appointment: MKK-RS 25
2025-11-17 09:09:44,108 - ispa_next.main - DEBUG - 



2025-11-17 09:09:44,108 - ispa_next.main - DEBUG - starting with process 2 (MKK-RS 25) of 16
2025-11-17 09:09:44,112 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:09:44,864 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:09:45,684 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 668
2025-11-17 09:09:45,685 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 09:09:46,892 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:09:46,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:10:16,411 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:10:19,639 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:20,802 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:10:20,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:20,880 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:10:21,120 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:10:21,125 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:10:21,126 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:21,231 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:10:24,464 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:10:24,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:25,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:10:27,158 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:10:27,255 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 09:10:28,262 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:10:28,266 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:10:28,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:28,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:28,851 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:10:28,896 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:10:30,133 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:10:31,422 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:10:31,693 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:10:34,382 - ispa_next.functions - DEBUG - Updated appointment (AB00028039) customer contact data.
2025-11-17 09:10:35,270 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:10:35,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:35,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:10:35,685 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:10:35,687 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:10:36,371 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:10:36,371 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:10:37,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:10:40,672 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:10:40,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:41,155 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:10:43,158 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:10:43,244 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_cbs_table
2025-11-17 09:10:44,250 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:10:44,251 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:10:44,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:44,324 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:10:44,885 - ispa_next.functions - DEBUG - check_service_requirement couldn't find CBS table, returning False
2025-11-17 09:10:44,889 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:10:44,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:44,966 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:10:50,506 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:51,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:10:51,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:10:51,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:10:51,651 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:10:52,908 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:10:52,910 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:10:53,533 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:10:53,534 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:10:53,535 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:10:53,535 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:10:53,536 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:10:53,537 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:10:53,538 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:10:53,539 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:10:53,540 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:10:53,541 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:10:53,544 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:10:53,546 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:10:53,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:54,720 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:10:54,723 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:10:54,725 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:55,919 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:10:55,922 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:10:55,924 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:10:55,926 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:10:57,125 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:10:57,127 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:10:57,623 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:10:58,178 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:10:58,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:11:09,951 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:11:09,954 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:11:09,955 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:11:10,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:11:10,663 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:11:10,665 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:11:12,716 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:11:21,119 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:11:21,503 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 09:11:21,635 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:22,629 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:11:22,630 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:25,776 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:11:25,781 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:11:26,606 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:11:26,626 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:11:26,636 - ispa_next.main - DEBUG - Found new Appointment: MKK RN 24
2025-11-17 09:11:26,638 - ispa_next.main - DEBUG - 



2025-11-17 09:11:26,638 - ispa_next.main - DEBUG - starting with process 3 (MKK RN 24) of 17
2025-11-17 09:11:26,645 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:11:27,822 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:11:29,024 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:11:29,025 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:11:30,781 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:11:30,782 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:11:59,950 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:12:00,049 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 09:12:00,055 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:12:00,680 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:12:00,681 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:12:03,169 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:12:03,169 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:12:03,948 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:12:03,961 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:12:03,979 - ispa_next.main - DEBUG - 



2025-11-17 09:12:03,979 - ispa_next.main - DEBUG - starting with process 4 (F-CS 2192) of 17
2025-11-17 09:12:03,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:12:04,820 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:12:05,708 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:12:05,709 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:12:06,898 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:12:06,899 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:12:27,735 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:12:31,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:12:33,576 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:12:33,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:33,681 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:12:33,880 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:12:33,884 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:12:33,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:34,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:12:44,901 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:12:44,902 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:12:45,677 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:12:47,681 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:12:47,807 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:12:47,911 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:12:48,029 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:12:52,227 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:12:53,234 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:12:53,238 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:12:53,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:53,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:12:53,780 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:12:53,838 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:12:53,954 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:12:55,086 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:12:55,344 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:12:59,441 - ispa_next.functions - DEBUG - Updated appointment (AB00028032) customer contact data.
2025-11-17 09:13:00,348 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:13:00,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:00,436 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:13:00,575 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:13:00,577 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:13:00,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:13:01,466 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:13:02,889 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:13:02,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:13:03,002 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:13:06,703 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:13:06,703 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:13:06,707 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:13:06,708 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:13:06,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:07,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:13:11,352 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:13:11,356 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:13:11,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:11,445 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:13:11,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:12,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:13:12,333 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:13:13,052 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:13:13,052 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:13:16,196 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:13:16,198 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:13:17,101 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:13:17,103 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:13:17,104 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:13:17,105 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:13:17,106 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:13:17,107 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:13:17,114 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:13:17,116 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:13:17,118 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:13:17,121 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:13:17,125 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:13:17,128 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:13:17,128 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:20,353 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:13:20,355 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:13:20,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:23,573 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:13:23,576 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:13:23,577 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:13:23,582 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:26,800 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:13:26,803 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:13:27,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:13:28,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:13:28,353 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:13:53,668 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:13:53,670 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:13:54,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:13:54,460 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:13:54,462 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:13:58,313 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:14:05,026 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:14:05,409 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 09:14:05,972 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:14:06,711 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:14:06,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:14:09,699 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:14:09,700 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:14:10,496 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:14:10,507 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:14:10,518 - ispa_next.main - DEBUG - 



2025-11-17 09:14:10,518 - ispa_next.main - DEBUG - starting with process 5 (HU-MJ 28) of 17
2025-11-17 09:14:10,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:14:11,581 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:14:12,692 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:14:12,694 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:14:14,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:14:14,258 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:14:36,443 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:14:39,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:40,713 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:14:40,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:40,796 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:14:40,951 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:14:40,954 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:14:40,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:14:41,023 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:14:44,041 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:14:44,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:14:45,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:14:47,059 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:14:47,140 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:14:50,406 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:14:50,492 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:14:50,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:14:51,721 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:15:03,104 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:15:04,109 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:15:04,112 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:15:04,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:04,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:04,648 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:15:04,698 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:15:05,910 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:15:06,594 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:15:09,582 - ispa_next.functions - DEBUG - Updated appointment (AA00030021) customer contact data.
2025-11-17 09:15:10,511 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:15:10,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:15:10,570 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:15:10,734 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:15:10,737 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:15:11,303 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:15:11,304 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:15:11,956 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:15:15,577 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:15:15,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:15:16,104 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:15:18,133 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:15:18,244 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:15:18,316 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:15:18,418 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:15:18,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:15:19,683 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:15:31,103 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:16:31,106 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:16:42,897 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:16:50,299 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:16:50,300 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:16:51,536 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:16:55,695 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:16:56,704 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:16:56,705 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:16:56,705 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:16:56,837 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:17:00,961 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:17:00,965 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:17:00,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:17:01,064 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:17:16,026 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 09:17:29,563 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 09:17:29,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:17:30,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:17:30,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:17:31,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:17:31,033 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:17:32,325 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:17:32,327 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:17:33,437 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:17:33,438 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:17:33,440 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 09:17:33,441 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:17:33,443 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:17:33,444 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:17:33,446 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:17:33,447 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:17:33,455 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:17:33,459 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:17:33,465 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 09:17:54,793 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 09:17:54,794 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 09:18:00,488 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:18:00,491 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:18:00,492 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:18:02,497 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:18:02,499 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:18:02,501 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:18:04,378 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:18:04,380 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:18:04,383 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:18:04,385 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:18:06,235 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:18:06,237 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:18:06,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:18:07,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:18:07,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:18:26,239 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:18:31,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:18:31,244 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:18:31,245 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:31,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:18:32,051 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:18:32,053 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:18:33,925 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:18:41,633 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:18:41,999 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 09:18:42,265 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:43,164 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 668
2025-11-17 09:18:43,165 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:45,737 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 09:18:45,738 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:18:46,586 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:18:46,601 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:18:46,611 - ispa_next.main - DEBUG - 



2025-11-17 09:18:46,611 - ispa_next.main - DEBUG - starting with process 6 (HU AC78E) of 17
2025-11-17 09:18:46,618 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:18:47,689 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:18:48,682 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 668
2025-11-17 09:18:48,683 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 09:18:49,869 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:18:49,871 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:19,483 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:19:19,492 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 09:19:19,496 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:19:19,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 668
2025-11-17 09:19:19,865 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:19:21,924 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 09:19:21,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:22,558 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:19:22,567 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:19:22,577 - ispa_next.main - DEBUG - 



2025-11-17 09:19:22,577 - ispa_next.main - DEBUG - starting with process 7 (HU-TK 1402) of 17
2025-11-17 09:19:22,581 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:19:23,428 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:19:24,327 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 668
2025-11-17 09:19:24,328 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 205
2025-11-17 09:19:25,707 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:19:25,708 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:19:49,434 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:19:52,817 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:19:55,379 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:19:55,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:19:55,444 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:19:55,704 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:20:02,167 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:20:02,170 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:20:02,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:02,290 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:20:12,289 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:20:12,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:13,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:15,345 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:20:15,448 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:20:18,708 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:20:18,782 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:20:18,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:21,386 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:20:32,837 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:20:33,841 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:20:33,845 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:20:33,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:34,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:34,350 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:20:34,411 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:20:35,563 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:20:35,821 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:20:38,676 - ispa_next.functions - DEBUG - Updated appointment (AB00028030) customer contact data.
2025-11-17 09:20:39,605 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:20:39,605 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:20:39,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:20:39,812 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:20:39,814 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:20:40,649 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:20:40,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:20:41,397 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:20:45,912 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:20:45,914 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:20:46,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:20:48,436 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:20:48,543 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:20:48,664 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:20:48,751 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:20:48,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:20:52,120 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:21:03,625 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:22:03,627 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:22:15,092 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:22:50,095 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:23:01,087 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:23:08,392 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:23:08,394 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:23:11,722 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:23:15,943 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:23:16,967 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:23:16,968 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:23:16,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:23:17,114 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:23:21,255 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:23:21,260 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:23:21,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:23:21,343 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:23:25,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:23:26,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:23:26,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:23:27,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:23:27,117 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:23:30,113 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:23:30,115 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:23:31,215 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:23:31,216 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:23:31,217 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:23:31,218 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:23:31,220 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:23:31,221 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:23:31,222 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:23:31,223 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:23:31,224 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:23:31,225 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:23:31,228 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:23:31,230 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:23:31,231 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:23:34,564 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:23:34,566 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:23:34,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:23:37,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:23:37,882 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:23:48,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:24:01,796 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:24:01,798 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:24:01,800 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:24:01,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:24:05,040 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:24:05,042 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:24:05,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:24:06,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:24:07,149 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:24:39,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:42,937 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:46,886 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:51,232 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:24:51,234 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:24:51,235 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:24:51,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:24:52,003 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:24:52,005 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:24:53,973 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:25:01,843 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:25:02,216 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 09:25:03,175 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:25:03,889 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:25:03,891 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:25:06,533 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:25:06,534 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:25:07,419 - ispa_next.appointments.models - DEBUG - Appointment Yadira Yamileta Steeg HU-YA 95 WBA31AA0X05R99855 ohne Termin.
2025-11-17 09:25:07,430 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:25:07,440 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:25:07,451 - ispa_next.main - DEBUG - 



2025-11-17 09:25:07,452 - ispa_next.main - DEBUG - starting with process 8 (HU-PW 667) of 17
2025-11-17 09:25:07,456 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:25:08,566 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:25:09,815 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:25:09,817 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:25:11,476 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:25:11,477 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:25:33,977 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:25:37,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:25:39,075 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:25:39,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:39,173 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:25:39,344 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:25:39,347 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:25:39,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:39,442 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:25:42,630 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:25:42,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:25:43,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:25:45,647 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:25:45,730 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:25:45,833 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:25:45,891 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:25:50,034 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:25:51,040 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:25:51,044 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:25:51,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:51,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:51,532 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:25:51,641 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:25:53,067 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:25:53,255 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:25:54,732 - ispa_next.functions - DEBUG - Updated appointment (AA00030017) customer contact data.
2025-11-17 09:25:55,625 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:25:55,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:25:55,692 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:25:55,897 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:25:55,901 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:25:56,830 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:25:56,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:25:57,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:26:01,665 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:26:01,665 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:26:01,668 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:26:01,669 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:26:01,670 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:26:02,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:26:06,283 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:26:06,287 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:26:06,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:26:06,346 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:26:12,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:26:12,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:26:12,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:26:13,342 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:26:13,343 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:26:15,246 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:26:15,248 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:26:16,083 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:26:16,084 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:26:16,085 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:26:16,088 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:26:16,089 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:26:16,090 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:26:16,091 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:26:16,092 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:26:16,093 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:26:16,094 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:26:16,098 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:26:16,100 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:26:16,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:26:17,998 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:26:18,001 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:26:18,006 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:26:19,916 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:26:19,919 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:26:19,921 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:26:19,924 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:26:21,830 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:26:21,833 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:26:22,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:26:23,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:26:23,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:26:43,427 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:26:47,904 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:26:47,906 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:26:47,907 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:26:48,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:26:48,655 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:26:48,657 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:26:50,295 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:26:57,747 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:26:58,124 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 09:26:58,453 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:26:59,901 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:26:59,903 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:27:02,947 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:27:02,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:27:03,841 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:27:03,857 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:27:03,864 - ispa_next.main - DEBUG - Found new Appointment: HU-YA 95
2025-11-17 09:27:03,866 - ispa_next.main - DEBUG - 



2025-11-17 09:27:03,866 - ispa_next.main - DEBUG - starting with process 9 (HU-YA 95) of 18
2025-11-17 09:27:03,870 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:27:05,113 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:27:06,104 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:27:06,105 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:27:07,459 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:27:07,460 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:27:29,590 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:27:33,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:33,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:27:33,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:27:34,520 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:27:34,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:34,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:27:34,799 - ispa_next.functions - DEBUG - HU date already expired after 80 days.
2025-11-17 09:27:41,653 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:27:41,656 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:27:41,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:27:41,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:27:51,929 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:27:51,930 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:27:53,036 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:27:55,040 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:27:55,152 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:27:58,406 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 09:28:06,592 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 09:28:07,616 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:28:07,621 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:28:07,626 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:08,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:08,117 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:28:08,160 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:28:09,434 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:28:09,656 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:28:12,373 - ispa_next.functions - DEBUG - Updated appointment (AB00028041) customer contact data.
2025-11-17 09:28:13,303 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:28:13,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:28:13,675 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:28:13,875 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:28:13,878 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:28:14,731 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:28:14,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:28:15,524 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:28:19,132 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:28:19,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:28:19,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:28:21,723 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:28:21,848 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:28:21,953 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:28:22,082 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:28:22,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:28:23,325 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:28:34,507 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:29:34,510 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:29:45,809 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:30:29,811 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:30:40,618 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 09:30:47,560 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:30:47,561 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:30:51,607 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:30:53,861 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:30:55,505 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:30:57,750 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:30:58,765 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:30:58,767 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:30:58,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:30:58,866 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:31:02,976 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:31:03,846 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 09:31:16,700 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:31:16,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:31:16,827 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:31:17,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:31:17,711 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:31:17,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:31:18,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:31:18,581 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:31:19,895 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:31:19,898 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:31:22,219 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:31:22,220 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:31:22,221 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:31:22,231 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:31:22,235 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:31:22,236 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:31:22,238 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:31:22,239 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:31:22,240 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:31:22,242 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:31:22,245 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:31:22,248 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:31:22,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:31:23,488 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:31:23,491 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:31:23,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:31:24,776 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:31:24,779 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:31:24,782 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:31:24,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:31:26,098 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:31:26,101 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:31:26,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:31:27,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:31:28,020 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:31:40,688 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:31:40,690 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:31:40,691 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:31:41,418 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:31:41,547 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:31:41,549 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:31:43,881 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:31:55,253 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:31:55,665 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 09:31:57,582 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:31:58,618 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:31:58,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:32:03,396 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:32:03,396 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:04,608 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:32:04,619 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:32:04,630 - ispa_next.main - DEBUG - 



2025-11-17 09:32:04,630 - ispa_next.main - DEBUG - starting with process 10 (FB-B 985) of 18
2025-11-17 09:32:04,635 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:32:06,211 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:32:07,572 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:32:07,578 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:32:09,323 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:32:09,324 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:32:48,057 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:32:51,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:32:53,131 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:32:53,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:53,269 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:53,685 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:32:53,690 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:32:53,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:32:53,815 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:32:57,341 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:32:57,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:32:58,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:00,740 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:33:00,891 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:33:01,038 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:33:01,127 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:33:05,405 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:33:06,412 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:33:06,417 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:33:06,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:06,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:06,913 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:33:06,985 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:33:08,369 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:33:08,599 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:33:10,456 - ispa_next.functions - DEBUG - Updated appointment (AA00030016) customer contact data.
2025-11-17 09:33:11,371 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:33:11,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:11,563 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:33:11,838 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:33:11,841 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:33:13,001 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:33:13,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:33:14,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:33:17,692 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:33:17,693 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:33:17,697 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:33:17,697 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:33:17,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:18,228 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:22,372 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:33:22,377 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:33:22,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:22,468 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:33:31,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:31,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:33:31,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:33:32,615 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:33:32,616 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:33:33,925 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:33:33,927 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:33:35,337 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:33:35,339 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:33:35,340 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:33:35,341 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:33:35,343 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:33:35,344 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:33:35,345 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:33:35,347 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:33:35,354 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:33:35,358 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:33:35,368 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:33:35,371 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:33:35,373 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:36,708 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:33:36,711 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:33:36,713 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:37,968 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:33:37,971 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:33:37,974 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:33:37,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:39,237 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:33:39,240 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:33:40,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:33:41,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:33:41,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:33:55,759 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:33:55,761 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:33:55,762 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:33:56,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:33:56,874 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:33:56,876 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:33:59,671 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:34:11,351 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:34:11,741 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 09:34:13,443 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:34:14,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:34:14,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:34:19,255 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:34:19,256 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:34:20,359 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:34:20,391 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:34:20,401 - ispa_next.main - DEBUG - 



2025-11-17 09:34:20,401 - ispa_next.main - DEBUG - starting with process 11 (HU-KJ 81) of 18
2025-11-17 09:34:20,406 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:34:22,203 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:34:23,959 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:34:23,961 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:34:26,215 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:34:26,217 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:34:57,452 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:35:01,200 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:03,168 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:35:03,169 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:03,280 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:35:03,577 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:35:08,883 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:35:08,886 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:35:08,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:08,985 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:35:12,517 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:35:12,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:35:13,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:35:15,950 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:35:16,101 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:35:16,283 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:35:16,400 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:35:20,622 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:35:21,629 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:35:21,634 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:35:21,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:22,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:22,146 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:35:22,286 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:35:23,619 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:35:23,861 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:35:26,084 - ispa_next.functions - DEBUG - Updated appointment (AA00030012) customer contact data.
2025-11-17 09:35:26,994 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:35:26,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:27,205 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:35:27,466 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:35:27,469 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:35:28,722 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:35:28,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:35:29,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:35:33,879 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:35:33,880 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:35:33,884 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:35:33,885 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:35:33,886 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:35:34,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:35:38,653 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:35:38,657 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:35:38,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:35:38,767 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:35:44,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:44,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:35:44,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:35:45,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:35:45,738 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:35:47,749 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:35:47,751 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:35:49,128 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:35:49,133 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:35:49,136 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:35:49,139 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:35:49,141 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:35:49,143 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:35:49,144 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:35:49,145 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:35:49,147 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:35:49,148 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:35:49,152 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:35:49,154 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:35:49,155 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:51,078 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:35:51,080 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:35:51,082 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:53,063 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:35:53,066 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:35:53,068 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:35:53,073 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:35:55,116 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:35:55,119 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:35:55,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:35:56,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:35:57,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:36:16,618 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:36:21,535 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:36:21,538 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:36:21,538 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:36:22,320 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:36:22,446 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:36:22,449 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:36:25,157 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:36:36,672 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:36:37,062 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 09:36:39,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:40,107 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:36:40,109 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:45,123 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:36:45,124 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:36:46,278 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:36:46,290 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:36:46,299 - ispa_next.main - DEBUG - 



2025-11-17 09:36:46,299 - ispa_next.main - DEBUG - starting with process 12 (HU-XS 108) of 18
2025-11-17 09:36:46,304 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:36:48,071 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:36:49,950 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:36:49,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:36:52,111 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:36:52,113 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:37:22,083 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:37:25,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:37:27,724 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:37:27,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:27,810 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:37:28,135 - ispa_next.functions - DEBUG - HU date already expired after 323 days.
2025-11-17 09:37:34,065 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:37:34,069 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:37:34,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:34,155 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:37:42,890 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:37:42,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:37:44,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:37:46,146 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:37:46,266 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:37:46,422 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:37:46,500 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:37:50,682 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:37:51,689 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:37:51,693 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:37:51,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:52,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:52,226 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:37:52,282 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:37:52,407 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:37:53,723 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:37:53,965 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:37:55,925 - ispa_next.functions - DEBUG - Updated appointment (AA00030000) customer contact data.
2025-11-17 09:37:56,842 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:37:56,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:37:57,046 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:37:57,254 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:37:57,257 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:37:57,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:37:58,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:37:59,876 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:37:59,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:38:00,021 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:38:03,628 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:38:03,628 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:38:03,632 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:38:03,633 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:38:03,634 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:38:04,142 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:38:08,340 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:38:08,358 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:38:08,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:38:08,452 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:38:08,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:09,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:38:09,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:38:10,704 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:38:10,704 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:38:12,638 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:38:12,640 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:38:13,639 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:38:13,640 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:38:13,641 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:38:13,643 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:38:13,644 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:38:13,645 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:38:13,646 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:38:13,648 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:38:13,649 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:38:13,650 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:38:13,653 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:38:13,656 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:38:13,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:15,561 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:38:15,563 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:38:15,569 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:17,518 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:38:17,520 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:38:17,523 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:38:17,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:19,440 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 09:38:29,089 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:38:29,091 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:38:29,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:38:30,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:38:30,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:38:51,117 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:38:56,881 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:38:56,883 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:38:56,884 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:38:57,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:38:57,988 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:38:57,989 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:39:00,653 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:39:12,451 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:39:12,833 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 09:39:14,594 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:39:15,390 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:39:15,392 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:39:19,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:39:19,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:39:20,710 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:39:20,722 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:39:20,731 - ispa_next.main - DEBUG - 



2025-11-17 09:39:20,731 - ispa_next.main - DEBUG - starting with process 13 (HU-AS 958) of 18
2025-11-17 09:39:20,736 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:39:22,535 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:39:24,367 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:39:24,369 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:39:26,557 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:39:26,559 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:39:59,903 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:40:03,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:40:06,230 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:40:06,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:06,312 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:40:06,699 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 09:40:12,514 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:40:12,517 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:40:12,518 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:12,627 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:40:22,250 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:40:22,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:23,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:40:25,821 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:40:25,954 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:40:26,065 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:40:26,183 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:40:28,306 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:40:29,311 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:40:29,315 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:40:29,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:29,831 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:29,832 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:40:29,892 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:40:30,079 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:40:31,404 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:40:31,673 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:40:34,230 - ispa_next.functions - DEBUG - Updated appointment (AF00016210) customer contact data.
2025-11-17 09:40:35,148 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:40:35,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:35,365 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:40:35,624 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:40:35,627 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:40:35,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:40:37,016 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:40:38,394 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:40:38,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:40:38,487 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:40:42,534 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:40:42,534 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:40:42,538 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:40:42,539 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:40:42,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:43,044 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:40:47,181 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:40:52,619 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:40:52,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:52,704 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:40:53,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:53,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:40:53,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:40:54,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:40:54,511 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:40:57,002 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:40:57,007 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:40:59,526 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:40:59,527 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:40:59,529 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:40:59,530 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:40:59,531 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:40:59,537 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:40:59,541 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:40:59,542 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:40:59,544 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:40:59,546 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:40:59,548 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:40:59,551 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:40:59,552 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:02,273 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:41:02,277 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:41:02,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:04,981 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:41:04,983 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:41:04,986 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:41:04,988 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:07,617 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:41:07,619 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:41:08,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:41:09,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:41:10,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:41:36,338 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:41:41,759 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:41:48,201 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:41:48,204 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:41:48,205 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:41:49,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:41:49,217 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:41:49,219 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:41:51,995 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:42:03,712 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:42:04,081 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 09:42:06,009 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:42:07,045 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:42:07,046 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:42:10,938 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 206
2025-11-17 09:42:10,939 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:42:12,804 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:42:12,814 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:42:12,824 - ispa_next.main - DEBUG - 



2025-11-17 09:42:12,824 - ispa_next.main - DEBUG - starting with process 14 (OF-JF 333) of 18
2025-11-17 09:42:12,827 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:42:14,195 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:42:15,535 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:42:15,537 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 206
2025-11-17 09:42:17,554 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:42:17,556 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:43:02,478 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:43:06,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:43:11,654 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:43:11,655 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:11,741 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:43:12,103 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 09:43:18,036 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:43:18,039 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:43:18,040 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:18,122 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:43:27,564 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:43:27,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:43:29,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:43:31,069 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:43:31,220 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:43:31,429 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:43:31,523 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:43:35,774 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:43:36,780 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:43:36,785 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:43:36,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:37,308 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:37,308 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:43:37,392 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:43:37,549 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:43:39,029 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:43:39,242 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:43:41,307 - ispa_next.functions - DEBUG - Updated appointment (AE00018282) customer contact data.
2025-11-17 09:43:42,253 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:43:42,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:43:42,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:43:42,718 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:43:42,721 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:43:42,903 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:43:44,024 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:43:45,483 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:43:45,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:43:45,577 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:43:49,219 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:43:49,219 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:43:49,224 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:43:49,225 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:43:49,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:43:49,738 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:43:53,931 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:43:59,547 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:43:59,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:43:59,642 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:44:00,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:44:00,552 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:44:00,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:44:01,388 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:44:01,389 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:44:06,284 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:44:06,287 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:44:07,592 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:44:07,605 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:44:07,606 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:44:07,607 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:44:07,609 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:44:07,610 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:44:07,614 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:44:07,618 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:44:07,619 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:44:07,620 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:44:07,633 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:44:07,635 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:44:07,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:44:13,166 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:44:13,168 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:44:13,176 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:44:18,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:44:18,800 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:44:30,812 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:44:30,815 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:44:30,818 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:44:30,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:44:36,380 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:44:36,386 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:44:37,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:44:38,106 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:44:38,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:45:26,385 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:45:33,146 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:45:39,490 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:45:45,244 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:45:51,818 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:45:57,893 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:45:57,896 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:45:57,897 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:45:58,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:45:59,073 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:45:59,075 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:46:01,913 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:46:13,689 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:46:14,080 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 09:46:16,330 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:46:17,392 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 09:46:17,394 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:46:22,403 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 207
2025-11-17 09:46:22,404 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:46:23,598 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:46:23,608 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:46:23,617 - ispa_next.main - DEBUG - 



2025-11-17 09:46:23,617 - ispa_next.main - DEBUG - starting with process 15 (FB-SR 1700) of 18
2025-11-17 09:46:23,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:46:25,397 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:46:27,244 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 09:46:27,245 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 207
2025-11-17 09:46:29,386 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:46:29,388 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:47:00,927 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:47:05,163 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:07,740 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:47:07,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:07,860 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:47:08,242 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:47:08,245 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:47:08,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:08,402 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:47:17,477 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:47:17,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:19,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:47:21,144 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:47:21,287 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:47:21,464 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:47:21,642 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:47:25,836 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 09:47:26,843 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:47:26,848 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:47:26,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:27,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:27,361 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:47:27,424 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:47:27,594 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:47:28,838 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:47:29,039 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:47:31,224 - ispa_next.functions - DEBUG - Updated appointment (AR00006517) customer contact data.
2025-11-17 09:47:32,144 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:47:32,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:32,367 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:47:32,618 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:47:32,620 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:47:32,771 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:47:34,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:47:35,861 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:47:35,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:47:35,947 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:47:40,084 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:47:40,084 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:47:40,084 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:47:40,087 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:47:40,088 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:47:40,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:40,631 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:47:44,771 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 09:47:44,776 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:47:44,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:44,894 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:47:45,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:45,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:47:45,802 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:47:46,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:47:46,691 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:47:49,184 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:47:49,203 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:47:50,768 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:47:50,772 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:47:50,774 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:47:50,775 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:47:50,796 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:47:50,798 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:47:50,800 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:47:50,802 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:47:50,804 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:47:50,806 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:47:50,809 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:47:50,812 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:47:50,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:53,514 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:47:53,517 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:47:53,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:56,232 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:47:56,235 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:47:56,237 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:47:56,239 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:47:58,920 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:47:58,922 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:47:59,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:48:00,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:48:01,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:48:27,406 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:48:32,556 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:48:39,146 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:48:39,149 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:48:39,149 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:48:39,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:48:40,091 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:48:40,093 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:48:42,735 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:48:54,079 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:48:54,485 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 09:48:56,556 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:48:57,630 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 09:48:57,632 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:49:02,163 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-17 09:49:02,164 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:49:03,382 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:49:03,392 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:49:03,399 - ispa_next.main - DEBUG - 



2025-11-17 09:49:03,399 - ispa_next.main - DEBUG - starting with process 16 (MKK-RM 157) of 18
2025-11-17 09:49:03,404 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:49:05,145 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:49:06,993 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 671
2025-11-17 09:49:06,994 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-17 09:49:09,112 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:49:09,114 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:49:42,705 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:49:46,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:49:48,454 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:49:48,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:49:48,537 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:49:48,950 - ispa_next.functions - DEBUG - HU date already expired after 84 days.
2025-11-17 09:49:55,343 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:49:55,346 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:49:55,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:49:55,433 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:50:04,476 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:50:04,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:50:06,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:50:08,103 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:50:08,268 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:50:08,452 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:50:08,573 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:50:08,575 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:11,273 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:50:23,382 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 09:50:24,387 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:50:24,393 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:50:24,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:50:24,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:50:24,989 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:50:25,040 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:50:26,363 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:50:27,619 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:50:27,868 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:50:30,551 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:50:30,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:50:30,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:50:31,044 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 09:50:31,047 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:50:32,207 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:50:32,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:50:33,412 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:50:37,438 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:50:37,439 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:50:37,957 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:50:39,960 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:50:40,107 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 09:50:40,278 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 09:50:40,435 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 09:50:40,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:50:42,481 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:50:54,339 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:51:54,346 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:52:06,126 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 09:52:43,129 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 09:52:54,794 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-17 09:53:04,796 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 09:53:04,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:53:14,135 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:17,864 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:21,748 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:25,645 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:29,646 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:33,989 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:38,427 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:42,022 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:46,233 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 09:53:49,477 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 09:53:52,330 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 09:53:53,354 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:53:53,355 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:53:53,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:53:53,457 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:53:57,643 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:54:02,718 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:54:02,719 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:02,828 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:54:03,223 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:03,827 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:54:03,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:54:05,211 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:54:05,212 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:54:07,186 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:54:07,190 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:54:12,299 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:54:12,300 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:54:12,301 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:54:12,302 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:54:12,303 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:54:12,304 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:54:12,307 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:54:12,313 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:54:12,316 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:54:12,321 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:54:12,325 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:54:12,327 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:54:12,328 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:54:14,422 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:54:14,425 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:54:14,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:54:16,390 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:54:16,393 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:54:16,395 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:54:16,397 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:54:18,374 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:54:18,377 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:54:19,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:54:20,111 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:54:20,332 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:54:40,208 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:54:45,986 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 09:54:45,989 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:54:45,990 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:54:46,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:54:46,814 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:54:46,817 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:54:49,241 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 09:55:00,996 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:55:01,388 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 09:55:03,446 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:55:04,550 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 09:55:04,551 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:55:09,052 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-17 09:55:09,053 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:55:10,312 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:55:10,322 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:55:10,332 - ispa_next.main - DEBUG - 



2025-11-17 09:55:10,332 - ispa_next.main - DEBUG - starting with process 17 (GN-BB 156) of 18
2025-11-17 09:55:10,336 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:55:12,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:55:13,984 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 09:55:13,986 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-17 09:55:16,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:55:16,268 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:55:52,955 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 156, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-17 09:55:52,973 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 09:55:52,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:55:53,663 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 09:55:53,665 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:55:58,539 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 208
2025-11-17 09:55:58,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:55:59,767 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:55:59,777 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
2025-11-17 09:55:59,791 - ispa_next.main - DEBUG - 



2025-11-17 09:55:59,791 - ispa_next.main - DEBUG - starting with process 18 (MKK-MG 366) of 18
2025-11-17 09:55:59,795 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:56:01,632 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:56:03,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 670
2025-11-17 09:56:03,589 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 208
2025-11-17 09:56:05,930 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 09:56:05,931 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:56:39,312 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 09:56:43,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:56:48,455 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 09:56:48,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:56:48,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:56:48,885 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 09:56:48,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:56:48,989 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:56:59,378 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 09:56:59,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:00,319 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:57:09,487 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:57:09,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:11,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:57:13,638 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 09:57:22,415 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 09:57:28,076 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 09:57:29,101 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 09:57:29,105 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 09:57:29,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:29,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:29,634 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 09:57:29,690 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 09:57:29,876 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 09:57:31,159 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 09:57:31,432 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 09:57:34,376 - ispa_next.functions - DEBUG - Updated appointment (AD00021124) customer contact data.
2025-11-17 09:57:35,295 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 09:57:35,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:35,555 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 09:57:38,077 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 09:57:38,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:57:40,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 09:57:41,557 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 09:57:41,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 09:57:41,660 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 09:57:45,786 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 09:57:45,787 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 09:57:45,787 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 09:57:45,790 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 09:57:45,790 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 09:57:45,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:46,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:57:50,423 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 09:57:55,468 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 09:57:55,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:55,553 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:57:55,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:56,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 09:57:56,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:57:57,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 09:57:57,340 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 09:58:02,559 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 09:58:02,567 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 09:58:03,919 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 09:58:03,921 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:58:03,923 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 09:58:03,924 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 09:58:03,925 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 09:58:03,926 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 09:58:03,927 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 09:58:03,929 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 09:58:03,936 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 09:58:03,940 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 09:58:03,952 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 09:58:03,956 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 09:58:03,957 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:58:09,506 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 09:58:09,509 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 09:58:09,511 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:58:14,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 09:58:15,073 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 09:58:27,382 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 09:58:27,385 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 09:58:27,387 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 09:58:27,390 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:58:32,900 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 09:58:32,903 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 09:58:33,755 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:58:34,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 09:58:35,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 09:59:14,301 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 09:59:14,302 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 09:59:15,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 09:59:15,419 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 09:59:15,421 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 09:59:20,447 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 09:59:32,663 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 09:59:33,095 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 09:59:35,459 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 09:59:36,734 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 669
2025-11-17 09:59:36,736 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 09:59:41,669 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 205
2025-11-17 09:59:41,670 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 09:59:43,416 - ispa_next.appointments.models - DEBUG - Appointment Erika Cavaco HU-E 444 WBAJT31090CD27359 ohne Termin.
2025-11-17 09:59:43,431 - ispa_next.appointments.models - DEBUG - Appointment Hans Schlottner  WBY31AW070FT65147 ohne Termin.
