2025-11-12 10:00:37,405 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:00:37,411 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:00:45,771 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:00:57,850 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:01:13,530 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:01:45,996 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:01:58,275 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:02:02,401 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:03,772 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:02:03,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:02:06,294 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 123
2025-11-12 10:02:06,294 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:02:06,295 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:07,236 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:08,383 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:02:24,270 - ispa_next.appointments.models - DEBUG - Appointment Robert Charles Armin FS-NA 42 WMWYT910303D93360 ohne Termin.
2025-11-12 10:02:24,285 - ispa_next.appointments.models - DEBUG - Appointment Nils-Roman Juraske MB-RJ 25 WBAJN71070CD07600 ohne Termin.
2025-11-12 10:02:24,301 - ispa_next.appointments.models - DEBUG - Appointment Benedikt Burger FFB-XG 87 WBS11DM0708D97738 ohne Termin.
2025-11-12 10:02:24,315 - ispa_next.appointments.models - DEBUG - Appointment Timon Wohlfarth  WMWXU710402M05502 ohne Termin.
2025-11-12 10:02:24,324 - ispa_next.appointments.models - DEBUG - Appointment Neutrik EMEA GmbH DAH-NG 90E WBY71GM0905348864 ohne Termin.
2025-11-12 10:02:24,334 - ispa_next.appointments.models - DEBUG - Appointment Chi Chung Nguyen M-HC 2737 WBACR61070LJ18143 ohne Termin.
2025-11-12 10:02:24,344 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Berger M-MB 525 WBAFF41030L117517 ohne Termin.
2025-11-12 10:02:24,345 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,345 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,345 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,348 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,348 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,348 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,352 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,361 - ispa_next.appointments.models - DEBUG - Appointment Brigitte Lang DAH-U 904 WMW21DL0703N66211 ohne Termin.
2025-11-12 10:02:24,369 - ispa_next.appointments.models - DEBUG - Appointment Franziska Scheitler DAH-FS 242 WBA31DZ040FJ93655 ohne Termin.
2025-11-12 10:02:24,377 - ispa_next.appointments.models - DEBUG - Appointment NovaTaste Germany GmbH BGL-NT 303 WBA41EG0005X32470 ohne Termin.
2025-11-12 10:02:24,385 - ispa_next.appointments.models - DEBUG - Appointment Sieglinde Wasmeier PAN-SW 11 WBA21BX0907N85009 ohne Termin.
2025-11-12 10:02:24,394 - ispa_next.appointments.models - DEBUG - Appointment REWE Markt GmbH FS-RE 208 WBA71AC0505R28464 ohne Termin.
2025-11-12 10:02:24,408 - ispa_next.appointments.models - DEBUG - Appointment Christos Michalopoulos DAH-GR 517 WBATX95050ND73284 ohne Termin.
2025-11-12 10:02:24,420 - ispa_next.appointments.models - DEBUG - Appointment Harald Schmidt-Habich FS-CU 168 WBAWZ510700L19145 ohne Termin.
2025-11-12 10:02:24,430 - ispa_next.appointments.models - DEBUG - Appointment Hiller DAH-LH 258 WBAWY510600E18805 ohne Termin.
2025-11-12 10:02:24,443 - ispa_next.appointments.models - DEBUG - Appointment Johannes Nist DAH-VN 66 WBA11GR0209Z99162 ohne Termin.
2025-11-12 10:02:24,457 - ispa_next.appointments.models - DEBUG - Appointment Annemarie Eichhorn DAH-AE 279 WBA71AC0405V15516 ohne Termin.
2025-11-12 10:02:24,474 - ispa_next.appointments.models - DEBUG - Appointment Ezmin Tanjic RE-EZA 1 WBACV61030LJ72146 ohne Termin.
2025-11-12 10:02:24,482 - ispa_next.appointments.models - DEBUG - Appointment PRK GmbH Kunststoffverarbeitung  WMW61DL0903S22669 ohne Termin.
2025-11-12 10:02:24,492 - ispa_next.appointments.models - DEBUG - Appointment Härtetechnik Redak GmbH & Co. KG DAH-MC 510 WBS41AY030FM13870 ohne Termin.
2025-11-12 10:02:24,502 - ispa_next.appointments.models - DEBUG - Appointment Volksbank Raiffeisenbank Dachau eG DAH-VR 86 E WBA81CY050FS22937 ohne Termin.
2025-11-12 10:02:24,513 - ispa_next.appointments.models - DEBUG - Appointment Dirk Ullrich RN-M 500E WBS81GV040CV92768 ohne Termin.
2025-11-12 10:02:24,521 - ispa_next.appointments.models - DEBUG - Appointment Jörg Rolfes OAL-AR 191 WBAUZ35010N015446 ohne Termin.
2025-11-12 10:02:24,531 - ispa_next.appointments.models - DEBUG - Appointment Andreas Christmann M-AK 1539E WMW11GC05RTA37157 ohne Termin.
2025-11-12 10:02:24,539 - ispa_next.appointments.models - DEBUG - Appointment Christian Ettenberger FFB-CE 56E WMW11DJ0602T37216 ohne Termin.
2025-11-12 10:02:24,553 - ispa_next.appointments.models - DEBUG - Appointment Baader Bank AG M-V 7427 WBA41EG0X05Y35735 ohne Termin.
2025-11-12 10:02:24,561 - ispa_next.appointments.models - DEBUG - Appointment Dr. Nicola Steiner DAH-LS 855 WMWXU71010TN14283 ohne Termin.
2025-11-12 10:02:24,568 - ispa_next.appointments.models - DEBUG - Appointment Rita Oberrecht-Schwarz DAH-RA 13 WBA11AB01N5T43220 ohne Termin.
2025-11-12 10:02:24,577 - ispa_next.appointments.models - DEBUG - Appointment Rolf Ludwig Hagert DAH-AR 678 WBA2E310705D82895 ohne Termin.
2025-11-12 10:02:24,586 - ispa_next.appointments.models - DEBUG - Appointment Rainer Tobias Möller DAH-ST 807 WBA6V31070EB10798 ohne Termin.
2025-11-12 10:02:24,597 - ispa_next.appointments.models - DEBUG - Appointment Dr. Norbert Metz STA-M 2828 WBA6X310405T68381 ohne Termin.
2025-11-12 10:02:24,605 - ispa_next.appointments.models - DEBUG - Appointment Franz Rockinger FFB-FR 267 WBA31BX0807R25447 ohne Termin.
2025-11-12 10:02:24,614 - ispa_next.appointments.models - DEBUG - Appointment Dario Zandonella Maiucco DAH-DZ 73 WBAXA51050C586150 ohne Termin.
2025-11-12 10:02:24,624 - ispa_next.appointments.models - DEBUG - Appointment Anna Gushchina M-AG 7192 WMWRC310X0TB89348 ohne Termin.
2025-11-12 10:02:24,624 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:02:24,638 - ispa_next.appointments.models - DEBUG - Appointment Radloff DAH-RA 238 WBY71AW050FR88400 ohne Termin.
2025-11-12 10:02:24,648 - ispa_next.appointments.models - DEBUG - Appointment Augusto Fracasso DAH-GF 289 WBA11AB0005N66647 ohne Termin.
2025-11-12 10:02:24,657 - ispa_next.main - DEBUG - Found 8 out of 53 appointments to process (configured limit: 15).
2025-11-12 10:02:24,657 - ispa_next.main - DEBUG - Processing 4 fresh appointments.
2025-11-12 10:02:24,658 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 10:02:24,658 - ispa_next.main - DEBUG - All appointments: M GX 4646, M-TU1209, DAH-VA33E, DAH-VA27E, M-MM 569, M-WB 1959, FS-PK 118, CHA-M 3195
2025-11-12 10:02:24,661 - ispa_next.main - DEBUG - 



2025-11-12 10:02:24,661 - ispa_next.main - DEBUG - starting with process 1 (M GX 4646) of 8
2025-11-12 10:02:24,679 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:02:25,947 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:27,167 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:02:27,172 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 123
2025-11-12 10:02:28,818 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:02:28,819 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:04,091 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:03:04,179 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:03:04,183 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:04,928 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:03:04,930 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:07,548 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:03:07,549 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:08,453 - ispa_next.main - DEBUG - 



2025-11-12 10:03:08,454 - ispa_next.main - DEBUG - starting with process 2 (M-TU1209) of 8
2025-11-12 10:03:08,460 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:03:09,672 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:10,862 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:03:10,862 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:03:12,489 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:12,491 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:42,954 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:03:42,965 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:03:42,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:43,590 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:03:43,592 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:46,457 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:03:46,458 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:47,308 - ispa_next.main - DEBUG - 



2025-11-12 10:03:47,308 - ispa_next.main - DEBUG - starting with process 3 (DAH-VA33E) of 8
2025-11-12 10:03:47,312 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:03:48,652 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:49,950 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:03:49,952 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:03:51,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:51,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:04:22,772 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:04:22,781 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:04:22,785 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:23,472 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:04:23,473 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:26,078 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:04:26,079 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:04:27,024 - ispa_next.main - DEBUG - 



2025-11-12 10:04:27,024 - ispa_next.main - DEBUG - starting with process 4 (DAH-VA27E) of 8
2025-11-12 10:04:27,029 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:04:28,331 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:04:29,803 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:04:29,804 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:04:31,376 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:04:31,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:04,952 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:05:04,961 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:05:04,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:05,435 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:05:05,436 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:07,672 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:05:07,675 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:08,445 - ispa_next.main - DEBUG - 



2025-11-12 10:05:08,446 - ispa_next.main - DEBUG - starting with process 5 (M-MM 569) of 8
2025-11-12 10:05:08,451 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:05:09,712 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:11,194 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:05:11,195 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:05:12,940 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:12,941 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:49,990 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:05:51,993 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:05:57,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:06:02,719 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:06:02,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:02,793 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:02,992 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:06:06,916 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:06:06,918 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:06:09,572 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:06:09,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:10,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:12,671 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:06:12,820 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:06:12,932 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:06:13,020 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:06:17,250 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:06:18,256 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:06:18,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:18,740 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:33,159 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:06:37,353 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:06:37,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:37,457 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:06:37,458 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:06:37,515 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:06:37,609 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:06:38,781 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-12 10:06:39,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-12 10:06:40,309 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:06:41,518 - ispa_next.functions - DEBUG - Updated appointment (AX00012220) customer contact data.
2025-11-12 10:06:42,429 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:06:42,431 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:06:42,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:43,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:06:44,111 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:06:44,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:06:44,175 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:06:48,160 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:06:48,160 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:06:48,164 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:06:48,166 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:06:48,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:48,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:52,783 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:06:52,787 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:06:52,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:52,889 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:06:53,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:53,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:06:53,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:06:54,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:06:54,498 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:06:59,198 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:06:59,200 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:07:00,778 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:07:00,780 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:07:00,782 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:07:00,795 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:07:00,799 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:07:00,801 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 10:07:00,802 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:07:00,803 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:07:00,805 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:07:00,806 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:07:00,809 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:07:00,813 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:07:00,816 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:07:00,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:06,203 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:07:06,205 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:07:06,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:11,424 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:07:11,426 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:07:11,427 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:07:11,430 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:16,655 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:07:31,511 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:07:32,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:07:32,992 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:07:33,150 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:07:42,331 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:07:45,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:07:49,457 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:07:53,625 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:07:58,113 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:02,070 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:06,052 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:08:06,054 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:08:06,054 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:06,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:08:06,705 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:08:06,706 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:08:08,518 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:08:19,998 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:08:20,370 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:08:20,746 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:24,345 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:08:24,346 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:27,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:08:27,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:28,447 - ispa_next.main - DEBUG - 



2025-11-12 10:08:28,447 - ispa_next.main - DEBUG - starting with process 6 (M-WB 1959) of 8
2025-11-12 10:08:28,452 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:29,793 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:31,061 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:08:31,063 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:08:32,498 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:32,499 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:57,030 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:08:59,171 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:09:03,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:09:07,312 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:09:07,313 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:07,402 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:09:07,685 - ispa_next.functions - DEBUG - HU date already expired after 840 days.
2025-11-12 10:09:12,019 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:09:12,022 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:09:14,744 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:09:14,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:15,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:17,734 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:09:17,839 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:09:17,933 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:09:18,022 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:09:22,217 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:09:23,224 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:09:23,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:23,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:38,719 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:09:42,940 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:09:42,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:43,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:09:43,027 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:09:43,086 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:09:44,271 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:09:44,487 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:09:45,721 - ispa_next.functions - DEBUG - Updated appointment (BH00015640) customer contact data.
2025-11-12 10:09:46,616 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:09:46,617 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:09:47,252 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:09:47,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:09:47,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:09:52,051 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:09:52,051 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:09:52,055 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:09:52,056 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:09:52,057 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:52,570 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:56,686 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:09:56,690 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:09:56,690 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:56,763 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:09:57,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:57,648 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:57,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:58,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:58,321 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:10:01,326 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:10:01,328 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:10:02,711 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:10:02,713 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:10:02,715 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:10:02,716 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:10:02,718 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:10:02,724 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 10:10:02,726 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:10:02,728 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:10:02,734 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:10:02,736 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:10:02,739 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:10:02,742 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:10:02,743 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:10:02,744 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:06,005 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:10:06,008 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:10:06,010 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:09,310 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:10:09,314 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:10:09,316 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:10:09,322 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:12,573 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:10:25,950 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:10:26,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:10:27,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:10:27,423 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:10:35,289 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:10:41,257 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:10:45,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:10:50,787 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:10:50,790 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:10:50,791 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:51,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:10:51,934 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:10:51,936 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:10:54,154 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:11:02,447 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:11:02,832 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:11:03,204 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:05,416 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:11:05,417 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:08,587 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:11:08,588 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:09,518 - ispa_next.main - DEBUG - 



2025-11-12 10:11:09,518 - ispa_next.main - DEBUG - starting with process 7 (FS-PK 118) of 8
2025-11-12 10:11:09,521 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:10,692 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:12,082 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:11:12,084 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:11:13,757 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:13,758 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:38,568 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:11:40,360 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:11:45,335 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:49,880 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:11:49,880 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:49,961 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:50,107 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:11:54,200 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:11:54,203 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:11:56,995 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:56,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:58,167 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:00,170 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:00,294 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:00,377 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:00,460 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:12:00,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:05,192 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:12:13,910 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:12:14,914 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:12:14,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:15,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:28,744 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:12:33,736 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:12:33,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:33,822 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:33,822 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:12:33,893 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:12:35,176 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:12:35,393 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:12:36,645 - ispa_next.functions - DEBUG - Updated appointment (AX00012117) customer contact data.
2025-11-12 10:12:37,551 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:12:37,553 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:12:38,181 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:12:38,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:12:38,826 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:12:42,949 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:42,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:43,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:45,509 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:45,608 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:45,731 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:45,807 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:12:45,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:50,447 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:12:58,782 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:13:58,785 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:14:07,265 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:14:39,268 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:14:50,890 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-12 10:14:54,952 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:14:54,954 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:59,720 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:15:03,917 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:15:04,922 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:15:04,923 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:15:04,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:05,009 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:15:09,152 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:15:09,156 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:15:09,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:09,275 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:15:09,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:10,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:10,503 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:11,201 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:11,202 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:15:15,327 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:15:15,328 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:15:16,646 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:15:16,662 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:16,665 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:15:16,666 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:16,668 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:15:16,669 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 10:15:16,670 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:15:16,671 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:15:16,672 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:15:16,673 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:15:16,675 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:15:16,677 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:15:16,679 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:15:16,679 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:21,312 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:15:21,313 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:15:21,317 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:25,934 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:15:25,937 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:15:25,950 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:15:25,952 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:30,642 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:15:46,088 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:15:46,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:15:47,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:15:48,087 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:56,314 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:00,210 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:04,601 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:08,894 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:13,196 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:17,254 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:17,256 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:16:17,256 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:17,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:16:17,965 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:16:17,966 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:16:19,671 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:16:28,645 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:16:29,047 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:16:29,488 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:31,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:16:31,831 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:34,710 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 159
2025-11-12 10:16:34,711 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:35,510 - ispa_next.main - DEBUG - 



2025-11-12 10:16:35,510 - ispa_next.main - DEBUG - starting with process 8 (CHA-M 3195) of 8
2025-11-12 10:16:35,514 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:36,602 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:37,855 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1284
2025-11-12 10:16:37,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 159
2025-11-12 10:16:39,347 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:39,350 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:17:14,562 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:17:17,007 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:17:22,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:24,773 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:17:24,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:24,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:25,204 - ispa_next.functions - DEBUG - HU date already expired after 532 days.
2025-11-12 10:17:29,480 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:17:29,483 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:17:32,318 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:32,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:33,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:35,333 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:17:35,477 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:17:35,580 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:17:35,651 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:17:39,839 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:17:40,856 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:17:40,858 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:41,393 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:53,113 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:17:57,131 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:17:57,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:57,208 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:57,209 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:17:57,272 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:17:57,352 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:17:58,485 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:17:58,704 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:18:00,401 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:18:00,403 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:18:00,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:18:01,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:18:02,457 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:18:02,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:18:02,806 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:18:06,819 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:18:06,819 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:18:06,823 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:18:06,824 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:18:06,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:07,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:11,433 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:18:15,700 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:18:15,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:15,774 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:18:16,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:16,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:18:16,689 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:18:17,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:18:17,313 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:18:19,717 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:18:19,719 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:18:21,669 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:18:21,670 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:21,673 - ispa_next.package_manager.main - DEBUG - Cannot place Servicereinigung / Maschinelle Oberwäsche und Fußr: active service advisor guards
2025-11-12 10:18:21,675 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:18:21,676 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:21,678 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:18:21,679 - ispa_next.package_manager.main - DEBUG - Cannot place 10061270900 (SW)- G6x G7x G9x Kabelbaum Cockpit ne: not present in source
2025-11-12 10:18:21,681 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:18:21,681 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:18:21,690 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:18:21,693 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:18:21,699 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:18:21,702 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:18:21,705 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:18:21,706 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:24,315 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:18:26,932 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:18:26,935 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:18:26,945 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:29,715 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:18:29,716 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:18:29,717 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:18:29,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:32,303 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:18:45,970 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:18:46,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:18:47,270 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:18:47,505 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:54,641 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:18:59,272 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:04,394 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:04,397 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:19:04,397 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:05,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:05,289 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:19:05,291 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:19:07,474 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:19:16,754 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:19:17,171 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:19:17,526 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:19:20,018 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1287
2025-11-12 10:19:20,020 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:19:23,161 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 10:19:23,162 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
