2025-11-17 12:00:38,391 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:00:38,401 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:00:48,836 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:01:00,648 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:01:16,326 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:01:40,011 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:01:52,396 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:01:54,834 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:01:55,678 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:01:55,680 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:01:58,124 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 151
2025-11-17 12:01:58,125 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:01:58,125 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:01:59,472 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:02:00,715 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:02:23,112 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:02:23,116 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:02:23,135 - ispa_next.appointments.models - DEBUG - Appointment Cengiz Biyik F-YC 6161 WBAJN11020BK39142 ohne Termin.
2025-11-17 12:02:23,135 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:02:23,137 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:02:23,167 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:02:23,220 - ispa_next.appointments.models - DEBUG - Appointment Ulrich Franz WW-SC 91 WBA5V71020FH87156 ohne Termin.
2025-11-17 12:02:23,247 - ispa_next.appointments.models - DEBUG - Appointment Firma AKC Angersbach & Kaiser  WBA65GP080N366928 ohne Termin.
2025-11-17 12:02:23,260 - ispa_next.appointments.models - DEBUG - Appointment   WBA11GV080CW64111 ohne Termin.
2025-11-17 12:02:23,271 - ispa_next.appointments.models - DEBUG - Appointment Marcel Werner Hohmann FD-MH 1306 WBAJN71050BS67908 ohne Termin.
2025-11-17 12:02:23,281 - ispa_next.appointments.models - DEBUG - Appointment   WBA32EE0805469799 ohne Termin.
2025-11-17 12:02:23,291 - ispa_next.appointments.models - DEBUG - Appointment Dino Keshishi HU-MD 1991 WBA8T31040GB33829 ohne Termin.
2025-11-17 12:02:23,301 - ispa_next.appointments.models - DEBUG - Appointment Edat Bayram GN-XM 1996 WBA7C41070BR92361 ohne Termin.
2025-11-17 12:02:23,312 - ispa_next.appointments.models - DEBUG - Appointment Firma MARL Seafood GmbH OF-AL 4545 WBA41EU0609Z08046 ohne Termin.
2025-11-17 12:02:23,349 - ispa_next.main - DEBUG - Found 15 out of 127 appointments to process (configured limit: 15).
2025-11-17 12:02:23,349 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 12:02:23,349 - ispa_next.main - DEBUG - All appointments: HU-VS 232, F-RR 8716, HU-MJ 28, HU-TK 1402, HU-PW 667, FB-B 985, HU-KJ 81, HU-XS 108, HU-AS 958, OF-JF 333, FB-SR 1700, MKK-RM 157, GN-BB 156, MKK-MG 366, F-BF 400
2025-11-17 12:02:23,365 - ispa_next.main - DEBUG - 



2025-11-17 12:02:23,365 - ispa_next.main - DEBUG - starting with process 1 (HU-VS 232) of 15
2025-11-17 12:02:23,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:02:24,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:02:25,878 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:02:25,879 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 151
2025-11-17 12:02:27,574 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:02:27,576 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:03:03,491 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:03:06,776 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:08,693 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:03:08,693 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:08,800 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:03:08,948 - ispa_next.functions - DEBUG - HU date already expired after 1875 days.
2025-11-17 12:03:12,427 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:03:12,430 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:03:12,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:12,504 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:03:19,494 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:03:19,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:20,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:03:22,340 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:03:22,478 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:03:22,552 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:03:22,626 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:03:24,768 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:03:25,774 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:03:25,778 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:03:25,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:26,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:26,289 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:03:26,343 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:03:26,510 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:03:27,771 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:03:28,005 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:03:29,717 - ispa_next.functions - DEBUG - Updated appointment (AB00028046) customer contact data.
2025-11-17 12:03:30,610 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:03:30,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:30,693 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:03:30,918 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:03:30,921 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:03:31,020 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:03:31,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:03:32,722 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:03:32,722 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:03:32,846 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:03:36,461 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:03:36,461 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:03:36,465 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:03:36,466 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:03:36,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:36,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:03:41,111 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:03:44,353 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:03:44,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:44,454 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:03:44,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:45,428 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:03:45,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:03:46,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:03:46,104 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:03:48,017 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:03:48,019 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:03:51,597 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:03:51,598 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:03:51,600 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:03:51,601 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:03:51,602 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:03:51,603 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:03:51,605 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:03:51,606 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:03:51,607 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:03:51,608 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:03:51,612 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:03:51,615 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:03:51,616 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:53,640 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:03:53,643 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:03:53,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:55,492 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:03:55,495 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:03:55,499 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:03:55,503 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:03:57,429 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:03:57,434 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:03:58,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:03:58,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:03:58,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:04:19,076 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:04:23,607 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:04:23,610 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:04:23,611 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:04:24,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:04:24,383 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:04:24,385 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:04:26,276 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:04:35,504 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:04:35,887 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:04:36,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:04:37,065 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:04:37,067 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:04:39,615 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:04:39,616 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:04:40,438 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:04:40,449 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:04:40,450 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:04:40,451 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:04:40,456 - ispa_next.main - DEBUG - Found new Appointment: M-HT 1691 E
2025-11-17 12:04:40,457 - ispa_next.main - DEBUG - 



2025-11-17 12:04:40,457 - ispa_next.main - DEBUG - starting with process 2 (M-HT 1691 E) of 16
2025-11-17 12:04:40,462 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:04:41,439 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:04:42,474 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:04:42,476 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:04:43,944 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:04:43,946 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:05:21,731 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:05:25,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:29,130 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:05:29,131 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:29,225 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:29,443 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:05:29,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:29,588 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:33,783 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:05:33,801 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:33,879 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:37,166 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:05:37,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:38,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:40,015 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:05:40,115 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:05:43,348 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:05:43,417 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:05:47,546 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:05:48,553 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:05:48,558 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:05:48,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:49,032 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:49,033 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:05:49,077 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:05:50,262 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:05:50,497 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:05:53,163 - ispa_next.functions - DEBUG - Updated appointment (AB00028055) customer contact data.
2025-11-17 12:05:54,065 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:05:54,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:54,142 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:54,347 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:05:54,350 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:05:55,153 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:05:55,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:05:55,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:05:59,429 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:05:59,429 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:05:59,433 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:05:59,434 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:05:59,435 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:59,939 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:04,078 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:06:04,913 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:06:16,778 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:06:16,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:16,856 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:06:26,163 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 12:06:34,386 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:06:34,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:35,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:35,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:35,912 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:35,913 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:06:39,663 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:06:39,665 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:06:41,040 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:06:41,042 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:06:41,044 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart)}
2025-11-17 12:06:41,045 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:06:41,047 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 12:06:41,048 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:06:41,050 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:06:41,051 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:06:41,052 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:06:41,063 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:07:24,772 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:07:24,773 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 12:07:27,836 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:28,432 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:30,005 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:30,591 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:31,141 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:32,084 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:32,659 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:33,234 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:34,208 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:34,834 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:35,419 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:36,391 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:37,006 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:37,583 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:38,563 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:39,145 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:39,686 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:40,602 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:41,215 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:41,769 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 12:07:42,706 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:43,929 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 12:07:44,906 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 12:07:45,762 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 12:07:53,831 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:07:53,835 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:07:53,836 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:58,745 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:07:58,747 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:07:58,754 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:08:03,487 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:08:03,490 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:08:03,493 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:08:03,496 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:08:08,243 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:08:08,245 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:08:09,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:08:09,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:08:10,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:08:45,683 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:08:45,684 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:08:46,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:08:46,703 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:08:46,706 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:08:51,790 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:09:03,508 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:09:03,884 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:09:05,840 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:09:06,652 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:09:06,653 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:09:11,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:09:11,259 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:09:12,509 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:09:12,521 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:09:12,521 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:09:12,522 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:09:12,531 - ispa_next.main - DEBUG - 



2025-11-17 12:09:12,531 - ispa_next.main - DEBUG - starting with process 3 (F-RR 8716) of 16
2025-11-17 12:09:12,536 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:09:14,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:09:16,601 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:09:16,603 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:09:18,656 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:09:18,657 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:09:55,324 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:09:58,956 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:59,037 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:59,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:01,887 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:10:01,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:01,987 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:10:02,284 - ispa_next.functions - DEBUG - HU date soon to be invalid in 42 days.
2025-11-17 12:10:07,191 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:10:07,195 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:10:07,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:07,306 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:10:16,102 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:10:16,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:10:17,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:10:19,695 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:10:19,883 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:10:20,061 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:10:20,212 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:10:20,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:22,910 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:10:35,396 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:10:36,404 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:10:36,410 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:10:36,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:37,017 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:37,018 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:10:37,072 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:10:37,212 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:10:38,490 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:10:38,708 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:10:40,694 - ispa_next.functions - DEBUG - Updated appointment (AB00028034) customer contact data.
2025-11-17 12:10:41,609 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:10:41,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:41,830 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:10:42,081 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:10:42,086 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:10:42,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:10:43,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:10:44,850 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:10:44,852 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:10:45,000 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:10:49,063 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:10:49,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:10:49,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:10:51,668 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:10:51,799 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:10:52,007 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:10:52,175 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:10:52,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:54,959 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:11:07,156 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:12:07,159 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:12:19,408 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:12:55,412 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:13:07,591 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 12:13:13,915 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 12:13:14,922 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:13:14,932 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:13:14,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:13:15,031 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:13:19,232 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:13:19,239 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:13:19,240 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 12:13:19,241 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:13:21,732 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:13:21,734 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:13:23,167 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:13:23,171 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:13:23,173 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:13:23,184 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:13:23,186 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:13:23,187 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:13:23,189 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:13:23,191 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:13:23,192 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:13:23,199 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:13:23,206 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:13:23,208 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:13:23,209 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:25,815 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:13:25,818 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:13:25,820 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:28,431 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:13:28,435 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:13:28,438 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:13:28,440 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:31,101 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:13:31,104 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:13:32,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:13:33,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:13:33,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:13:59,316 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:03,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:09,855 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:14:09,859 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:14:09,860 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:14:10,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:14:11,035 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:14:11,037 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:14:13,879 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:14:24,522 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:14:24,912 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 12:14:26,650 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:14:27,508 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:14:27,510 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:14:32,293 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:14:32,294 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:14:33,676 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:14:33,692 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:14:33,693 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:14:33,694 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:14:33,700 - ispa_next.main - DEBUG - 



2025-11-17 12:14:33,700 - ispa_next.main - DEBUG - starting with process 4 (HU-MJ 28) of 16
2025-11-17 12:14:33,704 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:14:35,517 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:14:37,425 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:14:37,427 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:14:39,667 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:14:39,669 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:15:21,705 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:15:25,559 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:15:28,226 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:15:28,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:28,308 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:15:28,674 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:15:28,677 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:15:28,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:28,812 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:15:32,223 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:15:32,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:15:33,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:15:35,968 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:15:36,132 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:15:36,292 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:15:36,448 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:15:40,669 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:15:41,676 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:15:41,681 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:15:41,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:42,262 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:42,263 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:15:42,336 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:15:43,757 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:15:43,986 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:15:46,208 - ispa_next.functions - DEBUG - Updated appointment (AA00030021) customer contact data.
2025-11-17 12:15:47,150 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:15:47,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:15:47,396 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:15:47,648 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:15:47,650 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:15:48,880 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:15:48,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:15:49,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:15:53,549 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:15:53,550 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:15:53,554 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:15:53,555 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:15:53,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:15:54,077 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:15:58,293 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:15:58,297 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:15:58,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:15:58,414 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:16:12,665 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 12:16:31,723 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:16:32,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:16:33,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:16:33,010 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:16:33,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:16:33,877 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:16:36,365 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:16:36,375 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:16:38,098 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:16:38,099 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:16:38,101 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:16:38,103 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:16:38,105 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:16:38,106 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:16:38,107 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:16:38,112 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:16:38,117 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:16:38,126 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:16:38,133 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:16:38,136 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:16:38,137 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:40,844 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:16:40,846 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:16:40,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:43,481 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:16:43,484 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:16:43,486 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:16:43,490 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:16:46,080 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:16:46,083 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:16:46,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:16:48,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:16:48,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:17:14,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:17:20,719 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:17:26,586 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:17:26,589 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:17:26,590 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:17:27,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:17:27,654 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:17:27,656 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:17:30,042 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:17:40,751 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:17:41,129 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 12:17:41,687 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:17:44,067 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:17:44,069 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:17:48,760 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:17:48,761 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:17:50,019 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:17:50,033 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:17:50,034 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:17:50,036 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:17:50,046 - ispa_next.main - DEBUG - 



2025-11-17 12:17:50,046 - ispa_next.main - DEBUG - starting with process 5 (HU-TK 1402) of 16
2025-11-17 12:17:50,054 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:17:51,786 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:17:53,293 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-17 12:17:53,295 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:17:55,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:17:55,567 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:18:35,914 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:18:39,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:18:42,931 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:18:42,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:43,021 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:18:43,382 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:18:49,699 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:18:49,703 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:18:49,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:18:49,797 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:18:58,825 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:18:58,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:00,538 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:19:02,541 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:19:02,736 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:19:02,917 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:19:03,033 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:19:07,300 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:19:08,308 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:19:08,313 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:19:08,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:08,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:08,889 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:19:08,981 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:19:10,382 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:19:10,619 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:19:12,832 - ispa_next.functions - DEBUG - Updated appointment (AB00028030) customer contact data.
2025-11-17 12:19:13,815 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:19:13,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:14,298 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:19:14,588 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:19:14,590 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:19:15,922 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:19:15,923 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:19:17,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:19:21,082 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:19:21,082 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:19:21,087 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:19:21,087 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:19:21,088 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:21,616 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:19:25,823 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:19:25,828 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:19:25,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:25,916 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:29,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:30,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:19:30,341 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:31,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:19:31,319 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:19:34,422 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:19:34,428 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:19:35,849 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:19:35,850 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:19:35,852 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:19:35,853 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:19:35,855 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:19:35,857 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:19:35,858 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:19:35,867 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:19:35,870 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:19:35,874 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:19:35,879 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:19:35,881 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:19:35,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:39,262 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:19:39,265 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:19:39,270 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:19:42,627 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:19:42,758 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:19:54,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:08,481 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:20:08,483 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:20:08,486 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:20:08,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:11,906 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:20:11,908 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:20:13,317 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:20:14,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:20:15,132 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:20:48,690 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:20:53,291 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:20:58,423 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:03,605 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:21:03,608 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:21:03,609 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:04,404 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:21:04,509 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:21:04,511 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:21:06,738 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:21:18,662 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:21:19,065 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 12:21:21,463 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:22,528 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:21:22,533 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:27,437 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:21:27,438 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:21:28,514 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:21:28,527 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:21:28,528 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:21:28,529 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:21:28,534 - ispa_next.main - DEBUG - 



2025-11-17 12:21:28,534 - ispa_next.main - DEBUG - starting with process 6 (HU-PW 667) of 16
2025-11-17 12:21:28,539 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:21:30,073 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:21:31,622 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:21:31,623 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 12:21:33,586 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:21:33,588 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:22:10,472 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:22:14,899 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:22:16,903 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:22:16,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:17,010 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:17,544 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:22:17,550 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:22:17,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:17,684 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:21,144 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:22:21,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:22,491 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:22:24,495 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:22:24,650 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:22:24,818 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:22:24,911 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:22:29,164 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:22:30,178 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:22:30,184 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:22:30,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:30,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:30,721 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:22:30,793 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:22:32,190 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:22:32,602 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:22:35,208 - ispa_next.functions - DEBUG - Updated appointment (AA00030017) customer contact data.
2025-11-17 12:22:36,138 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:22:36,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:36,397 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:22:36,703 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:22:36,705 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:22:38,117 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:22:38,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:22:39,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:22:43,434 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:22:43,435 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:22:43,440 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:22:43,442 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:22:43,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:44,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:22:48,256 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:22:48,262 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:22:48,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:48,399 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:22:54,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:54,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:22:54,687 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:22:55,683 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:22:55,683 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:22:57,724 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:22:57,726 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:22:59,091 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:22:59,093 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:22:59,094 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:22:59,096 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:22:59,098 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:22:59,099 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:22:59,100 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:22:59,102 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:22:59,103 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:22:59,111 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:22:59,118 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:22:59,122 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:22:59,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:01,075 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:23:01,078 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:23:01,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:03,008 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:23:03,011 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:23:03,013 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:23:03,017 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:04,900 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:23:04,903 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:23:05,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:23:06,561 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:23:06,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:23:28,575 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:23:34,436 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:23:34,439 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:23:34,440 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:23:35,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:23:35,650 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:23:35,652 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:23:38,525 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:23:49,821 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:23:50,225 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 12:23:52,064 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:23:52,917 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:23:52,918 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:23:57,565 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:23:57,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:23:58,780 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:23:58,792 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:23:58,793 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:23:58,794 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:23:58,799 - ispa_next.main - DEBUG - 



2025-11-17 12:23:58,799 - ispa_next.main - DEBUG - starting with process 7 (FB-B 985) of 16
2025-11-17 12:23:58,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:24:00,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:24:02,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:24:02,482 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 12:24:04,724 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:24:04,726 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:24:45,246 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:24:49,067 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:24:50,331 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:24:50,336 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:24:50,461 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:24:50,820 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:24:50,826 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:24:50,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:24:50,925 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:24:54,435 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:24:54,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:24:56,064 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:24:58,070 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:24:58,277 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:24:58,441 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:24:58,605 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:25:02,816 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:25:03,823 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:25:03,828 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:25:03,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:04,392 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:04,393 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:25:04,446 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:25:06,156 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:25:06,354 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:25:08,531 - ispa_next.functions - DEBUG - Updated appointment (AA00030016) customer contact data.
2025-11-17 12:25:09,469 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:25:09,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:09,682 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:25:09,970 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:25:09,973 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:25:11,277 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:25:11,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:25:12,415 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:25:16,010 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:25:16,010 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:25:16,015 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:25:16,017 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:25:16,018 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:16,529 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:25:20,721 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:25:20,727 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:25:20,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:20,861 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:25:29,726 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:30,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:25:30,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:25:31,244 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:25:31,244 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:25:32,617 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:25:32,620 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:25:34,042 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:25:34,046 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:25:34,049 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:25:34,051 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:25:34,053 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:25:34,054 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:25:34,056 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:25:34,057 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:25:34,058 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:25:34,060 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:25:34,064 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:25:34,067 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:25:34,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:35,403 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:25:35,406 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:25:35,408 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:36,676 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:25:36,679 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:25:36,682 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:25:36,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:37,938 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:25:37,941 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:25:38,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:25:39,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:25:39,910 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:25:55,342 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:25:55,345 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:25:55,347 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:25:56,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:25:56,555 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:25:56,557 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:25:59,468 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:26:11,030 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:26:11,402 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 12:26:13,104 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:26:13,999 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:26:14,001 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:26:18,400 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:26:18,401 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:26:19,963 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:26:19,975 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:26:19,976 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:26:19,977 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:26:19,983 - ispa_next.main - DEBUG - 



2025-11-17 12:26:19,983 - ispa_next.main - DEBUG - starting with process 8 (HU-KJ 81) of 16
2025-11-17 12:26:19,987 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:26:21,806 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:26:23,707 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:26:23,709 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:26:25,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:26:25,975 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:27:02,493 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:27:06,206 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:08,166 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:27:08,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:08,274 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:27:08,656 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:27:13,756 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:27:13,759 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:27:13,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:13,847 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:27:17,892 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:27:17,894 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:27:19,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:27:21,463 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:27:21,616 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:27:21,775 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:27:21,878 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:27:26,131 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:27:27,149 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:27:27,155 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:27:27,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:27,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:27,759 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:27:27,803 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:27:29,091 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:27:29,317 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:27:31,438 - ispa_next.functions - DEBUG - Updated appointment (AA00030012) customer contact data.
2025-11-17 12:27:32,356 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:27:32,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:32,898 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:27:33,223 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:27:33,226 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:27:34,483 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:27:34,484 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:27:35,621 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:27:39,695 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:27:39,695 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:27:39,699 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:27:39,700 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:27:39,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:27:40,304 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:27:44,501 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:27:44,520 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:27:44,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:27:44,644 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:27:50,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:50,840 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:27:50,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:27:51,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:27:51,604 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:27:53,487 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:27:53,491 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:27:54,712 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:27:54,713 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:27:54,714 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:27:54,715 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:27:54,717 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:27:54,718 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:27:54,719 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:27:54,720 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:27:54,721 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:27:54,722 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:27:54,725 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:27:54,728 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:27:54,729 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:56,608 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:27:56,611 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:27:56,613 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:27:58,615 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:27:58,618 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:27:58,621 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:27:58,623 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:00,582 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:28:00,585 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:28:01,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:28:02,438 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:28:02,718 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:28:21,692 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:28:27,587 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:28:27,590 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:28:27,591 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:28:28,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:28:28,657 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:28:28,659 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:28:30,986 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:28:42,657 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:28:43,056 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 12:28:44,861 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:28:45,988 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:28:45,990 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:28:50,895 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:28:50,896 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:28:52,142 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:28:52,159 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:28:52,160 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:28:52,161 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:28:52,167 - ispa_next.main - DEBUG - 



2025-11-17 12:28:52,167 - ispa_next.main - DEBUG - starting with process 9 (HU-XS 108) of 16
2025-11-17 12:28:52,173 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:28:54,004 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:28:55,771 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:28:55,772 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:28:58,012 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:28:58,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:29:36,160 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:29:40,358 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:29:42,272 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:29:42,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:42,370 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:42,702 - ispa_next.functions - DEBUG - HU date already expired after 323 days.
2025-11-17 12:29:48,200 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:29:48,204 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:29:48,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:29:48,283 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:29:56,801 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:29:56,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:29:58,105 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:00,112 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:30:00,252 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:30:00,440 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:30:00,568 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:30:04,845 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:30:05,866 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:30:05,872 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:30:05,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:06,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:06,386 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:30:06,435 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:30:06,623 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:30:07,878 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:30:08,086 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:30:10,549 - ispa_next.functions - DEBUG - Updated appointment (AA00030000) customer contact data.
2025-11-17 12:30:11,464 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:30:11,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:11,655 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:30:11,831 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:30:11,834 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:30:11,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:30:12,988 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:30:14,232 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:30:14,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:30:14,317 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:30:17,975 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:30:17,975 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:30:17,979 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:30:17,980 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:30:17,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:18,523 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:22,688 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:30:22,694 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:30:22,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:22,817 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:30:23,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:23,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:30:23,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:30:24,688 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:30:24,688 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:30:26,616 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:30:26,617 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:30:27,689 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:30:27,692 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:30:27,694 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:30:27,697 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:30:27,700 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:30:27,703 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:30:27,705 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:30:27,707 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:30:27,708 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:30:27,709 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:30:27,713 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:30:27,715 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:30:27,716 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:29,656 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:30:29,659 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:30:29,663 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:31,688 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:30:31,690 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:30:31,693 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:30:31,699 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:30:33,639 - ispa_next.functions - DEBUG - adding material to item=Package(name=Ölwechsel im Doppelkupplungsgetriebe (DKG), source=cart, target=unkown)
2025-11-17 12:30:43,502 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:30:43,518 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:30:44,221 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:30:45,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:30:45,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:31:05,540 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:10,793 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:31:10,796 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:31:10,796 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:31:11,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:31:11,675 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:31:11,678 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:31:13,949 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:31:25,468 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:31:25,837 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 12:31:27,690 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:31:28,805 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:31:28,807 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:31:33,852 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:31:33,852 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:31:35,163 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:31:35,176 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:31:35,177 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:31:35,178 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:31:35,183 - ispa_next.main - DEBUG - 



2025-11-17 12:31:35,183 - ispa_next.main - DEBUG - starting with process 10 (HU-AS 958) of 16
2025-11-17 12:31:35,187 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:31:37,174 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:31:38,666 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:31:38,668 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:31:40,635 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:31:40,636 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:32:20,090 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:32:23,797 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:32:26,393 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:32:26,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:26,486 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:32:26,924 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:32:33,441 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:32:33,445 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:32:33,446 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:33,550 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:32:42,608 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:32:42,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:32:44,257 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:32:46,266 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:32:46,425 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:32:46,585 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:32:46,683 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:32:48,904 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:32:49,926 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:32:49,930 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:32:49,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:50,776 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:50,777 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:32:50,847 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:32:51,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:32:52,417 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:32:52,631 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:32:54,957 - ispa_next.functions - DEBUG - Updated appointment (AF00016210) customer contact data.
2025-11-17 12:32:55,870 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:32:55,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:32:56,164 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:32:56,385 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:32:56,388 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:32:56,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:32:58,394 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:32:59,812 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:32:59,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:32:59,916 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:33:04,077 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:33:04,077 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:33:04,081 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:33:04,082 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:33:04,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:33:04,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:33:08,904 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:33:14,014 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:33:14,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:33:14,112 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:33:14,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:14,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:33:14,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:33:15,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:33:15,905 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:33:18,523 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:33:18,525 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:33:20,995 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:33:20,996 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:33:20,998 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:33:20,999 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:33:21,001 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:33:21,003 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:33:21,007 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:33:21,010 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:33:21,012 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:33:21,015 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:33:21,022 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:33:21,024 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:33:21,025 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:23,621 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:33:23,624 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:33:23,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:26,277 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:33:26,280 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:33:26,283 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:33:26,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:28,989 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:33:28,991 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:33:29,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:33:30,675 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:33:30,885 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:33:57,210 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:34:03,216 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:34:10,071 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:34:10,074 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:34:10,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:34:11,113 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:34:11,235 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:34:11,237 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:34:13,941 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:34:25,683 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:34:26,054 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 12:34:28,025 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:34:29,172 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:34:29,174 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:34:34,377 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:34:34,377 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:34:35,624 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:34:35,637 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:34:35,638 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:34:35,639 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:34:35,644 - ispa_next.main - DEBUG - 



2025-11-17 12:34:35,644 - ispa_next.main - DEBUG - starting with process 11 (OF-JF 333) of 16
2025-11-17 12:34:35,649 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:34:37,573 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:34:39,379 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 680
2025-11-17 12:34:39,381 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:34:41,506 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:34:41,508 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:35:20,816 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:35:25,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:35:30,473 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:35:30,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:30,571 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:35:30,988 - ispa_next.functions - DEBUG - HU date already expired after 24 days.
2025-11-17 12:35:37,363 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:35:37,366 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:35:37,367 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:37,482 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:35:47,690 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:35:47,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:35:49,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:35:51,251 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:35:51,386 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:35:51,575 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:35:51,680 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:35:55,901 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:35:56,908 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:35:56,927 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:35:56,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:57,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:35:57,519 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:35:57,657 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:35:57,857 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:35:59,345 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:35:59,569 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:36:02,360 - ispa_next.functions - DEBUG - Updated appointment (AE00018282) customer contact data.
2025-11-17 12:36:03,280 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:36:03,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:36:03,592 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:36:03,857 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:36:03,860 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:36:04,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:36:05,254 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:36:06,820 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:36:06,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:36:06,932 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:36:10,533 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:36:10,533 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:36:10,538 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:36:10,539 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:36:10,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:11,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:36:15,340 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:36:21,072 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:36:21,073 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:21,190 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:36:21,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:36:22,152 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:36:22,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:23,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:36:23,064 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:36:28,001 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:36:28,007 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:36:29,448 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:36:29,450 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:36:29,451 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:36:29,452 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:36:29,454 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:36:29,455 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:36:29,456 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:36:29,457 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:36:29,458 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:36:29,459 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:36:29,463 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:36:29,466 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:36:29,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:36:35,000 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:36:35,002 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:36:35,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:36:40,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:36:40,498 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:36:52,802 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:36:52,805 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:36:52,807 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:36:52,810 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:36:58,404 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:36:58,407 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:36:59,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:37:00,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:37:00,480 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:37:48,728 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:37:55,521 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:38:02,133 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:38:07,962 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:38:14,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:38:20,682 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:38:20,685 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:38:20,686 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:38:21,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:38:21,886 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:38:21,888 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:38:24,927 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:38:38,154 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:38:38,551 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 12:38:40,986 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:38:42,074 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:38:42,075 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:38:47,554 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:38:47,555 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:38:48,708 - ispa_next.appointments.models - DEBUG - Appointment Firma CCT GmbH AN-KS 336 WBA31GN0X05142691 ohne Termin.
2025-11-17 12:38:48,718 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:38:48,731 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:38:48,732 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:38:48,733 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:38:48,738 - ispa_next.main - DEBUG - 



2025-11-17 12:38:48,738 - ispa_next.main - DEBUG - starting with process 12 (FB-SR 1700) of 16
2025-11-17 12:38:48,743 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:38:50,295 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:38:51,862 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:38:51,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 12:38:53,831 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:38:53,832 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:39:33,429 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:39:37,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:39:40,281 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:39:40,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:40,440 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:39:40,785 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:39:40,788 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:39:40,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:39:40,981 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:39:50,085 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:39:50,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:39:51,908 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:39:53,952 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:39:54,103 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:39:54,267 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:39:54,417 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:39:58,684 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:39:59,691 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:39:59,695 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:39:59,712 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:40:00,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:40:00,206 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:40:00,269 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:40:00,469 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:40:01,783 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:40:01,995 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:40:04,301 - ispa_next.functions - DEBUG - Updated appointment (AR00006517) customer contact data.
2025-11-17 12:40:05,225 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:40:05,226 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:40:05,482 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:40:05,727 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:40:05,730 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:40:05,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:40:07,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:40:08,746 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:40:08,747 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:40:08,902 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:40:13,027 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:40:13,027 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:40:13,027 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:40:13,032 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:40:13,033 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:40:13,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:40:13,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:40:17,777 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:40:17,783 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:40:17,784 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:40:17,872 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:40:18,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:40:18,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:40:18,814 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:40:19,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:40:19,683 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:40:22,274 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:40:22,277 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:40:24,019 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:40:24,020 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:40:24,022 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:40:24,023 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:40:24,025 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:40:24,026 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:40:24,027 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:40:24,028 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:40:24,029 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:40:24,031 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:40:24,042 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:40:24,045 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:40:24,047 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:40:26,832 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:40:26,836 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:40:26,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:40:29,583 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:40:29,586 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:40:29,588 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:40:29,591 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:40:32,271 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:40:32,274 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:40:33,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:40:34,312 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:40:34,598 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:41:01,142 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:41:06,966 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:41:13,654 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:41:13,657 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:41:13,658 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:41:14,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:41:14,690 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:41:14,692 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:41:17,467 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:41:28,581 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:41:28,958 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 12:41:30,964 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:41:32,104 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:41:32,110 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:41:36,836 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:41:36,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:41:38,113 - ispa_next.appointments.models - DEBUG - Appointment Firma CCT GmbH AN-KS 336 WBA31GN0X05142691 ohne Termin.
2025-11-17 12:41:38,124 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:41:38,137 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:41:38,138 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:41:38,139 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:41:38,146 - ispa_next.main - DEBUG - 



2025-11-17 12:41:38,146 - ispa_next.main - DEBUG - starting with process 13 (MKK-RM 157) of 16
2025-11-17 12:41:38,151 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:41:39,702 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:41:41,522 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:41:41,524 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 12:41:44,014 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:41:44,016 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:42:27,996 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:42:31,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:33,736 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:42:33,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:42:33,857 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:42:34,203 - ispa_next.functions - DEBUG - HU date already expired after 84 days.
2025-11-17 12:42:41,021 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:42:41,025 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:42:41,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:42:41,119 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:42:50,622 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:42:50,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:42:52,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:42:54,212 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:42:54,372 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:42:54,491 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:42:54,622 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:42:54,623 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:42:56,620 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:43:09,911 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:43:10,925 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:43:10,929 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:43:10,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:43:11,562 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:43:11,563 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:43:11,621 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:43:12,962 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:43:14,343 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:43:14,564 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:43:17,377 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:43:17,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:43:17,569 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:43:17,782 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:43:17,785 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:43:19,001 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:43:19,002 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:43:20,294 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:43:24,381 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:43:24,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:43:24,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:43:26,908 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:43:27,071 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:43:27,205 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:43:27,307 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:43:27,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:43:29,395 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:43:41,717 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:44:41,734 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:44:53,832 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 12:45:28,835 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:45:41,359 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen' in nested popup
2025-11-17 12:45:51,210 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:45:51,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:46:00,508 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:04,652 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:08,558 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:12,746 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Zündkerzen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:17,084 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:21,944 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Motoröl' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:26,318 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Gasdruckfedern für Frontklappe prüfen' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:30,683 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Standardumfang' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:35,058 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Bremsflüssigkeit' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 12:46:37,862 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:46:41,027 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:46:42,035 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:46:42,035 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:46:42,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:46:42,163 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:46:46,307 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:46:52,070 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:46:52,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:46:52,188 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:46:52,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:53,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:46:53,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:46:54,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:46:54,015 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:46:55,956 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:46:55,959 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:47:00,957 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:47:00,958 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:47:00,961 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:47:00,963 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:47:00,964 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:47:00,966 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:47:00,967 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:47:00,969 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:47:00,976 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:47:00,980 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:47:00,987 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:47:00,989 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:47:00,990 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:03,005 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:47:03,008 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:47:03,013 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:04,989 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:47:04,992 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:47:04,994 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:47:04,996 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:06,925 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:47:06,927 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:47:07,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:47:08,796 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:47:09,049 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:47:29,582 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:47:35,922 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:47:35,925 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:47:35,926 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:47:36,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:47:37,120 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:47:37,122 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:47:39,879 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:47:51,676 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:47:52,052 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 12:47:54,274 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:47:55,438 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:47:55,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:48:00,227 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 209
2025-11-17 12:48:00,229 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:48:01,364 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:48:01,376 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:48:01,377 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:48:01,378 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:48:01,384 - ispa_next.main - DEBUG - 



2025-11-17 12:48:01,384 - ispa_next.main - DEBUG - starting with process 14 (GN-BB 156) of 16
2025-11-17 12:48:01,389 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:48:03,141 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:48:05,021 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:48:05,023 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 209
2025-11-17 12:48:07,326 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:48:07,328 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:48:45,972 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:48:49,822 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:48:49,904 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:48:50,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:48:52,192 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:48:52,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:48:52,278 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:48:52,700 - ispa_next.functions - DEBUG - HU date already expired after 5070 days.
2025-11-17 12:48:59,445 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:48:59,448 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:48:59,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:48:59,578 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:49:08,952 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:49:08,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:10,579 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:49:12,582 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:49:21,190 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 12:49:27,868 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 12:49:28,874 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:49:28,878 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:49:28,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:29,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:29,434 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:49:29,515 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:49:29,687 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:49:30,914 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 12:49:32,396 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:49:32,627 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:49:35,630 - ispa_next.functions - DEBUG - Updated appointment (AD00021162) customer contact data.
2025-11-17 12:49:36,557 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:49:36,591 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:36,846 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:49:37,117 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 12:49:37,120 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:49:37,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:49:38,545 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:49:39,966 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:49:39,967 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:49:40,089 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:49:44,228 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:49:44,228 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:49:44,228 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:49:44,232 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:49:44,233 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:49:44,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:44,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:49:48,963 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:49:48,969 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:49:48,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:49,062 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:49:49,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:50,014 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:49:50,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:49:50,913 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:49:50,914 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:49:52,832 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:49:52,834 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:49:54,095 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:49:54,099 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:49:54,102 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:49:54,104 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:49:54,107 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:49:54,109 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:49:54,110 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:49:54,111 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:49:54,112 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:49:54,114 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:49:54,118 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:49:54,120 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:49:54,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:56,186 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:49:56,189 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:49:56,196 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:49:58,216 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:49:58,220 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:49:58,222 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:49:58,227 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:00,210 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:50:00,213 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:50:01,051 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:50:02,046 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:50:02,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:50:24,581 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:50:31,009 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:50:31,012 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:50:31,013 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:50:32,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:50:32,129 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:50:32,137 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:50:34,830 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:50:46,839 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:50:47,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 12:50:49,036 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:50:50,034 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:50:50,035 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:50:54,296 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:50:54,297 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:50:55,299 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:50:55,309 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:50:55,311 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:50:55,312 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:50:55,316 - ispa_next.main - DEBUG - Found new Appointment: AN-KS 336
2025-11-17 12:50:55,318 - ispa_next.main - DEBUG - 



2025-11-17 12:50:55,318 - ispa_next.main - DEBUG - starting with process 15 (AN-KS 336) of 17
2025-11-17 12:50:55,322 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:50:56,792 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:50:58,442 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 681
2025-11-17 12:50:58,444 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 12:51:00,938 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:51:00,939 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:51:41,971 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:51:45,758 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:51:51,221 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:51:51,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:51:51,295 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:51:51,584 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:51:51,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:51:51,697 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:51:56,468 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:51:56,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:51:56,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:52:00,116 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:52:00,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:52:01,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:52:03,812 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:52:03,955 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:52:04,120 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:52:04,277 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:52:08,461 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 12:52:09,468 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:52:09,472 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:52:09,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:52:10,015 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:52:10,016 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:52:10,095 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:52:11,396 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:52:12,699 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:52:12,953 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:52:18,362 - ispa_next.functions - DEBUG - Updated appointment (AB00028058) customer contact data.
2025-11-17 12:52:19,331 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:52:19,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:52:19,639 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:52:22,521 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:52:24,493 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:52:24,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:52:25,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:52:29,374 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:52:29,374 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:52:29,379 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:52:29,381 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:52:29,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:52:29,916 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:52:34,117 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:52:35,426 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 12:52:47,768 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:52:47,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:52:47,866 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:52:56,740 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-17 12:53:04,955 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 12:53:05,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:05,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:53:05,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:06,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:53:06,789 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:53:11,780 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:53:11,786 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:53:13,340 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:53:13,358 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:53:13,362 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 12:53:13,364 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:53:13,366 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:53:13,369 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:53:13,370 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:53:13,371 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:53:13,383 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:53:13,385 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:53:13,388 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:53:36,530 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:53:36,545 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 12:53:44,555 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:53:44,558 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:53:44,559 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:50,808 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:53:50,811 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:53:50,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:53:57,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:53:57,092 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:54:07,536 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:54:25,350 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:54:25,353 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:54:25,356 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:54:25,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:54:31,599 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:54:31,602 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:54:32,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:54:33,614 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:54:33,900 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:55:29,791 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:55:29,792 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:55:30,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:55:30,881 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:55:30,884 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:55:36,358 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:55:50,360 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:55:50,735 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 12:55:53,369 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:55:54,464 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 12:55:54,465 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:56:00,102 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:56:00,103 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:01,379 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:56:01,391 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:56:01,392 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:56:01,393 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:56:01,399 - ispa_next.main - DEBUG - 



2025-11-17 12:56:01,399 - ispa_next.main - DEBUG - starting with process 16 (MKK-MG 366) of 17
2025-11-17 12:56:01,404 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:56:03,188 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:56:04,684 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 12:56:04,685 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 12:56:06,760 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:56:06,762 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:56:48,764 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:56:53,242 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:56:58,782 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:56:58,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:56:58,869 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:56:59,288 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:56:59,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:56:59,453 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:57:10,666 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:57:10,681 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:11,100 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:57:21,806 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:57:21,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:57:23,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:57:25,553 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:57:34,021 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 12:57:40,311 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 12:57:41,317 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:57:41,323 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:57:41,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:41,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:41,859 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:57:41,923 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:57:42,069 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:57:44,067 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:57:44,304 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:57:46,814 - ispa_next.functions - DEBUG - Updated appointment (AD00021124) customer contact data.
2025-11-17 12:57:47,755 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:57:47,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:57:48,051 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:57:51,361 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:57:51,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:57:52,966 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:57:54,428 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:57:54,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:57:54,529 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 12:57:58,615 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 12:57:58,615 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:57:58,615 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 12:57:58,618 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:57:58,619 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:57:58,620 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:57:59,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:58:03,271 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 12:58:09,227 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:58:09,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:09,318 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:58:09,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:10,240 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:58:10,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:11,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:58:11,111 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:58:16,102 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:58:16,104 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:58:17,451 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:58:17,452 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:58:17,453 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 12:58:17,454 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:58:17,457 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:58:17,459 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:58:17,461 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:58:17,471 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:58:17,474 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:58:17,478 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:58:17,483 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:58:17,485 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:58:17,486 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:58:23,062 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:58:23,065 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:58:23,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:58:28,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:58:28,633 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:58:41,171 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:58:41,174 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:58:41,177 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:58:41,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:58:46,783 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:58:46,786 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:58:47,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:58:48,674 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:58:48,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:59:28,447 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:59:28,448 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:59:29,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:59:29,603 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:59:29,605 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:59:34,894 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:59:48,661 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:59:49,046 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 12:59:51,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:59:52,945 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 12:59:52,947 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:59:58,691 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 12:59:58,692 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:59:59,960 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 12:59:59,972 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 12:59:59,974 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:59:59,974 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:59:59,980 - ispa_next.main - DEBUG - 



2025-11-17 12:59:59,980 - ispa_next.main - DEBUG - starting with process 17 (F-BF 400) of 17
2025-11-17 12:59:59,984 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:00:01,922 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:00:03,994 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:00:03,996 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 210
2025-11-17 13:00:12,451 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:00:12,453 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:00:58,602 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:01:02,663 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:04,647 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:01:04,648 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:04,778 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:01:05,140 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:01:05,146 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:01:05,147 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:05,391 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:01:09,068 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:01:09,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:11,205 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:01:13,208 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:01:13,376 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:01:13,486 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:01:13,615 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:01:13,617 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:15,643 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:01:28,986 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:01:29,994 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:01:30,002 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:01:30,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:30,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:30,506 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:01:30,565 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:01:31,923 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:01:33,220 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:01:33,462 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:01:36,084 - ispa_next.functions - DEBUG - Updated appointment (AD00021115) customer contact data.
2025-11-17 13:01:37,010 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:01:37,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:01:37,386 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:01:37,694 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-17 13:01:37,697 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:01:38,821 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:01:38,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:01:40,457 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:01:45,361 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 13:01:45,362 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:01:45,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:01:45,970 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:01:47,974 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:01:48,098 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:01:48,261 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:01:48,411 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:01:48,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:01:50,522 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:02:02,869 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:03:02,871 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:03:15,138 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:03:23,450 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:03:23,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:25,464 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:03:27,645 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:03:28,663 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:03:28,664 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:03:28,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:28,803 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:03:32,957 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:03:38,451 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:03:38,452 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:38,540 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:03:39,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:39,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:03:39,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:03:40,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:03:40,604 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:03:42,618 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:03:42,624 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:03:44,547 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:03:44,549 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:03:44,551 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 13:03:44,553 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:03:44,555 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:03:44,561 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:03:44,564 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:03:44,567 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:03:44,570 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:03:44,572 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:03:44,576 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:03:44,579 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:03:44,581 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:46,645 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 13:03:51,358 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:03:51,430 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:03:51,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:53,827 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:03:53,830 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:03:53,833 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:03:53,835 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:03:55,808 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:03:55,811 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:03:56,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:04:01,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:04:01,816 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:04:22,231 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:04:30,770 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:04:30,773 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:04:30,774 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:04:31,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:04:31,815 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:04:31,817 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:04:34,233 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:04:47,688 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:04:48,076 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 13:04:50,448 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:04:51,737 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-17 13:04:51,738 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:04:57,568 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 210
2025-11-17 13:04:57,569 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:04:58,746 - ispa_next.appointments.models - DEBUG - Appointment Waldemar Mackert HU-WM 142 WBA1A11060E924206 ohne Termin.
2025-11-17 13:04:58,757 - ispa_next.appointments.models - DEBUG - Appointment   WMW31GC01STA92039 ohne Termin.
2025-11-17 13:04:58,758 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:04:58,759 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
