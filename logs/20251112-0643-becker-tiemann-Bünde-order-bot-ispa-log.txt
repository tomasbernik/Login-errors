2025-11-12 06:43:31,604 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 06:43:31,610 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 06:43:39,964 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 06:43:51,756 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 06:44:07,304 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 06:44:46,467 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 06:44:57,590 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 06:45:00,784 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:45:01,913 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:45:01,915 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:45:04,135 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 160
2025-11-12 06:45:04,136 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 06:45:04,137 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 06:45:05,248 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 06:45:06,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:45:29,922 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 06:45:29,937 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 06:45:29,945 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 06:45:29,953 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 06:45:29,968 - ispa_next.main - DEBUG - Found 15 out of 38 appointments to process (configured limit: 15).
2025-11-12 06:45:29,968 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-12 06:45:29,968 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 06:45:29,968 - ispa_next.main - DEBUG - All appointments: BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE, HF-JC 8820, HF-C 213, HF-C 213, HF-H 2227E, HF-AV 404, HF-GE 123, OS-BO 693, HF-EO 550E
2025-11-12 06:45:29,971 - ispa_next.main - DEBUG - 



2025-11-12 06:45:29,971 - ispa_next.main - DEBUG - starting with process 1 (BÜNDE) of 15
2025-11-12 06:45:29,975 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:45:31,146 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:45:32,273 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:45:32,274 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 160
2025-11-12 06:45:33,450 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:45:33,452 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:46:14,495 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:46:14,592 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 06:46:14,595 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:46:15,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:46:15,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:46:17,493 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:46:17,494 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:46:18,268 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:46:18,271 - ispa_next.main - DEBUG - 



2025-11-12 06:46:18,272 - ispa_next.main - DEBUG - starting with process 2 (HF-LB-222) of 15
2025-11-12 06:46:18,275 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:46:19,397 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:46:20,461 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:46:20,462 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:46:21,805 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:46:21,807 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:46:55,632 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:46:55,641 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 06:46:55,644 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:46:56,067 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:46:56,067 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:46:58,397 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:46:58,398 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:46:59,254 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:46:59,256 - ispa_next.main - DEBUG - 



2025-11-12 06:46:59,257 - ispa_next.main - DEBUG - starting with process 3 (HF L 1612) of 15
2025-11-12 06:46:59,260 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:47:00,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:01,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:47:01,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:47:02,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:02,747 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:47:33,380 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:47:33,389 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 06:47:33,392 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:33,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:47:33,892 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:36,282 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:47:36,282 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:47:37,029 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:47:37,032 - ispa_next.main - DEBUG - 



2025-11-12 06:47:37,032 - ispa_next.main - DEBUG - starting with process 4 (OS-CW177) of 15
2025-11-12 06:47:37,036 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:47:38,121 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:47:39,259 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:47:39,261 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:47:40,600 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:47:40,602 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:48:09,924 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:48:09,935 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 06:48:09,939 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:48:10,435 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:48:10,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:48:12,759 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:48:12,760 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:48:13,543 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:48:13,546 - ispa_next.main - DEBUG - 



2025-11-12 06:48:13,546 - ispa_next.main - DEBUG - starting with process 5 (HF-BT 540) of 15
2025-11-12 06:48:13,549 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:48:14,717 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:48:15,777 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:48:15,778 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:48:17,054 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:48:17,055 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:48:39,586 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:48:49,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:48:53,416 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:48:53,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:48:53,508 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:48:53,769 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:48:53,774 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:48:53,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:48:53,868 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:48:57,032 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:48:57,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:48:58,168 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:49:00,173 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:49:00,283 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:49:03,542 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:49:03,611 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:49:03,611 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:49:11,991 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:49:12,995 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:49:12,996 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:49:13,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:49:25,117 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 06:49:25,117 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 06:49:32,351 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:49:32,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:49:32,414 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:49:32,415 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:49:32,524 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:49:33,742 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:49:34,018 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:49:37,211 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 06:49:38,110 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:49:38,112 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:49:38,850 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:49:38,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:49:39,588 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:49:43,183 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:49:43,185 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:49:43,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:49:45,658 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:49:45,797 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:49:45,898 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:49:45,986 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:49:45,986 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:49:57,307 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:50:01,641 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:50:01,642 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:50:05,800 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:50:06,806 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:50:06,809 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:50:06,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:50:06,919 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:50:16,136 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 06:50:21,209 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 06:50:21,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:50:21,763 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:50:21,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:50:22,532 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:50:22,533 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:50:26,115 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:50:26,116 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:50:27,180 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:50:27,181 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:50:27,184 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 06:50:27,189 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 06:50:27,191 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 06:50:27,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:50:27,198 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:50:27,200 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:50:27,201 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:50:27,202 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:50:27,203 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:50:27,205 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:50:27,207 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 06:50:49,591 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 06:50:49,615 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:50:49,616 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:50:50,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:50:51,226 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:50:51,227 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 06:50:51,274 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 06:50:53,856 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 06:50:53,859 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:50:54,342 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:50:54,343 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:50:56,916 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:50:56,917 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:50:57,757 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:50:57,760 - ispa_next.main - DEBUG - 



2025-11-12 06:50:57,760 - ispa_next.main - DEBUG - starting with process 6 (MI-JC 96 E) of 15
2025-11-12 06:50:57,763 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:50:58,903 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:50:59,838 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:50:59,839 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:51:01,230 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:51:01,231 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:51:31,420 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:51:31,430 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 06:51:31,432 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:51:31,952 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:51:31,953 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:51:34,362 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:51:34,363 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:51:35,177 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:51:35,180 - ispa_next.main - DEBUG - 



2025-11-12 06:51:35,180 - ispa_next.main - DEBUG - starting with process 7 (BÜNDE) of 15
2025-11-12 06:51:35,183 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:51:36,306 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:51:37,407 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:51:37,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:51:38,778 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:51:38,779 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:52:08,086 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 06:52:08,096 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 06:52:08,099 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:52:08,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:52:08,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:52:10,947 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:52:10,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:52:11,866 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:52:11,874 - ispa_next.main - DEBUG - 



2025-11-12 06:52:11,874 - ispa_next.main - DEBUG - starting with process 8 (HF-JC 8820) of 15
2025-11-12 06:52:11,877 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:52:13,009 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:52:14,021 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:52:14,023 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:52:15,337 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:52:15,338 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:52:37,147 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:52:38,732 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:52:43,355 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:52:44,580 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:52:44,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:52:44,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:52:44,881 - ispa_next.functions - DEBUG - HU date already expired after 1909 days.
2025-11-12 06:52:48,412 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:52:48,414 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:52:48,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:52:48,516 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:52:55,025 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:52:55,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:52:55,948 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:52:57,951 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:52:58,057 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:52:58,170 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:52:58,238 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:52:58,238 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:53:06,237 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:53:07,242 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:53:07,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:53:07,720 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:53:18,799 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 06:53:21,875 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:53:21,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:53:21,942 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:53:21,944 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:53:21,993 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:53:23,201 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:53:23,421 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:53:25,113 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:53:25,115 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:53:25,832 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:53:25,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:53:26,499 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:53:30,554 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 06:53:30,555 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:53:30,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:53:31,079 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:53:33,124 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:53:33,245 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:53:33,332 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:53:33,414 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:53:33,414 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:53:41,464 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:54:41,468 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:54:49,770 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:55:37,772 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:55:48,536 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:55:52,696 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:55:52,696 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:55:56,859 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:55:57,866 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:55:57,880 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:55:57,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:55:57,988 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:56:01,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:56:02,320 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:56:02,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:56:02,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:56:02,979 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:56:04,256 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:56:04,257 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:56:05,192 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:56:05,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:56:05,195 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 06:56:05,196 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 06:56:05,197 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:56:05,198 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:56:05,200 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:56:05,201 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:56:05,202 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:56:05,204 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:56:05,206 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:56:05,207 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:56:05,210 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:56:05,211 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:56:05,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:56:06,440 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:56:06,441 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:56:06,443 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:56:07,636 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:56:07,638 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:56:07,639 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:56:08,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:56:08,434 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:56:12,507 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:56:12,508 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:56:13,682 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:56:13,683 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:56:14,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:56:14,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:56:14,819 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:56:20,208 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 06:56:20,210 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 06:56:20,211 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:56:20,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:56:20,895 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 06:56:20,897 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 06:56:22,644 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 06:56:32,423 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 06:56:32,792 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 06:56:32,995 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:56:34,017 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:56:34,019 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 06:56:36,939 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 06:56:36,939 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:56:37,692 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 06:56:37,695 - ispa_next.main - DEBUG - 



2025-11-12 06:56:37,695 - ispa_next.main - DEBUG - starting with process 9 (HF-C 213) of 15
2025-11-12 06:56:37,698 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 06:56:38,723 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 06:56:39,640 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 06:56:39,641 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 06:56:40,938 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 06:56:40,939 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 06:57:13,790 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 06:57:15,595 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 06:57:20,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:57:22,258 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 06:57:22,259 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:22,346 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:57:22,536 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 06:57:22,538 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 06:57:22,539 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:22,611 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:57:29,365 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:57:29,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:57:30,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:57:32,259 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:57:32,393 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:57:32,481 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:57:32,574 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:57:32,575 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:57:40,864 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 06:57:41,880 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 06:57:41,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:42,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:52,230 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 06:57:55,979 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 06:57:55,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:57:56,065 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 06:57:56,066 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 06:57:56,133 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 06:57:56,241 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 06:57:57,464 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 06:57:57,696 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 06:57:58,982 - ispa_next.functions - DEBUG - Updated appointment (AI00015550) customer contact data.
2025-11-12 06:57:59,887 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 06:57:59,889 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 06:57:59,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:58:00,756 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 06:58:01,731 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 06:58:01,732 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 06:58:01,797 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 06:58:05,366 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 06:58:05,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:58:05,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:58:07,851 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 06:58:08,417 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 06:58:08,611 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 06:58:08,680 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 06:58:08,681 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:58:17,358 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 06:59:17,360 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 06:59:28,077 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 06:59:32,235 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 06:59:32,236 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 06:59:36,391 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 06:59:37,397 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 06:59:37,399 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 06:59:37,400 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:59:37,518 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 06:59:37,881 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 06:59:38,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 06:59:38,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 06:59:39,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 06:59:39,071 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 06:59:40,938 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 06:59:40,939 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 06:59:41,864 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 06:59:41,865 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:59:41,867 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 06:59:41,872 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 06:59:41,875 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 06:59:41,877 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 06:59:41,880 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 06:59:41,889 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 06:59:41,893 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 06:59:41,897 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 06:59:41,910 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 06:59:41,913 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 06:59:41,915 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 06:59:41,916 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 06:59:41,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:59:43,800 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 06:59:43,801 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 06:59:43,811 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:59:45,724 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 06:59:45,726 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 06:59:45,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 06:59:46,352 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 06:59:46,583 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:59:55,644 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 06:59:55,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 06:59:57,577 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 06:59:57,579 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 06:59:58,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 06:59:58,574 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 06:59:58,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:00:09,589 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:00:14,332 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:00:14,334 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:00:14,335 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:00:14,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:00:14,950 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:00:14,952 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:00:16,417 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:00:23,632 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:00:24,010 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 07:00:24,330 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:00:26,390 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:00:26,391 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:00:29,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:00:29,514 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:00:30,312 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:00:30,315 - ispa_next.main - DEBUG - 



2025-11-12 07:00:30,315 - ispa_next.main - DEBUG - starting with process 10 (HF-C 213) of 15
2025-11-12 07:00:30,319 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:00:31,400 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:00:32,584 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:00:32,585 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:00:33,887 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:00:33,889 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:01:05,799 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:01:07,191 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:01:11,841 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:01:13,728 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:01:13,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:13,795 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:01:13,955 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:01:13,958 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:01:13,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:14,042 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:01:20,624 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:01:20,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:01:21,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:01:23,652 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:01:23,803 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:01:23,921 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:01:23,990 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:01:23,990 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:01:31,980 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:01:32,983 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:01:32,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:33,500 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:39,654 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-12 07:01:39,656 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:01:39,658 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:01:39,781 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:01:39,782 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:01:39,828 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:01:39,939 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:01:41,037 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:01:41,310 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:01:42,488 - ispa_next.functions - DEBUG - Updated appointment (AF00021378) customer contact data.
2025-11-12 07:01:43,385 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:01:43,386 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:01:43,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:01:44,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:01:45,350 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:01:45,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:01:45,421 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:01:49,021 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:01:49,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:01:49,555 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:01:51,558 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:01:51,667 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:01:51,771 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:01:51,860 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:01:51,861 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:02:00,150 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:03:00,151 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:03:11,184 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:03:15,446 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:03:15,447 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:03:19,606 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:03:20,613 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:03:20,615 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:03:20,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:03:20,770 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:03:21,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:03:21,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:03:21,625 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:03:22,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:03:22,247 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:03:24,098 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:03:24,100 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:03:24,868 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:03:24,875 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:03:24,878 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:03:24,881 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:03:24,882 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:03:24,882 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:03:24,885 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:03:24,888 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:03:24,889 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:03:24,892 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:03:24,893 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:03:24,911 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:03:24,913 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:03:24,914 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:03:24,915 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:26,758 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:03:26,759 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:03:26,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:28,615 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:03:28,616 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:03:28,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:03:29,243 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:03:29,444 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:38,548 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:03:38,549 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:40,455 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:03:40,463 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:03:40,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:03:41,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:03:41,663 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:03:47,112 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:03:50,625 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:03:50,627 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:03:50,628 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:03:51,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:03:51,150 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:03:51,151 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:03:52,520 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:03:58,612 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:03:59,007 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 07:03:59,268 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:00,234 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:04:00,236 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:04:03,621 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:04:03,621 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:04:04,516 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:04:04,519 - ispa_next.main - DEBUG - 



2025-11-12 07:04:04,519 - ispa_next.main - DEBUG - starting with process 11 (HF-H 2227E) of 15
2025-11-12 07:04:04,523 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:04:05,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:04:06,613 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:04:06,614 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:04:07,689 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:04:07,690 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:04:30,190 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:04:31,576 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:04:35,975 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:04:42,019 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:04:42,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:42,126 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:04:42,340 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:04:42,342 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:04:42,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:42,462 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:04:45,602 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:04:45,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:04:46,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:04:48,441 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:04:48,558 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:04:48,638 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:04:48,737 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:04:48,737 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:04:57,332 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:04:58,336 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:04:58,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:04:58,852 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:13,035 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:05:17,184 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:05:17,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:05:17,264 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:05:17,265 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:05:17,361 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:05:18,606 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:05:19,860 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:05:20,076 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:05:21,793 - ispa_next.functions - DEBUG - Updated appointment (AA00044450) customer contact data.
2025-11-12 07:05:22,697 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:05:22,698 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:05:23,314 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:05:23,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:05:23,954 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:05:27,551 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:05:27,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:05:28,068 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:05:30,091 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:05:30,183 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:05:30,275 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:05:30,344 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:05:30,344 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:05:38,524 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:06:38,526 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:06:49,424 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:06:53,948 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:06:53,948 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:06:58,105 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:06:59,113 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:06:59,117 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:06:59,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:06:59,197 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:07:02,708 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 07:07:12,193 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:07:12,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:12,925 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:07:12,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:07:13,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:07:13,585 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:07:19,500 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:07:19,502 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:07:20,297 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:07:20,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:07:20,301 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:07:20,303 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:07:20,305 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:07:20,308 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:07:20,312 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 07:07:20,313 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:07:20,315 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:07:20,316 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:07:20,318 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:07:20,319 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 07:07:22,817 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:23,350 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:24,312 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:24,865 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:25,384 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:26,325 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:26,924 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:27,446 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:28,381 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:28,940 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:29,467 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:30,386 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:30,945 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:31,477 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:32,505 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:33,083 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:33,618 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:34,532 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:35,100 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:35,626 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:36,533 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:37,098 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:37,630 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:38,540 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:39,113 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:39,637 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:07:41,062 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:42,297 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:07:43,232 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:07:43,833 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:07:43,853 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:07:43,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:49,967 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:07:49,968 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:07:49,970 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:07:56,005 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:07:56,007 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:07:56,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:07:56,643 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:07:56,856 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:09,983 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:08:09,985 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:15,999 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:08:16,001 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:08:16,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:08:17,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:08:17,286 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:08:27,362 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:31,924 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:36,002 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:40,258 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:08:43,714 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:08:43,717 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:08:44,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:08:44,462 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:08:44,463 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:08:47,498 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:08:55,834 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:08:56,223 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 07:08:56,642 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:08:57,465 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:08:57,467 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:08:59,973 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:08:59,974 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:09:00,635 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:09:00,639 - ispa_next.main - DEBUG - 



2025-11-12 07:09:00,639 - ispa_next.main - DEBUG - starting with process 12 (HF-AV 404) of 15
2025-11-12 07:09:00,642 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:09:01,497 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:09:02,311 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:09:02,312 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:09:03,556 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:09:03,557 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:09:25,373 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:09:26,860 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:09:31,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:09:35,427 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:09:35,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:35,539 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:09:35,748 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 07:09:39,826 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:09:39,829 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:09:39,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:09:39,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:09:48,983 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:09:48,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:09:50,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:09:52,031 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:09:52,178 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:09:52,295 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:09:52,371 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:09:52,372 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:10:00,563 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:10:01,566 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:10:01,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:10:02,066 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:10:10,555 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:10:13,894 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:10:13,897 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:10:13,982 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:10:13,985 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:10:14,028 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:10:15,255 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:10:16,575 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:10:16,792 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:10:18,094 - ispa_next.functions - DEBUG - Updated appointment (AB00040183) customer contact data.
2025-11-12 07:10:19,012 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:10:19,014 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:10:19,607 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:10:19,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:10:20,326 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:10:23,923 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:10:23,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:10:24,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:10:26,427 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:10:26,546 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:10:26,640 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:10:26,702 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:10:26,702 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:10:34,961 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 07:11:34,963 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:11:46,144 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:11:50,485 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:11:50,485 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:11:54,666 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:11:55,672 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:11:55,690 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:11:55,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:11:55,807 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:11:59,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:11:59,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:11:59,820 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:12:00,539 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:12:00,540 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:12:05,328 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:12:05,332 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:12:06,290 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:12:06,293 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:12:06,296 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:12:06,305 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:12:06,307 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:12:06,310 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:12:06,313 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:12:06,317 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:12:06,318 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:12:06,321 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-12 07:12:06,323 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:12:06,324 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:12:06,326 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 07:12:08,794 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:09,331 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:10,312 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:10,922 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:11,442 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:12,375 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:12,930 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:13,477 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:14,414 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:14,977 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:15,528 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:16,442 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:16,990 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:17,534 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:18,465 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:19,021 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:19,550 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:20,519 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:21,080 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:12:21,601 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:12:23,376 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-12 07:12:24,235 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:12:24,237 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:12:24,238 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:28,344 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:12:28,346 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:12:28,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:32,313 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:12:32,315 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:12:32,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:12:33,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:12:33,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:42,266 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:12:42,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:46,272 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:12:46,277 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:12:46,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:12:47,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:12:47,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:12:55,363 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:13:00,133 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:13:04,030 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:13:08,438 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:13:13,172 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:13:13,174 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:13:13,174 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:13:13,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:13:13,703 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:13:13,704 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:13:14,943 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:13:23,392 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:13:23,783 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 07:13:24,334 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:25,191 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:13:25,192 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:13:28,733 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:13:28,734 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:13:29,655 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:13:29,659 - ispa_next.main - DEBUG - 



2025-11-12 07:13:29,659 - ispa_next.main - DEBUG - starting with process 13 (HF-GE 123) of 15
2025-11-12 07:13:29,686 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:13:30,956 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:13:32,076 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:13:32,077 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:13:33,533 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:13:33,535 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:14:02,363 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:14:03,889 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:14:08,887 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:14:13,541 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:14:13,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:13,603 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:13,761 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:14:13,763 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:14:13,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:13,836 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:16,808 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:14:16,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:14:17,991 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:14:19,995 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:14:20,120 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:14:20,196 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:14:20,319 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:14:20,319 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:14:29,112 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:14:30,117 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:14:30,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:30,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:43,136 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 07:14:43,137 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 07:14:46,688 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:14:46,691 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:14:46,776 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:14:46,777 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:14:46,822 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:14:47,972 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:14:49,174 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:14:49,435 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:14:50,881 - ispa_next.functions - DEBUG - Updated appointment (AF00021355) customer contact data.
2025-11-12 07:14:51,784 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:14:51,786 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:14:52,343 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:14:52,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:14:53,071 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:14:57,092 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:14:57,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:14:57,633 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:14:59,637 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:14:59,775 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:14:59,960 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:15:00,075 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:15:00,076 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:15:10,853 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:15:15,203 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:15:15,204 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:15:19,381 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:15:20,389 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:15:20,391 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:15:20,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:20,511 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:15:27,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:27,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:15:27,559 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:28,246 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:15:28,247 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:15:32,541 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:15:32,542 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:15:33,685 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:15:33,686 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:15:33,688 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:15:33,689 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:15:33,690 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:15:33,691 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:15:33,692 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:15:33,693 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:15:33,694 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:15:33,695 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:15:33,696 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:15:33,698 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:15:33,701 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:15:33,702 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:15:33,703 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:15:38,354 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:15:38,355 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:15:38,357 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:15:43,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:15:43,141 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:15:52,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:06,654 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:16:06,655 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:16:06,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:16:07,598 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:16:07,839 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:21,289 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:16:21,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:25,917 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:16:25,919 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:16:26,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:16:26,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:16:27,096 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:16:35,758 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:16:40,733 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:16:43,941 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:16:43,942 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:16:44,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:16:44,689 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:16:44,690 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:16:47,824 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:16:54,586 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:16:54,969 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 07:16:55,954 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:16:56,440 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:16:56,441 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:16:58,740 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:16:58,740 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:16:59,441 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:16:59,444 - ispa_next.main - DEBUG - 



2025-11-12 07:16:59,444 - ispa_next.main - DEBUG - starting with process 14 (OS-BO 693) of 15
2025-11-12 07:16:59,447 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:17:00,434 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:17:01,462 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:17:01,463 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:17:02,767 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:17:02,769 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:17:40,434 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:17:42,559 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:17:47,736 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:17:56,394 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:17:56,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:17:56,510 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:17:56,648 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:17:56,654 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:17:56,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:17:56,726 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:17:59,739 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:17:59,740 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:01,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:18:03,107 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:18:03,220 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:18:03,324 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:18:03,400 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:18:03,401 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:12,046 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:18:13,056 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:18:13,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:13,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:27,708 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 07:18:32,293 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:18:32,296 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:18:32,381 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:18:32,382 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:18:32,418 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:18:32,569 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 07:18:33,767 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:18:34,137 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:18:35,735 - ispa_next.functions - DEBUG - Updated appointment (AB00040597) customer contact data.
2025-11-12 07:18:36,740 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:18:36,742 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:18:36,869 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:18:37,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:18:38,854 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:18:38,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:18:38,938 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 07:18:42,512 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:18:42,513 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:18:43,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:18:45,027 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:18:45,157 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:18:45,250 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:18:45,375 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:18:45,375 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:18:56,167 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:19:00,913 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:19:00,913 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:19:03,067 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:19:04,074 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:19:04,077 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:19:04,078 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:04,154 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:19:08,344 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:19:20,874 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:19:21,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:22,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:19:22,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:19:22,944 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:19:22,945 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:19:31,146 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:19:31,147 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:19:32,173 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:19:32,175 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:19:32,178 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:19:32,180 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:19:32,181 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:19:32,182 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:19:32,184 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:19:32,185 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:19:32,186 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:19:32,187 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-12 07:19:32,188 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:19:32,190 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:19:32,192 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 07:19:34,947 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:35,498 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:36,023 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:37,526 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:38,064 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:38,586 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:40,107 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:40,627 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:41,160 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:42,727 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:43,247 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:43,780 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:45,315 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:45,837 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:46,379 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:47,934 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:48,463 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:48,999 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:50,543 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:51,099 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:51,620 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:53,129 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:53,690 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:54,223 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:55,726 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:56,246 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:56,804 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:19:58,323 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:19:58,844 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:19:59,381 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:20:00,933 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:20:01,462 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:20:02,011 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:20:03,514 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:20:04,032 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:20:04,571 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:20:06,115 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 07:20:06,691 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 07:20:07,221 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 07:20:10,255 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:20:10,275 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:20:10,292 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:19,137 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:20:19,138 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:20:19,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:27,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:20:28,007 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:20:37,260 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:20:55,996 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:20:55,997 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:20:55,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:20:56,947 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:20:57,171 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:16,789 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:21:16,800 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:25,486 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:21:25,488 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:21:26,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:21:26,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:21:26,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:21:39,894 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:21:44,919 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:21:48,505 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:21:48,506 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:21:49,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:21:49,331 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:21:49,332 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:21:52,617 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 07:22:00,981 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:22:01,372 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 07:22:02,550 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:03,171 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:22:03,172 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:05,663 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:22:05,664 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:06,423 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
2025-11-12 07:22:06,426 - ispa_next.main - DEBUG - 



2025-11-12 07:22:06,426 - ispa_next.main - DEBUG - starting with process 15 (HF-EO 550E) of 15
2025-11-12 07:22:06,429 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:22:07,309 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:22:08,251 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:22:08,252 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 349
2025-11-12 07:22:09,466 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 07:22:09,467 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:22:33,533 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 07:22:35,552 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 07:22:41,273 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:22:44,568 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 07:22:44,569 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:44,662 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:22:44,941 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 07:22:44,944 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 07:22:44,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:22:45,068 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:22:48,319 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:22:48,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:22:49,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:22:51,722 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:22:51,827 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:22:51,914 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:22:52,021 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:22:52,021 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:23:00,375 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 07:23:01,379 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 07:23:01,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:01,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:12,527 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 07:23:17,200 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 07:23:17,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:23:17,264 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 07:23:17,265 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 07:23:17,333 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 07:23:18,561 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 07:23:18,832 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 07:23:20,297 - ispa_next.functions - DEBUG - Updated appointment (AB00040564) customer contact data.
2025-11-12 07:23:21,213 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 07:23:21,215 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 07:23:21,993 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 07:23:21,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 07:23:23,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 07:23:27,425 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 07:23:27,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:27,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:23:29,935 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 07:23:30,063 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 07:23:30,167 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 07:23:30,253 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 07:23:30,253 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 07:23:41,202 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 07:23:45,245 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 07:23:45,245 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 07:23:49,377 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 07:23:50,383 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 07:23:50,386 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 07:23:50,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:23:50,512 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 07:23:59,765 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 07:24:08,591 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 07:24:08,599 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:09,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 07:24:09,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 07:24:09,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 07:24:09,994 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 07:24:12,997 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 07:24:12,999 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 07:24:13,878 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 07:24:13,879 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:24:13,881 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 07:24:13,882 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 07:24:13,899 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 07:24:13,900 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 07:24:13,902 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 07:24:13,903 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 07:24:13,904 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 07:24:13,905 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 07:24:13,906 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 07:24:13,908 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 07:24:13,910 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 07:24:13,911 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 07:24:13,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:17,163 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 07:24:17,166 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 07:24:17,169 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:20,423 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 07:24:20,425 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 07:24:20,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 07:24:21,418 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 07:24:21,738 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:33,705 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 07:24:33,707 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:36,959 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 07:24:36,960 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 07:24:37,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:24:37,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 07:24:38,051 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 07:24:45,557 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:49,660 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:53,824 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:58,867 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 07:24:58,869 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 07:24:58,870 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 07:24:59,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 07:24:59,595 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 07:24:59,596 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 07:25:01,386 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 07:25:09,650 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 07:25:10,028 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 07:25:10,831 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 07:25:11,587 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 608
2025-11-12 07:25:11,589 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 07:25:14,934 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 349
2025-11-12 07:25:14,935 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 07:25:15,848 - ispa_next.appointments.models - DEBUG - Appointment Autohaus Becker-Tiemann GmbH & Co. KG BUENDE WBA51AJ0X0CL28612 ohne Termin.
