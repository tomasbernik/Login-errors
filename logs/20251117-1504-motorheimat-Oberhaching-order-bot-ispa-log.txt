2025-11-17 15:32:36,547 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:32:36,555 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:32:45,333 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:32:55,966 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:33:11,575 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:33:37,563 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:33:54,660 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:33:57,260 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:33:58,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 791
2025-11-17 15:33:58,408 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 20
2025-11-17 15:33:59,983 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 9
2025-11-17 15:33:59,984 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:33:59,985 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:34:00,774 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:34:01,619 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:02,284 - ispa_next.appointments.models - DEBUG - Appointment Firma Getzner Werkstoffe GmbH M-X 1197 WBA31EE0105W45854 ohne Termin.
2025-11-17 15:34:02,288 - ispa_next.main - DEBUG - Found 1 out of 3 appointments to process (configured limit: 15).
2025-11-17 15:34:02,288 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-17 15:34:02,288 - ispa_next.main - DEBUG - All appointments: MS9224
2025-11-17 15:34:02,292 - ispa_next.main - DEBUG - 



2025-11-17 15:34:02,292 - ispa_next.main - DEBUG - starting with process 1 (MS9224) of 1
2025-11-17 15:34:02,299 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:34:03,091 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:34:03,766 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 791
2025-11-17 15:34:03,767 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 9
2025-11-17 15:34:05,072 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:34:05,074 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:19,105 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 155, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 15:34:19,175 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:34:19,178 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:34:19,506 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 791
2025-11-17 15:34:19,508 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:34:21,402 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 20
2025-11-17 15:34:21,403 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:22,181 - ispa_next.appointments.models - DEBUG - Appointment Gottfried Manfred Härdtner M-H 8726E WBY61EF0905Y61710 ohne Termin.
2025-11-17 15:34:22,188 - ispa_next.appointments.models - DEBUG - Appointment Firma Getzner Werkstoffe GmbH M-X 1197 WBA31EE0105W45854 ohne Termin.
2025-11-17 15:34:22,192 - ispa_next.main - DEBUG - Found new Appointment: OHA-AF 904
2025-11-17 15:34:22,193 - ispa_next.main - DEBUG - 



2025-11-17 15:34:22,193 - ispa_next.main - DEBUG - starting with process 2 (OHA-AF 904) of 2
2025-11-17 15:34:22,196 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:34:23,321 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:34:24,397 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 791
2025-11-17 15:34:24,399 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 20
2025-11-17 15:34:25,737 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:34:25,738 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:34:51,349 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:35:00,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:00,360 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:00,541 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:01,775 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:35:01,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:01,839 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:02,038 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 15:35:08,748 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:35:08,750 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:35:08,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:08,836 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:35:18,732 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:35:18,734 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:19,733 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:35:21,740 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:35:21,853 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:35:21,950 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:35:22,039 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:35:22,039 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:35:33,343 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:35:40,679 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:35:40,679 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:35:42,806 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:35:43,810 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:35:43,811 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:44,296 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:57,304 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:36:04,627 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:36:04,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:36:04,753 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:36:04,755 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:36:04,809 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:36:06,083 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:36:06,343 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:36:10,389 - ispa_next.functions - DEBUG - Updated appointment (AJ00018628) customer contact data.
2025-11-17 15:36:11,333 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:36:11,335 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:36:12,151 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:36:12,151 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:36:12,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:36:17,440 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:36:17,440 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:36:17,442 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:36:17,443 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:36:17,443 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:36:17,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:36:22,153 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:36:23,048 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:36:37,755 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:36:37,755 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 15:36:37,756 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:36:44,292 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:36:44,298 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:36:45,640 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:36:45,640 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:36:45,642 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:36:45,644 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:36:45,644 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:36:45,644 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:36:45,646 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:36:45,648 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:36:45,648 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:36:45,650 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:36:45,651 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:36:45,652 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:36:45,655 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:36:45,656 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:36:45,657 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:53,052 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:36:53,052 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:36:53,055 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:00,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:37:00,476 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:37:14,738 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:37:14,738 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:37:14,742 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:22,168 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:37:22,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:37:23,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:37:23,346 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:37,373 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:37:37,379 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:37:44,821 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:37:58,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:06,169 - ispa_next.common.mail - INFO - Successfully sent an email to 5 recipients
2025-11-17 15:38:06,172 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:38:06,661 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:38:07,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:38:07,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:38:57,046 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:38:57,048 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:38:57,871 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:38:57,955 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:38:57,957 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:39:01,202 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:39:14,316 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:39:14,706 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:39:16,126 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:39:16,751 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 791
2025-11-17 15:39:16,752 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:19,998 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 18
2025-11-17 15:39:19,998 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:39:21,029 - ispa_next.appointments.models - DEBUG - Appointment Firma Getzner Werkstoffe GmbH M-X 1197 WBA31EE0105W45854 ohne Termin.
2025-11-17 15:39:21,034 - ispa_next.main - DEBUG - Found new Appointment: M-H 8726E
2025-11-17 15:39:21,034 - ispa_next.main - DEBUG - Found new Appointment: M-NM 8866
2025-11-17 15:39:21,035 - ispa_next.main - DEBUG - 



2025-11-17 15:39:21,035 - ispa_next.main - DEBUG - starting with process 3 (M-H 8726E) of 4
2025-11-17 15:39:21,039 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:39:22,290 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:39:23,788 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 791
2025-11-17 15:39:23,790 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 18
2025-11-17 15:39:25,456 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:39:25,458 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:39:56,181 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:40:07,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:40:09,159 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:40:09,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:09,233 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:40:09,470 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:40:09,472 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:40:09,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:09,588 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:40:12,806 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:40:12,809 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:40:14,001 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:40:16,005 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:40:16,133 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:40:19,403 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:40:19,537 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:40:19,537 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:40:31,278 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:40:32,283 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:40:32,283 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:32,787 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:45,819 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:40:45,819 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:40:54,188 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:40:54,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:40:54,287 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:40:54,288 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:40:54,362 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:40:55,862 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:40:57,182 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:40:57,399 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:41:01,525 - ispa_next.functions - DEBUG - Updated appointment (AJ00018680) customer contact data.
2025-11-17 15:41:02,424 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:41:02,426 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:41:03,586 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:41:03,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:41:04,378 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:41:08,899 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:41:08,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:09,450 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:41:11,453 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:41:11,632 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:41:11,762 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:41:11,890 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:41:11,890 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:41:22,775 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:41:30,930 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:41:30,930 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:41:35,146 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:41:36,152 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:41:36,154 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:41:36,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:36,231 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:41:40,365 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:41:40,368 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:41:40,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:40,469 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:41:46,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:47,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:41:47,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:41:48,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:41:48,182 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:41:50,639 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:41:50,640 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:41:52,060 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:41:52,066 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:41:52,068 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:41:52,070 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:41:52,072 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:41:52,072 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:41:52,074 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 15:41:52,076 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:41:52,077 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:41:52,078 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:41:52,080 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:41:52,082 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:41:54,337 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:41:54,868 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:41:55,854 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:41:56,442 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:41:56,987 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:41:57,949 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:41:58,553 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:41:59,082 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:42:00,471 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:42:01,586 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:42:02,563 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:42:03,088 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:42:03,125 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:42:03,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:05,310 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:42:05,312 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:42:05,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:07,214 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:42:07,216 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:42:07,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:09,164 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:42:09,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:42:10,058 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:42:10,307 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:20,998 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:42:21,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:22,961 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:42:37,576 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:42:38,109 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:42:38,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:42:38,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:42:58,363 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:43:03,666 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:43:03,668 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:43:03,668 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:43:04,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:43:04,731 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:43:04,731 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:43:07,122 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:43:17,584 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:43:17,953 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:43:18,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:43:19,699 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 792
2025-11-17 15:43:19,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:43:22,640 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 19
2025-11-17 15:43:22,641 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:43:23,699 - ispa_next.appointments.models - DEBUG - Appointment Firma Getzner Werkstoffe GmbH M-X 1197 WBA31EE0105W45854 ohne Termin.
2025-11-17 15:43:23,703 - ispa_next.main - DEBUG - Found new Appointment: M-QW 717
2025-11-17 15:43:23,712 - ispa_next.main - DEBUG - 



2025-11-17 15:43:23,713 - ispa_next.main - DEBUG - starting with process 4 (M-QW 717) of 5
2025-11-17 15:43:23,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:43:25,324 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:43:26,901 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 792
2025-11-17 15:43:26,902 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 19
2025-11-17 15:43:28,440 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:43:28,441 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:44:02,194 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:44:14,282 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:14,411 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:14,642 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:44:15,893 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:44:15,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:16,003 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:16,298 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:44:16,300 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:44:16,301 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:16,393 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:44:28,044 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:44:28,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:44:29,424 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:44:31,429 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:44:31,565 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:44:34,847 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:44:35,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:44:35,016 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:44:46,741 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:44:47,746 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:44:47,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:44:48,264 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:45:01,773 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:45:10,777 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:45:10,779 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:45:10,882 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:45:10,884 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:45:10,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:45:11,125 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:45:12,429 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:45:12,657 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:45:15,700 - ispa_next.functions - DEBUG - Updated appointment (AJ00018681) customer contact data.
2025-11-17 15:45:16,600 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:45:16,600 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:45:16,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:45:17,759 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:45:19,420 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:45:19,422 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:45:19,568 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:45:23,213 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:45:23,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:45:23,752 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:45:25,756 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:45:25,875 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:45:26,045 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:45:26,172 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:45:26,172 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:45:37,960 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:46:37,962 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:46:49,773 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:47:02,777 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:47:14,436 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:47:23,544 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:47:24,551 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:47:24,551 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:47:24,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:47:24,747 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:47:29,087 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:47:29,090 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:47:29,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:47:29,174 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:47:29,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:47:30,118 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:47:30,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:47:30,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:47:30,836 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:47:32,152 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:47:32,158 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:47:33,760 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:47:33,763 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:47:33,765 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:47:33,765 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:47:33,767 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:47:33,769 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:47:33,769 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:47:33,771 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:47:33,773 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:47:33,775 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:47:33,782 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:47:33,786 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:47:33,788 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:47:33,790 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:47:33,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:34,995 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:47:34,996 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:47:34,998 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:36,196 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:47:36,196 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:47:36,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:37,384 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:47:37,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:47:38,288 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:47:38,382 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:47:38,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:47:39,614 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:47:53,079 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:47:53,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:47:54,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:47:54,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:48:07,649 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:48:07,651 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:48:07,653 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:48:08,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:48:08,590 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:48:08,591 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:48:11,061 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:48:21,105 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:48:21,481 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:48:22,018 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:48:23,308 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 792
2025-11-17 15:48:23,309 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:48:26,753 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 19
2025-11-17 15:48:26,753 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:48:27,935 - ispa_next.appointments.models - DEBUG - Appointment Firma Getzner Werkstoffe GmbH M-X 1197 WBA31EE0105W45854 ohne Termin.
2025-11-17 15:48:27,940 - ispa_next.main - DEBUG - 



2025-11-17 15:48:27,941 - ispa_next.main - DEBUG - starting with process 5 (M-NM 8866) of 5
2025-11-17 15:48:27,944 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:48:29,503 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:48:31,244 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 792
2025-11-17 15:48:31,245 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 19
2025-11-17 15:48:33,002 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:48:33,004 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:49:19,067 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:49:31,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:49:32,585 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:49:32,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:49:32,678 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:49:33,034 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:49:33,038 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:49:33,038 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:49:33,138 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:49:45,319 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:49:45,321 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:49:46,792 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:49:48,797 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:49:48,923 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:49:49,060 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:49:49,176 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:49:53,362 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:49:54,367 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:49:54,368 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:49:54,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:50:08,576 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:50:08,577 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:50:17,747 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:50:17,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:50:17,852 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:50:17,852 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:50:17,919 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:50:19,263 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:50:19,478 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:50:23,721 - ispa_next.functions - DEBUG - Updated appointment (AJ00018674) customer contact data.
2025-11-17 15:50:24,640 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:50:24,642 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:50:25,804 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:50:25,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:50:30,650 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:50:36,148 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:50:36,148 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:50:36,152 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:50:36,152 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:50:36,154 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:50:36,726 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:50:41,143 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:50:41,147 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:50:41,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:50:41,326 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:50:41,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:50:42,671 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:50:42,671 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:50:44,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:50:44,854 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:50:46,443 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:50:46,447 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:50:51,850 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:50:51,852 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:50:51,855 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:50:51,858 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:50:51,859 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 15:50:51,861 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:50:51,866 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:50:51,888 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:50:51,892 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:50:51,894 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:50:51,898 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:50:51,928 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:50:51,951 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:50:51,953 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:50:51,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:53,414 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:50:53,416 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:50:53,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:54,666 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:50:54,666 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:50:54,668 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:50:55,901 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:50:55,901 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 15:50:56,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 15:50:57,145 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:51:05,656 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:51:05,659 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:51:06,884 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:51:21,598 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:51:22,138 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:51:22,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:51:22,948 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:51:36,112 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:51:36,114 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:51:36,114 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:51:37,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:51:37,110 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:51:37,110 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:51:39,313 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:51:48,972 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:51:49,354 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:51:50,493 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:51:51,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 792
2025-11-17 15:51:51,363 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:51:54,574 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 19
2025-11-17 15:51:54,575 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:51:55,442 - ispa_next.appointments.models - DEBUG - Appointment Firma Getzner Werkstoffe GmbH M-X 1197 WBA31EE0105W45854 ohne Termin.
