2025-11-17 13:51:04,673 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:51:04,679 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:51:14,399 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:51:26,673 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:51:42,139 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:52:13,962 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:52:27,686 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:52:31,834 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:52:32,893 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2118
2025-11-17 13:52:32,894 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 598
2025-11-17 13:52:35,526 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 434
2025-11-17 13:52:35,527 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:52:35,528 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:52:37,116 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:52:38,347 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:53:46,210 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,210 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,211 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,211 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,247 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,294 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,316 - ispa_next.appointments.models - DEBUG - Appointment Martins Alves Miguel BL 161006 WMW51DK0102S61307 ohne Termin.
2025-11-17 13:53:46,319 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:53:46,342 - ispa_next.appointments.models - DEBUG - Appointment Nasim Gul BS 21650 WBAWX710000G77966 ohne Termin.
2025-11-17 13:53:46,365 - ispa_next.appointments.models - DEBUG - Appointment Werner Osterwalder BL 34340 WBA3T71020PW23796 ohne Termin.
2025-11-17 13:53:46,385 - ispa_next.appointments.models - DEBUG - Appointment Norbert Pogorzelski M-HV 2094E WBA41GV0X0CV22369 ohne Termin.
2025-11-17 13:53:46,400 - ispa_next.appointments.models - DEBUG - Appointment   WBAFF01060L211755 ohne Termin.
2025-11-17 13:53:46,421 - ispa_next.appointments.models - DEBUG - Appointment Walter Schwarz LÖ-WH 97 WBAVP51000VM67447 ohne Termin.
2025-11-17 13:53:46,438 - ispa_next.appointments.models - DEBUG - Appointment Dagmar Klipp BL 181288 WMWXR510102M31464 ohne Termin.
2025-11-17 13:53:46,451 - ispa_next.appointments.models - DEBUG - Appointment Perihan Hasserbetrci BS 31642 WBA11FL08RCR21472 ohne Termin.
2025-11-17 13:53:46,466 - ispa_next.appointments.models - DEBUG - Appointment Kevin Spettl LÖ-K 956 WBS3C91060P708776 ohne Termin.
2025-11-17 13:53:46,479 - ispa_next.main - DEBUG - Found 8 out of 69 appointments to process (configured limit: 15).
2025-11-17 13:53:46,479 - ispa_next.main - DEBUG - Processing 8 fresh appointments.
2025-11-17 13:53:46,479 - ispa_next.main - DEBUG - All appointments: SO 129739, LÖ-EC 208, LÖ-ZE 212E, LÖ-L 1992E, LÖ-BK 898, LÖ-KU 85, LÖ-AY 9999, LÖ-RJ 2504
2025-11-17 13:53:46,482 - ispa_next.main - DEBUG - 



2025-11-17 13:53:46,482 - ispa_next.main - DEBUG - starting with process 1 (SO 129739) of 8
2025-11-17 13:53:46,487 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:53:47,500 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:53:48,649 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2118
2025-11-17 13:53:48,650 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 434
2025-11-17 13:53:49,990 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:53:49,992 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:54:29,911 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:54:39,578 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:54:39,687 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:54:39,869 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:41,089 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:54:41,090 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:54:41,187 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:54:41,408 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:54:48,042 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:54:48,045 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:54:50,816 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:54:50,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:54:51,808 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:54:53,810 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:54:53,949 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:54:57,180 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:54:57,286 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:54:57,288 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:54:58,513 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:55:10,051 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:55:11,059 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:55:11,060 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:11,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:25,079 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 13:55:32,358 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:55:32,360 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:55:32,445 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:55:32,446 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:55:32,502 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:55:33,748 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:55:34,007 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:55:37,270 - ispa_next.functions - DEBUG - Updated appointment (AC00065319) customer contact data.
2025-11-17 13:55:38,185 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:55:38,187 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:55:38,920 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:55:38,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:55:39,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:55:44,153 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:55:44,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:55:44,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:55:46,706 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:55:46,799 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:55:46,911 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:55:46,971 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:55:46,972 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:55:48,911 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:56:00,148 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:57:00,150 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:57:11,483 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:57:18,644 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:57:18,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:57:20,583 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:57:24,752 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:57:25,773 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:57:25,776 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:57:25,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:57:25,882 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:57:31,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:57:32,486 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:57:32,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:57:33,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:57:33,096 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:57:34,899 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:57:34,901 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:57:35,771 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:57:35,772 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:57:35,773 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 13:57:35,774 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:57:35,775 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:57:35,776 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:57:35,777 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:57:35,779 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:57:35,780 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:57:35,781 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:57:35,782 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:57:36,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:57:37,116 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:57:46,032 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:57:46,034 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:57:46,035 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:57:46,035 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:57:48,680 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:57:48,682 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:57:48,684 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:57:48,686 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:57:48,688 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:57:48,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:57:51,220 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:57:51,222 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:57:51,223 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:57:51,224 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:57:51,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:57:52,572 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:57:52,574 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:57:53,867 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:58:03,672 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:58:04,056 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:58:04,366 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:58:06,730 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2120
2025-11-17 13:58:06,731 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:58:09,085 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 13:58:09,086 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:58:09,722 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 13:58:09,733 - ispa_next.main - DEBUG - 



2025-11-17 13:58:09,733 - ispa_next.main - DEBUG - starting with process 2 (LÖ-EC 208) of 8
2025-11-17 13:58:09,736 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:58:10,554 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:58:11,859 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2120
2025-11-17 13:58:11,861 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 599
2025-11-17 13:58:13,415 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:58:13,416 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:58:39,346 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:58:49,239 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:58:51,161 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:58:51,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:58:51,260 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:58:51,438 - ispa_next.functions - DEBUG - HU date already expired after 988 days.
2025-11-17 13:58:58,318 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:58:58,320 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:59:01,067 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:59:01,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:01,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:59:03,949 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:59:04,092 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:59:07,289 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:59:07,352 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:59:11,530 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:59:12,535 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:59:12,536 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:13,008 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:22,800 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:59:29,838 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:59:29,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:29,911 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:59:29,911 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:59:29,964 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:59:31,152 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:59:31,352 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:59:33,701 - ispa_next.functions - DEBUG - Updated appointment (AC00065317) customer contact data.
2025-11-17 13:59:34,589 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:59:34,592 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:59:35,382 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:59:35,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:59:36,095 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:59:40,556 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:59:40,556 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:59:40,560 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:59:40,563 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:59:40,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:41,072 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:59:41,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:41,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:59:41,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:59:42,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:59:42,583 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:59:45,023 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:59:45,025 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:59:45,903 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:59:45,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:59:45,905 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 13:59:45,906 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:59:45,907 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:59:45,909 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:59:45,909 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:59:45,911 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:59:45,915 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:59:45,917 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:59:45,921 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:59:46,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:59:47,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:59:56,633 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:59:56,635 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:59:56,637 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:59:56,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:59:59,881 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:59:59,883 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:59:59,884 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:59:59,886 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:59:59,888 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:59:59,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:00:03,121 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:00:03,122 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:00:03,124 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:00:03,124 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:03,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:00:04,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:00:04,214 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:00:09,355 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:00:18,749 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:00:19,149 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:00:19,628 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:21,798 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2120
2025-11-17 14:00:21,800 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:24,337 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 14:00:24,338 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:00:25,104 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:00:25,113 - ispa_next.main - DEBUG - 



2025-11-17 14:00:25,113 - ispa_next.main - DEBUG - starting with process 3 (LÖ-ZE 212E) of 8
2025-11-17 14:00:25,117 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:00:26,052 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:00:27,125 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2120
2025-11-17 14:00:27,126 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 599
2025-11-17 14:00:28,489 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:00:28,491 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:00:55,430 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:01:04,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:01:07,462 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:01:07,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:07,529 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:07,755 - ispa_next.functions - DEBUG - HU date already expired after 449 days.
2025-11-17 14:01:14,058 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:01:14,061 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:01:16,781 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:16,782 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:01:17,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:01:19,546 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:01:19,658 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:01:22,889 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:01:22,959 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:01:27,156 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:01:28,161 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:01:28,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:28,663 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:41,074 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:01:41,074 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:01:48,546 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:01:48,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:01:48,666 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:01:48,666 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:01:48,721 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:01:49,995 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:01:50,233 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:01:52,647 - ispa_next.functions - DEBUG - Updated appointment (AC00065313) customer contact data.
2025-11-17 14:01:53,557 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:01:53,559 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:01:54,350 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:01:54,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:01:55,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:01:58,881 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:01:58,881 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:01:58,885 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:01:58,890 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:01:58,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:01:59,420 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:05,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:05,589 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:02:05,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:02:06,407 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:02:06,408 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:02:08,948 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:02:08,950 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:02:09,773 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:02:09,774 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:09,776 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 14:02:09,776 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:02:09,778 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 14:02:09,778 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:02:09,780 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:02:09,781 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:02:09,782 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:02:09,783 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:02:10,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:02:11,180 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:02:20,334 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:02:20,335 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 14:02:22,328 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:02:22,884 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:02:24,257 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:02:24,812 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:02:25,340 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:02:26,266 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:02:26,884 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:02:27,409 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:02:28,316 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:02:28,893 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:02:29,417 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:02:30,341 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:02:31,402 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:02:32,363 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:02:32,796 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:02:32,800 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:02:32,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:02:35,373 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:02:35,374 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:02:35,376 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:02:35,377 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:02:35,380 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:02:35,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:02:37,935 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:02:37,936 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:02:37,938 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:02:37,938 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:02:38,436 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:02:39,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:02:39,003 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:02:40,585 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:02:47,077 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:02:47,460 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:02:47,997 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:02:50,577 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2121
2025-11-17 14:02:50,578 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:02:53,048 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 14:02:53,048 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:02:53,744 - ispa_next.appointments.models - DEBUG - Appointment Pia Boccalini LU 261473 WBAVP71060V202933 ohne Termin.
2025-11-17 14:02:53,752 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:02:53,761 - ispa_next.main - DEBUG - 



2025-11-17 14:02:53,761 - ispa_next.main - DEBUG - starting with process 4 (LÖ-L 1992E) of 8
2025-11-17 14:02:53,765 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:02:54,728 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:02:55,654 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2121
2025-11-17 14:02:55,655 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 599
2025-11-17 14:02:57,171 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:02:57,173 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:03:25,611 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:03:34,757 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:38,677 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:03:38,678 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:38,749 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:38,896 - ispa_next.functions - DEBUG - HU date soon to be invalid in 14 days.
2025-11-17 14:03:46,481 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:03:46,484 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:03:49,328 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:03:49,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:50,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:03:52,370 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:03:52,489 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:03:52,567 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:03:52,653 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:03:56,810 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:03:57,816 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:03:57,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:58,306 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:09,442 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:04:16,561 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:04:16,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:16,657 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:04:16,657 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:04:16,701 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:04:17,963 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:04:18,185 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:04:20,550 - ispa_next.functions - DEBUG - Updated appointment (AC00065312) customer contact data.
2025-11-17 14:04:21,462 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:04:21,464 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:04:22,263 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:04:22,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:04:22,981 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:04:26,597 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:04:26,598 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:04:26,601 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:04:26,604 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:04:26,604 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:27,101 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:35,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:36,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:36,329 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:37,011 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:37,012 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:04:40,721 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:04:40,726 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:04:41,812 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:04:41,813 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:04:41,816 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:04:41,821 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:04:41,828 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:04:41,834 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:04:41,835 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:04:41,837 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:04:41,838 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:04:41,839 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:04:41,842 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:04:41,844 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:04:41,845 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:45,821 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:04:48,595 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:04:48,622 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:04:48,669 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:04:48,677 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:04:48,681 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:04:48,685 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:04:52,894 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:04:52,896 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:04:52,899 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:04:52,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:04:53,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:04:54,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:04:54,638 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:04:56,786 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:05:05,426 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:05:05,834 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:05:06,288 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:08,810 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2121
2025-11-17 14:05:08,811 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:11,449 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 14:05:11,449 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:05:12,253 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:05:12,259 - ispa_next.main - DEBUG - Found new Appointment: LU 261473
2025-11-17 14:05:12,262 - ispa_next.main - DEBUG - 



2025-11-17 14:05:12,262 - ispa_next.main - DEBUG - starting with process 5 (LU 261473) of 9
2025-11-17 14:05:12,266 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:05:13,216 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:14,204 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2121
2025-11-17 14:05:14,205 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 599
2025-11-17 14:05:15,498 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:15,500 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:05:44,218 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:05:54,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:54,301 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:05:54,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:01,140 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:06:01,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:01,215 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:01,421 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 14:06:07,949 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:06:07,953 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:06:10,749 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:06:10,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:06:11,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:06:13,827 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:06:13,945 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:06:17,176 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:06:17,253 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:06:17,255 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:24,164 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:06:35,464 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:06:36,470 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:06:36,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:36,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:51,672 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:06:59,304 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:06:59,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:59,385 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:59,385 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:06:59,419 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:06:59,567 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:07:01,165 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:07:01,388 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:07:03,694 - ispa_next.functions - DEBUG - Updated appointment (AC00065325) customer contact data.
2025-11-17 14:07:04,630 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:07:04,633 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:07:04,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:07:05,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:07:07,479 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:07:07,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:07:07,802 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:07:12,484 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:07:12,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:07:13,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:07:15,174 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:07:15,326 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:07:15,437 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:07:15,556 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:07:15,557 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:07:23,839 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:07:35,411 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:08:35,422 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:08:46,946 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:08:54,627 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:08:55,633 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:08:55,636 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:08:55,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:55,717 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:08:56,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:56,583 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:08:56,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:08:57,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:08:57,269 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:09:04,289 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:09:04,293 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:09:05,492 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:09:05,493 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:09:05,494 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:09:05,495 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:09:05,496 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:09:05,497 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:09:05,498 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:09:05,506 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:09:05,509 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:09:05,512 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:09:05,518 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:09:05,520 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:09:05,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:13,556 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:09:13,558 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:09:13,560 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:09:13,563 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:09:13,565 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:09:13,569 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:09:21,613 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:09:21,615 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:09:21,617 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:09:21,617 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:09:22,478 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:09:23,263 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:09:23,264 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:09:25,413 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:09:43,509 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 14:09:43,511 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:09:43,512 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:09:44,070 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:09:44,144 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:09:44,145 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:09:47,980 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 14:09:48,006 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 14:09:50,665 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:09:50,668 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:09:52,899 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2121
2025-11-17 14:09:52,901 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:09:55,946 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 599
2025-11-17 14:09:55,947 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:09:56,916 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:09:56,923 - ispa_next.main - DEBUG - 



2025-11-17 14:09:56,923 - ispa_next.main - DEBUG - starting with process 6 (LÖ-BK 898) of 9
2025-11-17 14:09:56,928 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:09:58,118 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:09:59,393 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2121
2025-11-17 14:09:59,394 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 599
2025-11-17 14:10:00,717 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:10:00,719 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:10:29,790 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:10:38,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:38,904 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:39,076 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:40,290 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:10:40,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:10:40,357 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:10:40,551 - ispa_next.functions - DEBUG - HU date already expired after 170 days.
2025-11-17 14:10:46,973 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:10:46,976 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:10:49,698 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:10:49,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:10:50,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:10:52,760 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:10:52,936 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:10:56,146 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:10:56,223 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:10:56,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:57,491 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:11:08,834 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:11:09,852 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:11:09,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:10,348 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:22,307 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:11:30,100 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:11:30,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:30,165 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:11:30,165 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:11:30,248 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:11:30,373 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:11:31,596 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:11:31,855 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:11:34,019 - ispa_next.functions - DEBUG - Updated appointment (AC00065310) customer contact data.
2025-11-17 14:11:34,910 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:11:34,912 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:11:35,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:11:35,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:11:37,327 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:11:37,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:11:37,610 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:11:41,250 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:11:41,252 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:41,746 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:43,758 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:11:43,882 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:11:43,990 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:11:44,072 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:11:44,074 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:46,046 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:11:57,563 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:12:57,566 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:13:08,357 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:13:15,642 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:13:15,644 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:17,616 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:13:21,772 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:13:22,780 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:13:22,783 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:13:22,783 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:22,894 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:13:23,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:24,061 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:13:24,061 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:13:24,691 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:13:24,692 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:13:26,533 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:13:26,539 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:13:27,530 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:13:27,532 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:13:27,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 14:13:27,536 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:13:27,538 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:13:27,541 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:13:27,542 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:13:27,543 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:13:27,544 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:13:27,546 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:13:27,547 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:13:28,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:13:28,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:13:35,177 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:13:35,179 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:13:35,181 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:13:35,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:37,070 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:13:37,071 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:13:37,073 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:13:37,074 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:13:37,076 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:13:37,077 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:38,990 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:13:38,991 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:13:38,992 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:13:38,993 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:39,729 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:13:40,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:13:40,389 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:13:42,463 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:13:50,106 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:13:50,487 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:13:50,798 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:53,104 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2122
2025-11-17 14:13:53,105 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:55,644 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 600
2025-11-17 14:13:55,645 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:56,368 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:13:56,376 - ispa_next.main - DEBUG - 



2025-11-17 14:13:56,377 - ispa_next.main - DEBUG - starting with process 7 (LÖ-KU 85) of 9
2025-11-17 14:13:56,380 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:57,331 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:58,381 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2122
2025-11-17 14:13:58,382 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 600
2025-11-17 14:13:59,689 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:59,689 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:14:27,239 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:14:36,603 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:36,711 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:14:36,898 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:40,113 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:14:40,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:40,182 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:14:40,368 - ispa_next.functions - DEBUG - HU date already expired after 1664 days.
2025-11-17 14:14:47,834 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:14:47,838 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:14:50,712 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:14:50,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:14:51,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:14:53,760 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:14:59,263 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 14:15:07,157 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 14:15:08,163 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:15:08,164 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:08,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:22,073 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:15:30,172 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:15:30,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:30,303 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:15:30,304 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:15:30,334 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:15:30,456 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:15:31,620 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 14:15:32,736 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 14:15:33,021 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:15:35,770 - ispa_next.functions - DEBUG - Updated appointment (AC00065306) customer contact data.
2025-11-17 14:15:36,675 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:15:36,678 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:15:36,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:15:37,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:15:38,876 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:15:38,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:15:38,936 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:15:42,999 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-17 14:15:42,999 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:15:42,999 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:15:43,002 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:15:43,010 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:15:43,011 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:43,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:43,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:44,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:44,520 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:45,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:45,201 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:15:49,021 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:15:49,023 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:15:50,084 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:15:50,085 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:15:50,087 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 14:15:50,088 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:15:50,090 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:15:50,099 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:15:50,101 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:15:50,103 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:15:50,105 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:15:50,107 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:15:50,109 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:15:50,798 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:15:51,536 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:16:01,443 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:16:01,445 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:16:01,446 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:16:01,447 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:06,101 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:16:06,103 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:16:06,105 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:16:06,107 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:16:06,109 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:16:06,111 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:10,739 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:16:10,740 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:16:10,742 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:16:10,742 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:16:11,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:16:11,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:16:11,974 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:16:13,531 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:16:20,669 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:16:21,047 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:16:21,632 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:16:23,996 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2122
2025-11-17 14:16:23,997 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:16:27,569 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 600
2025-11-17 14:16:27,570 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:16:28,356 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:16:28,365 - ispa_next.main - DEBUG - 



2025-11-17 14:16:28,365 - ispa_next.main - DEBUG - starting with process 8 (LÖ-AY 9999) of 9
2025-11-17 14:16:28,369 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:16:29,385 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:16:30,769 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2122
2025-11-17 14:16:30,771 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 600
2025-11-17 14:16:32,231 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:16:32,232 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:17:01,957 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:17:11,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:14,573 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:17:14,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:14,694 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:14,943 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 14:17:22,080 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:17:22,083 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:17:24,914 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:17:24,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:17:26,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:17:28,646 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:17:28,747 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:17:32,002 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:17:32,108 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:17:32,109 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:34,800 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:17:46,264 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:17:47,269 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:17:47,271 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:47,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:02,902 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:18:11,340 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:18:11,343 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:11,484 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:18:11,485 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:18:11,523 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:18:11,665 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:18:13,055 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:18:13,280 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:18:15,598 - ispa_next.functions - DEBUG - Updated appointment (AE00033574) customer contact data.
2025-11-17 14:18:16,485 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:18:16,487 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:18:17,084 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:18:17,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:18:19,613 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:18:19,614 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:18:19,917 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:18:23,909 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 14:18:23,909 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:18:23,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:24,391 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:26,394 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:18:26,529 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:18:26,640 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:18:26,749 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:18:26,751 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:30,109 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:18:40,996 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:18:48,122 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:18:48,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:18:51,501 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:18:55,678 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:18:56,686 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:18:56,691 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:18:56,692 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:56,793 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:18:57,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:57,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:57,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:58,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:58,509 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:19:01,565 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:19:01,567 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:19:02,736 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:19:02,737 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:19:02,739 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Vorbereitungszeit für Werkstatt, source=from_tab, target=cart)}
2025-11-17 14:19:02,740 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:19:02,741 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:19:02,742 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:19:02,743 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:19:02,744 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:19:02,752 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:19:02,755 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:19:02,757 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:19:03,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 14:19:04,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 14:19:14,246 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:19:14,249 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:19:14,250 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:19:14,251 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:18,206 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:19:18,208 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:19:18,210 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:19:18,212 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:19:18,214 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:19:18,217 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:22,216 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:19:22,218 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:19:22,220 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:19:22,221 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:19:22,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:19:23,724 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:19:23,725 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:19:25,729 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:19:34,443 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:19:34,826 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 14:19:35,377 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:37,830 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2122
2025-11-17 14:19:37,832 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:19:40,770 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 601
2025-11-17 14:19:40,771 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:19:41,508 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
2025-11-17 14:19:41,514 - ispa_next.main - DEBUG - 



2025-11-17 14:19:41,514 - ispa_next.main - DEBUG - starting with process 9 (LÖ-RJ 2504) of 9
2025-11-17 14:19:41,518 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:19:42,536 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:19:43,540 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2122
2025-11-17 14:19:43,541 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 601
2025-11-17 14:19:44,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:19:44,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:17,305 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:20:26,933 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:32,367 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:20:32,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:20:32,501 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:20:32,674 - ispa_next.functions - DEBUG - HU date already expired after 17 days.
2025-11-17 14:20:39,157 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:20:39,159 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:20:41,922 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:20:41,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:20:42,980 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:20:44,984 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:20:45,113 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:20:48,393 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:20:48,524 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:20:48,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:54,029 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:21:05,341 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:21:06,345 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:21:06,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:06,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:20,239 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:21:28,560 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:21:28,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:28,714 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:28,715 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:21:28,756 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:21:28,869 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:21:30,317 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:21:30,534 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:21:33,082 - ispa_next.functions - DEBUG - Updated appointment (AC00064352) customer contact data.
2025-11-17 14:21:34,031 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:21:34,050 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:21:34,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:21:35,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:21:37,133 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:21:37,134 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:21:37,224 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:21:40,839 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:40,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:41,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:43,323 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:43,448 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:43,605 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:43,711 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:21:43,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:50,048 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:22:01,679 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:23:01,681 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:23:13,464 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:23:20,780 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:23:20,782 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:28,490 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 14:23:30,412 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:23:35,018 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:23:36,036 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:23:36,039 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:23:36,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:36,106 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:23:41,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:42,323 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:42,324 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:42,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:23:42,975 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:23:48,323 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:23:48,325 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:23:49,747 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:23:49,751 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:23:49,753 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:23:49,755 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:23:49,756 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:23:49,757 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:23:49,758 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:23:49,760 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:23:49,761 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:23:49,762 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:23:49,765 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:23:49,767 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:23:49,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:55,906 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:23:58,697 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:23:58,699 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:23:58,701 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:23:58,704 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:23:58,707 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:23:58,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:04,988 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:24:04,989 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:24:04,991 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:24:04,994 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:24:05,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:24:06,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:24:06,671 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:24:08,540 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 14:24:16,769 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:24:17,138 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 14:24:17,665 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:24:20,305 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 2123
2025-11-17 14:24:20,306 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:24:23,719 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 602
2025-11-17 14:24:23,720 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:24:24,585 - ispa_next.appointments.models - DEBUG - Appointment Armin Köpfer LÖ-CZ 1 WBA41FF080FP29124 ohne Termin.
2025-11-17 14:24:24,609 - ispa_next.appointments.models - DEBUG - Appointment Danijela Hirt LÖ-H 1405E WMW11DJ0102U33660 ohne Termin.
