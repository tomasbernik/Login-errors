2025-11-12 11:14:33,608 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 11:14:33,644 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 11:14:43,958 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 11:14:54,244 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 11:15:09,941 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 11:15:34,402 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 11:15:51,894 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 11:15:54,454 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:15:55,661 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-12 11:15:55,662 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 11:15:57,959 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 93
2025-11-12 11:15:57,960 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 11:15:57,961 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:15:59,063 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 11:15:59,794 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:13,765 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:16:13,824 - ispa_next.main - DEBUG - Found 4 out of 41 appointments to process (configured limit: 15).
2025-11-12 11:16:13,824 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 11:16:13,824 - ispa_next.main - DEBUG - Processing 1 already visited appointments (w/ RKR not callable).
2025-11-12 11:16:13,824 - ispa_next.main - DEBUG - All appointments: LM-K 55, ENS-MP-48, LM MM 585, LM-R 890
2025-11-12 11:16:13,828 - ispa_next.main - DEBUG - 



2025-11-12 11:16:13,828 - ispa_next.main - DEBUG - starting with process 1 (LM-K 55) of 4
2025-11-12 11:16:13,832 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:16:14,906 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:16:16,085 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-12 11:16:16,087 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 93
2025-11-12 11:16:17,342 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:16:17,343 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:16:42,334 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:16:51,389 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:16:53,962 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:16:53,962 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:16:54,042 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:16:54,206 - ispa_next.functions - DEBUG - HU date soon to be invalid in 89 days.
2025-11-12 11:17:00,613 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:17:00,615 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:17:00,616 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:00,705 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:03,843 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:03,844 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:04,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:06,707 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:17:06,802 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:17:06,931 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:17:06,998 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:17:11,196 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:17:12,201 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:17:12,201 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:12,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:24,785 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:17:30,837 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:17:30,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:30,959 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:17:30,959 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:17:30,995 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:17:32,217 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:17:32,452 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:17:33,996 - ispa_next.functions - DEBUG - Updated appointment (AB00018674) customer contact data.
2025-11-12 11:17:34,953 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:17:34,954 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:17:35,493 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:17:35,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:17:36,076 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:17:40,088 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:17:40,088 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:17:40,091 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:17:40,092 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:17:40,098 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:40,611 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:44,759 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:17:44,762 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:17:44,763 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:44,828 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:17:50,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:50,985 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:17:50,985 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:17:51,706 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:17:51,707 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:17:54,116 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:17:54,118 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:17:55,496 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:17:55,497 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:55,500 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=FAHRZEUGWÄSCHE BASIS, source=from_tab, target=cart)}
2025-11-12 11:17:55,501 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:17:55,504 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:17:55,519 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:17:55,524 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:17:55,527 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:17:55,528 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:17:55,530 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:17:55,532 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 11:17:56,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 11:17:56,839 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 11:18:08,655 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 11:18:08,657 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:18:08,660 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:18:08,661 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:11,274 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:18:11,276 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:18:11,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:13,803 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:18:13,805 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:18:13,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:18:14,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:18:14,419 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:20,565 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:18:20,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:23,135 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:18:33,704 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:18:34,216 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:34,729 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:18:34,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:18:41,393 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:46,786 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:50,664 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:18:50,665 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:18:50,666 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:18:51,177 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:18:51,275 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:18:51,276 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:18:52,939 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:19:01,896 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:19:02,278 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 11:19:03,172 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:03,771 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-12 11:19:03,772 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:06,635 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 11:19:06,636 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:07,557 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:19:07,560 - ispa_next.main - DEBUG - Found new Appointment: D-CG 5193 E
2025-11-12 11:19:07,562 - ispa_next.main - DEBUG - 



2025-11-12 11:19:07,562 - ispa_next.main - DEBUG - starting with process 2 (D-CG 5193 E) of 5
2025-11-12 11:19:07,566 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:19:08,788 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:19:10,205 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-12 11:19:10,207 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 126
2025-11-12 11:19:11,582 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:19:11,585 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:19:37,497 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:19:47,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:47,594 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:47,788 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:19:49,636 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:19:49,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:49,725 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:19:50,002 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 11:19:56,829 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:19:56,832 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:19:56,833 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:19:56,943 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:00,215 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:00,217 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:01,138 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:03,141 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:20:03,267 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:20:06,533 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:20:06,611 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:20:06,611 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:20:14,849 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 11:20:15,856 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:20:15,857 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:16,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:29,566 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 11:20:37,170 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:20:37,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:20:37,282 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:20:37,284 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:20:37,316 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:20:38,592 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:20:38,813 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:20:42,832 - ispa_next.functions - DEBUG - Updated appointment (AB00018687) customer contact data.
2025-11-12 11:20:43,749 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:20:43,750 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:20:44,583 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:20:44,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:20:45,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:20:49,786 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:20:49,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:20:50,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:20:52,301 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:20:52,413 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:20:52,530 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:20:52,598 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 11:20:52,599 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:21:00,693 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:22:00,696 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:22:08,892 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 11:22:37,895 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 11:22:46,188 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 11:22:52,610 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 11:22:53,615 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:22:53,616 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:22:53,617 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:22:53,726 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:22:57,858 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:22:57,862 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:22:57,862 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-12 11:22:57,863 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:22:59,745 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:22:59,747 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:23:01,054 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:23:01,055 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:23:01,057 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-12 11:23:01,058 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-12 11:23:01,060 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:23:01,061 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:23:01,064 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:23:01,065 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:23:01,068 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:23:01,069 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:23:01,073 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:23:01,077 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:23:01,082 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:23:01,083 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:23:01,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:03,039 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:23:03,040 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:23:03,050 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:05,039 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:23:05,040 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:23:05,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:23:05,705 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:23:05,739 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:23:05,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:07,592 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:23:17,804 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:23:18,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:18,780 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:23:18,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:23:24,245 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:23:24,246 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:23:24,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:24,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:24,827 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:23:24,828 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:23:26,792 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:23:41,366 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-12 11:23:41,368 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:23:41,369 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:41,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:23:42,009 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:23:42,010 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:23:43,499 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-12 11:23:43,521 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 11:23:45,512 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 11:23:45,515 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:45,881 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 11:23:45,882 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:48,106 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 127
2025-11-12 11:23:48,107 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:23:48,754 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:23:48,758 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:23:48,762 - ispa_next.main - DEBUG - 



2025-11-12 11:23:48,762 - ispa_next.main - DEBUG - starting with process 3 (ENS-MP-48) of 5
2025-11-12 11:23:48,765 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:23:49,613 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:23:50,493 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 11:23:50,494 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 127
2025-11-12 11:23:51,621 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:23:51,623 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:22,253 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:24:22,345 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 11:24:22,348 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:24:22,835 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 11:24:22,836 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:24:25,532 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 127
2025-11-12 11:24:25,533 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:24:26,391 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:24:26,395 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:24:26,398 - ispa_next.main - DEBUG - 



2025-11-12 11:24:26,398 - ispa_next.main - DEBUG - starting with process 4 (LM MM 585) of 5
2025-11-12 11:24:26,402 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:24:27,563 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:24:28,427 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 11:24:28,428 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 127
2025-11-12 11:24:29,595 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:24:29,597 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:01,568 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 11:25:01,576 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 11:25:01,579 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:01,890 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 11:25:01,891 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:03,942 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 127
2025-11-12 11:25:03,943 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:04,524 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:25:04,527 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 11:25:04,531 - ispa_next.main - DEBUG - 



2025-11-12 11:25:04,531 - ispa_next.main - DEBUG - starting with process 5 (LM-R 890) of 5
2025-11-12 11:25:04,544 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:25:05,451 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:25:06,311 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 552
2025-11-12 11:25:06,312 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 127
2025-11-12 11:25:07,538 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 11:25:07,539 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:25:29,157 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 11:25:30,940 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 11:25:35,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:25:38,527 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 11:25:38,528 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:38,593 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:38,824 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 11:25:38,828 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 11:25:38,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:38,931 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:25:45,785 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:25:45,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:25:47,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:25:49,030 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 11:25:49,124 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 11:25:49,223 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 11:25:49,329 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 11:25:53,536 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 11:25:54,541 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 11:25:54,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:25:55,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:06,464 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 11:26:09,841 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 11:26:09,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:09,953 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 11:26:09,954 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 11:26:10,001 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 11:26:11,183 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 11:26:12,356 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 11:26:12,570 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 11:26:14,268 - ispa_next.functions - DEBUG - Updated appointment (AC00019071) customer contact data.
2025-11-12 11:26:15,183 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 11:26:15,185 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 11:26:15,676 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 11:26:15,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 11:26:16,330 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 11:26:19,912 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 11:26:19,912 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 11:26:19,915 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 11:26:19,916 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 11:26:19,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:20,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:24,568 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 11:26:24,572 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 11:26:24,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:24,684 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 11:26:25,066 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:25,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 11:26:25,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 11:26:26,291 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 11:26:26,292 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 11:26:28,705 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 11:26:28,707 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 11:26:30,300 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 11:26:30,302 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:30,304 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug Innenraum saugen: active placement guards
2025-11-12 11:26:30,306 - ispa_next.package_manager.main - DEBUG - Cannot place FAHRZEUGWÄSCHE BASIS: active placement guards
2025-11-12 11:26:30,307 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 11:26:30,308 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 11:26:30,310 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 11:26:30,311 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 11:26:30,312 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 11:26:30,314 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 11:26:30,315 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 11:26:30,323 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 11:26:30,332 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 11:26:30,336 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 11:26:30,336 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:32,914 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 11:26:32,915 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 11:26:32,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:35,507 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 11:26:35,509 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 11:26:35,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 11:26:36,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 11:26:36,670 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:50,118 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 11:26:50,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:26:52,707 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 11:27:03,307 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 11:27:03,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:04,321 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 11:27:04,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 11:27:10,571 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:14,135 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 11:27:14,136 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 11:27:14,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 11:27:14,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 11:27:14,633 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 11:27:14,634 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 11:27:15,891 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 11:27:22,840 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 11:27:23,212 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 11:27:23,917 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 11:27:24,646 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 551
2025-11-12 11:27:24,647 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 11:27:27,714 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 126
2025-11-12 11:27:27,715 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 11:27:28,511 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
