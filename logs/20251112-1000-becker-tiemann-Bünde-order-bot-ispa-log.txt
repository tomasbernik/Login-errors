2025-11-12 10:00:35,814 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:00:35,823 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:00:48,647 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:01:00,088 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:01:15,756 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:01:48,662 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:02:01,230 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:02:03,938 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:04,723 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:02:04,724 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 10:02:06,579 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 150
2025-11-12 10:02:06,579 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:02:06,580 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:07,501 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:02:08,276 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:02:28,039 - ispa_next.appointments.models - DEBUG - Appointment Mariya Aleksandrovna OS-UA 81 WBA4C11010G273031 ohne Termin.
2025-11-12 10:02:28,052 - ispa_next.appointments.models - DEBUG - Appointment Öezlem Cicek HF-OZ 84 WBA31AX010FP86133 ohne Termin.
2025-11-12 10:02:28,059 - ispa_next.appointments.models - DEBUG - Appointment Vitali Skrebzov MI-OV 77 WBA2E310605F41924 ohne Termin.
2025-11-12 10:02:28,066 - ispa_next.appointments.models - DEBUG - Appointment Karlheinz Böttger HF-EK 2016 WBA2X71000V366813 ohne Termin.
2025-11-12 10:02:28,077 - ispa_next.main - DEBUG - Found 15 out of 36 appointments to process (configured limit: 15).
2025-11-12 10:02:28,078 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-12 10:02:28,078 - ispa_next.main - DEBUG - Processing 8 already visited appointments (w/ RKR not callable).
2025-11-12 10:02:28,078 - ispa_next.main - DEBUG - All appointments: BÜNDE, HF-LB-222, HF L 1612, OS-CW177, HF-BT 540, MI-JC 96 E, BÜNDE, HF-C 213, HF-C 213, HF-H 2227E, HF-AV 404, HF-GE 123, OS-BO 693, HF-EO 550E, HF-HB 922
2025-11-12 10:02:28,080 - ispa_next.main - DEBUG - 



2025-11-12 10:02:28,080 - ispa_next.main - DEBUG - starting with process 1 (BÜNDE) of 15
2025-11-12 10:02:28,084 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:02:28,886 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:02:29,699 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:02:29,700 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 150
2025-11-12 10:02:30,830 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:02:30,831 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:08,420 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:03:08,521 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:03:08,524 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:09,011 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:03:09,012 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:11,024 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 341
2025-11-12 10:03:11,024 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:11,816 - ispa_next.main - DEBUG - Found new Appointment: HF-EE 70
2025-11-12 10:03:11,817 - ispa_next.main - DEBUG - Found new Appointment: HF S 1105E
2025-11-12 10:03:11,819 - ispa_next.main - DEBUG - 



2025-11-12 10:03:11,819 - ispa_next.main - DEBUG - starting with process 2 (HF-EE 70) of 17
2025-11-12 10:03:11,821 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:03:12,919 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:03:14,005 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:03:14,006 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 341
2025-11-12 10:03:15,272 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:03:15,274 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:03:38,819 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:03:47,806 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:03:50,347 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:03:50,347 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:50,455 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:03:50,625 - ispa_next.functions - DEBUG - HU date already expired after 17 days.
2025-11-12 10:03:56,845 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:03:56,848 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:03:56,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:03:56,921 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:04:06,246 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:04:06,247 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:07,245 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:09,251 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:04:09,362 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:04:12,611 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:04:12,670 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:04:16,860 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:04:17,866 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:04:17,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:18,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:29,592 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:04:29,592 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:04:35,946 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:04:35,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:36,044 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:04:36,045 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:04:36,076 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:04:36,156 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:04:37,371 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:04:37,641 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:04:40,765 - ispa_next.functions - DEBUG - Updated appointment (AA00044507) customer contact data.
2025-11-12 10:04:41,669 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:04:41,670 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:04:41,737 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:04:42,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:04:43,700 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:04:43,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:04:43,860 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:04:47,461 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:04:47,461 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:04:47,464 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:04:47,467 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:04:47,468 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:47,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:48,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:48,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:04:48,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:04:49,471 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:04:49,472 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:04:52,445 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:04:52,447 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:04:53,563 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:04:53,570 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:04:53,572 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:04:53,575 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:04:53,576 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:04:53,578 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:04:53,582 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:04:53,583 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:04:53,592 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:04:53,595 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:04:53,597 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:04:53,599 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:04:53,603 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:04:53,604 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:04:53,604 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:04:56,860 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 10:04:59,677 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:04:59,679 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:04:59,683 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:03,045 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:05:03,047 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:05:03,048 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:05:03,737 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:05:03,960 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:13,810 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:05:13,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:17,025 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:05:17,026 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:05:17,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:05:18,043 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:05:18,178 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:05:25,258 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:28,781 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:31,937 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:35,675 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:05:35,677 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:05:35,678 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:05:36,285 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:05:36,393 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:05:36,394 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:05:38,120 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:05:48,788 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:05:49,166 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:05:49,659 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:50,566 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:05:50,568 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:53,336 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:05:53,336 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:05:54,224 - ispa_next.main - DEBUG - 



2025-11-12 10:05:54,225 - ispa_next.main - DEBUG - starting with process 3 (HF S 1105E) of 17
2025-11-12 10:05:54,228 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:05:55,270 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:05:56,290 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:05:56,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:05:57,543 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:05:57,545 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:06:27,341 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:06:27,351 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:06:27,354 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:06:27,735 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:06:27,737 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:06:30,209 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:06:30,209 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:06:31,108 - ispa_next.main - DEBUG - 



2025-11-12 10:06:31,108 - ispa_next.main - DEBUG - starting with process 4 (HF-LB-222) of 17
2025-11-12 10:06:31,112 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:06:32,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:06:33,706 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:06:33,708 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:06:35,018 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:06:35,020 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:05,665 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:07:05,673 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:07:05,676 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:06,088 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:07:06,089 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:08,240 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:07:08,240 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:08,948 - ispa_next.main - DEBUG - 



2025-11-12 10:07:08,948 - ispa_next.main - DEBUG - starting with process 5 (HF L 1612) of 17
2025-11-12 10:07:08,951 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:07:09,895 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:10,897 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:07:10,898 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:07:12,018 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:12,020 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:41,015 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:07:41,024 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:07:41,026 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:41,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:07:41,362 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:43,254 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:07:43,255 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:07:43,929 - ispa_next.main - DEBUG - 



2025-11-12 10:07:43,929 - ispa_next.main - DEBUG - starting with process 6 (OS-CW177) of 17
2025-11-12 10:07:43,934 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:07:44,844 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:07:45,684 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:07:45,685 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:07:46,756 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:07:46,757 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:17,292 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:08:17,300 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:08:17,304 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:17,681 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:08:17,682 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:19,497 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:08:19,498 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:20,233 - ispa_next.main - DEBUG - 



2025-11-12 10:08:20,233 - ispa_next.main - DEBUG - starting with process 7 (HF-BT 540) of 17
2025-11-12 10:08:20,237 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:08:21,344 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:08:22,177 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:08:22,178 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:08:23,526 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:08:23,527 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:08:46,441 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:08:55,639 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:08:59,571 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:08:59,572 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:08:59,659 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:08:59,903 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:08:59,907 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:08:59,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:00,030 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:09:03,048 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:09:03,050 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:04,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:06,060 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:09:06,188 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:09:09,411 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:09:09,521 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:09:09,521 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:09:17,988 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:09:18,994 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:09:18,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:19,502 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:31,628 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:09:31,629 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:09:37,755 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:09:37,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:09:37,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:09:37,845 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:09:37,889 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:09:39,084 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:09:39,302 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:09:42,583 - ispa_next.functions - DEBUG - Updated appointment (AE00024535) customer contact data.
2025-11-12 10:09:43,511 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:09:43,513 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:09:44,207 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:09:44,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:09:44,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:09:48,520 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:09:48,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:09:49,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:09:51,027 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:09:51,122 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:09:51,254 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:09:51,324 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:09:51,324 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:10:02,827 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 10:10:07,274 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:10:07,274 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:10:11,545 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:10:12,580 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:10:12,583 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:10:12,584 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:12,648 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:10:21,972 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:10:26,450 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:10:26,453 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:27,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:10:27,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:10:27,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:10:27,716 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:10:31,316 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:10:31,318 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:10:32,498 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:10:32,500 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:10:32,502 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:10:32,503 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:10:32,504 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Alle Wischerblätter ersetzen, source=from_aw_package, target=cart)}
2025-11-12 10:10:32,505 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:10:32,507 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:10:32,511 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:10:32,512 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:10:32,514 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:10:32,515 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:10:32,517 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:10:32,529 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:10:54,870 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 318, in _add_to_container_from_aw
    items = aw_dialog.query(
            ^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 506, in query
    found = query(self.control, string)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 194, in query
    return mapper.run(root, selector)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 138, in run
    current_root = self.execute(current_root, step)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 165, in execute
    return self._find_element(element, condition, kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mapper.py", line 96, in _find_element
    return find_first(
           ^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: control_type = '50023'
AND
automation_id = 'infrastructure:TreeGrid_2'
AND
class_name = 'TreeView'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 265, in run
    self._process_to_cart(self.to_cart)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 228, in _process_to_cart
    self.ui_helper.add_to_cart(self.base_element, add_to_container)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 188, in add_to_cart
    self._add_to_container_from_aw(base_element, from_aw)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 322, in _add_to_container_from_aw
    close_on_error(aw_dialog)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 293, in close_on_error
    raise ValueError("Catalog items not found.")
ValueError: Catalog items not found.

2025-11-12 10:10:54,897 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:10:54,899 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:55,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:10:56,383 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:10:56,384 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 10:10:56,407 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:10:59,301 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:10:59,303 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:59,792 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:10:59,794 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:02,401 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:11:02,402 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:03,091 - ispa_next.main - DEBUG - 



2025-11-12 10:11:03,091 - ispa_next.main - DEBUG - starting with process 8 (MI-JC 96 E) of 17
2025-11-12 10:11:03,096 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:03,943 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:04,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:11:04,798 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:11:05,952 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:05,953 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:36,322 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:11:36,331 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 10:11:36,333 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:36,893 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:11:36,894 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:39,457 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:11:39,457 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:11:40,140 - ispa_next.main - DEBUG - 



2025-11-12 10:11:40,140 - ispa_next.main - DEBUG - starting with process 9 (BÜNDE) of 17
2025-11-12 10:11:40,144 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:11:41,079 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:11:41,958 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:11:41,959 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:11:43,258 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:11:43,259 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:12,875 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:12:12,884 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 10:12:12,888 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:12:13,464 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:12:13,466 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:12:16,067 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:12:16,068 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:16,960 - ispa_next.main - DEBUG - 



2025-11-12 10:12:16,960 - ispa_next.main - DEBUG - starting with process 10 (HF-C 213) of 17
2025-11-12 10:12:16,963 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:12:18,184 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:12:19,493 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:12:19,502 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:12:20,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:12:20,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:12:43,600 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:12:45,545 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:12:50,615 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:52,521 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:12:52,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:52,629 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:52,781 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:12:52,785 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:12:52,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:52,876 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:12:59,738 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:59,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:00,742 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:02,751 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:13:02,899 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:13:03,003 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:13:03,088 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:13:07,294 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:13:08,299 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:13:08,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:08,832 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:18,699 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:13:22,603 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:13:22,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:22,699 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:13:22,700 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:13:22,731 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:13:22,830 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:13:24,093 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:13:24,312 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:13:25,702 - ispa_next.functions - DEBUG - Updated appointment (AI00015550) customer contact data.
2025-11-12 10:13:26,601 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:13:26,603 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:13:26,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:13:27,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:13:28,847 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:13:28,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:13:28,918 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:13:32,519 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:13:32,519 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:13:32,522 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:13:32,526 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:13:32,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:33,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:33,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:33,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:13:33,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:13:34,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:13:34,654 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:13:36,570 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:13:36,572 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:13:37,527 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:13:37,530 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:37,532 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:13:37,534 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:13:37,535 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:13:37,536 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:13:37,538 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:13:37,539 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:13:37,541 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:13:37,543 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:13:37,544 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:13:37,546 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:13:37,550 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:13:37,552 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:13:37,553 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:39,518 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:13:39,519 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:13:39,521 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:41,397 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:13:41,398 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:13:41,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:13:42,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:13:42,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:51,196 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:13:51,198 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:53,126 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:13:53,127 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:13:53,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:54,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:13:54,230 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:02,155 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:06,818 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:06,820 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:14:06,821 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:07,378 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:14:07,477 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:14:07,479 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:14:09,224 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:14:16,470 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:14:16,880 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 10:14:17,196 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:18,208 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:14:18,209 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:21,243 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:14:21,244 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:22,122 - ispa_next.main - DEBUG - 



2025-11-12 10:14:22,122 - ispa_next.main - DEBUG - starting with process 11 (HF-C 213) of 17
2025-11-12 10:14:22,126 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:23,323 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:24,527 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:14:24,529 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:14:26,012 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:26,014 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:49,960 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:14:51,906 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:14:56,734 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:58,648 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:14:58,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:58,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:14:58,888 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:14:58,890 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:14:58,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:14:59,012 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:05,010 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:15:05,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:05,952 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:07,955 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:15:08,141 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:15:08,263 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:15:08,325 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:15:12,542 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:15:13,547 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:15:13,565 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:14,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:23,717 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:15:27,324 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:15:27,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:27,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:15:27,405 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:15:27,459 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:15:27,546 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:15:28,671 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:15:28,913 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:15:30,223 - ispa_next.functions - DEBUG - Updated appointment (AF00021378) customer contact data.
2025-11-12 10:15:31,142 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:15:31,144 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:15:31,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:15:31,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:15:32,890 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:15:32,891 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:15:32,966 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:15:36,580 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:15:36,581 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:15:36,583 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:15:36,586 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:15:36,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:37,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:37,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:38,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:15:38,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:15:38,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:15:38,719 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:15:40,569 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:15:40,572 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:15:41,509 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:15:41,511 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:41,513 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:15:41,514 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:15:41,516 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:15:41,521 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:15:41,525 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:15:41,529 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:15:41,531 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:15:41,533 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:15:41,540 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:15:41,542 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:15:41,545 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:15:41,547 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:15:41,547 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:43,451 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:15:43,453 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:15:43,464 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:45,371 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:15:45,373 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:15:45,373 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:15:46,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:15:46,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:55,622 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:15:55,624 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:15:57,580 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:15:57,582 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:15:58,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:15:58,582 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:15:58,690 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:04,448 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:09,029 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:16:09,031 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:16:09,031 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:09,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:16:09,728 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:16:09,729 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:16:11,588 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:16:17,805 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:16:18,193 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 10:16:18,573 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:19,399 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:16:19,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:22,631 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:16:22,632 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:23,456 - ispa_next.main - DEBUG - 



2025-11-12 10:16:23,456 - ispa_next.main - DEBUG - starting with process 12 (HF-H 2227E) of 17
2025-11-12 10:16:23,461 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:16:24,597 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:16:25,518 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:16:25,519 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:16:26,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:16:26,903 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:16:51,108 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:16:52,823 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:16:57,415 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:03,395 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:17:03,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:03,463 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:03,726 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:17:03,728 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:17:03,728 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:03,838 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:06,862 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:06,864 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:07,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:09,747 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:17:09,857 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:17:09,945 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:17:10,017 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:17:14,228 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:17:15,232 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:17:15,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:15,701 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:29,822 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:17:33,260 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:17:33,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:33,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:17:33,341 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:17:33,382 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:17:34,537 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:17:35,797 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:17:35,998 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:17:37,282 - ispa_next.functions - DEBUG - Updated appointment (AA00044450) customer contact data.
2025-11-12 10:17:38,227 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:17:38,229 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:17:39,103 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:17:39,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:17:39,884 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:17:43,454 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:43,454 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:17:43,457 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:17:43,459 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:17:43,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:43,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:47,530 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-12 10:17:56,691 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:17:56,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:57,460 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:17:57,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:58,128 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:58,130 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:18:03,610 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:18:03,612 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:18:04,721 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:18:04,722 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:04,724 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:18:04,725 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:18:04,725 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:18:04,726 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:18:04,728 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:18:04,729 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:18:04,731 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:18:04,738 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:18:04,760 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:18:04,771 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:18:04,772 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:18:04,773 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:10,854 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:18:10,856 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:18:10,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:16,830 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:18:16,840 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:18:16,841 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:18:17,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:18:17,823 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:31,035 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:18:31,037 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:37,005 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:18:37,006 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:18:37,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:18:38,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:18:38,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:47,819 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:18:51,540 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:18:54,874 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:18:59,433 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:19:03,222 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:19:03,223 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:03,859 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:19:03,944 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:19:03,945 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:19:06,957 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:19:14,690 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:19:15,066 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 10:19:15,490 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:19:16,702 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:19:16,703 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:19:19,878 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:19:19,878 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:19:20,581 - ispa_next.main - DEBUG - 



2025-11-12 10:19:20,581 - ispa_next.main - DEBUG - starting with process 13 (HF-AV 404) of 17
2025-11-12 10:19:20,586 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:19:21,439 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:19:22,451 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:19:22,453 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:19:23,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:19:23,685 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:19:47,715 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:19:49,571 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:19:54,873 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:19:58,846 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:19:58,847 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:58,917 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:19:59,185 - ispa_next.functions - DEBUG - HU date already expired after 9 days.
2025-11-12 10:20:03,143 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:20:03,145 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:20:03,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:03,229 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:20:10,007 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:20:10,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:20:10,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:20:12,906 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:20:13,022 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:20:13,113 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:20:13,222 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:20:17,352 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:20:18,357 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:20:18,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:18,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:28,572 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:20:32,633 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:20:32,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:32,718 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:20:32,719 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:20:32,785 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:20:34,068 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:20:35,488 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:20:35,711 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:20:37,142 - ispa_next.functions - DEBUG - Updated appointment (AB00040183) customer contact data.
2025-11-12 10:20:38,067 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:20:38,069 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:20:38,770 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:20:38,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:20:39,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:20:43,202 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:20:43,203 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:20:43,207 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:20:43,210 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:20:43,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:20:43,708 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:20:47,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:47,715 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:20:47,716 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:20:48,435 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:20:48,436 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:20:52,073 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:20:52,075 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:20:53,045 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:20:53,048 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:20:53,051 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:20:53,054 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:20:53,056 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:20:53,058 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:20:53,060 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:20:53,061 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:20:53,063 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:20:53,064 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:20:53,065 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:20:53,067 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:20:53,070 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:20:53,071 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:20:53,072 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:20:57,058 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:20:57,060 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:20:57,061 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:01,016 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:21:01,017 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:21:01,017 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:21:01,812 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:21:02,039 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:11,193 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:21:11,195 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:15,182 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:21:15,183 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:21:15,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:21:16,198 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:21:16,337 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:21:24,310 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:29,252 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:33,544 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:38,386 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:44,473 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:21:44,475 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:21:44,476 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:45,142 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:21:45,257 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:21:45,258 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:21:47,021 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:21:54,962 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:21:55,345 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 10:21:55,857 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:56,825 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:21:56,830 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:00,208 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:22:00,209 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:01,129 - ispa_next.main - DEBUG - 



2025-11-12 10:22:01,129 - ispa_next.main - DEBUG - starting with process 14 (HF-GE 123) of 17
2025-11-12 10:22:01,133 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:02,342 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:03,537 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:22:03,538 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:22:05,068 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:05,069 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:29,765 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:22:31,873 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:22:36,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:22:41,569 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:22:41,570 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:41,654 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:41,847 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:22:41,850 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:22:41,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:41,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:22:45,209 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:22:45,210 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:22:46,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:22:48,834 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:22:48,941 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:22:49,059 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:22:49,135 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:22:53,287 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:22:54,294 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:22:54,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:22:54,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:06,398 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 10:23:06,398 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 10:23:09,832 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:23:09,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:09,898 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:09,899 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:23:09,946 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:23:11,285 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:23:12,480 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:23:12,705 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:23:14,140 - ispa_next.functions - DEBUG - Updated appointment (AF00021355) customer contact data.
2025-11-12 10:23:15,085 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:23:15,087 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:23:16,099 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:23:16,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:23:16,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:23:21,009 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:21,009 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:23:21,012 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:23:21,014 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:23:21,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:21,489 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:27,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:27,581 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:27,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:28,249 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:28,250 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:23:32,452 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:23:32,456 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:23:33,835 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:23:33,845 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:23:33,848 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:23:33,849 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:23:33,850 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:23:33,851 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:23:33,853 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:23:33,855 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:23:33,856 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:23:33,865 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:23:33,868 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:23:33,871 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:23:33,873 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:23:33,875 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:23:33,875 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:38,606 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:23:38,607 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:23:38,610 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:43,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:43,420 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:23:52,585 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:07,065 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:24:07,067 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:24:07,067 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:24:08,039 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:24:08,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:21,810 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:24:21,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:26,465 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:24:26,467 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:24:26,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:27,520 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:24:27,721 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:24:36,553 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:41,242 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:24:44,703 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:24:44,704 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:24:45,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:24:45,444 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:24:45,445 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:24:48,400 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:24:54,940 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:24:55,312 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 10:24:56,232 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:24:56,932 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:24:56,933 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:24:59,373 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 340
2025-11-12 10:24:59,374 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:00,060 - ispa_next.main - DEBUG - 



2025-11-12 10:25:00,060 - ispa_next.main - DEBUG - starting with process 15 (OS-BO 693) of 17
2025-11-12 10:25:00,063 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:25:00,989 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:25:01,801 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:25:01,802 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 340
2025-11-12 10:25:03,020 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:25:03,021 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:25:30,956 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:25:32,981 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:25:38,473 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:47,188 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:25:47,189 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:47,284 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:47,453 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:25:47,457 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:25:47,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:47,537 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:25:50,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:25:50,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:51,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:53,658 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:25:53,782 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:25:53,848 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:25:53,916 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:25:56,098 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:25:57,103 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:25:57,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:57,587 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:11,487 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:26:16,051 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:26:16,054 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:16,183 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:26:16,184 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:26:16,243 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:26:16,345 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:26:17,509 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:26:17,711 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:26:19,286 - ispa_next.functions - DEBUG - Updated appointment (AB00040597) customer contact data.
2025-11-12 10:26:20,222 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:26:20,224 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:26:20,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:26:21,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:26:22,944 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:26:22,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:26:23,039 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:26:26,606 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:26:26,607 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:26:26,610 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:26:26,614 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:26:26,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:27,167 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:30,702 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:26:42,781 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:26:43,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:43,946 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:26:43,946 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:26:44,608 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:26:44,609 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:26:52,225 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:26:52,227 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:26:53,816 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:26:53,817 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:53,818 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:26:53,820 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:26:53,821 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:26:53,822 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:26:53,829 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:26:53,832 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:26:53,835 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:26:53,838 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:26:53,840 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:26:53,842 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:26:53,845 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:26:53,846 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:26:53,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:02,574 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:27:02,575 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:27:02,585 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:11,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:27:11,589 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:27:20,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:27:39,557 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:27:39,559 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:27:39,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:27:40,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:27:40,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:00,916 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:28:00,923 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:09,743 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:28:09,744 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:28:10,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:28:10,859 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:28:11,095 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:28:24,664 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:28:29,538 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:28:33,462 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:28:33,463 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:34,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:28:34,256 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:28:34,257 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:28:37,495 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:28:46,337 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:28:46,717 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-12 10:28:48,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:48,726 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:28:48,727 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:52,132 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 337
2025-11-12 10:28:52,133 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:52,961 - ispa_next.main - DEBUG - 



2025-11-12 10:28:52,961 - ispa_next.main - DEBUG - starting with process 16 (HF-EO 550E) of 17
2025-11-12 10:28:52,966 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:54,131 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:55,344 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 613
2025-11-12 10:28:55,345 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 337
2025-11-12 10:28:56,648 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:56,649 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:20,911 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:29:22,717 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:29:27,752 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:31,058 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:29:31,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:31,131 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:31,302 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:29:31,305 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:29:31,306 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:31,457 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:34,529 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:34,531 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:35,863 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:37,868 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:29:37,990 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:29:38,104 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:29:38,192 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:29:42,411 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:29:43,416 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:29:43,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:43,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:53,631 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:29:57,202 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:29:57,204 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:57,291 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:57,291 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:29:57,333 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:29:58,563 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:29:58,787 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:30:00,588 - ispa_next.functions - DEBUG - Updated appointment (AB00040564) customer contact data.
2025-11-12 10:30:01,603 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:30:01,605 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:30:02,409 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:30:02,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:30:03,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:30:07,402 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:30:07,402 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:30:07,406 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:30:07,410 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:30:07,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:07,896 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:16,597 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:30:26,036 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:30:26,037 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:26,793 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:26,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:27,476 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:27,477 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:30:30,647 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:30:30,649 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:30:31,770 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:30:31,772 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:31,775 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:30:31,776 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:30:31,777 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:30:31,778 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:30:31,780 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:30:31,782 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:30:31,783 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:30:31,785 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:30:31,786 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:30:31,788 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:30:31,790 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:30:31,792 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:30:31,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:35,119 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:30:35,120 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:30:35,122 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:38,572 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:30:38,574 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:30:38,574 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:30:40,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:30:40,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:52,281 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:30:52,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:30:55,525 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:30:55,526 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:30:56,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:30:56,564 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:30:56,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:04,236 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:07,788 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:11,492 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:15,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:31:15,994 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:31:15,994 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:16,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:16,560 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:31:16,561 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:31:18,010 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:31:25,466 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:31:25,871 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-12 10:31:26,798 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:27,522 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 614
2025-11-12 10:31:27,524 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:30,487 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 338
2025-11-12 10:31:30,488 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:31,314 - ispa_next.appointments.models - DEBUG - Appointment Thomas Pietsch LIP-TP 964 WMW11DJ0502R56521 ohne Termin.
2025-11-12 10:31:31,321 - ispa_next.main - DEBUG - 



2025-11-12 10:31:31,321 - ispa_next.main - DEBUG - starting with process 17 (HF-HB 922) of 17
2025-11-12 10:31:31,324 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:31:32,444 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:31:33,781 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 614
2025-11-12 10:31:33,783 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 338
2025-11-12 10:31:35,144 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:31:35,146 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:31:59,255 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:32:01,019 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:32:06,363 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:07,576 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:32:07,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:07,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:07,827 - ispa_next.functions - DEBUG - HU date already expired after 996 days.
2025-11-12 10:32:11,133 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:32:11,135 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:32:11,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:11,220 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:14,410 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:32:14,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:15,667 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:17,670 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:32:17,779 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:32:17,861 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:32:17,922 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:32:22,126 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:32:23,131 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:32:23,132 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:23,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:34,258 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:32:38,834 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:32:38,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:38,899 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:32:38,899 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:32:38,993 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:32:40,281 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:32:41,537 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:32:41,786 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:32:43,319 - ispa_next.functions - DEBUG - Updated appointment (AF00021367) customer contact data.
2025-11-12 10:32:44,301 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:32:44,303 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:32:44,889 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:32:44,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:32:45,801 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:32:49,821 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:32:49,821 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:32:49,825 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:32:49,828 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:32:49,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:50,313 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:54,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:54,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:32:54,768 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:32:55,473 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:32:55,474 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:32:56,818 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:32:56,821 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:32:58,185 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:32:58,187 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:32:58,189 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:32:58,190 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:32:58,191 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:32:58,193 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:32:58,195 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:32:58,208 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:32:58,210 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:32:58,212 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:32:58,213 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:32:58,215 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:32:58,217 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:32:58,218 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:32:58,219 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:59,402 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:32:59,404 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:32:59,406 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:00,626 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:33:00,627 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:33:00,628 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:33:01,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:33:01,632 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:13,678 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:33:13,679 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:14,925 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:33:14,926 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:33:15,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:33:15,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:33:16,133 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:33:21,618 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:33:21,620 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:33:21,621 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:33:22,270 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:33:22,342 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:33:22,343 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:33:23,957 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:33:31,224 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:33:31,628 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-12 10:33:32,130 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:33,312 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 614
2025-11-12 10:33:33,314 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:36,112 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 338
2025-11-12 10:33:36,113 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:33:36,893 - ispa_next.main - DEBUG - Found new Appointment: LIP-TP 964
2025-11-12 10:33:36,894 - ispa_next.main - DEBUG - 



2025-11-12 10:33:36,894 - ispa_next.main - DEBUG - starting with process 18 (LIP-TP 964) of 18
2025-11-12 10:33:36,898 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:33:38,040 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:33:39,301 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 614
2025-11-12 10:33:39,303 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 338
2025-11-12 10:33:40,663 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:33:40,665 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:34:05,766 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:34:16,247 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:34:19,509 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:34:19,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:19,615 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:34:19,899 - ispa_next.functions - DEBUG - HU date already expired after 407 days.
2025-11-12 10:34:26,445 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:34:26,447 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:34:26,448 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:26,519 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:34:29,424 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:34:29,425 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:34:30,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:34:32,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:34:32,659 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:34:35,862 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:34:35,924 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:34:40,093 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:34:41,101 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:34:41,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:41,641 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:34:56,111 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:35:03,585 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:35:03,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:03,660 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:03,660 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:35:03,692 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:35:05,403 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:35:06,603 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:35:06,806 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:35:10,105 - ispa_next.functions - DEBUG - Updated appointment (AA00044516) customer contact data.
2025-11-12 10:35:10,998 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:35:11,001 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:35:11,730 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:35:11,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:35:12,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:35:17,151 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:35:17,151 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:35:17,305 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:35:17,309 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:35:17,309 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:18,009 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:18,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:18,860 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:18,860 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:19,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:19,647 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:35:23,304 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:35:23,306 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:35:24,257 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:35:24,261 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:35:24,263 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-12 10:35:24,265 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-12 10:35:24,268 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:35:24,270 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:35:24,271 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:35:24,272 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:35:24,273 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:35:24,275 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:35:24,276 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:35:24,277 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:35:24,280 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:35:24,281 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:35:24,282 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:28,381 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:35:28,383 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:35:28,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:32,368 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:35:32,370 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:35:32,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:35:33,000 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:35:33,033 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:35:33,034 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:36,943 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:35:36,945 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:35:37,455 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:35:37,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:35:38,123 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:46,454 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:51,194 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:35:55,852 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:36:01,876 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:36:01,877 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:36:02,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:36:02,658 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:36:02,659 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:36:05,773 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:36:13,578 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:36:13,962 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-12 10:36:14,380 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:36:15,471 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 614
2025-11-12 10:36:15,472 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:36:18,552 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 338
2025-11-12 10:36:18,553 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
