2025-11-17 12:01:23,598 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 12:01:23,605 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 12:01:36,456 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 12:01:47,020 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 12:02:02,868 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 12:03:16,475 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 12:03:34,870 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 12:03:38,702 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:03:40,444 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 848
2025-11-17 12:03:40,446 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 290
2025-11-17 12:03:43,563 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 137
2025-11-17 12:03:43,564 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 12:03:43,565 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:03:45,056 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 12:03:46,471 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:04:14,202 - ispa_next.appointments.models - DEBUG - Appointment Thorsten Schwarz FT-T 171 WBAEN510X0PC21387 ohne Termin.
2025-11-17 12:04:14,215 - ispa_next.appointments.models - DEBUG - Appointment  NW-G 3322 WBATX55010NV20982 ohne Termin.
2025-11-17 12:04:14,224 - ispa_next.appointments.models - DEBUG - Appointment Peter Manger SÜW-PM 20 WBY71GM0405396367 ohne Termin.
2025-11-17 12:04:14,239 - ispa_next.appointments.models - DEBUG - Appointment Reiner Buhl NW-RB 277 WBA5V71040AH89228 ohne Termin.
2025-11-17 12:04:14,251 - ispa_next.appointments.models - DEBUG - Appointment Liza-Simona Dragoi NW-SL 648 WBAVA71010PS02943 ohne Termin.
2025-11-17 12:04:14,259 - ispa_next.appointments.models - DEBUG - Appointment Tanja Heller NW-TH 11 WBA6K31020FK00800 ohne Termin.
2025-11-17 12:04:14,271 - ispa_next.appointments.models - DEBUG - Appointment Michele Guastaferro LU-CM 231 WBAJC31010G871442 ohne Termin.
2025-11-17 12:04:14,271 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 12:04:14,280 - ispa_next.appointments.models - DEBUG - Appointment Mohammad Al Ghaban NW-U 1076 WBAUY51010A886925 ohne Termin.
2025-11-17 12:04:14,289 - ispa_next.appointments.models - DEBUG - Appointment Markus Hengst  WBA1H11070VW96664 ohne Termin.
2025-11-17 12:04:14,298 - ispa_next.appointments.models - DEBUG - Appointment Weingut Reichsrat v. Buhl GmbH DÜW-RB 92 E WBA81CY080FS07302 ohne Termin.
2025-11-17 12:04:14,307 - ispa_next.appointments.models - DEBUG - Appointment Dimitri Blatner BB-DL 2908 WBAUT31030A863939 ohne Termin.
2025-11-17 12:04:14,319 - ispa_next.appointments.models - DEBUG - Appointment Nadine Hoffner NW-NH 79 WBAUE31070E070551 ohne Termin.
2025-11-17 12:04:14,332 - ispa_next.appointments.models - DEBUG - Appointment Rolf Dörr SÜW-BR 122 WBAHF11030WW43975 ohne Termin.
2025-11-17 12:04:14,362 - ispa_next.appointments.models - DEBUG - Appointment Ingrid Reinhardt NW-AR 16 WBAVN11090VN28373 ohne Termin.
2025-11-17 12:04:14,378 - ispa_next.appointments.models - DEBUG - Appointment Michael Reipert SÜW-R 7606 WBAJM71040B267868 ohne Termin.
2025-11-17 12:04:14,394 - ispa_next.appointments.models - DEBUG - Appointment Hans-Joachim Vesterling NW-UJ 68 WBA31BL090WW88639 ohne Termin.
2025-11-17 12:04:14,403 - ispa_next.appointments.models - DEBUG - Appointment Christian Mergl MA-CL 2310 WBAJM91090BH38833 ohne Termin.
2025-11-17 12:04:14,411 - ispa_next.appointments.models - DEBUG - Appointment Marc Ullemeyer GER-MU 27 WBAPF51040A428573 ohne Termin.
2025-11-17 12:04:14,419 - ispa_next.appointments.models - DEBUG - Appointment Jutta Inge Laubersheimer LD-L 400 WBA6L31090FK52101 ohne Termin.
2025-11-17 12:04:14,428 - ispa_next.appointments.models - DEBUG - Appointment Schulz Rainer HD-SP 550 WBAJP510X0BU55337 ohne Termin.
2025-11-17 12:04:14,436 - ispa_next.appointments.models - DEBUG - Appointment Sissy Klinger NW-S WBA1V710007A63233 ohne Termin.
2025-11-17 12:04:14,444 - ispa_next.appointments.models - DEBUG - Appointment Jetmire Idrizi NW-J 1999 WBAJF31070BS70122 ohne Termin.
2025-11-17 12:04:14,452 - ispa_next.appointments.models - DEBUG - Appointment Marcel Haupenthal SÜW-HM 256 WBA5F310X0FJ07362 ohne Termin.
2025-11-17 12:04:14,460 - ispa_next.appointments.models - DEBUG - Appointment Marco Röper RP-MP 210 WBAJC31010B050886 ohne Termin.
2025-11-17 12:04:14,469 - ispa_next.appointments.models - DEBUG - Appointment Andreas Friedrichsen NW-AF 46 WBAUZ35040N027624 ohne Termin.
2025-11-17 12:04:14,476 - ispa_next.appointments.models - DEBUG - Appointment Thomas Herbert Leydecker SÜW-LT 882 WBA6L71030FJ30924 ohne Termin.
2025-11-17 12:04:14,484 - ispa_next.appointments.models - DEBUG - Appointment Eduard Schall NW-ES 164 WBATX35010NC06188 ohne Termin.
2025-11-17 12:04:14,493 - ispa_next.appointments.models - DEBUG - Appointment Eduard Ludvig NW-IC 9000 WBA6L51000FJ00638 ohne Termin.
2025-11-17 12:04:14,505 - ispa_next.appointments.models - DEBUG - Appointment David Jauch SÜW-SD 712 WBAMX11050DY05841 ohne Termin.
2025-11-17 12:04:14,519 - ispa_next.appointments.models - DEBUG - Appointment Karl-Friedrich Deidesheimer NW-EF 57 WBAUM91080VR96138 ohne Termin.
2025-11-17 12:04:14,532 - ispa_next.appointments.models - DEBUG - Appointment Heinrich Schröder NW-XO 2 WBA5F71000FH03378 ohne Termin.
2025-11-17 12:04:14,549 - ispa_next.appointments.models - DEBUG - Appointment I & C Nebel GmbH NW-IC 808 WBATX35070NE03852 ohne Termin.
2025-11-17 12:04:14,562 - ispa_next.appointments.models - DEBUG - Appointment Andreas Röhle SÜW-T 811 WBATX75090N056853 ohne Termin.
2025-11-17 12:04:14,573 - ispa_next.appointments.models - DEBUG - Appointment Schwanen Apotheke GER-NE 320 WBA6L51060FH68494 ohne Termin.
2025-11-17 12:04:14,582 - ispa_next.appointments.models - DEBUG - Appointment Matthias Glass SÜW-JG 309 WBA5F71080FH06299 ohne Termin.
2025-11-17 12:04:14,589 - ispa_next.appointments.models - DEBUG - Appointment   WBA1V710905K77064 ohne Termin.
2025-11-17 12:04:14,600 - ispa_next.appointments.models - DEBUG - Appointment Manfred Lenz DÜW-L 57 WBAHT910805J05575 ohne Termin.
2025-11-17 12:04:14,608 - ispa_next.appointments.models - DEBUG - Appointment Dritan Krijeziu NW-E 1991 WBAKS410800C35366 ohne Termin.
2025-11-17 12:04:14,616 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Lemke NW-L 803 WBAAP91090JH89911 ohne Termin.
2025-11-17 12:04:14,624 - ispa_next.appointments.models - DEBUG - Appointment Noel Rapp SÜW-GR 119 WBA2E510X05G52214 ohne Termin.
2025-11-17 12:04:14,632 - ispa_next.appointments.models - DEBUG - Appointment Jan Rudolph NW-JR 1987 WBA5L31000G079266 ohne Termin.
2025-11-17 12:04:14,640 - ispa_next.appointments.models - DEBUG - Appointment Theberio Covaci RP-TA 108 WBAPB11020WE43180 ohne Termin.
2025-11-17 12:04:14,648 - ispa_next.appointments.models - DEBUG - Appointment Stefan Ebeling NW-GZ 4 WBAHF11080WW82481 ohne Termin.
2025-11-17 12:04:14,656 - ispa_next.appointments.models - DEBUG - Appointment Günther Werner Taube DÜW-GT 11 WBACV610X09D54605 ohne Termin.
2025-11-17 12:04:14,664 - ispa_next.appointments.models - DEBUG - Appointment Christiane Drewes-Wright NW-CD 23 WBAUL91040VF72459 ohne Termin.
2025-11-17 12:04:14,672 - ispa_next.appointments.models - DEBUG - Appointment Sabine Gallina-Zabilski SÜW-SG 67 WBADV710X0E533595 ohne Termin.
2025-11-17 12:04:14,680 - ispa_next.appointments.models - DEBUG - Appointment Hannelore Jung NW-H 778 WBAVF51000VF82703 ohne Termin.
2025-11-17 12:04:14,685 - ispa_next.main - DEBUG - Found 2 out of 17 appointments to process (configured limit: 15).
2025-11-17 12:04:14,685 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-17 12:04:14,685 - ispa_next.main - DEBUG - All appointments: GER-FI888, NW-H 1003
2025-11-17 12:04:14,688 - ispa_next.main - DEBUG - 



2025-11-17 12:04:14,688 - ispa_next.main - DEBUG - starting with process 1 (GER-FI888) of 2
2025-11-17 12:04:14,691 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:04:16,129 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:04:17,822 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 848
2025-11-17 12:04:17,823 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 137
2025-11-17 12:04:19,509 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:04:19,510 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:05:08,619 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:05:19,663 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:19,816 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:20,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:21,404 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:05:21,405 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:21,518 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:05:21,820 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:05:30,182 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:05:30,185 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:05:33,021 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:05:33,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:05:34,462 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:05:36,501 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:05:36,667 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:05:39,994 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:05:40,146 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:05:40,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:05:41,664 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:05:53,544 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:05:54,547 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:05:54,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:05:55,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:07,283 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 12:06:07,284 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 12:06:15,813 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:06:15,816 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:06:15,910 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:06:15,911 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:06:16,020 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:06:17,407 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 12:06:18,953 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:06:19,349 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:06:23,075 - ispa_next.functions - DEBUG - Updated appointment (AA00025045) customer contact data.
2025-11-17 12:06:23,988 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:06:23,990 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:06:25,026 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:06:25,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:06:25,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:06:29,493 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:06:29,494 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:06:30,041 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:06:32,043 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:06:32,271 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:06:32,391 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:06:32,507 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:06:32,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:33,914 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:06:45,795 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:06:53,573 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:06:53,574 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:06:54,835 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:06:59,059 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:07:00,063 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:07:00,064 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:07:00,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:07:00,237 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:07:04,404 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:07:04,407 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:07:04,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:07:04,536 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:07:04,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:07:05,509 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:07:05,510 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:07:06,281 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:07:06,282 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:07:07,649 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:07:07,651 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:07:08,834 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:07:08,835 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:07:08,838 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 12:07:08,840 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 12:07:08,841 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeugoberwäsche und Aussaugen, source=from_tab, target=cart)}
2025-11-17 12:07:08,842 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:07:08,845 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:07:08,846 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 12:07:08,847 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:07:08,849 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:07:08,851 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:07:08,853 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:07:08,855 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:07:08,857 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:07:09,666 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:07:10,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:07:16,514 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:07:16,517 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:07:16,533 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:07:16,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:18,887 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:07:18,889 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:07:18,891 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:20,873 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:07:20,874 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:07:20,875 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:07:21,521 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:07:21,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:07:31,302 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:07:31,304 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:07:45,248 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:07:45,764 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:07:46,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:07:46,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:08:05,683 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:08:12,644 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:08:12,648 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:08:12,649 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:08:14,240 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:08:14,374 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:08:14,375 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:08:17,608 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:08:32,452 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:08:32,855 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 12:08:34,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:08:35,079 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 848
2025-11-17 12:08:35,080 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:08:38,694 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 290
2025-11-17 12:08:38,695 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:08:39,715 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
2025-11-17 12:08:39,723 - ispa_next.main - DEBUG - 



2025-11-17 12:08:39,724 - ispa_next.main - DEBUG - starting with process 2 (NW-H 1003) of 2
2025-11-17 12:08:39,728 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:08:41,255 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:08:43,067 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 848
2025-11-17 12:08:43,068 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 290
2025-11-17 12:08:44,908 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 12:08:44,910 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:09:21,553 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 12:09:32,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:33,049 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:33,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:34,698 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 12:09:34,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:09:34,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:09:35,108 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 12:09:43,588 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 12:09:43,591 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 12:09:46,457 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:09:46,459 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:09:47,902 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:09:49,906 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:09:50,060 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:09:53,321 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:09:53,511 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:09:53,512 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:09:54,967 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:10:07,106 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 12:10:08,111 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 12:10:08,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:08,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:25,884 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 12:10:34,653 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 12:10:34,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:10:34,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 12:10:34,799 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 12:10:34,889 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 12:10:36,328 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 12:10:36,835 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 12:10:40,599 - ispa_next.functions - DEBUG - Updated appointment (AD00018593) customer contact data.
2025-11-17 12:10:41,542 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 12:10:41,577 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 12:10:42,516 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 12:10:42,517 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 12:10:43,416 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 12:10:48,022 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 12:10:48,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:10:48,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:10:50,755 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 12:10:50,885 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 12:10:51,039 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 12:10:51,119 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 12:10:51,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:10:53,239 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 12:11:04,225 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 12:11:11,838 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 12:11:11,840 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:13,847 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 12:11:18,094 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 12:11:19,102 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 12:11:19,103 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 12:11:19,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:19,197 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:11:23,380 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 12:11:23,384 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 12:11:23,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:23,461 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 12:11:23,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:24,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 12:11:24,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 12:11:25,345 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 12:11:25,348 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 12:11:27,372 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 12:11:27,393 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 12:11:28,619 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 12:11:28,620 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:11:28,623 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben vorn auf min. Stärke prüfe: placement requirements not met
2025-11-17 12:11:28,624 - ispa_next.package_manager.main - DEBUG - Cannot place Bremsscheiben hinten auf min. Stärke pr.: placement requirements not met
2025-11-17 12:11:28,625 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeugoberwäsche und Aussaugen, source=from_tab, target=cart)}
2025-11-17 12:11:28,626 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 12:11:28,630 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 12:11:28,631 - ispa_next.package_manager.main - DEBUG - Cannot place BMW Sicher in den Winter.Relax. We care.: placement requirements not met
2025-11-17 12:11:28,632 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 12:11:28,633 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 12:11:28,636 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 12:11:28,637 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 12:11:28,640 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 12:11:28,642 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 12:11:29,450 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 12:11:30,219 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 12:11:36,543 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 12:11:36,546 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 12:11:36,547 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 12:11:36,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:39,230 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 12:11:39,231 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 12:11:39,233 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:11:41,885 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 12:11:41,887 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 12:11:41,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 12:11:42,843 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 12:11:42,896 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 12:11:42,897 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 12:11:55,588 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 12:11:56,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:11:56,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 12:11:56,769 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 12:12:22,505 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:12:27,486 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:12:33,168 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:12:33,171 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:12:33,172 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:12:33,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:12:34,093 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:12:34,095 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:12:36,404 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 12:12:47,311 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:12:47,716 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 12:12:49,206 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:12:49,826 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 849
2025-11-17 12:12:49,828 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:12:53,599 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 291
2025-11-17 12:12:53,602 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 12:12:54,540 - ispa_next.appointments.models - DEBUG - Appointment RULAND Engineering Ruland Engi Ruland Engineering NW-RE 14 WBA6W910305P73086 ohne Termin.
2025-11-17 12:12:54,553 - ispa_next.appointments.models - DEBUG - Appointment Barbara Brödel PS-BB 232 WBA21BX0507L93456 ohne Termin.
