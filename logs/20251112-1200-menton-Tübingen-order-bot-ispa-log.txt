2025-11-12 12:07:31,659 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 12:07:31,666 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 12:07:41,304 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:07:51,528 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:08:07,102 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:10:05,203 - ispa_next.app_start.main - DEBUG - Operation already took 106.68 seconds (more than 80 seconds)
2025-11-12 12:10:07,256 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_ucc9zqx2_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_ucc9zqx2', 'txt']
2025-11-12 12:10:07,553 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:10:07,557 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:10:07,558 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:12:07,196 - ispa_next.app_start.main - DEBUG - Operation already took 107.38 seconds (more than 80 seconds)
2025-11-12 12:12:09,252 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_p0we0jpw_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_p0we0jpw', 'txt']
2025-11-12 12:12:09,491 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:12:09,495 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:12:15,957 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 12:12:25,216 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:12:35,562 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:12:51,148 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:14:49,569 - ispa_next.app_start.main - DEBUG - Operation already took 107.33 seconds (more than 80 seconds)
2025-11-12 12:14:51,626 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_0egi0mt6_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_0egi0mt6', 'txt']
2025-11-12 12:14:51,852 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:14:51,856 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:14:51,857 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:16:51,935 - ispa_next.app_start.main - DEBUG - Operation already took 107.81 seconds (more than 80 seconds)
2025-11-12 12:16:54,000 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_2jmuijre_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\6466b6612430bf35\\tess_2jmuijre', 'txt']
2025-11-12 12:16:54,218 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 12:16:54,222 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 12:17:00,543 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-12 12:17:08,046 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 12:17:19,206 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 12:17:34,901 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 12:17:59,269 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 12:18:10,626 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 12:18:13,549 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:14,947 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 678
2025-11-12 12:18:14,949 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 259
2025-11-12 12:18:17,550 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 190
2025-11-12 12:18:17,550 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 12:18:17,551 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:18,939 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 12:18:20,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:18:47,201 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:47,214 - ispa_next.appointments.models - DEBUG - Appointment Herr Gunter Rieger TÜ-DG 1415 WBA5K31070G277653 ohne Termin.
2025-11-12 12:18:47,225 - ispa_next.appointments.models - DEBUG - Appointment Herr Klaus Friedl TÜ-XX 1226 WBAUS31070A834463 ohne Termin.
2025-11-12 12:18:47,225 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:47,256 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 12:18:47,308 - ispa_next.main - DEBUG - Found 13 out of 79 appointments to process (configured limit: 15).
2025-11-12 12:18:47,308 - ispa_next.main - DEBUG - Processing 7 fresh appointments.
2025-11-12 12:18:47,309 - ispa_next.main - DEBUG - Processing 6 already visited appointments (w/ RKR not callable).
2025-11-12 12:18:47,309 - ispa_next.main - DEBUG - All appointments: TÜ-BB 4313, TÜ-GA 52, TÜ-H 1848, TÜ-RE 2227, RT-SF 444, TÜ JB 1122, TÜ-E 789 E, TÜ-SV 337, ES-MY 600 E, TÜ-PS 2101, TÜ-NB 9186, TÜ-MJ 1316, TÜ-TE 247
2025-11-12 12:18:47,312 - ispa_next.main - DEBUG - 



2025-11-12 12:18:47,312 - ispa_next.main - DEBUG - starting with process 1 (TÜ-BB 4313) of 13
2025-11-12 12:18:47,317 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:18:48,533 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:18:49,924 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 678
2025-11-12 12:18:49,925 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 190
2025-11-12 12:18:51,420 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:18:51,422 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:19:19,429 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:19:28,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:19:33,042 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:19:33,043 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:33,105 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:19:33,279 - ispa_next.functions - DEBUG - HU date already expired after 2 days.
2025-11-12 12:19:40,331 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:19:40,334 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:19:43,000 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:19:43,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:19:44,161 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:19:46,164 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:19:46,334 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:19:49,634 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:19:49,737 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:19:53,950 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:19:54,974 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:19:54,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:19:55,493 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:05,631 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:20:12,519 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:20:12,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:12,624 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:20:12,625 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:20:12,666 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:20:13,945 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:20:14,212 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:20:18,100 - ispa_next.functions - DEBUG - Updated appointment (AC00054740) customer contact data.
2025-11-12 12:20:19,007 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:20:19,009 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:20:19,906 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:20:19,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:20:20,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:20:24,236 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:20:24,236 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:20:24,239 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:20:24,240 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:20:24,241 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:24,777 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:28,960 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:20:28,964 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:20:28,964 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:29,047 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:20:29,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:30,028 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:20:30,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:20:30,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:20:30,740 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:20:35,029 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:20:35,031 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:20:35,938 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:20:35,939 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:35,941 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:20:35,941 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:20:35,942 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:20:35,943 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:20:35,944 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:20:35,945 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:20:35,946 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:20:35,947 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:20:35,948 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:20:35,952 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:20:35,953 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:20:35,955 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:40,513 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:20:40,514 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:45,128 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:20:45,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:20:46,531 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:20:46,533 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:51,095 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:20:51,098 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:20:51,100 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:20:51,102 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:20:55,687 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:21:07,409 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:21:07,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:08,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:21:08,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:21:17,368 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:23,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:27,014 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:21:33,043 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:21:33,044 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:33,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:21:33,938 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:21:33,940 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:21:38,187 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:21:48,107 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:21:48,505 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 12:21:48,900 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:50,071 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 678
2025-11-12 12:21:50,072 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:53,259 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 259
2025-11-12 12:21:53,260 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:21:54,087 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:21:54,098 - ispa_next.appointments.models - DEBUG - Appointment Herr Patrick Ott RT-P 6696 WBA2H310X0VF57986 ohne Termin.
2025-11-12 12:21:54,106 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 12:21:54,113 - ispa_next.main - DEBUG - 



2025-11-12 12:21:54,113 - ispa_next.main - DEBUG - starting with process 2 (TÜ-GA 52) of 13
2025-11-12 12:21:54,117 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:21:55,488 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:21:56,776 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 678
2025-11-12 12:21:56,777 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 259
2025-11-12 12:21:58,327 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:21:58,329 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:22:21,832 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:22:31,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:31,249 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:31,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:34,827 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:22:34,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:22:34,903 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:22:35,233 - ispa_next.functions - DEBUG - HU date already expired after 26 days.
2025-11-12 12:22:42,131 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:22:42,134 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:22:44,862 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:22:44,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:22:45,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:22:47,985 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:22:48,092 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:22:51,309 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:22:51,386 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:22:51,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:22:54,664 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:23:03,141 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:23:04,156 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:23:04,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:04,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:16,148 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:23:23,935 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:23:23,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:23:24,041 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:23:24,042 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:23:24,075 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:23:25,318 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:23:26,413 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:23:26,633 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:23:28,650 - ispa_next.functions - DEBUG - Updated appointment (AC00054738) customer contact data.
2025-11-12 12:23:29,591 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:23:29,593 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:23:30,683 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:23:30,684 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:23:31,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:23:35,459 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 12:23:35,460 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:23:35,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:23:36,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:23:38,025 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:23:38,138 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:23:38,286 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:23:38,357 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:23:38,359 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:23:41,770 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:23:53,263 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 12:23:58,814 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:23:58,815 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:04,186 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-12 12:24:06,079 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:24:10,790 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:24:11,797 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:24:11,798 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:24:11,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:11,878 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:24:16,012 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:24:16,834 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:24:31,991 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:24:31,992 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:32,307 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:24:36,167 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:36,712 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:24:36,713 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:24:37,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:24:37,653 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:24:41,108 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:24:41,114 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:24:43,750 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:24:43,755 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:24:43,757 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:24:43,759 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:24:43,761 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:24:43,783 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:24:43,785 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:24:43,788 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:24:43,790 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:24:43,792 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:24:43,794 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:24:43,809 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:24:43,811 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:24:43,812 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:47,224 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:24:47,226 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:50,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:24:51,525 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:24:52,697 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:24:52,701 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:56,017 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:24:56,019 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:24:56,020 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:24:56,024 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:24:59,326 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:25:14,137 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:25:14,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:25:15,496 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:25:15,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:25:24,606 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:30,081 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:35,878 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:41,799 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:25:41,801 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:25:41,802 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:25:42,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:25:42,997 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:25:42,999 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:25:45,937 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:25:58,227 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:25:58,597 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 12:25:59,195 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:01,948 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 678
2025-11-12 12:26:01,951 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:06,678 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 259
2025-11-12 12:26:06,679 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:07,940 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:26:07,950 - ispa_next.appointments.models - DEBUG - Appointment Herr Patrick Ott RT-P 6696 WBA2H310X0VF57986 ohne Termin.
2025-11-12 12:26:07,961 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 12:26:07,970 - ispa_next.main - DEBUG - 



2025-11-12 12:26:07,970 - ispa_next.main - DEBUG - starting with process 3 (TÜ-H 1848) of 13
2025-11-12 12:26:07,974 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:26:09,606 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:26:11,050 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 678
2025-11-12 12:26:11,052 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 259
2025-11-12 12:26:12,920 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:26:12,922 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:26:44,671 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:26:57,120 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:27:02,418 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:27:02,419 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:02,507 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:27:02,884 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:27:02,887 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:27:06,007 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:06,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:07,495 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:27:09,500 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:27:09,691 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:27:13,055 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:27:13,170 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:27:17,415 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:27:18,420 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:27:18,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:18,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:32,413 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 12:27:42,796 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:27:42,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:27:42,902 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:27:42,903 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:27:43,013 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:27:44,380 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:27:45,886 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:27:46,110 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:27:50,077 - ispa_next.functions - DEBUG - Updated appointment (AC00054735) customer contact data.
2025-11-12 12:27:51,032 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:27:51,034 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:27:52,521 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:27:52,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:27:53,586 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:27:57,202 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:27:57,202 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:27:57,206 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:27:57,208 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:27:57,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:27:57,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:01,930 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:28:03,335 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:28:14,772 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:28:14,773 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:14,899 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:28:22,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:23,464 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:28:23,464 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:24,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:28:24,252 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:28:29,021 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:28:29,025 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:28:30,530 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:28:30,531 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:28:30,533 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:28:30,534 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:28:30,535 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:28:30,537 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:28:30,538 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:28:30,539 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:28:30,541 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:28:30,542 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:28:30,544 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:28:30,547 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:28:30,549 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:28:30,550 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:36,523 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:28:36,524 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:41,890 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:28:42,858 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:28:44,121 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:28:44,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:28:49,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:28:50,029 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:29:00,681 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:29:00,683 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:29:00,685 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:29:00,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:06,093 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:29:26,191 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:29:27,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:29:28,112 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:29:28,366 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:29:39,707 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:29:44,992 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:29:52,361 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:29:52,362 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:29:53,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:29:53,538 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:29:53,540 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:29:59,167 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:30:12,662 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:30:13,032 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 12:30:14,071 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:30:16,621 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-12 12:30:16,622 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:30:20,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 260
2025-11-12 12:30:20,828 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:30:22,110 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:30:22,121 - ispa_next.appointments.models - DEBUG - Appointment Herr Patrick Ott RT-P 6696 WBA2H310X0VF57986 ohne Termin.
2025-11-12 12:30:22,131 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 12:30:22,135 - ispa_next.main - DEBUG - 



2025-11-12 12:30:22,135 - ispa_next.main - DEBUG - starting with process 4 (TÜ-RE 2227) of 13
2025-11-12 12:30:22,140 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:30:23,781 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:30:25,187 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-12 12:30:25,188 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 260
2025-11-12 12:30:27,110 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:30:27,112 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:03,156 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:31:03,241 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 12:31:03,245 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:04,177 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-12 12:31:04,180 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:08,183 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 260
2025-11-12 12:31:08,184 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:09,310 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:31:09,320 - ispa_next.appointments.models - DEBUG - Appointment Herr Patrick Ott RT-P 6696 WBA2H310X0VF57986 ohne Termin.
2025-11-12 12:31:09,332 - ispa_next.appointments.models - DEBUG - Appointment Herr Josua Grauer TÜ-JG 1973 WBA4T11050PX69403 ohne Termin.
2025-11-12 12:31:09,336 - ispa_next.main - DEBUG - 



2025-11-12 12:31:09,336 - ispa_next.main - DEBUG - starting with process 5 (RT-SF 444) of 13
2025-11-12 12:31:09,340 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:31:11,102 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:31:12,616 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 679
2025-11-12 12:31:12,617 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 260
2025-11-12 12:31:14,524 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:31:14,526 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:31:45,024 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:31:58,403 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:32:03,695 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:32:03,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:03,804 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:32:04,112 - ispa_next.functions - DEBUG - HU date soon to be invalid in 74 days.
2025-11-12 12:32:13,758 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:32:13,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:13,877 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:32:22,622 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:32:25,959 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:32:25,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:32:27,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:32:29,299 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:32:29,479 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:32:32,781 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:32:32,855 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:32:32,857 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:32:38,397 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:32:47,531 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 12:32:48,536 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:32:48,537 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:32:49,087 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:04,652 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:33:04,652 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-12 12:33:14,882 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:33:14,884 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:33:14,999 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:33:15,000 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:33:15,055 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:33:15,288 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:33:16,671 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:33:16,902 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:33:20,106 - ispa_next.functions - DEBUG - Updated appointment (AB00066331) customer contact data.
2025-11-12 12:33:21,010 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:33:21,015 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:33:21,256 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:33:22,119 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:33:23,750 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:33:23,751 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:33:23,846 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:33:27,448 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:33:27,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:33:27,932 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:33:29,935 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:33:30,109 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:33:30,261 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:33:30,352 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 12:33:30,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:33:35,869 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:33:44,628 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 12:34:44,630 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 12:34:56,536 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 12:35:01,554 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 12:35:01,555 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:07,190 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:35:11,473 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 12:35:12,480 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:35:12,482 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:35:12,483 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:12,601 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:35:16,756 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 12:35:17,714 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 12:35:28,764 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:35:28,765 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:28,849 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:35:29,265 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:29,770 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:35:29,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:35:30,591 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:35:30,591 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:35:35,384 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:35:35,397 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:35:37,157 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:35:37,158 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:35:37,160 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Wischerblätter Leasing, source=from_tab, target=cart)}
2025-11-12 12:35:37,161 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:35:37,163 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:35:37,165 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:35:37,180 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:35:37,182 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:35:37,183 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:35:37,186 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:35:37,189 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 12:35:37,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 12:35:38,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 12:35:46,778 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 12:35:46,780 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:35:46,782 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:35:46,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:52,975 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:35:52,976 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:35:58,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:35:59,854 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:36:00,783 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:36:00,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:06,827 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:36:07,340 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:36:16,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:34,986 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:36:34,988 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:36:34,990 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:36:34,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:36:41,201 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:37:01,004 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:37:01,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:02,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:37:02,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:37:15,238 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:37:22,063 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:37:30,920 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:37:30,921 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:37:32,052 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:37:32,147 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:37:32,149 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:37:37,536 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:37:49,759 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:37:50,152 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 12:37:51,234 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:37:53,610 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-12 12:37:53,611 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:37:58,071 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 12:37:58,074 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:37:59,334 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:37:59,339 - ispa_next.main - DEBUG - 



2025-11-12 12:37:59,339 - ispa_next.main - DEBUG - starting with process 6 (TÜ JB 1122) of 13
2025-11-12 12:37:59,343 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:01,265 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:02,986 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-12 12:38:02,988 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 12:38:05,335 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:05,337 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:42,928 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 12:38:42,940 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 12:38:42,945 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:43,805 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-12 12:38:43,807 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:48,653 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 263
2025-11-12 12:38:48,653 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:38:49,897 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:38:49,903 - ispa_next.main - DEBUG - 



2025-11-12 12:38:49,903 - ispa_next.main - DEBUG - starting with process 7 (TÜ-E 789 E) of 13
2025-11-12 12:38:49,907 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:38:51,299 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:38:52,681 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 682
2025-11-12 12:38:52,682 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 263
2025-11-12 12:38:54,625 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:38:54,626 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:22,999 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:39:36,548 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:39:40,532 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:39:40,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:39:40,644 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:39:40,962 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:39:40,965 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:39:44,033 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:39:44,035 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:39:44,399 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-12 12:39:44,709 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\Users\Bot\AppData\Local\robocorp\holotree\220eddf_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 74, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-12 12:39:44,729 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:39:44,730 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:39:45,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:39:46,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:39:46,704 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 12:39:46,734 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 12:39:49,969 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 12:39:49,973 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:39:52,630 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:39:52,631 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:39:56,897 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:39:56,898 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:39:57,829 - ispa_next.appointments.models - DEBUG - Appointment Firma Guido Buchwald RT-SB 513 WBACY810509P94568 ohne Termin.
2025-11-12 12:39:57,840 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:39:57,844 - ispa_next.main - DEBUG - 



2025-11-12 12:39:57,844 - ispa_next.main - DEBUG - starting with process 8 (TÜ-SV 337) of 13
2025-11-12 12:39:57,847 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:39:59,190 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:40:00,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:40:00,645 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:40:02,730 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:40:02,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:40:40,945 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:40:43,837 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:40:50,705 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:40:53,353 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:40:53,353 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:40:53,455 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:40:53,843 - ispa_next.functions - DEBUG - HU date soon to be invalid in 40 days.
2025-11-12 12:40:59,871 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:40:59,875 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:41:02,910 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:41:02,913 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:04,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:06,300 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:41:06,492 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:41:06,632 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:41:06,819 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:41:11,062 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:41:12,068 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:41:12,069 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:12,690 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:29,648 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:41:35,520 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:41:35,521 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:35,615 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:41:35,616 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:41:35,659 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:41:35,830 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:41:37,003 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:41:37,224 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:41:39,291 - ispa_next.functions - DEBUG - Updated appointment (AC00054609) customer contact data.
2025-11-12 12:41:40,193 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:41:40,197 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:41:40,499 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:41:41,550 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:41:42,974 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:41:42,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:41:43,097 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:41:46,695 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:41:46,695 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:41:46,698 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:41:46,699 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:41:46,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:47,215 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:51,408 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:41:51,413 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:41:51,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:51,502 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:41:51,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:52,413 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:41:52,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:41:53,191 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:41:53,191 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:41:55,720 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:41:55,722 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:41:58,537 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:41:58,538 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:58,543 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:41:58,550 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:41:58,552 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:41:58,557 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:41:58,558 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:41:58,560 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:41:58,561 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:41:58,565 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:41:58,567 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:41:58,576 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:41:58,577 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:41:58,578 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:01,329 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:42:01,330 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:03,940 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:42:04,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:42:05,575 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:42:05,577 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:08,155 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:42:08,157 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:42:08,159 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:42:08,161 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:10,659 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:42:27,184 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:42:27,808 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:42:28,528 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:42:28,813 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:42:37,090 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:42:42,670 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:42:48,875 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:42:48,877 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:42:48,878 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:42:49,937 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:42:50,053 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:42:50,054 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:42:52,870 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:43:05,080 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:43:05,462 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-12 12:43:06,024 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:08,881 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:43:08,882 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:13,601 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:43:13,603 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:43:14,807 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:43:14,811 - ispa_next.main - DEBUG - Found new Appointment: RT-SB 513
2025-11-12 12:43:14,813 - ispa_next.main - DEBUG - 



2025-11-12 12:43:14,813 - ispa_next.main - DEBUG - starting with process 9 (RT-SB 513) of 14
2025-11-12 12:43:14,816 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:43:16,266 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:43:18,053 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:43:18,054 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:43:20,131 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:43:20,132 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:44:02,851 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:44:15,823 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:44:19,138 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:44:19,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:19,279 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:44:19,706 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:44:29,471 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:44:29,475 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:44:32,813 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:44:32,815 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:44:34,530 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:44:36,533 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:44:36,707 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:44:40,051 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:44:40,184 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:44:44,406 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:44:45,411 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:44:45,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:45,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:44:59,854 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:45:08,241 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:45:08,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:08,320 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:45:08,321 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:45:08,403 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:45:09,703 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:45:10,876 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:45:11,078 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:45:13,841 - ispa_next.functions - DEBUG - Updated appointment (AC00054746) customer contact data.
2025-11-12 12:45:14,776 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:45:14,777 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:45:15,850 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:45:15,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:45:16,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:45:20,891 - ispa_next.functions - DEBUG - Non-dealer number in configured list
2025-11-12 12:45:20,891 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:45:20,892 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:45:20,894 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:45:20,895 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:45:20,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:21,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:25,719 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:45:25,730 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:45:25,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:25,822 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:45:31,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:31,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:45:31,893 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:45:32,741 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:45:32,741 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:45:35,861 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:45:35,863 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:45:37,246 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:45:37,247 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:37,249 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:45:37,250 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:45:37,251 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:45:37,252 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:45:37,253 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:45:37,260 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:45:37,263 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:45:37,266 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:45:37,269 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:45:37,272 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:45:37,274 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:45:37,275 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:40,630 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-12 12:45:43,501 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:45:43,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:47,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:45:47,937 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:45:48,944 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:45:48,948 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:52,269 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:45:52,271 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:45:52,272 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:45:52,274 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:45:55,643 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:46:12,842 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:46:13,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:46:14,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:46:14,248 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:46:23,797 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:46:29,911 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:46:37,876 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:46:37,877 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:46:38,915 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:46:39,013 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:46:39,015 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:46:44,744 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 12:46:57,578 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:46:57,960 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-12 12:46:58,438 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:47:01,288 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:47:01,294 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:47:05,963 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:47:05,964 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:47:07,240 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:47:07,244 - ispa_next.main - DEBUG - 



2025-11-12 12:47:07,244 - ispa_next.main - DEBUG - starting with process 10 (ES-MY 600 E) of 14
2025-11-12 12:47:07,248 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:47:09,096 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:47:10,639 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:47:10,641 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:47:12,902 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:47:12,904 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:47:45,875 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:47:48,833 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:47:55,677 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:47:58,392 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:47:58,393 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:47:58,497 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:47:58,835 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:48:04,471 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:48:04,473 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:48:07,493 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:48:07,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:48:08,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:48:10,734 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:48:10,885 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:48:11,013 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:48:11,127 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:48:15,340 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:48:16,347 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:48:16,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:48:16,849 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:48:32,243 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:48:38,347 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:48:38,348 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:48:38,438 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:48:38,439 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:48:38,499 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:48:40,088 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:48:41,844 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:48:42,069 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:48:44,076 - ispa_next.functions - DEBUG - Updated appointment (AC00054663) customer contact data.
2025-11-12 12:48:44,994 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:48:45,003 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:48:46,424 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:48:46,426 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:48:47,523 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:48:51,629 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:48:51,629 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:48:51,631 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:48:51,632 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:48:51,633 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:48:52,174 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:48:56,373 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:48:56,379 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:48:56,380 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:48:56,469 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:49:02,274 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:02,823 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:49:02,824 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:49:03,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:49:03,710 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:49:06,329 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:49:06,331 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:49:08,239 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:49:08,241 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:49:08,243 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:49:08,244 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:49:08,246 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:49:08,248 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:49:08,249 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:49:08,267 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:49:08,270 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:49:08,273 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:49:08,277 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:49:08,279 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:49:08,280 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:10,881 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:49:10,882 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:13,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:49:14,503 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:49:15,605 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:49:15,608 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:18,314 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:49:18,324 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:49:18,326 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:49:18,329 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:20,943 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:49:37,196 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:49:37,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:49:38,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:49:38,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:49:47,251 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:53,045 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:59,234 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:49:59,237 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:49:59,237 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:50:00,248 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:50:00,326 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:50:00,328 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:50:02,607 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:50:14,105 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:50:14,490 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-12 12:50:15,049 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:50:17,983 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:50:17,985 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:50:22,873 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:50:22,874 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:50:24,134 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:50:24,139 - ispa_next.main - DEBUG - 



2025-11-12 12:50:24,139 - ispa_next.main - DEBUG - starting with process 11 (TÜ-PS 2101) of 14
2025-11-12 12:50:24,145 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:50:26,002 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:50:27,858 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:50:27,860 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:50:30,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:50:30,065 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:51:02,928 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:51:05,749 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:51:12,777 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:51:13,999 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:51:14,000 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:14,105 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:14,484 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:51:14,487 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:51:17,563 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:51:17,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:51:19,173 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:51:21,179 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:51:21,317 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:51:21,451 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:51:21,529 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:51:25,781 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:51:26,787 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:51:26,787 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:27,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:42,779 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:51:49,229 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:51:49,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:51:49,339 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:51:49,340 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:51:49,401 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:51:50,804 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:51:51,015 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:51:53,090 - ispa_next.functions - DEBUG - Updated appointment (AC00054718) customer contact data.
2025-11-12 12:51:53,999 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:51:54,002 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:51:55,803 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:51:55,804 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:51:57,048 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:52:00,658 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:52:00,658 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:52:00,661 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:52:00,662 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:52:00,662 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:01,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:52:05,311 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:52:05,329 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:52:05,330 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:05,419 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:52:05,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:06,310 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:52:06,311 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:52:07,276 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:52:07,277 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:52:08,612 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:52:08,614 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:52:10,188 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:52:10,193 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:52:10,195 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:52:10,197 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:52:10,198 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:52:10,201 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:52:10,202 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:52:10,204 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:52:10,206 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:52:10,207 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:52:10,208 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:52:10,212 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:52:10,214 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:52:10,215 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:11,451 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:52:11,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:12,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:52:13,809 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:52:14,881 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:52:14,884 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:16,134 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:52:16,140 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:52:16,144 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:52:16,148 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:17,378 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:52:34,032 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:52:34,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:52:35,336 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:52:35,626 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:52:42,940 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:52:42,941 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:52:42,942 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:52:43,888 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:52:44,027 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:52:44,029 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:52:46,515 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:52:58,814 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:52:59,208 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-12 12:52:59,830 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:53:02,688 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:53:02,690 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:53:07,402 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:53:07,403 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:53:08,685 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:53:08,690 - ispa_next.main - DEBUG - 



2025-11-12 12:53:08,690 - ispa_next.main - DEBUG - starting with process 12 (TÜ-NB 9186) of 14
2025-11-12 12:53:08,694 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:53:10,607 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:53:12,582 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:53:12,584 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:53:14,967 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:53:14,969 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:53:48,074 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:53:51,364 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:53:58,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:53:59,747 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:53:59,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:53:59,834 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:54:00,229 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 12:54:06,147 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:54:06,150 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:54:09,259 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:54:09,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:10,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:54:12,839 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:54:12,992 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:54:13,171 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:54:13,277 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:54:17,463 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:54:18,469 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:54:18,470 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:18,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:35,999 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 12:54:42,474 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:54:42,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:42,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:54:42,621 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:54:42,677 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:54:44,034 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:54:44,245 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:54:46,818 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:54:46,822 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:54:48,155 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:54:48,155 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:54:49,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:54:53,385 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:54:53,385 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:54:53,388 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:54:53,389 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:54:53,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:53,917 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:54:58,122 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:54:58,128 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:54:58,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:54:58,245 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:54:58,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:59,164 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:54:59,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:55:00,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:55:00,057 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:55:01,400 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:55:01,402 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:55:03,145 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:55:03,148 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:55:03,149 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:55:03,150 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:55:03,152 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:55:03,153 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:55:03,167 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:55:03,170 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:55:03,172 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:55:03,173 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:55:03,174 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:55:03,177 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:55:03,179 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:55:03,179 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:55:04,411 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:55:04,412 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:55:05,679 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:55:06,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:55:07,769 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:55:07,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:55:09,012 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:55:09,014 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:55:09,016 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:55:09,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:55:10,265 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:55:26,800 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:55:27,445 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:55:28,145 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:55:28,431 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:55:35,756 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:55:35,758 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:55:35,759 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:55:36,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:55:36,933 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:55:36,934 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:55:39,830 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:55:52,449 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:55:52,839 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-12 12:55:53,314 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:55:56,444 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:55:56,446 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:56:01,274 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:56:01,275 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:56:02,576 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:56:02,581 - ispa_next.main - DEBUG - 



2025-11-12 12:56:02,581 - ispa_next.main - DEBUG - starting with process 13 (TÜ-MJ 1316) of 14
2025-11-12 12:56:02,585 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:56:04,462 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:56:06,290 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:56:06,291 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:56:08,668 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:56:08,670 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:56:51,296 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:56:54,234 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:57:00,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:57:02,122 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:57:02,122 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:02,256 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:57:02,589 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 12:57:02,592 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 12:57:05,670 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:57:05,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:57:07,316 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:57:09,322 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 12:57:09,502 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 12:57:09,635 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 12:57:09,781 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 12:57:13,992 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 12:57:14,998 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 12:57:14,999 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:15,515 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:30,349 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 12:57:36,709 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 12:57:36,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:36,870 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:57:36,871 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 12:57:36,926 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 12:57:37,125 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 12:57:38,339 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 12:57:38,540 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 12:57:40,599 - ispa_next.functions - DEBUG - Updated appointment (AC00054706) customer contact data.
2025-11-12 12:57:41,520 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 12:57:41,524 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 12:57:41,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:57:43,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 12:57:44,654 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 12:57:44,654 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 12:57:44,762 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 12:57:48,374 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 12:57:48,374 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 12:57:48,377 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 12:57:48,378 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 12:57:48,379 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:57:48,918 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:57:53,086 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 12:57:53,090 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 12:57:53,091 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:57:53,204 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 12:57:53,587 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:54,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 12:57:54,125 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 12:57:54,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 12:57:54,996 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 12:57:56,465 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 12:57:56,473 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 12:57:58,383 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 12:57:58,384 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:57:58,398 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 12:57:58,400 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 12:57:58,401 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 12:57:58,402 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 12:57:58,403 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 12:57:58,410 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 12:57:58,414 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 12:57:58,417 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 12:57:58,419 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 12:57:58,422 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 12:57:58,424 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 12:57:58,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:57:59,636 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 12:57:59,637 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:00,936 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 12:58:02,074 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 12:58:03,188 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 12:58:03,190 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:04,420 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 12:58:04,423 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 12:58:04,425 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 12:58:04,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:05,643 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 12:58:22,218 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 12:58:22,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:58:23,611 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 12:58:23,921 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:58:31,272 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 12:58:31,274 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 12:58:31,275 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:58:32,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 12:58:32,429 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 12:58:32,430 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 12:58:35,318 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 12:58:47,362 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 12:58:47,737 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-12 12:58:48,327 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:58:51,389 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:58:51,391 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 12:58:56,242 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 12:58:56,243 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:58:57,549 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
2025-11-12 12:58:57,554 - ispa_next.main - DEBUG - 



2025-11-12 12:58:57,554 - ispa_next.main - DEBUG - starting with process 14 (TÜ-TE 247) of 14
2025-11-12 12:58:57,558 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 12:58:59,455 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 12:59:01,399 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 12:59:01,400 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 264
2025-11-12 12:59:03,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 12:59:03,835 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 12:59:46,704 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 12:59:49,786 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 12:59:56,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:56,393 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:56,664 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 12:59:57,984 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 12:59:57,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 12:59:58,072 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 12:59:58,508 - ispa_next.functions - DEBUG - HU date already expired after 1306 days.
2025-11-12 13:00:04,298 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 13:00:04,301 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 13:00:07,330 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:00:07,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:00:09,122 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:00:11,128 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 13:00:11,333 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 13:00:11,527 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 13:00:11,712 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 13:00:11,714 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:13,104 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 13:00:24,094 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 13:00:29,122 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 13:00:29,124 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:00:30,446 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 13:00:34,697 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 13:00:35,703 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 13:00:35,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:36,289 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:00:55,042 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 13:01:00,476 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 13:01:00,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:01:00,600 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 13:01:00,601 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 13:01:00,651 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 13:01:00,928 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 13:01:02,282 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 13:01:02,499 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 13:01:05,329 - ispa_next.functions - DEBUG - Updated appointment (AC00054707) customer contact data.
2025-11-12 13:01:06,245 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 13:01:06,247 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 13:01:06,558 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:01:07,836 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 13:01:09,156 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 13:01:09,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 13:01:09,295 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 13:01:13,451 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 13:01:13,451 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 13:01:13,451 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 13:01:13,454 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 13:01:13,455 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 13:01:13,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:01:13,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:01:18,152 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 13:01:18,179 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 13:01:18,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:01:18,280 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 13:01:18,733 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 13:01:19,265 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 13:01:19,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 13:01:20,126 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 13:01:20,127 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 13:01:21,515 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 13:01:21,517 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 13:01:23,406 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 13:01:23,408 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:01:23,412 - ispa_next.package_manager.main - DEBUG - Cannot place Wischerblätter Leasing: placement requirements not met
2025-11-12 13:01:23,414 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 13:01:23,415 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 13:01:23,416 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 13:01:23,417 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 13:01:23,418 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 13:01:23,420 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 13:01:23,421 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 13:01:23,422 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 13:01:23,426 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 13:01:23,428 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 13:01:23,429 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:24,694 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 13:01:24,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:25,916 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Termin
2025-11-12 13:01:27,042 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Termin
2025-11-12 13:01:27,971 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 13:01:27,973 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:29,211 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 13:01:29,212 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 13:01:29,214 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 13:01:29,216 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:30,463 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 13:01:47,030 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 13:01:47,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:01:48,292 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 13:01:48,515 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 13:01:56,133 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 13:01:56,136 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 13:01:56,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 13:01:57,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 13:01:57,472 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 13:01:57,474 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 13:02:00,447 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 13:02:13,479 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 13:02:13,859 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-12 13:02:14,603 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 13:02:17,854 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 683
2025-11-12 13:02:17,856 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 13:02:23,011 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 264
2025-11-12 13:02:23,012 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 13:02:24,393 - ispa_next.appointments.models - DEBUG - Appointment Firma Kemmlit Bauelemente GmbH TÜ-KE 8899 WBA11FL030CV03498 ohne Termin.
