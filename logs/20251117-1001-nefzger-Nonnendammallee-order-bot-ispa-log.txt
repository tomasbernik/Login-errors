2025-11-17 10:01:24,427 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 10:01:24,430 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 10:01:29,712 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 10:01:42,261 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 10:01:57,887 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 10:02:21,862 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 10:02:37,037 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 10:02:41,100 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:02:42,097 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1649
2025-11-17 10:02:42,099 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 868
2025-11-17 10:02:44,280 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 327
2025-11-17 10:02:44,281 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 10:02:44,282 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:45,283 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 10:02:46,266 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:03:37,067 - ispa_next.appointments.models - DEBUG - Appointment Yasemin Bülbül-Miersch LN-ZE22E WBATA610009N27119 ohne Termin.
2025-11-17 10:03:37,100 - ispa_next.appointments.models - DEBUG - Appointment Dirk Silbermann B-DC1869 WBA6S110X07J70542 ohne Termin.
2025-11-17 10:03:37,121 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81DP0709K09211 ohne Termin.
2025-11-17 10:03:37,155 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY41DU070S518688 ohne Termin.
2025-11-17 10:03:37,166 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF51030WY39437 ohne Termin.
2025-11-17 10:03:37,188 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY8P610707H78448 ohne Termin.
2025-11-17 10:03:37,204 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AL0207R09669 ohne Termin.
2025-11-17 10:03:37,215 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW11GD0602W43409 ohne Termin.
2025-11-17 10:03:37,226 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FZ060FN39207 ohne Termin.
2025-11-17 10:03:37,237 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GF0207R57756 ohne Termin.
2025-11-17 10:03:37,248 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW71DH0602W03642 ohne Termin.
2025-11-17 10:03:37,258 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF51030WY39437 ohne Termin.
2025-11-17 10:03:37,272 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81FY080FT52812 ohne Termin.
2025-11-17 10:03:37,293 - ispa_next.appointments.models - DEBUG - Appointment Marie Grysla PM-VX343 WMWYT110303E87434 ohne Termin.
2025-11-17 10:03:37,304 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AV070FR60670 ohne Termin.
2025-11-17 10:03:37,314 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHS910405H66834 ohne Termin.
2025-11-17 10:03:37,328 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0307R96836 ohne Termin.
2025-11-17 10:03:37,348 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA7K310407E93147 ohne Termin.
2025-11-17 10:03:37,362 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAYH110805U65786 ohne Termin.
2025-11-17 10:03:37,380 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AG020CL43319 ohne Termin.
2025-11-17 10:03:37,392 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY41AW090FR07448 ohne Termin.
2025-11-17 10:03:37,419 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAYK910405V31475 ohne Termin.
2025-11-17 10:03:37,435 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51AJ020CK75517 ohne Termin.
2025-11-17 10:03:37,447 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA15BZ070N151888 ohne Termin.
2025-11-17 10:03:37,458 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBS41HK090CU55009 ohne Termin.
2025-11-17 10:03:37,469 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FY000FT70917 ohne Termin.
2025-11-17 10:03:37,480 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GM0305015388 ohne Termin.
2025-11-17 10:03:37,493 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21AT050CG42297 ohne Termin.
2025-11-17 10:03:37,518 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41GV010CW11067 ohne Termin.
2025-11-17 10:03:37,541 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 B-NF6001 WBA11EY0809Y64502 ohne Termin.
2025-11-17 10:03:37,555 - ispa_next.appointments.models - DEBUG - Appointment Milan Knezevic B-MK3467 WBAJF31010WC66496 ohne Termin.
2025-11-17 10:03:37,568 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AL0X07H27110 ohne Termin.
2025-11-17 10:03:37,579 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA55DP000N309942 ohne Termin.
2025-11-17 10:03:37,590 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51BY0007P59464 ohne Termin.
2025-11-17 10:03:37,607 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31EE0605126010 ohne Termin.
2025-11-17 10:03:37,619 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0307U42695 ohne Termin.
2025-11-17 10:03:37,630 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0607U42710 ohne Termin.
2025-11-17 10:03:37,641 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA81GE0607U43565 ohne Termin.
2025-11-17 10:03:37,654 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW21HF0XSTB17405 ohne Termin.
2025-11-17 10:03:37,665 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31EG0905259552 ohne Termin.
2025-11-17 10:03:37,677 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21BX0207P87450 ohne Termin.
2025-11-17 10:03:37,689 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31EG0905259552 ohne Termin.
2025-11-17 10:03:37,702 - ispa_next.appointments.models - DEBUG - Appointment Jörg Eberhard Dr. Priemer B-JP560E WBA61DP0909T07325 ohne Termin.
2025-11-17 10:03:37,723 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAYH110205T09209 ohne Termin.
2025-11-17 10:03:37,737 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY11CF020CK44997 ohne Termin.
2025-11-17 10:03:37,750 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBATY95040N120449 ohne Termin.
2025-11-17 10:03:37,767 - ispa_next.appointments.models - DEBUG - Appointment Wolfgang Kühn B-WK224 WBAJG110005N50089 ohne Termin.
2025-11-17 10:03:37,779 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY71EG0705Z84330 ohne Termin.
2025-11-17 10:03:37,790 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBADZ41070CL17914 ohne Termin.
2025-11-17 10:03:37,801 - ispa_next.appointments.models - DEBUG - Appointment Klaus Bernd Bullerdieck B-MW5635E WBA31EF0605Z06362 ohne Termin.
2025-11-17 10:03:37,812 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 TF-PJ496 WBA11AK0807L55295 ohne Termin.
2025-11-17 10:03:37,824 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21EM0009Y33660 ohne Termin.
2025-11-17 10:03:37,835 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31DT0909W35160 ohne Termin.
2025-11-17 10:03:37,846 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA71AB0805V55325 ohne Termin.
2025-11-17 10:03:37,857 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY41DU010S494419 ohne Termin.
2025-11-17 10:03:37,869 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA25DP020N316149 ohne Termin.
2025-11-17 10:03:37,880 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA28FF0408E59660 ohne Termin.
2025-11-17 10:03:37,894 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 B-CB6060 WBSUR91000VP74965 ohne Termin.
2025-11-17 10:03:37,905 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31BK050CJ72958 ohne Termin.
2025-11-17 10:03:37,917 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY7X41040S014907 ohne Termin.
2025-11-17 10:03:37,937 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF510X0WY41136 ohne Termin.
2025-11-17 10:03:37,950 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA6X110105T79228 ohne Termin.
2025-11-17 10:03:37,966 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY8P610807L39255 ohne Termin.
2025-11-17 10:03:37,978 - ispa_next.appointments.models - DEBUG - Appointment Mirko Baumann  WBA21BY0107R75410 ohne Termin.
2025-11-17 10:03:37,989 - ispa_next.appointments.models - DEBUG - Appointment Andreas Jäger OHV-J3161 WBA61EE0105W16982 ohne Termin.
2025-11-17 10:03:38,000 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA31AA0X05T53666 ohne Termin.
2025-11-17 10:03:38,012 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61DP0209W98902 ohne Termin.
2025-11-17 10:03:38,023 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY21CF080CM28197 ohne Termin.
2025-11-17 10:03:38,034 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA6N31010FM96349 ohne Termin.
2025-11-17 10:03:38,045 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61CM0508E37609 ohne Termin.
2025-11-17 10:03:38,057 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAJG110405N31822 ohne Termin.
2025-11-17 10:03:38,068 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBATR55080ND36569 ohne Termin.
2025-11-17 10:03:38,080 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBS11EC0109U63862 ohne Termin.
2025-11-17 10:03:38,091 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WMW11GD0X02W43686 ohne Termin.
2025-11-17 10:03:38,103 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AV0X0FN27974 ohne Termin.
2025-11-17 10:03:38,122 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA7K310505P86547 ohne Termin.
2025-11-17 10:03:38,137 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA71BX0307P36500 ohne Termin.
2025-11-17 10:03:38,150 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA6S110007K21546 ohne Termin.
2025-11-17 10:03:38,162 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GE0507U23927 ohne Termin.
2025-11-17 10:03:38,173 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAFY61050CU07070 ohne Termin.
2025-11-17 10:03:38,185 - ispa_next.appointments.models - DEBUG - Appointment Serhat Kagitci B-O3404 WBS81CH030CG32149 ohne Termin.
2025-11-17 10:03:38,197 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61DP0909K93670 ohne Termin.
2025-11-17 10:03:38,208 - ispa_next.appointments.models - DEBUG - Appointment ASS Athletic Sport Sponsoring GmbH BO-QX6883 WBA11BZ0609W26323 ohne Termin.
2025-11-17 10:03:38,219 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA58FF0908E61823 ohne Termin.
2025-11-17 10:03:38,230 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBY8P610807L21113 ohne Termin.
2025-11-17 10:03:38,242 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21BX0307L11465 ohne Termin.
2025-11-17 10:03:38,253 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAHF11040WX86479 ohne Termin.
2025-11-17 10:03:38,265 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FL080CS40487 ohne Termin.
2025-11-17 10:03:38,277 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBS11ET0709Y73534 ohne Termin.
2025-11-17 10:03:38,289 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA51CM0808E89909 ohne Termin.
2025-11-17 10:03:38,299 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61DP0909K93670 ohne Termin.
2025-11-17 10:03:38,310 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAJU810909K24494 ohne Termin.
2025-11-17 10:03:38,322 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FY090FT58281 ohne Termin.
2025-11-17 10:03:38,343 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA21GE0907P98025 ohne Termin.
2025-11-17 10:03:38,359 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA25DP010N131980 ohne Termin.
2025-11-17 10:03:38,371 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FY030FT71088 ohne Termin.
2025-11-17 10:03:38,383 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AU090CH53655 ohne Termin.
2025-11-17 10:03:38,394 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41CM0508E30277 ohne Termin.
2025-11-17 10:03:38,406 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11FZ090FT30110 ohne Termin.
2025-11-17 10:03:38,419 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41CM0008E48122 ohne Termin.
2025-11-17 10:03:38,430 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61EE0205Z98343 ohne Termin.
2025-11-17 10:03:38,440 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA41CM0808D25233 ohne Termin.
2025-11-17 10:03:38,452 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA7K310207P36144 ohne Termin.
2025-11-17 10:03:38,464 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBAJU810009R84894 ohne Termin.
2025-11-17 10:03:38,474 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA58FU0308E59679 ohne Termin.
2025-11-17 10:03:38,487 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA61CA0909P80872 ohne Termin.
2025-11-17 10:03:38,497 - ispa_next.appointments.models - DEBUG - Appointment R-Projekt FN Verwaltung GmbH HG-VS225 WBA2A71060VZ32541 ohne Termin.
2025-11-17 10:03:38,509 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBATA610309H05351 ohne Termin.
2025-11-17 10:03:38,526 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2  WBA11AU090CH53655 ohne Termin.
2025-11-17 10:03:38,540 - ispa_next.appointments.models - DEBUG - Appointment Intern Betrieb 2 B-DI2920 WBA7N510X07P81318 ohne Termin.
2025-11-17 10:03:38,604 - ispa_next.main - DEBUG - Found 15 out of 94 appointments to process (configured limit: 15).
2025-11-17 10:03:38,604 - ispa_next.main - DEBUG - Processing 15 fresh appointments.
2025-11-17 10:03:38,604 - ispa_next.main - DEBUG - All appointments: B - KP 560E, B-KI9900, B-LM9984, OHV-PL30, B MH 1918, B KL 2475 E, 0 34 16, BLKKP32, B-As 1250, B- SH7750, B-MW 8129, B SB4307, B AI6675, PM EX 440, M MM 3386E
2025-11-17 10:03:38,608 - ispa_next.main - DEBUG - 



2025-11-17 10:03:38,608 - ispa_next.main - DEBUG - starting with process 1 (B - KP 560E) of 15
2025-11-17 10:03:38,611 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:03:39,570 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:03:40,535 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1649
2025-11-17 10:03:40,536 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 327
2025-11-17 10:03:42,007 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:03:42,009 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:04:13,347 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:04:22,422 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:24,287 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:04:24,288 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:24,381 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:04:24,607 - ispa_next.functions - DEBUG - HU date soon to be invalid in 3 days.
2025-11-17 10:04:31,057 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:04:31,061 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:04:33,812 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:04:33,813 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:04:34,929 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:04:36,933 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:04:37,071 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:04:40,308 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:04:40,409 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:04:40,411 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:04:41,635 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:04:52,877 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:04:53,882 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:04:53,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:54,389 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:04:57,416 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:04:57,421 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:04:57,423 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:04:57,429 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:04:58,018 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:04:58,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:04:58,647 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:05:02,641 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:05:02,642 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:05:02,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:05:03,113 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:05:05,116 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:05:05,259 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:05:05,394 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:05:05,482 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:05:05,484 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:05:06,675 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:05:17,771 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:06:17,773 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:06:29,197 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:06:36,223 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:06:36,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:06:37,415 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:06:41,608 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:06:42,614 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:06:42,614 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:06:42,615 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:42,704 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:06:46,857 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:06:46,862 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:06:46,863 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:46,936 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:06:52,403 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:52,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:06:52,900 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:06:53,639 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:06:53,642 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:06:54,915 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:06:54,916 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:06:55,822 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:06:55,823 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:55,828 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:06:55,829 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:06:55,839 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:06:55,840 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 10:06:55,841 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:06:55,845 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:06:55,846 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:06:55,850 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:06:55,852 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:06:56,544 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:06:57,182 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:07:05,873 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:07:05,876 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:07:05,878 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:07:05,879 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:07,804 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:07:07,807 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:07:07,809 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:09,657 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:07:09,659 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:07:09,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:07:10,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:07:10,272 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:13,488 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:07:13,493 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:15,329 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:07:25,732 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:07:26,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:26,689 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:07:26,872 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:07:32,698 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:37,713 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:07:37,717 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:07:37,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:38,297 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:07:38,390 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:07:38,394 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:07:40,114 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:07:50,138 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:07:50,528 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 10:07:51,594 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:53,016 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1651
2025-11-17 10:07:53,017 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:07:56,063 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:07:56,064 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:07:56,912 - ispa_next.appointments.models - DEBUG - Appointment Nissen Hotelbetriebs GmbH B-VN5000E WBATA610409K70918 ohne Termin.
2025-11-17 10:07:56,930 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:07:56,943 - ispa_next.main - DEBUG - 



2025-11-17 10:07:56,943 - ispa_next.main - DEBUG - starting with process 2 (B-KI9900) of 15
2025-11-17 10:07:56,948 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:07:57,974 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:07:59,005 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1651
2025-11-17 10:07:59,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:08:00,515 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:08:00,517 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:08:27,023 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:08:36,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:36,512 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:36,695 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:39,897 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:08:39,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:08:40,005 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:08:40,224 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:08:40,227 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:08:43,022 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:08:43,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:08:44,353 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:08:46,357 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:08:46,477 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:08:49,720 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:08:49,806 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:08:49,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:08:53,135 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:09:04,400 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:09:05,405 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:09:05,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:05,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:09:18,075 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:09:25,363 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:09:25,365 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:09:25,368 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:09:26,023 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:09:26,023 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:09:26,735 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:09:30,353 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:09:30,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:09:30,815 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:09:32,819 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:09:32,954 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:09:33,074 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:09:33,180 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:09:33,182 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:36,400 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:09:47,171 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:09:54,338 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:09:54,340 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:09:57,626 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:10:01,825 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:10:02,831 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:10:02,831 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:10:02,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:02,910 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:10:07,075 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:10:07,739 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:10:23,521 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:10:23,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:23,637 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:10:29,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:29,703 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:10:29,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:10:30,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:10:30,580 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:10:33,569 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:10:33,572 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:10:34,898 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:10:34,900 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:10:34,904 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:10:34,905 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:10:34,909 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:10:34,910 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:10:34,912 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:10:34,916 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:10:34,918 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:10:34,924 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:10:34,935 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:10:35,637 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:10:36,927 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:10:46,654 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:10:46,655 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:10:47,356 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:10:47,466 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:10:56,309 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:10:56,312 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:10:56,314 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:10:56,315 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:00,221 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 10:11:05,490 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:11:05,555 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:11:05,557 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:09,592 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:11:09,594 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:11:09,595 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:11:10,203 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:11:10,554 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:34,072 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:11:34,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:11:37,998 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:11:53,427 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:11:54,006 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:11:54,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:11:54,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:12:06,635 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:12:14,351 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:12:22,203 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:12:32,015 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:12:40,549 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:12:40,552 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:12:40,553 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:12:41,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:12:41,696 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:12:41,698 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:12:44,473 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:12:57,385 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:12:57,777 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 10:12:59,047 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:07,705 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 10:13:07,711 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:14,617 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:13:14,619 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:13:15,879 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:13:15,889 - ispa_next.main - DEBUG - 



2025-11-17 10:13:15,889 - ispa_next.main - DEBUG - starting with process 3 (B-LM9984) of 15
2025-11-17 10:13:15,893 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:13:17,685 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:13:19,530 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 10:13:19,532 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:13:22,588 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:13:22,590 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:14:06,103 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:14:21,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:21,379 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:21,633 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:24,186 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:14:24,187 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:24,285 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:14:24,667 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:14:24,674 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:14:27,783 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:14:27,785 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:14:30,186 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:14:32,189 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:14:32,345 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:14:35,683 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:14:35,820 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:14:35,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:14:38,480 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:14:50,611 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:14:51,617 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:14:51,618 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:14:52,139 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:15:08,482 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:15:18,805 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:15:18,807 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:15:18,810 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:15:19,979 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:15:19,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:15:21,144 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:15:24,789 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:15:24,791 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:25,267 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:15:27,269 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:15:27,452 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:15:27,636 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:15:27,766 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:15:27,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:30,488 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:15:41,983 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:15:49,885 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:15:49,886 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:15:52,506 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:15:56,761 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:15:57,768 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:15:57,769 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:15:57,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:15:57,872 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:02,073 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:16:02,078 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:16:02,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:02,189 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:16:10,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:11,363 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:16:11,364 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:16:12,275 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:16:12,278 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:16:14,719 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:16:14,723 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:16:16,125 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:16:16,129 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:16,134 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:16:16,136 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:16:16,143 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:16:16,147 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:16:16,149 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:16:16,156 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:16:16,157 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:16:16,161 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:16:16,163 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:16:16,853 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:16:17,795 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:16:27,777 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:16:27,790 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:16:28,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:16:28,661 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:16:37,777 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:16:37,780 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:16:37,782 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:16:37,783 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:41,067 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:16:41,069 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:16:41,071 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:44,512 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:16:44,515 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:16:44,516 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:16:45,386 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:16:45,619 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:55,939 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:16:55,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:16:59,185 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:17:14,838 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:17:15,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:16,107 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:17:16,383 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:17:29,578 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:37,305 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:45,453 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:54,927 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:17:54,931 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:17:54,932 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:17:56,024 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:17:56,153 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:17:56,155 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:17:58,954 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:18:11,486 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:18:11,870 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 10:18:13,165 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:20,870 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:18:20,886 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:27,961 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 870
2025-11-17 10:18:27,962 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:18:29,264 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:18:29,279 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:18:29,285 - ispa_next.main - DEBUG - 



2025-11-17 10:18:29,286 - ispa_next.main - DEBUG - starting with process 4 (OHV-PL30) of 15
2025-11-17 10:18:29,290 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:18:31,111 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:18:33,013 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:18:33,015 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 870
2025-11-17 10:18:36,168 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:18:36,170 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:19:16,719 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:19:29,567 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:19:32,167 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:19:32,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:32,271 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:19:32,606 - ispa_next.functions - DEBUG - HU date already expired after 298 days.
2025-11-17 10:19:42,658 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:19:42,662 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:19:45,697 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:19:45,699 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:19:47,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:19:49,566 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:19:49,742 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:19:49,937 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:19:50,059 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:19:54,325 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 10:19:55,331 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:19:55,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:19:55,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:14,628 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 10:20:25,463 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:20:25,465 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:20:25,468 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:20:25,630 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:20:26,915 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:20:28,908 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:20:28,908 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:20:29,026 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 10:20:32,944 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:20:32,944 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 10:20:32,949 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:20:32,951 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:20:32,951 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:34,070 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:38,258 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:20:38,263 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:20:38,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:38,383 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:20:41,887 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:42,427 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:20:42,428 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:20:43,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:20:43,296 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:20:45,765 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:20:45,768 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:20:47,557 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:20:47,558 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:47,562 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:20:47,563 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:20:47,567 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:20:47,568 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:20:47,570 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:20:47,575 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:20:47,576 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:20:47,585 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:20:47,588 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:20:48,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:20:49,302 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:20:59,494 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:20:59,495 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:21:00,228 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:21:00,347 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:21:09,681 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:21:09,684 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:21:09,686 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:21:09,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:12,897 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:21:12,900 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:21:12,902 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:16,134 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:21:16,138 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:21:16,139 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:21:16,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:21:17,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:27,637 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:21:27,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:30,925 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:21:46,668 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:21:47,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:21:47,953 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:21:48,225 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:21:59,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:07,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:16,051 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:24,973 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:22:24,976 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:22:24,977 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:22:26,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:22:26,140 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:22:26,145 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:22:28,972 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:22:41,016 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:22:41,407 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 10:22:42,813 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:22:50,945 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:22:50,947 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:22:58,473 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:22:58,474 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:22:59,813 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:22:59,826 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:22:59,832 - ispa_next.main - DEBUG - 



2025-11-17 10:22:59,832 - ispa_next.main - DEBUG - starting with process 5 (B MH 1918) of 15
2025-11-17 10:22:59,836 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:23:01,670 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:23:03,588 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:23:03,590 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:23:06,894 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:23:06,895 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:23:49,289 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:24:02,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:03,559 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:24:03,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:03,677 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:24:04,003 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:24:04,007 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:24:07,073 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:07,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:09,109 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:11,114 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:11,300 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:14,604 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:14,758 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:14,760 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:16,009 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:24:31,705 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:24:32,713 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:24:32,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:33,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:24:37,959 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:24:37,964 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:24:37,967 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:24:37,969 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:24:39,067 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:24:39,068 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:24:40,327 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:24:44,409 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:24:44,409 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:24:44,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:24:44,894 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:24:46,897 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:24:47,089 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:24:47,271 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:24:47,425 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:24:47,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:24:48,638 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:24:59,836 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:25:07,706 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:25:07,709 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:08,920 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:25:13,164 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:25:14,171 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:25:14,172 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:25:14,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:14,275 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:25:18,476 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:25:18,481 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:25:18,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:18,592 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:25:24,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:24,695 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:25:24,696 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:25:25,554 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:25:25,557 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:25:26,867 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:25:26,869 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:25:28,252 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:25:28,253 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:25:28,258 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:25:28,259 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:25:28,267 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:25:28,269 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:25:28,271 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:25:28,276 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:25:28,277 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:25:28,281 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:25:28,283 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:25:28,976 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:25:30,063 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:25:40,305 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:25:40,306 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:25:41,015 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:25:41,130 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:25:50,680 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:25:50,683 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:25:50,686 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:25:50,687 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:52,816 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:25:52,819 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:25:52,821 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:25:54,746 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:25:54,748 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:25:54,749 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:25:55,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:25:56,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:05,179 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:26:05,181 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:07,158 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:26:22,865 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:26:23,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:26:24,261 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:26:24,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:26:34,517 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:26:43,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:26:43,622 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:26:43,622 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:26:44,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:26:44,760 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:26:44,766 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:26:47,600 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:27:00,016 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:27:00,406 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 10:27:01,788 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:27:09,742 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:27:09,743 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:27:16,854 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:27:16,855 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:27:18,194 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:27:18,208 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:27:18,215 - ispa_next.main - DEBUG - 



2025-11-17 10:27:18,215 - ispa_next.main - DEBUG - starting with process 6 (B KL 2475 E) of 15
2025-11-17 10:27:18,219 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:27:20,036 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:27:21,932 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:27:21,934 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:27:25,319 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:27:25,320 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:28:14,615 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:28:27,822 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:30,395 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:28:30,395 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:30,492 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:28:30,832 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:28:30,836 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:28:33,915 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:28:33,917 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:28:35,732 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:28:37,735 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:28:37,887 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:28:41,208 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:28:41,357 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:28:41,362 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:28:44,038 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:28:56,094 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:28:57,100 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:28:57,104 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:28:57,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:29:02,525 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:29:02,530 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:29:02,532 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:29:02,535 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:29:03,705 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:29:03,706 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:29:05,065 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:29:08,692 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:29:08,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:29:09,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:29:11,703 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:29:11,874 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:29:12,060 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:29:12,220 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:29:12,221 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:29:14,859 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:29:26,895 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:30:26,897 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:30:37,779 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:30:46,115 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:30:46,117 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:30:48,919 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:30:53,173 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:30:54,179 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:30:54,180 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:30:54,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:54,284 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:30:58,480 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:30:58,485 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:30:58,486 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:30:58,614 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:30:59,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:59,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:30:59,576 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:31:00,447 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:31:00,449 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:31:02,911 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:31:02,913 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:31:04,209 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:31:04,210 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:31:04,214 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:31:04,215 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:31:04,219 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list), Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 10:31:04,222 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:31:04,227 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:31:04,229 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:31:04,237 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:31:04,240 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:31:04,942 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:31:05,959 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:31:16,304 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:31:16,312 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 10:31:20,039 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:31:20,601 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:31:21,546 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:31:22,249 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:31:22,792 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:31:23,724 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:31:24,327 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:31:24,870 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:31:26,541 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:31:27,354 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:31:27,897 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 10:31:28,848 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:31:30,568 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 10:31:31,563 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 10:31:32,535 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:31:33,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:31:33,435 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:31:42,741 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:31:42,745 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:31:42,747 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:31:42,748 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:45,288 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:31:45,290 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:31:45,296 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:47,891 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:31:47,894 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:31:47,895 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:31:48,645 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:31:49,185 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:31:58,851 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:31:58,854 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:01,427 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:32:17,167 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:32:17,741 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:32:18,606 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:32:18,899 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:32:29,578 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:37,796 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:47,083 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:32:47,086 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:32:47,087 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:32:48,133 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:32:48,235 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:32:48,238 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:32:51,715 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:33:05,011 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:33:05,405 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 10:33:06,691 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:33:14,712 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:33:14,714 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:33:21,829 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:33:21,830 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:33:23,178 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:33:23,191 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:33:23,197 - ispa_next.main - DEBUG - 



2025-11-17 10:33:23,197 - ispa_next.main - DEBUG - starting with process 7 (0 34 16) of 15
2025-11-17 10:33:23,201 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:33:25,005 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:33:26,955 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:33:26,957 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:33:30,261 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:33:30,266 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:33:51,369 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 149, in handle_briefing_screen
    raise AppointmentWithoutDMS("Appointment has no DMS data, proceed with the next one.")
ispa_next.exceptions.AppointmentWithoutDMS: Appointment has no DMS data, proceed with the next one.

2025-11-17 10:33:51,518 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 10:33:51,524 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:33:52,365 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:33:52,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:33:58,976 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:33:58,977 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:34:00,439 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:34:00,452 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:34:00,458 - ispa_next.main - DEBUG - 



2025-11-17 10:34:00,458 - ispa_next.main - DEBUG - starting with process 8 (BLKKP32) of 15
2025-11-17 10:34:00,462 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:34:02,329 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:34:04,233 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:34:04,235 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:34:07,624 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:34:07,626 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:34:56,077 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:35:09,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:11,383 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:35:11,384 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:11,488 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:35:11,829 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:35:11,833 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:35:14,985 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:14,987 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:17,380 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:19,383 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:35:19,565 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:35:22,870 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:35:23,007 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:35:23,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:25,044 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:35:37,330 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:35:38,336 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:35:38,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:38,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:35:43,731 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:35:43,740 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:35:43,742 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:35:43,744 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:35:44,898 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:35:44,899 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:35:46,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:35:49,970 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:35:49,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:35:50,448 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:35:52,451 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:35:52,676 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:35:52,839 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:35:53,003 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:35:53,005 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:35:54,994 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:36:06,004 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:36:14,702 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:36:14,704 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:36:20,221 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:36:26,724 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Mikrofilter (ggf. weiter Zusatzarbeit(en) beachten' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:36:33,997 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Luftfiltereinsatz' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:36:40,787 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:36:45,628 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:36:46,636 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:36:46,637 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:36:46,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:36:46,766 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:36:50,909 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:36:52,110 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:37:05,167 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:37:05,168 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:05,267 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:37:05,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:06,298 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:37:06,299 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:07,156 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:07,159 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:37:09,021 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:37:09,023 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:37:12,297 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:37:12,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:12,302 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:37:12,303 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:37:12,308 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:37:12,309 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:37:12,310 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:37:12,314 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:37:12,316 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:37:12,321 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:37:12,323 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:37:13,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:37:14,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:37:25,177 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:37:25,222 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:37:25,910 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:37:26,027 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:37:35,958 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:37:36,204 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:37:36,206 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:37:36,207 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:38,767 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:37:38,770 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:37:38,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:37:41,366 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:37:41,921 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:37:51,268 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:08,945 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:38:08,947 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:38:08,948 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:38:10,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:38:10,746 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:29,137 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:38:29,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:38:31,741 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:38:47,716 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:38:48,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:38:49,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:38:49,506 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:39:01,809 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:39:10,634 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:39:10,635 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:11,738 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:39:11,845 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:39:11,848 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:39:18,289 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:39:32,016 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:39:32,402 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 10:39:40,720 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:42,223 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:39:42,225 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:49,593 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:39:49,594 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:39:50,996 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:39:51,009 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:39:51,016 - ispa_next.main - DEBUG - 



2025-11-17 10:39:51,016 - ispa_next.main - DEBUG - starting with process 9 (B-As 1250) of 15
2025-11-17 10:39:51,020 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:39:52,926 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:39:55,655 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:39:55,657 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:39:59,099 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:39:59,101 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:40:47,895 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:41:01,612 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:02,827 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:41:02,828 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:02,932 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:41:03,296 - ispa_next.functions - DEBUG - HU date already expired after 385 days.
2025-11-17 10:41:13,422 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:41:13,426 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:41:16,499 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:16,501 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:18,877 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:20,880 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:41:21,045 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:41:24,366 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:41:24,513 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:41:24,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:25,808 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:41:38,254 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:41:39,259 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:41:39,260 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:39,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:41:45,601 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:41:45,609 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:41:45,612 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:41:45,614 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:41:46,845 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:41:46,846 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:41:49,012 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:41:53,127 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:41:53,127 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:41:53,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:41:53,665 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:41:55,667 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:41:55,841 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:41:56,046 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:41:56,203 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:41:56,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:41:57,442 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:42:09,788 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:43:09,791 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:43:20,776 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:43:29,227 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:43:29,229 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:43:30,542 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:43:34,785 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:43:35,791 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:43:35,792 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:43:35,792 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:35,943 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:43:40,130 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:43:40,135 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:43:40,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:40,245 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:43:40,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:41,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:43:41,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:43:42,260 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:43:42,263 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:43:43,582 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:43:43,584 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:43:45,178 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:43:45,179 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:43:45,183 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:43:45,184 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:43:45,190 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:43:45,192 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:43:45,193 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:43:45,199 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:43:45,204 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:43:45,208 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:43:45,211 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:43:45,921 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:43:47,206 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:43:58,238 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:43:58,239 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:43:58,970 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:43:59,063 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:44:08,675 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:44:08,779 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:44:08,970 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:44:08,971 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:11,206 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:44:11,209 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:44:11,211 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:13,114 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:44:13,117 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:44:13,118 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:44:14,204 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:44:14,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:20,465 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:44:20,468 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:22,456 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:44:38,013 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:44:38,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:44:39,548 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:44:39,814 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:44:50,663 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:45:00,608 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:45:00,611 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:45:00,612 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:45:02,473 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:45:02,582 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:45:02,584 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:45:05,558 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:45:18,299 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:45:18,674 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 10:45:20,157 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:45:28,438 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:45:28,440 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:45:35,935 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 10:45:35,936 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:45:37,277 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:45:37,290 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:45:37,297 - ispa_next.main - DEBUG - 



2025-11-17 10:45:37,297 - ispa_next.main - DEBUG - starting with process 10 (B- SH7750) of 15
2025-11-17 10:45:37,301 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:45:39,206 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:45:41,237 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1653
2025-11-17 10:45:41,239 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 10:45:44,754 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:45:44,756 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:46:37,603 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:46:51,303 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:46:52,552 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:46:52,553 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:46:52,680 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:46:53,015 - ispa_next.functions - DEBUG - HU date soon to be invalid in 71 days.
2025-11-17 10:47:03,169 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:47:03,173 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:47:06,235 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:47:06,237 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:08,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:10,656 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:47:10,816 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:47:14,146 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:47:14,265 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:47:14,267 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:15,644 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:47:29,038 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:47:30,044 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:47:30,045 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:30,669 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:47:36,139 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:47:36,144 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:47:36,146 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:47:36,148 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:47:37,390 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:47:37,391 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:47:39,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:47:43,125 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 10:47:43,125 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:47:43,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:47:43,725 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:47:45,729 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:47:45,880 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:47:46,078 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:47:46,221 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:47:46,223 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:47:47,449 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:48:00,007 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:49:00,010 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:49:13,058 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:49:38,061 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:49:48,989 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:49:56,928 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:49:56,930 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:49:58,205 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:50:02,469 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:50:03,477 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:50:03,478 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:50:03,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:03,590 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:50:07,813 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 10:50:07,818 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:50:07,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:07,923 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:50:12,075 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:12,837 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:50:12,838 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:50:13,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:50:13,794 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:50:15,141 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:50:15,143 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:50:16,860 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:50:16,862 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:50:16,866 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:50:16,867 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:50:16,871 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:50:16,872 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:50:16,873 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:50:16,879 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:50:16,880 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:50:16,889 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:50:16,891 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:50:17,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:50:18,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:50:30,617 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:50:30,618 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:50:31,315 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:50:31,462 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:50:42,017 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:50:42,020 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:50:42,022 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:50:42,023 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:44,438 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:50:44,441 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:50:44,446 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:46,336 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:50:46,340 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:50:46,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:50:47,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:50:47,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:56,632 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:50:56,634 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:50:58,729 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:51:14,746 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:51:15,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:51:16,325 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:51:16,625 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:51:27,795 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:38,012 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:51:38,014 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:51:38,015 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:51:39,085 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:51:39,212 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:51:39,214 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:51:42,181 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 10:51:55,352 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:51:55,734 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 10:51:57,250 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:52:06,041 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1656
2025-11-17 10:52:06,043 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:52:13,790 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 870
2025-11-17 10:52:13,791 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:52:15,204 - ispa_next.appointments.models - DEBUG - Appointment Workday GmbH M-WD1715E WBA81CY050FS21691 ohne Termin.
2025-11-17 10:52:15,215 - ispa_next.appointments.models - DEBUG - Appointment Sürmeli B-EK2404 WBA5V51020FH72340 ohne Termin.
2025-11-17 10:52:15,225 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:52:15,238 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:52:15,243 - ispa_next.main - DEBUG - 



2025-11-17 10:52:15,243 - ispa_next.main - DEBUG - starting with process 11 (B-MW 8129) of 15
2025-11-17 10:52:15,247 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:52:17,197 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:52:19,206 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1656
2025-11-17 10:52:19,208 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 870
2025-11-17 10:52:23,923 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:52:23,925 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:53:21,105 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 10:53:35,175 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:53:39,113 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 10:53:39,114 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:53:39,229 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 10:53:39,556 - ispa_next.functions - DEBUG - HU date already expired after 81 days.
2025-11-17 10:53:50,167 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 10:53:50,171 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 10:53:53,243 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:53:53,244 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:53:55,718 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:53:57,721 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:53:57,869 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:54:01,251 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:54:01,385 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:54:01,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:05,722 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:54:23,227 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 10:54:24,232 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 10:54:24,233 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:24,888 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:54:30,104 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 10:54:30,115 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 10:54:30,118 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 10:54:30,122 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 10:54:31,419 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 10:54:31,420 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 10:54:33,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 10:54:36,715 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 10:54:36,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:54:37,286 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:54:39,293 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 10:54:39,495 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 10:54:39,680 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 10:54:39,845 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 10:54:39,847 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:54:44,159 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:54:56,783 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 10:55:56,786 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 10:56:08,669 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 10:56:20,914 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 10:56:20,916 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:56:26,721 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='Fahrzeug-Check' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 10:56:32,330 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 10:56:38,248 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 10:56:39,255 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 10:56:39,256 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 10:56:39,257 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:39,380 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:56:43,592 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 10:56:44,843 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 10:56:56,475 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 10:56:56,476 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:56,581 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 10:56:56,977 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:57,744 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 10:56:57,746 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:56:58,765 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:56:58,768 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 10:57:02,353 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 10:57:02,356 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 10:57:04,760 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 10:57:04,762 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:04,766 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 10:57:04,768 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 10:57:04,773 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 10:57:04,774 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 10:57:04,776 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 10:57:04,781 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 10:57:04,783 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 10:57:04,792 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 10:57:04,795 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 10:57:05,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:57:07,057 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 10:57:19,109 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:57:19,338 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 10:57:20,748 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 10:57:20,840 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 10:57:32,421 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 10:57:32,424 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 10:57:32,426 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 10:57:32,427 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:37,066 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 10:57:37,072 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 10:57:37,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:57:43,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 10:57:44,217 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 10:57:55,368 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 10:57:55,371 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 10:57:55,372 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 10:57:57,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 10:57:57,365 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:09,485 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 10:58:09,487 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:14,414 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 10:58:31,542 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 10:58:32,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:58:33,399 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 10:58:33,667 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 10:58:49,232 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 10:58:58,736 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 10:58:58,736 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:58:59,872 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 10:59:00,031 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 10:59:00,034 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 10:59:06,847 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 10:59:22,345 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 10:59:22,732 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 10:59:25,826 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:33,070 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 10:59:33,072 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:40,763 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 871
2025-11-17 10:59:40,764 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 10:59:42,184 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 10:59:42,197 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 10:59:42,202 - ispa_next.main - DEBUG - Found new Appointment: B-SX293E
2025-11-17 10:59:42,202 - ispa_next.main - DEBUG - Found new Appointment: M-WD1715E
2025-11-17 10:59:42,202 - ispa_next.main - DEBUG - Found new Appointment: B-EK2404
2025-11-17 10:59:42,204 - ispa_next.main - DEBUG - 



2025-11-17 10:59:42,204 - ispa_next.main - DEBUG - starting with process 12 (B-SX293E) of 18
2025-11-17 10:59:42,208 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 10:59:44,178 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 10:59:46,197 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1658
2025-11-17 10:59:46,199 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 871
2025-11-17 10:59:49,827 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 10:59:49,829 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:00:44,943 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:00:59,262 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:00,480 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:01:00,480 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:00,627 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:01:00,991 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:01:00,995 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:01:04,195 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:01:04,197 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:01:07,216 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:01:09,231 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:01:09,406 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:01:12,791 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:01:12,903 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:01:12,905 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:01:14,242 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:01:27,159 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:01:28,165 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:01:28,166 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:28,844 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:01:51,969 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:02:04,430 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:02:04,433 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:02:04,435 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:02:05,788 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:02:05,788 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:02:07,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:02:11,119 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:02:11,121 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:12,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:02:14,056 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:02:14,226 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:02:14,432 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:02:14,612 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:02:14,614 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:15,996 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:02:27,059 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:02:35,212 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:02:35,214 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:02:36,445 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:02:40,718 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:02:41,726 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:02:41,727 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:02:41,727 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:41,831 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:02:46,059 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:02:46,064 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:02:46,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:46,176 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:02:56,186 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:57,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:02:57,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:02:58,709 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:02:58,713 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:02:59,994 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:02:59,996 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:03:01,967 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:03:01,968 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:03:01,977 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:03:01,978 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:03:01,984 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:03:01,985 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:03:01,986 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:03:01,990 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:03:01,991 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:03:01,998 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:03:02,000 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:03:02,714 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:03:04,301 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:03:16,701 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:03:16,760 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:03:18,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:03:18,569 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:03:31,044 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:03:31,475 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:03:31,478 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:03:31,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:33,399 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:03:33,402 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:03:33,404 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:35,433 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:03:35,436 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:03:35,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:03:36,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:03:37,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:48,972 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:03:48,977 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:03:50,869 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:04:07,664 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:04:08,264 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:04:09,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:04:09,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:04:21,246 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:04:32,043 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:04:32,046 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:04:32,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:04:33,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:04:33,274 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:04:33,276 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:04:36,385 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:04:50,235 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:04:50,637 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 11:04:52,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:01,355 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1659
2025-11-17 11:05:01,356 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:10,607 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 869
2025-11-17 11:05:10,608 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:05:12,061 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:05:12,074 - ispa_next.appointments.models - DEBUG - Appointment Emanuel Fink B-WF4586 WBSBR92090EH78375 ohne Termin.
2025-11-17 11:05:12,079 - ispa_next.main - DEBUG - 



2025-11-17 11:05:12,080 - ispa_next.main - DEBUG - starting with process 13 (M-WD1715E) of 18
2025-11-17 11:05:12,084 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:05:14,123 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:05:16,166 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1659
2025-11-17 11:05:16,168 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 869
2025-11-17 11:05:19,961 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:05:19,963 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:06:14,190 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:06:28,821 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:28,962 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:29,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:32,468 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:06:32,469 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:32,632 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:06:32,983 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:06:32,989 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:06:36,195 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:06:36,196 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:06:39,005 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:06:41,008 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:06:41,187 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:06:41,388 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:06:41,554 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:06:41,556 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:06:45,188 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:06:57,843 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:06:58,849 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:06:58,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:06:59,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:07:20,875 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 11:07:34,048 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:07:34,050 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:07:34,053 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:07:35,391 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:07:35,392 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:07:37,253 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:07:41,853 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:07:42,540 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:07:44,374 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:07:46,377 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:07:46,570 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:07:46,733 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:07:46,888 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:07:46,890 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:07:50,293 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:08:04,931 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:09:04,934 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:09:17,481 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 11:09:30,564 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 11:09:31,571 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:09:31,572 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:09:31,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:31,669 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:09:35,868 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:09:35,873 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:09:35,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:35,976 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:09:41,832 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:42,759 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:09:42,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:09:43,934 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:09:43,939 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:09:46,959 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:09:46,962 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:09:49,575 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:09:49,576 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:09:49,581 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 11:09:49,582 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:09:49,587 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:09:49,589 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:09:49,590 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:09:49,599 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:09:49,601 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:09:49,608 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:09:49,610 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:09:50,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:09:52,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:10:05,761 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:10:06,006 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:10:06,009 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:10:06,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:09,387 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:10:09,389 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:10:09,391 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:12,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:10:13,803 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:10:24,425 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:44,539 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:10:44,542 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:10:44,542 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:10:46,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:10:46,320 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:10:46,323 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:10:49,722 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:11:07,186 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:11:07,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:08,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:11:09,159 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:11:22,953 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:34,202 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:11:44,020 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:11:44,021 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:11:45,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:11:45,305 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:11:45,307 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:11:52,175 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:12:06,598 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:12:06,986 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 11:12:15,925 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:17,864 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1660
2025-11-17 11:12:17,866 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:25,945 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 870
2025-11-17 11:12:25,945 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:12:27,343 - ispa_next.appointments.models - DEBUG - Appointment Jörg Gaedke B-CJ1077 WBA5K31010G583912 ohne Termin.
2025-11-17 11:12:27,356 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:12:27,363 - ispa_next.main - DEBUG - 



2025-11-17 11:12:27,364 - ispa_next.main - DEBUG - starting with process 14 (B-EK2404) of 18
2025-11-17 11:12:27,368 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:12:29,453 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:12:31,606 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1660
2025-11-17 11:12:31,608 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 870
2025-11-17 11:12:35,729 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:12:35,731 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:13:33,941 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:13:48,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:13:50,650 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:13:50,651 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:13:50,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:13:51,167 - ispa_next.functions - DEBUG - HU date already expired after 1165 days.
2025-11-17 11:14:02,079 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:14:02,083 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:14:05,240 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:14:05,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:08,140 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:14:10,143 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:14:10,297 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:14:13,757 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:14:13,873 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:14:16,121 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:14:17,128 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:14:17,129 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:17,977 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:14:37,109 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:14:37,110 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:14:49,008 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:14:49,011 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:14:49,013 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:14:50,375 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:14:50,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:14:52,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:14:56,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:14:56,271 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:14:56,275 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:14:56,276 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:14:56,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:14:57,075 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:15:01,242 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:15:02,594 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:15:16,842 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:15:16,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:15:16,992 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:15:17,376 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:15:18,194 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:15:18,195 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:15:19,354 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:15:19,357 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:15:21,279 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:15:21,281 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:15:23,495 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:15:23,497 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:15:23,538 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:15:23,540 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:15:23,546 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:15:23,548 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:15:23,549 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:15:23,556 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:15:23,557 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:15:23,562 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:15:23,569 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:15:24,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:15:26,159 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:15:40,010 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:15:40,011 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:15:40,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:15:41,772 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:15:54,446 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:15:54,449 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:15:54,452 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:15:54,452 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:57,051 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:15:57,053 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:15:57,056 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:15:59,693 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:15:59,699 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:15:59,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:16:00,575 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:16:01,664 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:13,523 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:16:13,526 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:16,247 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:16:33,664 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:16:34,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:16:35,685 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:16:36,007 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:16:50,651 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:00,964 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:12,786 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:17:12,789 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:17:12,790 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:17:14,022 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:17:14,123 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:17:14,128 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:17:17,320 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:17:32,579 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:17:32,946 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 11:17:35,158 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:17:44,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1660
2025-11-17 11:17:44,107 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:17:53,025 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 870
2025-11-17 11:17:53,026 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:17:54,508 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:17:54,523 - ispa_next.main - DEBUG - Found new Appointment: B-CJ1077
2025-11-17 11:17:54,524 - ispa_next.main - DEBUG - 



2025-11-17 11:17:54,525 - ispa_next.main - DEBUG - starting with process 15 (B-CJ1077) of 19
2025-11-17 11:17:54,529 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:17:56,596 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:17:58,762 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1660
2025-11-17 11:17:58,764 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 870
2025-11-17 11:18:02,871 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:18:02,876 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:19:04,674 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:19:20,982 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:21,129 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:19:21,424 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:22,683 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:19:22,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:22,850 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:19:23,224 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:19:23,228 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:19:26,510 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:19:26,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:19:29,580 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:19:31,583 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:19:31,795 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:19:35,208 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:19:35,347 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:19:35,349 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:19:36,837 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:19:49,586 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:19:50,592 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:19:50,593 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:19:51,488 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:20:08,857 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 11:20:22,291 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:20:22,294 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:20:22,296 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:20:23,621 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:20:23,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:20:25,714 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:20:29,958 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:20:29,958 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:20:30,005 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:20:30,835 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:20:32,838 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:20:33,003 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:20:33,215 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:20:33,345 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:20:33,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:20:34,635 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:20:47,362 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:21:47,364 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:21:58,431 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:22:07,806 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:22:07,808 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:22:09,353 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:22:13,648 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:22:14,655 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:22:14,656 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:22:14,656 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:14,770 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:22:18,960 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:22:18,965 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:22:18,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:19,108 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:22:19,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:20,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:22:20,437 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:22:21,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:22:21,683 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:22:23,043 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:22:23,045 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:22:25,282 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:22:25,283 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:22:25,287 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:22:25,288 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:22:25,292 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:22:25,293 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:22:25,295 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:22:25,299 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:22:25,300 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:22:25,305 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:22:25,308 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:22:26,021 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:22:27,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:22:42,163 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:22:42,165 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:22:42,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:22:42,998 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:22:58,444 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:22:58,447 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:22:58,449 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:22:58,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:00,541 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:23:00,544 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:23:00,546 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:02,479 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:23:02,482 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:23:02,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:23:03,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:23:04,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:08,815 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:23:08,818 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:10,956 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:23:27,441 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:23:28,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:23:29,385 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:23:29,665 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:23:48,079 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:23:59,998 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:24:00,002 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:24:00,003 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:24:01,190 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:24:01,360 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:24:01,363 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:24:04,544 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:24:25,987 - ispa_next.appointment_ending - DEBUG - recursive call of complete process
2025-11-17 11:24:25,990 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:24:25,991 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:24:28,675 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:24:28,845 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:24:28,848 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:24:40,543 - ispa_next.appointment_ending - DEBUG - Terminvereinbarung abschließen button found but not enabled.
2025-11-17 11:24:40,586 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 11:24:46,341 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 11:24:46,345 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:24:55,166 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1661
2025-11-17 11:24:55,168 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:25:03,756 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 870
2025-11-17 11:25:03,756 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:25:05,202 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:25:05,209 - ispa_next.main - DEBUG - 



2025-11-17 11:25:05,209 - ispa_next.main - DEBUG - starting with process 16 (B SB4307) of 19
2025-11-17 11:25:05,214 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:25:07,367 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:25:09,557 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1661
2025-11-17 11:25:09,562 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 870
2025-11-17 11:25:13,668 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:25:13,669 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:25:50,188 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 167, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 11:25:50,739 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 11:25:50,768 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:25:51,722 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1661
2025-11-17 11:25:51,724 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:26:00,982 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 870
2025-11-17 11:26:00,983 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:26:02,458 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:26:02,465 - ispa_next.main - DEBUG - 



2025-11-17 11:26:02,465 - ispa_next.main - DEBUG - starting with process 17 (B AI6675) of 19
2025-11-17 11:26:02,470 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:26:04,622 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:26:06,794 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1661
2025-11-17 11:26:06,796 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 870
2025-11-17 11:26:10,978 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:26:10,979 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:27:12,764 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:27:28,263 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:30,286 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:27:30,287 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:27:30,397 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:27:30,801 - ispa_next.functions - DEBUG - HU date already expired after 51 days.
2025-11-17 11:27:42,364 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:27:42,368 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:27:45,629 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:27:45,631 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:27:49,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:27:51,096 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:27:51,294 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:27:54,817 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:27:54,967 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:27:54,969 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:27:58,730 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:28:12,155 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:28:13,161 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:28:13,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:14,121 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:28:19,537 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:28:19,542 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:28:19,544 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:28:19,547 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:28:20,925 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:28:20,926 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:28:23,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:28:26,705 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:28:26,707 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:28:27,597 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:28:29,600 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:28:29,768 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:28:29,995 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:28:30,183 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:28:30,184 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:28:32,169 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:28:45,175 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:29:45,178 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:29:57,516 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:30:05,687 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:30:05,689 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:30:07,745 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:30:11,989 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:30:12,996 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:30:12,997 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:30:12,998 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:13,176 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:30:17,364 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:30:17,369 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:30:17,370 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:17,473 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:30:21,955 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:22,993 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:30:22,994 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:30:24,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:30:24,327 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:30:26,551 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:30:26,553 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:30:28,927 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:30:28,928 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:30:28,934 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:30:28,939 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:30:28,944 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:30:28,946 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:30:28,947 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:30:28,953 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:30:28,954 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:30:28,961 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:30:28,963 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:30:29,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:30:31,699 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:30:47,254 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:30:47,255 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:30:47,957 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:30:49,244 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:31:04,820 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:31:04,823 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:31:04,825 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:31:04,826 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:07,820 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:31:07,823 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:31:07,825 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:10,632 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:31:10,635 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:31:10,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:31:12,470 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:31:12,730 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:24,351 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:31:24,356 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:31:28,444 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:31:45,816 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:31:46,411 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:31:47,924 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:31:48,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:32:02,234 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:13,691 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:26,421 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:32:26,424 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:32:26,425 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:32:27,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:32:27,796 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:32:27,798 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:32:31,091 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:32:45,906 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:32:46,284 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 11:32:55,666 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:32:57,836 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1645
2025-11-17 11:32:57,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:33:07,834 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 872
2025-11-17 11:33:07,835 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:33:09,374 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:33:09,381 - ispa_next.main - DEBUG - Found new Appointment: B-UW306
2025-11-17 11:33:09,383 - ispa_next.main - DEBUG - 



2025-11-17 11:33:09,383 - ispa_next.main - DEBUG - starting with process 18 (B-UW306) of 20
2025-11-17 11:33:09,387 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:33:11,555 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:33:13,782 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1645
2025-11-17 11:33:13,784 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 872
2025-11-17 11:33:18,031 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:33:18,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:34:23,235 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:34:38,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:34:39,888 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:34:39,889 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:40,009 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:34:40,377 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:34:40,381 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:34:43,829 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:34:43,831 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:34:46,911 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:34:48,915 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:34:49,130 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:34:52,575 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:34:52,766 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:34:54,965 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 11:34:55,971 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:34:55,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:34:56,967 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:35:17,246 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:35:17,247 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 11:35:29,789 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:35:29,792 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:35:29,795 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:35:31,160 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:35:31,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:35:33,544 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:35:37,203 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:35:37,203 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:35:37,207 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:35:37,208 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:35:37,209 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:35:38,151 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:35:42,302 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 11:35:43,675 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 11:36:03,348 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:36:03,349 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:03,502 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:36:03,912 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:04,891 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:36:04,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:36:06,217 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:36:06,220 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:36:07,783 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:36:07,785 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:36:10,193 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:36:10,194 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:36:10,198 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:36:10,199 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:36:10,203 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:36:10,204 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:36:10,206 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:36:10,210 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:36:10,212 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:36:10,219 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:36:10,222 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:36:10,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:36:12,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:36:29,940 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:36:29,941 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:36:30,622 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:36:30,784 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:36:46,034 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:36:46,042 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:36:46,044 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:36:46,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:48,125 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:36:48,127 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:36:48,129 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:36:50,168 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:36:50,171 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:36:50,172 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:36:51,030 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:36:52,308 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:14,205 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:37:14,208 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:16,333 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:37:33,799 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:37:34,410 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:37:36,023 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:37:36,354 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:37:51,839 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:38:04,501 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:38:04,505 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:38:04,506 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:05,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:38:05,917 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:38:05,920 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:38:09,177 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 11:38:23,986 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:38:24,384 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 11:38:27,399 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:35,282 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1647
2025-11-17 11:38:35,284 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:44,190 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 874
2025-11-17 11:38:44,191 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:38:45,684 - ispa_next.appointments.models - DEBUG - Appointment SAP SE HD-LS935E WBY61EF0105Y44190 ohne Termin.
2025-11-17 11:38:45,703 - ispa_next.appointments.models - DEBUG - Appointment Gheorghe Popa B-CF7188 WBA31EX0509W34300 ohne Termin.
2025-11-17 11:38:45,709 - ispa_next.main - DEBUG - Found new Appointment: B-WS4245
2025-11-17 11:38:45,711 - ispa_next.main - DEBUG - 



2025-11-17 11:38:45,711 - ispa_next.main - DEBUG - starting with process 19 (B-WS4245) of 21
2025-11-17 11:38:45,715 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:38:47,943 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:38:50,160 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1647
2025-11-17 11:38:50,161 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 874
2025-11-17 11:38:54,656 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:38:54,658 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:39:59,549 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:40:17,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:17,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:40:17,672 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:40:24,175 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:40:24,176 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:24,280 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:40:24,717 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:40:24,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:40:24,822 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:40:39,927 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:40:44,593 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:40:44,594 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:40:47,758 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:40:49,761 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:40:59,852 - ispa_next.rkr_manager.state - DEBUG - RKR not available or supported
2025-11-17 11:41:12,598 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: no_support
2025-11-17 11:41:13,605 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:41:13,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:41:14,644 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:41:35,503 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 11:41:50,463 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:41:50,466 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:41:50,468 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:41:50,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:41:53,114 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:41:57,001 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:41:57,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:41:59,450 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 11:42:03,791 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-17 11:42:03,791 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:42:03,791 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 11:42:03,794 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:42:03,795 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:42:03,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:42:04,825 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:42:09,047 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:42:09,052 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:42:09,053 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:42:09,157 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:42:09,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:42:10,642 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:42:10,643 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:42:12,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:42:12,036 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:42:18,634 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:42:18,636 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:42:21,815 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:42:21,816 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:42:21,820 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:42:21,821 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:42:21,825 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:42:21,827 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:42:21,828 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:42:21,835 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:42:21,840 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:42:21,846 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:42:21,848 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:42:22,610 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:42:24,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:42:41,470 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:42:41,471 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:42:42,180 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:42:42,295 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:43:00,720 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:43:00,723 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:43:00,726 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:43:00,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:43:08,293 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:43:08,295 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:43:08,298 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:43:15,564 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:43:16,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:43:32,820 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:43:32,823 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:43:32,823 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:43:36,351 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:43:36,460 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:43:36,462 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:43:44,178 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:44:01,909 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:44:02,413 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:44:04,033 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:44:04,321 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:44:23,801 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:44:37,150 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:44:48,419 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:44:48,420 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:44:49,776 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:44:49,887 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:44:49,889 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:44:57,592 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:45:15,581 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:45:15,978 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 11:45:20,127 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:45:28,092 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1650
2025-11-17 11:45:28,094 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:45:37,212 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 11:45:37,213 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:45:38,686 - ispa_next.appointments.models - DEBUG - Appointment Peter Blust B-MW8010 WBA15BZ0X0N266419 ohne Termin.
2025-11-17 11:45:38,696 - ispa_next.appointments.models - DEBUG - Appointment Hagen Doering B-OX1340 WBA31AA0703L53717 ohne Termin.
2025-11-17 11:45:38,715 - ispa_next.main - DEBUG - 



2025-11-17 11:45:38,716 - ispa_next.main - DEBUG - starting with process 20 (PM EX 440) of 21
2025-11-17 11:45:38,721 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:45:40,951 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:45:43,154 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1650
2025-11-17 11:45:43,156 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 11:45:47,743 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:45:47,745 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:46:59,210 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:47:15,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:17,644 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:47:17,645 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:47:17,761 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:47:18,194 - ispa_next.functions - DEBUG - HU date already expired after 169 days.
2025-11-17 11:47:30,446 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:47:30,450 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:47:35,404 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:47:35,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:47:38,898 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:47:40,903 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:47:41,126 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:47:44,657 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:47:44,791 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:47:44,793 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:47:47,346 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:48:00,985 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:48:01,992 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:48:01,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:48:03,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:48:08,748 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:48:08,753 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:48:08,756 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:48:08,758 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:48:10,180 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:48:10,181 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:48:12,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:48:16,330 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:48:16,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:48:17,375 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:48:19,378 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:48:19,596 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:48:19,825 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:48:19,954 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:48:19,956 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:48:22,471 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:48:36,167 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 11:49:36,170 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:49:48,839 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:49:56,958 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:49:56,960 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:49:59,495 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:50:03,857 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:50:04,864 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:50:04,865 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:50:04,866 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:04,980 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:50:09,200 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:50:09,206 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:50:09,206 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:09,319 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:50:14,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:15,280 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:50:15,281 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:50:16,819 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:50:16,822 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:50:19,405 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:50:19,407 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:50:22,077 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:50:22,078 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:50:22,088 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:50:22,094 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:50:22,099 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:50:22,103 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:50:22,104 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:50:22,111 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:50:22,113 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:50:22,122 - ispa_next.package_manager.main - DEBUG - found packages to update: {Package(name=Service Bremse vorn, source=cart, target=update)}
2025-11-17 11:50:22,125 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:50:22,826 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:50:25,085 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:50:43,813 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:50:43,835 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:50:45,919 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:50:46,084 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:51:03,685 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:51:03,695 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 11:51:07,761 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:51:08,312 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:51:09,310 - ispa_next.package_manager.helper - DEBUG - _update_parts_in_package
2025-11-17 11:51:15,705 - ispa_next.package_manager.helper - DEBUG - Part with number '83192413695' cannot be removed / replaced.
2025-11-17 11:51:21,702 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:51:22,571 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:51:23,183 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:51:24,140 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:51:25,018 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:51:25,560 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 11:51:27,137 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:51:30,097 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 11:51:31,040 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 11:51:32,216 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:51:32,219 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:51:32,534 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:51:36,420 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 11:51:46,017 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:51:46,021 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:51:46,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:51:50,717 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:51:50,720 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:51:50,721 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:51:52,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:51:52,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:52:03,751 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:52:03,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:52:07,153 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:52:25,160 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:52:25,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:52:27,624 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:52:27,980 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:52:45,529 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:52:59,134 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 11:52:59,135 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:53:00,545 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:53:00,648 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 11:53:00,651 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 11:53:08,314 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 11:53:24,801 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 11:53:25,216 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 11:53:28,459 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:53:36,637 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1651
2025-11-17 11:53:36,639 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 11:53:45,627 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 11:53:45,629 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:53:47,132 - ispa_next.main - DEBUG - 



2025-11-17 11:53:47,133 - ispa_next.main - DEBUG - starting with process 21 (M MM 3386E) of 21
2025-11-17 11:53:47,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 11:53:49,399 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 11:53:51,658 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1651
2025-11-17 11:53:51,660 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 876
2025-11-17 11:53:56,369 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 11:53:56,371 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 11:55:10,248 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 11:55:27,212 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:55:31,607 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 11:55:31,608 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:31,717 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:32,094 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 11:55:32,097 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:55:32,274 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 11:55:44,464 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 11:55:49,310 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:55:49,312 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:55:52,696 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:55:54,699 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:55:54,846 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:55:58,402 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:55:58,603 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:55:58,605 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:56:03,132 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:56:16,215 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 11:56:17,221 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 11:56:17,222 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:56:18,434 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:56:24,196 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 11:56:24,202 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 11:56:24,204 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 11:56:24,210 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 11:56:25,743 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 11:56:25,744 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 11:56:28,040 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 11:56:31,728 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 11:56:31,730 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:56:32,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:56:34,810 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 11:56:35,038 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 11:56:35,280 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 11:56:35,405 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 11:56:35,407 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:56:39,868 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 11:56:51,150 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 11:56:59,405 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 11:56:59,406 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:57:04,198 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 11:57:08,543 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 11:57:09,549 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 11:57:09,550 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 11:57:09,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:09,654 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:57:13,823 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 11:57:13,828 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 11:57:13,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:14,003 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 11:57:20,829 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 11:57:23,755 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 11:57:23,756 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 11:57:25,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 11:57:25,327 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 11:57:29,904 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 11:57:29,906 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 11:57:32,622 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 11:57:32,623 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:57:32,627 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Servicewäsche / Kostenlose Servicewäsch, source=from_tab, target=cart)}
2025-11-17 11:57:32,628 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 11:57:32,632 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 11:57:32,633 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Nefzger Wintercheck, source=from_tab, target=advice_list)}
2025-11-17 11:57:32,635 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 11:57:32,640 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 11:57:32,641 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 11:57:32,649 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 11:57:32,652 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 11:57:33,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:57:35,637 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 11:57:57,621 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:57:57,716 - ispa_next.package_manager.helper - DEBUG - add_to_advice_list called
2025-11-17 11:57:58,417 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 11:57:58,517 - ispa_next.common.shared - DEBUG - ISPA tab Marketing is already open
2025-11-17 11:58:17,278 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 11:58:17,303 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 11:58:17,308 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 11:58:17,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:22,739 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 11:58:22,742 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 11:58:22,745 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:28,167 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 11:58:28,171 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 11:58:28,171 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 11:58:29,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 11:58:30,728 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:48,766 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 11:58:48,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:58:54,126 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 11:59:14,614 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 11:59:15,250 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 11:59:17,146 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 11:59:17,498 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 11:59:35,181 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 11:59:49,042 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 12:00:00,439 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 12:00:00,439 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 12:00:01,836 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 12:00:01,953 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 12:00:01,960 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 12:00:10,003 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 12:00:26,821 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 12:00:27,215 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-17 12:00:30,556 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 12:00:38,930 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1652
2025-11-17 12:00:38,932 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 12:00:49,795 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 876
2025-11-17 12:00:49,797 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
