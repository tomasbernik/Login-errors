2025-11-17 13:08:25,352 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 13:08:25,360 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 13:08:34,575 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 13:08:47,412 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 13:09:03,199 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:11:04,388 - ispa_next.app_start.main - DEBUG - Operation already took 109.78 seconds (more than 80 seconds)
2025-11-17 13:11:06,491 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\ab4633ce92eb739a\\tess_2uly50h6_input.PNG', 'C:\\Users\\azureuser\\AppData\\Local\\robocorp\\temp\\ab4633ce92eb739a\\tess_2uly50h6', 'txt']
2025-11-17 13:11:06,816 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 13:11:06,820 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 13:11:06,821 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 13:11:33,692 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 13:11:52,429 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 13:11:55,575 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:11:57,189 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:11:57,190 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 13:12:00,584 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 70
2025-11-17 13:12:00,585 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 13:12:00,586 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:12:02,089 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 13:12:03,585 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:12:16,251 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 13:12:16,266 - ispa_next.main - DEBUG - Found 3 out of 7 appointments to process (configured limit: 15).
2025-11-17 13:12:16,266 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-17 13:12:16,266 - ispa_next.main - DEBUG - All appointments: HI-EF 99, MI-VS 81, HF-KT 524
2025-11-17 13:12:16,269 - ispa_next.main - DEBUG - 



2025-11-17 13:12:16,269 - ispa_next.main - DEBUG - starting with process 1 (HI-EF 99) of 3
2025-11-17 13:12:16,272 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:12:17,761 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:12:19,295 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:12:19,297 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 70
2025-11-17 13:12:21,026 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:12:21,027 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:13:09,959 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:13:21,068 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:13:26,587 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:13:26,588 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:26,704 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:26,960 - ispa_next.functions - DEBUG - HU date already expired after 453 days.
2025-11-17 13:13:35,463 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:13:35,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:35,571 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:13:45,670 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:13:48,670 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:13:48,672 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:13:49,989 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:13:51,992 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:13:52,168 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:13:52,292 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:13:52,404 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:13:56,634 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 13:13:57,637 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:13:57,638 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:13:58,148 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:02,210 - ispa_next.functions - DEBUG - no DSE icon found
2025-11-17 13:14:02,213 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:14:02,215 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:02,350 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:14:02,351 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:14:02,427 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:14:03,871 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:14:05,275 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:14:05,699 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:14:09,871 - ispa_next.functions - DEBUG - Updated appointment (AA00050629) customer contact data.
2025-11-17 13:14:10,779 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:14:10,781 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:14:11,860 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:14:11,861 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:14:12,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:14:17,687 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:14:17,688 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 13:14:17,779 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:14:17,780 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:14:17,780 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:18,560 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:22,699 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:14:22,703 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:14:22,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:22,816 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:14:31,644 - ispa_next.wipers - DEBUG - valid contract found: Alphabet Service Inclusive
2025-11-17 13:14:54,961 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-17 13:14:56,414 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:57,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:14:57,344 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:14:58,103 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:14:58,106 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:15:03,815 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:15:03,817 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:15:05,039 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:15:05,043 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:15:05,047 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart), Package(name=Wischerblatt für Heckscheibenwischer ersetzen, source=from_aw_package, target=cart), Package(name=Wischerblätter ersetzen in Ihrem Leasingvertrag en, source=from_tab, target=cart), Package(name=Interne Qualitätssicherung, source=from_tab, target=cart), Package(name=Wischerblatt links und rechts ersetzen, source=from_aw_package, target=cart)}
2025-11-17 13:15:05,049 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:15:05,052 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:15:05,053 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:15:05,054 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:15:05,058 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:15:05,059 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:15:05,063 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:15:05,065 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:15:05,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:15:06,670 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:15:28,386 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:15:28,987 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:16:17,784 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:16:17,788 - ispa_next.package_manager.helper - DEBUG - add_appointment_note in package_manager
2025-11-17 13:16:25,449 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:16:25,450 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:16:25,451 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:35,090 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:16:35,091 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:16:35,093 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:16:44,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:16:45,278 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:16:57,345 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:17,915 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:17:17,915 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:17:17,917 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:27,606 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:17:27,607 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:17:28,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:17:29,106 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:47,422 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:17:47,426 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:17:57,093 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 13:18:06,803 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:18:21,651 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:18:31,440 - ispa_next.common.mail - INFO - Successfully sent an email to 3 recipients
2025-11-17 13:18:31,444 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:18:31,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:18:32,629 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:18:32,880 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:20:06,792 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:11,935 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:19,400 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:25,578 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:31,003 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:36,502 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:41,456 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:46,671 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:52,138 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:20:57,109 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:21:02,464 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:21:08,156 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:21:14,948 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:21:14,951 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:21:14,952 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:21:15,834 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:21:15,917 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:21:15,918 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:21:18,706 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:21:31,725 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:21:32,149 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 13:21:34,558 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:35,391 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:21:35,393 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:39,596 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 13:21:39,597 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:21:40,994 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 13:21:40,998 - ispa_next.main - DEBUG - Found new Appointment: MI-SD 44
2025-11-17 13:21:40,999 - ispa_next.main - DEBUG - 



2025-11-17 13:21:40,999 - ispa_next.main - DEBUG - starting with process 2 (MI-SD 44) of 4
2025-11-17 13:21:41,013 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:21:42,598 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:21:44,194 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:21:44,195 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 13:21:46,064 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:21:46,066 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:22:21,860 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:22:33,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:33,263 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:22:33,499 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:22:35,518 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:22:35,519 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:35,656 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:22:35,931 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:22:35,947 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:22:38,848 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:22:38,850 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:22:40,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:22:42,335 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:22:42,461 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:22:45,720 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 13:22:55,480 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 13:22:56,486 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:22:56,487 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:22:57,026 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:07,059 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:23:15,865 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:23:15,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:23:15,988 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:23:15,990 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:23:16,096 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:23:16,258 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:23:17,970 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:23:18,431 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:23:21,469 - ispa_next.functions - DEBUG - Updated appointment (AA00050631) customer contact data.
2025-11-17 13:23:22,403 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:23:22,428 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:23:22,582 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:23:23,442 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:23:25,093 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:23:25,094 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:23:25,286 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 13:23:28,948 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:23:28,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:23:29,468 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:23:31,470 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:23:31,654 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:23:31,790 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:23:31,876 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:23:31,878 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:23:34,706 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:23:46,260 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:24:46,264 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:24:58,000 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 13:25:05,433 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:25:05,435 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:08,408 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:25:12,633 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:25:13,638 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:25:13,639 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:25:13,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:13,791 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:25:17,954 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 13:25:17,957 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:25:17,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:18,080 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:25:18,463 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:19,129 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:25:19,130 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:25:19,867 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:25:19,869 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:25:22,402 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:25:22,404 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:25:23,515 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:25:23,518 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:25:23,522 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Interne Qualitätssicherung, source=from_tab, target=cart), Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-17 13:25:23,524 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:25:23,530 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 13:25:23,540 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 13:25:23,543 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:25:23,545 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:25:23,546 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:25:23,548 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:25:23,550 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:25:24,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:25:25,187 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:25:40,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:25:40,872 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:25:46,637 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:25:46,638 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 13:25:46,639 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 13:25:46,640 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:50,707 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 13:25:50,709 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 13:25:50,712 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:54,828 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 13:25:54,829 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 13:25:54,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:25:58,891 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 13:25:58,892 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-17 13:25:59,474 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-17 13:25:59,700 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:07,408 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 13:26:07,410 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:26:11,430 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 13:26:25,426 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 13:26:25,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:26:26,467 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:26:26,646 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:27:06,044 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:11,241 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:16,204 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:21,564 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:27,059 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 13:27:27,061 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:27:27,061 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:27,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:27:27,999 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 13:27:28,000 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 13:27:30,367 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 13:27:41,113 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 13:27:41,511 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 13:27:43,099 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:27:43,836 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:27:43,838 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:27:47,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 13:27:47,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:27:48,897 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 13:27:48,901 - ispa_next.main - DEBUG - 



2025-11-17 13:27:48,902 - ispa_next.main - DEBUG - starting with process 3 (MI-VS 81) of 4
2025-11-17 13:27:48,904 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:27:50,382 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:27:52,301 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:27:52,302 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 13:27:54,404 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:27:54,405 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:28:26,378 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:28:37,509 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:28:40,152 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:28:40,153 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:28:40,267 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:28:40,563 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-17 13:28:48,752 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:28:48,755 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:28:51,611 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:28:51,613 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:28:51,859 - ispa_next.common.shared - ERROR - Error opening ISPA tab: Wartung
2025-11-17 13:28:52,886 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 50, in open_ispa_tab
    target_tab = tab_control.find_first(C.name(name), C.control_type_name("Text"))
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\decorators\null_control.py", line 23, in wrapper
    return func(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\mixins.py", line 186, in find_first
    found = m.find_first(
            ^^^^^^^^^^^^^
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 87, in find_first
    raise_error(msg)
  File "C:\ProgramData\robocorp\ht\84e04c8_5a1fac3_9fcd2534\Lib\site-packages\pyfenster\query\methods.py", line 78, in raise_error
    raise ElementNotFoundError(msg)
pyfenster.exceptions.ElementNotFoundError: 'FindFirst' failed: name = 'Wartung'
AND
control_type = '50020'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 72, in process_appointment
    remote_keyread_manager.run(waiting=False)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\main.py", line 61, in run
    self.ui_helper.open_tab(base_element=self.base_element, name="Wartung")
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\rkr_manager\helper.py", line 272, in open_tab
    opened = open_ispa_tab(base_element=base_element, name=name)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\common\shared.py", line 73, in open_ispa_tab
    raise ElementNotFoundError(error_msg) from exc
pyfenster.exceptions.ElementNotFoundError: Error opening ISPA tab: Wartung

2025-11-17 13:28:52,914 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:28:52,915 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:28:53,789 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:28:54,454 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:28:54,455 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:28:54,480 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:28:57,734 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 13:28:57,738 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:28:58,299 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:28:58,300 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:29:02,836 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 13:29:02,837 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:29:04,040 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
2025-11-17 13:29:04,044 - ispa_next.main - DEBUG - 



2025-11-17 13:29:04,044 - ispa_next.main - DEBUG - starting with process 4 (HF-KT 524) of 4
2025-11-17 13:29:04,047 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:29:05,592 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:29:07,408 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:29:07,410 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 86
2025-11-17 13:29:11,176 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 13:29:11,178 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:29:51,998 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 13:30:04,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:30:12,964 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 13:30:12,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:13,107 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:13,469 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 13:30:13,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:13,616 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:30:21,467 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 13:30:24,799 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:30:24,800 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:30:26,200 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:30:28,204 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:30:28,363 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:30:28,463 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:30:28,626 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:30:28,628 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:30:37,219 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:30:49,097 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 13:30:50,102 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 13:30:50,103 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:30:50,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:01,727 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 13:31:11,459 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 13:31:11,461 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:31:11,626 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 13:31:11,627 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 13:31:11,708 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 13:31:13,156 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 13:31:14,745 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 13:31:15,107 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 13:31:17,296 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-17 13:31:18,330 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 13:31:18,331 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 13:31:19,579 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 13:31:19,580 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 13:31:20,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 13:31:24,288 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 13:31:24,290 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:31:24,857 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:31:26,861 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 13:31:27,058 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 13:31:27,226 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 13:31:27,363 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 13:31:27,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:31:35,874 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:31:47,491 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 13:32:47,495 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 13:32:58,467 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 13:33:06,416 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 13:33:06,418 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 13:33:15,042 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 13:33:19,294 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 13:33:20,301 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 13:33:20,302 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 13:33:20,303 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:20,441 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:24,577 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 13:33:25,668 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 13:33:45,058 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 13:33:45,059 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:45,283 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 13:33:45,790 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:46,395 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 13:33:46,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 13:33:47,451 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 13:33:47,452 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 13:33:55,231 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 13:33:55,249 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 13:33:57,272 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 13:33:57,274 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:57,279 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Interne Qualitätssicherung, source=from_tab, target=cart), Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-17 13:33:57,282 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 13:33:57,285 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 13:33:57,286 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 13:33:57,289 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 13:33:57,290 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 13:33:57,292 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 13:33:57,294 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 13:33:58,140 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-17 13:33:59,422 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-17 13:34:16,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 13:34:17,604 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 13:34:25,154 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 13:34:25,155 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 13:34:30,142 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:30,692 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:31,239 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:32,860 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:33,408 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:33,959 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:35,616 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:36,189 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:36,748 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:38,382 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:38,942 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:39,490 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:41,188 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:41,746 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:42,296 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:43,992 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:44,546 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:45,095 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:46,730 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:47,282 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:47,831 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:49,404 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:49,959 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:50,508 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:53,398 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:53,967 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:54,551 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:56,234 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:56,789 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:34:57,375 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:34:58,998 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:34:59,558 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:35:00,109 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:35:01,792 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:35:02,350 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:35:02,902 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:35:04,589 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 13:35:05,161 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 13:35:05,753 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-17 13:35:06,306 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-17 13:35:06,972 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-17 13:35:07,533 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-17 13:35:08,152 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-17 13:35:08,153 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-17 13:35:10,107 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 110, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-17 13:35:11,069 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 13:35:11,070 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 13:35:12,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 13:35:13,878 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 13:35:13,879 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-17 13:35:13,927 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 13:35:20,702 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 13:35:20,706 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 13:35:22,460 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 260
2025-11-17 13:35:22,467 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 13:35:29,731 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 86
2025-11-17 13:35:29,732 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 13:35:31,892 - ispa_next.appointments.models - DEBUG - Appointment Susanne Sempa HF-SV 1503 WBATX750X0NC03524 ohne Termin.
