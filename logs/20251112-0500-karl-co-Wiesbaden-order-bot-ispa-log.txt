2025-11-12 05:07:34,458 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 05:07:34,466 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 05:07:45,118 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:07:55,284 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:08:10,929 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:10:09,447 - ispa_next.app_start.main - DEBUG - Operation already took 107.20 seconds (more than 80 seconds)
2025-11-12 05:10:11,546 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7f871f6f703606cf\\tess_0nyrdl8y_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7f871f6f703606cf\\tess_0nyrdl8y', 'txt']
2025-11-12 05:10:11,864 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:10:11,869 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:10:11,871 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:12:10,545 - ispa_next.app_start.main - DEBUG - Operation already took 106.44 seconds (more than 80 seconds)
2025-11-12 05:12:12,634 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7f871f6f703606cf\\tess_r_ok_u9e_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7f871f6f703606cf\\tess_r_ok_u9e', 'txt']
2025-11-12 05:12:12,840 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:12:12,845 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:12:18,516 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-12 05:12:26,178 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 05:12:36,885 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 05:12:52,464 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:14:50,051 - ispa_next.app_start.main - DEBUG - Operation already took 106.52 seconds (more than 80 seconds)
2025-11-12 05:14:52,135 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7f871f6f703606cf\\tess_vnxzbw16_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\7f871f6f703606cf\\tess_vnxzbw16', 'txt']
2025-11-12 05:14:52,406 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-12 05:14:52,412 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-12 05:14:52,414 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 05:15:29,493 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 05:15:45,142 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 05:15:48,233 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:15:49,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:15:49,558 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-12 05:15:52,147 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 37
2025-11-12 05:15:52,148 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 05:15:52,149 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:15:53,253 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 05:15:54,415 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:15:59,723 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,723 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,723 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,724 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,724 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,725 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,725 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,726 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 05:15:59,730 - ispa_next.main - DEBUG - Found 6 out of 8 appointments to process (configured limit: 15).
2025-11-12 05:15:59,730 - ispa_next.main - DEBUG - Processing 1 fresh appointments.
2025-11-12 05:15:59,731 - ispa_next.main - DEBUG - Processing 5 already visited appointments (w/ RKR not callable).
2025-11-12 05:15:59,731 - ispa_next.main - DEBUG - All appointments: FB RM 929E, GG-ZV 17, WI-NG 340, WI-SC 881, WI-NI 63, MTK-BU 1 E
2025-11-12 05:15:59,734 - ispa_next.main - DEBUG - 



2025-11-12 05:15:59,734 - ispa_next.main - DEBUG - starting with process 1 (FB RM 929E) of 6
2025-11-12 05:15:59,737 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:16:00,940 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:16:02,324 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:16:02,326 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 37
2025-11-12 05:16:03,858 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:16:03,860 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:16:38,289 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 05:16:38,461 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 05:16:38,465 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:16:39,235 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:16:39,236 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:16:41,905 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-12 05:16:41,905 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:16:42,792 - ispa_next.appointments.models - DEBUG - Appointment Ellen Persch RÜD-EP 90 WMW51DK0402T35996 ohne Termin.
2025-11-12 05:16:42,815 - ispa_next.main - DEBUG - 



2025-11-12 05:16:42,815 - ispa_next.main - DEBUG - starting with process 2 (GG-ZV 17) of 6
2025-11-12 05:16:42,830 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:16:44,095 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:16:45,403 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:16:45,409 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-12 05:16:46,865 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:16:46,866 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:17:14,118 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:17:15,743 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:17:20,351 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:17:20,430 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:17:20,580 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:17:24,509 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:17:24,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:17:24,619 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:17:24,792 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:17:24,796 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:17:27,599 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:17:27,601 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:17:28,634 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:17:30,646 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:17:30,732 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:17:30,824 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:17:30,901 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:17:30,903 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:17:34,848 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:17:43,080 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 05:17:44,083 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:17:44,087 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:17:44,625 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:17:56,018 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:17:59,527 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:17:59,529 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:17:59,608 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:17:59,610 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:17:59,646 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:17:59,740 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:18:00,837 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:18:01,116 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:18:04,101 - ispa_next.functions - DEBUG - Updated appointment (AE00049690) customer contact data.
2025-11-12 05:18:05,015 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:18:05,016 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:18:05,089 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:18:05,240 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:18:05,242 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:18:05,346 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:18:05,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:18:06,906 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:18:06,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:18:06,992 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:18:11,042 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:18:11,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:18:11,518 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:18:13,521 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:18:13,632 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:18:13,724 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:18:13,848 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 05:18:13,849 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:18:17,815 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:18:26,131 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:19:26,133 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:19:34,309 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 05:20:14,311 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 05:20:22,378 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-12 05:20:29,521 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-12 05:20:30,525 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:20:30,527 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:20:30,527 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:20:30,659 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:20:34,770 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:20:34,775 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:20:34,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:20:34,864 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:20:40,474 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:20:40,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:20:40,945 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:20:41,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:20:41,567 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:20:45,285 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:20:45,290 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:20:46,671 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:20:46,672 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:20:46,675 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 05:20:46,677 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:20:46,678 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:20:46,681 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:20:46,700 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:20:46,702 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:20:46,705 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:20:46,707 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:20:46,710 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:20:46,715 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:20:46,716 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:20:46,717 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:20:50,676 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:20:50,678 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:20:50,696 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:20:54,631 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:20:54,631 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:20:54,633 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:20:54,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:20:58,490 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:21:11,977 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:21:12,640 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:21:13,379 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:21:13,542 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:21:51,619 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:21:55,296 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:21:58,730 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:22:02,694 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:22:07,090 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:22:07,091 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:22:07,092 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:22:07,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:22:07,708 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:22:07,709 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:22:09,188 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:22:17,872 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:22:18,294 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 05:22:18,468 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:22:19,746 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:22:19,754 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:22:22,859 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-12 05:22:22,859 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:22:23,672 - ispa_next.appointments.models - DEBUG - Appointment Ellen Persch RÜD-EP 90 WMW51DK0402T35996 ohne Termin.
2025-11-12 05:22:23,679 - ispa_next.main - DEBUG - 



2025-11-12 05:22:23,679 - ispa_next.main - DEBUG - starting with process 3 (WI-NG 340) of 6
2025-11-12 05:22:23,686 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:22:24,817 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:22:25,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:22:25,754 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-12 05:22:26,989 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:22:26,990 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:22:55,954 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:22:58,079 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:23:03,080 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:23:07,674 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:23:07,674 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:07,752 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:23:07,923 - ispa_next.functions - DEBUG - HU date already expired after 429 days.
2025-11-12 05:23:11,410 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:23:11,412 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:23:14,076 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:23:14,077 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:23:15,055 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:23:17,062 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:23:17,174 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:23:17,262 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:23:17,344 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:23:21,518 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:23:22,524 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:23:22,524 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:23,034 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:37,184 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:23:41,233 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:23:41,235 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:41,320 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:23:41,321 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:23:41,396 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:23:42,607 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:23:42,858 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:23:44,610 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:23:44,611 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:44,673 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:23:44,848 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:23:44,849 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:23:45,698 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:23:45,698 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:23:46,309 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:23:50,319 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:23:50,319 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:23:50,321 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:23:50,321 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:23:50,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:23:50,845 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:23:54,955 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:23:54,957 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:23:54,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:23:55,061 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:23:55,427 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:55,971 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:23:55,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:23:56,653 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:23:56,655 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:24:00,845 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:24:00,849 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:24:01,898 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:24:01,902 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:24:01,904 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 05:24:01,908 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:24:01,910 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:24:01,913 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:24:01,914 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:24:01,914 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:24:01,917 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:24:01,918 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:24:01,920 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:24:01,922 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:24:01,924 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:24:01,925 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:06,468 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:24:06,469 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:24:06,472 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:11,079 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:24:11,081 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:24:11,081 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:24:11,083 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:24:15,634 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:24:28,918 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:24:29,700 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:24:30,516 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:24:30,688 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:25:15,266 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:19,264 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:23,562 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:27,191 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:31,270 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:35,816 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:25:35,818 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:25:35,820 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:25:36,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:25:36,647 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:25:36,649 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:25:38,513 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:25:46,756 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:25:47,136 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 05:25:47,681 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:25:48,833 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:25:48,835 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:25:51,821 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-12 05:25:51,821 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:25:52,637 - ispa_next.appointments.models - DEBUG - Appointment Ellen Persch RÜD-EP 90 WMW51DK0402T35996 ohne Termin.
2025-11-12 05:25:52,642 - ispa_next.main - DEBUG - 



2025-11-12 05:25:52,642 - ispa_next.main - DEBUG - starting with process 4 (WI-SC 881) of 6
2025-11-12 05:25:52,645 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:25:53,806 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:25:55,079 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:25:55,080 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-12 05:25:56,656 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:25:56,657 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:26:30,384 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:26:32,128 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:26:36,568 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:26:40,480 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:26:40,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:40,549 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:26:40,703 - ispa_next.functions - DEBUG - HU date already expired after 17 days.
2025-11-12 05:26:44,368 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:26:44,369 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:26:47,099 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:26:47,100 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:26:48,049 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:26:50,054 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:26:50,163 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:26:50,237 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:26:50,305 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:26:54,486 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:26:55,491 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:26:55,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:26:55,999 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:27:09,371 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 05:27:13,841 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:27:13,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:27:13,944 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:27:13,944 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:27:14,006 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:27:15,262 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:27:15,493 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:27:18,330 - ispa_next.functions - DEBUG - Updated appointment (AM00019361) customer contact data.
2025-11-12 05:27:19,239 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:27:19,239 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:27:19,313 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:27:19,480 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:27:19,480 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:27:20,046 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:27:20,046 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:27:20,682 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:27:24,669 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:27:24,669 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:27:24,673 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:27:24,673 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:27:24,673 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:27:25,166 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:27:29,266 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 05:27:32,170 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:27:32,170 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:27:32,249 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:27:37,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:27:38,219 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:27:38,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:27:38,834 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:27:38,834 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:27:42,427 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:27:42,433 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:27:44,485 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:27:44,485 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:27:44,487 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 05:27:44,503 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:27:44,505 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:27:44,507 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:27:44,509 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:27:44,509 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:27:44,511 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:27:44,513 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:27:44,515 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:27:44,517 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:27:44,517 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:27:44,519 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:27:48,475 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:27:48,477 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:27:48,479 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:27:52,382 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:27:52,384 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:27:52,385 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:27:52,387 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:27:56,283 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:28:08,726 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:28:09,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:28:10,110 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:28:10,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:28:48,895 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:28:53,285 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:28:57,662 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:01,837 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:06,636 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:29:06,638 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:29:06,638 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:07,307 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:29:07,409 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:29:07,410 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:29:09,210 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:29:17,574 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:29:17,951 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 05:29:18,503 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:19,922 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:29:19,924 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:23,221 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-12 05:29:23,221 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:29:24,290 - ispa_next.appointments.models - DEBUG - Appointment Ellen Persch RÜD-EP 90 WMW51DK0402T35996 ohne Termin.
2025-11-12 05:29:24,303 - ispa_next.main - DEBUG - 



2025-11-12 05:29:24,303 - ispa_next.main - DEBUG - starting with process 5 (WI-NI 63) of 6
2025-11-12 05:29:24,308 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:29:25,557 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:29:26,883 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:29:26,884 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-12 05:29:28,513 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:29:28,515 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:30:02,913 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:30:04,577 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:30:09,175 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:30:12,388 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:30:12,390 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:12,483 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:12,856 - ispa_next.functions - DEBUG - HU date already expired after 18 days.
2025-11-12 05:30:17,135 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:30:17,137 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:30:19,952 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:19,953 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:20,799 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:30:22,804 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:30:22,906 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:30:22,986 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:30:23,094 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:30:27,294 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:30:28,299 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:30:28,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:28,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:38,090 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 05:30:42,383 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:30:42,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:42,471 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:42,471 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:30:42,561 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:30:42,682 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:30:43,869 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:30:44,091 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:30:47,089 - ispa_next.functions - DEBUG - Updated appointment (BA00011076) customer contact data.
2025-11-12 05:30:47,979 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:30:47,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:30:48,045 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:30:48,159 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:30:48,161 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:30:48,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:30:49,100 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:30:50,056 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:30:50,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:30:50,120 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 05:30:53,708 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:30:53,708 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:30:53,710 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:30:53,710 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:30:53,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:54,179 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:30:58,294 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:30:58,296 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:30:58,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:30:58,376 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:31:02,562 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:03,091 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:31:03,093 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:31:03,700 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:31:03,702 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:31:06,674 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:31:06,676 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:31:09,425 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:31:09,431 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:31:09,433 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 05:31:09,433 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:31:09,437 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:31:09,439 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 05:31:09,439 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:31:09,439 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:31:09,441 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:31:09,443 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:31:09,445 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:31:09,446 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:31:09,448 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:31:09,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:12,792 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:31:12,794 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:31:12,794 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:16,038 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:31:16,040 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:31:16,041 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:31:16,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:31:19,298 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:31:33,188 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:31:33,819 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:31:34,433 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:31:34,589 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:32:05,758 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:32:09,983 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:32:14,222 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:32:18,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:32:18,803 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:32:18,805 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:32:19,543 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:32:19,641 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:32:19,641 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:32:21,845 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:32:30,538 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:32:30,919 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 05:32:31,445 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:32:32,643 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:32:32,644 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:32:35,613 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-12 05:32:35,613 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:32:36,304 - ispa_next.appointments.models - DEBUG - Appointment Ellen Persch RÜD-EP 90 WMW51DK0402T35996 ohne Termin.
2025-11-12 05:32:36,309 - ispa_next.main - DEBUG - 



2025-11-12 05:32:36,309 - ispa_next.main - DEBUG - starting with process 6 (MTK-BU 1 E) of 6
2025-11-12 05:32:36,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:32:37,293 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:32:38,469 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:32:38,470 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 41
2025-11-12 05:32:40,004 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 05:32:40,006 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:33:14,303 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 05:33:16,411 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 05:33:21,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:33:24,450 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 05:33:24,451 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:24,509 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:33:24,707 - ispa_next.functions - DEBUG - HU date already expired after 35 days.
2025-11-12 05:33:27,824 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 05:33:27,826 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 05:33:30,575 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:33:30,577 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:33:31,730 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:33:33,748 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 05:33:33,853 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 05:33:33,947 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 05:33:34,017 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 05:33:38,261 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 05:33:39,267 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 05:33:39,268 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:39,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:51,387 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-12 05:33:55,596 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 05:33:55,598 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:33:55,688 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:33:55,689 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 05:33:55,731 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 05:33:57,008 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 05:33:58,171 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 05:33:58,425 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 05:34:01,472 - ispa_next.functions - DEBUG - Updated appointment (AR00013986) customer contact data.
2025-11-12 05:34:02,382 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 05:34:02,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:34:02,449 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 05:34:02,542 - ispa_next.functions - DEBUG - DMS info search failed: Dialog not available
2025-11-12 05:34:02,542 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 05:34:03,058 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 05:34:03,058 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 05:34:03,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 05:34:07,773 - ispa_next.functions - DEBUG - Home dealer assignment button not available
2025-11-12 05:34:07,789 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 05:34:07,790 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 05:34:07,795 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 05:34:07,795 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 05:34:07,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:34:08,319 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:34:12,419 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 05:34:12,421 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 05:34:12,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:34:12,480 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 05:34:17,980 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 05:34:18,432 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 05:34:18,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 05:34:19,090 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 05:34:19,091 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 05:34:22,137 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 05:34:22,138 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 05:34:23,628 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 05:34:23,630 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:34:23,631 - ispa_next.package_manager.main - DEBUG - Cannot place Auswuchten der Räder: placement requirements not met
2025-11-12 05:34:23,632 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 05:34:23,633 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 05:34:23,636 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 05:34:23,637 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 05:34:23,638 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 05:34:23,639 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 05:34:23,641 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 05:34:23,644 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 05:34:23,645 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 05:34:23,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:26,955 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 05:34:26,956 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 05:34:26,961 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:30,220 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 05:34:30,222 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 05:34:30,223 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 05:34:30,224 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:34:33,466 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 05:34:47,617 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 05:34:48,225 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:34:48,933 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 05:34:49,075 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 05:35:21,061 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:35:26,011 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:35:29,884 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:35:34,697 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 05:35:34,699 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 05:35:34,701 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 05:35:35,369 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 05:35:35,463 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 05:35:35,465 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 05:35:37,434 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 05:35:44,863 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 05:35:45,263 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 05:35:45,895 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 05:35:46,998 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 1482
2025-11-12 05:35:47,000 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 05:35:49,374 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 41
2025-11-12 05:35:49,374 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 05:35:50,098 - ispa_next.appointments.models - DEBUG - Appointment Ellen Persch RÜD-EP 90 WMW51DK0402T35996 ohne Termin.
