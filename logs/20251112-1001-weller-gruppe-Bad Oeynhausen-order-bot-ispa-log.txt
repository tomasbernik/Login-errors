2025-11-12 10:08:24,077 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-12 10:08:24,085 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-12 10:08:37,616 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-12 10:08:48,743 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-12 10:09:04,571 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-12 10:09:28,924 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-12 10:09:48,306 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-12 10:09:51,566 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:09:53,329 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:09:53,330 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 10:09:56,745 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 71
2025-11-12 10:09:56,746 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-12 10:09:56,747 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:09:58,314 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-12 10:09:59,754 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:12,523 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:12,547 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-12 10:10:12,563 - ispa_next.main - DEBUG - Found 7 out of 9 appointments to process (configured limit: 15).
2025-11-12 10:10:12,564 - ispa_next.main - DEBUG - Processing 3 fresh appointments.
2025-11-12 10:10:12,564 - ispa_next.main - DEBUG - Processing 4 already visited appointments (w/ RKR not callable).
2025-11-12 10:10:12,564 - ispa_next.main - DEBUG - All appointments: HF-M 1183, HF-KT 524, mi mp 200, GT-WK 7070, OS-MW 37, MI-JH356, MI-EI 121E
2025-11-12 10:10:12,567 - ispa_next.main - DEBUG - 



2025-11-12 10:10:12,567 - ispa_next.main - DEBUG - starting with process 1 (HF-M 1183) of 7
2025-11-12 10:10:12,570 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:10:14,145 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:10:15,698 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:10:15,699 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 71
2025-11-12 10:10:17,848 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:10:17,850 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:10:54,570 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:11:06,097 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:08,722 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:11:08,723 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:08,876 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:09,121 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:11:09,124 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:11:12,139 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:11:12,141 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:11:13,527 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:11:15,530 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:11:15,694 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:11:19,234 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:11:19,336 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:11:19,338 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:11:22,093 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:11:30,651 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:11:31,656 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:11:31,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:32,177 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:46,496 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-12 10:11:55,495 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:11:55,497 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:11:55,591 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:11:55,592 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:11:55,708 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:11:57,299 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:11:58,795 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:11:59,225 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:12:02,235 - ispa_next.functions - DEBUG - Updated appointment (AB00029959) customer contact data.
2025-11-12 10:12:03,186 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:12:03,189 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:12:04,325 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:12:04,326 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:12:05,117 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:12:08,828 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:12:08,830 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:09,347 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:11,350 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:12:11,526 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:12:11,668 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:12:11,761 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:12:11,763 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:14,475 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:12:26,383 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-12 10:12:31,622 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:12:31,624 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:12:34,318 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:12:38,548 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:12:39,553 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:12:39,554 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:12:39,555 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:39,687 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:12:43,837 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:12:43,841 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:12:43,842 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:43,965 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:12:49,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:50,480 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:12:50,481 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:12:52,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:12:52,343 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:12:55,464 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:12:55,468 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:12:56,504 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:12:56,506 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:12:56,510 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-12 10:12:56,512 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:12:56,514 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:12:56,516 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:12:56,517 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:12:56,519 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:12:56,520 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:12:56,522 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:12:56,524 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:12:57,300 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:12:57,995 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:13:04,300 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:13:04,302 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:13:04,303 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:13:04,304 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:07,716 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:13:07,717 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:13:07,720 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:11,289 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:13:11,289 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:13:11,291 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:14,641 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:13:14,642 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:13:15,230 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:13:15,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:26,272 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:13:26,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:13:29,669 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:13:43,399 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:13:43,943 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:13:44,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:13:44,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:14:17,486 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:22,235 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:27,209 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:32,362 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:14:32,365 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:14:32,365 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:33,273 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:14:33,365 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:14:33,366 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:14:35,665 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:14:48,564 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:14:48,983 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-12 10:14:50,313 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:51,120 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:14:51,121 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:14:55,386 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 10:14:55,386 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:14:56,501 - ispa_next.main - DEBUG - 



2025-11-12 10:14:56,501 - ispa_next.main - DEBUG - starting with process 2 (HF-KT 524) of 7
2025-11-12 10:14:56,505 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:14:58,038 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:14:59,635 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:14:59,637 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 10:15:01,564 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:15:01,566 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:15:44,539 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:15:56,256 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:04,420 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:16:04,421 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:04,532 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:04,922 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:16:04,925 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:05,135 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:13,333 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:16:16,343 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:16:16,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:16:17,635 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:16:19,639 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:16:19,824 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:16:19,928 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:16:20,016 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:16:20,018 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:16:28,476 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:16:37,049 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-12 10:16:38,054 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:16:38,055 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:38,584 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:49,339 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:16:58,520 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:16:58,522 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:16:58,635 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:16:58,636 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:16:58,746 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:17:00,568 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:17:02,167 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:17:02,507 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:17:04,548 - ispa_next.functions - DEBUG - Updated appointment (AA00050509) customer contact data.
2025-11-12 10:17:05,488 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:17:05,489 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:17:06,731 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:17:06,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:17:07,762 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:17:11,421 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:17:11,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:17:11,914 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:17:13,916 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:17:14,075 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:17:14,262 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:17:14,344 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-12 10:17:14,345 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:17:22,863 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:17:31,729 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-12 10:18:31,733 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-12 10:18:42,700 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-12 10:18:48,869 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-12 10:18:48,871 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:18:57,296 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:19:01,518 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-12 10:19:02,523 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:19:02,524 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:19:02,525 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:02,703 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:19:06,861 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-12 10:19:07,886 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-12 10:19:23,252 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:19:23,253 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:23,841 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:19:24,246 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:24,866 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:19:24,867 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:19:25,983 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:19:25,985 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:19:33,707 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:19:33,709 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:19:35,743 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:19:35,745 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:35,749 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Interne Qualitätssicherung, source=from_tab, target=cart), Package(name=Kostenlose maschinelle Oberwäsche, source=from_tab, target=cart)}
2025-11-12 10:19:35,752 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:19:35,758 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-12 10:19:35,762 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:19:35,765 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:19:35,766 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:19:35,768 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:19:35,770 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-12 10:19:36,641 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kataloge
2025-11-12 10:19:37,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kataloge
2025-11-12 10:19:55,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-12 10:19:56,210 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-12 10:20:03,585 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-12 10:20:03,587 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-12 10:20:09,073 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:09,658 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:10,215 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:11,834 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:12,386 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:12,935 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:14,526 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:15,087 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:15,652 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:17,269 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:17,844 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:18,394 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:20,002 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:20,553 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:21,109 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:22,681 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:23,241 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:23,798 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:25,366 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:25,923 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:26,480 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:28,084 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:28,670 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:29,232 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:31,846 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:32,401 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:32,954 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:34,528 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:35,103 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:35,664 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:37,300 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:37,853 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:38,404 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:40,068 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:40,642 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:41,196 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:42,831 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-12 10:20:43,382 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-12 10:20:43,932 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1650, 0)
2025-11-12 10:20:44,480 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1630, 0)
2025-11-12 10:20:45,059 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1620, 0)
2025-11-12 10:20:45,639 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1610, 0)
2025-11-12 10:20:46,191 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1600, 0)
2025-11-12 10:20:46,191 - ispa_next.package_manager.helper - DEBUG - Error during package identification in cart detail view
2025-11-12 10:20:48,482 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 112, in process_appointment
    package_manager.run()
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 266, in run
    self._process_to_advice_list(self.to_advice_list)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\main.py", line 234, in _process_to_advice_list
    self.ui_helper.cart_operation(self.base_element, move_to_container)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 551, in cart_operation
    raise e
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\package_manager\helper.py", line 507, in cart_operation
    raise ValueError("Package not found in cart operation.")
ValueError: Package not found in cart operation.

2025-11-12 10:20:48,717 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:20:48,718 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:20:50,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:20:51,540 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:20:51,541 - ispa_next.appointment_ending - DEBUG - complete_process exists early.
2025-11-12 10:20:51,584 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-12 10:20:58,491 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-12 10:20:58,494 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:20:59,892 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:20:59,894 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:06,889 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 10:21:06,890 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:21:09,133 - ispa_next.main - DEBUG - 



2025-11-12 10:21:09,133 - ispa_next.main - DEBUG - starting with process 3 (mi mp 200) of 7
2025-11-12 10:21:09,137 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:21:12,094 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:21:15,424 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:21:15,427 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 10:21:18,726 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:21:18,728 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:02,137 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 43, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\azureuser\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 160, in handle_briefing_screen
    raise AppointmentNotSynchronized(
ispa_next.exceptions.AppointmentNotSynchronized: Appointment is not properly synchronized with DMS, proceed with the next one.

2025-11-12 10:22:02,149 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-12 10:22:02,152 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:03,481 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:22:03,483 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:10,043 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 10:22:10,044 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:22:11,983 - ispa_next.main - DEBUG - 



2025-11-12 10:22:11,983 - ispa_next.main - DEBUG - starting with process 4 (GT-WK 7070) of 7
2025-11-12 10:22:11,989 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:22:14,941 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:22:18,509 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:22:18,511 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 10:22:21,885 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:22:21,887 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:23:12,058 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:23:16,575 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:23:25,325 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:23:29,570 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:23:29,571 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:29,778 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:23:30,319 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:23:41,793 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:23:41,796 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:23:45,172 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:23:45,174 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:23:47,290 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:23:49,293 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:23:49,512 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:23:49,761 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:23:49,932 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:23:54,269 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:23:55,275 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:23:55,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:23:55,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:11,183 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:24:20,274 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:24:20,277 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:24:20,478 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:24:20,479 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:24:20,577 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:24:22,162 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:24:22,545 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:24:25,600 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:24:25,603 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:24:27,652 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:24:27,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:24:29,123 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:24:32,765 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:24:32,765 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:24:32,768 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:24:32,769 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:24:32,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:33,368 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:24:37,583 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:24:37,588 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:24:37,589 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:24:37,747 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:24:47,332 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:25:02,659 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:25:03,211 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:03,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:25:03,932 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:25:05,154 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:25:05,156 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:25:09,254 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:25:09,256 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:25:11,477 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:25:11,478 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:25:11,481 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:25:11,482 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:25:11,486 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:25:11,488 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:25:11,489 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:25:11,492 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:25:11,493 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:25:11,496 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:25:11,499 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:25:11,501 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:25:11,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:15,862 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:25:15,864 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:25:15,866 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:20,099 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:25:20,099 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:25:20,101 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:24,396 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:25:24,397 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:25:25,904 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:25:26,302 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:46,135 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:25:46,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:25:50,460 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:26:13,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:26:14,298 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:26:15,067 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:26:15,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:26:59,098 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:07,290 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:15,735 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:24,033 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:34,180 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:27:34,182 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:27:34,183 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:27:35,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:27:36,002 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:27:36,004 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:27:40,433 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:27:59,299 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:27:59,818 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-12 10:28:01,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:03,598 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:28:03,601 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:10,666 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 10:28:10,667 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:28:12,607 - ispa_next.main - DEBUG - 



2025-11-12 10:28:12,608 - ispa_next.main - DEBUG - starting with process 5 (OS-MW 37) of 7
2025-11-12 10:28:12,642 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:28:15,713 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:28:19,125 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:28:19,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 10:28:22,352 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:28:22,354 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:29:12,076 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:29:16,535 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:29:25,004 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:29:29,927 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:29:29,928 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:30,129 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:29:30,689 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:29:30,692 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:29:34,901 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:29:34,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:29:37,522 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:29:39,525 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:29:39,732 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:29:39,982 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:29:40,126 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:29:44,550 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:29:45,555 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:29:45,556 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:29:46,141 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:02,593 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:30:11,728 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:30:11,731 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:11,890 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:30:11,891 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:30:11,995 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:30:12,268 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-12 10:30:14,392 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:30:14,751 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:30:17,392 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:30:17,394 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:30:17,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:30:19,124 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:30:21,268 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:30:21,269 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:30:21,441 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-12 10:30:25,078 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:30:25,078 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:30:25,081 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:30:25,082 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:30:25,083 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:25,646 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:29,924 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:30:29,928 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:30:29,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:30,104 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:30:39,067 - ispa_next.wipers - DEBUG - valid contract found: BMW Bank
2025-11-12 10:30:53,144 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:30:53,629 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:54,791 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:30:54,793 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:30:55,821 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:30:55,823 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:31:00,329 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:31:00,332 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:31:02,826 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:31:02,835 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:31:02,838 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:31:02,839 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:31:02,842 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:31:02,844 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:31:02,845 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:31:02,848 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:31:02,849 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:31:02,852 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:31:02,856 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:31:02,857 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:31:02,858 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:08,000 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:31:08,002 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:31:08,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:13,026 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:31:13,026 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:31:13,045 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:18,193 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:31:18,194 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:31:19,577 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:31:19,768 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:28,681 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:31:28,686 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:31:33,758 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:31:56,869 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:31:57,485 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:31:58,169 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:31:58,635 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:32:49,049 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:32:57,714 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:33:06,232 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:33:15,089 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:33:24,276 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:33:33,474 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:33:33,476 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:33:33,477 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:33:35,079 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:33:35,252 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:33:35,253 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:33:39,839 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:33:58,929 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:33:59,357 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-12 10:34:01,680 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:03,230 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:34:03,232 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:10,232 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 85
2025-11-12 10:34:10,233 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:34:12,234 - ispa_next.main - DEBUG - 



2025-11-12 10:34:12,234 - ispa_next.main - DEBUG - starting with process 6 (MI-JH356) of 7
2025-11-12 10:34:12,239 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:34:15,142 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:34:18,636 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:34:18,638 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 85
2025-11-12 10:34:22,073 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:34:22,075 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:35:15,759 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:35:20,494 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:35:30,378 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:35:36,379 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:35:36,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:35:36,572 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:35:37,159 - ispa_next.functions - DEBUG - HU date is not available.
2025-11-12 10:35:46,331 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:35:46,335 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:35:49,610 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:35:49,612 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:35:51,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:35:53,988 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:35:54,194 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:35:54,485 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:35:54,635 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:35:58,958 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:35:59,962 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:35:59,963 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:00,526 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:16,976 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:36:26,908 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:36:26,911 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:36:27,085 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:36:27,086 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:36:27,180 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:36:28,826 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:36:29,237 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:36:35,142 - ispa_next.functions - DEBUG - Updated appointment (AA00050351) customer contact data.
2025-11-12 10:36:36,334 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:36:36,337 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:36:38,382 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:36:38,383 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:36:39,899 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:36:43,672 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:36:43,672 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:36:43,675 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:36:43,676 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:36:43,676 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:44,241 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:36:48,518 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:36:48,523 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:36:48,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:36:48,641 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:36:57,541 - ispa_next.wipers - DEBUG - valid contract found: BMW Service Plus
2025-11-12 10:37:11,928 - ispa_next.wipers - DEBUG - wipers found to add.
2025-11-12 10:37:12,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:13,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:37:13,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:37:14,727 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:37:14,729 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:37:20,106 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:37:20,108 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:37:22,304 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:37:22,305 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:37:22,309 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:37:22,311 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:37:22,315 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-12 10:37:22,316 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:37:22,318 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:37:22,322 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:37:22,324 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:37:22,328 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:37:22,361 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:37:22,363 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:37:22,364 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:28,127 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:37:28,129 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:37:28,134 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:33,905 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:37:33,905 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:37:33,909 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:39,572 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:37:39,573 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:37:41,192 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:37:41,753 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:37:56,478 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:37:56,481 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:38:02,510 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:38:27,503 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:38:28,160 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:38:28,996 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:38:29,396 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:39:17,680 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:39:17,681 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:39:19,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:39:19,498 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:39:19,500 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:39:28,216 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-12 10:39:48,527 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:39:48,972 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-12 10:39:51,289 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:39:53,005 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:39:53,007 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:00,341 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 10:40:00,342 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:40:02,282 - ispa_next.main - DEBUG - 



2025-11-12 10:40:02,283 - ispa_next.main - DEBUG - starting with process 7 (MI-EI 121E) of 7
2025-11-12 10:40:02,286 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:40:05,288 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:40:08,704 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:40:08,707 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 84
2025-11-12 10:40:12,237 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-12 10:40:12,239 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-12 10:41:01,323 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-12 10:41:06,272 - ispa_next.appointments.functions - DEBUG - Appointment was already processed in the past.
2025-11-12 10:41:14,953 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:41:18,531 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-12 10:41:18,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:18,687 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:41:19,270 - ispa_next.functions - DEBUG - HU date already expired after 265 days.
2025-11-12 10:41:31,748 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-12 10:41:31,751 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-12 10:41:35,097 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:41:35,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:41:37,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:41:39,056 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-12 10:41:39,253 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-12 10:41:39,520 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-12 10:41:39,685 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-12 10:41:44,022 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-12 10:41:45,028 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-12 10:41:45,029 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:41:45,558 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:02,370 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-12 10:42:12,118 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-12 10:42:12,120 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:12,259 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-12 10:42:12,260 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-12 10:42:12,389 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-12 10:42:14,075 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-12 10:42:14,460 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-12 10:42:17,419 - ispa_next.functions - DEBUG - Updated appointment (AA00050549) customer contact data.
2025-11-12 10:42:18,483 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-12 10:42:18,532 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-12 10:42:20,574 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-12 10:42:20,575 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-12 10:42:22,234 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-12 10:42:25,860 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-12 10:42:25,860 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-12 10:42:25,863 - ispa_next.functions - DEBUG - generate_attachments
2025-11-12 10:42:25,864 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-12 10:42:25,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:27,511 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:32,145 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-12 10:42:32,149 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-12 10:42:32,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:32,330 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-12 10:42:32,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:33,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-12 10:42:33,412 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-12 10:42:34,620 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-12 10:42:34,622 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-12 10:42:37,941 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-12 10:42:37,945 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-12 10:42:40,094 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-12 10:42:40,097 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:42:40,101 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-12 10:42:40,103 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-12 10:42:40,106 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-12 10:42:40,108 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-12 10:42:40,110 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-12 10:42:40,111 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-12 10:42:40,114 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-12 10:42:40,117 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-12 10:42:40,119 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-12 10:42:40,119 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:43,914 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-12 10:42:43,916 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-12 10:42:43,918 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:47,561 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-12 10:42:47,561 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-12 10:42:47,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:51,149 - ispa_next.functions - DEBUG - process_check_control
2025-11-12 10:42:51,150 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Beanstandungen
2025-11-12 10:42:52,472 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Beanstandungen
2025-11-12 10:42:52,561 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-12 10:42:52,563 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:42:56,125 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-12 10:43:18,286 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-12 10:43:18,849 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:43:19,594 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-12 10:43:19,952 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-12 10:43:56,164 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:04,803 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:13,703 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:23,310 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-12 10:44:23,312 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-12 10:44:23,313 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-12 10:44:24,920 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-12 10:44:25,116 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-12 10:44:25,117 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-12 10:44:29,529 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-12 10:44:48,209 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-12 10:44:48,639 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-12 10:44:50,887 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-12 10:44:52,556 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 305
2025-11-12 10:44:52,570 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-12 10:45:00,002 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 84
2025-11-12 10:45:00,024 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
