2025-11-17 14:00:52,863 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 14:00:52,871 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 14:01:06,964 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 14:01:19,911 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 14:01:35,489 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 14:02:00,825 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 14:02:16,132 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 14:02:18,295 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:02:19,224 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 328
2025-11-17 14:02:19,225 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 221
2025-11-17 14:02:21,186 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 220
2025-11-17 14:02:21,187 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 14:02:21,187 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:02:22,034 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 14:02:22,893 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:02:55,314 - ispa_next.appointments.models - DEBUG - Appointment Andreas Georg Dudek KK-AD 759 WBAHS910805H70160 ohne Termin.
2025-11-17 14:02:55,324 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:02:55,333 - ispa_next.appointments.models - DEBUG - Appointment Heike Zarabski-Tofing GEL-JH 12E WBY11HH020CT36363 ohne Termin.
2025-11-17 14:02:55,343 - ispa_next.appointments.models - DEBUG - Appointment Can Luka Celik GEL-CC 30 WBA31BN040CN13021 ohne Termin.
2025-11-17 14:02:55,355 - ispa_next.appointments.models - DEBUG - Appointment Helga Nobis MO-TH 2488 WBAHS110205F48912 ohne Termin.
2025-11-17 14:02:55,365 - ispa_next.appointments.models - DEBUG - Appointment Thomas Mesenhol GEL-T 6370 WBA51AJ020CN02494 ohne Termin.
2025-11-17 14:02:55,373 - ispa_next.appointments.models - DEBUG - Appointment Stephanie Rinsche-Stöcker KLE-RI 239 WBA11CG0X0CJ30646 ohne Termin.
2025-11-17 14:02:55,399 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:55,426 - ispa_next.appointments.models - DEBUG - Appointment Jürgen Franz Tönnessen KLE-JT 304 WBA3A11000J283456 ohne Termin.
2025-11-17 14:02:55,437 - ispa_next.appointments.models - DEBUG - Appointment Daria Kamila Kolodziej KLE-QR 734 WBA8L71060K555733 ohne Termin.
2025-11-17 14:02:55,454 - ispa_next.appointments.models - DEBUG - Appointment Oliver Christian Wiegand MH-WI 1001 WMWZM31040T035812 ohne Termin.
2025-11-17 14:02:55,463 - ispa_next.appointments.models - DEBUG - Appointment Rabiullah Arash GEL-NK 786 WBAWZ510800M35552 ohne Termin.
2025-11-17 14:02:55,465 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 14:02:55,473 - ispa_next.main - DEBUG - Found 14 out of 23 appointments to process (configured limit: 15).
2025-11-17 14:02:55,473 - ispa_next.main - DEBUG - Processing 14 fresh appointments.
2025-11-17 14:02:55,473 - ispa_next.main - DEBUG - All appointments: WES-M 768E, GEL-LB 228, MO-FH 714, GEL-C 308, WES-LP 22, GEL-K 476, MO-VE 157, KLE-MY 369, KLE-W 1982, KLE-PR 281, KLE-CS 99, GEL-F 198E, M-D-3722, KK-B 602
2025-11-17 14:02:55,476 - ispa_next.main - DEBUG - 



2025-11-17 14:02:55,476 - ispa_next.main - DEBUG - starting with process 1 (WES-M 768E) of 14
2025-11-17 14:02:55,480 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:02:56,489 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:02:57,505 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 328
2025-11-17 14:02:57,506 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 220
2025-11-17 14:02:58,948 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:02:58,949 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:03:27,104 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:03:36,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:36,293 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:36,448 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:03:38,995 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:03:38,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:39,066 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:39,260 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:03:39,262 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:03:39,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:03:39,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:03:42,271 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:03:42,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:03:43,081 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:03:45,084 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:03:45,188 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:03:48,434 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:03:48,505 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:03:48,506 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:03:59,705 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:04:00,709 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:04:00,720 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:01,224 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:12,334 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:04:12,334 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:04:18,804 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:04:18,806 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:04:18,893 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:04:18,894 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:04:18,961 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:04:20,212 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:04:21,545 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:04:21,797 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:04:24,912 - ispa_next.functions - DEBUG - Updated appointment (AM00012271) customer contact data.
2025-11-17 14:04:25,818 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:04:25,820 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:04:26,666 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:04:26,667 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:04:27,346 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:04:30,922 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:04:30,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:31,404 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:04:33,408 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:04:33,528 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:04:33,629 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:04:33,692 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:04:33,693 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:04:45,171 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:04:52,296 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:04:52,297 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:04:56,514 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:04:57,521 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:04:57,525 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:04:57,526 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:04:57,592 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:05:03,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:03,652 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:05:03,653 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:05:04,341 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:05:04,344 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:05:06,779 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:05:06,781 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:05:07,744 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:05:07,746 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:05:07,750 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 14:05:07,751 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:05:07,752 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:05:07,757 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:05:07,759 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:05:07,760 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:05:07,765 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:05:07,773 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:05:07,784 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:05:07,788 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:05:07,790 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:05:07,791 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:10,345 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:05:10,346 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:05:10,347 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:12,921 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:05:12,922 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:05:12,924 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:05:12,937 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:15,449 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:05:27,604 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:05:28,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:05:28,772 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:05:28,892 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:05:35,054 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:05:40,394 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:05:40,395 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:05:40,883 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:05:40,969 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:05:40,970 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:05:44,080 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:05:55,148 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:05:55,534 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 14:05:55,886 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:05:56,773 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 329
2025-11-17 14:05:56,774 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:05:59,706 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 222
2025-11-17 14:05:59,706 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:06:00,577 - ispa_next.appointments.models - DEBUG - Appointment van Bebber Heinz KR-VB 47 WBA51CM0908E52660 ohne Termin.
2025-11-17 14:06:00,585 - ispa_next.appointments.models - DEBUG - Appointment Andreas Georg Dudek KK-AD 759 WBAHS910805H70160 ohne Termin.
2025-11-17 14:06:00,592 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:06:00,599 - ispa_next.appointments.models - DEBUG - Appointment Heike Zarabski-Tofing GEL-JH 12E WBY11HH020CT36363 ohne Termin.
2025-11-17 14:06:00,607 - ispa_next.appointments.models - DEBUG - Appointment Can Luka Celik GEL-CC 30 WBA31BN040CN13021 ohne Termin.
2025-11-17 14:06:00,615 - ispa_next.appointments.models - DEBUG - Appointment Helga Nobis MO-TH 2488 WBAHS110205F48912 ohne Termin.
2025-11-17 14:06:00,622 - ispa_next.appointments.models - DEBUG - Appointment Thomas Mesenhol GEL-T 6370 WBA51AJ020CN02494 ohne Termin.
2025-11-17 14:06:00,629 - ispa_next.appointments.models - DEBUG - Appointment Stephanie Rinsche-Stöcker KLE-RI 239 WBA11CG0X0CJ30646 ohne Termin.
2025-11-17 14:06:00,634 - ispa_next.main - DEBUG - 



2025-11-17 14:06:00,634 - ispa_next.main - DEBUG - starting with process 2 (GEL-LB 228) of 14
2025-11-17 14:06:00,637 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:06:01,831 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:06:03,126 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 329
2025-11-17 14:06:03,127 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 222
2025-11-17 14:06:04,571 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:06:04,573 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:06:31,548 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:06:40,697 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:40,785 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:40,951 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:06:42,824 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:06:42,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:42,902 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:43,152 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:06:43,155 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:06:43,156 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:06:43,246 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:06:53,815 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:06:53,817 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:06:55,019 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:06:57,025 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:06:57,238 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:07:00,462 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:07:00,584 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:07:00,585 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:07:11,970 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:07:12,973 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:07:12,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:13,469 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:27,131 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:07:34,356 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:07:34,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:07:34,422 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:07:34,422 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:07:34,465 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:07:35,755 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:07:35,986 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:07:39,235 - ispa_next.functions - DEBUG - Updated appointment (AM00012265) customer contact data.
2025-11-17 14:07:40,160 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:07:40,163 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:07:40,987 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:07:40,988 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:07:41,656 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:07:45,233 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:07:45,234 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:07:45,713 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:07:47,718 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:07:47,839 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:07:47,981 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:07:48,079 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:07:48,080 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:07:59,530 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:08:59,534 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:09:10,718 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:09:31,721 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:09:43,044 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:09:50,399 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:09:51,405 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:09:51,408 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:09:51,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:51,549 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:09:51,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:52,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:09:52,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:09:53,202 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:09:53,205 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:09:55,110 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:09:55,135 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:09:56,174 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:09:56,177 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:09:56,181 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:09:56,183 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:09:56,187 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:09:56,188 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:09:56,189 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:09:56,192 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:09:56,193 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:09:56,197 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:09:56,200 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:09:56,878 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:09:57,662 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:10:04,752 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:10:04,754 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:10:04,755 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:10:04,756 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:07,402 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:10:07,404 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:10:07,406 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:10,013 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:10:10,015 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:10:10,017 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:10:10,027 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:12,578 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:10:26,314 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:10:26,959 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:10:27,565 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:10:27,790 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:10:34,378 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:10:40,275 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:10:40,276 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:10:40,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:10:40,820 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:10:40,821 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:10:44,133 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:10:51,495 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:10:51,875 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 14:10:52,428 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:10:52,904 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 329
2025-11-17 14:10:52,905 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:10:55,633 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 222
2025-11-17 14:10:55,634 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:10:56,361 - ispa_next.appointments.models - DEBUG - Appointment van Bebber Heinz KR-VB 47 WBA51CM0908E52660 ohne Termin.
2025-11-17 14:10:56,369 - ispa_next.appointments.models - DEBUG - Appointment Andreas Georg Dudek KK-AD 759 WBAHS910805H70160 ohne Termin.
2025-11-17 14:10:56,375 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:10:56,381 - ispa_next.appointments.models - DEBUG - Appointment Heike Zarabski-Tofing GEL-JH 12E WBY11HH020CT36363 ohne Termin.
2025-11-17 14:10:56,387 - ispa_next.appointments.models - DEBUG - Appointment Can Luka Celik GEL-CC 30 WBA31BN040CN13021 ohne Termin.
2025-11-17 14:10:56,394 - ispa_next.appointments.models - DEBUG - Appointment Helga Nobis MO-TH 2488 WBAHS110205F48912 ohne Termin.
2025-11-17 14:10:56,400 - ispa_next.appointments.models - DEBUG - Appointment Thomas Mesenhol GEL-T 6370 WBA51AJ020CN02494 ohne Termin.
2025-11-17 14:10:56,406 - ispa_next.appointments.models - DEBUG - Appointment Stephanie Rinsche-Stöcker KLE-RI 239 WBA11CG0X0CJ30646 ohne Termin.
2025-11-17 14:10:56,408 - ispa_next.main - DEBUG - 



2025-11-17 14:10:56,408 - ispa_next.main - DEBUG - starting with process 3 (MO-FH 714) of 14
2025-11-17 14:10:56,411 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:10:57,391 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:10:58,361 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 329
2025-11-17 14:10:58,367 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 222
2025-11-17 14:10:59,579 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:10:59,580 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:11:26,291 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:11:36,003 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:11:39,242 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:11:39,242 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:39,340 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:11:39,647 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:11:39,649 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:11:39,650 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:39,760 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:11:49,400 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:11:49,402 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:11:50,510 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:11:52,541 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:11:52,667 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:11:52,771 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:11:52,866 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:11:57,109 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:11:58,116 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:11:58,117 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:11:58,657 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:09,140 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:12:09,140 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:12:15,964 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:12:15,966 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:16,058 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:12:16,059 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:12:16,161 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:12:17,439 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:12:17,654 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:12:20,979 - ispa_next.functions - DEBUG - Updated appointment (AM00012240) customer contact data.
2025-11-17 14:12:21,909 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:12:21,910 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:12:22,498 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:12:22,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:12:23,172 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:12:26,731 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:12:26,731 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:12:26,749 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:12:26,752 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:12:26,752 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:12:27,274 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:12:27,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:28,143 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:12:28,144 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:12:28,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:12:28,767 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:12:31,762 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:12:31,767 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:12:32,727 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:12:32,728 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:12:32,733 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:12:32,745 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:12:32,751 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:12:32,752 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:12:32,752 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:12:32,756 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:12:32,756 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:12:32,760 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:12:32,762 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:12:33,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:12:34,147 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:12:40,844 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:12:40,846 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:12:40,848 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:12:40,848 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:44,860 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 14:12:47,161 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:12:47,162 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:12:47,164 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:51,182 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:12:51,184 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:12:51,185 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:12:51,187 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:12:55,127 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:13:07,440 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:13:08,095 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:13:08,760 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:13:08,908 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:13:16,882 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:13:23,154 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:13:23,155 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:23,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:13:23,842 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:13:23,843 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:13:27,274 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:13:35,226 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:13:35,624 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 14:13:36,326 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:36,867 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 329
2025-11-17 14:13:36,868 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:39,906 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 222
2025-11-17 14:13:39,907 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:13:40,792 - ispa_next.appointments.models - DEBUG - Appointment van Bebber Heinz KR-VB 47 WBA51CM0908E52660 ohne Termin.
2025-11-17 14:13:40,800 - ispa_next.appointments.models - DEBUG - Appointment Andreas Georg Dudek KK-AD 759 WBAHS910805H70160 ohne Termin.
2025-11-17 14:13:40,808 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:13:40,815 - ispa_next.appointments.models - DEBUG - Appointment Heike Zarabski-Tofing GEL-JH 12E WBY11HH020CT36363 ohne Termin.
2025-11-17 14:13:40,822 - ispa_next.appointments.models - DEBUG - Appointment Can Luka Celik GEL-CC 30 WBA31BN040CN13021 ohne Termin.
2025-11-17 14:13:40,829 - ispa_next.appointments.models - DEBUG - Appointment Helga Nobis MO-TH 2488 WBAHS110205F48912 ohne Termin.
2025-11-17 14:13:40,836 - ispa_next.appointments.models - DEBUG - Appointment Thomas Mesenhol GEL-T 6370 WBA51AJ020CN02494 ohne Termin.
2025-11-17 14:13:40,840 - ispa_next.main - DEBUG - Found new Appointment: KLE-RI 239
2025-11-17 14:13:40,841 - ispa_next.main - DEBUG - 



2025-11-17 14:13:40,841 - ispa_next.main - DEBUG - starting with process 4 (KLE-RI 239) of 15
2025-11-17 14:13:40,845 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:13:41,950 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:13:43,340 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 329
2025-11-17 14:13:43,341 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 222
2025-11-17 14:13:44,694 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:13:44,695 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:14:13,188 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:14:22,204 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:14:25,509 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:14:25,511 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:25,599 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:14:25,941 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:14:25,943 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:14:25,944 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:26,026 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:14:29,252 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:14:29,254 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:14:30,251 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:14:32,257 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:14:32,423 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:14:35,666 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:14:35,759 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:14:39,917 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 14:14:40,921 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:14:40,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:41,382 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:51,949 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:14:58,205 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:14:58,207 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:14:58,272 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:14:58,272 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:14:58,385 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:14:59,574 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:14:59,790 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:15:03,030 - ispa_next.functions - DEBUG - Updated appointment (AV00009514) customer contact data.
2025-11-17 14:15:03,940 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:15:03,941 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:15:04,550 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:15:04,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:15:05,339 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:15:08,917 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:15:08,917 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:15:08,920 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:15:08,924 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:15:08,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:09,406 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:13,739 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:14,277 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:15:14,278 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:14,955 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:14,958 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:15:18,024 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:15:18,026 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:15:18,931 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:15:18,932 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:15:18,936 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:15:18,937 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:15:18,939 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: {Package(name=Ladewunsch und Ladezustand, source=cart, target=advice_list)}
2025-11-17 14:15:18,940 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:15:18,943 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:15:18,944 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:15:18,948 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:15:18,951 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:15:19,624 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:15:20,332 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:15:27,258 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:15:27,259 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 14:15:29,424 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:15:29,982 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:15:31,455 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:15:32,048 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:15:32,594 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:15:33,544 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:15:34,126 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:15:34,664 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:15:35,575 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:15:36,145 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:15:36,667 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:15:37,589 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:15:38,140 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:15:38,662 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 14:15:39,582 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:15:40,604 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 14:15:41,570 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 14:15:41,993 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:15:41,995 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:15:41,995 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:45,232 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:15:45,233 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:15:45,235 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:15:48,491 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:15:48,949 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:15:58,189 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:11,274 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:16:11,275 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:16:11,276 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:16:11,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:14,668 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 14:16:23,903 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:16:37,616 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:16:38,218 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:16:38,828 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:16:38,947 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:16:46,593 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:16:53,137 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:16:53,138 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:16:53,769 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:16:53,863 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:16:53,864 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:16:57,554 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:17:05,526 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:17:05,904 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 14:17:06,841 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:17:07,386 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 331
2025-11-17 14:17:07,387 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:17:10,266 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 224
2025-11-17 14:17:10,267 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:17:10,938 - ispa_next.appointments.models - DEBUG - Appointment van Bebber Heinz KR-VB 47 WBA51CM0908E52660 ohne Termin.
2025-11-17 14:17:10,944 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:17:10,951 - ispa_next.main - DEBUG - Found new Appointment: KK-AD 759
2025-11-17 14:17:10,951 - ispa_next.main - DEBUG - Found new Appointment: GEL-JH 12E
2025-11-17 14:17:10,951 - ispa_next.main - DEBUG - Found new Appointment: GEL-CC 30
2025-11-17 14:17:10,952 - ispa_next.main - DEBUG - Found new Appointment: MO-TH 2488
2025-11-17 14:17:10,953 - ispa_next.main - DEBUG - 



2025-11-17 14:17:10,953 - ispa_next.main - DEBUG - starting with process 5 (KK-AD 759) of 19
2025-11-17 14:17:10,956 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:17:11,922 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:17:12,966 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 331
2025-11-17 14:17:12,967 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 224
2025-11-17 14:17:14,505 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:17:14,506 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:17:45,690 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:17:55,649 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:55,771 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:55,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:17:59,136 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:17:59,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:59,196 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:17:59,413 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:17:59,416 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:17:59,416 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:17:59,546 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:18:09,227 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:18:09,229 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:18:10,531 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:18:12,552 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:18:12,659 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:18:12,789 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:18:12,876 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:18:12,877 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:18:23,776 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:18:30,803 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:18:30,803 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:18:35,008 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:18:36,013 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:18:36,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:36,506 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:48,314 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:18:56,288 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:18:56,291 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:18:56,386 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:18:56,386 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:18:56,437 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:18:57,624 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:18:58,880 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:18:59,088 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:19:02,163 - ispa_next.functions - DEBUG - Updated appointment (AV00009525) customer contact data.
2025-11-17 14:19:03,064 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:19:03,065 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:19:04,136 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:19:04,137 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:19:04,972 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:19:09,380 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:19:09,380 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:19:09,382 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:19:09,384 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:19:09,385 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:09,842 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:19:10,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:10,716 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:19:10,717 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:11,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:19:11,446 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:19:14,494 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:19:14,495 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:19:15,688 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:19:15,690 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:19:15,704 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 14:19:15,707 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:19:15,716 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:19:15,723 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:19:15,732 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:19:15,746 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:19:15,752 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:19:15,753 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:19:15,758 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:19:15,762 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:19:15,763 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:19:15,764 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:19,125 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:19:19,126 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:19:19,127 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:22,363 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:19:22,440 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:19:31,912 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:44,537 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:19:44,538 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:19:44,540 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:19:44,542 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:19:47,777 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 14:19:56,170 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:20:08,346 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:20:08,904 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:20:09,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:20:09,863 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:20:17,341 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:20:23,240 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:20:23,240 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:23,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:20:23,789 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:20:23,791 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:20:26,799 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:20:35,526 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:20:35,902 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 14:20:36,969 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:37,710 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 331
2025-11-17 14:20:37,712 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:40,983 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 224
2025-11-17 14:20:40,984 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:20:41,950 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:20:41,958 - ispa_next.main - DEBUG - Found new Appointment: KR-VB 47
2025-11-17 14:20:41,960 - ispa_next.main - DEBUG - 



2025-11-17 14:20:41,960 - ispa_next.main - DEBUG - starting with process 6 (KR-VB 47) of 20
2025-11-17 14:20:41,964 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:20:43,267 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:20:44,653 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 331
2025-11-17 14:20:44,654 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 224
2025-11-17 14:20:46,149 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:20:46,151 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:21:21,917 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:21:31,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:31,539 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:31,711 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:21:33,643 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:21:33,644 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:33,745 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:33,971 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:21:33,974 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:21:33,975 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:34,083 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:21:37,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:21:37,408 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:21:38,553 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:21:40,556 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:21:40,659 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:21:43,860 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:21:43,927 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:21:43,928 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:21:55,160 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:21:56,164 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:21:56,165 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:21:56,654 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:08,749 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:22:08,749 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 14:22:16,776 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:22:16,777 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:22:16,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:22:16,845 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:22:16,882 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:22:18,095 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:22:19,284 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:22:19,548 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:22:23,165 - ispa_next.functions - DEBUG - Updated appointment (AV00009536) customer contact data.
2025-11-17 14:22:24,113 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:22:24,114 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:22:24,770 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:22:24,770 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:22:25,505 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:22:29,102 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:22:29,102 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:29,590 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:22:31,593 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:22:31,725 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:22:31,831 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:22:31,892 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:22:31,892 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:22:43,117 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:22:50,320 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:22:50,320 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:22:54,538 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:22:55,544 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:22:55,548 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:22:55,548 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:22:55,626 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:23:01,208 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:01,676 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:23:01,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:23:02,343 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:23:02,347 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:23:04,225 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:23:04,231 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:23:05,251 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:23:05,252 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:23:05,255 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 14:23:05,260 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:23:05,262 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:23:05,268 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:23:05,270 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:23:05,271 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:23:05,275 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:23:05,277 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:23:05,280 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:23:05,283 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:23:05,284 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:23:05,285 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:07,163 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:23:07,164 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:23:07,166 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:09,037 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:23:09,039 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:23:09,040 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:23:09,043 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:10,979 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:23:24,466 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:23:25,119 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:23:25,874 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:23:26,036 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:23:32,069 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:23:37,858 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:23:37,859 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:23:38,328 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:23:38,405 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:23:38,406 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:23:41,845 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:23:49,478 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:23:49,869 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 6.
2025-11-17 14:23:50,446 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:23:51,175 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 332
2025-11-17 14:23:51,176 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:23:54,639 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 225
2025-11-17 14:23:54,640 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:23:55,370 - ispa_next.appointments.models - DEBUG - Appointment Helene Swyen GEL-HW 2 WBA11EE0105166695 ohne Termin.
2025-11-17 14:23:55,376 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:23:55,383 - ispa_next.main - DEBUG - 



2025-11-17 14:23:55,383 - ispa_next.main - DEBUG - starting with process 7 (GEL-JH 12E) of 20
2025-11-17 14:23:55,386 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:23:56,528 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:23:57,523 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 332
2025-11-17 14:23:57,525 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 225
2025-11-17 14:23:59,058 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:23:59,059 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:24:35,462 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:24:45,214 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:45,281 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:24:45,466 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:24:48,135 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:24:48,136 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:48,211 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:24:48,435 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:24:48,437 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:24:48,438 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:24:48,547 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:24:51,841 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:24:51,843 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:24:53,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:24:55,077 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:24:55,239 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:24:58,463 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:24:58,544 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:24:58,544 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:25:09,690 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:25:10,708 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:25:10,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:11,238 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:25,717 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:25:33,477 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:25:33,479 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:25:33,554 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:25:33,555 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:25:33,639 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:25:34,964 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:25:35,223 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:25:38,622 - ispa_next.functions - DEBUG - Updated appointment (BH00010015) customer contact data.
2025-11-17 14:25:39,532 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:25:39,534 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:25:40,331 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:25:40,332 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:25:41,099 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:25:45,532 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:25:45,533 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:25:46,279 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:25:48,281 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:25:48,407 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:25:48,502 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:25:48,588 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:25:48,589 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:25:59,436 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:26:06,460 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:26:06,460 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:26:10,660 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:26:11,665 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:26:11,668 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:26:11,669 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:11,764 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:26:21,466 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:21,982 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:26:21,983 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:26:22,728 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:26:22,732 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:26:25,178 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:26:25,179 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:26:26,664 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:26:26,668 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:26:26,673 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:26:26,675 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:26:26,679 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:26:26,681 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:26:26,682 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:26:26,687 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:26:26,688 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:26:26,693 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:26:26,714 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:26:27,401 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:26:28,097 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:26:35,117 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:26:35,119 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:26:35,120 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:26:35,121 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:38,416 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:26:38,418 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:26:38,421 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:41,762 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:26:41,763 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:26:41,764 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:26:41,766 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:26:45,048 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:26:57,306 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:26:57,934 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:26:58,666 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:26:58,824 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:27:05,939 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:27:11,491 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:27:11,492 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:27:11,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:27:12,017 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:27:12,018 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:27:15,060 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:27:23,554 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:27:23,931 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 7.
2025-11-17 14:27:24,782 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:25,562 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 332
2025-11-17 14:27:25,564 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:28,920 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 224
2025-11-17 14:27:28,920 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:27:30,257 - ispa_next.appointments.models - DEBUG - Appointment Helene Swyen GEL-HW 2 WBA11EE0105166695 ohne Termin.
2025-11-17 14:27:30,266 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:27:30,271 - ispa_next.main - DEBUG - 



2025-11-17 14:27:30,271 - ispa_next.main - DEBUG - starting with process 8 (GEL-CC 30) of 20
2025-11-17 14:27:30,274 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:27:31,578 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:27:32,797 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 332
2025-11-17 14:27:32,799 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 224
2025-11-17 14:27:34,439 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:27:34,441 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:28:04,393 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:28:14,924 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:15,013 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:28:15,232 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:28:16,507 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:28:16,508 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:16,592 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:28:16,834 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:28:16,838 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:28:16,839 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:16,957 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:28:20,177 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:28:20,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:28:21,293 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:28:23,298 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:28:23,424 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:28:26,660 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:28:26,770 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:28:26,771 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:28:38,194 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:28:39,199 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:28:39,200 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:39,702 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:28:54,063 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:29:02,428 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:29:02,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:02,531 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:29:02,532 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:29:02,586 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:29:03,869 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:29:04,138 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:29:07,073 - ispa_next.functions - DEBUG - Updated appointment (AV00009519) customer contact data.
2025-11-17 14:29:08,054 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:29:08,055 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:29:09,344 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:29:09,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:29:10,094 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:29:13,692 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:29:13,694 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:29:14,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:29:16,216 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:29:16,344 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:29:16,439 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:29:16,561 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:29:16,561 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:29:27,536 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:29:34,705 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:29:34,705 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:29:38,909 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:29:39,950 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:29:39,953 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:29:39,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:29:40,017 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:29:45,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:46,089 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:29:46,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:29:46,789 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:29:46,792 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:29:48,154 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:29:48,156 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:29:49,160 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:29:49,167 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:29:49,174 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:29:49,176 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:29:49,180 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:29:49,181 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:29:49,182 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:29:49,186 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:29:49,187 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:29:49,192 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:29:49,202 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:29:49,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:29:50,617 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:29:57,780 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:29:57,782 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:29:57,784 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:29:57,785 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:29:59,769 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:29:59,770 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:29:59,772 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:01,736 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:30:01,738 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:30:01,739 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:30:01,741 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:03,660 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:30:16,824 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:30:17,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:30:17,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:30:18,103 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:30:23,987 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:30:30,190 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:30:30,191 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:30:30,868 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:30:30,976 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:30:30,977 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:30:34,763 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:30:42,191 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:30:42,592 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 8.
2025-11-17 14:30:43,319 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:30:43,891 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 14:30:43,892 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:30:46,252 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 14:30:46,253 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:30:46,984 - ispa_next.appointments.models - DEBUG - Appointment Hanno Baetcke KLE-B 9229 WBA11GR0209Y68717 ohne Termin.
2025-11-17 14:30:46,991 - ispa_next.appointments.models - DEBUG - Appointment Hanno Baetcke KLE-B 9119 WBA21EJ080CN02123 ohne Termin.
2025-11-17 14:30:47,001 - ispa_next.appointments.models - DEBUG - Appointment Helene Swyen GEL-HW 2 WBA11EE0105166695 ohne Termin.
2025-11-17 14:30:47,008 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:30:47,013 - ispa_next.main - DEBUG - 



2025-11-17 14:30:47,014 - ispa_next.main - DEBUG - starting with process 9 (MO-TH 2488) of 20
2025-11-17 14:30:47,017 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:30:48,062 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:30:49,768 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 14:30:49,770 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 14:30:51,333 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:30:51,334 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:31:19,721 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:31:29,316 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:29,392 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:29,631 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:31:30,907 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:31:30,907 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:31,017 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:31,275 - ispa_next.functions - DEBUG - HU date already expired after 2151 days.
2025-11-17 14:31:38,703 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:31:38,708 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:31:38,709 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:31:38,798 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:31:49,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:31:49,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:31:50,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:31:52,439 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:31:52,566 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:31:55,793 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:31:55,877 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:31:55,878 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:32:07,323 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:32:08,327 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:32:08,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:08,829 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:21,598 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:32:29,458 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:32:29,460 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:32:29,531 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:32:29,532 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:32:29,577 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:32:29,671 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:32:30,844 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 14:32:32,072 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 14:32:32,553 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:32:35,387 - ispa_next.functions - DEBUG - Updated appointment (AV00009518) customer contact data.
2025-11-17 14:32:36,382 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:32:36,384 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:32:36,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:32:37,861 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:32:39,470 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:32:39,471 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:32:39,693 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 14:32:43,439 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:32:43,441 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:32:43,978 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:32:45,983 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:32:46,075 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:32:46,218 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:32:46,314 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:32:46,314 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:32:57,662 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:33:57,664 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:34:09,263 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:34:20,266 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:34:31,364 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:34:39,223 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:34:40,229 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:34:40,231 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:34:40,232 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:40,338 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:34:40,704 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:41,242 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:34:41,243 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:34:41,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:34:41,948 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:34:43,841 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:34:43,843 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:34:44,890 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:34:44,897 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:34:44,902 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:34:44,904 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:34:44,907 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:34:44,923 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:34:44,925 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:34:44,928 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:34:44,930 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:34:44,934 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:34:44,936 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:34:45,606 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:34:46,344 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:34:53,645 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:34:53,647 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:34:53,648 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:34:53,649 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:56,305 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:34:56,307 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:34:56,309 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:34:58,906 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:34:58,907 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:34:58,907 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:34:58,921 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:01,567 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:35:14,350 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:35:14,927 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:35:15,533 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:35:15,656 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:35:22,740 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:35:28,674 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:35:28,675 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:35:29,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:35:29,521 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:35:29,523 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:35:33,326 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:35:41,832 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:35:42,207 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 9.
2025-11-17 14:35:43,008 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:35:43,819 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:35:43,820 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:35:46,975 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 14:35:46,976 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:35:47,883 - ispa_next.appointments.models - DEBUG - Appointment Norbert Sprünken KLE-RN 998 WBA2A51020V236022 ohne Termin.
2025-11-17 14:35:47,893 - ispa_next.appointments.models - DEBUG - Appointment Hanno Baetcke KLE-B 9229 WBA11GR0209Y68717 ohne Termin.
2025-11-17 14:35:47,912 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:35:47,914 - ispa_next.main - DEBUG - Found new Appointment: KLE-B 9119
2025-11-17 14:35:47,914 - ispa_next.main - DEBUG - Found new Appointment: GEL-HW 2
2025-11-17 14:35:47,916 - ispa_next.main - DEBUG - 



2025-11-17 14:35:47,917 - ispa_next.main - DEBUG - starting with process 10 (KLE-B 9119) of 22
2025-11-17 14:35:47,920 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:35:49,153 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:35:50,128 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:35:50,129 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 14:35:51,681 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:35:51,683 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:36:28,073 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:36:38,001 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:38,090 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:36:38,249 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:36:40,864 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:36:40,865 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:40,946 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:36:41,258 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:36:41,260 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:36:41,261 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:36:41,358 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:36:44,659 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:36:44,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:36:46,212 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:36:48,217 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:36:48,355 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:36:51,594 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:36:51,655 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:36:51,655 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:37:03,455 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:37:04,458 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:37:04,458 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:04,974 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:15,717 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:37:23,951 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:37:23,954 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:37:24,050 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:37:24,051 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:37:24,149 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:37:25,428 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:37:26,622 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:37:26,867 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:37:30,681 - ispa_next.functions - DEBUG - Updated appointment (AV00009543) customer contact data.
2025-11-17 14:37:31,656 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:37:31,658 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:37:32,551 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:37:32,551 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:37:33,447 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:37:37,030 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:37:37,032 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:37:37,519 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:37:39,523 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:37:39,646 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:37:39,765 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:37:39,827 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:37:39,828 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:37:51,521 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:38:51,524 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:39:02,484 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:39:09,891 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:39:09,891 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:39:14,154 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:39:15,160 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:39:15,162 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:39:15,162 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:39:15,246 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:39:30,489 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:39:31,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:39:31,014 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:39:31,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:39:31,737 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:39:34,244 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:39:34,246 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:39:35,451 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:39:35,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:39:35,457 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:39:35,458 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:39:35,461 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:39:35,465 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:39:35,466 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:39:35,476 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:39:35,488 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:39:35,495 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:39:35,499 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:39:36,193 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:39:37,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:39:44,954 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:39:44,956 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:39:44,958 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:39:44,958 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:48,272 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:39:48,274 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:39:48,276 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:51,559 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:39:51,560 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:39:51,561 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:39:51,566 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:39:54,856 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:40:08,454 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:40:09,112 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:40:09,802 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:40:10,024 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:40:18,080 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:40:24,284 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:40:24,285 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:40:25,008 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:40:25,133 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:40:25,134 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:40:28,888 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:40:37,854 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:40:38,237 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 10.
2025-11-17 14:40:39,066 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:40:39,871 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:40:39,872 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:40:43,144 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 14:40:43,145 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:40:43,944 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:40:43,948 - ispa_next.main - DEBUG - Found new Appointment: KLE-RN 998
2025-11-17 14:40:43,949 - ispa_next.main - DEBUG - Found new Appointment: KLE-B 9229
2025-11-17 14:40:43,950 - ispa_next.main - DEBUG - 



2025-11-17 14:40:43,950 - ispa_next.main - DEBUG - starting with process 11 (KLE-RN 998) of 24
2025-11-17 14:40:43,954 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:40:45,132 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:40:46,269 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:40:46,270 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 14:40:48,032 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:40:48,033 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:41:20,839 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:41:31,929 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:41:35,960 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:41:35,961 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:36,053 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:41:36,242 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:41:36,245 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:41:36,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:41:36,356 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:41:46,803 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:41:46,805 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:41:47,936 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:41:49,939 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:41:50,279 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:41:50,367 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:41:50,463 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:41:50,463 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:42:02,027 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 14:42:09,088 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:42:09,088 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:42:13,279 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:42:14,295 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:42:14,295 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:14,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:27,241 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:42:35,966 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:42:35,968 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:36,038 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:42:36,039 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:42:36,107 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:42:37,487 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:42:37,741 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:42:41,640 - ispa_next.functions - DEBUG - Updated appointment (AV00009551) customer contact data.
2025-11-17 14:42:42,619 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:42:42,621 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:42:43,487 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:42:43,488 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:42:44,440 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:42:48,092 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:42:48,092 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 14:42:48,095 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:42:48,098 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:42:48,099 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:42:48,564 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:42:48,933 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:49,430 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:42:49,431 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:42:50,227 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:42:50,230 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:42:53,847 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:42:53,852 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:42:54,976 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:42:54,977 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:42:54,980 - ispa_next.package_manager.main - DEBUG - Cannot place Fahrzeug maschinell waschen/aussaugen (kostenlos): active placement guards
2025-11-17 14:42:54,982 - ispa_next.package_manager.main - DEBUG - found packages to cart: set()
2025-11-17 14:42:54,982 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:42:54,986 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:42:54,987 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:42:54,988 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:42:54,992 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:42:54,993 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:42:54,998 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:42:55,008 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:42:55,011 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:42:55,012 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:42:58,986 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:42:58,988 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:42:58,989 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:43:02,987 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:43:02,989 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:43:02,990 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:43:02,992 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:43:06,960 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:43:19,800 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:43:20,423 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:43:21,053 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:43:21,202 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:43:29,253 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:43:35,117 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:43:35,117 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:43:35,812 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:43:35,933 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:43:35,936 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:43:39,790 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:43:48,178 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:43:48,546 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 11.
2025-11-17 14:43:49,178 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:43:49,851 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:43:49,852 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:43:52,921 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 14:43:52,922 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:43:53,744 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:43:53,747 - ispa_next.main - DEBUG - 



2025-11-17 14:43:53,748 - ispa_next.main - DEBUG - starting with process 12 (KLE-B 9229) of 24
2025-11-17 14:43:53,755 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:43:54,986 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:43:56,265 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:43:56,267 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 14:43:57,986 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:43:57,987 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:44:27,710 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:44:37,590 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:37,649 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:37,805 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:44:39,702 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:44:39,703 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:39,770 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:39,927 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:44:39,928 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:44:39,929 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:44:39,989 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:44:43,353 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:44:43,355 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:44:44,693 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:44:46,696 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:44:46,820 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:44:50,043 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:44:50,120 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:44:50,120 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:45:01,643 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:45:02,659 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:45:02,660 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:45:03,158 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:45:13,939 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 14:45:21,956 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:45:21,958 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:45:22,038 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:45:22,039 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:45:22,084 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:45:23,297 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:45:24,430 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:45:24,688 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:45:28,390 - ispa_next.functions - DEBUG - Updated appointment (AV00009545) customer contact data.
2025-11-17 14:45:29,298 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:45:29,306 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:45:30,321 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:45:30,322 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:45:31,850 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:45:35,433 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:45:35,434 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:45:35,940 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:45:37,945 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:45:38,063 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:45:38,166 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:45:38,240 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:45:38,240 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:45:49,343 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:46:49,345 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:47:01,219 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:47:28,221 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:47:39,700 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:47:47,648 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:47:48,654 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:47:48,656 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:47:48,657 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:47:48,759 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:47:54,323 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:54,848 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:47:54,848 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:47:55,514 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:47:55,517 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:47:57,335 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:47:57,337 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:47:58,303 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:47:58,318 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:47:58,322 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:47:58,323 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:47:58,326 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:47:58,327 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:47:58,327 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:47:58,332 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:47:58,333 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:47:58,336 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:47:58,339 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:47:59,033 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:47:59,785 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:48:06,990 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:48:06,993 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:48:06,994 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:48:06,994 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:09,635 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:48:09,636 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:48:09,638 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:12,238 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:48:12,239 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:48:12,240 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:48:12,241 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:14,897 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:48:26,126 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:48:26,701 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:48:27,387 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:48:27,609 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:48:35,161 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:48:41,511 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:48:41,511 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:42,192 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:48:42,261 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:48:42,262 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:48:46,017 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:48:53,300 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:48:53,682 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 12.
2025-11-17 14:48:54,447 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:48:55,239 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:48:55,240 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:48:57,951 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 14:48:57,952 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:48:58,863 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:48:58,866 - ispa_next.main - DEBUG - 



2025-11-17 14:48:58,866 - ispa_next.main - DEBUG - starting with process 13 (GEL-HW 2) of 24
2025-11-17 14:48:58,869 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:48:59,777 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:49:00,747 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:49:00,748 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 14:49:02,160 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:49:02,161 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:49:40,434 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:49:51,012 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:51,101 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:51,286 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:49:52,512 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:49:52,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:52,583 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:53,002 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:49:53,003 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:49:53,004 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:49:53,102 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:49:56,406 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:49:56,407 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:49:57,753 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:49:59,758 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:49:59,880 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:49:59,983 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:50:00,078 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:50:00,079 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:50:11,378 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:50:12,380 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:50:12,382 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:12,892 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:27,494 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 14:50:36,132 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:50:36,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:50:36,217 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:50:36,217 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:50:36,267 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:50:37,546 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:50:38,803 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:50:39,045 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:50:42,676 - ispa_next.functions - DEBUG - Updated appointment (AV00009542) customer contact data.
2025-11-17 14:50:43,748 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:50:43,750 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:50:45,156 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:50:45,157 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:50:46,167 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:50:49,743 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:50:49,745 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:50:50,300 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:50:52,303 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:50:52,439 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:50:52,555 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:50:52,653 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:50:52,654 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:51:04,140 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:52:04,142 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:52:16,087 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:52:41,090 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:52:52,434 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 14:53:00,348 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 14:53:01,354 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:53:01,357 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:53:01,358 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:53:01,426 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 14:53:07,081 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:53:07,566 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:53:07,567 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:53:08,181 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:53:08,185 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:53:09,524 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:53:09,526 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:53:10,551 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:53:10,552 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:53:10,558 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:53:10,560 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:53:10,566 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:53:10,567 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:53:10,568 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:53:10,573 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:53:10,574 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:53:10,578 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:53:10,579 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:53:11,276 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:53:12,031 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:53:19,135 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:53:19,137 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:53:19,138 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:53:19,138 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:21,054 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:53:21,056 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:53:21,058 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:22,910 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:53:22,912 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:53:22,913 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:53:22,914 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:24,816 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:53:38,342 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:53:39,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:53:39,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:53:39,986 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:53:46,820 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:53:53,044 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:53:53,045 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:53:53,760 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:53:53,877 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:53:53,878 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:53:57,943 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:54:06,702 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:54:07,073 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 13.
2025-11-17 14:54:07,907 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:54:08,724 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:54:08,726 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:11,937 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 14:54:11,938 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:54:12,809 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA1S51050V804353 ohne Termin.
2025-11-17 14:54:12,812 - ispa_next.main - DEBUG - 



2025-11-17 14:54:12,812 - ispa_next.main - DEBUG - starting with process 14 (GEL-C 308) of 24
2025-11-17 14:54:12,815 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:54:14,054 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:54:15,318 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 14:54:15,320 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 227
2025-11-17 14:54:17,018 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:54:17,020 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:54:58,653 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:55:08,758 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:08,844 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:09,029 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:55:11,771 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:55:11,772 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:11,848 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:12,142 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 14:55:12,145 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 14:55:12,146 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:12,236 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:15,407 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:55:15,409 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:55:16,788 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:55:18,793 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:55:18,909 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:55:22,118 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:55:22,211 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:55:22,211 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:55:33,846 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 14:55:34,850 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 14:55:34,851 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:35,381 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:47,759 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 14:55:55,513 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 14:55:55,515 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:55:55,579 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:55:55,579 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 14:55:55,618 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 14:55:56,856 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 14:55:58,113 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 14:55:58,388 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 14:56:02,264 - ispa_next.functions - DEBUG - Updated appointment (AM00012237) customer contact data.
2025-11-17 14:56:03,271 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 14:56:03,272 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 14:56:04,182 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 14:56:04,183 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 14:56:05,963 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 14:56:09,552 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 14:56:09,554 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 14:56:10,037 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 14:56:12,041 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 14:56:12,157 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 14:56:12,265 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 14:56:12,393 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 14:56:12,393 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:56:23,950 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 14:57:23,953 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 14:57:35,752 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 14:57:42,896 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 14:57:42,896 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 14:57:47,082 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 14:57:48,088 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 14:57:48,091 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 14:57:48,091 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 14:57:48,094 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 14:57:50,597 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 14:57:50,599 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 14:57:51,448 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 14:57:51,448 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:57:51,452 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 14:57:51,453 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 14:57:51,456 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 14:57:51,456 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 14:57:51,459 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 14:57:51,463 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 14:57:51,466 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 14:57:51,472 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 14:57:51,473 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 14:57:52,205 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 14:57:52,893 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 14:58:00,789 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 14:58:00,791 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 14:58:00,792 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 14:58:00,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:04,139 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 14:58:04,140 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 14:58:04,142 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:07,499 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 14:58:07,500 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 14:58:07,501 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 14:58:07,502 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:10,749 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 14:58:23,048 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 14:58:23,636 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:58:24,437 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 14:58:24,592 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:58:32,529 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 14:58:39,074 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 14:58:39,075 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:58:39,835 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 14:58:39,942 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 14:58:39,943 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 14:58:43,646 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 14:58:51,482 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 14:58:51,851 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 14.
2025-11-17 14:58:52,673 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:58:53,946 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 14:58:53,948 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 14:58:57,220 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 14:58:57,221 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:58:58,095 - ispa_next.main - DEBUG - 



2025-11-17 14:58:58,095 - ispa_next.main - DEBUG - starting with process 15 (WES-LP 22) of 24
2025-11-17 14:58:58,101 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 14:58:59,310 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 14:59:00,449 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 14:59:00,450 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 14:59:02,070 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 14:59:02,072 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 14:59:41,641 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 14:59:51,965 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:59:52,027 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:59:52,205 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 14:59:54,905 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 14:59:54,906 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 14:59:54,967 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 14:59:55,138 - ispa_next.functions - DEBUG - HU date already expired after 87 days.
2025-11-17 15:00:01,561 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:00:01,563 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:00:01,563 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:00:01,625 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:00:04,590 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:00:04,592 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:00:06,360 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:00:08,428 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:00:11,850 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:00:15,417 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:00:15,546 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:00:15,547 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:00:27,276 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:00:28,284 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:00:28,286 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:00:28,807 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:00:38,582 - ispa_next.functions - DEBUG - DSE icon is green
2025-11-17 15:00:47,040 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:00:47,042 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:00:47,138 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:00:47,139 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:00:47,170 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:00:48,383 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:00:48,643 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:00:52,471 - ispa_next.functions - DEBUG - Updated appointment (AM00012214) customer contact data.
2025-11-17 15:00:53,415 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:00:53,417 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:00:55,055 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:00:55,056 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:00:56,021 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:00:59,582 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:00:59,583 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:01:00,056 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:01:02,062 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:01:02,185 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:01:02,264 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:01:02,375 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:01:02,375 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:01:13,731 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:02:13,733 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:02:25,081 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:02:42,086 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:02:54,189 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:03:02,194 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_not_successfull
2025-11-17 15:03:03,199 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:03:03,201 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:03:03,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:03:03,271 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:03:13,337 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:03:13,817 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:03:13,818 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:03:14,494 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:03:14,497 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:03:16,924 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:03:16,926 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:03:17,959 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:03:17,961 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:03:17,965 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:03:17,967 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:03:17,970 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:03:17,971 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:03:17,972 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:03:17,975 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:03:17,976 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:03:17,979 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:03:17,980 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:03:18,659 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:03:19,403 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:03:27,006 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:03:27,008 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:03:27,009 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:03:27,009 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:30,337 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:03:30,338 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:03:30,342 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:33,746 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:03:33,747 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:03:33,748 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:03:33,750 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:03:37,123 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:03:51,499 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:03:52,101 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:03:52,968 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:03:53,141 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:04:00,815 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:04:06,424 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:04:06,425 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:04:07,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:04:07,142 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:04:07,144 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:04:10,826 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:04:20,004 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:04:20,381 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 15.
2025-11-17 15:04:21,572 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:04:22,546 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:04:22,547 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:04:25,765 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:04:25,766 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:04:26,692 - ispa_next.main - DEBUG - 



2025-11-17 15:04:26,692 - ispa_next.main - DEBUG - starting with process 16 (GEL-K 476) of 24
2025-11-17 15:04:26,696 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:04:27,859 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:04:28,942 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:04:28,943 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:04:30,747 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:04:30,749 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:05:16,200 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:05:27,154 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:05:31,973 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:05:31,973 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:32,034 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:05:32,218 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:05:32,223 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:05:32,224 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:05:32,312 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:05:42,499 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:05:42,500 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:05:43,945 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:05:45,950 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:05:46,064 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:05:46,166 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:05:46,234 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:05:46,235 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:05:57,450 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:06:04,863 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:06:04,863 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:06:09,047 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:06:10,064 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:06:10,065 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:10,739 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:23,548 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:06:30,674 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:06:30,677 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:30,774 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:06:30,775 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:06:30,828 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:06:31,102 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:06:33,233 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:06:33,460 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:06:36,653 - ispa_next.functions - DEBUG - Updated appointment (AM00012198) customer contact data.
2025-11-17 15:06:37,557 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:06:37,561 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:06:37,876 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:06:39,120 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:06:40,780 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:06:40,922 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:06:41,653 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:06:45,298 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:06:45,298 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:06:45,302 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:06:45,305 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:06:45,305 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:45,800 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:06:46,179 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:46,751 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:06:46,753 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:06:47,410 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:06:47,413 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:06:52,423 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:06:52,428 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:06:53,700 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:06:53,715 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:06:53,720 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:06:53,721 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:06:53,725 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:06:53,727 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:06:53,729 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:06:53,733 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:06:53,736 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:06:53,743 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:06:53,745 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:06:54,432 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:06:55,447 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:07:03,724 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:07:03,725 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:07:03,726 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:07:03,727 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:09,939 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:07:09,940 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:07:09,942 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:16,076 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:07:16,537 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:07:25,724 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:41,186 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:07:41,188 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:07:41,190 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:07:41,192 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:07:47,301 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 15:07:55,251 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:08:09,933 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:08:10,597 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:08:12,444 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:08:12,660 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:08:24,107 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:08:30,105 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:08:30,106 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:08:30,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:08:30,934 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:08:30,936 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:08:35,246 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:08:45,451 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:08:45,847 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 16.
2025-11-17 15:08:47,834 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:08:48,871 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:08:48,872 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:08:52,309 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:08:52,310 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:08:53,249 - ispa_next.main - DEBUG - 



2025-11-17 15:08:53,249 - ispa_next.main - DEBUG - starting with process 17 (MO-VE 157) of 24
2025-11-17 15:08:53,253 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:08:54,610 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:08:55,908 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:08:55,909 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:08:58,015 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:08:58,017 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:09:22,132 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:09:22,587 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 17.
2025-11-17 15:09:22,591 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:09:23,088 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:09:23,089 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:09:26,418 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:09:26,419 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:09:27,393 - ispa_next.main - DEBUG - 



2025-11-17 15:09:27,393 - ispa_next.main - DEBUG - starting with process 18 (KLE-MY 369) of 24
2025-11-17 15:09:27,397 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:09:28,355 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:09:29,412 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:09:29,412 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:09:30,957 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:09:30,958 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:09:53,110 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:09:53,121 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 18.
2025-11-17 15:09:53,125 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:09:53,873 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:09:53,875 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:09:57,758 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:09:57,759 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:09:58,684 - ispa_next.main - DEBUG - 



2025-11-17 15:09:58,684 - ispa_next.main - DEBUG - starting with process 19 (KLE-W 1982) of 24
2025-11-17 15:09:58,690 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:09:59,764 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:10:00,888 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:10:00,889 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:10:02,544 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:10:02,545 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:10:25,976 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:10:26,029 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 19.
2025-11-17 15:10:26,032 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:10:26,656 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:10:26,658 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:10:30,685 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:10:30,686 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:10:31,580 - ispa_next.main - DEBUG - 



2025-11-17 15:10:31,580 - ispa_next.main - DEBUG - starting with process 20 (KLE-PR 281) of 24
2025-11-17 15:10:31,584 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:10:32,957 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:10:34,224 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:10:34,226 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:10:36,206 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:10:36,207 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:11:00,316 - ispa_next.appointment_loop.main - DEBUG - Appointment failed: Traceback (most recent call last):
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointment_loop\main.py", line 41, in process_appointment
    handle_briefing_screen(element=app)
  File "C:\Users\Bot\AppData\Local\automizor\runner\ispa_next\appointments\functions.py", line 173, in handle_briefing_screen
    raise ViewTransitionError("Couldn't open 'Terminvereinbarung', proceed with next appointment")
ispa_next.exceptions.ViewTransitionError: Couldn't open 'Terminvereinbarung', proceed with next appointment

2025-11-17 15:11:00,325 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 20.
2025-11-17 15:11:00,329 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:11:00,790 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:11:00,792 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:11:04,741 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:11:04,743 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:11:05,644 - ispa_next.main - DEBUG - 



2025-11-17 15:11:05,645 - ispa_next.main - DEBUG - starting with process 21 (KLE-CS 99) of 24
2025-11-17 15:11:05,648 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:11:07,141 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:11:08,433 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:11:08,434 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:11:10,324 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:11:10,326 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:11:44,671 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:11:55,832 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:11:58,522 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:11:58,523 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:11:58,601 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:11:58,818 - ispa_next.functions - DEBUG - HU date soon to be invalid in 16 days.
2025-11-17 15:12:06,031 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:12:06,033 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:12:06,034 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:06,120 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:12:17,631 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:12:17,632 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:12:19,022 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:12:21,025 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:12:21,169 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:12:24,542 - ispa_next.rkr_manager.state - DEBUG - Cannot call from RKR
2025-11-17 15:12:33,345 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: rkr_button_disabled
2025-11-17 15:12:34,351 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:12:34,352 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:34,847 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:47,913 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:12:47,913 - ispa_next.functions - DEBUG - DSE dealer channels are valid
2025-11-17 15:12:56,763 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:12:56,766 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:12:56,862 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:12:56,862 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:12:56,932 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:12:57,025 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:12:58,291 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:12:58,593 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:13:02,767 - ispa_next.functions - DEBUG - Updated appointment (AM00012116) customer contact data.
2025-11-17 15:13:03,690 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:13:03,691 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:13:03,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:13:05,237 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:13:06,915 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:13:07,071 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:13:07,325 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:13:11,108 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:13:11,110 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:13:11,612 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:13:13,616 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:13:13,740 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:13:13,844 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:13:13,917 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:13:13,917 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:13:25,493 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:14:25,496 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:14:37,137 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:14:45,140 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:14:56,357 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:15:03,770 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:15:03,770 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:15:07,982 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:15:08,989 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:15:08,992 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:15:08,993 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:15:09,103 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:15:09,482 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:15:09,973 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:15:09,974 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:15:10,722 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:15:10,725 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:15:13,936 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:15:13,938 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:15:15,145 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:15:15,147 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:15:15,151 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart), Package(name=AU / § Hauptuntersuchung / Paketpreis, source=from_tab, target=cart)}
2025-11-17 15:15:15,155 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:15:15,159 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:15:15,161 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:15:15,162 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:15:15,168 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 15:15:15,172 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:15:15,177 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:15:15,182 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:15:15,862 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:15:16,768 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:15:36,720 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:15:36,722 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:15:39,575 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:15:40,141 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:15:41,061 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:15:41,676 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:15:42,197 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:15:44,475 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:15:45,129 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:15:45,652 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:15:46,631 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:15:47,188 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:15:47,727 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:15:48,698 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:15:49,275 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:15:49,801 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:15:50,751 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:15:51,336 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:15:51,874 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:15:52,835 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:15:54,244 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:15:54,282 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:15:54,283 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:15:57,756 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:15:57,757 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:15:57,759 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:01,247 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:16:01,249 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:16:01,251 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:16:01,252 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:04,637 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:16:19,537 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:16:20,289 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:16:21,314 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:16:21,471 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:29,681 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:16:36,848 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:16:36,849 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:38,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:16:38,554 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:16:38,555 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:16:42,834 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:16:52,661 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:16:53,030 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 21.
2025-11-17 15:16:54,553 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:55,841 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:16:55,843 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:17:00,536 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 225
2025-11-17 15:17:00,537 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:17:01,479 - ispa_next.main - DEBUG - 



2025-11-17 15:17:01,480 - ispa_next.main - DEBUG - starting with process 22 (GEL-F 198E) of 24
2025-11-17 15:17:01,483 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:17:02,821 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:17:04,105 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:17:04,106 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 225
2025-11-17 15:17:06,056 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:17:06,057 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:17:41,758 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:17:53,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:57,803 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:17:57,803 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:57,916 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:58,132 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:17:58,135 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:17:58,135 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:58,342 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:18:01,555 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:18:01,557 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:02,905 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:18:04,911 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:18:05,017 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:18:08,307 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:18:08,378 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:18:08,379 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:20,076 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:18:21,088 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:18:21,089 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:21,609 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:35,362 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:18:44,339 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:18:44,342 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:18:44,412 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:18:44,413 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:18:44,447 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:18:45,781 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:18:46,039 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:18:50,306 - ispa_next.functions - DEBUG - Updated appointment (AM00012088) customer contact data.
2025-11-17 15:18:51,219 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:18:51,248 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:18:53,036 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:18:53,036 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:18:54,217 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:18:57,823 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:18:57,825 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:18:58,328 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:00,334 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:19:00,438 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:19:00,581 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:19:00,650 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:19:00,650 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:19:11,411 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:19:18,671 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:19:18,672 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:19:22,985 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:19:23,992 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:19:23,994 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:19:23,995 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:24,101 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:29,711 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:30,284 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:19:30,284 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:30,935 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:19:30,938 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:19:34,679 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:19:34,681 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:19:35,750 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:19:35,751 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:35,755 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:19:35,756 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:35,759 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:19:35,761 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:19:35,762 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:19:35,768 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:19:35,772 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:19:35,776 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:19:35,777 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:19:36,449 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:19:37,324 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:19:45,435 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:19:45,436 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:19:45,439 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:19:45,439 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:50,312 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:19:53,589 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:19:53,591 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:19:53,595 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:58,779 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:19:58,781 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:19:58,782 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:19:58,784 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:03,495 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:20:16,817 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:20:17,498 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:18,446 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:20:18,620 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:20:28,890 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:20:37,042 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:37,042 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:38,007 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:38,080 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:20:38,081 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:42,161 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:20:50,750 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:20:51,121 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 22.
2025-11-17 15:20:52,195 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:20:53,114 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:20:53,115 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:20:57,003 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 225
2025-11-17 15:20:57,004 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:20:57,785 - ispa_next.main - DEBUG - 



2025-11-17 15:20:57,785 - ispa_next.main - DEBUG - starting with process 23 (M-D-3722) of 24
2025-11-17 15:20:57,788 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:58,779 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:20:59,829 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 334
2025-11-17 15:20:59,830 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 225
2025-11-17 15:21:01,511 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:21:01,512 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:36,800 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:21:48,183 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:21:53,019 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:21:53,019 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:53,112 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:53,403 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:21:53,405 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:21:53,406 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:53,514 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:56,583 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:21:56,585 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:58,003 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:00,007 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:22:00,128 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:22:00,220 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:22:00,304 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:22:00,304 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:22:12,138 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:22:13,144 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:22:13,145 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:13,619 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:28,917 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:22:37,530 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:22:37,532 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:37,610 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:22:37,611 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:22:37,652 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:22:38,946 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:22:40,099 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:22:40,369 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:22:43,803 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:22:43,805 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:22:44,839 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:22:44,840 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:22:46,239 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:22:49,884 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:22:49,885 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:22:50,366 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:52,370 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:22:52,543 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:22:52,630 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:22:52,746 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:22:52,746 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:23:04,191 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:24:04,193 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:24:16,620 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:24:24,344 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:24:24,345 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:24:26,539 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:24:27,545 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:24:27,548 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:24:27,549 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:27,654 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:24:33,319 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:34,027 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:34,028 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:34,833 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:34,836 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:24:39,333 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:24:39,335 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:24:40,502 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:24:40,503 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:40,507 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:24:40,509 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:24:40,513 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:24:40,517 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:24:40,520 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:24:40,525 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:24:40,526 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:24:40,529 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:24:40,530 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:24:41,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:24:42,556 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:24:50,214 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:24:50,216 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:24:50,217 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:24:50,217 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:55,756 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:24:55,757 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:24:55,762 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:01,509 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:25:02,013 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:25:11,437 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:27,204 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:25:27,206 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:25:27,207 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:25:27,220 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:25:32,870 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 15:25:43,380 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:25:58,876 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:25:59,495 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:00,423 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:26:00,590 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:11,560 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:26:18,310 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:26:18,310 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:19,003 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:26:19,129 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:26:19,131 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:26:22,755 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:26:31,943 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:26:36,857 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 23.
2025-11-17 15:26:36,860 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:37,438 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 15:26:37,439 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:41,061 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 226
2025-11-17 15:26:41,062 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:26:41,961 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
2025-11-17 15:26:41,969 - ispa_next.main - DEBUG - 



2025-11-17 15:26:41,969 - ispa_next.main - DEBUG - starting with process 24 (KK-B 602) of 24
2025-11-17 15:26:41,973 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:26:43,388 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:26:44,842 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 335
2025-11-17 15:26:44,844 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 226
2025-11-17 15:26:46,684 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:26:46,685 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:18,529 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:27:34,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:44,147 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:27:44,148 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:44,207 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:44,392 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:27:44,395 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:27:44,396 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:27:44,470 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:27:48,326 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:27:48,327 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:27:50,603 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:27:52,605 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:27:52,778 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:27:53,216 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:27:53,367 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:27:53,367 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:28:05,268 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:28:06,275 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:28:06,275 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:07,073 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:20,215 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:28:28,039 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:28:28,041 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:28,128 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:28:28,129 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:28:28,163 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:28:29,441 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:28:30,794 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:28:31,066 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:28:35,178 - ispa_next.functions - DEBUG - Updated appointment (AA00073898) customer contact data.
2025-11-17 15:28:36,147 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:28:36,150 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:28:37,465 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:28:37,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:28:38,778 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:28:42,380 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:28:42,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:28:42,876 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:28:44,886 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:28:45,034 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:28:45,145 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:28:45,211 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:28:45,211 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:28:56,683 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Schlüsseldaten überschreiben und öffnen (Empfohlen)' in nested popup
2025-11-17 15:29:04,217 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:29:04,217 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:29:08,440 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:29:09,471 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:29:09,474 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:29:09,475 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:09,547 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:29:16,163 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:16,707 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:16,708 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:17,400 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:29:17,403 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:29:25,484 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:29:25,486 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:29:26,793 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:29:26,795 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:29:26,800 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Fahrzeug maschinell waschen/aussaugen (kostenlos), source=from_tab, target=cart)}
2025-11-17 15:29:26,801 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:29:26,805 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:29:26,806 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:29:26,807 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:29:26,810 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:29:26,812 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:29:26,815 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:29:26,818 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:29:27,552 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:29:28,542 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:29:37,274 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:29:37,277 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:29:37,278 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:29:37,279 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:47,140 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:29:47,142 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:29:47,143 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:56,688 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:57,171 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:30:09,127 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:30,033 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:30:30,035 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:30:30,037 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:30:30,057 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:39,969 - ispa_next.functions - DEBUG - adding material to item=Package(name=Motoröl, source=cart, target=unkown)
2025-11-17 15:30:50,632 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:31:06,999 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:31:07,710 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:31:08,731 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:31:08,867 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:23,967 - ispa_next.functions - DEBUG - Sucessfully closed JobDetailsView.
2025-11-17 15:31:30,882 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:31:30,883 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:31:31,725 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:31:31,812 - ispa_next.common.shared - DEBUG - ISPA tab Abschluss is already open
2025-11-17 15:31:31,813 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:31:35,747 - ispa_next.appointment_ending - DEBUG - Service parts target assigned before process exit.
2025-11-17 15:31:39,880 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:31:44,275 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 24.
2025-11-17 15:31:44,279 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:31:44,861 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 337
2025-11-17 15:31:44,863 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:31:48,546 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 227
2025-11-17 15:31:48,546 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:31:49,405 - ispa_next.appointments.models - DEBUG - Appointment Gabriele Raffs GEL-G 485E WBY71EG0805483494 ohne Termin.
2025-11-17 15:31:49,417 - ispa_next.appointments.models - DEBUG - Appointment Lars Birgels KR-LB 172 WBA2C11090V904353 ohne Termin.
