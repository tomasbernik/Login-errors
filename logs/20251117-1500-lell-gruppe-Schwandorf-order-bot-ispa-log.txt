2025-11-17 15:00:37,415 - ispa_next.main - DEBUG - ISPA Next attempt (1 / 5)
2025-11-17 15:00:37,421 - overlays.client - INFO - Connected to overlay manager pipe
2025-11-17 15:00:45,658 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:00:59,105 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:01:14,724 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:03:12,556 - ispa_next.app_start.main - DEBUG - Operation already took 106.47 seconds (more than 80 seconds)
2025-11-17 15:03:14,662 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_icrs3xbv_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_icrs3xbv', 'txt']
2025-11-17 15:03:14,904 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:03:14,910 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:03:14,910 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:05:13,595 - ispa_next.app_start.main - DEBUG - Operation already took 106.30 seconds (more than 80 seconds)
2025-11-17 15:05:15,661 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_7zwe9nf0_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_7zwe9nf0', 'txt']
2025-11-17 15:05:15,890 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:05:15,896 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:05:23,069 - ispa_next.main - DEBUG - ISPA Next attempt (2 / 5)
2025-11-17 15:05:32,073 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:05:42,661 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:05:58,228 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:07:55,777 - ispa_next.app_start.main - DEBUG - Operation already took 106.43 seconds (more than 80 seconds)
2025-11-17 15:07:57,847 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_5ts7sbl6_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_5ts7sbl6', 'txt']
2025-11-17 15:07:58,093 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:07:58,098 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:07:58,099 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:09:56,958 - ispa_next.app_start.main - DEBUG - Operation already took 106.46 seconds (more than 80 seconds)
2025-11-17 15:09:59,032 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_ailgxjxw_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_ailgxjxw', 'txt']
2025-11-17 15:09:59,272 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:09:59,277 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:10:05,161 - ispa_next.main - DEBUG - ISPA Next attempt (3 / 5)
2025-11-17 15:10:12,583 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:10:23,330 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:10:38,716 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:12:36,407 - ispa_next.app_start.main - DEBUG - Operation already took 106.53 seconds (more than 80 seconds)
2025-11-17 15:12:38,468 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_zvh2l45l_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_zvh2l45l', 'txt']
2025-11-17 15:12:38,699 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:12:38,705 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:12:38,705 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:14:37,803 - ispa_next.app_start.main - DEBUG - Operation already took 106.72 seconds (more than 80 seconds)
2025-11-17 15:14:39,878 - pytesseract - DEBUG - ['tesseract', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_kvcqiqmn_input.PNG', 'C:\\Users\\Bot\\AppData\\Local\\robocorp\\temp\\223d9149637f2ec2\\tess_kvcqiqmn', 'txt']
2025-11-17 15:14:40,131 - ispa_next.app_start.main - DEBUG - Unknown error
2025-11-17 15:14:40,135 - ispa_next.app_start.main - DEBUG - Exception occurred: Unknown error during authentication
2025-11-17 15:14:46,650 - ispa_next.main - DEBUG - ISPA Next attempt (4 / 5)
2025-11-17 15:14:55,612 - ispa_next.app_start.functions - DEBUG - handle_update_available
2025-11-17 15:15:06,087 - ispa_next.app_start.functions - DEBUG - has_ispa_errors
2025-11-17 15:15:21,840 - ispa_next.app_start.functions - DEBUG - authenticate_user
2025-11-17 15:15:45,310 - ispa_next.app_start.main - DEBUG - Login successful
2025-11-17 15:15:57,693 - ispa_next.appointments.functions - DEBUG - order_appointments_grid_by_created_at
2025-11-17 15:16:00,746 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:01,840 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 485
2025-11-17 15:16:01,841 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 33
2025-11-17 15:16:03,713 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 12
2025-11-17 15:16:03,718 - ispa_next.appointments.functions - DEBUG - recover_or_exit_IPS_error
2025-11-17 15:16:03,718 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:16:04,598 - ispa_next.appointments.functions - DEBUG - check_appointments_grid_for_IPS_error
2025-11-17 15:16:05,437 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:06,345 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 15:16:06,351 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 15:16:06,358 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 15:16:06,359 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:06,367 - ispa_next.appointments.models - DEBUG - Appointment Firma Dachbau Gradl BUL-GX 42 WBA11CM0308C43879 ohne Termin.
2025-11-17 15:16:06,373 - ispa_next.appointments.models - DEBUG - Appointment Gregor Berki SAD-BK 161 WBA5V51060FH45254 ohne Termin.
2025-11-17 15:16:06,374 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:16:06,379 - ispa_next.main - DEBUG - Found 2 out of 5 appointments to process (configured limit: 15).
2025-11-17 15:16:06,379 - ispa_next.main - DEBUG - Processing 2 fresh appointments.
2025-11-17 15:16:06,379 - ispa_next.main - DEBUG - All appointments: SAD-JX 89, SAD-HN 606
2025-11-17 15:16:06,382 - ispa_next.main - DEBUG - 



2025-11-17 15:16:06,382 - ispa_next.main - DEBUG - starting with process 1 (SAD-JX 89) of 2
2025-11-17 15:16:06,386 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:16:07,170 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:16:07,750 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 485
2025-11-17 15:16:07,751 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 12
2025-11-17 15:16:08,797 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:16:08,798 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:16:38,609 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:16:48,272 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:48,376 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:48,562 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:16:49,796 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:16:49,796 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:49,901 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:16:50,194 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:16:50,197 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:16:50,198 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:16:50,294 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:00,249 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:00,251 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:01,256 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:03,259 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:03,363 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:17:06,579 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:17:06,648 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:17:06,650 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:07,971 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:17:19,156 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:17:20,160 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:17:20,161 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:20,651 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:33,968 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:17:40,776 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:17:40,778 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:17:40,862 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:17:40,864 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:17:40,900 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:17:42,130 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:17:42,378 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:17:45,207 - ispa_next.functions - DEBUG - Updated appointment (AB00037752) customer contact data.
2025-11-17 15:17:46,130 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:17:46,131 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:17:47,023 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:17:47,026 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:17:47,743 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:17:52,260 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:17:52,262 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:17:52,771 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:17:54,773 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:17:54,882 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:17:54,978 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:17:55,058 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:17:55,064 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:17:57,005 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:18:08,443 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:19:08,447 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:19:19,705 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:19:26,920 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:19:26,920 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:28,955 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:19:33,150 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:19:34,157 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:19:34,158 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:19:34,159 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:19:34,248 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:19:38,385 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:19:38,390 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:19:38,390 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 15:19:38,392 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:19:40,272 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:19:40,276 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:19:41,294 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:19:41,298 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:41,304 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 15:19:41,312 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:19:41,316 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:19:41,316 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:19:41,318 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:19:41,322 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:19:41,324 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:19:41,338 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:19:41,340 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:19:41,344 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:19:41,349 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:19:42,044 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:19:42,775 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:19:45,128 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:19:45,145 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:19:45,148 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:19:45,149 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:47,767 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:19:47,767 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:19:47,771 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:50,369 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:19:50,369 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:19:50,371 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:52,901 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:19:52,903 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:19:52,906 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:19:55,454 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:20:06,676 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:20:06,676 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:20:06,678 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:07,212 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:20:07,750 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:20:07,750 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:20:09,113 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:20:17,152 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:20:17,533 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 1.
2025-11-17 15:20:17,955 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:20:18,898 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 487
2025-11-17 15:20:18,900 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:20:21,256 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 34
2025-11-17 15:20:21,257 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:20:21,870 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 15:20:21,875 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 15:20:21,880 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 15:20:21,885 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 15:20:21,885 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:20:21,891 - ispa_next.appointments.models - DEBUG - Appointment Stephan Wiedmann SAD-QV 9 WBA2C11070V901631 ohne Termin.
2025-11-17 15:20:21,893 - ispa_next.main - DEBUG - Found new Appointment: NEW-MH 987
2025-11-17 15:20:21,897 - ispa_next.main - DEBUG - 



2025-11-17 15:20:21,897 - ispa_next.main - DEBUG - starting with process 2 (NEW-MH 987) of 3
2025-11-17 15:20:21,900 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:20:22,789 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:20:23,619 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 487
2025-11-17 15:20:23,620 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 34
2025-11-17 15:20:24,800 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:20:24,801 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:21:00,044 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:21:09,525 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:21:10,773 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:21:10,775 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:10,880 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:11,223 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:21:11,226 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:21:11,227 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:11,291 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:14,456 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:21:14,456 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:15,479 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:21:17,485 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:21:17,656 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:21:20,879 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:21:20,996 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:21:25,226 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: data_still_good
2025-11-17 15:21:26,229 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:21:26,231 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:26,692 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:37,876 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:21:44,264 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:21:44,266 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:21:44,404 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:21:44,405 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:21:44,436 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:21:45,634 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:21:45,883 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:21:49,695 - ispa_next.functions - DEBUG - Updated appointment (AB00037753) customer contact data.
2025-11-17 15:21:50,605 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:21:50,607 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:21:51,428 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:21:51,429 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:21:52,193 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:21:55,795 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:21:55,795 - ispa_next.rkr_manager.main - DEBUG - early exiting RemoteKeyReadManager - enabled=False or early_exit_enabled=True
2025-11-17 15:21:55,798 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:21:55,799 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:21:55,799 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:21:56,311 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:00,508 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:22:00,512 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:22:00,512 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:22:00,594 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:22:06,173 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:06,773 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:22:06,774 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:22:07,416 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:22:07,418 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:22:08,725 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:22:08,728 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:22:09,724 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:22:09,726 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:22:09,729 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 15:22:09,743 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:22:09,753 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:22:09,754 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:22:09,758 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:22:09,759 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:22:09,764 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:22:09,772 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:22:09,774 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:22:09,780 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:22:09,783 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:22:10,462 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:22:11,170 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:22:13,445 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:22:13,447 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:22:13,449 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:22:13,450 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:15,366 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:22:15,366 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:22:15,368 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:17,255 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:22:17,255 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:22:17,257 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:19,168 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:22:19,170 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:22:19,180 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:22:21,350 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:22:32,408 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:22:32,408 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:22:32,410 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:22:32,984 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:22:33,563 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:22:33,565 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:22:35,272 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:22:42,993 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:22:43,375 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 2.
2025-11-17 15:22:44,082 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:22:45,015 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 488
2025-11-17 15:22:45,015 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:22:48,017 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 35
2025-11-17 15:22:48,018 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:22:48,896 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 15:22:48,903 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 15:22:48,918 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 15:22:48,925 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 15:22:48,925 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:22:48,931 - ispa_next.appointments.models - DEBUG - Appointment Stephan Wiedmann SAD-QV 9 WBA2C11070V901631 ohne Termin.
2025-11-17 15:22:48,933 - ispa_next.main - DEBUG - Found new Appointment: HF-NK 290
2025-11-17 15:22:48,937 - ispa_next.main - DEBUG - 



2025-11-17 15:22:48,937 - ispa_next.main - DEBUG - starting with process 3 (HF-NK 290) of 4
2025-11-17 15:22:48,940 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:22:50,163 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:22:51,228 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 488
2025-11-17 15:22:51,229 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 35
2025-11-17 15:22:52,419 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:22:52,419 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:23:19,921 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:23:28,877 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:28,990 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:29,136 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:30,374 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:23:30,375 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:30,448 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:30,680 - ispa_next.functions - DEBUG - HU date already expired after 19 days.
2025-11-17 15:23:37,558 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:23:37,559 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:23:37,560 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:23:37,622 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:23:40,494 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:23:40,496 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:23:41,767 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:23:43,783 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:23:43,882 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:23:47,104 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:23:47,176 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:23:47,177 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:23:48,372 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:23:59,677 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:24:00,681 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:24:00,682 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:01,258 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:12,979 - ispa_next.functions - DEBUG - DSE icon is red
2025-11-17 15:24:19,218 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:24:19,220 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:24:19,286 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:24:19,288 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:24:19,394 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:24:19,488 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:24:20,509 - ispa_next.functions - DEBUG - fetch_customer_data_from_wps
2025-11-17 15:24:21,658 - ispa_next.functions - DEBUG - fetch_customer_data_from_temporary_data
2025-11-17 15:24:21,965 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:24:24,403 - ispa_next.functions - DEBUG - Updated appointment (AB00037755) customer contact data.
2025-11-17 15:24:25,344 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:24:25,344 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:24:25,430 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:26,047 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:24:27,345 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:24:27,345 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:24:27,440 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:24:31,844 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:24:31,845 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:24:32,349 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:24:34,353 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:24:34,449 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:24:34,589 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:24:34,658 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:24:34,658 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:24:37,486 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:24:48,566 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:25:48,568 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:25:59,398 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:26:06,585 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:26:06,587 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:26:12,080 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Fahrzeuguntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:26:14,846 - ispa_next.rkr_manager.state - DEBUG - moving cart item source=<PackageSource.CART: 'cart'> name='§ Abgasuntersuchung' target=<Container.UNKOWN: 'unkown'> notification=None element=<pyfenster.Element name='BMW.ISPI.TRAC.IspaNext.BasketUI.ViewModels.BasketJobViewModel' class_name='TreeViewItem' control_type_name='TreeItem'> tab=None category=None subcategory=None search_term=None catalog_group=None catalog_subgroup=None catalog_page=None package_type=None number=None package_aw=None optional_part=None required_aws=[] parts_to_replace=None note=None valid_from=datetime.datetime(1900, 1, 1, 7, 0) valid_until=datetime.datetime(2100, 1, 1, 7, 0) valid_weekdays=[] replacement_packages=[] service_advisor_guards=[] service_advisor_requirements=[] deletion_guards=[] deletion_requirements=[] placement_guards=[] placement_requirements=[] to advice_list
2025-11-17 15:26:16,765 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:26:20,972 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:26:21,979 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:26:21,981 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:26:21,981 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:26:22,049 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:26:26,192 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =True
2025-11-17 15:26:26,792 - ispa_next.functions - DEBUG - generate_appointment_pdfs
2025-11-17 15:26:37,069 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:26:37,069 - ispa_next.wipers - DEBUG - no mileage provided for wiper check, exiting.
2025-11-17 15:26:37,070 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:26:39,574 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:26:39,580 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:26:42,166 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:26:42,173 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:26:42,177 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 15:26:42,179 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:26:42,182 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:26:42,182 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:26:42,184 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:26:42,186 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:26:42,186 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:26:42,190 - ispa_next.package_manager.main - DEBUG - found packages to delete: {Package(name=§ Fahrzeuguntersuchung, source=cart, target=trash)}
2025-11-17 15:26:42,190 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:26:42,194 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:26:42,196 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:26:42,950 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:26:43,882 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:26:46,656 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:26:46,658 - ispa_next.package_manager.helper - DEBUG - cart_operation called
2025-11-17 15:26:49,404 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:26:49,964 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:26:50,903 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:26:51,499 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:26:52,043 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:26:52,951 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:26:53,530 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:26:54,058 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:26:54,968 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:26:55,540 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:26:56,065 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1685, 0)
2025-11-17 15:26:56,982 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:26:58,454 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:27:00,277 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:27:00,996 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:27:01,926 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:27:02,539 - ispa_next.package_manager.helper - DEBUG - Package name not found with coordinate: (-1700, 0)
2025-11-17 15:27:03,467 - root - WARNING - Failed to scroll control: (-2146233079, None, (None, None, None, 0, None))
2025-11-17 15:27:04,229 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:27:04,243 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:27:04,245 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:07,606 - ispa_next.functions - DEBUG - Adding additional texts to cart items
2025-11-17 15:27:10,949 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:27:10,951 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:27:10,968 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:14,365 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:27:14,366 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:27:14,367 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:17,640 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:27:17,642 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:27:17,645 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:27:20,972 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:27:34,580 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:27:34,582 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:27:34,582 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:27:35,245 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:27:35,811 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:27:35,813 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:27:37,869 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:27:46,452 - ispa_next.appointment_ending - DEBUG - return from complete process straight to process_list with saving without error_dialog.
2025-11-17 15:27:46,842 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 3.
2025-11-17 15:27:47,544 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:48,682 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 489
2025-11-17 15:27:48,682 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:51,922 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 36
2025-11-17 15:27:51,926 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:27:52,779 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 15:27:52,784 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 15:27:52,790 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 15:27:52,796 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 15:27:52,796 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:27:52,799 - ispa_next.main - DEBUG - 



2025-11-17 15:27:52,799 - ispa_next.main - DEBUG - starting with process 4 (SAD-HN 606) of 4
2025-11-17 15:27:52,801 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:27:53,982 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:27:55,350 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 489
2025-11-17 15:27:55,352 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 36
2025-11-17 15:27:57,154 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:27:57,156 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:28:33,987 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:28:45,802 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:28:49,854 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:28:49,854 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:49,946 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:28:50,194 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:28:50,202 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:28:50,202 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:28:50,289 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:28:53,548 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:28:53,550 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:28:55,175 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:28:57,182 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:28:57,406 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:29:00,656 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:29:00,790 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:29:00,792 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:29:04,909 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:29:16,428 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:29:17,432 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:29:17,433 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:17,951 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:30,759 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:29:39,490 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:29:39,492 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:29:39,612 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:29:39,612 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:29:39,695 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:29:41,094 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:29:42,423 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:29:42,686 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:29:45,719 - ispa_next.functions - DEBUG - Updated appointment (AG00013449) customer contact data.
2025-11-17 15:29:46,620 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:29:46,624 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:29:47,874 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:29:47,874 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:29:48,790 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:29:53,340 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:29:53,374 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:29:53,931 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:29:55,941 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:29:56,080 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:29:56,244 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:29:56,404 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:29:56,406 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:30:01,500 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:30:13,473 - ispa_next.rkr_manager.state - DEBUG - Waiting for timeout to pass
2025-11-17 15:31:13,476 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:31:24,843 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:31:32,570 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:31:32,572 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:31:37,425 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:31:41,627 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:31:42,634 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:31:42,635 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:31:42,635 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:42,742 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:31:46,943 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:31:46,946 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:31:46,947 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:47,022 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:31:47,399 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:47,986 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:31:47,986 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:31:48,805 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:31:48,807 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:31:53,030 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:31:53,032 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:31:54,458 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:31:54,459 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:31:54,461 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 15:31:54,463 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:31:54,465 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:31:54,467 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:31:54,467 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:31:54,469 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:31:54,469 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:31:54,473 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:31:54,473 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:31:54,483 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:31:54,487 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:31:55,354 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:31:56,268 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:31:59,340 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:31:59,342 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:31:59,344 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:31:59,344 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:04,775 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:32:04,777 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:32:04,779 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:10,096 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:32:10,096 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:32:10,098 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:15,358 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:32:15,359 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:32:15,361 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:32:20,659 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:32:34,158 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:32:34,160 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:32:34,160 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:32:35,127 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:32:35,764 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:32:35,764 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:32:38,074 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:32:47,072 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:32:51,137 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 4.
2025-11-17 15:32:51,140 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:32:51,794 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 490
2025-11-17 15:32:51,794 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:32:55,810 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 36
2025-11-17 15:32:55,811 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:32:56,869 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 15:32:56,876 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 15:32:56,883 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 15:32:56,888 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 15:32:56,889 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
2025-11-17 15:32:56,891 - ispa_next.main - DEBUG - Found new Appointment: R-P 2392
2025-11-17 15:32:56,893 - ispa_next.main - DEBUG - 



2025-11-17 15:32:56,893 - ispa_next.main - DEBUG - starting with process 5 (R-P 2392) of 5
2025-11-17 15:32:56,896 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:32:58,429 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:33:00,063 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 490
2025-11-17 15:33:00,065 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 36
2025-11-17 15:33:01,866 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 1
2025-11-17 15:33:01,868 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:33:39,302 - ispa_next.rkr_manager.main - DEBUG - RemoteKeyReadManager initialized
2025-11-17 15:33:51,084 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:33:53,046 - ispa_next.functions - DEBUG - check_and_verify_hu_date
2025-11-17 15:33:53,047 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:33:53,162 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:33:53,539 - ispa_next.functions - DEBUG - check_potential_workshop_test
2025-11-17 15:33:53,540 - ispa_next.functions - DEBUG - check_vehicle_age_for_service_plus
2025-11-17 15:33:53,541 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:33:53,643 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:33:57,061 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:33:57,063 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:33:59,166 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:34:01,173 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:34:01,314 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:34:04,587 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:34:04,692 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:34:04,694 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:34:06,775 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:34:18,891 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: non_blocking_wait
2025-11-17 15:34:19,896 - ispa_next.functions - DEBUG - handle_data_privacy_consent
2025-11-17 15:34:19,896 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:34:20,436 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:34:34,240 - ispa_next.functions - DEBUG - DSE icon is yellow
2025-11-17 15:34:43,661 - ispa_next.functions - DEBUG - transfer_customer_data_to_appointment
2025-11-17 15:34:43,664 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:34:43,769 - ispa_next.common.shared - DEBUG - ISPA tab Kunden & Fahrzeug is already open
2025-11-17 15:34:43,771 - ispa_next.functions - DEBUG - fetch_customer_data
2025-11-17 15:34:43,848 - ispa_next.functions - DEBUG - fetch_customer_data_from_bmw_id
2025-11-17 15:34:44,005 - ispa_next.functions - DEBUG - fetch_customer_data_from_dms
2025-11-17 15:34:45,352 - ispa_next.functions - DEBUG - All data found, skipping remaining sources
2025-11-17 15:34:45,578 - ispa_next.functions - DEBUG - copy_customer_data_to_appointment
2025-11-17 15:34:49,894 - ispa_next.functions - DEBUG - Updated appointment (AB00037757) customer contact data.
2025-11-17 15:34:50,818 - ispa_next.functions - DEBUG - check_for_alpina_vehicle
2025-11-17 15:34:50,827 - ispa_next.functions - DEBUG - check_bmw_id_add_to_list
2025-11-17 15:34:51,092 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:34:51,975 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Fahrzeugzustand
2025-11-17 15:34:53,755 - ispa_next.functions - DEBUG - check_home_dealer_add_to_list
2025-11-17 15:34:53,757 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Fahrzeugzustand
2025-11-17 15:34:53,845 - ispa_next.common.shared - DEBUG - ISPA tab Fahrzeugzustand is already open
2025-11-17 15:34:57,476 - ispa_next.rkr_manager.main - DEBUG - running RemoteKeyReadManager
2025-11-17 15:34:57,477 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:34:57,984 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:34:59,990 - ispa_next.rkr_manager.state - DEBUG - Entering initial state
2025-11-17 15:35:00,159 - ispa_next.rkr_manager.state - DEBUG - Checking customer consent
2025-11-17 15:35:00,301 - ispa_next.rkr_manager.state - DEBUG - Checking data freshness
2025-11-17 15:35:00,412 - ispa_next.rkr_manager.state - DEBUG - Getting cart and advice list contents
2025-11-17 15:35:00,414 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:03,100 - ispa_next.rkr_manager.state - DEBUG - Triggering remote key read
2025-11-17 15:35:14,494 - ispa_next.rkr_manager.helper - DEBUG - Found button 'Hinzufügen (Empfohlen)' in nested popup
2025-11-17 15:35:22,186 - ispa_next.rkr_manager.state - DEBUG - Checking cart items after successfull RKR
2025-11-17 15:35:22,188 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:24,885 - ispa_next.rkr_manager.state - DEBUG - Checking color in CBS positions
2025-11-17 15:35:29,095 - ispa_next.rkr_manager.state - DEBUG - State machine completed with reason: success
2025-11-17 15:35:30,100 - ispa_next.functions - DEBUG - generate_attachments
2025-11-17 15:35:30,113 - ispa_next.functions - DEBUG - check_service_requirement
2025-11-17 15:35:30,115 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:30,227 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:35:34,375 - ispa_next.functions - DEBUG - check_service_requirement result: pdf_needed =False
2025-11-17 15:35:34,379 - ispa_next.wipers - DEBUG - handle_wiper_service_contracts
2025-11-17 15:35:34,381 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:34,472 - ispa_next.common.shared - DEBUG - ISPA tab Wartung is already open
2025-11-17 15:35:43,972 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:44,463 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Kunden & Fahrzeug
2025-11-17 15:35:44,465 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Wartung
2025-11-17 15:35:45,350 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Wartung
2025-11-17 15:35:45,352 - ispa_next.package_manager.main - DEBUG - updating cart content
2025-11-17 15:35:47,780 - ispa_next.package_manager.main - DEBUG - updating advice list content
2025-11-17 15:35:47,782 - ispa_next.package_manager.helper - DEBUG - get_advice_list_contents
2025-11-17 15:35:49,258 - ispa_next.package_manager.main - DEBUG - determining package movements
2025-11-17 15:35:49,262 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:35:49,265 - ispa_next.package_manager.main - DEBUG - found packages to cart: {Package(name=Kostenlose Fzg Reinigung, source=from_tab, target=cart)}
2025-11-17 15:35:49,267 - ispa_next.package_manager.main - DEBUG - determining packages to place
2025-11-17 15:35:49,269 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben vorn aus- und einbauen/ersetze: placement requirements not met
2025-11-17 15:35:49,271 - ispa_next.package_manager.main - DEBUG - Cannot place Beide Bremsscheiben hinten aus- und einbauen/erset: placement requirements not met
2025-11-17 15:35:49,273 - ispa_next.package_manager.main - DEBUG - Cannot place Ladewunsch und Ladezustand: not present in source
2025-11-17 15:35:49,273 - ispa_next.package_manager.main - DEBUG - found packages to advice_list: set()
2025-11-17 15:35:49,275 - ispa_next.package_manager.main - DEBUG - determining package to delete
2025-11-17 15:35:49,278 - ispa_next.package_manager.main - DEBUG - found packages to delete: set()
2025-11-17 15:35:49,280 - ispa_next.package_manager.main - DEBUG - determining package to update
2025-11-17 15:35:49,283 - ispa_next.package_manager.main - DEBUG - found packages to update: set()
2025-11-17 15:35:49,285 - ispa_next.package_manager.helper - DEBUG - add_to_cart called
2025-11-17 15:35:50,039 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Marketing
2025-11-17 15:35:51,004 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Marketing
2025-11-17 15:35:53,932 - ispa_next.package_manager.helper - DEBUG - _add_to_container_manual
2025-11-17 15:35:53,934 - ispa_next.functions - DEBUG - verify_cart_packages_additional_texts
2025-11-17 15:35:53,935 - ispa_next.functions - DEBUG - check_cart_for_additional_text_packages
2025-11-17 15:35:53,935 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:35:57,274 - ispa_next.functions - DEBUG - handle_mobility_replacement
2025-11-17 15:35:57,276 - ispa_next.functions - DEBUG - verify_battery_in_motoroil_package
2025-11-17 15:35:57,278 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:00,563 - ispa_next.functions - DEBUG - verify_breaks_in_break_package
2025-11-17 15:36:00,563 - ispa_next.functions - DEBUG - verify breaks added if breaks service in cart
2025-11-17 15:36:00,565 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:03,830 - ispa_next.functions - DEBUG - process_check_control
2025-11-17 15:36:03,832 - ispa_next.functions - DEBUG - trying add_material_to_package
2025-11-17 15:36:03,834 - ispa_next.functions - DEBUG - get_cart_contents
2025-11-17 15:36:07,092 - ispa_next.functions - DEBUG - notify_aw_increase_to_service_advisor
2025-11-17 15:36:22,213 - ispa_next.functions - DEBUG - check_cart_packages_for_parts_service_and_parts_availability
2025-11-17 15:36:22,214 - ispa_next.appointment_ending - DEBUG - entered complete process
2025-11-17 15:36:22,215 - ispa_next.appointment_loop.helpers - DEBUG - Checking for potential OIDC Login dialog
2025-11-17 15:36:23,149 - ispa_next.common.shared - DEBUG - Attempting to open ISPA tab: Abschluss
2025-11-17 15:36:23,734 - ispa_next.common.shared - DEBUG - Successfully opened ISPA tab: Abschluss
2025-11-17 15:36:23,735 - ispa_next.appointment_ending - DEBUG - complete_process isn't exiting early.
2025-11-17 15:36:26,329 - ispa_next.appointment_ending - DEBUG - No need to assign service parts target.
2025-11-17 15:36:35,195 - ispa_next.appointment_ending - DEBUG - attempt to close process with save: False
2025-11-17 15:36:39,228 - ispa_next.appointment_loop.main - DEBUG - Closing appointment 5.
2025-11-17 15:36:39,232 - ispa_next.appointments.functions - DEBUG - filter_appointments_grid_by_term
2025-11-17 15:36:39,970 - ispa_next.appointments.functions - DEBUG - Gross total count for all events at location: 490
2025-11-17 15:36:39,972 - ispa_next.appointments.functions - DEBUG - Unfiltered total count for 'Terminvereinbarung' events: 1
2025-11-17 15:36:43,739 - ispa_next.appointments.functions - DEBUG - Filtered by term total count for 'Terminvereinbarung' events: 36
2025-11-17 15:36:43,739 - ispa_next.appointments.functions - DEBUG - fetch_appointments_from_grid
2025-11-17 15:36:45,001 - ispa_next.appointments.models - DEBUG - Appointment Hermann Glaser CHA-HG 111 WBA4J51060BN79538 ohne Termin.
2025-11-17 15:36:45,007 - ispa_next.appointments.models - DEBUG - Appointment Semra Mümtaz SAD-SI 87 WBA5K11030D944272 ohne Termin.
2025-11-17 15:36:45,014 - ispa_next.appointments.models - DEBUG - Appointment Firma Food-SB GmbH NEN-LB 400 WBA11AJ070CL74137 ohne Termin.
2025-11-17 15:36:45,019 - ispa_next.appointments.models - DEBUG - Appointment Bernd Iberl SAD-IB 267 WBA11DW060WW67715 ohne Termin.
2025-11-17 15:36:45,019 - ispa_next.appointments.models - DEBUG - Skipping appointment without VIN
